--note:
--sampe BOS_AR_FCustBasicInformation_LockFCustBasicInformation
--
--
CREATE OR REPLACE FUNCTION BOS_AP_Ap_AdjustApTransRemain(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint,
p_decAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_ApTrans
SET 
decRemain = decRemain + p_decAmount
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szSuppId = p_szSuppId And shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_AdjustApTransRemain_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint,
p_decAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_ApTrans
SET 
decRemain = decRemain + p_decAmount
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szSuppId = p_szSuppId And shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_CloseApTrans(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint,
p_bClosed bit,
p_dtmClosed timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_ApTrans
SET 
bClosed = p_bClosed,
dtmClosed = p_dtmClosed
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szSuppId = p_szSuppId And shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_CloseApTrans_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint,
p_bClosed bit,
p_dtmClosed timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_ApTrans
SET 
bClosed = p_bClosed,
dtmClosed = p_dtmClosed
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szSuppId = p_szSuppId And shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_CountPassDueApOfSupp(
p_dtmTransaction timestamp,
p_szInvSuppId BOS_DT_szId,
p_decMinAmountTreatedAsAp BOS_DT_decDecimal)
RETURNS void AS
$BODY$
BEGIN
SELECT 
COUNT(BAT.szDocId) AS cntPassDueAp


FROM 
BOS_AP_ApTrans As BAT

WHERE 
BAT.bClosed = 0 And BAT.decRemain > p_decMinAmountTreatedAsAp And (BAT.szTrnId = 'FInv' Or BAT.szTrnId = 'PDREC') AND BAT.dtmDue < p_dtmTransaction AND BAT.szSuppId LIKE p_szInvSuppId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_CountPassDueApOfSupp_014(
p_dtmTransaction timestamp,
p_szInvSuppId BOS_DT_szId,
p_decMinAmountTreatedAsAp BOS_DT_decDecimal)
RETURNS void AS
$BODY$
BEGIN
SELECT 
COUNT(BAT.szDocId) AS cntPassDueAp


FROM 
BOS_AP_ApTrans As BAT

WHERE 
BAT.bClosed = 0 And BAT.decRemain > p_decMinAmountTreatedAsAp And (BAT.szTrnId = 'FInv' Or BAT.szTrnId = 'PDREC') AND BAT.dtmDue < p_dtmTransaction AND BAT.szSuppId LIKE p_szInvSuppId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_CreateApMaster(
p_szSuppId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_decAmount BOS_DT_decAmount,
p_bBad bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AP_ApMaster
(
szSuppId,
szCcyId,
decAmount,
bBad,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szSuppId,
p_szCcyId,
p_decAmount,
p_bBad,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_CreateApTrans(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint,
p_dtmDate timestamp,
p_dtmPeriode timestamp,
p_szCcyId BOS_DT_szSmallId,
p_decAmount BOS_DT_decAmount,
p_decRemain BOS_DT_decAmount,
p_szDescription BOS_DT_szDescription,
p_bClosed bit,
p_dtmClosed timestamp,
p_szUrl BOS_DT_szUrl,
p_szFInvoiceStatus varchar,
p_szInvWorkplaceId BOS_DT_szId,
p_szRefTrnId BOS_DT_szMediumId,
p_szRefDocId BOS_DT_szId,
p_bCash bit,
p_dtmDue timestamp,
p_dtmDue_Printed timestamp,
p_szFInvoiceType BOS_DT_szSmallId,
p_szFInvoiceUsage varchar,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AP_ApTrans
(
szTrnId,
szDocId,
szSuppId,
shRevNo,
dtmDate,
dtmPeriode,
szCcyId,
decAmount,
decRemain,
szDescription,
bClosed,
dtmClosed,
szUrl,
szFInvoiceStatus,
szInvWorkplaceId,
szRefTrnId,
szRefDocId,
bCash,
dtmDue,
dtmDue_Printed,
szFInvoiceType,
szFInvoiceUsage,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szTrnId,
p_szDocId,
p_szSuppId,
p_shRevNo,
p_dtmDate,
p_dtmPeriode,
p_szCcyId,
p_decAmount,
p_decRemain,
p_szDescription,
p_bClosed,
p_dtmClosed,
p_szUrl,
p_szFInvoiceStatus,
p_szInvWorkplaceId,
p_szRefTrnId,
p_szRefDocId,
p_bCash,
p_dtmDue,
p_dtmDue_Printed,
p_szFInvoiceType,
p_szFInvoiceUsage,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_CreateApTrans_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint,
p_dtmDate timestamp,
p_dtmPeriode timestamp,
p_szCcyId BOS_DT_szSmallId,
p_decAmount BOS_DT_decAmount,
p_decRemain BOS_DT_decAmount,
p_szDescription BOS_DT_szDescription,
p_bClosed bit,
p_dtmClosed timestamp,
p_szUrl BOS_DT_szUrl,
p_szFInvoiceStatus varchar,
p_szInvWorkplaceId BOS_DT_szId,
p_szRefTrnId BOS_DT_szMediumId,
p_szRefDocId BOS_DT_szId,
p_bCash bit,
p_dtmDue timestamp,
p_dtmDue_Printed timestamp,
p_szFInvoiceType BOS_DT_szSmallId,
p_szFInvoiceUsage varchar,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AP_ApTrans
(
szTrnId,
szDocId,
szSuppId,
shRevNo,
dtmDate,
dtmPeriode,
szCcyId,
decAmount,
decRemain,
szDescription,
bClosed,
dtmClosed,
szUrl,
szFInvoiceStatus,
szInvWorkplaceId,
szRefTrnId,
szRefDocId,
bCash,
dtmDue,
dtmDue_Printed,
szFInvoiceType,
szFInvoiceUsage,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szTrnId,
p_szDocId,
p_szSuppId,
p_shRevNo,
p_dtmDate,
p_dtmPeriode,
p_szCcyId,
p_decAmount,
p_decRemain,
p_szDescription,
p_bClosed,
p_dtmClosed,
p_szUrl,
p_szFInvoiceStatus,
p_szInvWorkplaceId,
p_szRefTrnId,
p_szRefDocId,
p_bCash,
p_dtmDue,
p_dtmDue_Printed,
p_szFInvoiceType,
p_szFInvoiceUsage,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_CreateApTransRefDoc(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint,
p_shItemNumber smallint,
p_szRefTrnId BOS_DT_szMediumId,
p_szRefDocId BOS_DT_szId,
p_szRefSuppId BOS_DT_szId,
p_shRefRevNo smallint,
p_decAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AP_ApTransRefDoc
(
szTrnId,
szDocId,
szSuppId,
shRevNo,
shItemNumber,
szRefTrnId,
szRefDocId,
szRefSuppId,
shRefRevNo,
decAmount
)
VALUES
(
p_szTrnId,
p_szDocId,
p_szSuppId,
p_shRevNo,
p_shItemNumber,
p_szRefTrnId,
p_szRefDocId,
p_szRefSuppId,
p_shRefRevNo,
p_decAmount
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_CreateApTransRefDoc_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint,
p_shItemNumber smallint,
p_szRefTrnId BOS_DT_szMediumId,
p_szRefDocId BOS_DT_szId,
p_szRefSuppId BOS_DT_szId,
p_shRefRevNo smallint,
p_decAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AP_ApTransRefDoc
(
szTrnId,
szDocId,
szSuppId,
shRevNo,
shItemNumber,
szRefTrnId,
szRefDocId,
szRefSuppId,
shRefRevNo,
decAmount
)
VALUES
(
p_szTrnId,
p_szDocId,
p_szSuppId,
p_shRevNo,
p_shItemNumber,
p_szRefTrnId,
p_szRefDocId,
p_szRefSuppId,
p_shRefRevNo,
p_decAmount
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_DebitAp(
p_szSuppId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_decDebitAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_ApMaster
SET 
decAmount = decAmount + p_decDebitAmount
WHERE 
szSuppId = p_szSuppId And szCcyId = p_szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_DebitAp_013(
p_szSuppId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_decDebitAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_ApMaster
SET 
decAmount = decAmount + p_decDebitAmount
WHERE 
szSuppId = p_szSuppId And szCcyId = p_szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_DeleteApMaster(
p_szSuppId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_AP_ApMaster
WHERE
szSuppId = p_szSuppId And szCcyId = p_szCcyId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_DeleteApTrans(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_AP_ApTrans
WHERE
szTrnId = p_szTrnId And szDocId = p_szDocId And szSuppId = p_szSuppId And shRevNo = p_shRevNo;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_DeleteApTrans_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_AP_ApTrans
WHERE
szTrnId = p_szTrnId And szDocId = p_szDocId And szSuppId = p_szSuppId And shRevNo = p_shRevNo;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_DeleteApTransRefDoc(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_AP_ApTransRefDoc
WHERE
szTrnId = p_szTrnId And szDocId = p_szDocId And szSuppId = p_szSuppId And shRevNo = p_shRevNo;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_DeleteApTransRefDoc_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_AP_ApTransRefDoc
WHERE
szTrnId = p_szTrnId And szDocId = p_szDocId And szSuppId = p_szSuppId And shRevNo = p_shRevNo;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_FlagApBad(
p_szSuppId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_bBad bit)
RETURNS void AS
$BODY$
BEGIN

If p_szCcyId = ''
  THEN
Begin
Update
BOS_AP_ApMaster
Set
bBad = p_bBad
Where
szSuppId = p_szSuppId;
End; 
Else
Begin
Update
BOS_AP_ApMaster
Set
bBad = p_bBad
Where
szSuppId = p_szSuppId And szCcyId = p_szCcyId;
End;

END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetApHistory(
p_szSuppId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_bUnclosedOnly bit)
RETURNS void AS
$BODY$
BEGIN

IF p_bUnclosedOnly = 1
  THEN

Select
BAA.szTrnId,
BAA.szDocId,
BAA.shRevNo,
BAA.dtmDate,
BAA.decAmount,
BAA.decRemain,
BAA.szDescription,
BAA.bClosed,
BAA.dtmClosed,
BAA.szUrl,
BAA.szFInvoiceStatus,
BAA.szInvWorkplaceId,
BAA.szRefTrnId,
BAA.szRefDocId,
BAA.bCash,
BAA.dtmDue,
BAA.dtmDue_Printed,
BAA.dtmPeriode

From
BOS_AP_ApTrans AS BAA
Where
BAA.szSuppId = p_szSuppId And
BAA.szCcyId = p_szCcyId And
BAA.dtmDate >= p_dtmStart And BAA.dtmDate < DateAdd(Day, 1, p_dtmEnd)
AND BAA.bClosed = 0

ORDER BY
BAA.dtmDate, 
BAA.szTrnId,
BAA.szDocId,
BAA.shRevNo;

ELSE

Select
BAA.szTrnId,
BAA.szDocId,
BAA.shRevNo,
BAA.dtmDate,
BAA.decAmount,
BAA.decRemain,
BAA.szDescription,
BAA.bClosed,
BAA.dtmClosed,
BAA.szUrl,
BAA.szFInvoiceStatus,
BAA.szInvWorkplaceId,
BAA.szRefTrnId,
BAA.szRefDocId,
BAA.bCash,
BAA.dtmDue,
BAA.dtmDue_Printed,
BAA.dtmPeriode

From
BOS_AP_ApTrans AS BAA

Where
BAA.szSuppId = p_szSuppId And
BAA.szCcyId = p_szCcyId And
BAA.dtmDate >= p_dtmStart And BAA.dtmDate < DateAdd(Day, 1, p_dtmEnd)

ORDER BY
BAA.dtmDate, 
BAA.szTrnId,
BAA.szDocId,
BAA.shRevNo;

END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetApHistory_014(
p_szSuppId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_bUnclosedOnly bit)
RETURNS void AS
$BODY$
BEGIN

IF p_bUnclosedOnly = 1
  THEN

Select
BAA.szTrnId,
BAA.szDocId,
BAA.shRevNo,
BAA.dtmDate,
BAA.decAmount,
BAA.decRemain,
BAA.szDescription,
BAA.bClosed,
BAA.dtmClosed,
BAA.szUrl,
BAA.szFInvoiceStatus,
BAA.szInvWorkplaceId,
BAA.szRefTrnId,
BAA.szRefDocId,
BAA.bCash,
BAA.dtmDue,
BAA.dtmDue_Printed,
BAA.dtmPeriode

From
BOS_AP_ApTrans AS BAA
Where
BAA.szSuppId = p_szSuppId And
BAA.szCcyId = p_szCcyId And
BAA.dtmDate >= p_dtmStart And BAA.dtmDate < DateAdd(Day, 1, p_dtmEnd)
AND BAA.bClosed = 0

ORDER BY
BAA.dtmDate, 
BAA.szTrnId,
BAA.szDocId,
BAA.shRevNo;

ELSE

Select
BAA.szTrnId,
BAA.szDocId,
BAA.shRevNo,
BAA.dtmDate,
BAA.decAmount,
BAA.decRemain,
BAA.szDescription,
BAA.bClosed,
BAA.dtmClosed,
BAA.szUrl,
BAA.szFInvoiceStatus,
BAA.szInvWorkplaceId,
BAA.szRefTrnId,
BAA.szRefDocId,
BAA.bCash,
BAA.dtmDue,
BAA.dtmDue_Printed,
BAA.dtmPeriode

From
BOS_AP_ApTrans AS BAA

Where
BAA.szSuppId = p_szSuppId And
BAA.szCcyId = p_szCcyId And
BAA.dtmDate >= p_dtmStart And BAA.dtmDate < DateAdd(Day, 1, p_dtmEnd)

ORDER BY
BAA.dtmDate, 
BAA.szTrnId,
BAA.szDocId,
BAA.shRevNo;


END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetApTrans(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
Select
BOS_AP_ApTrans.szSuppId,
IsNull(BOS_AP_Supplier.szName, '') As szSuppNm,
BOS_AP_ApTrans.dtmDate,
BOS_AP_ApTrans.dtmPeriode,
BOS_AP_ApTrans.szCcyId,
BOS_CU_Currency.szAmountFormat,
BOS_AP_ApTrans.decAmount,
BOS_AP_ApTrans.decRemain,
BOS_AP_ApTrans.szDescription,
BOS_AP_ApTrans.bClosed,
BOS_AP_ApTrans.dtmClosed,
BOS_AP_ApTrans.szUrl,
BOS_AP_ApTrans.szFInvoiceStatus,
BOS_AP_ApTrans.szInvWorkplaceId,
BOS_AP_ApTrans.szRefTrnId,
BOS_AP_ApTrans.szRefDocId,
BOS_AP_ApTrans.bCash,
BOS_AP_ApTrans.dtmDue,
BOS_AP_ApTrans.dtmDue_Printed,
BOS_AP_Supplier.szPaymentTermId AS szPaymentTermId_J,
BOS_AP_ApTrans.szFInvoiceType,
BOS_AP_ApTrans.szFInvoiceUsage,

BOS_AP_ApTrans.dtmLastUpdated,
BOS_AP_ApTrans.bAlreadyTransferred

From
BOS_AP_ApTrans
LEFT JOIN BOS_AP_Supplier ON BOS_AP_Supplier.szSuppId = BOS_AP_ApTrans.szSuppId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AP_ApTrans.szCcyId

Where
BOS_AP_ApTrans.szTrnId = p_szTrnId And BOS_AP_ApTrans.szDocId = p_szDocId And BOS_AP_ApTrans.szSuppId LIKE p_szSuppId And BOS_AP_ApTrans.shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetApTrans_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
Select
BOS_AP_ApTrans.szSuppId,
IsNull(BOS_AP_Supplier.szName, '') As szSuppNm,
BOS_AP_ApTrans.dtmDate,
BOS_AP_ApTrans.dtmPeriode,
BOS_AP_ApTrans.szCcyId,
BOS_CU_Currency.szAmountFormat,
BOS_AP_ApTrans.decAmount,
BOS_AP_ApTrans.decRemain,
BOS_AP_ApTrans.szDescription,
BOS_AP_ApTrans.bClosed,
BOS_AP_ApTrans.dtmClosed,
BOS_AP_ApTrans.szUrl,
BOS_AP_ApTrans.szFInvoiceStatus,
BOS_AP_ApTrans.szInvWorkplaceId,
BOS_AP_ApTrans.szRefTrnId,
BOS_AP_ApTrans.szRefDocId,
BOS_AP_ApTrans.bCash,
BOS_AP_ApTrans.dtmDue,
BOS_AP_ApTrans.dtmDue_Printed,
BOS_AP_Supplier.szPaymentTermId AS szPaymentTermId_J,
BOS_AP_ApTrans.szFInvoiceType,
BOS_AP_ApTrans.szFInvoiceUsage,

BOS_AP_ApTrans.dtmLastUpdated,
BOS_AP_ApTrans.bAlreadyTransferred

From
BOS_AP_ApTrans
LEFT JOIN BOS_AP_Supplier ON BOS_AP_Supplier.szSuppId = BOS_AP_ApTrans.szSuppId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AP_ApTrans.szCcyId

Where
BOS_AP_ApTrans.szTrnId = p_szTrnId And BOS_AP_ApTrans.szDocId = p_szDocId And BOS_AP_ApTrans.szSuppId LIKE p_szSuppId And BOS_AP_ApTrans.shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetApTransRefDoc(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRefTrnId,
szRefDocId,
szRefSuppId,
shRefRevNo,
decAmount

FROM 
BOS_AP_ApTransRefDoc
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szSuppId = p_szSuppId And shRevNo = p_shRevNo ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetApTransRefDoc_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRefTrnId,
szRefDocId,
szRefSuppId,
shRefRevNo,
decAmount

FROM 
BOS_AP_ApTransRefDoc
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szSuppId = p_szSuppId And shRevNo = p_shRevNo ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetLastRevNo(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
Max(shRevNo) As shLastRevNo

FROM 
BOS_AP_ApTrans
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szSuppId LIKE p_szSuppId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetLastRevNo_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
Max(shRevNo) As shLastRevNo

FROM 
BOS_AP_ApTrans
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szSuppId LIKE p_szSuppId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetListOfApMaster(
p_szSuppId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_szInvWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AP_ApMaster.szSuppId,
BOS_AP_ApMaster.szCcyId


FROM 
BOS_AP_ApMaster
LEFT JOIN BOS_AP_Supplier AS Supp ON Supp.szSuppId = BOS_AP_ApMaster.szSuppIdLEFT JOIN BOS_AP_Supplier AS Supp ON Supp.szSuppId = BOS_AP_ApMaster.szSuppId
WHERE 
BOS_AP_ApMaster.szSuppId like p_szSuppId And BOS_AP_ApMaster.szCcyId like p_szCcyId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetListOfApMasterData(
p_szSuppId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AP_ApMaster.szSuppId,
BOS_AP_ApMaster.szCcyId,

BOS_AP_Supplier.szName As szSuppNm,
BOS_AP_Supplier.szStatus AS szSuppStatus_J,

BOS_AP_ApMaster.decAmount,
AMC.decAmount AS decApClassAmount,

BOS_CU_Currency.szSymbol as szCcySymbol,
BOS_CU_Currency.szAmountFormat,
BOS_AP_ApMaster.bBad,

-- Data Status.
BOS_AP_ApMaster.dtmLastUpdated,
BOS_AP_ApMaster.bAlreadyTransferred,

BOS_AP_Supplier.szDefaultCcyId AS szSuppDefaultCcyId_J,
BOS_AP_Supplier.decCreditLimit AS decSuppCreditLimit_J,

BOS_AP_Supplier.decCreditLimit AS decSuppApClassCreditLimit_J


FROM 
BOS_AP_ApMaster
Left Join BOS_AP_Supplier On BOS_AP_Supplier.szSuppId = BOS_AP_ApMaster.szSuppId
Left Join BOS_CU_Currency On BOS_CU_Currency.szCcyId = BOS_AP_ApMaster.szCcyId
LEFT JOIN BOS_AP_ApMasterClass AS AMC ON AMC.szSuppId = BOS_AP_ApMaster.szSuppIdLEFT JOIN BOS_AP_ApMasterClass AS AMC ON AMC.szSuppId = BOS_AP_ApMaster.szSuppId
AND AMC.szCcyId = BOS_AP_ApMaster.szCcyId

WHERE 
BOS_AP_ApMaster.szSuppId LIKE p_szSuppId And BOS_AP_ApMaster.szCcyId LIKE p_szCcyId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetListOfApMasterData_014(
p_szSuppId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AP_ApMaster.szSuppId,
BOS_AP_ApMaster.szCcyId,

BOS_AP_Supplier.szName As szSuppNm,
BOS_AP_Supplier.szStatus AS szSuppStatus_J,

BOS_AP_ApMaster.decAmount,
AMC.decAmount AS decApClassAmount,

BOS_CU_Currency.szSymbol as szCcySymbol,
BOS_CU_Currency.szAmountFormat,
BOS_AP_ApMaster.bBad,

-- Data Status.
BOS_AP_ApMaster.dtmLastUpdated,
BOS_AP_ApMaster.bAlreadyTransferred,

BOS_AP_Supplier.szDefaultCcyId AS szSuppDefaultCcyId_J,
BOS_AP_Supplier.decCreditLimit AS decSuppCreditLimit_J,

BOS_AP_Supplier.decCreditLimit AS decSuppApClassCreditLimit_J


FROM 
BOS_AP_ApMaster
Left Join BOS_AP_Supplier On BOS_AP_Supplier.szSuppId = BOS_AP_ApMaster.szSuppId
Left Join BOS_CU_Currency On BOS_CU_Currency.szCcyId = BOS_AP_ApMaster.szCcyId
LEFT JOIN BOS_AP_ApMasterClass AS AMC ON AMC.szSuppId = BOS_AP_ApMaster.szSuppIdLEFT JOIN BOS_AP_ApMasterClass AS AMC ON AMC.szSuppId = BOS_AP_ApMaster.szSuppId
AND AMC.szCcyId = BOS_AP_ApMaster.szCcyId

WHERE 
BOS_AP_ApMaster.szSuppId LIKE p_szSuppId And BOS_AP_ApMaster.szCcyId LIKE p_szCcyId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetListOfApMasterSupp(
p_szSuppId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
BOS_AP_ApMaster.szSuppId

FROM 
BOS_AP_ApMaster
Left Join BOS_AP_Supplier On BOS_AP_Supplier.szSuppId = BOS_AP_ApMaster.szSuppId
WHERE 
BOS_AP_ApMaster.szSuppId like p_szSuppId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetListOfApTrans()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szTrnId,
szDocId,
szSuppId,
shRevNo

FROM 
BOS_AP_ApTrans;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetListOfApTransThatIsPayedByMe(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AP_ApTransRefDoc.szRefTrnId,
BOS_AP_ApTransRefDoc.szRefDocId,
BOS_AP_ApTransRefDoc.szRefSuppId,
BOS_AP_ApTransRefDoc.shRefRevno


FROM 
BOS_AP_ApTransRefDoc

WHERE 
BOS_AP_ApTransRefDoc.szTrnId = p_szTrnId and BOS_AP_ApTransRefDoc.szDocId = p_szDocId AND BOS_AP_ApTransRefDoc.szSuppId LIKE p_szSuppId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetListOfApTransThatIsPayedByMe_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AP_ApTransRefDoc.szRefTrnId,
BOS_AP_ApTransRefDoc.szRefDocId,
BOS_AP_ApTransRefDoc.szRefSuppId,
BOS_AP_ApTransRefDoc.shRefRevno


FROM 
BOS_AP_ApTransRefDoc

WHERE 
BOS_AP_ApTransRefDoc.szTrnId = p_szTrnId and BOS_AP_ApTransRefDoc.szDocId = p_szDocId AND BOS_AP_ApTransRefDoc.szSuppId LIKE p_szSuppId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetListOfApTransThatPayMe(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AP_ApTransRefDoc.szTrnId,
BOS_AP_ApTransRefDoc.szDocId,
BOS_AP_ApTransRefDoc.szSuppId,
BOS_AP_ApTransRefDoc.shRevno


FROM 
BOS_AP_ApTransRefDoc
WHERE 
BOS_AP_ApTransRefDoc.szRefTrnId = p_szTrnId AND BOS_AP_ApTransRefDoc.szRefDocId = p_szDocId AND BOS_AP_ApTransRefDoc.szRefSuppId LIKE p_szSuppId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetListOfApTransThatPayMe_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AP_ApTransRefDoc.szTrnId,
BOS_AP_ApTransRefDoc.szDocId,
BOS_AP_ApTransRefDoc.szSuppId,
BOS_AP_ApTransRefDoc.shRevno


FROM 
BOS_AP_ApTransRefDoc
WHERE 
BOS_AP_ApTransRefDoc.szRefTrnId = p_szTrnId AND BOS_AP_ApTransRefDoc.szRefDocId = p_szDocId AND BOS_AP_ApTransRefDoc.szRefSuppId LIKE p_szSuppId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetListOfApTransThatPayMeIncludingMyself(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
art.szTrnId, art.szDocId, art.szSuppId, art.shRevNo

FROM 
BOS_AP_ApTrans As art

Left Join BOS_AP_ApTransRefDoc As artrd On
artrd.szTrnId = art.szTrnId and artrd.szDocId = art.szDocId and artrd.szSuppId = art.szSuppId and artrd.shRevNo = art.shRevNo

WHERE 
(art.szTrnId = p_szTrnId and art.szDocId = p_szDocId and art.szSuppId = p_szSuppId and art.shRevNo = p_shRevNo) or (artrd.szRefTrnId = p_szTrnId and artrd.szRefDocId = p_szDocId and artrd.szRefSuppId = p_szSuppId and artrd.shRefRevNo = p_shRevNo) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetListOfApTransThatPayMeIncludingMyself_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
art.szTrnId, art.szDocId, art.szSuppId, art.shRevNo

FROM 
BOS_AP_ApTrans As art

Left Join BOS_AP_ApTransRefDoc As artrd On
artrd.szTrnId = art.szTrnId and artrd.szDocId = art.szDocId and artrd.szSuppId = art.szSuppId and artrd.shRevNo = art.shRevNo

WHERE 
(art.szTrnId = p_szTrnId and art.szDocId = p_szDocId and art.szSuppId = p_szSuppId and art.shRevNo = p_shRevNo) or (artrd.szRefTrnId = p_szTrnId and artrd.szRefDocId = p_szDocId and artrd.szRefSuppId = p_szSuppId and artrd.shRefRevNo = p_shRevNo) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetOldestAgingApOfSupp(
p_szInvSuppId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BAT.dtmPeriode

FROM 
BOS_AP_ApTrans As BAT
Left Join BOS_AP_Supplier As BAC On BAT.szSuppId = BAC.szSuppId

WHERE 
BAT.bClosed = 0 And BAT.szSuppId Like p_szInvSuppId And (BAT.szTrnId = 'FInv' Or BAT.szTrnId = 'PDREC') 
ORDER BY 
BAT.dtmPeriode
LIMIT 1;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_GetOldestAgingApOfSupp_014(
p_szInvSuppId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BAT.dtmPeriode

FROM 
BOS_AP_ApTrans As BAT
Left Join BOS_AP_Supplier As BAC On BAT.szSuppId = BAC.szSuppId

WHERE 
BAT.bClosed = 0 And BAT.szSuppId Like p_szInvSuppId And (BAT.szTrnId = 'FInv' Or BAT.szTrnId = 'PDREC') 
ORDER BY 
BAT.dtmPeriode

LIMIT 1;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_IsApMasterExist(
p_szSuppId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szSuppId,
szCcyId

FROM 
BOS_AP_ApMaster
WHERE 
szSuppId = p_szSuppId And szCcyId = p_szCcyId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_IsApTransClosed(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
bClosed

FROM 
BOS_AP_ApTrans
WHERE 
 szTrnId = p_szTrnId And szDocId = p_szDocId And szSuppId like p_szSuppId And shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_IsApTransClosed_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
bClosed

FROM 
BOS_AP_ApTrans
WHERE 
 szTrnId = p_szTrnId And szDocId = p_szDocId And szSuppId like p_szSuppId And shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_IsApTransExist(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szTrnId

FROM 
BOS_AP_ApTrans
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szSuppId like p_szSuppId And shRevNo = p_shRevNo ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_IsApTransExist_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szTrnId

FROM 
BOS_AP_ApTrans
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szSuppId like p_szSuppId And shRevNo = p_shRevNo ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_LockApMaster(
p_szSuppId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_ApMaster
SET 
decAmount = decAmount
WHERE 
szSuppId = p_szSuppId And szCcyId = p_szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_LockApTrans(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_ApTrans
SET 
szDescription = szDescription
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szSuppId = p_szSuppId And shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_LockApTrans_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_ApTrans
SET 
szDescription = szDescription
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szSuppId = p_szSuppId And shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_UpdateApMaster(
p_szSuppId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_decAmount BOS_DT_decAmount,
p_bBad bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_ApMaster
SET 
decAmount = p_decAmount,
bBad = p_bBad
WHERE 
szSuppId = p_szSuppId And szCcyId = p_szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_UpdateApMaster_014(
p_szSuppId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_decAmount BOS_DT_decAmount,
p_bBad bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_ApMaster
SET 
decAmount = p_decAmount,
bBad = p_bBad
WHERE 
szSuppId = p_szSuppId And szCcyId = p_szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_UpdateFInvoiceStatusOnAp(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szFInvoiceStatus varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_ApTrans
SET 
 szFInvoiceStatus = p_szFInvoiceStatus
WHERE 
 szTrnId = p_szTrnId And szDocId = p_szDocId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Ap_UpdateFInvoiceStatusOnAp_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szFInvoiceStatus varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_ApTrans
SET 
 szFInvoiceStatus = p_szFInvoiceStatus
WHERE 
 szTrnId = p_szTrnId And szDocId = p_szDocId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_CountUnAppliedFSupplierPayment(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
count(szFSupplierPayment_sId) as iPaymentCount

FROM 
BOS_AP_FSupplierPayment_s
WHERE 
bVoid = 0 AND bApplied = 0 AND dtmFSupplierPayment >= p_dtmFrom AND dtmFSupplierPayment < DATEADD(DAY, 1, p_dtmTo) AND BOS_AP_FSupplierPayment_s.szDeposanId LIKE p_szOpUserId AND BOS_AP_FSupplierPayment_s.szWorkplaceId LIKE p_szWorkplaceId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_CreateFSupplierPayment(
p_szFSupplierPayment_sId BOS_DT_szId,
p_dtmFSupplierPayment timestamp,
p_szFCashReceiptId BOS_DT_szId,
p_szDeposanId BOS_DT_szId,
p_szAccountId1 BOS_DT_szId,
p_szSubAccountId1 BOS_DT_szGLAccount,
p_decAmount1 BOS_DT_decAmount,
p_szAccountId2 BOS_DT_szId,
p_szSubAccountId2 BOS_DT_szGLAccount,
p_decAmount2 BOS_DT_decAmount,
p_szAccountId3 BOS_DT_szId,
p_szSubAccountId3 BOS_DT_szGLAccount,
p_decAmount3 BOS_DT_decAmount,
p_szAccountId4 BOS_DT_szId,
p_szSubAccountId4 BOS_DT_szGLAccount,
p_decAmount4 BOS_DT_decAmount,
p_decAmount BOS_DT_decAmount,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_szRemark BOS_DT_szDescription,
p_szCashAccountId BOS_DT_szId,
p_szCashGlSubAccountId BOS_DT_szGLAccount,
p_szApAccountId BOS_DT_szId,
p_szApGlSubAccountId BOS_DT_szGLAccount,
p_decControlAmount BOS_DT_decAmount,
p_szChequeId BOS_DT_szId,
p_szFCashTrnId BOS_DT_szId,
p_szFCashDocId BOS_DT_szId,
p_szVoucherId BOS_DT_szId,
p_apInvoiceAmountReturn numeric,
p_apInvoiceIdReturn BOS_DT_szId,
p_supplierDisbursementId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AP_FSupplierPayment_s
(
szFSupplierPayment_sId,
dtmFSupplierPayment,
szFCashReceiptId,
szDeposanId,
szAccountId1,
szSubAccountId1,
decAmount1,
szAccountId2,
szSubAccountId2,
decAmount2,
szAccountId3,
szSubAccountId3,
decAmount3,
szAccountId4,
szSubAccountId4,
decAmount4,
decAmount,
szCcyId,
szCcyRateId,
szRemark,
szCashAccountId,
szCashGlSubAccountId,
szApAccountId,
szApGlSubAccountId,
decControlAmount,
szChequeId,
szFCashTrnId,
szFCashDocId,
szVoucherId,
apInvoiceAmountReturn,
apInvoiceIdReturn,
supplierDisbursementId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFSupplierPayment_sId,
p_dtmFSupplierPayment,
p_szFCashReceiptId,
p_szDeposanId,
p_szAccountId1,
p_szSubAccountId1,
p_decAmount1,
p_szAccountId2,
p_szSubAccountId2,
p_decAmount2,
p_szAccountId3,
p_szSubAccountId3,
p_decAmount3,
p_szAccountId4,
p_szSubAccountId4,
p_decAmount4,
p_decAmount,
p_szCcyId,
p_szCcyRateId,
p_szRemark,
p_szCashAccountId,
p_szCashGlSubAccountId,
p_szApAccountId,
p_szApGlSubAccountId,
p_decControlAmount,
p_szChequeId,
p_szFCashTrnId,
p_szFCashDocId,
p_szVoucherId,
p_apInvoiceAmountReturn,
p_apInvoiceIdReturn,
p_supplierDisbursementId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_CreateFSupplierPayment_013(
p_szFSupplierPayment_sId BOS_DT_szId,
p_dtmFSupplierPayment timestamp,
p_szFCashReceiptId BOS_DT_szId,
p_szDeposanId BOS_DT_szId,
p_szAccountId1 BOS_DT_szId,
p_szSubAccountId1 BOS_DT_szGLAccount,
p_decAmount1 BOS_DT_decAmount,
p_szAccountId2 BOS_DT_szId,
p_szSubAccountId2 BOS_DT_szGLAccount,
p_decAmount2 BOS_DT_decAmount,
p_szAccountId3 BOS_DT_szId,
p_szSubAccountId3 BOS_DT_szGLAccount,
p_decAmount3 BOS_DT_decAmount,
p_szAccountId4 BOS_DT_szId,
p_szSubAccountId4 BOS_DT_szGLAccount,
p_decAmount4 BOS_DT_decAmount,
p_decAmount BOS_DT_decAmount,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_szRemark BOS_DT_szDescription,
p_szCashAccountId BOS_DT_szId,
p_szCashGlSubAccountId BOS_DT_szGLAccount,
p_szApAccountId BOS_DT_szId,
p_szApGlSubAccountId BOS_DT_szGLAccount,
p_decControlAmount BOS_DT_decAmount,
p_szChequeId BOS_DT_szId,
p_szFCashTrnId BOS_DT_szId,
p_szFCashDocId BOS_DT_szId,
p_szVoucherId BOS_DT_szId,
p_apInvoiceAmountReturn numeric,
p_apInvoiceIdReturn BOS_DT_szId,
p_supplierDisbursementId BOS_DT_szId,
p_purchaseTypeId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AP_FSupplierPayment_s
(
szFSupplierPayment_sId,
dtmFSupplierPayment,
szFCashReceiptId,
szDeposanId,
szAccountId1,
szSubAccountId1,
decAmount1,
szAccountId2,
szSubAccountId2,
decAmount2,
szAccountId3,
szSubAccountId3,
decAmount3,
szAccountId4,
szSubAccountId4,
decAmount4,
decAmount,
szCcyId,
szCcyRateId,
szRemark,
szCashAccountId,
szCashGlSubAccountId,
szApAccountId,
szApGlSubAccountId,
decControlAmount,
szChequeId,
szFCashTrnId,
szFCashDocId,
szVoucherId,
apInvoiceAmountReturn,
apInvoiceIdReturn,
supplierDisbursementId,
purchaseTypeId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFSupplierPayment_sId,
p_dtmFSupplierPayment,
p_szFCashReceiptId,
p_szDeposanId,
p_szAccountId1,
p_szSubAccountId1,
p_decAmount1,
p_szAccountId2,
p_szSubAccountId2,
p_decAmount2,
p_szAccountId3,
p_szSubAccountId3,
p_decAmount3,
p_szAccountId4,
p_szSubAccountId4,
p_decAmount4,
p_decAmount,
p_szCcyId,
p_szCcyRateId,
p_szRemark,
p_szCashAccountId,
p_szCashGlSubAccountId,
p_szApAccountId,
p_szApGlSubAccountId,
p_decControlAmount,
p_szChequeId,
p_szFCashTrnId,
p_szFCashDocId,
p_szVoucherId,
p_apInvoiceAmountReturn,
p_apInvoiceIdReturn,
p_supplierDisbursementId,
p_purchaseTypeId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_CreateFSupplierPaymentItem(
p_szFSupplierPayment_sId BOS_DT_szId,
p_shItemNumber smallint,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_decPaidByCashReceipt BOS_DT_decAmount,
p_szFDoId BOS_DT_szId,
p_remain_s BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AP_FSupplierPayment_s_Item
(
szFSupplierPayment_sId,
shItemNumber,
szTrnId,
szDocId,
szSuppId,
decAmount,
decPaidByCashReceipt,
szFDoId,
remain_s
)
VALUES
(
p_szFSupplierPayment_sId,
p_shItemNumber,
p_szTrnId,
p_szDocId,
p_szSuppId,
p_decAmount,
p_decPaidByCashReceipt,
p_szFDoId,
p_remain_s
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_CreateFSupplierPaymentItem_013(
p_szFSupplierPayment_sId BOS_DT_szId,
p_shItemNumber smallint,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szSuppId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_decPaidByCashReceipt BOS_DT_decAmount,
p_szFDoId BOS_DT_szId,
p_remain_s BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AP_FSupplierPayment_s_Item
(
szFSupplierPayment_sId,
shItemNumber,
szTrnId,
szDocId,
szSuppId,
decAmount,
decPaidByCashReceipt,
szFDoId,
remain_s
)
VALUES
(
p_szFSupplierPayment_sId,
p_shItemNumber,
p_szTrnId,
p_szDocId,
p_szSuppId,
p_decAmount,
p_decPaidByCashReceipt,
p_szFDoId,
p_remain_s
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_CreateFSupplierPaymentItemDetail(
p_szFSupplierPayment_sId BOS_DT_szId,
p_shItemNumber smallint,
p_shDetailNumber smallint,
p_szBankId BOS_DT_szId,
p_szRefDocId BOS_DT_szId,
p_bValue smallint,
p_decAmount BOS_DT_decAmount,
p_bDeposit smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AP_FSupplierPayment_s_ItemDetail
(
szFSupplierPayment_sId,
shItemNumber,
shDetailNumber,
szBankId,
szRefDocId,
bValue,
decAmount,
bDeposit
)
VALUES
(
p_szFSupplierPayment_sId,
p_shItemNumber,
p_shDetailNumber,
p_szBankId,
p_szRefDocId,
p_bValue,
p_decAmount,
p_bDeposit
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_DeleteFSupplierPayment(
p_szFSupplierPayment_sId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_AP_FSupplierPayment_s
WHERE
 szFSupplierPayment_sId = p_szFSupplierPayment_sId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_DeleteFSupplierPaymentItem(
p_szFSupplierPayment_sId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_AP_FSupplierPayment_s_Item
WHERE
 szFSupplierPayment_sId = p_szFSupplierPayment_sId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_DeleteFSupplierPaymentItemDetail(
p_szFSupplierPayment_sId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_AP_FSupplierPayment_s_ItemDetail
WHERE
 szFSupplierPayment_sId = p_szFSupplierPayment_sId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_GetAmountOfUnsettledPdr(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szFSupplierPayment_sId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
sum(BOS_AP_FSupplierPaymentItem_s_Detail.decAmount) as decAmount

FROM 
BOS_AP_FSupplierPayment_s
Inner Join BOS_AP_FSupplierPayment_s_Item On BOS_AP_FSupplierPayment_s.szFSupplierPayment_sId = BOS_AP_FSupplierPayment_s_Item.szFSupplierPayment_sId
Inner Join BOS_AP_FSupplierPaymentItem_s_Detail On BOS_AP_FSupplierPayment_s_Item.szFSupplierPayment_sId = BOS_AP_FSupplierPaymentItem_s_Detail.szFSupplierPayment_sId And
BOS_AP_FSupplierPayment_s_Item.shItemNumber = BOS_AP_FSupplierPaymentItem_s_Detail.shItemNumber
Left Join BOS_CAS_Pdr on
BOS_CAS_Pdr.szBankId = BOS_AP_FSupplierPaymentItem_s_Detail.szBankId and
BOS_CAS_Pdr.szRefId = BOS_AP_FSupplierPaymentItem_s_Detail.szRefDocId
WHERE 
BOS_AP_FSupplierPayment_s_Item.szTrnId = p_szTrnId And BOS_AP_FSupplierPayment_s_Item.szDocId = p_szDocId And BOS_AP_FSupplierPayment_s.bApplied = 1 and BOS_AP_FSupplierPaymentItem_s_Detail.bValue = 0 and BOS_CAS_Pdr.szStatus <> 'CLE' and BOS_CAS_Pdr.szStatus <> 'REJ' and BOS_AP_FSupplierPayment_s.szFSupplierPayment_sId <> p_szFSupplierPayment_sId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_GetAmountOfUnsettledPdr_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szFSupplierPayment_sId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
sum(BOS_AP_FSupplierPaymentItem_s_Detail.decAmount) as decAmount

FROM 
BOS_AP_FSupplierPayment_s
Inner Join BOS_AP_FSupplierPayment_s_Item On BOS_AP_FSupplierPayment_s.szFSupplierPayment_sId = BOS_AP_FSupplierPayment_s_Item.szFSupplierPayment_sId
Inner Join BOS_AP_FSupplierPaymentItem_s_Detail On BOS_AP_FSupplierPayment_s_Item.szFSupplierPayment_sId = BOS_AP_FSupplierPaymentItem_s_Detail.szFSupplierPayment_sId And
BOS_AP_FSupplierPayment_s_Item.shItemNumber = BOS_AP_FSupplierPaymentItem_s_Detail.shItemNumber
Left Join BOS_CAS_Pdr on
BOS_CAS_Pdr.szBankId = BOS_AP_FSupplierPaymentItem_s_Detail.szBankId and
BOS_CAS_Pdr.szRefId = BOS_AP_FSupplierPaymentItem_s_Detail.szRefDocId
WHERE 
BOS_AP_FSupplierPayment_s_Item.szTrnId = p_szTrnId And BOS_AP_FSupplierPayment_s_Item.szDocId = p_szDocId And BOS_AP_FSupplierPayment_s.bApplied = 1 and BOS_AP_FSupplierPaymentItem_s_Detail.bValue = 0 and BOS_CAS_Pdr.szStatus <> 'CLE' and BOS_CAS_Pdr.szStatus <> 'REJ' and BOS_AP_FSupplierPayment_s.szFSupplierPayment_sId <> p_szFSupplierPayment_sId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_GetFSupplierPayment(
p_szFSupplierPayment_sId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
Select
BOS_AP_FSupplierPayment_s.dtmFSupplierPayment,
BOS_AP_FSupplierPayment_s.szFCashReceiptId,
BOS_AP_FSupplierPayment_s.szDeposanId,
BOS_PI_Employee.szName as szDeposanNm,

BOS_AP_FSupplierPayment_s.szAccountId1,
BOS_AP_FSupplierPayment_s.szSubAccountId1,
BOS_AP_FSupplierPayment_s.decAmount1,

BOS_AP_FSupplierPayment_s.szAccountId2,
BOS_AP_FSupplierPayment_s.szSubAccountId2,
BOS_AP_FSupplierPayment_s.decAmount2,

BOS_AP_FSupplierPayment_s.szAccountId3,
BOS_AP_FSupplierPayment_s.szSubAccountId3,
BOS_AP_FSupplierPayment_s.decAmount3,

BOS_AP_FSupplierPayment_s.szAccountId4,
BOS_AP_FSupplierPayment_s.szSubAccountId4,
BOS_AP_FSupplierPayment_s.decAmount4,
Acc1.szName as szAccName1_J,
SubAcc1.szDescription as szSubAccName1_J,
Acc2.szName as szAccName2_J,
SubAcc2.szDescription as szSubAccName2_J,
Acc3.szName as szAccName3_J,
SubAcc3.szDescription as szSubAccName3_J,
Acc4.szName as szAccName4_J,
SubAcc4.szDescription as szSubAccName4_J,

BOS_AP_FSupplierPayment_s.apInvoiceAmountReturn,
BOS_AP_FSupplierPayment_s.apInvoiceIdReturn,
BOS_AP_FSupplierPayment_s.supplierDisbursementId,

BOS_AP_FSupplierPayment_s.decAmount,

BOS_AP_FSupplierPayment_s.szCcyId,
BOS_CU_Currency.szSymbol as szCcySymbol,
BOS_CU_Currency.szAmountFormat,

BOS_AP_FSupplierPayment_s.szCcyRateId,

BOS_AP_FSupplierPayment_s.bResultFrTransfer,
BOS_AP_FSupplierPayment_s.bVoid,
BOS_GEN_Approved.bApproved,
BOS_AP_FSupplierPayment_s.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_AP_FSupplierPayment_s.btPrintedCount,
BOS_AP_FSupplierPayment_s.bTransferred,
BOS_AP_FSupplierPayment_s.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_AP_FSupplierPayment_s.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_AP_FSupplierPayment_s.szTaxEntityId,
BOS_AP_FSupplierPayment_s.bNeedApproval,
BOS_AP_FSupplierPayment_s.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_AP_FSupplierPayment_s.dtmCreated,
BOS_AP_FSupplierPayment_s.bSystemCreated,
BOS_AP_FSupplierPayment_s.szUserId,
BOS_SM_User.szName AS szUserNm_J,

BOS_AP_FSupplierPayment_s.szRemark,
BOS_AP_FSupplierPayment_s.szCashAccountId,
BOS_AP_FSupplierPayment_s.szCashGlSubAccountId,
BOS_AP_FSupplierPayment_s.szApAccountId,
BOS_AP_FSupplierPayment_s.szApGLSubAccountId,

BOS_AP_FSupplierPayment_s.decControlAmount,
BOS_AP_FSupplierPayment_s.szChequeId,
BOS_AP_FSupplierPayment_s.szFCashTrnId,
BOS_AP_FSupplierPayment_s.szFCashDocId,
BOS_AP_FSupplierPayment_s.szVoucherId,

BOS_AP_FSupplierPayment_s.dtmLastUpdated,
BOS_AP_FSupplierPayment_s.bAlreadyTransferred
From
BOS_AP_FSupplierPayment_s
LEFT JOIN BOS_GEN_Approved ON BOS_AP_FSupplierPayment_s.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_AP_FSupplierPayment_s.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AP_FSupplierPayment_s.szDeposanId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AP_FSupplierPayment_s.szCcyId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_AP_FSupplierPayment_s.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AP_FSupplierPayment_s.szWorkplaceId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_AP_FSupplierPayment_s.szUserId
LEFT JOIN BOS_GL_Account AS Acc1 ON Acc1.szAccountId = BOS_AP_FSupplierPayment_s.szAccountId1
LEFT JOIN BOS_GL_GLSubAcc AS SubAcc1 ON SubAcc1.szGLSubAccId = BOS_AP_FSupplierPayment_s.szSubAccountId1
LEFT JOIN BOS_GL_Account AS Acc2 ON Acc2.szAccountId = BOS_AP_FSupplierPayment_s.szAccountId2
LEFT JOIN BOS_GL_GLSubAcc AS SubAcc2 ON SubAcc2.szGLSubAccId = BOS_AP_FSupplierPayment_s.szSubAccountId2
LEFT JOIN BOS_GL_Account AS Acc3 ON Acc3.szAccountId = BOS_AP_FSupplierPayment_s.szAccountId3
LEFT JOIN BOS_GL_GLSubAcc AS SubAcc3 ON SubAcc3.szGLSubAccId = BOS_AP_FSupplierPayment_s.szSubAccountId3
LEFT JOIN BOS_GL_Account AS Acc4 ON Acc4.szAccountId = BOS_AP_FSupplierPayment_s.szAccountId4
LEFT JOIN BOS_GL_GLSubAcc AS SubAcc4 ON SubAcc4.szGLSubAccId = BOS_AP_FSupplierPayment_s.szSubAccountId4
Where
BOS_AP_FSupplierPayment_s.szFSupplierPayment_sId = p_szFSupplierPayment_sId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_GetFSupplierPayment_013(
p_szFSupplierPayment_sId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
Select
BOS_AP_FSupplierPayment_s.dtmFSupplierPayment,
BOS_AP_FSupplierPayment_s.szFCashReceiptId,
BOS_AP_FSupplierPayment_s.szDeposanId,
BOS_PI_Employee.szName as szDeposanNm,

BOS_AP_FSupplierPayment_s.szAccountId1,
BOS_AP_FSupplierPayment_s.szSubAccountId1,
BOS_AP_FSupplierPayment_s.decAmount1,

BOS_AP_FSupplierPayment_s.szAccountId2,
BOS_AP_FSupplierPayment_s.szSubAccountId2,
BOS_AP_FSupplierPayment_s.decAmount2,

BOS_AP_FSupplierPayment_s.szAccountId3,
BOS_AP_FSupplierPayment_s.szSubAccountId3,
BOS_AP_FSupplierPayment_s.decAmount3,

BOS_AP_FSupplierPayment_s.szAccountId4,
BOS_AP_FSupplierPayment_s.szSubAccountId4,
BOS_AP_FSupplierPayment_s.decAmount4,
Acc1.szName as szAccName1_J,
SubAcc1.szDescription as szSubAccName1_J,
Acc2.szName as szAccName2_J,
SubAcc2.szDescription as szSubAccName2_J,
Acc3.szName as szAccName3_J,
SubAcc3.szDescription as szSubAccName3_J,
Acc4.szName as szAccName4_J,
SubAcc4.szDescription as szSubAccName4_J,

BOS_AP_FSupplierPayment_s.apInvoiceAmountReturn,
BOS_AP_FSupplierPayment_s.apInvoiceIdReturn,
BOS_AP_FSupplierPayment_s.supplierDisbursementId,

BOS_AP_FSupplierPayment_s.decAmount,

BOS_AP_FSupplierPayment_s.szCcyId,
BOS_CU_Currency.szSymbol as szCcySymbol,
BOS_CU_Currency.szAmountFormat,

BOS_AP_FSupplierPayment_s.szCcyRateId,
BOS_AP_FSupplierPayment_s.purchaseTypeId, 

BOS_AP_FSupplierPayment_s.bResultFrTransfer,
BOS_AP_FSupplierPayment_s.bVoid,
BOS_GEN_Approved.bApproved,
BOS_AP_FSupplierPayment_s.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_AP_FSupplierPayment_s.btPrintedCount,
BOS_AP_FSupplierPayment_s.bTransferred,
BOS_AP_FSupplierPayment_s.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_AP_FSupplierPayment_s.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_AP_FSupplierPayment_s.szTaxEntityId,
BOS_AP_FSupplierPayment_s.bNeedApproval,
BOS_AP_FSupplierPayment_s.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_AP_FSupplierPayment_s.dtmCreated,
BOS_AP_FSupplierPayment_s.bSystemCreated,
BOS_AP_FSupplierPayment_s.szUserId,
BOS_SM_User.szName AS szUserNm_J,

BOS_AP_FSupplierPayment_s.szRemark,
BOS_AP_FSupplierPayment_s.szCashAccountId,
BOS_AP_FSupplierPayment_s.szCashGlSubAccountId,
BOS_AP_FSupplierPayment_s.szApAccountId,
BOS_AP_FSupplierPayment_s.szApGLSubAccountId,

BOS_AP_FSupplierPayment_s.decControlAmount,
BOS_AP_FSupplierPayment_s.szChequeId,
BOS_AP_FSupplierPayment_s.szFCashTrnId,
BOS_AP_FSupplierPayment_s.szFCashDocId,
BOS_AP_FSupplierPayment_s.szVoucherId,

BOS_AP_FSupplierPayment_s.dtmLastUpdated,
BOS_AP_FSupplierPayment_s.bAlreadyTransferred
From
BOS_AP_FSupplierPayment_s
LEFT JOIN BOS_GEN_Approved ON BOS_AP_FSupplierPayment_s.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_AP_FSupplierPayment_s.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AP_FSupplierPayment_s.szDeposanId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AP_FSupplierPayment_s.szCcyId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_AP_FSupplierPayment_s.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AP_FSupplierPayment_s.szWorkplaceId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_AP_FSupplierPayment_s.szUserId
LEFT JOIN BOS_GL_Account AS Acc1 ON Acc1.szAccountId = BOS_AP_FSupplierPayment_s.szAccountId1
LEFT JOIN BOS_GL_GLSubAcc AS SubAcc1 ON SubAcc1.szGLSubAccId = BOS_AP_FSupplierPayment_s.szSubAccountId1
LEFT JOIN BOS_GL_Account AS Acc2 ON Acc2.szAccountId = BOS_AP_FSupplierPayment_s.szAccountId2
LEFT JOIN BOS_GL_GLSubAcc AS SubAcc2 ON SubAcc2.szGLSubAccId = BOS_AP_FSupplierPayment_s.szSubAccountId2
LEFT JOIN BOS_GL_Account AS Acc3 ON Acc3.szAccountId = BOS_AP_FSupplierPayment_s.szAccountId3
LEFT JOIN BOS_GL_GLSubAcc AS SubAcc3 ON SubAcc3.szGLSubAccId = BOS_AP_FSupplierPayment_s.szSubAccountId3
LEFT JOIN BOS_GL_Account AS Acc4 ON Acc4.szAccountId = BOS_AP_FSupplierPayment_s.szAccountId4
LEFT JOIN BOS_GL_GLSubAcc AS SubAcc4 ON SubAcc4.szGLSubAccId = BOS_AP_FSupplierPayment_s.szSubAccountId4
Where
BOS_AP_FSupplierPayment_s.szFSupplierPayment_sId = p_szFSupplierPayment_sId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_GetFSupplierPaymentItem(
p_szFSupplierPayment_sId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
Select
BOS_AP_FSupplierPayment_s_Item.shItemNumber,
BOS_AP_FSupplierPayment_s_Item.szTrnId,
BOS_AP_FSupplierPayment_s_Item.szDocId,
BOS_AP_FSupplierPayment_s_Item.szSuppId,
BOS_AP_Supplier.szName As szSupplierNm,
BOS_AP_FSupplierPayment_s_Item.decAmount,
BOS_AP_FSupplierPayment_s_Item.decPaidByCashReceipt,
BOS_AP_FSupplierPayment_s_Item.szFDoId,
BOS_AP_ApTrans.dtmDate as dtmDate_J,
BOS_AP_ApTrans.decRemain as remain_s
From 
BOS_AP_FSupplierPayment_s_Item 
LEFT JOIN BOS_AP_ApTrans ON BOS_AP_FSupplierPayment_s_Item.szTrnId = BOS_AP_ApTrans.szTrnId 
And BOS_AP_FSupplierPayment_s_Item.szDocId = BOS_AP_ApTrans.szDocId 
And BOS_AP_FSupplierPayment_s_Item.szSuppId = BOS_AP_ApTrans.szSuppId
LEFT JOIN BOS_AP_Supplier ON BOS_AP_FSupplierPayment_s_Item.szSuppId = BOS_AP_Supplier.szSuppId
Where 
BOS_AP_FSupplierPayment_s_Item.szFSupplierPayment_sId = p_szFSupplierPayment_sId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_GetFSupplierPaymentItem_013(
p_szFSupplierPayment_sId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
Select
BOS_AP_FSupplierPayment_s_Item.shItemNumber,
BOS_AP_FSupplierPayment_s_Item.szTrnId,
BOS_AP_FSupplierPayment_s_Item.szDocId,
BOS_AP_FSupplierPayment_s_Item.szSuppId,
BOS_AP_Supplier.szName As szSupplierNm,
BOS_AP_FSupplierPayment_s_Item.decAmount,
BOS_AP_FSupplierPayment_s_Item.decPaidByCashReceipt,
BOS_AP_FSupplierPayment_s_Item.szFDoId,
BOS_AP_ApTrans.dtmDate as dtmDate_J,
BOS_AP_ApTrans.decRemain as remain_s
From 
BOS_AP_FSupplierPayment_s_Item 
LEFT JOIN BOS_AP_ApTrans ON BOS_AP_FSupplierPayment_s_Item.szTrnId = BOS_AP_ApTrans.szTrnId 
And BOS_AP_FSupplierPayment_s_Item.szDocId = BOS_AP_ApTrans.szDocId 
And BOS_AP_FSupplierPayment_s_Item.szSuppId = BOS_AP_ApTrans.szSuppId
LEFT JOIN BOS_AP_Supplier ON BOS_AP_FSupplierPayment_s_Item.szSuppId = BOS_AP_Supplier.szSuppId
Where 
BOS_AP_FSupplierPayment_s_Item.szFSupplierPayment_sId = p_szFSupplierPayment_sId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_GetFSupplierPaymentItemDetail(
p_szFSupplierPayment_sId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AP_FSupplierPayment_s_ItemDetail.szFSupplierPayment_sId,
BOS_AP_FSupplierPayment_s_ItemDetail.shItemNumber,
BOS_AP_FSupplierPayment_s_ItemDetail.shDetailNumber,
BOS_AP_FSupplierPayment_s_ItemDetail.szBankId,
COALESCE(BOS_CAS_Bank.szName, '') As szBankName,
BOS_AP_FSupplierPayment_s_ItemDetail.szRefDocId,
BOS_AP_FSupplierPayment_s_ItemDetail.bValue,
BOS_AP_FSupplierPayment_s_ItemDetail.decAmount,
BOS_AP_FSupplierPayment_s_ItemDetail.bDeposit

FROM 
BOS_AP_FSupplierPayment_s_ItemDetail
Left Join BOS_CAS_Bank On BOS_AP_FSupplierPayment_s_ItemDetail.szBankId = BOS_CAS_Bank.szBankId
WHERE 
BOS_AP_FSupplierPayment_s_ItemDetail.szFSupplierPayment_sId = p_szFSupplierPayment_sId and BOS_AP_FSupplierPayment_s_ItemDetail.shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_GetListOfApTransTobePaid(
p_szDeposanId BOS_DT_szId,
p_dtmDate timestamp)
RETURNS void AS
$BODY$
BEGIN

Select  
BAT.szTrnId,  
BAT.szDocId,  
BAT.szSuppId,  
BOS_AP_Supplier.szName As szSuppName,  
BAT.decRemain As decArAmount --Remaining of AR  

From  
BOS_AP_APTrans As BAT  
Left Join BOS_AP_Supplier On BAT.szSuppId = BOS_AP_Supplier.szSuppId 
Left Join BOS_SD_CjrTracking On BAT.szTrnId = BOS_SD_CjrTracking.szTrnId And BAT.szDocId = BOS_SD_CjrTracking.szDocId  
Left Join BOS_SD_FCjrItem On BOS_SD_CjrTracking.szFCjrId = BOS_SD_FCjrItem.szFCjrId And   
BOS_SD_CjrTracking.szCjrTrackingId = BOS_SD_FCjrItem.szCjrTrackingId  

Where  
BAT.decRemain > 0 And  
BAT.decAmount > 0 And  
BAT.bClosed = 0 And  
BAT.szDocId in (select distinct BST.szDocId  
from BOS_SD_FCjr as BSC inner join BOS_SD_FCjrItem as BSCI on BSC.szFCjrId = BSCI.szFCjrId  
inner join BOS_SD_CJrTracking as BST on BSCI.szCjrTrackingId = BST.szCjrTrackingId  
where BST.szCollectorId = p_szDeposanId And BSC.dtmFCjr >= p_dtmDate AND  
BSC.dtmFCjr < DATEADD(DAY, 1, p_dtmDate))  

Order By  
BOS_SD_CjrTracking.szFCjrId,  
BOS_SD_FCjrItem.shItemNumber;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_GetListOfFSupplierPayment()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSupplierPayment_sId, dtmFSupplierPayment, szFCashReceiptId

FROM 
BOS_AP_FSupplierPayment_s;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_GetListOfUnAppliedFSupplierPayment(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSupplierPaymentId

FROM 
BOS_AP_FSupplierPayment
WHERE 
szWorkplaceId LIKE p_szWorkplaceId AND bVoid = 0 AND bApplied = 0 AND dtmFSupplierPayment >= p_dtmFrom AND dtmFSupplierPayment < DATEADD(DAY, 1, p_dtmTo) AND BOS_AP_FsupplierPayment._s.szDeposanId LIKE p_szOpUserId 
ORDER BY 
dtmFSupplierPayment;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_IsFSupplierPaymentExist(
p_szFSupplierPayment_sId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSupplierPayment_sId

FROM 
BOS_AP_FSupplierPayment_s
WHERE 
 szFSupplierPayment_sId = p_szFSupplierPayment_sId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_IsInvAssignedToOtherFSupplierPayment(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szFSupplierPayment_sId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AP_FSupplierPayment_s.szFSupplierPayment_sId

FROM 
BOS_AP_FSupplierPayment_s
Inner Join BOS_AP_FSupplierPayment_s_Item On BOS_AP_FSupplierPayment_s.szFSupplierPayment_sId = BOS_AP_FSupplierPayment_s_Item.szFSupplierPayment_sId
WHERE 
BOS_AP_FSupplierPayment_s_Item.szTrnId = p_szTrnId And BOS_AP_FSupplierPayment_s_Item.szDocId = p_szDocId And BOS_AP_FSupplierPayment_s.szFSupplierPayment_sId <> p_szFSupplierPayment_sId And BOS_AP_FSupplierPayment_s.bVoid = 0 ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_IsInvAssignedToOtherFSupplierPayment_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szFSupplierPayment_sId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AP_FSupplierPayment_s.szFSupplierPayment_sId

FROM 
BOS_AP_FSupplierPayment_s
Inner Join BOS_AP_FSupplierPayment_s_Item On BOS_AP_FSupplierPayment_s.szFSupplierPayment_sId = BOS_AP_FSupplierPayment_s_Item.szFSupplierPayment_sId
WHERE 
BOS_AP_FSupplierPayment_s_Item.szTrnId = p_szTrnId And BOS_AP_FSupplierPayment_s_Item.szDocId = p_szDocId And BOS_AP_FSupplierPayment_s.szFSupplierPayment_sId <> p_szFSupplierPayment_sId And BOS_AP_FSupplierPayment_s.bVoid = 0 ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_LockFSupplierPayment(
p_szFSupplierPayment_sId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_FSupplierPayment_s
SET 
szDeposanId = szDeposanId
WHERE 
szFSupplierPayment_sId = p_szFSupplierPayment_sId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_UpdateFSupplierPayment(
p_szFSupplierPayment_sId BOS_DT_szId,
p_dtmFSupplierPayment timestamp,
p_szFCashReceiptId BOS_DT_szId,
p_szDeposanId BOS_DT_szId,
p_szAccountId1 BOS_DT_szId,
p_szSubAccountId1 BOS_DT_szGLAccount,
p_decAmount1 BOS_DT_decAmount,
p_szAccountId2 BOS_DT_szId,
p_szSubAccountId2 BOS_DT_szGLAccount,
p_decAmount2 BOS_DT_decAmount,
p_szAccountId3 BOS_DT_szGLAccount,
p_szSubAccountId3 BOS_DT_szGLAccount,
p_decAmount3 BOS_DT_decAmount,
p_szAccountId4 BOS_DT_szId,
p_szSubAccountId4 BOS_DT_szGLAccount,
p_decAmount4 BOS_DT_decAmount,
p_decAmount BOS_DT_decAmount,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_szRemark BOS_DT_szDescription,
p_szCashAccountId BOS_DT_szId,
p_szCashGlSubAccountId BOS_DT_szGLAccount,
p_szApAccountId BOS_DT_szId,
p_szApGlSubAccountId BOS_DT_szGLAccount,
p_decControlAmount BOS_DT_decAmount,
p_szChequeId BOS_DT_szId,
p_apInvoiceAmountReturn numeric,
p_apInvoiceIdReturn BOS_DT_szId,
p_supplierDisbursementId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_FSupplierPayment_s
SET 
dtmFSupplierPayment = p_dtmFSupplierPayment,
szFCashReceiptId = p_szFCashReceiptId,
szDeposanId = p_szDeposanId,
szAccountId1 = p_szAccountId1,
szSubAccountId1 = p_szSubAccountId1,
decAmount1 = p_decAmount1,
szAccountId2 = p_szAccountId2,
szSubAccountId2 = p_szSubAccountId2,
decAmount2 = p_decAmount2,
szAccountId3 = p_szAccountId3,
szSubAccountId3 = p_szSubAccountId3,
decAmount3 = p_decAmount3,
szAccountId4 = p_szAccountId4,
szSubAccountId4 = p_szSubAccountId4,
decAmount4 = p_decAmount4,
decAmount = p_decAmount,
szCcyId = p_szCcyId,
szCcyRateId = p_szCcyRateId,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
szRemark = p_szRemark,
szCashAccountId = p_szCashAccountId,
szCashGlSubAccountId = p_szCashGlSubAccountId,
szApAccountId = p_szApAccountId,
szApGlSubAccountId = p_szApGlSubAccountId,

decControlAmount = p_decControlAmount,
szChequeId = p_szChequeId,

apInvoiceAmountReturn = p_apInvoiceAmountReturn,
apInvoiceIdReturn = p_apInvoiceIdReturn,
supplierDisbursementId = p_supplierDisbursementId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId
WHERE 
szFSupplierPayment_sId = p_szFSupplierPayment_sId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_FSupplierPayment_s_UpdateFSupplierPayment_013(
p_szFSupplierPayment_sId BOS_DT_szId,
p_dtmFSupplierPayment timestamp,
p_szFCashReceiptId BOS_DT_szId,
p_szDeposanId BOS_DT_szId,
p_szAccountId1 BOS_DT_szId,
p_szSubAccountId1 BOS_DT_szGLAccount,
p_decAmount1 BOS_DT_decAmount,
p_szAccountId2 BOS_DT_szId,
p_szSubAccountId2 BOS_DT_szGLAccount,
p_decAmount2 BOS_DT_decAmount,
p_szAccountId3 BOS_DT_szGLAccount,
p_szSubAccountId3 BOS_DT_szGLAccount,
p_decAmount3 BOS_DT_decAmount,
p_szAccountId4 BOS_DT_szId,
p_szSubAccountId4 BOS_DT_szGLAccount,
p_decAmount4 BOS_DT_decAmount,
p_decAmount BOS_DT_decAmount,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_szRemark BOS_DT_szDescription,
p_szCashAccountId BOS_DT_szId,
p_szCashGlSubAccountId BOS_DT_szGLAccount,
p_szApAccountId BOS_DT_szId,
p_szApGlSubAccountId BOS_DT_szGLAccount,
p_decControlAmount BOS_DT_decAmount,
p_szChequeId BOS_DT_szId,
p_apInvoiceAmountReturn numeric,
p_apInvoiceIdReturn BOS_DT_szId,
p_supplierDisbursementId BOS_DT_szId,
p_purchaseTypeId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_FSupplierPayment_s
SET 
dtmFSupplierPayment = p_dtmFSupplierPayment,
szFCashReceiptId = p_szFCashReceiptId,
szDeposanId = p_szDeposanId,
szAccountId1 = p_szAccountId1,
szSubAccountId1 = p_szSubAccountId1,
decAmount1 = p_decAmount1,
szAccountId2 = p_szAccountId2,
szSubAccountId2 = p_szSubAccountId2,
decAmount2 = p_decAmount2,
szAccountId3 = p_szAccountId3,
szSubAccountId3 = p_szSubAccountId3,
decAmount3 = p_decAmount3,
szAccountId4 = p_szAccountId4,
szSubAccountId4 = p_szSubAccountId4,
decAmount4 = p_decAmount4,
decAmount = p_decAmount,
szCcyId = p_szCcyId,
szCcyRateId = p_szCcyRateId,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
szRemark = p_szRemark,
szCashAccountId = p_szCashAccountId,
szCashGlSubAccountId = p_szCashGlSubAccountId,
szApAccountId = p_szApAccountId,
szApGlSubAccountId = p_szApGlSubAccountId,

decControlAmount = p_decControlAmount,
szChequeId = p_szChequeId,

apInvoiceAmountReturn = p_apInvoiceAmountReturn,
apInvoiceIdReturn = p_apInvoiceIdReturn,
supplierDisbursementId = p_supplierDisbursementId,
purchaseTypeId = p_purchaseTypeId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId
WHERE 
szFSupplierPayment_sId = p_szFSupplierPayment_sId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Supplier_CreateSupplier(
p_szSuppId BOS_DT_szId,
p_szName BOS_DT_szName,
p_SuppszContactPerson BOS_DT_szName,
p_SuppszRoomNo BOS_DT_szSmallName,
p_SuppszFloor BOS_DT_szSmallName,
p_SuppszBuilding BOS_DT_szName,
p_SuppszAddress_1 BOS_DT_szName,
p_SuppszAddress_2 BOS_DT_szName,
p_SuppszDistrict BOS_DT_szMediumName,
p_SuppszCity BOS_DT_szMediumName,
p_SuppszZipCode BOS_DT_szSmallName,
p_SuppszState BOS_DT_szMediumName,
p_SuppszCountry BOS_DT_szMediumName,
p_SuppszPhoneNo_1 BOS_DT_szMediumName,
p_SuppszPhoneNo_2 BOS_DT_szMediumName,
p_SuppszFaxNo BOS_DT_szMediumName,
p_SuppszMobileNo BOS_DT_szMediumName,
p_SuppszEmail BOS_DT_szMediumName,
p_SuppszWebSite BOS_DT_szMediumName,
p_szSuppCustId BOS_DT_szId,
p_szOurCustId BOS_DT_szId,
p_szSuppUserId BOS_DT_szId,
p_szSuppGroupId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId,
p_szPaymentTermId BOS_DT_szId,
p_decCreditLimit BOS_DT_decAmount,
p_szDefaultCcyId BOS_DT_szSmallId,
p_szAccId BOS_DT_szId,
p_szGLSubAccId BOS_DT_szGLAccount,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szNPWP BOS_DT_szTaxId,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AP_Supplier
(
szSuppId,
szName,
SuppszContactPerson,
SuppszRoomNo,
SuppszFloor,
SuppszBuilding,
SuppszAddress_1,
SuppszAddress_2,
SuppszDistrict,
SuppszCity,
SuppszZipCode,
SuppszState,
SuppszCountry,
SuppszPhoneNo_1,
SuppszPhoneNo_2,
SuppszFaxNo,
SuppszMobileNo,
SuppszEmail,
SuppszWebSite,
szSuppCustId,
szOurCustId,
szSuppUserId,
szSuppGroupId,
szStatus,
szPaymentTermId,
decCreditLimit,
szDefaultCcyId,
szAccId,
szGLSubAccId,
dtmLastUpdated,
bAlreadyTransferred,
szNPWP,
szWorkplaceId
)
VALUES
(
p_szSuppId,
p_szName,
p_SuppszContactPerson,
p_SuppszRoomNo,
p_SuppszFloor,
p_SuppszBuilding,
p_SuppszAddress_1,
p_SuppszAddress_2,
p_SuppszDistrict,
p_SuppszCity,
p_SuppszZipCode,
p_SuppszState,
p_SuppszCountry,
p_SuppszPhoneNo_1,
p_SuppszPhoneNo_2,
p_SuppszFaxNo,
p_SuppszMobileNo,
p_SuppszEmail,
p_SuppszWebSite,
p_szSuppCustId,
p_szOurCustId,
p_szSuppUserId,
p_szSuppGroupId,
p_szStatus,
p_szPaymentTermId,
p_decCreditLimit,
p_szDefaultCcyId,
p_szAccId,
p_szGLSubAccId,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szNPWP,
p_szWorkplaceId
-- ==================================================================
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Supplier_CreateSupplier_014(
p_szSuppId BOS_DT_szId,
p_szName BOS_DT_szName,
p_SuppszContactPerson BOS_DT_szName,
p_SuppszRoomNo BOS_DT_szSmallName,
p_SuppszFloor BOS_DT_szSmallName,
p_SuppszBuilding BOS_DT_szName,
p_SuppszAddress_1 BOS_DT_szName,
p_SuppszAddress_2 BOS_DT_szName,
p_SuppszDistrict BOS_DT_szName,
p_SuppszCity BOS_DT_szMediumName,
p_SuppszZipCode BOS_DT_szSmallName,
p_SuppszState BOS_DT_szMediumName,
p_SuppszCountry BOS_DT_szMediumName,
p_SuppszPhoneNo_1 BOS_DT_szMediumName,
p_SuppszPhoneNo_2 BOS_DT_szMediumName,
p_SuppszFaxNo BOS_DT_szMediumName,
p_SuppszMobileNo BOS_DT_szMediumName,
p_SuppszEmail BOS_DT_szMediumName,
p_SuppszWebSite BOS_DT_szMediumName,
p_szSuppCustId BOS_DT_szId,
p_szOurCustId BOS_DT_szId,
p_szSuppUserId BOS_DT_szId,
p_szSuppGroupId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId,
p_szPaymentTermId BOS_DT_szId,
p_decCreditLimit BOS_DT_decAmount,
p_szDefaultCcyId BOS_DT_szSmallId,
p_szAccId BOS_DT_szId,
p_szGLSubAccId BOS_DT_szGLAccount,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szNPWP BOS_DT_szTaxId,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AP_Supplier
(
szSuppId,
szName,
SuppszContactPerson,
SuppszRoomNo,
SuppszFloor,
SuppszBuilding,
SuppszAddress_1,
SuppszAddress_2,
SuppszDistrict,
SuppszCity,
SuppszZipCode,
SuppszState,
SuppszCountry,
SuppszPhoneNo_1,
SuppszPhoneNo_2,
SuppszFaxNo,
SuppszMobileNo,
SuppszEmail,
SuppszWebSite,
szSuppCustId,
szOurCustId,
szSuppUserId,
szSuppGroupId,
szStatus,
szPaymentTermId,
decCreditLimit,
szDefaultCcyId,
szAccId,
szGLSubAccId,
dtmLastUpdated,
bAlreadyTransferred,
szNPWP,
szWorkplaceId
)
VALUES
(
p_szSuppId,
p_szName,
p_SuppszContactPerson,
p_SuppszRoomNo,
p_SuppszFloor,
p_SuppszBuilding,
p_SuppszAddress_1,
p_SuppszAddress_2,
p_SuppszDistrict,
p_SuppszCity,
p_SuppszZipCode,
p_SuppszState,
p_SuppszCountry,
p_SuppszPhoneNo_1,
p_SuppszPhoneNo_2,
p_SuppszFaxNo,
p_SuppszMobileNo,
p_SuppszEmail,
p_SuppszWebSite,
p_szSuppCustId,
p_szOurCustId,
p_szSuppUserId,
p_szSuppGroupId,
p_szStatus,
p_szPaymentTermId,
p_decCreditLimit,
p_szDefaultCcyId,
p_szAccId,
p_szGLSubAccId,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szNPWP,
p_szWorkplaceId
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Supplier_CreateSuppProduct(
p_szSuppId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szRefProductId BOS_DT_szId,
p_szRefProductName BOS_DT_szName,
p_decQuality BOS_DT_decAmount,
p_decLeadDay BOS_DT_decAmount,
p_decMinOrderQty BOS_DT_decAmount,
p_decMaxOrderQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AP_SuppProduct
(
szSuppId,
szProductId,
szRefProductId,
szRefProductName,
decQuality,
decLeadDay,
decMinOrderQty,
decMaxOrderQty
)
VALUES
(
p_szSuppId,
p_szProductId,
p_szRefProductId,
p_szRefProductName,
p_decQuality,
p_decLeadDay,
p_decMinOrderQty,
p_decMaxOrderQty
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Supplier_CreateSuppProduct_014(
p_szSuppId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szRefProductId BOS_DT_szId,
p_szRefProductName BOS_DT_szName,
p_decQuality BOS_DT_decAmount,
p_decLeadDay BOS_DT_decAmount,
p_decMinOrderQty BOS_DT_decAmount,
p_decMaxOrderQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AP_SuppProduct
(
szSuppId,
szProductId,
szRefProductId,
szRefProductName,
decQuality,
decLeadDay,
decMinOrderQty,
decMaxOrderQty
)
VALUES
(
p_szSuppId,
p_szProductId,
p_szRefProductId,
p_szRefProductName,
p_decQuality,
p_decLeadDay,
p_decMinOrderQty,
p_decMaxOrderQty
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Supplier_DeleteSupplier(
p_szSuppId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_AP_Supplier
WHERE
 szSuppId = p_szSuppId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Supplier_DeleteSuppProduct(
p_szSuppId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_AP_SuppProduct
WHERE
 szSuppId = p_szSuppId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Supplier_GetListOfSupplier()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szSuppId, szName

FROM 
BOS_AP_Supplier;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Supplier_GetOneSuppProduct(
p_szSuppId BOS_DT_szId,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_Product.szName as szProductNm,
BOS_INV_Product.szUomId as szProductUomId,
BOS_AP_SuppProduct.szRefProductId,
BOS_AP_SuppProduct.szRefProductName,
BOS_AP_SuppProduct.decQuality,
BOS_AP_SuppProduct.decLeadDay,
BOS_AP_SuppProduct.decMinOrderQty,
BOS_AP_SuppProduct.decMaxOrderQty

FROM 
BOS_AP_SuppProduct
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_AP_SuppProduct.szProductIdLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_AP_SuppProduct.szProductId
WHERE 
BOS_AP_SuppProduct.szSuppId = p_szSuppId AND BOS_AP_SuppProduct.szProductId = p_szProductId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Supplier_GetOneSuppProduct_014(
p_szSuppId BOS_DT_szId,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_Product.szName as szProductNm,
BOS_INV_Product.szUomId as szProductUomId,
BOS_AP_SuppProduct.szRefProductId,
BOS_AP_SuppProduct.szRefProductName,
BOS_AP_SuppProduct.decQuality,
BOS_AP_SuppProduct.decLeadDay,
BOS_AP_SuppProduct.decMinOrderQty,
BOS_AP_SuppProduct.decMaxOrderQty

FROM 
BOS_AP_SuppProduct
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_AP_SuppProduct.szProductIdLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_AP_SuppProduct.szProductId
WHERE 
BOS_AP_SuppProduct.szSuppId = p_szSuppId AND BOS_AP_SuppProduct.szProductId = p_szProductId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Supplier_GetProductFromSuppProduct(
p_szSuppId BOS_DT_szId,
p_szRefProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId 

FROM 
BOS_AP_SuppProduct 
WHERE 
szSuppId = p_szSuppId  AND szRefProductId = p_szRefProductId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Supplier_GetSupplier(
p_szSuppId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
Select
BOS_AP_Supplier.szName,
BOS_AP_Supplier.SuppszContactPerson,
BOS_AP_Supplier.SuppszRoomNo,
BOS_AP_Supplier.SuppszFloor,
BOS_AP_Supplier.SuppszBuilding,
BOS_AP_Supplier.SuppszAddress_1,
BOS_AP_Supplier.SuppszAddress_2,
BOS_AP_Supplier.SuppszDistrict,
BOS_AP_Supplier.SuppszCity,
BOS_AP_Supplier.SuppszZipCode,
BOS_AP_Supplier.SuppszState,
BOS_AP_Supplier.SuppszCountry,
BOS_AP_Supplier.SuppszPhoneNo_1,
BOS_AP_Supplier.SuppszPhoneNo_2,
BOS_AP_Supplier.SuppszFaxNo,
BOS_AP_Supplier.SuppszMobileNo,
BOS_AP_Supplier.SuppszEmail,
BOS_AP_Supplier.SuppszWebSite,
BOS_AP_Supplier.szSuppCustId,
BOS_AP_Supplier.szOurCustId,
BOS_AP_Supplier.szSuppUserId,
BOS_AP_Supplier.szSuppGroupId,
BOS_AP_Supplier.szStatus,
BOS_AP_Supplier.szPaymentTermId,
BOS_AP_Supplier.decCreditLimit,

BOS_AP_Supplier.szDefaultCcyId,
BCC.szAmountFormat AS szDefaultCcyAmountFormat_J,

BOS_AP_Supplier.szAccId,
BOS_AP_Supplier.szGLSubAccId,
Acc.szName as szAccNm_J,
SubAcc.szDescription as szGLSubAccNm_J,

BOS_AP_Supplier.dtmLastUpdated,
BOS_AP_Supplier.bAlreadyTransferred,
BOS_AP_Supplier.szNPWP,
BOS_AP_Supplier.szWorkplaceId 

From 
BOS_AP_Supplier
LEFT JOIN BOS_CU_Currency AS BCC ON BCC.szCcyId = BOS_AP_Supplier.szDefaultCcyId
LEFT JOIN BOS_GL_Account AS Acc ON Acc.szAccountId = BOS_AP_Supplier.szAccId
LEFT JOIN BOS_GL_GLSubAcc AS SubAcc ON SubAcc.szGLSubAccId = BOS_AP_Supplier.szGLSubAccId

Where 
szSuppId = p_szSuppId;

-- ==================================================================


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Supplier_GetSupplier_014(
p_szSuppId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
Select
BOS_AP_Supplier.szName,
BOS_AP_Supplier.SuppszContactPerson,
BOS_AP_Supplier.SuppszRoomNo,
BOS_AP_Supplier.SuppszFloor,
BOS_AP_Supplier.SuppszBuilding,
BOS_AP_Supplier.SuppszAddress_1,
BOS_AP_Supplier.SuppszAddress_2,
BOS_AP_Supplier.SuppszDistrict,
BOS_AP_Supplier.SuppszCity,
BOS_AP_Supplier.SuppszZipCode,
BOS_AP_Supplier.SuppszState,
BOS_AP_Supplier.SuppszCountry,
BOS_AP_Supplier.SuppszPhoneNo_1,
BOS_AP_Supplier.SuppszPhoneNo_2,
BOS_AP_Supplier.SuppszFaxNo,
BOS_AP_Supplier.SuppszMobileNo,
BOS_AP_Supplier.SuppszEmail,
BOS_AP_Supplier.SuppszWebSite,
BOS_AP_Supplier.szSuppCustId,
BOS_AP_Supplier.szOurCustId,
BOS_AP_Supplier.szSuppUserId,
BOS_AP_Supplier.szSuppGroupId,
BOS_AP_Supplier.szStatus,
BOS_AP_Supplier.szPaymentTermId,
BOS_AP_Supplier.decCreditLimit,

BOS_AP_Supplier.szDefaultCcyId,
BCC.szAmountFormat AS szDefaultCcyAmountFormat_J,

BOS_AP_Supplier.szAccId,
BOS_AP_Supplier.szGLSubAccId,
Acc.szName as szAccNm_J,
SubAcc.szDescription as szGLSubAccNm_J,

BOS_AP_Supplier.dtmLastUpdated,
BOS_AP_Supplier.bAlreadyTransferred,
BOS_AP_Supplier.szNPWP,
BOS_AP_Supplier.szWorkplaceId 

From 
BOS_AP_Supplier
LEFT JOIN BOS_CU_Currency AS BCC ON BCC.szCcyId = BOS_AP_Supplier.szDefaultCcyId
LEFT JOIN BOS_GL_Account AS Acc ON Acc.szAccountId = BOS_AP_Supplier.szAccId
LEFT JOIN BOS_GL_GLSubAcc AS SubAcc ON SubAcc.szGLSubAccId = BOS_AP_Supplier.szGLSubAccId

Where 
szSuppId = p_szSuppId;

-- ==================================================================



END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Supplier_GetSuppProduct(
p_szSuppId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AP_SuppProduct.szProductId,
BOS_INV_Product.szName as szProductNm,
BOS_INV_Product.szUomId as szProductUomId,
BOS_AP_SuppProduct.szRefProductId,
BOS_AP_SuppProduct.szRefProductName,
BOS_AP_SuppProduct.decQuality,
BOS_AP_SuppProduct.decLeadDay,
BOS_AP_SuppProduct.decMinOrderQty,
BOS_AP_SuppProduct.decMaxOrderQty

FROM 
BOS_AP_SuppProduct
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_AP_SuppProduct.szProductIdLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_AP_SuppProduct.szProductId
WHERE 
BOS_AP_SuppProduct.szSuppId = p_szSuppId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Supplier_GetSuppProduct_014(
p_szSuppId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AP_SuppProduct.szProductId,
BOS_INV_Product.szName as szProductNm,
BOS_INV_Product.szUomId as szProductUomId,
BOS_AP_SuppProduct.szRefProductId,
BOS_AP_SuppProduct.szRefProductName,
BOS_AP_SuppProduct.decQuality,
BOS_AP_SuppProduct.decLeadDay,
BOS_AP_SuppProduct.decMinOrderQty,
BOS_AP_SuppProduct.decMaxOrderQty

FROM 
BOS_AP_SuppProduct
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_AP_SuppProduct.szProductIdLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_AP_SuppProduct.szProductId
WHERE 
BOS_AP_SuppProduct.szSuppId = p_szSuppId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Supplier_IsSupplierExist(
p_szSuppId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szSuppId

FROM 
BOS_AP_Supplier
WHERE 
 szSuppId = p_szSuppId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Supplier_LockSupplier(
p_szSuppId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_Supplier
SET 
 szName = szName
WHERE 
 szSuppId = p_szSuppId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Supplier_UpdateSupplier(
p_szSuppId BOS_DT_szId,
p_szName BOS_DT_szName,
p_SuppszContactPerson BOS_DT_szName,
p_SuppszRoomNo BOS_DT_szSmallName,
p_SuppszFloor BOS_DT_szSmallName,
p_SuppszBuilding BOS_DT_szName,
p_SuppszAddress_1 BOS_DT_szName,
p_SuppszAddress_2 BOS_DT_szName,
p_SuppszDistrict BOS_DT_szMediumName,
p_SuppszCity BOS_DT_szMediumName,
p_SuppszZipCode BOS_DT_szSmallName,
p_SuppszState BOS_DT_szMediumName,
p_SuppszCountry BOS_DT_szMediumName,
p_SuppszPhoneNo_1 BOS_DT_szMediumName,
p_SuppszPhoneNo_2 BOS_DT_szMediumName,
p_SuppszFaxNo BOS_DT_szMediumName,
p_SuppszMobileNo BOS_DT_szMediumName,
p_SuppszEmail BOS_DT_szMediumName,
p_SuppszWebSite BOS_DT_szMediumName,
p_szSuppCustId BOS_DT_szId,
p_szOurCustId BOS_DT_szId,
p_szSuppUserId BOS_DT_szId,
p_szSuppGroupId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId,
p_szPaymentTermId BOS_DT_szId,
p_decCreditLimit BOS_DT_decAmount,
p_szDefaultCcyId BOS_DT_szSmallId,
p_szAccId BOS_DT_szId,
p_szGLSubAccId BOS_DT_szGLAccount,
p_szNPWP BOS_DT_szTaxId,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_Supplier
SET 
szName = p_szName,
SuppszContactPerson = p_SuppszContactPerson,
SuppszRoomNo = p_SuppszRoomNo,
SuppszFloor = p_SuppszFloor,
SuppszBuilding = p_SuppszBuilding,
SuppszAddress_1 = p_SuppszAddress_1,
SuppszAddress_2 = p_SuppszAddress_2,
SuppszDistrict = p_SuppszDistrict,
SuppszCity = p_SuppszCity,
SuppszZipCode = p_SuppszZipCode,
SuppszState = p_SuppszState,
SuppszCountry = p_SuppszCountry,
SuppszPhoneNo_1 = p_SuppszPhoneNo_1,
SuppszPhoneNo_2 = p_SuppszPhoneNo_2,
SuppszFaxNo = p_SuppszFaxNo,
SuppszMobileNo = p_SuppszMobileNo,
SuppszEmail = p_SuppszEmail,
SuppszWebSite = p_SuppszWebSite,
szSuppCustId = p_szSuppCustId,
szOurCustId = p_szOurCustId,
szSuppUserId = p_szSuppUserId,
szSuppGroupId = p_szSuppGroupId,
szStatus = p_szStatus,
szPaymentTermId = p_szPaymentTermId,
decCreditLimit = p_decCreditLimit,
szDefaultCcyId = p_szDefaultCcyId,
szAccId = p_szAccId,
szGLSubAccId = p_szGLSubAccId,
szNPWP = p_szNPWP,
szWorkplaceId = p_szWorkplaceId

WHERE 
szSuppId = p_szSuppId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AP_Supplier_UpdateSupplier_014(
p_szSuppId BOS_DT_szId,
p_szName BOS_DT_szName,
p_SuppszContactPerson BOS_DT_szName,
p_SuppszRoomNo BOS_DT_szSmallName,
p_SuppszFloor BOS_DT_szSmallName,
p_SuppszBuilding BOS_DT_szName,
p_SuppszAddress_1 BOS_DT_szName,
p_SuppszAddress_2 BOS_DT_szName,
p_SuppszDistrict BOS_DT_szName,
p_SuppszCity BOS_DT_szMediumName,
p_SuppszZipCode BOS_DT_szSmallName,
p_SuppszState BOS_DT_szMediumName,
p_SuppszCountry BOS_DT_szMediumName,
p_SuppszPhoneNo_1 BOS_DT_szMediumName,
p_SuppszPhoneNo_2 BOS_DT_szMediumName,
p_SuppszFaxNo BOS_DT_szMediumName,
p_SuppszMobileNo BOS_DT_szMediumName,
p_SuppszEmail BOS_DT_szMediumName,
p_SuppszWebSite BOS_DT_szMediumName,
p_szSuppCustId BOS_DT_szId,
p_szOurCustId BOS_DT_szId,
p_szSuppUserId BOS_DT_szId,
p_szSuppGroupId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId,
p_szPaymentTermId BOS_DT_szId,
p_decCreditLimit BOS_DT_decAmount,
p_szDefaultCcyId BOS_DT_szSmallId,
p_szAccId BOS_DT_szId,
p_szGLSubAccId BOS_DT_szGLAccount,
p_szNPWP BOS_DT_szTaxId,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AP_Supplier
SET 
szName = p_szName,
SuppszContactPerson = p_SuppszContactPerson,
SuppszRoomNo = p_SuppszRoomNo,
SuppszFloor = p_SuppszFloor,
SuppszBuilding = p_SuppszBuilding,
SuppszAddress_1 = p_SuppszAddress_1,
SuppszAddress_2 = p_SuppszAddress_2,
SuppszDistrict = p_SuppszDistrict,
SuppszCity = p_SuppszCity,
SuppszZipCode = p_SuppszZipCode,
SuppszState = p_SuppszState,
SuppszCountry = p_SuppszCountry,
SuppszPhoneNo_1 = p_SuppszPhoneNo_1,
SuppszPhoneNo_2 = p_SuppszPhoneNo_2,
SuppszFaxNo = p_SuppszFaxNo,
SuppszMobileNo = p_SuppszMobileNo,
SuppszEmail = p_SuppszEmail,
SuppszWebSite = p_SuppszWebSite,
szSuppCustId = p_szSuppCustId,
szOurCustId = p_szOurCustId,
szSuppUserId = p_szSuppUserId,
szSuppGroupId = p_szSuppGroupId,
szStatus = p_szStatus,
szPaymentTermId = p_szPaymentTermId,
decCreditLimit = p_decCreditLimit,
szDefaultCcyId = p_szDefaultCcyId,
szAccId = p_szAccId,
szGLSubAccId = p_szGLSubAccId,
szNPWP = p_szNPWP,
szWorkplaceId = p_szWorkplaceId

WHERE 
szSuppId = p_szSuppId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_AdjustArTransRemain(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint,
p_decAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_ArTrans
SET 
decRemain = decRemain + p_decAmount
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szCustId = p_szCustId And shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_AdjustArTransRemain_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint,
p_decAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_ArTrans
SET 
decRemain = decRemain + p_decAmount
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szCustId = p_szCustId And shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_ArMasterDecrementTotalOpenInvoice(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_ArMaster
SET 
intNumberOfOpenInvoice = intNumberOfOpenInvoice - 1
WHERE 
BOS_AR_ArMaster.szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_ArMasterIncrementTotalOpenInvoice(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_ArMaster
SET 
intNumberOfOpenInvoice = intNumberOfOpenInvoice + 1
WHERE 
BOS_AR_ArMaster.szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_CloseArTrans(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint,
p_bClosed bit,
p_dtmClosed timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_ArTrans
SET 
bClosed = p_bClosed,
dtmClosed = p_dtmClosed
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szCustId = p_szCustId And shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_CloseArTrans_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint,
p_bClosed bit,
p_dtmClosed timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_ArTrans
SET 
bClosed = p_bClosed,
dtmClosed = p_dtmClosed
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szCustId = p_szCustId And shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_CountPassDueArOfCustomer(
p_dtmTransaction timestamp,
p_szInvCustId BOS_DT_szId,
p_decMinAmountTreatedAsAr BOS_DT_decDecimal,
p_szArClassId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
COUNT(BAT.szDocId) AS cntPassDueAr


FROM 
BOS_AR_ArTrans As BAT

WHERE 
BAT.bClosed = 0 And BAT.decRemain > p_decMinAmountTreatedAsAr And (BAT.szTrnId = 'FInv' Or BAT.szTrnId = 'PDREC') AND BAT.dtmDue < p_dtmTransaction AND BAT.szCustId LIKE p_szInvCustId AND BAT.szArClassId LIKE p_szArClassId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_CreateArMaster(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_decAmount BOS_DT_decAmount,
p_bBad bit,
p_intNumberOfOpenInvoice smallint,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_ArMaster
(
szCustId,
szCcyId,
decAmount,
bBad,
intNumberOfOpenInvoice,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCustId,
p_szCcyId,
p_decAmount,
p_bBad,
p_intNumberOfOpenInvoice,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_CreateArMaster_014(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_decAmount BOS_DT_decAmount,
p_bBad bit,
p_intNumberOfOpenInvoice smallint,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_ArMaster
(
szCustId,
szCcyId,
decAmount,
bBad,
intNumberOfOpenInvoice,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCustId,
p_szCcyId,
p_decAmount,
p_bBad,
p_intNumberOfOpenInvoice,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_CreateArTrans(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint,
p_szArClassId BOS_DT_szId,
p_dtmDate timestamp,
p_dtmPeriode timestamp,
p_szCcyId BOS_DT_szSmallId,
p_decAmount BOS_DT_decAmount,
p_decRemain BOS_DT_decAmount,
p_szDescription BOS_DT_szDescription,
p_bClosed bit,
p_dtmClosed timestamp,
p_szUrl BOS_DT_szUrl,
p_szFInvoiceStatus varchar,
p_szInvWorkplaceId BOS_DT_szId,
p_szRefTrnId BOS_DT_szMediumId,
p_szRefDocId BOS_DT_szId,
p_szFInvoiceUsage varchar,
p_bCash bit,
p_dtmDue timestamp,
p_dtmDue_Printed timestamp,
p_szFInvoiceType BOS_DT_szSmallId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint,
p_dtmCollectionDoc timestamp,
p_dtmToBeCollected timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_ArTrans
(
szTrnId,
szDocId,
szCustId,
shRevNo,
szArClassId,
dtmDate,
dtmPeriode,
szCcyId,
decAmount,
decRemain,
szDescription,
bClosed,
dtmClosed,
szUrl,
szFInvoiceStatus,
szInvWorkplaceId,
szRefTrnId,
szRefDocId,
szFInvoiceUsage,
bCash,
dtmDue,
dtmDue_Printed,
szFInvoiceType,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
 dtmCollectionDoc,
 dtmToBeCollected
)
VALUES
(
p_szTrnId,
p_szDocId,
p_szCustId,
p_shRevNo,
p_szArClassId,
p_dtmDate,
p_dtmPeriode,
p_szCcyId,
p_decAmount,
p_decRemain,
p_szDescription,
p_bClosed,
p_dtmClosed,
p_szUrl,
p_szFInvoiceStatus,
p_szInvWorkplaceId,
p_szRefTrnId,
p_szRefDocId,
p_szFInvoiceUsage,
p_bCash,
p_dtmDue,
p_dtmDue_Printed,
p_szFInvoiceType,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
 p_dtmCollectionDoc,
 p_dtmToBeCollected
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_CreateArTrans_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint,
p_szArClassId BOS_DT_szId,
p_dtmDate timestamp,
p_dtmPeriode timestamp,
p_szCcyId BOS_DT_szSmallId,
p_decAmount BOS_DT_decAmount,
p_decRemain BOS_DT_decAmount,
p_szDescription BOS_DT_szDescription,
p_bClosed bit,
p_dtmClosed timestamp,
p_szUrl BOS_DT_szUrl,
p_szFInvoiceStatus varchar,
p_szInvWorkplaceId BOS_DT_szId,
p_szRefTrnId BOS_DT_szMediumId,
p_szRefDocId BOS_DT_szId,
p_szFInvoiceUsage varchar,
p_bCash bit,
p_dtmDue timestamp,
p_dtmDue_Printed timestamp,
p_szFInvoiceType BOS_DT_szSmallId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint,
p_dtmCollectionDoc timestamp,
p_dtmToBeCollected timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_ArTrans
(
szTrnId,
szDocId,
szCustId,
shRevNo,
szArClassId,
dtmDate,
dtmPeriode,
szCcyId,
decAmount,
decRemain,
szDescription,
bClosed,
dtmClosed,
szUrl,
szFInvoiceStatus,
szInvWorkplaceId,
szRefTrnId,
szRefDocId,
szFInvoiceUsage,
bCash,
dtmDue,
dtmDue_Printed,
szFInvoiceType,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
 dtmCollectionDoc,
 dtmToBeCollected
)
VALUES
(
p_szTrnId,
p_szDocId,
p_szCustId,
p_shRevNo,
p_szArClassId,
p_dtmDate,
p_dtmPeriode,
p_szCcyId,
p_decAmount,
p_decRemain,
p_szDescription,
p_bClosed,
p_dtmClosed,
p_szUrl,
p_szFInvoiceStatus,
p_szInvWorkplaceId,
p_szRefTrnId,
p_szRefDocId,
p_szFInvoiceUsage,
p_bCash,
p_dtmDue,
p_dtmDue_Printed,
p_szFInvoiceType,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
 p_dtmCollectionDoc,
 p_dtmToBeCollected
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_CreateArTransRefDoc(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint,
p_shItemNumber smallint,
p_szRefTrnId BOS_DT_szMediumId,
p_szRefDocId BOS_DT_szId,
p_szRefCustId BOS_DT_szId,
p_shRefRevNo smallint,
p_decAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_ArTransRefDoc
(
szTrnId,
szDocId,
szCustId,
shRevNo,
shItemNumber,
szRefTrnId,
szRefDocId,
szRefCustId,
shRefRevNo,
decAmount
)
VALUES
(
p_szTrnId,
p_szDocId,
p_szCustId,
p_shRevNo,
p_shItemNumber,
p_szRefTrnId,
p_szRefDocId,
p_szRefCustId,
p_shRefRevNo,
p_decAmount
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_CreateArTransRefDoc_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint,
p_shItemNumber smallint,
p_szRefTrnId BOS_DT_szMediumId,
p_szRefDocId BOS_DT_szId,
p_szRefCustId BOS_DT_szId,
p_shRefRevNo smallint,
p_decAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_ArTransRefDoc
(
szTrnId,
szDocId,
szCustId,
shRevNo,
shItemNumber,
szRefTrnId,
szRefDocId,
szRefCustId,
shRefRevNo,
decAmount
)
VALUES
(
p_szTrnId,
p_szDocId,
p_szCustId,
p_shRevNo,
p_shItemNumber,
p_szRefTrnId,
p_szRefDocId,
p_szRefCustId,
p_shRefRevNo,
p_decAmount
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_DebitAr(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_decDebitAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_ArMaster
SET 
decAmount = decAmount + p_decDebitAmount
WHERE 
szCustId = p_szCustId And szCcyId = p_szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_DebitAr_013(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_decDebitAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_ArMaster
SET 
decAmount = decAmount + p_decDebitAmount
WHERE 
szCustId = p_szCustId And szCcyId = p_szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_DeleteArMaster(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_AR_ArMaster
WHERE
szCustId = p_szCustId And szCcyId = p_szCcyId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_DeleteArTrans(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_AR_ArTrans
WHERE
szTrnId = p_szTrnId And szDocId = p_szDocId And szCustId = p_szCustId And shRevNo = p_shRevNo;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_DeleteArTrans_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_AR_ArTrans
WHERE
szTrnId = p_szTrnId And szDocId = p_szDocId And szCustId = p_szCustId And shRevNo = p_shRevNo;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_DeleteArTransRefDoc(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_AR_ArTransRefDoc
WHERE
szTrnId = p_szTrnId And szDocId = p_szDocId And szCustId = p_szCustId And shRevNo = p_shRevNo;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_DeleteArTransRefDoc_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_AR_ArTransRefDoc
WHERE
szTrnId = p_szTrnId And szDocId = p_szDocId And szCustId = p_szCustId And shRevNo = p_shRevNo;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_FlagArBad(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_bBad bit)
RETURNS void AS
$BODY$
BEGIN

If p_szCcyId = ''
THEN

	Update
	BOS_AR_ArMaster
	Set
	bBad = p_bBad
	Where
	szCustId = p_szCustId;

Else
	Begin
	Update
	BOS_AR_ArMaster
	Set
	bBad = p_bBad
	Where
	szCustId = p_szCustId And szCcyId = p_szCcyId;
	End;

END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetArHistory(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_szArClassId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_bUnclosedOnly bit)
RETURNS void AS
$BODY$
BEGIN

IF p_bUnclosedOnly = 1
  THEN

Select
BAA.szTrnId,
BAA.szDocId,
BAA.shRevNo,
BAA.szArClassId,
BAA.dtmDate,
BAA.decAmount,
BAA.decRemain,
BAA.szDescription,
BAA.bClosed,
BAA.dtmClosed,
BAA.szUrl,
BAA.szFInvoiceStatus,
BAA.szInvWorkplaceId,
BAA.szRefTrnId,
BAA.szRefDocId,
BAA.szFInvoiceUsage,
BAA.bCash,
BAA.dtmDue,
BAA.dtmDue_Printed,
BAA.dtmPeriode,
--change by freddy simamora approval
--BSC.szChangeNote
'' AS szChangeNote
From
BOS_AR_ArTrans AS BAA
--LEFT JOIN BOS_SD_CjrTracking AS BSC ON BSC.szTrnId = BAA.szTrnId AND BSC.szDocId = BAA.szDocId

Where
BAA.szCustId = p_szCustId And
BAA.szCcyId = p_szCcyId And
BAA.dtmDate >= p_dtmStart And BAA.dtmDate < DateAdd(Day, 1, p_dtmEnd)
AND BAA.bClosed = 0
AND BAA.szArClassId LIKE p_szArClassId

ORDER BY
BAA.dtmDate, 
BAA.szTrnId,
BAA.szDocId,
BAA.shRevNo;

ELSE

Select
BAA.szTrnId,
BAA.szDocId,
BAA.shRevNo,
BAA.szArClassId,
BAA.dtmDate,
BAA.decAmount,
BAA.decRemain,
BAA.szDescription,
BAA.bClosed,
BAA.dtmClosed,
BAA.szUrl,
BAA.szFInvoiceStatus,
BAA.szInvWorkplaceId,
BAA.szRefTrnId,
BAA.szRefDocId,
BAA.szFInvoiceUsage,
BAA.bCash,
BAA.dtmDue,
BAA.dtmDue_Printed,
BAA.dtmPeriode,
--BSC.szChangeNote=NULL,'',BSC.szChangeNote)
'' AS szChangeNote
From
BOS_AR_ArTrans AS BAA
--LEFT JOIN BOS_SD_CjrTracking AS BSC ON BSC.szTrnId = BAA.szTrnId AND BSC.szDocId = BAA.szDocId

Where
BAA.szCustId = p_szCustId And
BAA.szCcyId = p_szCcyId And
BAA.dtmDate >= p_dtmStart And BAA.dtmDate < DateAdd(Day, 1, p_dtmEnd)
AND BAA.szArClassId LIKE p_szArClassId

ORDER BY
BAA.dtmDate, 
BAA.szTrnId,
BAA.szDocId,
BAA.shRevNo;



END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetArTrans(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
Select
BOS_AR_ArTrans.szArClassId,
BOS_AR_ArTrans.szCustId,
IsNull(INV_TO.szName, '') As szCustNm,
BOS_AR_ArTrans.dtmDate,
BOS_AR_ArTrans.dtmPeriode,
BOS_AR_ArTrans.szCcyId,
BOS_CU_Currency.szAmountFormat,
BOS_AR_ArTrans.decAmount,
BOS_AR_ArTrans.decRemain,
BOS_AR_ArTrans.szDescription,
BOS_AR_ArTrans.bClosed,
BOS_AR_ArTrans.dtmClosed,
BOS_AR_ArTrans.szUrl,
BOS_AR_ArTrans.szFInvoiceStatus,
BOS_AR_ArTrans.szInvWorkplaceId,
BOS_AR_ArTrans.szRefTrnId,
BOS_AR_ArTrans.szRefDocId,
BOS_AR_ArTrans.szFInvoiceUsage,
BOS_AR_ArTrans.bCash,
BOS_AR_ArTrans.dtmDue,
BOS_AR_ArTrans.dtmDue_Printed,
BSC.szChangeNote,
BOS_SD_FInvoice.szPaymentTermId AS szPaymentTermId_J,
COLL_TO.szCollWorkplaceId AS szCustCollWpId_J,
BOS_AR_ArTrans.szFInvoiceType,
BOS_AR_ArTrans.dtmLastUpdated,
BOS_AR_ArTrans.bAlreadyTransferred
, BOS_AR_ArTrans.dtmCollectionDoc
, BOS_AR_ArTrans.dtmToBeCollected

From
BOS_AR_ArTrans

LEFT JOIN BOS_SD_FInvoice ON BOS_AR_ArTrans.szTrnId = 'FInv' 
AND BOS_SD_FInvoice.szFInvoiceId = BOS_AR_ArTrans.szDocId

LEFT JOIN BOS_AR_Customer AS INV_TO ON INV_TO.szCustId = BOS_AR_ArTrans.szCustId
--Customer in ar trans is already invoice customer, so just link to it directly.
LEFT JOIN BOS_AR_CustSales ON BOS_AR_CustSales.szCustId = BOS_AR_ArTrans.szCustId
LEFT JOIN BOS_AR_Customer AS COLL_TO ON COLL_TO.szCustId = INV_TO.szCollectToCustId

LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_ArTrans.szCcyId
LEFT JOIN BOS_SD_CjrTracking AS BSC ON BSC.szTrnId = BOS_AR_ArTrans.szTrnId AND BSC.szDocId = BOS_AR_ArTrans.szDocId

Where
BOS_AR_ArTrans.szTrnId = p_szTrnId And BOS_AR_ArTrans.szDocId = p_szDocId And BOS_AR_ArTrans.szCustId LIKE p_szCustId And BOS_AR_ArTrans.shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetArTrans_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
Select
BOS_AR_ArTrans.szArClassId,
BOS_AR_ArTrans.szCustId,
IsNull(INV_TO.szName, '') As szCustNm,
BOS_AR_ArTrans.dtmDate,
BOS_AR_ArTrans.dtmPeriode,
BOS_AR_ArTrans.szCcyId,
BOS_CU_Currency.szAmountFormat,
BOS_AR_ArTrans.decAmount,
BOS_AR_ArTrans.decRemain,
BOS_AR_ArTrans.szDescription,
BOS_AR_ArTrans.bClosed,
BOS_AR_ArTrans.dtmClosed,
BOS_AR_ArTrans.szUrl,
BOS_AR_ArTrans.szFInvoiceStatus,
BOS_AR_ArTrans.szInvWorkplaceId,
BOS_AR_ArTrans.szRefTrnId,
BOS_AR_ArTrans.szRefDocId,
BOS_AR_ArTrans.szFInvoiceUsage,
BOS_AR_ArTrans.bCash,
BOS_AR_ArTrans.dtmDue,
BOS_AR_ArTrans.dtmDue_Printed,
BSC.szChangeNote,
BOS_SD_FInvoice.szPaymentTermId AS szPaymentTermId_J,
COLL_TO.szCollWorkplaceId AS szCustCollWpId_J,
BOS_AR_ArTrans.szFInvoiceType,
BOS_AR_ArTrans.dtmLastUpdated,
BOS_AR_ArTrans.bAlreadyTransferred
, BOS_AR_ArTrans.dtmCollectionDoc
, BOS_AR_ArTrans.dtmToBeCollected

From
BOS_AR_ArTrans

LEFT JOIN BOS_SD_FInvoice ON BOS_AR_ArTrans.szTrnId = 'FInv' 
AND BOS_SD_FInvoice.szFInvoiceId = BOS_AR_ArTrans.szDocId

LEFT JOIN BOS_AR_Customer AS INV_TO ON INV_TO.szCustId = BOS_AR_ArTrans.szCustId
--Customer in ar trans is already invoice customer, so just link to it directly.
LEFT JOIN BOS_AR_CustSales ON BOS_AR_CustSales.szCustId = BOS_AR_ArTrans.szCustId
LEFT JOIN BOS_AR_Customer AS COLL_TO ON COLL_TO.szCustId = INV_TO.szCollectToCustId

LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_ArTrans.szCcyId
LEFT JOIN BOS_SD_CjrTracking AS BSC ON BSC.szTrnId = BOS_AR_ArTrans.szTrnId AND BSC.szDocId = BOS_AR_ArTrans.szDocId

Where
BOS_AR_ArTrans.szTrnId = p_szTrnId And BOS_AR_ArTrans.szDocId = p_szDocId And BOS_AR_ArTrans.szCustId LIKE p_szCustId And BOS_AR_ArTrans.shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetArTransRefDoc(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRefTrnId,
szRefDocId,
szRefCustId,
shRefRevNo,
decAmount

FROM 
BOS_AR_ArTransRefDoc
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szCustId = p_szCustId And shRevNo = p_shRevNo ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetArTransRefDoc_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRefTrnId,
szRefDocId,
szRefCustId,
shRefRevNo,
decAmount

FROM 
BOS_AR_ArTransRefDoc
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szCustId = p_szCustId And shRevNo = p_shRevNo ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetLastRevNo(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
Max(shRevNo) As shLastRevNo

FROM 
BOS_AR_ArTrans
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szCustId LIKE p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetLastRevNo_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
Max(shRevNo) As shLastRevNo

FROM 
BOS_AR_ArTrans
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szCustId LIKE p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetListOfArMaster(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_szInvWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_ArMaster.szCustId,
BOS_AR_ArMaster.szCcyId


FROM 
BOS_AR_ArMaster
LEFT JOIN BOS_AR_Customer AS Cust ON Cust.szCustId = BOS_AR_ArMaster.szCustIdLEFT JOIN BOS_AR_Customer AS Cust ON Cust.szCustId = BOS_AR_ArMaster.szCustId
WHERE 
BOS_AR_ArMaster.szCustId like p_szCustId And BOS_AR_ArMaster.szCcyId like p_szCcyId AND Cust.szInvWorkplaceId LIKE p_szInvWorkplaceId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetListOfArMasterCust(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
BOS_AR_ArMaster.szCustId

FROM 
BOS_AR_ArMaster
Left Join BOS_AR_Customer On BOS_AR_Customer.szCustId = BOS_AR_ArMaster.szCustId
WHERE 
BOS_AR_ArMaster.szCustId like p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetListOfArMasterData(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_szArClassId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

Select
BOS_AR_ArMaster.szCustId,
BOS_AR_ArMaster.szCcyId,

BOS_AR_Customer.szName As szCustNm,
BOS_AR_Customer.szStatus AS szCustStatus_J,

BOS_AR_ArMaster.decAmount,
AMC.decAmount AS decArClassAmount,

BOS_CU_Currency.szSymbol as szCcySymbol,
BOS_CU_Currency.szAmountFormat,
BOS_AR_ArMaster.bBad,
BOS_AR_ArMaster.intNumberOfOpenInvoice,

-- Data Status.
BOS_AR_ArMaster.dtmLastUpdated,
BOS_AR_ArMaster.bAlreadyTransferred,

BSR.szOpUserId,
BPE.szName AS szOpUserNm,

BOS_AR_Customer.szDefaultCcyId AS szCustDefaultCcyId_J,
BOS_AR_CustSales.decCreditLimit AS decCustCreditLimit_J,

CSAC.decCreditLimit AS decCustArClassCreditLimit_J

From
BOS_AR_ArMaster
Left Join BOS_AR_Customer On BOS_AR_Customer.szCustId = BOS_AR_ArMaster.szCustId
Left Join BOS_CU_Currency On BOS_CU_Currency.szCcyId = BOS_AR_ArMaster.szCcyId
LEFT JOIN BOS_SD_CustCollRoutine AS BSC ON BSC.szCustId = BOS_AR_Customer.szCustId
LEFT JOIN BOS_SD_Route AS BSR ON BSR.szRouteId = BSC.szDefaultRouteId
LEFT JOIN BOS_PI_Employee AS BPE ON BPE.szEmployeeId = BSR.szOpUserId
LEFT JOIN BOS_AR_CustSales ON BOS_AR_CustSales.szCustId = BOS_AR_Customer.szInvoiceToCustId
LEFT JOIN BOS_AR_CustSalesArClass AS CSAC ON CSAC.szCustId = BOS_AR_Customer.szInvoiceToCustId
AND CSAC.szArClassId = p_szArClassId
LEFT JOIN BOS_AR_ArMasterClass AS AMC ON AMC.szCustId = BOS_AR_ArMaster.szCustId
AND AMC.szCcyId = BOS_AR_ArMaster.szCcyId
AND AMC.szArClassId = p_szArClassId

Where
BOS_AR_ArMaster.szCustId LIKE p_szCustId And BOS_AR_ArMaster.szCcyId LIKE p_szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetListOfArMasterData_014(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_szArClassId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

Select
BOS_AR_ArMaster.szCustId,
BOS_AR_ArMaster.szCcyId,

BOS_AR_Customer.szName As szCustNm,
BOS_AR_Customer.szStatus AS szCustStatus_J,

BOS_AR_ArMaster.decAmount,
AMC.decAmount AS decArClassAmount,

BOS_CU_Currency.szSymbol as szCcySymbol,
BOS_CU_Currency.szAmountFormat,
BOS_AR_ArMaster.bBad,
BOS_AR_ArMaster.intNumberOfOpenInvoice,

-- Data Status.
BOS_AR_ArMaster.dtmLastUpdated,
BOS_AR_ArMaster.bAlreadyTransferred,

BSR.szOpUserId,
BPE.szName AS szOpUserNm,

BOS_AR_Customer.szDefaultCcyId AS szCustDefaultCcyId_J,
BOS_AR_CustSales.decCreditLimit AS decCustCreditLimit_J,

CSAC.decCreditLimit AS decCustArClassCreditLimit_J

From
BOS_AR_ArMaster
Left Join BOS_AR_Customer On BOS_AR_Customer.szCustId = BOS_AR_ArMaster.szCustId
Left Join BOS_CU_Currency On BOS_CU_Currency.szCcyId = BOS_AR_ArMaster.szCcyId
LEFT JOIN BOS_SD_CustCollRoutine AS BSC ON BSC.szCustId = BOS_AR_Customer.szCustId
LEFT JOIN BOS_SD_Route AS BSR ON BSR.szRouteId = BSC.szDefaultRouteId
LEFT JOIN BOS_PI_Employee AS BPE ON BPE.szEmployeeId = BSR.szOpUserId
LEFT JOIN BOS_AR_CustSales ON BOS_AR_CustSales.szCustId = BOS_AR_Customer.szInvoiceToCustId
LEFT JOIN BOS_AR_CustSalesArClass AS CSAC ON CSAC.szCustId = BOS_AR_Customer.szInvoiceToCustId
AND CSAC.szArClassId = p_szArClassId
LEFT JOIN BOS_AR_ArMasterClass AS AMC ON AMC.szCustId = BOS_AR_ArMaster.szCustId
AND AMC.szCcyId = BOS_AR_ArMaster.szCcyId
AND AMC.szArClassId = p_szArClassId

Where
BOS_AR_ArMaster.szCustId LIKE p_szCustId And BOS_AR_ArMaster.szCcyId LIKE p_szCcyId;


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetListOfArMasterData_015(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_szArClassId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

Select
BOS_AR_ArMaster.szCustId,
BOS_AR_ArMaster.szCcyId,

BOS_AR_Customer.szName As szCustNm,
BOS_AR_Customer.szStatus AS szCustStatus_J,

BOS_AR_ArMaster.decAmount,
AMC.decAmount AS decArClassAmount,

BOS_CU_Currency.szSymbol as szCcySymbol,
BOS_CU_Currency.szAmountFormat,
BOS_AR_ArMaster.bBad,
BOS_AR_ArMaster.intNumberOfOpenInvoice,

-- Data Status.
BOS_AR_ArMaster.dtmLastUpdated,
BOS_AR_ArMaster.bAlreadyTransferred,

BSR.szOpUserId,
BPE.szName AS szOpUserNm,

BOS_AR_Customer.szDefaultCcyId AS szCustDefaultCcyId_J,
BOS_AR_CustSales.decCreditLimit AS decCustCreditLimit_J,

CSAC.decCreditLimit AS decCustArClassCreditLimit_J,
ISNULL(AMC.intNumberOfOpenInvoice,0) AS intNumberOfArClassOpenInvoice
From
BOS_AR_ArMaster
Left Join BOS_AR_Customer On BOS_AR_Customer.szCustId = BOS_AR_ArMaster.szCustId
Left Join BOS_CU_Currency On BOS_CU_Currency.szCcyId = BOS_AR_ArMaster.szCcyId
LEFT JOIN BOS_SD_CustCollRoutine AS BSC ON BSC.szCustId = BOS_AR_Customer.szCustId
LEFT JOIN BOS_SD_Route AS BSR ON BSR.szRouteId = BSC.szDefaultRouteId
LEFT JOIN BOS_PI_Employee AS BPE ON BPE.szEmployeeId = BSR.szOpUserId
LEFT JOIN BOS_AR_CustSales ON BOS_AR_CustSales.szCustId = BOS_AR_Customer.szInvoiceToCustId
LEFT JOIN BOS_AR_CustSalesArClass AS CSAC ON CSAC.szCustId = BOS_AR_Customer.szInvoiceToCustId
AND CSAC.szArClassId = p_szArClassId
LEFT JOIN BOS_AR_ArMasterClass AS AMC ON AMC.szCustId = BOS_AR_ArMaster.szCustId
AND AMC.szCcyId = BOS_AR_ArMaster.szCcyId
AND AMC.szArClassId = p_szArClassId

Where
BOS_AR_ArMaster.szCustId LIKE p_szCustId And BOS_AR_ArMaster.szCcyId LIKE p_szCcyId;



END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetListOfArTrans()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szTrnId,
szDocId,
szCustId,
shRevNo

FROM 
BOS_AR_ArTrans;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetListOfArTransThatIsPayedByMe(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_ArTransRefDoc.szRefTrnId,
BOS_AR_ArTransRefDoc.szRefDocId,
BOS_AR_ArTransRefDoc.szRefCustId,
BOS_AR_ArTransRefDoc.shRefRevno


FROM 
BOS_AR_ArTransRefDoc

WHERE 
BOS_AR_ArTransRefDoc.szTrnId = p_szTrnId and BOS_AR_ArTransRefDoc.szDocId = p_szDocId AND BOS_AR_ArTransRefDoc.szCustId LIKE p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetListOfArTransThatIsPayedByMe_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_ArTransRefDoc.szRefTrnId,
BOS_AR_ArTransRefDoc.szRefDocId,
BOS_AR_ArTransRefDoc.szRefCustId,
BOS_AR_ArTransRefDoc.shRefRevno


FROM 
BOS_AR_ArTransRefDoc

WHERE 
BOS_AR_ArTransRefDoc.szTrnId = p_szTrnId and BOS_AR_ArTransRefDoc.szDocId = p_szDocId AND BOS_AR_ArTransRefDoc.szCustId LIKE p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetListOfArTransThatPayMe(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_ArTransRefDoc.szTrnId,
BOS_AR_ArTransRefDoc.szDocId,
BOS_AR_ArTransRefDoc.szCustId,
BOS_AR_ArTransRefDoc.shRevno


FROM 
BOS_AR_ArTransRefDoc
WHERE 
BOS_AR_ArTransRefDoc.szRefTrnId = p_szTrnId AND BOS_AR_ArTransRefDoc.szRefDocId = p_szDocId AND BOS_AR_ArTransRefDoc.szRefCustId LIKE p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetListOfArTransThatPayMe_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_ArTransRefDoc.szTrnId,
BOS_AR_ArTransRefDoc.szDocId,
BOS_AR_ArTransRefDoc.szCustId,
BOS_AR_ArTransRefDoc.shRevno


FROM 
BOS_AR_ArTransRefDoc
WHERE 
BOS_AR_ArTransRefDoc.szRefTrnId = p_szTrnId AND BOS_AR_ArTransRefDoc.szRefDocId = p_szDocId AND BOS_AR_ArTransRefDoc.szRefCustId LIKE p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetListOfArTransThatPayMeIncludingMyself(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
art.szTrnId, art.szDocId, art.szCustId, art.shRevNo

FROM 
BOS_AR_ArTrans As art

Left Join BOS_AR_ArTransRefDoc As artrd On
artrd.szTrnId = art.szTrnId and artrd.szDocId = art.szDocId and artrd.szCustId = art.szCustId and artrd.shRevNo = art.shRevNo

WHERE 
(art.szTrnId = p_szTrnId and art.szDocId = p_szDocId and art.szCustId = p_szCustId and art.shRevNo = p_shRevNo) or (artrd.szRefTrnId = p_szTrnId and artrd.szRefDocId = p_szDocId and artrd.szRefCustId = p_szCustId and artrd.shRefRevNo = p_shRevNo) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetListOfArTransThatPayMeIncludingMyself_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
art.szTrnId, art.szDocId, art.szCustId, art.shRevNo

FROM 
BOS_AR_ArTrans As art

Left Join BOS_AR_ArTransRefDoc As artrd On
artrd.szTrnId = art.szTrnId and artrd.szDocId = art.szDocId and artrd.szCustId = art.szCustId and artrd.shRevNo = art.shRevNo

WHERE 
(art.szTrnId = p_szTrnId and art.szDocId = p_szDocId and art.szCustId = p_szCustId and art.shRevNo = p_shRevNo) or (artrd.szRefTrnId = p_szTrnId and artrd.szRefDocId = p_szDocId and artrd.szRefCustId = p_szCustId and artrd.shRefRevNo = p_shRevNo) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetListOfOpenSoAmount(
p_szInvToCustId BOS_DT_szId,
p_szArClassId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_szArClassId = ''
  THEN

Select
BSS.szFSoId,
(BSS.decAmount - BSS.decDownPayment) AS decRemainingAmount,
BSS.szCcyId,
BSS.szCcyRateId

From
BOS_AR_Customer AS BAC
LEFT JOIN BOS_SD_FSo AS BSS ON BSS.szCustId = BAC.szCustId

Where
BAC.szInvoiceToCustId = p_szInvToCustId
AND BSS.szCompletedFInvoiceId = '' AND BSS.bApplied = 1 AND BSS.szStatus = 'OPE';

ELSE

Select
BSS.szFSoId,

--This differs with case of empty AR class.
--So remaining AR class amount = down payment / amount * AR class amount.
BSS.decAmount,
BSS.decDownPayment,

(
SELECT isnull(sum(item.decAmount - item.decDiscount), 0) 
FROM BOS_SD_FSoItem AS item
LEFT JOIN BOS_INV_Product As P ON P.szProductId = item.szProductId
WHERE item.szFSoId = BSS.szFSoId
AND P.szArClassId = p_szArClassId
) AS decArClassAmount,

BSS.szCcyId,
BSS.szCcyRateId

From
BOS_AR_Customer AS BAC
LEFT JOIN BOS_SD_FSo AS BSS ON BSS.szCustId = BAC.szCustId

Where
BAC.szInvoiceToCustId = p_szInvToCustId
AND BSS.szCompletedFInvoiceId = '' AND BSS.bApplied = 1 AND BSS.szStatus = 'OPE';

END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetListOfOpenSoAmount_013(
p_szInvToCustId BOS_DT_szId,
p_szArClassId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_szArClassId = ''    
  THEN

Select    
BSS.szFSoId,    
(BSS.decAmount - BSS.decDownPayment - ISNULL(FDO.decAmount, 0)) AS decRemainingAmount, 
BSS.szCcyId,    
BSS.szCcyRateId    

From    
BOS_AR_Customer AS BAC    
LEFT JOIN BOS_SD_FSo AS BSS ON BSS.szCustId = BAC.szCustId    
LEFT JOIN (SELECT szFSoId, bApplied, SUM(decAmount) AS decAmount FROM BOS_SD_FDo GROUP BY szFSoId, bApplied) FDO 
ON FDO.szFSoId = BSS.szFSoId AND FDO.bApplied = 1   
Where    
BAC.szInvoiceToCustId = p_szInvToCustId    
AND BSS.szCompletedFInvoiceId = '' AND BSS.bApplied = 1 AND BSS.szStatus = 'OPE';    

ELSE    

Select    
BSS.szFSoId,    

--This differs with case of empty AR class.    
--So remaining AR class amount = down payment / amount * AR class amount.    
BSS.decAmount,    
BSS.decDownPayment,    

(    
SELECT isnull(sum(item.decAmount - item.decDiscount), 0) - ISNULL(SUM(FDO.decAmount), 0)   
FROM BOS_SD_FSoItem AS item    
LEFT JOIN BOS_INV_Product As P ON P.szProductId = item.szProductId   
LEFT JOIN 
(
SELECT A.szFSoId, A.bApplied, C.szArClassId, SUM(B.decAmount - B.decDiscount) AS decAmount
FROM BOS_SD_FDo A 
LEFT JOIN BOS_SD_FDoItem B ON B.szDoId = A.szDoId
LEFT JOIN BOS_INV_Product C ON C.szProductId = B.szProductId 
GROUP BY A.szFSoId, A.bApplied, C.szArClassId
) FDO ON FDO.szFSoId = BSS.szFSoId AND FDo.szArClassId = p_szArClassId AND FDO.bApplied = 1
WHERE item.szFSoId = BSS.szFSoId AND P.szArClassId = p_szArClassId   
) AS decArClassAmount,    

BSS.szCcyId,    
BSS.szCcyRateId    

From    
BOS_AR_Customer AS BAC    
LEFT JOIN BOS_SD_FSo AS BSS ON BSS.szCustId = BAC.szCustId    

Where    
BAC.szInvoiceToCustId = p_szInvToCustId    
AND BSS.szCompletedFInvoiceId = '' AND BSS.bApplied = 1 AND BSS.szStatus = 'OPE';    


END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetListOfOutstandingDOAmount(
p_szInvToCustId BOS_DT_szId,
p_do_not_check_szFDoId BOS_DT_szId,
p_szArClassId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_szArClassId = ''
  THEN

Select
BSD.szCcyId,
BSD.szCcyRateId,
sum(BSD.decAmount) AS decOutstandingDOAmount

From
BOS_AR_Customer AS BAC
LEFT JOIN BOS_SD_FDo AS BSD ON BSD.szCustId = BAC.szCustId

Where
BAC.szInvoiceToCustId = p_szInvToCustId
AND BSD.szFInvoiceId = '' 
AND BSD.szDoId <> p_do_not_check_szFDoId 
AND BSD.bApplied = 1 AND BSD.szFSoId = ''

GROUP BY
BSD.szCcyId,
BSD.szCcyRateId;

ELSE

Select
BSD.szCcyId,
BSD.szCcyRateId,

--This differs with case of empty AR class id.
(
SELECT ISNULL(SUM(item.decAmount - item.decDiscount), 0)
FROM BOS_SD_FDoItem AS item
LEFT JOIN BOS_INV_Product AS P ON P.szProductId = item.szProductId
WHERE item.szDoId = BSD.szDoId
AND P.szArClassId = p_szArClassId
) AS decOutstandingDOAmount

From
BOS_AR_Customer AS BAC
LEFT JOIN BOS_SD_FDo AS BSD ON BSD.szCustId = BAC.szCustId

Where
BAC.szInvoiceToCustId = p_szInvToCustId
AND BSD.szFInvoiceId = '' 
AND BSD.szDoId <> p_do_not_check_szFDoId 
AND BSD.bApplied = 1 AND BSD.szFSoId = '';

--Cannot group-by as the case of empty AR class id.
--GROUP BY
--BSD.szCcyId,
--BSD.szCcyRateId

END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_GetOldestAgingArOfCustomer(
p_szInvCustId BOS_DT_szId,
p_szArClassId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BAT.dtmPeriode

FROM 
BOS_AR_ArTrans As BAT
Left Join BOS_AR_Customer As BAC On BAT.szCustId = BAC.szCustId

WHERE 
BAT.bClosed = 0 And BAT.szCustId Like p_szInvCustId And (BAT.szTrnId = 'FInv' Or BAT.szTrnId = 'PDREC') AND BAT.szArClassId LIKE p_szArClassId 
ORDER BY 
BAT.dtmPeriode
LIMIT 1;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_IsArMasterExist(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId,
szCcyId

FROM 
BOS_AR_ArMaster
WHERE 
szCustId = p_szCustId And szCcyId = p_szCcyId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_IsArTransClosed(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
bClosed

FROM 
BOS_AR_ArTrans
WHERE 
 szTrnId = p_szTrnId And szDocId = p_szDocId And szCustId like p_szCustId And shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_IsArTransClosed_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
bClosed

FROM 
BOS_AR_ArTrans
WHERE 
 szTrnId = p_szTrnId And szDocId = p_szDocId And szCustId like p_szCustId And shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_IsArTransExist(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szTrnId

FROM 
BOS_AR_ArTrans
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szCustId like p_szCustId And shRevNo = p_shRevNo ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_IsArTransExist_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szTrnId

FROM 
BOS_AR_ArTrans
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szCustId like p_szCustId And shRevNo = p_shRevNo ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_LockArMaster(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_ArMaster
SET 
decAmount = decAmount
WHERE 
szCustId = p_szCustId And szCcyId = p_szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_LockArTrans(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_ArTrans
SET 
szDescription = szDescription
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szCustId = p_szCustId And shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_LockArTrans_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_shRevNo smallint)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_ArTrans
SET 
szDescription = szDescription
WHERE 
szTrnId = p_szTrnId And szDocId = p_szDocId And szCustId = p_szCustId And shRevNo = p_shRevNo;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_TransItemReason(
p_szTrnId BOS_DT_szId,
p_szDocId BOS_DT_szId,
p_dtmDate timestamp,
p_szReasonId BOS_DT_szId,
p_szEmployeeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_ArTransItemReason
(
szTrnId,
szDocId,
dtmDate,
SzReasonId,
szEmployeeId
)
VALUES
(
p_szTrnId,
p_szDocId,
p_dtmDate,
p_SzReasonId,
p_szEmployeeId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_TransItemReason_013(
p_szTrnId BOS_DT_szId,
p_szDocId BOS_DT_szId,
p_dtmDate timestamp,
p_szReasonId BOS_DT_szId,
p_szEmployeeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_ArTransItemReason
(
szTrnId,
szDocId,
dtmDate,
SzReasonId,
szEmployeeId
)
VALUES
(
p_szTrnId,
p_szDocId,
p_dtmDate,
p_SzReasonId,
p_szEmployeeId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_UpdateArMaster(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_decAmount BOS_DT_decAmount,
p_bBad bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_ArMaster
SET 
decAmount = p_decAmount,
bBad = p_bBad
WHERE 
szCustId = p_szCustId And szCcyId = p_szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_UpdateArMaster_014(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_decAmount BOS_DT_decAmount,
p_bBad bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_ArMaster
SET 
decAmount = p_decAmount,
bBad = p_bBad
WHERE 
szCustId = p_szCustId And szCcyId = p_szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_UpdateArMasterWithAmountInArTrans()
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_ArMaster
(
szCustId,
szCcyId,
decAmount,
bBad,
-- Data Status.
dtmLastUpdated
)
(SELECT distinct BOS_AR_ArTrans.szCustId, BOS_AR_ArTrans.szCcyId, 0, 0, '1971-02-16', 0
from BOS_AR_ArTrans
left join BOS_AR_ArMaster as M on M.szCustId = BOS_AR_ArTrans.szCustId and M.szCcyId = BOS_AR_ArTrans.szCcyId
where
	BOS_AR_ArTrans.bClosed = 0 
	and BOS_AR_ArTrans.decRemain <> 0
	and BOS_AR_ArTrans.szTrnId = 'FInv'
	and M.szCustId is null
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_UpdateFInvoiceStatusOnAr(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szFInvoiceStatus varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_ArTrans
SET 
 szFInvoiceStatus = p_szFInvoiceStatus
WHERE 
 szTrnId = p_szTrnId And szDocId = p_szDocId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Ar_UpdateFInvoiceStatusOnAr_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szFInvoiceStatus varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_ArTrans
SET 
 szFInvoiceStatus = p_szFInvoiceStatus
WHERE 
 szTrnId = p_szTrnId And szDocId = p_szDocId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Category_CreateCategory(
p_szCategoryId BOS_DT_szId,
p_szCategoryType varchar,
p_szDescription varchar,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_Category
(
szCategoryId ,
szCategoryType,
szDescription,
szPriceId,
szPromoPriceId,
szPriceOrderId,
szPromoPriceOrderId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCategoryId,
p_szCategoryType,
p_szDescription,
p_szPriceId,
p_szPromoPriceId,
p_szPriceOrderId,
p_szPromoPriceOrderId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Category_CreateCategory_013(
p_szCategoryId BOS_DT_szId,
p_szCategoryType varchar,
p_szDescription varchar,
p_szParentCategory varchar,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_Category
(
szCategoryId ,
szCategoryType,
szDescription,
szParentCategory,
szPriceId,
szPromoPriceId,
szPriceOrderId,
szPromoPriceOrderId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCategoryId,
p_szCategoryType,
p_szDescription,
p_szParentCategory,
p_szPriceId,
p_szPromoPriceId,
p_szPriceOrderId,
p_szPromoPriceOrderId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Category_DeleteCategory(
p_szCategoryId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Category_GetCategory(
p_szCategoryId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCategoryType

FROM 
BOS_AR_Category
WHERE 
szCategoryId = p_szCategoryId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Category_GetCategory_014(
p_szCategoryId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCategoryType

FROM 
BOS_AR_Category
WHERE 
szCategoryId = p_szCategoryId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Category_GetListOfCategory()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCategoryId

FROM 
BOS_AR_Category;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Category_IsCategoryExist(
p_szCategoryId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCategoryType 

FROM 
BOS_AR_Category 
WHERE 
szCategoryId = p_szCategoryId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Category_LockCategory(
p_szCategoryId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_Category
SET 
szCategoryType = szCategoryType,
szParentCategory = szParentCategory
WHERE 
szCategoryId = p_szCategoryId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Category_LockCategory_014(
p_szCategoryId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_Category
SET 
szCategoryType = szCategoryType,
szParentCategory = szParentCategory
WHERE 
szCategoryId = p_szCategoryId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Category_UpdateCategory(
p_szCategoryId BOS_DT_szId,
p_szCategoryType varchar,
p_szDescription BOS_DT_szDescription,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_Category
SET 
szCategoryId = p_szCategoryId ,
szCategoryType = p_szCategoryType,
szDescription = p_szDescription,
szPriceId = p_szPriceId,
szPromoPriceId = p_szPromoPriceId,
szPriceOrderId = p_szPriceOrderId,
szPromoPriceOrderId = p_szPromoPriceOrderId

WHERE 
szCategoryId   = p_szCategoryId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Category_UpdateCategory_013(
p_szCategoryId BOS_DT_szId,
p_szCategoryType varchar,
p_szDescription BOS_DT_szDescription,
p_szParentCategory varchar,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_Category
SET 
szCategoryId = p_szCategoryId ,
szCategoryType = p_szCategoryType,
szDescription = p_szDescription,
szParentCategory = p_szParentCategory,
szPriceId = p_szPriceId,
szPromoPriceId = p_szPromoPriceId,
szPriceOrderId = p_szPriceOrderId,
szPromoPriceOrderId = p_szPromoPriceOrderId

WHERE 
szCategoryId   = p_szCategoryId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CategoryType_CreateCategoryType(
p_szCategoryType varchar,
p_szDescription BOS_DT_szDescription,
p_szParentCategoryType varchar,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_CategoryType
(
szCategoryType,
szDescription,
szParentCategoryType,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCategoryType,
p_szDescription,
p_szParentCategoryType,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CategoryType_CreateCategoryType_014(
p_szCategoryType varchar,
p_szDescription BOS_DT_szDescription,
p_szParentCategoryType varchar,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_CategoryType
(
szCategoryType,
szDescription,
szParentCategoryType,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCategoryType,
p_szDescription,
p_szParentCategoryType,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CategoryType_DeleteCategoryType(
p_szCategoryType varchar)
RETURNS void AS
$BODY$
BEGIN
DELETE 
  FROM BOS_AR_CategoryType
WHERE
szCategoryType = p_szCategoryType;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CategoryType_GetCategoryType(
p_szCategoryType varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
dtmLastUpdated,
bAlreadyTransferred,
szParentCategoryType

FROM 
BOS_AR_CategoryType
WHERE 
szCategoryType=p_szCategoryType ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CategoryType_GetCategoryType_014(
p_szCategoryType varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
dtmLastUpdated,
bAlreadyTransferred,
szParentCategoryType

FROM 
BOS_AR_CategoryType
WHERE 
szCategoryType=p_szCategoryType ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CategoryType_GetListOfCategoryType()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCategoryType, szDescription, szParentCategoryType

FROM 
BOS_AR_CategoryType;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CategoryType_GetListOfCategoryType_014()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCategoryType, szDescription, szParentCategoryType

FROM 
BOS_AR_CategoryType;


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CategoryType_IsCategoryTypeExist(
p_szCategoryType varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription, szParentCategoryType

FROM 
BOS_AR_CategoryType
WHERE 
szCategoryType=p_szCategoryType ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CategoryType_IsCategoryTypeExist_014(
p_szCategoryType varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription, szParentCategoryType

FROM 
BOS_AR_CategoryType
WHERE 
szCategoryType=p_szCategoryType ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CategoryType_LockCategoryType(
p_szCategoryType varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_CategoryType
SET 
szDescription = szDescription,
szParentCategoryType = szParentCategoryType
WHERE 
szCategoryType = p_szCategoryType;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CategoryType_LockCategoryType_014(
p_szCategoryType varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_CategoryType
SET 
szDescription = szDescription,
szParentCategoryType = szParentCategoryType
WHERE 
szCategoryType = p_szCategoryType;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CategoryType_UpdateCategoryType(
p_szCategoryType varchar,
p_szDescription BOS_DT_szDescription,
p_szParentCategoryType varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_CategoryType
SET 
szDescription = p_szDescription,
szParentCategoryType = p_szParentCategoryType
WHERE 
szCategoryType = p_szCategoryType;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CategoryType_UpdateCategoryType_014(
p_szCategoryType varchar,
p_szDescription BOS_DT_szDescription,
p_szParentCategoryType varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_CategoryType
SET 
szDescription = p_szDescription,
szParentCategoryType = p_szParentCategoryType
WHERE 
szCategoryType = p_szCategoryType;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustInvoice_CreateCustInvoice(
p_szCustId BOS_DT_szId,
p_szCustInvoiceNm BOS_DT_szName,
p_szCustTaxNm BOS_DT_szName,
p_szCustCollectNm BOS_DT_szName,
p_InvoiceszContactPerson BOS_DT_szName,
p_InvoiceszRoomNo BOS_DT_szSmallName,
p_InvoiceszFloor BOS_DT_szSmallName,
p_InvoiceszBuilding BOS_DT_szName,
p_InvoiceszAddress_1 BOS_DT_szBigDescription,
p_InvoiceszAddress_2 BOS_DT_szBigDescription,
p_InvoiceszDistrict BOS_DT_szMediumName,
p_InvoiceszCity BOS_DT_szMediumName,
p_InvoiceszZipCode BOS_DT_szSmallName,
p_InvoiceszState BOS_DT_szMediumName,
p_InvoiceszCountry BOS_DT_szMediumName,
p_InvoiceszPhoneNo_1 BOS_DT_szMediumName,
p_InvoiceszPhoneNo_2 BOS_DT_szMediumName,
p_InvoiceszFaxNo BOS_DT_szMediumName,
p_InvoiceszMobileNo BOS_DT_szMediumName,
p_InvoiceszEmail BOS_DT_szMediumName,
p_InvoiceszWebSite BOS_DT_szMediumName,
p_bIsDiffTaxAddress bit,
p_TaxszContactPerson BOS_DT_szName,
p_TaxszRoomNo BOS_DT_szSmallName,
p_TaxszFloor BOS_DT_szSmallName,
p_TaxszBuilding BOS_DT_szName,
p_TaxszAddress_1 BOS_DT_szBigDescription,
p_TaxszAddress_2 BOS_DT_szBigDescription,
p_TaxszDistrict BOS_DT_szMediumName,
p_TaxszCity BOS_DT_szMediumName,
p_TaxszZipCode BOS_DT_szSmallName,
p_TaxszState BOS_DT_szMediumName,
p_TaxszCountry BOS_DT_szMediumName,
p_TaxszPhoneNo_1 BOS_DT_szMediumName,
p_TaxszPhoneNo_2 BOS_DT_szMediumName,
p_TaxszFaxNo BOS_DT_szMediumName,
p_TaxszMobileNo BOS_DT_szMediumName,
p_TaxszEmail BOS_DT_szMediumName,
p_TaxszWebSite BOS_DT_szMediumName,
p_bIsDiffCollectAddress bit,
p_CollectszContactPerson BOS_DT_szName,
p_CollectszRoomNo BOS_DT_szSmallName,
p_CollectszFloor BOS_DT_szSmallName,
p_CollectszBuilding BOS_DT_szName,
p_CollectszAddress_1 BOS_DT_szBigDescription,
p_CollectszAddress_2 BOS_DT_szBigDescription,
p_CollectszDistrict BOS_DT_szMediumName,
p_CollectszCity BOS_DT_szMediumName,
p_CollectszZipCode BOS_DT_szSmallName,
p_CollectszState BOS_DT_szMediumName,
p_CollectszCountry BOS_DT_szMediumName,
p_CollectszPhoneNo_1 BOS_DT_szMediumName,
p_CollectszPhoneNo_2 BOS_DT_szMediumName,
p_CollectszFaxNo BOS_DT_szMediumName,
p_CollectszMobileNo BOS_DT_szMediumName,
p_CollectszEmail BOS_DT_szMediumName,
p_CollectszWebSite BOS_DT_szMediumName,
p_bLock bit,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_CustInvoice
(
szCustId,
szCustInvoiceNm ,
szCustTaxNm ,
szCustCollectNm ,
InvoiceszContactPerson,
InvoiceszRoomNo,
InvoiceszFloor,
InvoiceszBuilding,
InvoiceszAddress_1,
InvoiceszAddress_2,
InvoiceszDistrict,
InvoiceszCity,
InvoiceszZipCode,
InvoiceszState,
InvoiceszCountry,
InvoiceszPhoneNo_1,
InvoiceszPhoneNo_2,
InvoiceszFaxNo,
InvoiceszMobileNo,
InvoiceszEmail,
InvoiceszWebSite,
bIsDiffTaxAddress,
TaxszContactPerson,
TaxszRoomNo,
TaxszFloor,
TaxszBuilding,
TaxszAddress_1,
TaxszAddress_2,
TaxszDistrict,
TaxszCity,
TaxszZipCode,
TaxszState,
TaxszCountry,
TaxszPhoneNo_1,
TaxszPhoneNo_2,
TaxszFaxNo,
TaxszMobileNo,
TaxszEmail,
TaxszWebSite,
bIsDiffCollectAddress,
CollectszContactPerson,
CollectszRoomNo,
CollectszFloor,
CollectszBuilding,
CollectszAddress_1,
CollectszAddress_2,
CollectszDistrict,
CollectszCity,
CollectszZipCode,
CollectszState,
CollectszCountry,
CollectszPhoneNo_1,
CollectszPhoneNo_2,
CollectszFaxNo,
CollectszMobileNo,
CollectszEmail,
CollectszWebSite,
bLock,
dtmLastUpdated
)
VALUES
(
p_szCustId,
p_szCustInvoiceNm ,
p_szCustTaxNm ,
p_szCustCollectNm ,
p_InvoiceszContactPerson,
p_InvoiceszRoomNo,
p_InvoiceszFloor,
p_InvoiceszBuilding,
p_InvoiceszAddress_1,
p_InvoiceszAddress_2,
p_InvoiceszDistrict,
p_InvoiceszCity,
p_InvoiceszZipCode,
p_InvoiceszState,
p_InvoiceszCountry,
p_InvoiceszPhoneNo_1,
p_InvoiceszPhoneNo_2,
p_InvoiceszFaxNo,
p_InvoiceszMobileNo,
p_InvoiceszEmail,
p_InvoiceszWebSite,
p_bIsDiffTaxAddress,
p_TaxszContactPerson,
p_TaxszRoomNo,
p_TaxszFloor,
p_TaxszBuilding,
p_TaxszAddress_1,
p_TaxszAddress_2,
p_TaxszDistrict,
p_TaxszCity,
p_TaxszZipCode,
p_TaxszState,
p_TaxszCountry,
p_TaxszPhoneNo_1,
p_TaxszPhoneNo_2,
p_TaxszFaxNo,
p_TaxszMobileNo,
p_TaxszEmail,
p_TaxszWebSite,
p_bIsDiffCollectAddress,
p_CollectszContactPerson,
p_CollectszRoomNo,
p_CollectszFloor,
p_CollectszBuilding,
p_CollectszAddress_1,
p_CollectszAddress_2,
p_CollectszDistrict,
p_CollectszCity,
p_CollectszZipCode,
p_CollectszState,
p_CollectszCountry,
p_CollectszPhoneNo_1,
p_CollectszPhoneNo_2,
p_CollectszFaxNo,
p_CollectszMobileNo,
p_CollectszEmail,
p_CollectszWebSite,
p_bLock,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustInvoice_CreateCustInvoice_013(
p_szCustId BOS_DT_szId,
p_szCustInvoiceNm BOS_DT_szName,
p_szCustTaxNm BOS_DT_szName,
p_szCustCollectNm BOS_DT_szName,
p_InvoiceszContactPerson BOS_DT_szName,
p_InvoiceszRoomNo BOS_DT_szSmallName,
p_InvoiceszFloor BOS_DT_szSmallName,
p_InvoiceszBuilding BOS_DT_szName,
p_InvoiceszAddress_1 BOS_DT_szBigDescription,
p_InvoiceszAddress_2 BOS_DT_szBigDescription,
p_InvoiceszDistrict BOS_DT_szName,
p_InvoiceszCity BOS_DT_szMediumName,
p_InvoiceszZipCode BOS_DT_szSmallName,
p_InvoiceszState BOS_DT_szMediumName,
p_InvoiceszCountry BOS_DT_szMediumName,
p_InvoiceszPhoneNo_1 BOS_DT_szMediumName,
p_InvoiceszPhoneNo_2 BOS_DT_szMediumName,
p_InvoiceszFaxNo BOS_DT_szMediumName,
p_InvoiceszMobileNo BOS_DT_szMediumName,
p_InvoiceszEmail BOS_DT_szMediumName,
p_InvoiceszWebSite BOS_DT_szMediumName,
p_bIsDiffTaxAddress bit,
p_TaxszContactPerson BOS_DT_szName,
p_TaxszRoomNo BOS_DT_szSmallName,
p_TaxszFloor BOS_DT_szSmallName,
p_TaxszBuilding BOS_DT_szName,
p_TaxszAddress_1 BOS_DT_szBigDescription,
p_TaxszAddress_2 BOS_DT_szBigDescription,
p_TaxszDistrict BOS_DT_szName,
p_TaxszCity BOS_DT_szMediumName,
p_TaxszZipCode BOS_DT_szSmallName,
p_TaxszState BOS_DT_szMediumName,
p_TaxszCountry BOS_DT_szMediumName,
p_TaxszPhoneNo_1 BOS_DT_szMediumName,
p_TaxszPhoneNo_2 BOS_DT_szMediumName,
p_TaxszFaxNo BOS_DT_szMediumName,
p_TaxszMobileNo BOS_DT_szMediumName,
p_TaxszEmail BOS_DT_szMediumName,
p_TaxszWebSite BOS_DT_szMediumName,
p_bIsDiffCollectAddress bit,
p_CollectszContactPerson BOS_DT_szName,
p_CollectszRoomNo BOS_DT_szSmallName,
p_CollectszFloor BOS_DT_szSmallName,
p_CollectszBuilding BOS_DT_szName,
p_CollectszAddress_1 BOS_DT_szBigDescription,
p_CollectszAddress_2 BOS_DT_szBigDescription,
p_CollectszDistrict BOS_DT_szName,
p_CollectszCity BOS_DT_szMediumName,
p_CollectszZipCode BOS_DT_szSmallName,
p_CollectszState BOS_DT_szMediumName,
p_CollectszCountry BOS_DT_szMediumName,
p_CollectszPhoneNo_1 BOS_DT_szMediumName,
p_CollectszPhoneNo_2 BOS_DT_szMediumName,
p_CollectszFaxNo BOS_DT_szMediumName,
p_CollectszMobileNo BOS_DT_szMediumName,
p_CollectszEmail BOS_DT_szMediumName,
p_CollectszWebSite BOS_DT_szMediumName,
p_bLock bit,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_CustInvoice
(
szCustId,
szCustInvoiceNm ,
szCustTaxNm ,
szCustCollectNm ,
InvoiceszContactPerson,
InvoiceszRoomNo,
InvoiceszFloor,
InvoiceszBuilding,
InvoiceszAddress_1,
InvoiceszAddress_2,
InvoiceszDistrict,
InvoiceszCity,
InvoiceszZipCode,
InvoiceszState,
InvoiceszCountry,
InvoiceszPhoneNo_1,
InvoiceszPhoneNo_2,
InvoiceszFaxNo,
InvoiceszMobileNo,
InvoiceszEmail,
InvoiceszWebSite,
bIsDiffTaxAddress,
TaxszContactPerson,
TaxszRoomNo,
TaxszFloor,
TaxszBuilding,
TaxszAddress_1,
TaxszAddress_2,
TaxszDistrict,
TaxszCity,
TaxszZipCode,
TaxszState,
TaxszCountry,
TaxszPhoneNo_1,
TaxszPhoneNo_2,
TaxszFaxNo,
TaxszMobileNo,
TaxszEmail,
TaxszWebSite,
bIsDiffCollectAddress,
CollectszContactPerson,
CollectszRoomNo,
CollectszFloor,
CollectszBuilding,
CollectszAddress_1,
CollectszAddress_2,
CollectszDistrict,
CollectszCity,
CollectszZipCode,
CollectszState,
CollectszCountry,
CollectszPhoneNo_1,
CollectszPhoneNo_2,
CollectszFaxNo,
CollectszMobileNo,
CollectszEmail,
CollectszWebSite,
bLock,
dtmLastUpdated
)
VALUES
(
p_szCustId,
p_szCustInvoiceNm ,
p_szCustTaxNm ,
p_szCustCollectNm ,
p_InvoiceszContactPerson,
p_InvoiceszRoomNo,
p_InvoiceszFloor,
p_InvoiceszBuilding,
p_InvoiceszAddress_1,
p_InvoiceszAddress_2,
p_InvoiceszDistrict,
p_InvoiceszCity,
p_InvoiceszZipCode,
p_InvoiceszState,
p_InvoiceszCountry,
p_InvoiceszPhoneNo_1,
p_InvoiceszPhoneNo_2,
p_InvoiceszFaxNo,
p_InvoiceszMobileNo,
p_InvoiceszEmail,
p_InvoiceszWebSite,
p_bIsDiffTaxAddress,
p_TaxszContactPerson,
p_TaxszRoomNo,
p_TaxszFloor,
p_TaxszBuilding,
p_TaxszAddress_1,
p_TaxszAddress_2,
p_TaxszDistrict,
p_TaxszCity,
p_TaxszZipCode,
p_TaxszState,
p_TaxszCountry,
p_TaxszPhoneNo_1,
p_TaxszPhoneNo_2,
p_TaxszFaxNo,
p_TaxszMobileNo,
p_TaxszEmail,
p_TaxszWebSite,
p_bIsDiffCollectAddress,
p_CollectszContactPerson,
p_CollectszRoomNo,
p_CollectszFloor,
p_CollectszBuilding,
p_CollectszAddress_1,
p_CollectszAddress_2,
p_CollectszDistrict,
p_CollectszCity,
p_CollectszZipCode,
p_CollectszState,
p_CollectszCountry,
p_CollectszPhoneNo_1,
p_CollectszPhoneNo_2,
p_CollectszFaxNo,
p_CollectszMobileNo,
p_CollectszEmail,
p_CollectszWebSite,
p_bLock,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustInvoice_DeleteCustInvoice(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_AR_CustInvoice
WHERE
szCustId = p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustInvoice_GetCustInvoice(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId,
szCustInvoiceNm,
szCustTaxNm,
szCustCollectNm,
InvoiceszContactPerson,
InvoiceszRoomNo,
InvoiceszFloor,
InvoiceszBuilding,
InvoiceszAddress_1,
InvoiceszAddress_2,
InvoiceszDistrict,
InvoiceszCity,
InvoiceszZipCode,
InvoiceszState,
InvoiceszCountry,
InvoiceszPhoneNo_1,
InvoiceszPhoneNo_2,
InvoiceszFaxNo,
InvoiceszMobileNo,
InvoiceszEmail,
InvoiceszWebSite,
bIsDiffTaxAddress,
TaxszContactPerson,
TaxszRoomNo,
TaxszFloor,
TaxszBuilding,
TaxszAddress_1,
TaxszAddress_2,
TaxszDistrict,
TaxszCity,
TaxszZipCode,
TaxszState,
TaxszCountry,
TaxszPhoneNo_1,
TaxszPhoneNo_2,
TaxszFaxNo,
TaxszMobileNo,
TaxszEmail,
TaxszWebSite,
bIsDiffCollectAddress,
CollectszContactPerson,
CollectszRoomNo,
CollectszFloor,
CollectszBuilding,
CollectszAddress_1,
CollectszAddress_2,
CollectszDistrict,
CollectszCity,
CollectszZipCode,
CollectszState,
CollectszCountry,
CollectszPhoneNo_1,
CollectszPhoneNo_2,
CollectszFaxNo,
CollectszMobileNo,
CollectszEmail,
CollectszWebSite,

dtmLastUpdated


FROM 
BOS_AR_CustInvoice
WHERE 
szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustInvoice_GetCustInvoice_014(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId,
szCustInvoiceNm,
szCustTaxNm,
szCustCollectNm,
InvoiceszContactPerson,
InvoiceszRoomNo,
InvoiceszFloor,
InvoiceszBuilding,
InvoiceszAddress_1,
InvoiceszAddress_2,
InvoiceszDistrict,
InvoiceszCity,
InvoiceszZipCode,
InvoiceszState,
InvoiceszCountry,
InvoiceszPhoneNo_1,
InvoiceszPhoneNo_2,
InvoiceszFaxNo,
InvoiceszMobileNo,
InvoiceszEmail,
InvoiceszWebSite,
bIsDiffTaxAddress,
TaxszContactPerson,
TaxszRoomNo,
TaxszFloor,
TaxszBuilding,
TaxszAddress_1,
TaxszAddress_2,
TaxszDistrict,
TaxszCity,
TaxszZipCode,
TaxszState,
TaxszCountry,
TaxszPhoneNo_1,
TaxszPhoneNo_2,
TaxszFaxNo,
TaxszMobileNo,
TaxszEmail,
TaxszWebSite,
bIsDiffCollectAddress,
CollectszContactPerson,
CollectszRoomNo,
CollectszFloor,
CollectszBuilding,
CollectszAddress_1,
CollectszAddress_2,
CollectszDistrict,
CollectszCity,
CollectszZipCode,
CollectszState,
CollectszCountry,
CollectszPhoneNo_1,
CollectszPhoneNo_2,
CollectszFaxNo,
CollectszMobileNo,
CollectszEmail,
CollectszWebSite,

dtmLastUpdated


FROM 
BOS_AR_CustInvoice
WHERE 
szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustInvoice_GetListOfCustInvoice()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId,
InvoiceszContactPerson,
InvoiceszRoomNo,
InvoiceszFloor,
InvoiceszBuilding,
InvoiceszAddress_1,
InvoiceszAddress_2,
InvoiceszDistrict,
InvoiceszCity,
InvoiceszZipCode,
InvoiceszState,
InvoiceszCountry,
InvoiceszPhoneNo_1,
InvoiceszPhoneNo_2,
InvoiceszFaxNo,
InvoiceszMobileNo,
InvoiceszEmail,
InvoiceszWebSite,
bIsDiffTaxAddress,
TaxszContactPerson,
TaxszRoomNo,
TaxszFloor,
TaxszBuilding,
TaxszAddress_1,
TaxszAddress_2,
TaxszDistrict,
TaxszCity,
TaxszZipCode,
TaxszState,
TaxszCountry,
TaxszPhoneNo_1,
TaxszPhoneNo_2,
TaxszFaxNo,
TaxszMobileNo,
TaxszEmail,
TaxszWebSite,
bIsDiffCollectAddress,
CollectszContactPerson,
CollectszRoomNo,
CollectszFloor,
CollectszBuilding,
CollectszAddress_1,
CollectszAddress_2,
CollectszDistrict,
CollectszCity,
CollectszZipCode,
CollectszState,
CollectszCountry,
CollectszPhoneNo_1,
CollectszPhoneNo_2,
CollectszFaxNo,
CollectszMobileNo,
CollectszEmail,
CollectszWebSite,
bLock

FROM 
BOS_AR_CustInvoice;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustInvoice_IsCustInvoiceExist(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId

FROM 
BOS_AR_CustInvoice
WHERE 
szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustInvoice_IsExistCustInvoice(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId 

FROM 
BOS_AR_CustInvoice 
WHERE 
szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustInvoice_LockCustInvoice(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_CustInvoice
SET 
bLock = bLock
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustInvoice_UpdateCustInvoice(
p_szCustId BOS_DT_szId,
p_szCustInvoiceNm BOS_DT_szName,
p_szCustTaxNm BOS_DT_szName,
p_szCustCollectNm BOS_DT_szName,
p_InvoiceszContactPerson BOS_DT_szName,
p_InvoiceszRoomNo BOS_DT_szSmallName,
p_InvoiceszFloor BOS_DT_szSmallName,
p_InvoiceszBuilding BOS_DT_szName,
p_InvoiceszAddress_1 BOS_DT_szBigDescription,
p_InvoiceszAddress_2 BOS_DT_szBigDescription,
p_InvoiceszDistrict BOS_DT_szMediumName,
p_InvoiceszCity BOS_DT_szMediumName,
p_InvoiceszZipCode BOS_DT_szSmallName,
p_InvoiceszState BOS_DT_szMediumName,
p_InvoiceszCountry BOS_DT_szMediumName,
p_InvoiceszPhoneNo_1 BOS_DT_szMediumName,
p_InvoiceszPhoneNo_2 BOS_DT_szMediumName,
p_InvoiceszFaxNo BOS_DT_szMediumName,
p_InvoiceszMobileNo BOS_DT_szMediumName,
p_InvoiceszEmail BOS_DT_szMediumName,
p_InvoiceszWebSite BOS_DT_szMediumName,
p_bIsDiffTaxAddress bit,
p_TaxszContactPerson BOS_DT_szName,
p_TaxszRoomNo BOS_DT_szSmallName,
p_TaxszFloor BOS_DT_szSmallName,
p_TaxszBuilding BOS_DT_szName,
p_TaxszAddress_1 BOS_DT_szBigDescription,
p_TaxszAddress_2 BOS_DT_szBigDescription,
p_TaxszDistrict BOS_DT_szMediumName,
p_TaxszCity BOS_DT_szMediumName,
p_TaxszZipCode BOS_DT_szSmallName,
p_TaxszState BOS_DT_szMediumName,
p_TaxszCountry BOS_DT_szMediumName,
p_TaxszPhoneNo_1 BOS_DT_szMediumName,
p_TaxszPhoneNo_2 BOS_DT_szMediumName,
p_TaxszFaxNo BOS_DT_szMediumName,
p_TaxszMobileNo BOS_DT_szMediumName,
p_TaxszEmail BOS_DT_szMediumName,
p_TaxszWebSite BOS_DT_szMediumName,
p_bIsDiffCollectAddress bit,
p_CollectszContactPerson BOS_DT_szName,
p_CollectszRoomNo BOS_DT_szSmallName,
p_CollectszFloor BOS_DT_szSmallName,
p_CollectszBuilding BOS_DT_szName,
p_CollectszAddress_1 BOS_DT_szBigDescription,
p_CollectszAddress_2 BOS_DT_szBigDescription,
p_CollectszDistrict BOS_DT_szMediumName,
p_CollectszCity BOS_DT_szMediumName,
p_CollectszZipCode BOS_DT_szSmallName,
p_CollectszState BOS_DT_szMediumName,
p_CollectszCountry BOS_DT_szMediumName,
p_CollectszPhoneNo_1 BOS_DT_szMediumName,
p_CollectszPhoneNo_2 BOS_DT_szMediumName,
p_CollectszFaxNo BOS_DT_szMediumName,
p_CollectszMobileNo BOS_DT_szMediumName,
p_CollectszEmail BOS_DT_szMediumName,
p_CollectszWebSite BOS_DT_szMediumName)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_CustInvoice
SET 
szCustInvoiceNm = p_szCustInvoiceNm,
szCustTaxNm = p_szCustTaxNm,
szCustCollectNm = p_szCustCollectNm,
InvoiceszContactPerson = p_InvoiceszContactPerson,
InvoiceszRoomNo = p_InvoiceszRoomNo,
InvoiceszFloor = p_InvoiceszFloor,
InvoiceszBuilding = p_InvoiceszBuilding,
InvoiceszAddress_1 = p_InvoiceszAddress_1,
InvoiceszAddress_2 = p_InvoiceszAddress_2,
InvoiceszDistrict = p_InvoiceszDistrict,
InvoiceszCity = p_InvoiceszCity,
InvoiceszZipCode = p_InvoiceszZipCode,
InvoiceszState = p_InvoiceszState,
InvoiceszCountry = p_InvoiceszCountry,
InvoiceszPhoneNo_1 = p_InvoiceszPhoneNo_1,
InvoiceszPhoneNo_2 = p_InvoiceszPhoneNo_2,
InvoiceszFaxNo = p_InvoiceszFaxNo,
InvoiceszMobileNo = p_InvoiceszMobileNo,
InvoiceszEmail = p_InvoiceszEmail,
InvoiceszWebSite = p_InvoiceszWebSite,
bIsDiffTaxAddress = p_bIsDiffTaxAddress,
TaxszContactPerson = p_TaxszContactPerson,
TaxszRoomNo = p_TaxszRoomNo,
TaxszFloor = p_TaxszFloor,
TaxszBuilding = p_TaxszBuilding,
TaxszAddress_1 = p_TaxszAddress_1,
TaxszAddress_2 = p_TaxszAddress_2,
TaxszDistrict = p_TaxszDistrict,
TaxszCity = p_TaxszCity,
TaxszZipCode = p_TaxszZipCode,
TaxszState = p_TaxszState,
TaxszCountry = p_TaxszCountry,
TaxszPhoneNo_1 = p_TaxszPhoneNo_1,
TaxszPhoneNo_2 = p_TaxszPhoneNo_2,
TaxszFaxNo = p_TaxszFaxNo,
TaxszMobileNo = p_TaxszMobileNo,
TaxszEmail = p_TaxszEmail,
TaxszWebSite = p_TaxszWebSite,
bIsDiffCollectAddress = p_bIsDiffCollectAddress,
CollectszContactPerson = p_CollectszContactPerson,
CollectszRoomNo = p_CollectszRoomNo,
CollectszFloor = p_CollectszFloor,
CollectszBuilding = p_CollectszBuilding,
CollectszAddress_1 = p_CollectszAddress_1,
CollectszAddress_2 = p_CollectszAddress_2,
CollectszDistrict = p_CollectszDistrict,
CollectszCity = p_CollectszCity,
CollectszZipCode = p_CollectszZipCode,
CollectszState = p_CollectszState,
CollectszCountry = p_CollectszCountry,
CollectszPhoneNo_1 = p_CollectszPhoneNo_1,
CollectszPhoneNo_2 = p_CollectszPhoneNo_2,
CollectszFaxNo = p_CollectszFaxNo,
CollectszMobileNo = p_CollectszMobileNo,

CollectszEmail = p_CollectszEmail,
CollectszWebSite = p_CollectszWebSite
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustInvoice_UpdateCustInvoice_013(
p_szCustId BOS_DT_szId,
p_szCustInvoiceNm BOS_DT_szName,
p_szCustTaxNm BOS_DT_szName,
p_szCustCollectNm BOS_DT_szName,
p_InvoiceszContactPerson BOS_DT_szName,
p_InvoiceszRoomNo BOS_DT_szSmallName,
p_InvoiceszFloor BOS_DT_szSmallName,
p_InvoiceszBuilding BOS_DT_szName,
p_InvoiceszAddress_1 BOS_DT_szBigDescription,
p_InvoiceszAddress_2 BOS_DT_szBigDescription,
p_InvoiceszDistrict BOS_DT_szName,
p_InvoiceszCity BOS_DT_szMediumName,
p_InvoiceszZipCode BOS_DT_szSmallName,
p_InvoiceszState BOS_DT_szMediumName,
p_InvoiceszCountry BOS_DT_szMediumName,
p_InvoiceszPhoneNo_1 BOS_DT_szMediumName,
p_InvoiceszPhoneNo_2 BOS_DT_szMediumName,
p_InvoiceszFaxNo BOS_DT_szMediumName,
p_InvoiceszMobileNo BOS_DT_szMediumName,
p_InvoiceszEmail BOS_DT_szMediumName,
p_InvoiceszWebSite BOS_DT_szMediumName,
p_bIsDiffTaxAddress bit,
p_TaxszContactPerson BOS_DT_szName,
p_TaxszRoomNo BOS_DT_szSmallName,
p_TaxszFloor BOS_DT_szSmallName,
p_TaxszBuilding BOS_DT_szName,
p_TaxszAddress_1 BOS_DT_szBigDescription,
p_TaxszAddress_2 BOS_DT_szBigDescription,
p_TaxszDistrict BOS_DT_szName,
p_TaxszCity BOS_DT_szMediumName,
p_TaxszZipCode BOS_DT_szSmallName,
p_TaxszState BOS_DT_szMediumName,
p_TaxszCountry BOS_DT_szMediumName,
p_TaxszPhoneNo_1 BOS_DT_szMediumName,
p_TaxszPhoneNo_2 BOS_DT_szMediumName,
p_TaxszFaxNo BOS_DT_szMediumName,
p_TaxszMobileNo BOS_DT_szMediumName,
p_TaxszEmail BOS_DT_szMediumName,
p_TaxszWebSite BOS_DT_szMediumName,
p_bIsDiffCollectAddress bit,
p_CollectszContactPerson BOS_DT_szName,
p_CollectszRoomNo BOS_DT_szSmallName,
p_CollectszFloor BOS_DT_szSmallName,
p_CollectszBuilding BOS_DT_szName,
p_CollectszAddress_1 BOS_DT_szBigDescription,
p_CollectszAddress_2 BOS_DT_szBigDescription,
p_CollectszDistrict BOS_DT_szName,
p_CollectszCity BOS_DT_szMediumName,
p_CollectszZipCode BOS_DT_szSmallName,
p_CollectszState BOS_DT_szMediumName,
p_CollectszCountry BOS_DT_szMediumName,
p_CollectszPhoneNo_1 BOS_DT_szMediumName,
p_CollectszPhoneNo_2 BOS_DT_szMediumName,
p_CollectszFaxNo BOS_DT_szMediumName,
p_CollectszMobileNo BOS_DT_szMediumName,
p_CollectszEmail BOS_DT_szMediumName,
p_CollectszWebSite BOS_DT_szMediumName)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_CustInvoice
SET 
szCustInvoiceNm = p_szCustInvoiceNm,
szCustTaxNm = p_szCustTaxNm,
szCustCollectNm = p_szCustCollectNm,
InvoiceszContactPerson = p_InvoiceszContactPerson,
InvoiceszRoomNo = p_InvoiceszRoomNo,
InvoiceszFloor = p_InvoiceszFloor,
InvoiceszBuilding = p_InvoiceszBuilding,
InvoiceszAddress_1 = p_InvoiceszAddress_1,
InvoiceszAddress_2 = p_InvoiceszAddress_2,
InvoiceszDistrict = p_InvoiceszDistrict,
InvoiceszCity = p_InvoiceszCity,
InvoiceszZipCode = p_InvoiceszZipCode,
InvoiceszState = p_InvoiceszState,
InvoiceszCountry = p_InvoiceszCountry,
InvoiceszPhoneNo_1 = p_InvoiceszPhoneNo_1,
InvoiceszPhoneNo_2 = p_InvoiceszPhoneNo_2,
InvoiceszFaxNo = p_InvoiceszFaxNo,
InvoiceszMobileNo = p_InvoiceszMobileNo,
InvoiceszEmail = p_InvoiceszEmail,
InvoiceszWebSite = p_InvoiceszWebSite,
bIsDiffTaxAddress = p_bIsDiffTaxAddress,
TaxszContactPerson = p_TaxszContactPerson,
TaxszRoomNo = p_TaxszRoomNo,
TaxszFloor = p_TaxszFloor,
TaxszBuilding = p_TaxszBuilding,
TaxszAddress_1 = p_TaxszAddress_1,
TaxszAddress_2 = p_TaxszAddress_2,
TaxszDistrict = p_TaxszDistrict,
TaxszCity = p_TaxszCity,
TaxszZipCode = p_TaxszZipCode,
TaxszState = p_TaxszState,
TaxszCountry = p_TaxszCountry,
TaxszPhoneNo_1 = p_TaxszPhoneNo_1,
TaxszPhoneNo_2 = p_TaxszPhoneNo_2,
TaxszFaxNo = p_TaxszFaxNo,
TaxszMobileNo = p_TaxszMobileNo,
TaxszEmail = p_TaxszEmail,
TaxszWebSite = p_TaxszWebSite,
bIsDiffCollectAddress = p_bIsDiffCollectAddress,
CollectszContactPerson = p_CollectszContactPerson,
CollectszRoomNo = p_CollectszRoomNo,
CollectszFloor = p_CollectszFloor,
CollectszBuilding = p_CollectszBuilding,
CollectszAddress_1 = p_CollectszAddress_1,
CollectszAddress_2 = p_CollectszAddress_2,
CollectszDistrict = p_CollectszDistrict,
CollectszCity = p_CollectszCity,
CollectszZipCode = p_CollectszZipCode,
CollectszState = p_CollectszState,
CollectszCountry = p_CollectszCountry,
CollectszPhoneNo_1 = p_CollectszPhoneNo_1,
CollectszPhoneNo_2 = p_CollectszPhoneNo_2,
CollectszFaxNo = p_CollectszFaxNo,
CollectszMobileNo = p_CollectszMobileNo,

CollectszEmail = p_CollectszEmail,
CollectszWebSite = p_CollectszWebSite
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustLocation_CreateCustLocation(
p_szCustId BOS_DT_szId,
p_btLocId smallint,
p_szCustDeliveryNm BOS_DT_szName,
p_LocationszContactPerson BOS_DT_szName,
p_LocationszRoomNo BOS_DT_szSmallName,
p_LocationszFloor BOS_DT_szSmallName,
p_LocationszBuilding BOS_DT_szName,
p_LocationszAddress_1 BOS_DT_szName,
p_LocationszAddress_2 BOS_DT_szName,
p_LocationszDistrict BOS_DT_szMediumName,
p_LocationszCity BOS_DT_szMediumName,
p_LocationszZipCode BOS_DT_szSmallName,
p_LocationszState BOS_DT_szMediumName,
p_LocationszCountry BOS_DT_szMediumName,
p_LocationszPhoneNo_1 BOS_DT_szMediumName,
p_LocationszPhoneNo_2 BOS_DT_szMediumName,
p_LocationszFaxNo BOS_DT_szMediumName,
p_LocationszMobileNo BOS_DT_szMediumName,
p_LocationszEmail BOS_DT_szMediumName,
p_LocationszWebSite BOS_DT_szMediumName,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_CustLocation
(
szCustId,
btLocId,
szCustDeliveryNm,
LocationszContactPerson,
LocationszRoomNo,
LocationszFloor,
LocationszBuilding,
LocationszAddress_1,
LocationszAddress_2,
LocationszDistrict,
LocationszCity,
LocationszZipcode,
LocationszState,
LocationszCountry,
LocationszPhoneNo_1,
LocationszPhoneNo_2,
LocationszFaxNo,
LocationszMobileNo,
LocationszEmail,
LocationszWebSite,
dtmLastUpdated
)
VALUES
(
p_szCustId,
p_btLocId,
p_szCustDeliveryNm,
p_LocationszContactPerson,
p_LocationszRoomNo,
p_LocationszFloor,
p_LocationszBuilding,
p_LocationszAddress_1,
p_LocationszAddress_2,
p_LocationszDistrict,
p_LocationszCity,
p_LocationszZipcode,
p_LocationszState,
p_LocationszCountry,
p_LocationszPhoneNo_1,
p_LocationszPhoneNo_2,
p_LocationszFaxNo,
p_LocationszMobileNo,
p_LocationszEmail,
p_LocationszWebSite,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustLocation_CreateCustLocation_013(
p_szCustId BOS_DT_szId,
p_btLocId smallint,
p_szCustDeliveryNm BOS_DT_szName,
p_LocationszContactPerson BOS_DT_szName,
p_LocationszRoomNo BOS_DT_szSmallName,
p_LocationszFloor BOS_DT_szSmallName,
p_LocationszBuilding BOS_DT_szName,
p_LocationszAddress_1 BOS_DT_szName,
p_LocationszAddress_2 BOS_DT_szName,
p_LocationszDistrict BOS_DT_szName,
p_LocationszCity BOS_DT_szMediumName,
p_LocationszZipCode BOS_DT_szSmallName,
p_LocationszState BOS_DT_szMediumName,
p_LocationszCountry BOS_DT_szMediumName,
p_LocationszPhoneNo_1 BOS_DT_szMediumName,
p_LocationszPhoneNo_2 BOS_DT_szMediumName,
p_LocationszFaxNo BOS_DT_szMediumName,
p_LocationszMobileNo BOS_DT_szMediumName,
p_LocationszEmail BOS_DT_szMediumName,
p_LocationszWebSite BOS_DT_szMediumName,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_CustLocation
(
szCustId,
btLocId,
szCustDeliveryNm,
LocationszContactPerson,
LocationszRoomNo,
LocationszFloor,
LocationszBuilding,
LocationszAddress_1,
LocationszAddress_2,
LocationszDistrict,
LocationszCity,
LocationszZipcode,
LocationszState,
LocationszCountry,
LocationszPhoneNo_1,
LocationszPhoneNo_2,
LocationszFaxNo,
LocationszMobileNo,
LocationszEmail,
LocationszWebSite,
dtmLastUpdated
)
VALUES
(
p_szCustId,
p_btLocId,
p_szCustDeliveryNm,
p_LocationszContactPerson,
p_LocationszRoomNo,
p_LocationszFloor,
p_LocationszBuilding,
p_LocationszAddress_1,
p_LocationszAddress_2,
p_LocationszDistrict,
p_LocationszCity,
p_LocationszZipcode,
p_LocationszState,
p_LocationszCountry,
p_LocationszPhoneNo_1,
p_LocationszPhoneNo_2,
p_LocationszFaxNo,
p_LocationszMobileNo,
p_LocationszEmail,
p_LocationszWebSite,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustLocation_DeleteCustLocation(
p_szCustId BOS_DT_szId,
p_btLocId smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_AR_CustLocation
WHERE
szCustId=p_szCustId AND btLocId=p_btLocId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustLocation_DeleteCustMultiLocation(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE FROM BOS_AR_CustLocation
WHERE
	szCustId=p_szCustId and
	btLocId > 0;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustLocation_DeleteListOfCustLocation(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE FROM BOS_AR_CustLocation
WHERE
	szCustId=p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustLocation_GetCustLocation(
p_szCustId BOS_DT_szId,
p_btLocId smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId

FROM 
BOS_AR_CustLocation
WHERE 
szCustId=p_szCustId AND btLocId=p_btLocId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustLocation_GetCustLocation_014(
p_szCustId BOS_DT_szId,
p_btLocId smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId

FROM 
BOS_AR_CustLocation
WHERE 
szCustId=p_szCustId AND btLocId=p_btLocId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustLocation_GetListOfCustLocation()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId,
btLocId

FROM 
BOS_AR_CustLocation;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustLocation_GetListOfCustLocationByCust(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
btLocId

FROM 
BOS_AR_CustLocation
WHERE 
szCustId=p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustLocation_IsCustLocationExist(
p_szCustId BOS_DT_szId,
p_btLocId smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId 

FROM 
BOS_AR_CustLocation 
WHERE 
szCustId=p_szCustId AND btLocId=p_btLocId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustLocation_LockCustLocation(
p_szCustId BOS_DT_szId,
p_btLocId smallint)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_CustLocation
SET 
LocationszFloor=LocationszFloor
WHERE 
szCustId=p_szCustId AND btLocId=p_btLocId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustLocation_UpdateCustLocation(
p_szCustId BOS_DT_szId,
p_btLocId smallint,
p_szCustDeliveryNm BOS_DT_szName,
p_LocationszContactPerson BOS_DT_szName,
p_LocationszRoomNo BOS_DT_szSmallName,
p_LocationszFloor BOS_DT_szSmallName,
p_LocationszBuilding BOS_DT_szName,
p_LocationszAddress_1 BOS_DT_szName,
p_LocationszAddress_2 BOS_DT_szName,
p_LocationszDistrict BOS_DT_szName,
p_LocationszCity BOS_DT_szMediumName,
p_LocationszZipCode BOS_DT_szSmallName,
p_LocationszState BOS_DT_szMediumName,
p_LocationszCountry BOS_DT_szMediumName,
p_LocationszPhoneNo_1 BOS_DT_szMediumName,
p_LocationszPhoneNo_2 BOS_DT_szMediumName,
p_LocationszFaxNo BOS_DT_szMediumName,
p_LocationszMobileNo BOS_DT_szMediumName,
p_LocationszEmail BOS_DT_szMediumName,
p_LocationszWebSite BOS_DT_szMediumName)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_CustLocation
SET 
szCustDeliveryNm = p_szCustDeliveryNm,
LocationszContactPerson=p_LocationszContactPerson,
LocationszRoomNo=p_LocationszRoomNo,
LocationszFloor=p_LocationszFloor,
LocationszBuilding=p_LocationszBuilding,
LocationszAddress_1=p_LocationszAddress_1,
LocationszAddress_2=p_LocationszAddress_2,
LocationszDistrict=p_LocationszDistrict,
LocationszCity=p_LocationszCity,
LocationszZipcode=p_LocationszZipcode,
LocationszState=p_LocationszState,
LocationszCountry=p_LocationszCountry,
LocationszPhoneNo_1=p_LocationszPhoneNo_1,
LocationszPhoneNo_2=p_LocationszPhoneNo_2,
LocationszFaxNo=p_LocationszFaxNo,
LocationszMobileNo=p_LocationszMobileNo,
LocationszEmail=p_LocationszEmail,
LocationszWebSite=p_LocationszWebSite
WHERE 
szCustId=p_szCustId AND btLocId=p_btLocId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_CreateCustomer(
p_szCustId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szFCallId BOS_DT_szId,
p_CustszContactPerson BOS_DT_szName,
p_CustszRoomNo BOS_DT_szSmallName,
p_CustszFloor BOS_DT_szSmallName,
p_CustszBuilding BOS_DT_szName,
p_CustszAddress_1 BOS_DT_szBigDescription,
p_CustszAddress_2 BOS_DT_szBigDescription,
p_CustszDistrict BOS_DT_szMediumName,
p_CustszCity BOS_DT_szMediumName,
p_CustszZipCode BOS_DT_szSmallName,
p_CustszState BOS_DT_szMediumName,
p_CustszCountry BOS_DT_szMediumName,
p_CustszPhoneNo_1 BOS_DT_szMediumName,
p_CustszPhoneNo_2 BOS_DT_szMediumName,
p_CustszFaxNo BOS_DT_szMediumName,
p_CustszMobileNo BOS_DT_szMediumName,
p_CustszEmail BOS_DT_szMediumName,
p_CustszWebSite BOS_DT_szMediumName,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_bSoldToCust bit,
p_bDeliverToCust bit,
p_bInvoiceToCust bit,
p_bCollectToCust bit,
p_szSoldToCustId BOS_DT_szId,
p_szDeliverToCustId BOS_DT_szId,
p_szInvoiceToCustId BOS_DT_szId,
p_szCollectToCustId BOS_DT_szId,
p_bIsDiffDeliveryAddress bit,
p_bIsDiffInvoiceAddress bit,
p_bIsMultiLocation bit,
p_szCategory_1 BOS_DT_szId,
p_szCategory_2 BOS_DT_szId,
p_szCategory_3 BOS_DT_szId,
p_szCategory_4 BOS_DT_szId,
p_szCategory_5 BOS_DT_szId,
p_szCategory_6 BOS_DT_szId,
p_szCategory_7 BOS_DT_szId,
p_szCategory_8 BOS_DT_szId,
p_szCategory_9 BOS_DT_szId,
p_szCategory_10 BOS_DT_szId,
p_bJoinInvoice bit,
p_szStatus varchar,
p_szReasonId BOS_DT_szId,
p_szDlvWorkplaceId BOS_DT_szId,
p_szInvWorkplaceId BOS_DT_szId,
p_szCollWorkplaceId BOS_DT_szId,
p_szSalWorkplaceId BOS_DT_szId,
p_szDistrChannelId BOS_DT_szId,
p_szDefaultCcyId BOS_DT_szSmallId,
p_szStartDoc varchar,
p_dtmStart timestamp,
p_szContractDoc varchar,
p_dtmContract timestamp,
p_szRenewalDoc varchar,
p_dtmRenewal timestamp,
p_szStopDoc varchar,
p_dtmStop timestamp,
p_szSalesId BOS_DT_szId,
p_bICP bit,
p_szLastFCustBIId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_bNeedInvoiceChange BOS_DT_bBoolean,
p_bInvoiceChangeWithReceipt BOS_DT_bBoolean,
p_bHasSpecialCollectionDay BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Sunday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Monday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Tuesday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Wednesday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Thursday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Friday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Saturday BOS_DT_bBoolean,
p_bPaymentType_Cash BOS_DT_bBoolean,
p_bPaymentType_CurrentAccount BOS_DT_bBoolean,
p_bPaymentType_Transfer BOS_DT_bBoolean,
p_bRequiredDocuments_PO BOS_DT_bBoolean,
p_bRequiredDocuments_Receipt BOS_DT_bBoolean,
p_bRequiredDocuments_StandardTaxInvoice BOS_DT_bBoolean,
p_bRequiredDocuments_Materai BOS_DT_bBoolean,
p_bRequiredDocuments_ReceiptNote BOS_DT_bBoolean,
p_bRequiredDocuments_Other BOS_DT_bBoolean,
p_szRequiredDocuments_Other BOS_DT_szBigDescription,
p_szGuarantee BOS_DT_szBigDescription,
p_szDeliveryGroupId BOS_DT_szId,
p_szBarcodeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_Customer
(
szCustId,
szName,
szFCallId,
--- Basic Address.,
CustszContactPerson,
CustszRoomNo,
CustszFloor,
CustszBuilding,
CustszAddress_1,
CustszAddress_2,
CustszDistrict,
CustszCity,
CustszZipcode,
CustszState,
CustszCountry,
CustszPhoneNo_1,
CustszPhoneNo_2,
CustszFaxNo,
CustszMobileNo,
CustszEmail,
CustszWebSite,
szLatitude,
szLongitude,
bSoldToCust,
bDeliverToCust,
bInvoiceToCust,
bCollectToCust,
szSoldToCustId,
szDeliverToCustId,
szInvoiceToCustId,
szCollectToCustId,
bIsDiffDeliveryAddress,
bIsDiffInvoiceAddress,
bIsMultiLocation,
--- Customer Category.,
szCategory_1,
szCategory_2,
szCategory_3,
szCategory_4,
szCategory_5,
szCategory_6,
szCategory_7,
szCategory_8,
szCategory_9,
szCategory_10,
bJoinInvoice,
szStatus,
szReasonId,
szDlvWorkplaceId,
szInvWorkplaceId,
szCollWorkplaceId,
szSalWorkplaceId,
szDistrChannelId,
szDefaultCcyId,
--- Closing Info.,
szStartDoc,
dtmStart,
szContractDoc,
dtmContract,
szRenewalDoc,
dtmRenewal,
szStopDoc,
dtmStop,
szSalesId,
bICP,
szLastFCustBIId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
-- Customer Validation,
bNeedInvoiceChange,
bInvoiceChangeWithReceipt,
bHasSpecialCollectionDay,
bHasSpecialCollectionDay_Sunday,
bHasSpecialCollectionDay_Monday,
bHasSpecialCollectionDay_Tuesday,
bHasSpecialCollectionDay_Wednesday,
bHasSpecialCollectionDay_Thursday,
bHasSpecialCollectionDay_Friday,
bHasSpecialCollectionDay_Saturday,
bPaymentType_Cash,
bPaymentType_CurrentAccount,
bPaymentType_Transfer,
bRequiredDocuments_PO,
bRequiredDocuments_Receipt,
bRequiredDocuments_StandardTaxInvoice,
bRequiredDocuments_Materai,
bRequiredDocuments_ReceiptNote,
bRequiredDocuments_Other,
szRequiredDocuments_Other,
szGuarantee,
szDeliveryGroupId,
szBarcodeId
)
VALUES
(
p_szCustId,
p_szName,
p_szFCallId,
p_CustszContactPerson,
p_CustszRoomNo,
p_CustszFloor,
p_CustszBuilding,
p_CustszAddress_1,
p_CustszAddress_2,
p_CustszDistrict,
p_CustszCity,
p_CustszZipcode,
p_CustszState,
p_CustszCountry,
p_CustszPhoneNo_1,
p_CustszPhoneNo_2,
p_CustszFaxNo,
p_CustszMobileNo,
p_CustszEmail,
p_CustszWebSite,
p_szLatitude,
p_szLongitude,
p_bSoldToCust,
p_bDeliverToCust,
p_bInvoiceToCust,
p_bCollectToCust,
p_szSoldToCustId,
p_szDeliverToCustId,
p_szInvoiceToCustId,
p_szCollectToCustId,
p_bIsDiffDeliveryAddress,
p_bIsDiffInvoiceAddress,
p_bIsMultiLocation,
p_szCategory_1,
p_szCategory_2,
p_szCategory_3,
p_szCategory_4,
p_szCategory_5,
p_szCategory_6,
p_szCategory_7,
p_szCategory_8,
p_szCategory_9,
p_szCategory_10,
p_bJoinInvoice,
p_szStatus,
p_szReasonId,
p_szDlvWorkplaceId,
p_szInvWorkplaceId,
p_szCollWorkplaceId,
p_szSalWorkplaceId,
p_szDistrChannelId,
p_szDefaultCcyId,
p_szStartDoc,
p_dtmStart ,
p_szContractDoc,
p_dtmContract ,
p_szRenewalDoc,
p_dtmRenewal ,
p_szStopDoc,
p_dtmStop ,
p_szSalesId ,
p_bICP,
p_szLastFCustBIId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
-- Customer Validation,
p_bNeedInvoiceChange,
p_bInvoiceChangeWithReceipt,
p_bHasSpecialCollectionDay,
p_bHasSpecialCollectionDay_Sunday,
p_bHasSpecialCollectionDay_Monday,
p_bHasSpecialCollectionDay_Tuesday,
p_bHasSpecialCollectionDay_Wednesday,
p_bHasSpecialCollectionDay_Thursday,
p_bHasSpecialCollectionDay_Friday,
p_bHasSpecialCollectionDay_Saturday,
p_bPaymentType_Cash,
p_bPaymentType_CurrentAccount,
p_bPaymentType_Transfer,
p_bRequiredDocuments_PO,
p_bRequiredDocuments_Receipt,
p_bRequiredDocuments_StandardTaxInvoice,
p_bRequiredDocuments_Materai,
p_bRequiredDocuments_ReceiptNote,
p_bRequiredDocuments_Other,
p_szRequiredDocuments_Other,
p_szGuarantee,
p_szDeliveryGroupId,
p_szBarcodeId

);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_CreateCustomer_013(
p_szCustId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szFCallId BOS_DT_szId,
p_CustszContactPerson BOS_DT_szName,
p_CustszRoomNo BOS_DT_szSmallName,
p_CustszFloor BOS_DT_szSmallName,
p_CustszBuilding BOS_DT_szName,
p_CustszAddress_1 BOS_DT_szBigDescription,
p_CustszAddress_2 BOS_DT_szBigDescription,
p_CustszDistrict BOS_DT_szMediumName,
p_CustszCity BOS_DT_szMediumName,
p_CustszZipCode BOS_DT_szSmallName,
p_CustszState BOS_DT_szMediumName,
p_CustszCountry BOS_DT_szMediumName,
p_CustszPhoneNo_1 BOS_DT_szMediumName,
p_CustszPhoneNo_2 BOS_DT_szMediumName,
p_CustszFaxNo BOS_DT_szMediumName,
p_CustszMobileNo BOS_DT_szMediumName,
p_CustszEmail BOS_DT_szMediumName,
p_CustszWebSite BOS_DT_szMediumName,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_bSoldToCust bit,
p_bDeliverToCust bit,
p_bInvoiceToCust bit,
p_bCollectToCust bit,
p_szSoldToCustId BOS_DT_szId,
p_szDeliverToCustId BOS_DT_szId,
p_szInvoiceToCustId BOS_DT_szId,
p_szCollectToCustId BOS_DT_szId,
p_bIsDiffDeliveryAddress bit,
p_bIsDiffInvoiceAddress bit,
p_bIsMultiLocation bit,
p_szCategory_1 BOS_DT_szId,
p_szCategory_2 BOS_DT_szId,
p_szCategory_3 BOS_DT_szId,
p_szCategory_4 BOS_DT_szId,
p_szCategory_5 BOS_DT_szId,
p_szCategory_6 BOS_DT_szId,
p_szCategory_7 BOS_DT_szId,
p_szCategory_8 BOS_DT_szId,
p_szCategory_9 BOS_DT_szId,
p_szCategory_10 BOS_DT_szId,
p_bJoinInvoice bit,
p_szStatus varchar,
p_szReasonId BOS_DT_szId,
p_szDlvWorkplaceId BOS_DT_szId,
p_szInvWorkplaceId BOS_DT_szId,
p_szCollWorkplaceId BOS_DT_szId,
p_szSalWorkplaceId BOS_DT_szId,
p_szDistrChannelId BOS_DT_szId,
p_szDefaultCcyId BOS_DT_szSmallId,
p_szStartDoc varchar,
p_dtmStart timestamp,
p_szContractDoc varchar,
p_dtmContract timestamp,
p_szRenewalDoc varchar,
p_dtmRenewal timestamp,
p_szStopDoc varchar,
p_dtmStop timestamp,
p_szSalesId BOS_DT_szId,
p_bICP bit,
p_szLastFCustBIId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_bNeedInvoiceChange BOS_DT_bBoolean,
p_bInvoiceChangeWithReceipt BOS_DT_bBoolean,
p_bHasSpecialCollectionDay BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Sunday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Monday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Tuesday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Wednesday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Thursday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Friday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Saturday BOS_DT_bBoolean,
p_bPaymentType_Cash BOS_DT_bBoolean,
p_bPaymentType_CurrentAccount BOS_DT_bBoolean,
p_bPaymentType_Transfer BOS_DT_bBoolean,
p_bRequiredDocuments_PO BOS_DT_bBoolean,
p_bRequiredDocuments_Receipt BOS_DT_bBoolean,
p_bRequiredDocuments_StandardTaxInvoice BOS_DT_bBoolean,
p_bRequiredDocuments_Materai BOS_DT_bBoolean,
p_bRequiredDocuments_ReceiptNote BOS_DT_bBoolean,
p_bRequiredDocuments_Other BOS_DT_bBoolean,
p_szRequiredDocuments_Other BOS_DT_szBigDescription,
p_szGuarantee BOS_DT_szBigDescription,
p_szDeliveryGroupId BOS_DT_szId,
p_szBarcodeId BOS_DT_szId,
p_szActivityStatus BOS_DT_szId,
p_dtmLastChangeActivityStatus timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_Customer
(
szCustId,
szName,
szFCallId,
--- Basic Address.,
CustszContactPerson,
CustszRoomNo,
CustszFloor,
CustszBuilding,
CustszAddress_1,
CustszAddress_2,
CustszDistrict,
CustszCity,
CustszZipcode,
CustszState,
CustszCountry,
CustszPhoneNo_1,
CustszPhoneNo_2,
CustszFaxNo,
CustszMobileNo,
CustszEmail,
CustszWebSite,
szLatitude,
szLongitude,
bSoldToCust,
bDeliverToCust,
bInvoiceToCust,
bCollectToCust,
szSoldToCustId,
szDeliverToCustId,
szInvoiceToCustId,
szCollectToCustId,
bIsDiffDeliveryAddress,
bIsDiffInvoiceAddress,
bIsMultiLocation,
--- Customer Category.,
szCategory_1,
szCategory_2,
szCategory_3,
szCategory_4,
szCategory_5,
szCategory_6,
szCategory_7,
szCategory_8,
szCategory_9,
szCategory_10,
bJoinInvoice,
szStatus,
szReasonId,
szDlvWorkplaceId,
szInvWorkplaceId,
szCollWorkplaceId,
szSalWorkplaceId,
szDistrChannelId,
szDefaultCcyId,
--- Closing Info.,
szStartDoc,
dtmStart,
szContractDoc,
dtmContract,
szRenewalDoc,
dtmRenewal,
szStopDoc,
dtmStop,
szSalesId,
bICP,
szLastFCustBIId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
-- Customer Validation,
bNeedInvoiceChange,
bInvoiceChangeWithReceipt,
bHasSpecialCollectionDay,
bHasSpecialCollectionDay_Sunday,
bHasSpecialCollectionDay_Monday,
bHasSpecialCollectionDay_Tuesday,
bHasSpecialCollectionDay_Wednesday,
bHasSpecialCollectionDay_Thursday,
bHasSpecialCollectionDay_Friday,
bHasSpecialCollectionDay_Saturday,
bPaymentType_Cash,
bPaymentType_CurrentAccount,
bPaymentType_Transfer,
bRequiredDocuments_PO,
bRequiredDocuments_Receipt,
bRequiredDocuments_StandardTaxInvoice,
bRequiredDocuments_Materai,
bRequiredDocuments_ReceiptNote,
bRequiredDocuments_Other,
szRequiredDocuments_Other,
szGuarantee,
szDeliveryGroupId,
szBarcodeId,
szActivityStatus,
dtmLastChangeActivityStatus
)
VALUES
(
p_szCustId,
p_szName,
p_szFCallId,
p_CustszContactPerson,
p_CustszRoomNo,
p_CustszFloor,
p_CustszBuilding,
p_CustszAddress_1,
p_CustszAddress_2,
p_CustszDistrict,
p_CustszCity,
p_CustszZipcode,
p_CustszState,
p_CustszCountry,
p_CustszPhoneNo_1,
p_CustszPhoneNo_2,
p_CustszFaxNo,
p_CustszMobileNo,
p_CustszEmail,
p_CustszWebSite,
p_szLatitude,
p_szLongitude,
p_bSoldToCust,
p_bDeliverToCust,
p_bInvoiceToCust,
p_bCollectToCust,
p_szSoldToCustId,
p_szDeliverToCustId,
p_szInvoiceToCustId,
p_szCollectToCustId,
p_bIsDiffDeliveryAddress,
p_bIsDiffInvoiceAddress,
p_bIsMultiLocation,
p_szCategory_1,
p_szCategory_2,
p_szCategory_3,
p_szCategory_4,
p_szCategory_5,
p_szCategory_6,
p_szCategory_7,
p_szCategory_8,
p_szCategory_9,
p_szCategory_10,
p_bJoinInvoice,
p_szStatus,
p_szReasonId,
p_szDlvWorkplaceId,
p_szInvWorkplaceId,
p_szCollWorkplaceId,
p_szSalWorkplaceId,
p_szDistrChannelId,
p_szDefaultCcyId,
p_szStartDoc,
p_dtmStart ,
p_szContractDoc,
p_dtmContract ,
p_szRenewalDoc,
p_dtmRenewal ,
p_szStopDoc,
p_dtmStop ,
p_szSalesId ,
p_bICP,
p_szLastFCustBIId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
-- Customer Validation,
p_bNeedInvoiceChange,
p_bInvoiceChangeWithReceipt,
p_bHasSpecialCollectionDay,
p_bHasSpecialCollectionDay_Sunday,
p_bHasSpecialCollectionDay_Monday,
p_bHasSpecialCollectionDay_Tuesday,
p_bHasSpecialCollectionDay_Wednesday,
p_bHasSpecialCollectionDay_Thursday,
p_bHasSpecialCollectionDay_Friday,
p_bHasSpecialCollectionDay_Saturday,
p_bPaymentType_Cash,
p_bPaymentType_CurrentAccount,
p_bPaymentType_Transfer,
p_bRequiredDocuments_PO,
p_bRequiredDocuments_Receipt,
p_bRequiredDocuments_StandardTaxInvoice,
p_bRequiredDocuments_Materai,
p_bRequiredDocuments_ReceiptNote,
p_bRequiredDocuments_Other,
p_szRequiredDocuments_Other,
p_szGuarantee,
p_szDeliveryGroupId,
p_szBarcodeId  ,
p_szActivityStatus,
p_dtmLastChangeActivityStatus
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_CreateCustomerProductItem(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szRefProductId BOS_DT_szId,
p_szRefProductName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_CustomerProductItem
(
szCustId,
szProductId,
szRefProductId,
szRefProductName
)
VALUES
(
p_szCustId,
p_szProductId,
p_szRefProductId,
p_szRefProductName
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_DeleteCustomer(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_AR_Customer
WHERE
szCustId = p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_DeleteCustomerProductItem(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_AR_CustomerProductItem
WHERE
 szCustId = p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_FlagDiffDeliveryAddress(
p_szCustId BOS_DT_szId,
p_bIsDiffDeliveryAddress bit,
p_bIsMultiLocation bit,
p_szDlvWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_Customer
SET 
bIsDiffDeliveryAddress=p_bIsDiffDeliveryAddress,
bIsMultiLocation = p_bIsMultiLocation,
szDlvWorkplaceId = p_szDlvWorkplaceId
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_FlagDiffInvoiceAddress(
p_szCustId BOS_DT_szId,
p_bDiffInvoiceAddress bit,
p_szInvWorkplaceId BOS_DT_szId,
p_szCollWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_Customer
SET 
bIsDiffInvoiceAddress = p_bDiffInvoiceAddress,
szInvWorkplaceId = p_szInvWorkplaceId,
szCollWorkplaceId = p_szCollWorkplaceId
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_GetCustNm(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_Customer.szName


FROM 
BOS_AR_Customer

WHERE 
BOS_AR_Customer.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_GetCustomer(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_AR_Customer.szName,  
BOS_AR_Customer.CustszContactPerson,  
BOS_AR_Customer.CustszRoomNo,  
BOS_AR_Customer.CustszFloor,  
BOS_AR_Customer.CustszBuilding,  
BOS_AR_Customer.CustszAddress_1,  
BOS_AR_Customer.CustszAddress_2,  
BOS_AR_Customer.CustszDistrict,  
BOS_AR_Customer.CustszCity,  
BOS_AR_Customer.CustszZipcode,  
BOS_AR_Customer.CustszState,  
BOS_AR_Customer.CustszCountry,  
BOS_AR_Customer.CustszPhoneNo_1,  
BOS_AR_Customer.CustszPhoneNo_2,  
BOS_AR_Customer.CustszFaxNo,  
BOS_AR_Customer.CustszMobileNo,  
BOS_AR_Customer.CustszEmail,  
BOS_AR_Customer.CustszWebSite,  

BOS_AR_Customer.szLatitude,  
BOS_AR_Customer.szLongitude,  

BOS_AR_Customer.szFCallId,  
BOS_AR_Customer.bSoldToCust,  
BOS_AR_Customer.bDeliverToCust,  
BOS_AR_Customer.bInvoiceToCust,  
BOS_AR_Customer.bCollectToCust,  
BOS_AR_Customer.szSoldToCustId,  
SOLD_TO.szName as szSoldToCustNm,  
BOS_AR_Customer.szDeliverToCustId,  
DLV_TO.szName as szDeliverToCustNm,  
BOS_AR_Customer.szInvoiceToCustId,  
INV_TO.szName as szInvoiceToCustNm,  
BOS_AR_Customer.szCollectToCustId,  
COLL_TO.szName as szCollectToCustNm,  
BOS_AR_Customer.bIsDiffDeliveryAddress,  
BOS_AR_Customer.bIsDiffInvoiceAddress,  
BOS_AR_Customer.bIsMultiLocation,  
BOS_AR_Customer.szCategory_1,  
CAT_1.szDescription AS szCategory_1Desc,  
CAT_1.szPriceId As szCategory_1PriceId,  
CAT_1.szPromoPriceId As szCategory_1PromoPriceId,  
BOS_AR_Customer.szCategory_2,  
CAT_2.szDescription AS szCategory_2Desc,  
CAT_2.szPriceId As szCategory_2PriceId,  
CAT_2.szPromoPriceId As szCategory_2PromoPriceId,  
BOS_AR_Customer.szCategory_3,  
CAT_3.szDescription AS szCategory_3Desc,  
CAT_3.szPriceId As szCategory_3PriceId,  
CAT_3.szPromoPriceId As szCategory_3PromoPriceId,  
BOS_AR_Customer.szCategory_4,  
CAT_4.szDescription AS szCategory_4Desc,  
CAT_4.szPriceId As szCategory_4PriceId,  
CAT_4.szPromoPriceId As szCategory_4PromoPriceId,  
BOS_AR_Customer.szCategory_5,  
CAT_5.szDescription AS szCategory_5Desc,  
CAT_5.szPriceId As szCategory_5PriceId,  
CAT_5.szPromoPriceId As szCategory_5PromoPriceId,  
BOS_AR_Customer.szCategory_6,  
CAT_6.szDescription AS szCategory_6Desc,  
CAT_6.szPriceId As szCategory_6PriceId,  
CAT_6.szPromoPriceId As szCategory_6PromoPriceId,  
BOS_AR_Customer.szCategory_7,  
CAT_7.szDescription AS szCategory_7Desc,  
CAT_7.szPriceId As szCategory_7PriceId,  
CAT_7.szPromoPriceId As szCategory_7PromoPriceId,  
BOS_AR_Customer.szCategory_8,  
CAT_8.szDescription AS szCategory_8Desc,  
CAT_8.szPriceId As szCategory_8PriceId,  
CAT_8.szPromoPriceId As szCategory_8PromoPriceId,  
BOS_AR_Customer.szCategory_9,  
CAT_9.szDescription AS szCategory_9Desc,  
CAT_9.szPriceId As szCategory_9PriceId,  
CAT_9.szPromoPriceId As szCategory_9PromoPriceId,  
BOS_AR_Customer.szCategory_10,  
CAT_10.szDescription AS szCategory_10Desc,  
CAT_10.szPriceId As szCategory_10PriceId,  
CAT_10.szPromoPriceId As szCategory_10PromoPriceId,  
BOS_AR_Customer.bJoinInvoice,  
BOS_AR_Customer.szStatus,  
BOS_AR_Customer.szReasonId,  


DLV_TO.szDlvWorkplaceId,  
INV_TO.szInvWorkplaceId,  
COLL_TO.szCollWorkplaceId,  
SOLD_TO.szSalWorkplaceId,  

BOS_AR_Customer.szDistrChannelId,  
BOS_SD_DistrChannel.szName as szDistrChannelNm,  
BOS_AR_Customer.szDefaultCcyId,  

BOS_AR_Customer.szStartDoc,  
BOS_AR_Customer.dtmStart,  
BOS_AR_Customer.szContractDoc,  
BOS_AR_Customer.dtmContract,  
BOS_AR_Customer.szRenewalDoc,  
BOS_AR_Customer.dtmRenewal,  
BOS_AR_Customer.szStopDoc,  
BOS_AR_Customer.dtmStop,  
BOS_AR_Customer.szSalesId,  
isNull(BOS_PI_Employee.szName,'') as szSalesNm,  
BOS_AR_Customer.bICP,  
BOS_AR_Customer.szLastFCustBIId,  

--Customer's collection info  
BSR.szRouteId AS szCollRouteId,  
BSR.szDescription AS szCollRouteDescription,  
BSR.szOpUserId AS szCollectorId,  
Collector.szName AS szCollectorNm,  

-- Data Status.  
BOS_AR_Customer.dtmLastUpdated,  
BOS_AR_Customer.bAlreadyTransferred,  
-- Customer Validation  
BOS_AR_Customer.bNeedInvoiceChange,  
BOS_AR_Customer.bInvoiceChangeWithReceipt,  
BOS_AR_Customer.bHasSpecialCollectionDay,  
BOS_AR_Customer.bHasSpecialCollectionDay_Sunday,  
BOS_AR_Customer.bHasSpecialCollectionDay_Monday,  
BOS_AR_Customer.bHasSpecialCollectionDay_Tuesday,  
BOS_AR_Customer.bHasSpecialCollectionDay_Wednesday,  
BOS_AR_Customer.bHasSpecialCollectionDay_Thursday,  
BOS_AR_Customer.bHasSpecialCollectionDay_Friday,  
BOS_AR_Customer.bHasSpecialCollectionDay_Saturday,   
BOS_AR_Customer.bPaymentType_Cash,  
BOS_AR_Customer.bPaymentType_CurrentAccount,  
BOS_AR_Customer.bPaymentType_Transfer,  
BOS_AR_Customer.bRequiredDocuments_PO,  
BOS_AR_Customer.bRequiredDocuments_Receipt,  
BOS_AR_Customer.bRequiredDocuments_StandardTaxInvoice,  
BOS_AR_Customer.bRequiredDocuments_Materai,  
BOS_AR_Customer.bRequiredDocuments_ReceiptNote,  
BOS_AR_Customer.bRequiredDocuments_Other,  
BOS_AR_Customer.szRequiredDocuments_Other,  
BOS_AR_Customer.szGuarantee,
BOS_AR_Customer.szDeliveryGroupId,
ISNULL(DeliveryGroup.szDesc, '') AS szDeliveryGroupDesc_J,
BOS_AR_Customer.szBarcodeId    
FROM  
BOS_AR_Customer  
LEFT JOIN BOS_PI_Employee ON BOS_AR_Customer.szSalesId = BOS_PI_Employee.szEmployeeId  
LEFT JOIN BOS_AR_Customer AS SOLD_TO ON SOLD_TO.szCustId = BOS_AR_Customer.szSoldToCustId  
LEFT JOIN BOS_AR_Customer AS DLV_TO ON DLV_TO.szCustId = BOS_AR_Customer.szDeliverToCustId  
LEFT JOIN BOS_AR_Customer AS INV_TO ON INV_TO.szCustId = BOS_AR_Customer.szInvoiceToCustId  
LEFT JOIN BOS_AR_Customer AS COLL_TO ON COLL_TO.szCustId = INV_TO.szCollectToCustId  
LEFT JOIN BOS_AR_Category AS CAT_1 ON CAT_1.szCategoryId = BOS_AR_Customer.szCategory_1  
LEFT JOIN BOS_AR_Category AS CAT_2 ON CAT_2.szCategoryId = BOS_AR_Customer.szCategory_2  
LEFT JOIN BOS_AR_Category AS CAT_3 ON CAT_3.szCategoryId = BOS_AR_Customer.szCategory_3  
LEFT JOIN BOS_AR_Category AS CAT_4 ON CAT_4.szCategoryId = BOS_AR_Customer.szCategory_4  
LEFT JOIN BOS_AR_Category AS CAT_5 ON CAT_5.szCategoryId = BOS_AR_Customer.szCategory_5  
LEFT JOIN BOS_AR_Category AS CAT_6 ON CAT_6.szCategoryId = BOS_AR_Customer.szCategory_6  
LEFT JOIN BOS_AR_Category AS CAT_7 ON CAT_7.szCategoryId = BOS_AR_Customer.szCategory_7  
LEFT JOIN BOS_AR_Category AS CAT_8 ON CAT_8.szCategoryId = BOS_AR_Customer.szCategory_8  
LEFT JOIN BOS_AR_Category AS CAT_9 ON CAT_9.szCategoryId = BOS_AR_Customer.szCategory_9  
LEFT JOIN BOS_AR_Category AS CAT_10 ON CAT_10.szCategoryId = BOS_AR_Customer.szCategory_10  
LEFT JOIN BOS_SD_DistrChannel ON BOS_SD_DistrChannel.szDistrChannelId = BOS_AR_Customer.szDistrChannelId  
LEFT JOIN BOS_SD_CustCollRoutine AS BSCCR ON BSCCR.szCustId = COLL_TO.szCustId  
LEFT JOIN BOS_SD_Route AS BSR ON BSR.szRouteId = BSCCR.szDefaultRouteId  
LEFT JOIN BOS_PI_Employee AS Collector ON Collector.szEmployeeId = BSR.szOpUserId  
LEFT JOIN BOS_SD_DeliveryGroup AS DeliveryGroup ON DeliveryGroup.szWorkplaceId = BOS_AR_Customer.szDlvWorkplaceId AND DeliveryGroup.szDeliveryGroupId = BOS_AR_Customer.szDeliveryGroupId
WHERE  
BOS_AR_Customer.szCustId = p_szCustId;

--SET ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_GetCustomer_013(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_AR_Customer.szName,  
BOS_AR_Customer.CustszContactPerson,  
BOS_AR_Customer.CustszRoomNo,  
BOS_AR_Customer.CustszFloor,  
BOS_AR_Customer.CustszBuilding,  
BOS_AR_Customer.CustszAddress_1,  
BOS_AR_Customer.CustszAddress_2,  
BOS_AR_Customer.CustszDistrict,  
BOS_AR_Customer.CustszCity,  
BOS_AR_Customer.CustszZipcode,  
BOS_AR_Customer.CustszState,  
BOS_AR_Customer.CustszCountry,  
BOS_AR_Customer.CustszPhoneNo_1,  
BOS_AR_Customer.CustszPhoneNo_2,  
BOS_AR_Customer.CustszFaxNo,  
BOS_AR_Customer.CustszMobileNo,  
BOS_AR_Customer.CustszEmail,  
BOS_AR_Customer.CustszWebSite,  

BOS_AR_Customer.szLatitude,  
BOS_AR_Customer.szLongitude,  

BOS_AR_Customer.szFCallId,  
BOS_AR_Customer.bSoldToCust,  
BOS_AR_Customer.bDeliverToCust,  
BOS_AR_Customer.bInvoiceToCust,  
BOS_AR_Customer.bCollectToCust,  
BOS_AR_Customer.szSoldToCustId,  
SOLD_TO.szName as szSoldToCustNm,  
BOS_AR_Customer.szDeliverToCustId,  
DLV_TO.szName as szDeliverToCustNm,  
BOS_AR_Customer.szInvoiceToCustId,  
INV_TO.szName as szInvoiceToCustNm,  
BOS_AR_Customer.szCollectToCustId,  
COLL_TO.szName as szCollectToCustNm,  
BOS_AR_Customer.bIsDiffDeliveryAddress,  
BOS_AR_Customer.bIsDiffInvoiceAddress,  
BOS_AR_Customer.bIsMultiLocation,  
BOS_AR_Customer.szCategory_1,  
CAT_1.szDescription AS szCategory_1Desc,  
CAT_1.szPriceId As szCategory_1PriceId,  
CAT_1.szPromoPriceId As szCategory_1PromoPriceId,  
BOS_AR_Customer.szCategory_2,  
CAT_2.szDescription AS szCategory_2Desc,  
CAT_2.szPriceId As szCategory_2PriceId,  
CAT_2.szPromoPriceId As szCategory_2PromoPriceId,  
BOS_AR_Customer.szCategory_3,  
CAT_3.szDescription AS szCategory_3Desc,  
CAT_3.szPriceId As szCategory_3PriceId,  
CAT_3.szPromoPriceId As szCategory_3PromoPriceId,  
BOS_AR_Customer.szCategory_4,  
CAT_4.szDescription AS szCategory_4Desc,  
CAT_4.szPriceId As szCategory_4PriceId,  
CAT_4.szPromoPriceId As szCategory_4PromoPriceId,  
BOS_AR_Customer.szCategory_5,  
CAT_5.szDescription AS szCategory_5Desc,  
CAT_5.szPriceId As szCategory_5PriceId,  
CAT_5.szPromoPriceId As szCategory_5PromoPriceId,  
BOS_AR_Customer.szCategory_6,  
CAT_6.szDescription AS szCategory_6Desc,  
CAT_6.szPriceId As szCategory_6PriceId,  
CAT_6.szPromoPriceId As szCategory_6PromoPriceId,  
BOS_AR_Customer.szCategory_7,  
CAT_7.szDescription AS szCategory_7Desc,  
CAT_7.szPriceId As szCategory_7PriceId,  
CAT_7.szPromoPriceId As szCategory_7PromoPriceId,  
BOS_AR_Customer.szCategory_8,  
CAT_8.szDescription AS szCategory_8Desc,  
CAT_8.szPriceId As szCategory_8PriceId,  
CAT_8.szPromoPriceId As szCategory_8PromoPriceId,  
BOS_AR_Customer.szCategory_9,  
CAT_9.szDescription AS szCategory_9Desc,  
CAT_9.szPriceId As szCategory_9PriceId,  
CAT_9.szPromoPriceId As szCategory_9PromoPriceId,  
BOS_AR_Customer.szCategory_10,  
CAT_10.szDescription AS szCategory_10Desc,  
CAT_10.szPriceId As szCategory_10PriceId,  
CAT_10.szPromoPriceId As szCategory_10PromoPriceId,  
BOS_AR_Customer.bJoinInvoice,  
BOS_AR_Customer.szStatus,  
BOS_AR_Customer.szReasonId, 

DLV_TO.szDlvWorkplaceId,  
INV_TO.szInvWorkplaceId,  
COLL_TO.szCollWorkplaceId,  
SOLD_TO.szSalWorkplaceId,  

BOS_AR_Customer.szDistrChannelId,  
BOS_SD_DistrChannel.szName as szDistrChannelNm,  
BOS_AR_Customer.szDefaultCcyId,  

BOS_AR_Customer.szStartDoc,  
BOS_AR_Customer.dtmStart,  
BOS_AR_Customer.szContractDoc,  
BOS_AR_Customer.dtmContract,  
BOS_AR_Customer.szRenewalDoc,  
BOS_AR_Customer.dtmRenewal,  
BOS_AR_Customer.szStopDoc,  
BOS_AR_Customer.dtmStop,  
BOS_AR_Customer.szSalesId,  
isNull(BOS_PI_Employee.szName,'') as szSalesNm,  
BOS_AR_Customer.bICP,  
BOS_AR_Customer.szLastFCustBIId,  

--Customer's collection info  
BSR.szRouteId AS szCollRouteId,  
BSR.szDescription AS szCollRouteDescription,  
BSR.szOpUserId AS szCollectorId,  
Collector.szName AS szCollectorNm,  

-- Data Status.  
BOS_AR_Customer.dtmLastUpdated,  
BOS_AR_Customer.bAlreadyTransferred,  
-- Customer Validation  
BOS_AR_Customer.bNeedInvoiceChange,  
BOS_AR_Customer.bInvoiceChangeWithReceipt,  
BOS_AR_Customer.bHasSpecialCollectionDay,  
BOS_AR_Customer.bHasSpecialCollectionDay_Sunday,  
BOS_AR_Customer.bHasSpecialCollectionDay_Monday,  
BOS_AR_Customer.bHasSpecialCollectionDay_Tuesday,  
BOS_AR_Customer.bHasSpecialCollectionDay_Wednesday,  
BOS_AR_Customer.bHasSpecialCollectionDay_Thursday,  
BOS_AR_Customer.bHasSpecialCollectionDay_Friday,  
BOS_AR_Customer.bHasSpecialCollectionDay_Saturday,   
BOS_AR_Customer.bPaymentType_Cash,  
BOS_AR_Customer.bPaymentType_CurrentAccount,  
BOS_AR_Customer.bPaymentType_Transfer,  
BOS_AR_Customer.bRequiredDocuments_PO,  
BOS_AR_Customer.bRequiredDocuments_Receipt,  
BOS_AR_Customer.bRequiredDocuments_StandardTaxInvoice,  
BOS_AR_Customer.bRequiredDocuments_Materai,  
BOS_AR_Customer.bRequiredDocuments_ReceiptNote,  
BOS_AR_Customer.bRequiredDocuments_Other,  
BOS_AR_Customer.szRequiredDocuments_Other,  
BOS_AR_Customer.szGuarantee,
BOS_AR_Customer.szDeliveryGroupId,
ISNULL(DeliveryGroup.szDesc, '') AS szDeliveryGroupDesc_J,
BOS_AR_Customer.szBarcodeId,
BOS_AR_Customer.szActivityStatus,
BOS_AR_Customer.dtmLastChangeActivityStatus    
FROM  
BOS_AR_Customer  
LEFT JOIN BOS_PI_Employee ON BOS_AR_Customer.szSalesId = BOS_PI_Employee.szEmployeeId  
LEFT JOIN BOS_AR_Customer AS SOLD_TO ON SOLD_TO.szCustId = BOS_AR_Customer.szSoldToCustId  
LEFT JOIN BOS_AR_Customer AS DLV_TO ON DLV_TO.szCustId = BOS_AR_Customer.szDeliverToCustId  
LEFT JOIN BOS_AR_Customer AS INV_TO ON INV_TO.szCustId = BOS_AR_Customer.szInvoiceToCustId  
LEFT JOIN BOS_AR_Customer AS COLL_TO ON COLL_TO.szCustId = INV_TO.szCollectToCustId  
LEFT JOIN BOS_AR_Category AS CAT_1 ON CAT_1.szCategoryId = BOS_AR_Customer.szCategory_1  
LEFT JOIN BOS_AR_Category AS CAT_2 ON CAT_2.szCategoryId = BOS_AR_Customer.szCategory_2  
LEFT JOIN BOS_AR_Category AS CAT_3 ON CAT_3.szCategoryId = BOS_AR_Customer.szCategory_3  
LEFT JOIN BOS_AR_Category AS CAT_4 ON CAT_4.szCategoryId = BOS_AR_Customer.szCategory_4  
LEFT JOIN BOS_AR_Category AS CAT_5 ON CAT_5.szCategoryId = BOS_AR_Customer.szCategory_5  
LEFT JOIN BOS_AR_Category AS CAT_6 ON CAT_6.szCategoryId = BOS_AR_Customer.szCategory_6  
LEFT JOIN BOS_AR_Category AS CAT_7 ON CAT_7.szCategoryId = BOS_AR_Customer.szCategory_7  
LEFT JOIN BOS_AR_Category AS CAT_8 ON CAT_8.szCategoryId = BOS_AR_Customer.szCategory_8  
LEFT JOIN BOS_AR_Category AS CAT_9 ON CAT_9.szCategoryId = BOS_AR_Customer.szCategory_9  
LEFT JOIN BOS_AR_Category AS CAT_10 ON CAT_10.szCategoryId = BOS_AR_Customer.szCategory_10  
LEFT JOIN BOS_SD_DistrChannel ON BOS_SD_DistrChannel.szDistrChannelId = BOS_AR_Customer.szDistrChannelId  
LEFT JOIN BOS_SD_CustCollRoutine AS BSCCR ON BSCCR.szCustId = COLL_TO.szCustId  
LEFT JOIN BOS_SD_Route AS BSR ON BSR.szRouteId = BSCCR.szDefaultRouteId  
LEFT JOIN BOS_PI_Employee AS Collector ON Collector.szEmployeeId = BSR.szOpUserId  
LEFT JOIN BOS_SD_DeliveryGroup AS DeliveryGroup ON DeliveryGroup.szWorkplaceId = BOS_AR_Customer.szDlvWorkplaceId AND DeliveryGroup.szDeliveryGroupId = BOS_AR_Customer.szDeliveryGroupId
WHERE  
BOS_AR_Customer.szCustId = p_szCustId;

--SET ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_GetCustomerDlvInfo(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_AR_Customer.szName,
BOS_AR_Customer.bDeliverToCust,
BOS_AR_Customer.szDeliverToCustId,
BOS_AR_Customer.szStatus,
BOS_AR_Customer.bIsDiffDeliveryAddress,
BOS_AR_Customer.bIsMultiLocation,
BOS_AR_Customer.szDlvWorkplaceId,

BOS_AR_Customer.szInvoiceToCustId,

DlvAddr.szCustDeliveryNm as Dlv_szName,

DlvCustomer.bIsDiffDeliveryAddress as Dlv_bIsDiffDeliveryAddress,
DlvCustomer.bIsMultiLocation as Dlv_bIsMultiLocation,
DlvCustomer.szDlvWorkplaceId as Dlv_szDlvWorkplaceId,

DlvAddr.LocationszAddress_1 AS szCustDeliveryAddress_1_J,
DlvCustomer.szDistrChannelId AS szCustDeliveryDistrChannelId_J,
DC.szName AS szCustDeliveryDistrChannelNm_J,

BACS.szPaymentTermId,

BACS.decCreditLimit AS decCreditLimit_J,
InvCustomer.szDefaultCcyId AS szDefaultCcyId_J,

BACS.intMaxCountOpenInv AS intMaxCountOpenInv_J

FROM
BOS_AR_Customer 
LEFT JOIN BOS_AR_Customer AS DlvCustomer ON BOS_AR_Customer.szDeliverToCustId = DlvCustomer.szCustId
LEFT JOIN BOS_AR_CustLocation AS DlvAddr ON (DlvAddr.szCustId = DlvCustomer.szCustId and DlvAddr.btLocId = 0)
LEFT JOIN BOS_AR_Customer AS InvCustomer ON InvCustomer.szCustId = BOS_AR_Customer.szInvoiceToCustId
LEFT JOIN BOS_AR_CustSales AS BACS ON BACS.szCustId = InvCustomer.szCustId
LEFT JOIN BOS_SD_DistrChannel AS DC ON DC.szDistrChannelId = DlvCustomer.szDistrChannelId

WHERE
BOS_AR_Customer.szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_GetCustomerDlvInfo_013(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_AR_Customer.szName,
BOS_AR_Customer.bDeliverToCust,
BOS_AR_Customer.szDeliverToCustId,
BOS_AR_Customer.szStatus,
BOS_AR_Customer.bIsDiffDeliveryAddress,
BOS_AR_Customer.bIsMultiLocation,
BOS_AR_Customer.szDlvWorkplaceId,

BOS_AR_Customer.szInvoiceToCustId,

DlvAddr.szCustDeliveryNm as Dlv_szName,

DlvCustomer.bIsDiffDeliveryAddress as Dlv_bIsDiffDeliveryAddress,
DlvCustomer.bIsMultiLocation as Dlv_bIsMultiLocation,
DlvCustomer.szDlvWorkplaceId as Dlv_szDlvWorkplaceId,

DlvAddr.LocationszAddress_1 AS szCustDeliveryAddress_1_J,
DlvCustomer.szDistrChannelId AS szCustDeliveryDistrChannelId_J,
DC.szName AS szCustDeliveryDistrChannelNm_J,

BACS.szPaymentTermId,

BACS.decCreditLimit AS decCreditLimit_J,
InvCustomer.szDefaultCcyId AS szDefaultCcyId_J,

BACS.intMaxCountOpenInv AS intMaxCountOpenInv_J

FROM
BOS_AR_Customer 
LEFT JOIN BOS_AR_Customer AS DlvCustomer ON BOS_AR_Customer.szDeliverToCustId = DlvCustomer.szCustId
LEFT JOIN BOS_AR_CustLocation AS DlvAddr ON (DlvAddr.szCustId = DlvCustomer.szCustId and DlvAddr.btLocId = 0)
LEFT JOIN BOS_AR_Customer AS InvCustomer ON InvCustomer.szCustId = BOS_AR_Customer.szInvoiceToCustId
LEFT JOIN BOS_AR_CustSales AS BACS ON BACS.szCustId = InvCustomer.szCustId
LEFT JOIN BOS_SD_DistrChannel AS DC ON DC.szDistrChannelId = DlvCustomer.szDistrChannelId

WHERE
BOS_AR_Customer.szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_GetCustomerInvInfo(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
InvAddr.szCustInvoiceNm AS szCustInvName_J,

BOS_AR_Customer.bInvoiceToCust,
BOS_AR_Customer.szInvoiceToCustId,

InvCust.bJoinInvoice AS bJoinInvoice_J,
InvCust.szInvWorkplaceId AS szInvWorkplaceId_J,

InvCustSales.decCreditLimit AS decCreditLimit_J,
InvCust.szDefaultCcyId AS szDefaultCcyId_J,

InvCustSales.szPaymentTermId AS szCustInvCustSalesPaymentTermId_J,

CollCust.szCollWorkplaceId AS szCollWorkplaceId_J,
CollWp.szName as szCollWorkplaceNm_J,

BOS_SD_Route.szOpUserId AS szDefaultRouteCollId_J,

InvCustSales.szInvoiceProcessingId,
BOS_SD_InvoiceProcessing.szPriceOrderId AS szInvProcPriceOrderId_J,
BOS_SD_InvoiceProcessing.szPromoPriceOrderId AS szInvProcPromoPriceOrderId_J,
BOS_SD_InvoiceProcessing.szPriceId AS szInvProcPriceId_J,
BOS_SD_InvoiceProcessing.szPromoPriceId AS szInvProcPromoPriceId_J

FROM
BOS_AR_Customer
LEFT JOIN BOS_AR_Customer AS InvCust ON InvCust.szCustId = BOS_AR_Customer.szInvoiceToCustId
LEFT JOIN BOS_AR_CustInvoice AS InvAddr ON InvAddr.szCustId = InvCust.szCustId
LEFT JOIN BOS_AR_Customer AS CollCust ON CollCust.szCustId = InvCust.szCollectToCustId
LEFT JOIN BOS_SD_CustCollRoutine ON BOS_SD_CustCollRoutine.szCustId = CollCust.szCustId
LEFT JOIN BOS_SD_Route ON BOS_SD_Route.szRouteId = BOS_SD_CustCollRoutine.szDefaultRouteId
LEFT JOIN BOS_GL_Workplace AS CollWp ON CollWp.szWorkplaceId = CollCust.szCollWorkplaceId
LEFT JOIN BOS_AR_CustSales AS InvCustSales ON InvCustSales.szCustId = InvCust.szCustId
LEFT JOIN BOS_SD_InvoiceProcessing ON BOS_SD_InvoiceProcessing.szInvoiceProcessingId = InvCustSales.szInvoiceProcessingId

WHERE
BOS_AR_Customer.szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_GetCustomerProductItem(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_CustomerProductItem.szProductId

FROM 
BOS_AR_CustomerProductItem
WHERE 
BOS_AR_CustomerProductItem.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_GetCustomerSalInfo(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_Customer.szName,
BOS_AR_Customer.bSoldToCust,
BOS_AR_Customer.szSoldToCustId,
BOS_AR_Customer.szSalWorkplaceId,
SalCustomer.szName as Sal_szName,
SalCustomer.szSalWorkplaceId as Sal_szSalWorkplaceId

FROM 
BOS_AR_Customer LEFT JOIN BOS_AR_Customer AS SalCustomer ON BOS_AR_Customer.szSoldToCustId = SalCustomer.szCustIdBOS_AR_Customer LEFT JOIN BOS_AR_Customer AS SalCustomer ON BOS_AR_Customer.szSoldToCustId = SalCustomer.szCustId
WHERE 
BOS_AR_Customer.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_GetCustomerStatus(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szStatus

FROM 
BOS_AR_Customer
WHERE 
 szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_GetListOfCustomer()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId, szName

FROM 
BOS_AR_Customer;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_IsCustomerExist(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId

FROM 
BOS_AR_Customer
WHERE 
szCustId=p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_LockCustomer(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_Customer
SET 
bSoldtoCust=bSoldtoCust
WHERE 
szCustId=p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_UpdateCustomer(
p_szCustId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szFCallId BOS_DT_szId,
p_CustszContactPerson BOS_DT_szName,
p_CustszRoomNo BOS_DT_szSmallName,
p_CustszFloor BOS_DT_szSmallName,
p_CustszBuilding BOS_DT_szName,
p_CustszAddress_1 BOS_DT_szBigDescription,
p_CustszAddress_2 BOS_DT_szBigDescription,
p_CustszDistrict BOS_DT_szMediumName,
p_CustszCity BOS_DT_szMediumName,
p_CustszZipCode BOS_DT_szSmallName,
p_CustszState BOS_DT_szMediumName,
p_CustszCountry BOS_DT_szMediumName,
p_CustszPhoneNo_1 BOS_DT_szMediumName,
p_CustszPhoneNo_2 BOS_DT_szMediumName,
p_CustszFaxNo BOS_DT_szMediumName,
p_CustszMobileNo BOS_DT_szMediumName,
p_CustszEmail BOS_DT_szMediumName,
p_CustszWebSite BOS_DT_szMediumName,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_bSoldToCust bit,
p_bDeliverToCust bit,
p_bInvoiceToCust bit,
p_bCollectToCust bit,
p_szSoldToCustId BOS_DT_szId,
p_szDeliverToCustId BOS_DT_szId,
p_szInvoiceToCustId BOS_DT_szId,
p_szCollectToCustId BOS_DT_szId,
p_bIsDiffDeliveryAddress bit,
p_bIsDiffInvoiceAddress bit,
p_bIsMultiLocation bit,
p_szCategory_1 BOS_DT_szId,
p_szCategory_2 BOS_DT_szId,
p_szCategory_3 BOS_DT_szId,
p_szCategory_4 BOS_DT_szId,
p_szCategory_5 BOS_DT_szId,
p_szCategory_6 BOS_DT_szId,
p_szCategory_7 BOS_DT_szId,
p_szCategory_8 BOS_DT_szId,
p_szCategory_9 BOS_DT_szId,
p_szCategory_10 BOS_DT_szId,
p_bJoinInvoice bit,
p_szStatus varchar,
p_szReasonId BOS_DT_szId,
p_szDlvWorkplaceId BOS_DT_szId,
p_szInvWorkplaceId BOS_DT_szId,
p_szCollWorkplaceId BOS_DT_szId,
p_szSalWorkplaceId BOS_DT_szId,
p_szDistrChannelId BOS_DT_szId,
p_szDefaultCcyId BOS_DT_szSmallId,
p_szStartDoc varchar,
p_dtmStart timestamp,
p_szContractDoc varchar,
p_dtmContract timestamp,
p_szRenewalDoc varchar,
p_dtmRenewal timestamp,
p_szStopDoc varchar,
p_dtmStop timestamp,
p_szSalesId BOS_DT_szId,
p_bICP bit,
p_szLastFCustBIId BOS_DT_szId,
p_bNeedInvoiceChange BOS_DT_bBoolean,
p_bInvoiceChangeWithReceipt BOS_DT_bBoolean,
p_bHasSpecialCollectionDay BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Sunday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Monday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Tuesday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Wednesday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Thursday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Friday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Saturday BOS_DT_bBoolean,
p_bPaymentType_Cash BOS_DT_bBoolean,
p_bPaymentType_CurrentAccount BOS_DT_bBoolean,
p_bPaymentType_Transfer BOS_DT_bBoolean,
p_bRequiredDocuments_PO BOS_DT_bBoolean,
p_bRequiredDocuments_Receipt BOS_DT_bBoolean,
p_bRequiredDocuments_StandardTaxInvoice BOS_DT_bBoolean,
p_bRequiredDocuments_Materai BOS_DT_bBoolean,
p_bRequiredDocuments_ReceiptNote BOS_DT_bBoolean,
p_bRequiredDocuments_Other BOS_DT_bBoolean,
p_szRequiredDocuments_Other BOS_DT_szBigDescription,
p_szGuarantee BOS_DT_szBigDescription,
p_szDeliveryGroupId BOS_DT_szId,
p_szBarcodeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_Customer
SET 
szName=p_szName,
szFCallId = p_szFCallId,
CustszContactPerson=p_CustszContactPerson,
CustszRoomNo=p_CustszRoomNo,
CustszFloor=p_CustszFloor,
CustszBuilding=p_CustszBuilding,
CustszAddress_1=p_CustszAddress_1,
CustszAddress_2=p_CustszAddress_2,
CustszDistrict=p_CustszDistrict,
CustszCity=p_CustszCity,
CustszZipcode=p_CustszZipcode,
CustszState=p_CustszState,
CustszCountry=p_CustszCountry,
CustszPhoneNo_1=p_CustszPhoneNo_1,
CustszPhoneNo_2=p_CustszPhoneNo_2,
CustszFaxNo=p_CustszFaxNo,
CustszMobileNo=p_CustszMobileNo,
CustszEmail=p_CustszEmail,
CustszWebSite=p_CustszWebSite,
szLatitude=p_szLatitude,
szLongitude=p_szLongitude,
bSoldToCust=p_bSoldToCust,
bDeliverToCust=p_bDeliverToCust,
bInvoiceToCust=p_bInvoiceToCust,
bCollectToCust=p_bCollectToCust,
szSoldToCustId=p_szSoldToCustId,
szDeliverToCustId=p_szDeliverToCustId,
szInvoiceToCustId=p_szInvoiceToCustId,
szCollectToCustId = p_szCollectToCustId,
bIsDiffDeliveryAddress=p_bIsDiffDeliveryAddress,
bIsDiffInvoiceAddress=p_bIsDiffInvoiceAddress,
bIsMultiLocation=p_bIsMultiLocation,
szCategory_1=p_szCategory_1,
szCategory_2=p_szCategory_2,
szCategory_3=p_szCategory_3,
szCategory_4=p_szCategory_4,
szCategory_5=p_szCategory_5,
szCategory_6=p_szCategory_6,
szCategory_7=p_szCategory_7,
szCategory_8=p_szCategory_8,
szCategory_9=p_szCategory_9,
szCategory_10=p_szCategory_10,
bJoinInvoice=p_bJoinInvoice,
szStatus = p_szStatus,
szReasonId = p_szReasonId,

szDlvWorkplaceId = p_szDlvWorkplaceId,
szInvWorkplaceId =  p_szInvWorkplaceId,
szCollWorkplaceId = p_szCollWorkplaceId,
szSalWorkplaceId = p_szSalWorkplaceId,
szDistrChannelId = p_szDistrChannelId,
szDefaultCcyId = p_szDefaultCcyId,
szStartDoc = p_szStartDoc ,
dtmStart = p_dtmStart ,
szContractDoc = p_szContractDoc ,
dtmContract = p_dtmContract ,
szRenewalDoc = p_szRenewalDoc ,
dtmRenewal = p_dtmRenewal ,
szStopDoc = p_szStopDoc ,
dtmStop = p_dtmStop ,
szSalesId = p_szSalesId ,
bICP = p_bICP,
szLastFCustBIId = p_szLastFCustBIId,
-- Customer Validation
bNeedInvoiceChange = p_bNeedInvoiceChange,
bInvoiceChangeWithReceipt = p_bInvoiceChangeWithReceipt,
bHasSpecialCollectionDay = p_bHasSpecialCollectionDay,
bHasSpecialCollectionDay_Sunday = p_bHasSpecialCollectionDay_Sunday,
bHasSpecialCollectionDay_Monday = p_bHasSpecialCollectionDay_Monday,
bHasSpecialCollectionDay_Tuesday = p_bHasSpecialCollectionDay_Tuesday,
bHasSpecialCollectionDay_Wednesday = p_bHasSpecialCollectionDay_Wednesday,
bHasSpecialCollectionDay_Thursday = p_bHasSpecialCollectionDay_Thursday,
bHasSpecialCollectionDay_Friday = p_bHasSpecialCollectionDay_Friday,
bHasSpecialCollectionDay_Saturday = p_bHasSpecialCollectionDay_Saturday,
bPaymentType_Cash = p_bPaymentType_Cash,
bPaymentType_CurrentAccount = p_bPaymentType_CurrentAccount,
bPaymentType_Transfer = p_bPaymentType_Transfer,
bRequiredDocuments_PO = p_bRequiredDocuments_PO,
bRequiredDocuments_Receipt = p_bRequiredDocuments_Receipt,
bRequiredDocuments_StandardTaxInvoice = p_bRequiredDocuments_StandardTaxInvoice,
bRequiredDocuments_Materai = p_bRequiredDocuments_Materai,
bRequiredDocuments_ReceiptNote = p_bRequiredDocuments_ReceiptNote,
bRequiredDocuments_Other = p_bRequiredDocuments_Other,
szRequiredDocuments_Other = p_szRequiredDocuments_Other,
szGuarantee = p_szGuarantee,
szDeliveryGroupId = p_szDeliveryGroupId,
szBarcodeId = p_szBarcodeId
WHERE 
szCustId=p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_UpdateCustomer_013(
p_szCustId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szFCallId BOS_DT_szId,
p_CustszContactPerson BOS_DT_szName,
p_CustszRoomNo BOS_DT_szSmallName,
p_CustszFloor BOS_DT_szSmallName,
p_CustszBuilding BOS_DT_szName,
p_CustszAddress_1 BOS_DT_szBigDescription,
p_CustszAddress_2 BOS_DT_szBigDescription,
p_CustszDistrict BOS_DT_szName,
p_CustszCity BOS_DT_szMediumName,
p_CustszZipCode BOS_DT_szSmallName,
p_CustszState BOS_DT_szMediumName,
p_CustszCountry BOS_DT_szMediumName,
p_CustszPhoneNo_1 BOS_DT_szMediumName,
p_CustszPhoneNo_2 BOS_DT_szMediumName,
p_CustszFaxNo BOS_DT_szMediumName,
p_CustszMobileNo BOS_DT_szMediumName,
p_CustszEmail BOS_DT_szMediumName,
p_CustszWebSite BOS_DT_szMediumName,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_bSoldToCust bit,
p_bDeliverToCust bit,
p_bInvoiceToCust bit,
p_bCollectToCust bit,
p_szSoldToCustId BOS_DT_szId,
p_szDeliverToCustId BOS_DT_szId,
p_szInvoiceToCustId BOS_DT_szId,
p_szCollectToCustId BOS_DT_szId,
p_bIsDiffDeliveryAddress bit,
p_bIsDiffInvoiceAddress bit,
p_bIsMultiLocation bit,
p_szCategory_1 BOS_DT_szId,
p_szCategory_2 BOS_DT_szId,
p_szCategory_3 BOS_DT_szId,
p_szCategory_4 BOS_DT_szId,
p_szCategory_5 BOS_DT_szId,
p_szCategory_6 BOS_DT_szId,
p_szCategory_7 BOS_DT_szId,
p_szCategory_8 BOS_DT_szId,
p_szCategory_9 BOS_DT_szId,
p_szCategory_10 BOS_DT_szId,
p_bJoinInvoice bit,
p_szStatus varchar,
p_szReasonId BOS_DT_szId,
p_szDlvWorkplaceId BOS_DT_szId,
p_szInvWorkplaceId BOS_DT_szId,
p_szCollWorkplaceId BOS_DT_szId,
p_szSalWorkplaceId BOS_DT_szId,
p_szDistrChannelId BOS_DT_szId,
p_szDefaultCcyId BOS_DT_szSmallId,
p_szStartDoc varchar,
p_dtmStart timestamp,
p_szContractDoc varchar,
p_dtmContract timestamp,
p_szRenewalDoc varchar,
p_dtmRenewal timestamp,
p_szStopDoc varchar,
p_dtmStop timestamp,
p_szSalesId BOS_DT_szId,
p_bICP bit,
p_szLastFCustBIId BOS_DT_szId,
p_bNeedInvoiceChange BOS_DT_bBoolean,
p_bInvoiceChangeWithReceipt BOS_DT_bBoolean,
p_bHasSpecialCollectionDay BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Sunday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Monday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Tuesday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Wednesday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Thursday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Friday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Saturday BOS_DT_bBoolean,
p_bPaymentType_Cash BOS_DT_bBoolean,
p_bPaymentType_CurrentAccount BOS_DT_bBoolean,
p_bPaymentType_Transfer BOS_DT_bBoolean,
p_bRequiredDocuments_PO BOS_DT_bBoolean,
p_bRequiredDocuments_Receipt BOS_DT_bBoolean,
p_bRequiredDocuments_StandardTaxInvoice BOS_DT_bBoolean,
p_bRequiredDocuments_Materai BOS_DT_bBoolean,
p_bRequiredDocuments_ReceiptNote BOS_DT_bBoolean,
p_bRequiredDocuments_Other BOS_DT_bBoolean,
p_szRequiredDocuments_Other BOS_DT_szBigDescription,
p_szGuarantee BOS_DT_szBigDescription,
p_szDeliveryGroupId BOS_DT_szId,
p_szBarcodeId BOS_DT_szId,
p_szActivityStatus BOS_DT_szId,
p_dtmLastChangeActivityStatus timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_Customer
SET 
szName=p_szName,
szFCallId = p_szFCallId,
CustszContactPerson=p_CustszContactPerson,
CustszRoomNo=p_CustszRoomNo,
CustszFloor=p_CustszFloor,
CustszBuilding=p_CustszBuilding,
CustszAddress_1=p_CustszAddress_1,
CustszAddress_2=p_CustszAddress_2,
CustszDistrict=p_CustszDistrict,
CustszCity=p_CustszCity,
CustszZipcode=p_CustszZipcode,
CustszState=p_CustszState,
CustszCountry=p_CustszCountry,
CustszPhoneNo_1=p_CustszPhoneNo_1,
CustszPhoneNo_2=p_CustszPhoneNo_2,
CustszFaxNo=p_CustszFaxNo,
CustszMobileNo=p_CustszMobileNo,
CustszEmail=p_CustszEmail,
CustszWebSite=p_CustszWebSite,
szLatitude=p_szLatitude,
szLongitude=p_szLongitude,
bSoldToCust=p_bSoldToCust,
bDeliverToCust=p_bDeliverToCust,
bInvoiceToCust=p_bInvoiceToCust,
bCollectToCust=p_bCollectToCust,
szSoldToCustId=p_szSoldToCustId,
szDeliverToCustId=p_szDeliverToCustId,
szInvoiceToCustId=p_szInvoiceToCustId,
szCollectToCustId = p_szCollectToCustId,
bIsDiffDeliveryAddress=p_bIsDiffDeliveryAddress,
bIsDiffInvoiceAddress=p_bIsDiffInvoiceAddress,
bIsMultiLocation=p_bIsMultiLocation,
szCategory_1=p_szCategory_1,
szCategory_2=p_szCategory_2,
szCategory_3=p_szCategory_3,
szCategory_4=p_szCategory_4,
szCategory_5=p_szCategory_5,
szCategory_6=p_szCategory_6,
szCategory_7=p_szCategory_7,
szCategory_8=p_szCategory_8,
szCategory_9=p_szCategory_9,
szCategory_10=p_szCategory_10,
bJoinInvoice=p_bJoinInvoice,
szStatus = p_szStatus,
szReasonId = p_szReasonId,

szDlvWorkplaceId = p_szDlvWorkplaceId,
szInvWorkplaceId =  p_szInvWorkplaceId,
szCollWorkplaceId = p_szCollWorkplaceId,
szSalWorkplaceId = p_szSalWorkplaceId,
szDistrChannelId = p_szDistrChannelId,
szDefaultCcyId = p_szDefaultCcyId,
szStartDoc = p_szStartDoc ,
dtmStart = p_dtmStart ,
szContractDoc = p_szContractDoc ,
dtmContract = p_dtmContract ,
szRenewalDoc = p_szRenewalDoc ,
dtmRenewal = p_dtmRenewal ,
szStopDoc = p_szStopDoc ,
dtmStop = p_dtmStop ,
szSalesId = p_szSalesId ,
bICP = p_bICP,
szLastFCustBIId = p_szLastFCustBIId,
-- Customer Validation
bNeedInvoiceChange = p_bNeedInvoiceChange,
bInvoiceChangeWithReceipt = p_bInvoiceChangeWithReceipt,
bHasSpecialCollectionDay = p_bHasSpecialCollectionDay,
bHasSpecialCollectionDay_Sunday = p_bHasSpecialCollectionDay_Sunday,
bHasSpecialCollectionDay_Monday = p_bHasSpecialCollectionDay_Monday,
bHasSpecialCollectionDay_Tuesday = p_bHasSpecialCollectionDay_Tuesday,
bHasSpecialCollectionDay_Wednesday = p_bHasSpecialCollectionDay_Wednesday,
bHasSpecialCollectionDay_Thursday = p_bHasSpecialCollectionDay_Thursday,
bHasSpecialCollectionDay_Friday = p_bHasSpecialCollectionDay_Friday,
bHasSpecialCollectionDay_Saturday = p_bHasSpecialCollectionDay_Saturday,
bPaymentType_Cash = p_bPaymentType_Cash,
bPaymentType_CurrentAccount = p_bPaymentType_CurrentAccount,
bPaymentType_Transfer = p_bPaymentType_Transfer,
bRequiredDocuments_PO = p_bRequiredDocuments_PO,
bRequiredDocuments_Receipt = p_bRequiredDocuments_Receipt,
bRequiredDocuments_StandardTaxInvoice = p_bRequiredDocuments_StandardTaxInvoice,
bRequiredDocuments_Materai = p_bRequiredDocuments_Materai,
bRequiredDocuments_ReceiptNote = p_bRequiredDocuments_ReceiptNote,
bRequiredDocuments_Other = p_bRequiredDocuments_Other,
szRequiredDocuments_Other = p_szRequiredDocuments_Other,
szGuarantee = p_szGuarantee,
szDeliveryGroupId = p_szDeliveryGroupId,
szBarcodeId = p_szBarcodeId,
szActivityStatus = p_szActivityStatus,
dtmLastChangeActivityStatus = p_dtmLastChangeActivityStatus
WHERE 
szCustId=p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_UpdateCustomerStatus(
p_szCustId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId,
p_szReasonId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_Customer
SET 
szStatus = p_szStatus,
szReasonId = p_szReasonId
WHERE 
szCustId=p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_Customer_UpdateOnlyCustomerAddress(
p_szCustId BOS_DT_szId,
p_CustszContactPerson BOS_DT_szName,
p_CustszRoomNo BOS_DT_szSmallName,
p_CustszFloor BOS_DT_szSmallName,
p_CustszBuilding BOS_DT_szName,
p_CustszAddress_1 BOS_DT_szName,
p_CustszAddress_2 BOS_DT_szName,
p_CustszDistrict BOS_DT_szName,
p_CustszCity BOS_DT_szMediumName,
p_CustszZipCode BOS_DT_szSmallName,
p_CustszState BOS_DT_szMediumName,
p_CustszCountry BOS_DT_szMediumName,
p_CustszPhoneNo_1 BOS_DT_szMediumName,
p_CustszPhoneNo_2 BOS_DT_szMediumName,
p_CustszFaxNo BOS_DT_szMediumName,
p_CustszMobileNo BOS_DT_szMediumName,
p_CustszEmail BOS_DT_szMediumName,
p_CustszWebSite BOS_DT_szMediumName)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_Customer
SET 
CustszContactPerson=p_CustszContactPerson,
CustszRoomNo=p_CustszRoomNo,
CustszFloor=p_CustszFloor,
CustszBuilding=p_CustszBuilding,
CustszAddress_1=p_CustszAddress_1,
CustszAddress_2=p_CustszAddress_2,
CustszDistrict=p_CustszDistrict,
CustszCity=p_CustszCity,
CustszZipcode=p_CustszZipcode,
CustszState=p_CustszState,
CustszCountry=p_CustszCountry,
CustszPhoneNo_1=p_CustszPhoneNo_1,
CustszPhoneNo_2=p_CustszPhoneNo_2,
CustszFaxNo=p_CustszFaxNo,
CustszMobileNo=p_CustszMobileNo,
CustszEmail=p_CustszEmail,
CustszWebSite=p_CustszWebSite


WHERE 
szCustId=p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustPrePayment_CreateCustPrePayment(
p_szCustId BOS_DT_szId,
p_decPayment BOS_DT_decAmount,
p_szCcyId BOS_DT_szSmallId,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_CustPrePayment
(
szCustId,
decPayment,
szCcyId,
dtmLastUpdated
)
VALUES
(
p_szCustId,
p_decPayment,
p_szCcyId,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustPrePayment_CreateCustPrePayment_014(
p_szCustId BOS_DT_szId,
p_decPayment BOS_DT_decAmount,
p_szCcyId BOS_DT_szSmallId,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_CustPrePayment
(
szCustId,
decPayment,
szCcyId,
dtmLastUpdated
)
VALUES
(
p_szCustId,
p_decPayment,
p_szCcyId,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustPrePayment_CreateCustPrePaymentHistory(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_decPrePayment BOS_DT_decAmount,
p_dtmPayment timestamp,
p_szTrnId BOS_DT_szId,
p_szDocId BOS_DT_szId,
p_szUrl BOS_DT_szUrl,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_CustPrePaymentHistory
(
szCustId,
szCcyId,
decPrePayment,
dtmPayment,
szTrnId,
szDocId,
szUrl,
szDescription
)
VALUES
(
p_szCustId,
p_szCcyId,
p_decPrePayment,
p_dtmPayment,
p_szTrnId,
p_szDocId,
p_szUrl,
p_szDescription
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustPrePayment_CreateCustPrePaymentHistory_013(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_decPrePayment BOS_DT_decAmount,
p_dtmPayment timestamp,
p_szTrnId BOS_DT_szId,
p_szDocId BOS_DT_szId,
p_szUrl BOS_DT_szUrl,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_CustPrePaymentHistory
(
szCustId,
szCcyId,
decPrePayment,
dtmPayment,
szTrnId,
szDocId,
szUrl,
szDescription
)
VALUES
(
p_szCustId,
p_szCcyId,
p_decPrePayment,
p_dtmPayment,
p_szTrnId,
p_szDocId,
p_szUrl,
p_szDescription
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustPrePayment_DeleteCustPrePayment(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_AR_CustPrePayment
WHERE
szCustId = p_szCustId And szCcyId = p_szCcyId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustPrePayment_GetCustPrePayment(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_AR_CustPrePayment.szCustId,
BOS_AR_Customer.szName as szCustNm_J,

BOS_AR_CustPrePayment.szCcyId,
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat_J,
BOS_CU_Currency.szSymbol AS szCcySymbol_J,

decPayment,
BOS_AR_CustPrePayment.dtmLastUpdated

FROM
BOS_AR_CustPrePayment
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_CustPrePayment.szCcyId
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_AR_CustPrePayment.szCustId

WHERE
BOS_AR_CustPrePayment.szCustId = p_szCustId And BOS_AR_CustPrePayment.szCcyId = p_szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustPrePayment_GetCustPrePayment_014(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_AR_CustPrePayment.szCustId,
BOS_AR_Customer.szName as szCustNm_J,

BOS_AR_CustPrePayment.szCcyId,
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat_J,
BOS_CU_Currency.szSymbol AS szCcySymbol_J,

decPayment,
BOS_AR_CustPrePayment.dtmLastUpdated

FROM
BOS_AR_CustPrePayment
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_CustPrePayment.szCcyId
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_AR_CustPrePayment.szCustId

WHERE
BOS_AR_CustPrePayment.szCustId = p_szCustId And BOS_AR_CustPrePayment.szCcyId = p_szCcyId;


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustPrePayment_GetListOfCustPrePayment()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId,
szCcyId

FROM 
BOS_AR_CustPrePayment;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustPrePayment_GetListOfCustPrePaymentData(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

Select
BOS_AR_CustPrePayment.szCustId,
BOS_AR_Customer.szName as szCustNm_J,

BOS_AR_CustPrePayment.szCcyId,
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat_J,
BOS_CU_Currency.szSymbol AS szCcySymbol_J,

decPayment

From
BOS_AR_CustPrePayment
LEFT JOIN BOS_CU_Currency ON BOS_AR_CustPrePayment.szCcyId = BOS_CU_Currency.szCcyId
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_AR_CustPrePayment.szCustId

Where
BOS_AR_CustPrePayment.szCustId LIKE p_szCustId

Order By
BOS_AR_CustPrePayment.szCustId, BOS_AR_CustPrePayment.szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustPrePayment_GetListOfCustPrePaymentHistory(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_dtmStartPeriod timestamp,
p_dtmEndPeriod timestamp)
RETURNS void AS
$BODY$
BEGIN

Select	
BOS_AR_CustPrePaymentHistory.szCustId,
BOS_AR_Customer.szName,
BOS_AR_CustPrePaymentHistory.dtmPayment,
BOS_AR_CustPrePaymentHistory.decPrePayment,
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat_J,
BOS_AR_CustPrePaymentHistory.szTrnId,
BOS_AR_CustPrePaymentHistory.szDocId,
BOS_AR_CustPrePaymentHistory.szUrl,
BOS_AR_CustPrePaymentHistory.szDescription

From
BOS_AR_CustPrePaymentHistory
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_AR_CustPrePaymentHistory.szCustId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_CustPrePaymentHistory.szCcyId

Where
BOS_AR_CustPrePaymentHistory.szCustId LIKE p_szCustId AND
BOS_AR_CustPrePaymentHistory.szCcyId = p_szCcyId AND
BOS_AR_CustPrePaymentHistory.dtmPayment >= p_dtmStartPeriod AND	
BOS_AR_CustPrePaymentHistory.dtmPayment < dateadd(day, 1, p_dtmEndPeriod)
Order By
BOS_AR_CustPrePaymentHistory.dtmPayment;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustPrePayment_IncrCustPrePayment(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_decPayment BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_CustPrePayment
SET 
decPayment = decPayment + p_decPayment

WHERE 
szCustId = p_szCustId And szCcyId = p_szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustPrePayment_IsCustPrePaymentExist(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId

FROM 
BOS_AR_CustPrePayment
WHERE 
szCustId = p_szCustId And szCcyId = p_szCcyId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustPrePayment_LockCustPrePayment(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_CustPrePayment
SET 
decPayment = decPayment
WHERE 
szCustId = p_szCustId And szCcyId = p_szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustPrePayment_UpdateCustPrePayment(
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_decPayment BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_CustPrePayment
SET 
decPayment = p_decPayment

WHERE 
szCustId = p_szCustId And szCcyId = p_szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustProductDeposit_CreateCustProductDeposit(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_CustProductDeposit
(
szCustId,
szProductId,
decQty,
dtmLastUpdated
)
VALUES
(
p_szCustId,
p_szProductId,
p_decQty,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustProductDeposit_CreateCustProductDeposit_014(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_CustProductDeposit
(
szCustId,
szProductId,
decQty,
dtmLastUpdated
)
VALUES
(
p_szCustId,
p_szProductId,
p_decQty,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustProductDeposit_CreateCustProductDepositHistory(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_dtmTransaction timestamp,
p_decQty BOS_DT_decAmount,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szUrl BOS_DT_szUrl,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_CustProductDepositHistory
(
	szCustId,
	szProductId,
	dtmTransaction,
	decQty,
	szTrnId,
	szDocId,
	szUrl,
	szDescription
)
VALUES
(
p_szCustId,
p_szProductId,
p_dtmTransaction,
p_decQty,
p_szTrnId,
p_szDocId,
p_szUrl,
p_szDescription
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustProductDeposit_CreateCustProductDepositHistory_013(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_dtmTransaction timestamp,
p_decQty BOS_DT_decAmount,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szUrl BOS_DT_szUrl,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_CustProductDepositHistory
(
	szCustId,
	szProductId,
	dtmTransaction,
	decQty,
	szTrnId,
	szDocId,
	szUrl,
	szDescription
)
VALUES
(
p_szCustId,
p_szProductId,
p_dtmTransaction,
p_decQty,
p_szTrnId,
p_szDocId,
p_szUrl,
p_szDescription
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustProductDeposit_DeleteCustProductDeposit(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_AR_CustProductDeposit
WHERE
szCustId = p_szCustId AND szProductId = p_szProductId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustProductDeposit_GetCustProductDeposit(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_AR_CustProductDeposit.szCustId,
isnull(BOS_AR_Customer.szName,'') AS szCustNm,
BOS_AR_CustProductDeposit.szProductId,
isnull(BOS_INV_Product.szName,'') as szProductNm,
BOS_AR_CustProductDeposit.decQty,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat,
BOS_AR_CustProductDeposit.dtmLastUpdated

FROM  BOS_AR_CustProductDeposit

left join BOS_INV_Product on 
BOS_AR_CustProductDeposit.szProductId = BOS_INV_Product.szProductId
left join BOS_AR_Customer on 
BOS_AR_CustProductDeposit.szCustId = BOS_AR_Customer.szCustId


WHERE
BOS_AR_CustProductDeposit.szCustId = p_szCustId AND
BOS_AR_CustProductDeposit.szProductId = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustProductDeposit_GetCustProductDeposit_014(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_AR_CustProductDeposit.szCustId,
isnull(BOS_AR_Customer.szName,'') AS szCustNm,
BOS_AR_CustProductDeposit.szProductId,
isnull(BOS_INV_Product.szName,'') as szProductNm,
BOS_AR_CustProductDeposit.decQty,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat,
BOS_AR_CustProductDeposit.dtmLastUpdated

FROM  BOS_AR_CustProductDeposit

left join BOS_INV_Product on 
BOS_AR_CustProductDeposit.szProductId = BOS_INV_Product.szProductId
left join BOS_AR_Customer on 
BOS_AR_CustProductDeposit.szCustId = BOS_AR_Customer.szCustId


WHERE
BOS_AR_CustProductDeposit.szCustId = p_szCustId AND
BOS_AR_CustProductDeposit.szProductId = p_szProductId;


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustProductDeposit_GetListOfCustProductDeposit()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId,
szProductId

FROM 
BOS_AR_CustProductDeposit;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustProductDeposit_GetListOfCustProductDepositData(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_AR_CustProductDeposit.szCustId,
isnull(BOS_AR_Customer.szName,'') AS szCustNm,
BOS_AR_CustProductDeposit.szProductId,
isnull(BOS_INV_Product.szName,'') as szProductNm,
BOS_AR_CustProductDeposit.decQty,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat

FROM
BOS_AR_CustProductDeposit
left join BOS_INV_Product on BOS_AR_CustProductDeposit.szProductId = BOS_INV_Product.szProductId
left join BOS_AR_Customer on BOS_AR_CustProductDeposit.szCustId = BOS_AR_Customer.szCustId


WHERE
BOS_AR_CustProductDeposit.szCustId LIKE p_szCustId
AND BOS_AR_CustProductDeposit.szProductId LIKE p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustProductDeposit_GetListOfCustProductDepositHistoryData(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_dtmStartDate timestamp,
p_dtmEndDate timestamp)
RETURNS void AS
$BODY$
BEGIN

SELECT 
BOS_AR_CustProductDepositHistory.szCustId,
isnull(BOS_AR_Customer.szName,'') AS szCustNm,
BOS_AR_CustProductDepositHistory.szProductId,
isnull(BOS_INV_Product.szName,'') as szProductNm,
BOS_AR_CustProductDepositHistory.dtmTransaction,
BOS_INV_Product.szQtyFormat as szProductQtyFormat,

BOS_AR_CustProductDepositHistory.decQty,
BOS_INV_Product.szUomId AS szProductUomId_J,

BOS_AR_CustProductDepositHistory.szTrnId,
BOS_AR_CustProductDepositHistory.szDocId,
BOS_AR_CustProductDepositHistory.szUrl,
BOS_AR_CustProductDepositHistory.szDescription


FROM
BOS_AR_CustProductDepositHistory
left join BOS_INV_Product on BOS_AR_CustProductDepositHistory.szProductId = BOS_INV_Product.szProductId
left join BOS_AR_Customer on BOS_AR_CustProductDepositHistory.szCustId = BOS_AR_Customer.szCustId
LEFT JOIN BOS_AR_CustProductDeposit ON BOS_AR_CustProductDeposit.szCustId = BOS_AR_CustProductDepositHistory.szCustId
AND BOS_AR_CustProductDeposit.szProductId = BOS_AR_CustProductDepositHistory.szProductId

WHERE
BOS_AR_CustProductDepositHistory.szCustId LIKE p_szCustId and
--We don't want to return mix products as they will have mix UOMs.
BOS_AR_CustProductDepositHistory.szProductId = p_szProductId and
(BOS_AR_CustProductDepositHistory.dtmTransaction >= p_dtmStartDate AND
BOS_AR_CustProductDepositHistory.dtmTransaction < dateadd(day,1, p_dtmEndDate) )

ORDER BY
BOS_AR_CustProductDepositHistory.dtmTransaction;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustProductDeposit_IsCustProductDepositExist(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_CustProductDeposit.szCustId


FROM 
BOS_AR_CustProductDeposit

WHERE 
szCustId LIKE p_szCustId AND szProductId = p_szProductId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustProductDeposit_LockCustProductDeposit(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_CustProductDeposit
SET 
decQty = decQty

WHERE 
szCustId = p_szCustId AND szProductId = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustProductDeposit_UpdateCustProductDeposit(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_CustProductDeposit
SET 
decQty = p_decQty

WHERE 
szCustId = p_szCustId AND
szProductId = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustSales_CreateCustSales(
p_szCustId BOS_DT_szId,
p_bAllowToCredit bit,
p_decCreditLimit BOS_DT_decAmount,
p_szPaymentTermId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szInvoiceProcessingId BOS_DT_szId,
p_bInvoiceNote bit,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_bNoVatApplied BOS_DT_bBoolean,
p_bCheckMaxDropSize BOS_DT_bBoolean,
p_intMaxCountOpenInv smallint,
p_bCheckMinDropSize BOS_DT_bBoolean,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_CustSales
(
szCustId ,
bAllowToCredit,
decCreditLimit,
szPaymentTermId,
szPriceId,
szPriceOrderId,
szInvoiceProcessingId,
bInvoiceNote,
szPromoPriceId,
szPromoPriceOrderId,
bNoVatApplied,
bCheckMaxDropSize,
intMaxCountOpenInv,
bCheckMinDropSize,
dtmLastUpdated
)
VALUES
(
p_szCustId,
p_bAllowToCredit,
p_decCreditLimit,
p_szPaymentTermId,
p_szPriceId,
p_szPriceOrderId,
p_szInvoiceProcessingId,
p_bInvoiceNote,
p_szPromoPriceId,
p_szPromoPriceOrderId,
p_bNoVatApplied,
p_bCheckMaxDropSize,
p_intMaxCountOpenInv,
p_bCheckMinDropSize,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustSales_CreateCustSales_013(
p_szCustId BOS_DT_szId,
p_bAllowToCredit bit,
p_decCreditLimit BOS_DT_decAmount,
p_szPaymentTermId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szInvoiceProcessingId BOS_DT_szId,
p_bInvoiceNote bit,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_bNoVatApplied BOS_DT_bBoolean,
p_bCheckMaxDropSize BOS_DT_bBoolean,
p_intMaxCountOpenInv smallint,
p_bCheckMinDropSize BOS_DT_bBoolean,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_CustSales
(
szCustId ,
bAllowToCredit,
decCreditLimit,
szPaymentTermId,
szPriceId,
szPriceOrderId,
szInvoiceProcessingId,
bInvoiceNote,
szPromoPriceId,
szPromoPriceOrderId,
bNoVatApplied,
bCheckMaxDropSize,
intMaxCountOpenInv,
bCheckMinDropSize,
dtmLastUpdated
)
VALUES
(
p_szCustId,
p_bAllowToCredit,
p_decCreditLimit,
p_szPaymentTermId,
p_szPriceId,
p_szPriceOrderId,
p_szInvoiceProcessingId,
p_bInvoiceNote,
p_szPromoPriceId,
p_szPromoPriceOrderId,
p_bNoVatApplied,
p_bCheckMaxDropSize,
p_intMaxCountOpenInv,
p_bCheckMinDropSize,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustSales_DeleteCustSales(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE FROM BOS_AR_CustSales
WHERE 
	szCustId = p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustSales_GetCustSales(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_AR_Customer.szName as szCustNm_J,
BOS_AR_Customer.szDlvWorkplaceId AS szCustDlvWorkplaceId_J,

BOS_AR_CustSales.bAllowToCredit,
BOS_AR_CustSales.decCreditLimit,
BOS_AR_Customer.szDefaultCcyId AS szDefaultCcyId_J,
BOS_CU_Currency.szAmountFormat AS szDefaultCcyAmountFormat_J,
BOS_AR_CustSales.szPaymentTermId, 

BOS_AR_CustSales.szPriceId,
BOS_AR_CustSales.szPriceOrderId,

BOS_AR_CustSales.szInvoiceProcessingId,
BOS_SD_InvoiceProcessing.szDescription AS szInvoiceProcessingDescr_J,
BOS_SD_InvoiceProcessing.bImmediateInvoice AS bInvoiceProcessingImmediateInvoice_J,

BOS_AR_CustSales.bInvoiceNote,

BOS_AR_CustSales.szPromoPriceId,
BOS_AR_CustSales.szPromoPriceOrderId,

BOS_AR_CustSales.bNoVatApplied,

TBL_CAT1.szCategoryId  AS szCustCategoryId_1_J,
TBL_CAT1.szPriceId  AS szCustCategoryPriceId_1_J,	
TBL_CAT1.szPromoPriceId  AS szCustCategoryPromoPriceId_1_J,	
TBL_CAT1.szPriceOrderId  AS szCustCategoryPriceOrderId_1_J,	
TBL_CAT1.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_1_J,	

TBL_CAT2.szCategoryId  AS szCustCategoryId_2_J,
TBL_CAT2.szPriceId  AS szCustCategoryPriceId_2_J,	
TBL_CAT2.szPromoPriceId  AS szCustCategoryPromoPriceId_2_J,	
TBL_CAT2.szPriceOrderId  AS szCustCategoryPriceOrderId_2_J,	
TBL_CAT2.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_2_J,	

TBL_CAT3.szCategoryId  AS szCustCategoryId_3_J,
TBL_CAT3.szPriceId  AS szCustCategoryPriceId_3_J,	
TBL_CAT3.szPromoPriceId  AS szCustCategoryPromoPriceId_3_J,	
TBL_CAT3.szPriceOrderId  AS szCustCategoryPriceOrderId_3_J,	
TBL_CAT3.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_3_J,	

TBL_CAT4.szCategoryId  AS szCustCategoryId_4_J,
TBL_CAT4.szPriceId  AS szCustCategoryPriceId_4_J,	
TBL_CAT4.szPromoPriceId  AS szCustCategoryPromoPriceId_4_J,	
TBL_CAT4.szPriceOrderId  AS szCustCategoryPriceOrderId_4_J,	
TBL_CAT4.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_4_J,	

TBL_CAT5.szCategoryId  AS szCustCategoryId_5_J,
TBL_CAT5.szPriceId  AS szCustCategoryPriceId_5_J,	
TBL_CAT5.szPromoPriceId  AS szCustCategoryPromoPriceId_5_J,
TBL_CAT5.szPriceOrderId  AS szCustCategoryPriceOrderId_5_J,	
TBL_CAT5.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_5_J,

TBL_CAT6.szCategoryId  AS szCustCategoryId_6_J,
TBL_CAT6.szPriceId  AS szCustCategoryPriceId_6_J,	
TBL_CAT6.szPromoPriceId  AS szCustCategoryPromoPriceId_6_J,
TBL_CAT6.szPriceOrderId  AS szCustCategoryPriceOrderId_6_J,	
TBL_CAT6.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_6_J,

TBL_CAT7.szCategoryId  AS szCustCategoryId_7_J,
TBL_CAT7.szPriceId  AS szCustCategoryPriceId_7_J,	
TBL_CAT7.szPromoPriceId  AS szCustCategoryPromoPriceId_7_J,
TBL_CAT7.szPriceOrderId  AS szCustCategoryPriceOrderId_7_J,	
TBL_CAT7.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_7_J,

TBL_CAT8.szCategoryId  AS szCustCategoryId_8_J,
TBL_CAT8.szPriceId  AS szCustCategoryPriceId_8_J,	
TBL_CAT8.szPromoPriceId  AS szCustCategoryPromoPriceId_8_J,
TBL_CAT8.szPriceOrderId  AS szCustCategoryPriceOrderId_8_J,	
TBL_CAT8.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_8_J,

TBL_CAT9.szCategoryId  AS szCustCategoryId_9_J,
TBL_CAT9.szPriceId  AS szCustCategoryPriceId_9_J,	
TBL_CAT9.szPromoPriceId  AS szCustCategoryPromoPriceId_9_J,
TBL_CAT9.szPriceOrderId  AS szCustCategoryPriceOrderId_9_J,	
TBL_CAT9.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_9_J,

TBL_CAT10.szCategoryId  AS szCustCategoryId_10_J,
TBL_CAT10.szPriceId  AS szCustCategoryPriceId_10_J,	
TBL_CAT10.szPromoPriceId  AS szCustCategoryPromoPriceId_10_J,
TBL_CAT10.szPriceOrderId  AS szCustCategoryPriceOrderId_10_J,	
TBL_CAT10.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_10_J,

CS_INV.szCustId AS szCustSalesOfInvCustId_J,

BOS_AR_Customer.szDistrChannelId AS szCustDistrChannelId_J,

BOS_AR_CustSales.bCheckMaxDropSize,
BOS_AR_CustSales.intMaxCountOpenInv,
BOS_AR_CustSales.bCheckMinDropSize,
BOS_AR_CustSales.dtmLastUpdated

FROM
BOS_AR_CustSales
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_AR_CustSales.szCustId
LEFT JOIN BOS_SD_InvoiceProcessing ON BOS_SD_InvoiceProcessing.szInvoiceProcessingId = BOS_AR_CustSales.szInvoiceProcessingId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_Customer.szDefaultCcyId
LEFT JOIN BOS_AR_Category AS TBL_CAT1 ON TBL_CAT1.szCategoryId = BOS_AR_Customer.szCategory_1
LEFT JOIN BOS_AR_Category AS TBL_CAT2 ON TBL_CAT2.szCategoryId = BOS_AR_Customer.szCategory_2
LEFT JOIN BOS_AR_Category AS TBL_CAT3 ON TBL_CAT3.szCategoryId = BOS_AR_Customer.szCategory_3
LEFT JOIN BOS_AR_Category AS TBL_CAT4 ON TBL_CAT4.szCategoryId = BOS_AR_Customer.szCategory_4
LEFT JOIN BOS_AR_Category AS TBL_CAT5 ON TBL_CAT5.szCategoryId = BOS_AR_Customer.szCategory_5
LEFT JOIN BOS_AR_Category AS TBL_CAT6 ON TBL_CAT6.szCategoryId = BOS_AR_Customer.szCategory_6
LEFT JOIN BOS_AR_Category AS TBL_CAT7 ON TBL_CAT7.szCategoryId = BOS_AR_Customer.szCategory_7
LEFT JOIN BOS_AR_Category AS TBL_CAT8 ON TBL_CAT8.szCategoryId = BOS_AR_Customer.szCategory_8
LEFT JOIN BOS_AR_Category AS TBL_CAT9 ON TBL_CAT9.szCategoryId = BOS_AR_Customer.szCategory_9
LEFT JOIN BOS_AR_Category AS TBL_CAT10 ON TBL_CAT10.szCategoryId = BOS_AR_Customer.szCategory_10
LEFT JOIN BOS_AR_CustSales CS_INV ON CS_INV.szCustId = BOS_AR_Customer.szInvoiceToCustId

WHERE 
BOS_AR_CustSales.szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustSales_GetCustSales_014(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_AR_Customer.szName as szCustNm_J,
BOS_AR_Customer.szDlvWorkplaceId AS szCustDlvWorkplaceId_J,

BOS_AR_CustSales.bAllowToCredit,
BOS_AR_CustSales.decCreditLimit,
BOS_AR_Customer.szDefaultCcyId AS szDefaultCcyId_J,
BOS_CU_Currency.szAmountFormat AS szDefaultCcyAmountFormat_J,
BOS_AR_CustSales.szPaymentTermId, 

BOS_AR_CustSales.szPriceId,
BOS_AR_CustSales.szPriceOrderId,

BOS_AR_CustSales.szInvoiceProcessingId,
BOS_SD_InvoiceProcessing.szDescription AS szInvoiceProcessingDescr_J,
BOS_SD_InvoiceProcessing.bImmediateInvoice AS bInvoiceProcessingImmediateInvoice_J,

BOS_AR_CustSales.bInvoiceNote,

BOS_AR_CustSales.szPromoPriceId,
BOS_AR_CustSales.szPromoPriceOrderId,

BOS_AR_CustSales.bNoVatApplied,

TBL_CAT1.szCategoryId  AS szCustCategoryId_1_J,
TBL_CAT1.szPriceId  AS szCustCategoryPriceId_1_J,    
TBL_CAT1.szPromoPriceId  AS szCustCategoryPromoPriceId_1_J,    
TBL_CAT1.szPriceOrderId  AS szCustCategoryPriceOrderId_1_J,    
TBL_CAT1.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_1_J,    

TBL_CAT2.szCategoryId  AS szCustCategoryId_2_J,
TBL_CAT2.szPriceId  AS szCustCategoryPriceId_2_J,    
TBL_CAT2.szPromoPriceId  AS szCustCategoryPromoPriceId_2_J,    
TBL_CAT2.szPriceOrderId  AS szCustCategoryPriceOrderId_2_J,    
TBL_CAT2.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_2_J,    

TBL_CAT3.szCategoryId  AS szCustCategoryId_3_J,
TBL_CAT3.szPriceId  AS szCustCategoryPriceId_3_J,    
TBL_CAT3.szPromoPriceId  AS szCustCategoryPromoPriceId_3_J,    
TBL_CAT3.szPriceOrderId  AS szCustCategoryPriceOrderId_3_J,    
TBL_CAT3.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_3_J,    

TBL_CAT4.szCategoryId  AS szCustCategoryId_4_J,
TBL_CAT4.szPriceId  AS szCustCategoryPriceId_4_J,    
TBL_CAT4.szPromoPriceId  AS szCustCategoryPromoPriceId_4_J,    
TBL_CAT4.szPriceOrderId  AS szCustCategoryPriceOrderId_4_J,    
TBL_CAT4.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_4_J,    

TBL_CAT5.szCategoryId  AS szCustCategoryId_5_J,
TBL_CAT5.szPriceId  AS szCustCategoryPriceId_5_J,    
TBL_CAT5.szPromoPriceId  AS szCustCategoryPromoPriceId_5_J,
TBL_CAT5.szPriceOrderId  AS szCustCategoryPriceOrderId_5_J,    
TBL_CAT5.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_5_J,

TBL_CAT6.szCategoryId  AS szCustCategoryId_6_J,
TBL_CAT6.szPriceId  AS szCustCategoryPriceId_6_J,    
TBL_CAT6.szPromoPriceId  AS szCustCategoryPromoPriceId_6_J,
TBL_CAT6.szPriceOrderId  AS szCustCategoryPriceOrderId_6_J,    
TBL_CAT6.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_6_J,

TBL_CAT7.szCategoryId  AS szCustCategoryId_7_J,
TBL_CAT7.szPriceId  AS szCustCategoryPriceId_7_J,    
TBL_CAT7.szPromoPriceId  AS szCustCategoryPromoPriceId_7_J,
TBL_CAT7.szPriceOrderId  AS szCustCategoryPriceOrderId_7_J,    
TBL_CAT7.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_7_J,

TBL_CAT8.szCategoryId  AS szCustCategoryId_8_J,
TBL_CAT8.szPriceId  AS szCustCategoryPriceId_8_J,    
TBL_CAT8.szPromoPriceId  AS szCustCategoryPromoPriceId_8_J,
TBL_CAT8.szPriceOrderId  AS szCustCategoryPriceOrderId_8_J,    
TBL_CAT8.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_8_J,

TBL_CAT9.szCategoryId  AS szCustCategoryId_9_J,
TBL_CAT9.szPriceId  AS szCustCategoryPriceId_9_J,    
TBL_CAT9.szPromoPriceId  AS szCustCategoryPromoPriceId_9_J,
TBL_CAT9.szPriceOrderId  AS szCustCategoryPriceOrderId_9_J,    
TBL_CAT9.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_9_J,

TBL_CAT10.szCategoryId  AS szCustCategoryId_10_J,
TBL_CAT10.szPriceId  AS szCustCategoryPriceId_10_J,    
TBL_CAT10.szPromoPriceId  AS szCustCategoryPromoPriceId_10_J,
TBL_CAT10.szPriceOrderId  AS szCustCategoryPriceOrderId_10_J,    
TBL_CAT10.szPromoPriceOrderId  AS szCustCategoryPromoPriceOrderId_10_J,

CS_INV.szCustId AS szCustSalesOfInvCustId_J,

BOS_AR_Customer.szDistrChannelId AS szCustDistrChannelId_J,

BOS_AR_CustSales.bCheckMaxDropSize,
BOS_AR_CustSales.intMaxCountOpenInv,
BOS_AR_CustSales.bCheckMinDropSize,
BOS_AR_CustSales.dtmLastUpdated

FROM
BOS_AR_CustSales
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_AR_CustSales.szCustId
LEFT JOIN BOS_SD_InvoiceProcessing ON BOS_SD_InvoiceProcessing.szInvoiceProcessingId = BOS_AR_CustSales.szInvoiceProcessingId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_Customer.szDefaultCcyId
LEFT JOIN BOS_AR_Category AS TBL_CAT1 ON TBL_CAT1.szCategoryId = BOS_AR_Customer.szCategory_1
LEFT JOIN BOS_AR_Category AS TBL_CAT2 ON TBL_CAT2.szCategoryId = BOS_AR_Customer.szCategory_2
LEFT JOIN BOS_AR_Category AS TBL_CAT3 ON TBL_CAT3.szCategoryId = BOS_AR_Customer.szCategory_3
LEFT JOIN BOS_AR_Category AS TBL_CAT4 ON TBL_CAT4.szCategoryId = BOS_AR_Customer.szCategory_4
LEFT JOIN BOS_AR_Category AS TBL_CAT5 ON TBL_CAT5.szCategoryId = BOS_AR_Customer.szCategory_5
LEFT JOIN BOS_AR_Category AS TBL_CAT6 ON TBL_CAT6.szCategoryId = BOS_AR_Customer.szCategory_6
LEFT JOIN BOS_AR_Category AS TBL_CAT7 ON TBL_CAT7.szCategoryId = BOS_AR_Customer.szCategory_7
LEFT JOIN BOS_AR_Category AS TBL_CAT8 ON TBL_CAT8.szCategoryId = BOS_AR_Customer.szCategory_8
LEFT JOIN BOS_AR_Category AS TBL_CAT9 ON TBL_CAT9.szCategoryId = BOS_AR_Customer.szCategory_9
LEFT JOIN BOS_AR_Category AS TBL_CAT10 ON TBL_CAT10.szCategoryId = BOS_AR_Customer.szCategory_10
LEFT JOIN BOS_AR_CustSales CS_INV ON CS_INV.szCustId = BOS_AR_Customer.szInvoiceToCustId

WHERE 
BOS_AR_CustSales.szCustId = p_szCustId;


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustSales_GetListOfCustSales()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId ,
szPaymentTermId

FROM 
BOS_AR_CustSales;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustSales_IsCustSalesExist(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
bAllowToCredit 

FROM 
BOS_AR_CustSales 
WHERE 
szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustSales_LockCustSales(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_CustSales
SET 
bInvoiceNote = bInvoiceNote
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustSales_UpdateCustSales(
p_szCustId BOS_DT_szId,
p_bAllowToCredit bit,
p_decCreditLimit BOS_DT_decAmount,
p_szPaymentTermId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szInvoiceProcessingId BOS_DT_szId,
p_bInvoiceNote bit,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_bNoVatApplied BOS_DT_bBoolean,
p_bCheckMaxDropSize BOS_DT_bBoolean,
p_intMaxCountOpenInv smallint,
p_bCheckMinDropSize BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_CustSales
SET 
szCustId = p_szCustId ,
bAllowToCredit = p_bAllowToCredit,
decCreditLimit = p_decCreditLimit,
szPaymentTermId = p_szPaymentTermId,
szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
szInvoiceProcessingId = p_szInvoiceProcessingId,
bInvoiceNote = p_bInvoiceNote,
szPromoPriceId = p_szPromoPriceId,
szPromoPriceOrderId = p_szPromoPriceOrderId,
bNoVatApplied = p_bNoVatApplied,

bCheckMaxDropSize = p_bCheckMaxDropSize,
intMaxCountOpenInv = p_intMaxCountOpenInv,
bCheckMinDropSize = p_bCheckMinDropSize
WHERE 
szCustId   = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_CustSales_UpdateCustSales_013(
p_szCustId BOS_DT_szId,
p_bAllowToCredit bit,
p_decCreditLimit BOS_DT_decAmount,
p_szPaymentTermId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szInvoiceProcessingId BOS_DT_szId,
p_bInvoiceNote bit,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_bNoVatApplied BOS_DT_bBoolean,
p_bCheckMaxDropSize BOS_DT_bBoolean,
p_intMaxCountOpenInv smallint,
p_bCheckMinDropSize BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_CustSales
SET 
szCustId = p_szCustId ,
bAllowToCredit = p_bAllowToCredit,
decCreditLimit = p_decCreditLimit,
szPaymentTermId = p_szPaymentTermId,
szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
szInvoiceProcessingId = p_szInvoiceProcessingId,
bInvoiceNote = p_bInvoiceNote,
szPromoPriceId = p_szPromoPriceId,
szPromoPriceOrderId = p_szPromoPriceOrderId,
bNoVatApplied = p_bNoVatApplied,

bCheckMaxDropSize = p_bCheckMaxDropSize,
intMaxCountOpenInv = p_intMaxCountOpenInv,
bCheckMinDropSize = p_bCheckMinDropSize
WHERE 
szCustId   = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_CreateFCustBasicInformation(
p_szFCustBIId BOS_DT_szId,
p_szFCallId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_dtmDoc timestamp,
p_bNewCustomer bit,
p_szCustNm BOS_DT_szName,
p_szDistrChannelId BOS_DT_szId,
p_szCategoryId1 BOS_DT_szId,
p_szCategoryId2 BOS_DT_szId,
p_szCategoryId3 BOS_DT_szId,
p_szCategoryId4 BOS_DT_szId,
p_szCategoryId5 BOS_DT_szId,
p_szCategoryId6 BOS_DT_szId,
p_szCategoryId7 BOS_DT_szId,
p_szCategoryId8 BOS_DT_szId,
p_szCategoryId9 BOS_DT_szId,
p_szCategoryId10 BOS_DT_szId,
p_CustszContactPerson BOS_DT_szName,
p_CustszRoomNo BOS_DT_szSmallName,
p_CustszFloor BOS_DT_szSmallName,
p_CustszBuilding BOS_DT_szName,
p_CustszAddress_1 BOS_DT_szBigDescription,
p_CustszAddress_2 BOS_DT_szBigDescription,
p_CustszDistrict BOS_DT_szMediumName,
p_CustszCity BOS_DT_szMediumName,
p_CustszZipCode BOS_DT_szSmallName,
p_CustszState BOS_DT_szMediumName,
p_CustszCountry BOS_DT_szMediumName,
p_CustszPhoneNo_1 BOS_DT_szMediumName,
p_CustszPhoneNo_2 BOS_DT_szMediumName,
p_CustszFaxNo BOS_DT_szMediumName,
p_CustszMobileNo BOS_DT_szMediumName,
p_CustszEmail BOS_DT_szMediumName,
p_CustszWebSite BOS_DT_szMediumName,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_bSoldToCust bit,
p_bDeliverToCust bit,
p_bInvoiceToCust bit,
p_bCollectToCust bit,
p_szSoldToCustId BOS_DT_szId,
p_szDeliverToCustId BOS_DT_szId,
p_szInvoiceToCustId BOS_DT_szId,
p_szCollectToCustId BOS_DT_szId,
p_szRemark BOS_DT_szDescription,
p_bJoinInvoice bit,
p_bDelCust bit,
p_szStatus varchar,
p_szReasonId BOS_DT_szId,
p_szSalWorkplaceId BOS_DT_szId,
p_szDefaultCcyId BOS_DT_szSmallId,
p_szFCustChgSalesCfgId BOS_DT_szId,
p_szStartDoc varchar,
p_dtmStart timestamp,
p_szContractDoc varchar,
p_dtmContract timestamp,
p_szRenewalDoc varchar,
p_dtmRenewal timestamp,
p_szStopDoc varchar,
p_dtmStop timestamp,
p_szSalesId BOS_DT_szId,
p_bICP bit,
p_bCheckMaxDropSize BOS_DT_bBoolean,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_bNeedInvoiceChange BOS_DT_bBoolean,
p_bInvoiceChangeWithReceipt BOS_DT_bBoolean,
p_bHasSpecialCollectionDay BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Sunday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Monday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Tuesday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Wednesday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Thursday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Friday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Saturday BOS_DT_bBoolean,
p_bPaymentType_Cash BOS_DT_bBoolean,
p_bPaymentType_CurrentAccount BOS_DT_bBoolean,
p_bPaymentType_Transfer BOS_DT_bBoolean,
p_bRequiredDocuments_PO BOS_DT_bBoolean,
p_bRequiredDocuments_Receipt BOS_DT_bBoolean,
p_bRequiredDocuments_StandardTaxInvoice BOS_DT_bBoolean,
p_bRequiredDocuments_Materai BOS_DT_bBoolean,
p_bRequiredDocuments_ReceiptNote BOS_DT_bBoolean,
p_bRequiredDocuments_Other BOS_DT_bBoolean,
p_szRequiredDocuments_Other BOS_DT_szBigDescription,
p_szGuarantee BOS_DT_szBigDescription,
p_bCheckMinDropSize BOS_DT_bBoolean,
p_szDeliveryGroupId BOS_DT_szId,
p_szBarcodeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustBasicInformation
(
szFCustBIId,
szFCallId,
szCustId,
szSalesOrgId,
dtmDoc,
bNewCustomer,
szCustNm,
szDistrChannelId,
---- Customer Category.,
szCategory_1,
szCategory_2,
szCategory_3,
szCategory_4,
szCategory_5,
szCategory_6,
szCategory_7,
szCategory_8,
szCategory_9,
szCategory_10,
--- Basic Addresss.,
CustszContactPerson,
CustszRoomNo,
CustszFloor,
CustszBuilding,
CustszAddress_1,
CustszAddress_2,
CustszDistrict,
CustszCity,
CustszZipCode,
CustszState,
CustszCountry,
CustszPhoneNo_1,
CustszPhoneNo_2,
CustszFaxNo,
CustszMobileNo,
CustszEmail,
CustszWebSite,
szLatitude,
szLongitude,
bSoldToCust,
bDeliverToCust,
bInvoiceToCust,
bCollectToCust,
szSoldToCustId,
szDeliverToCustId,
szInvoiceToCustId,
szCollectToCustId,
szRemark,
bJoinInvoice,
bDelCust,
szStatus,
szReasonId,
szSalWorkplaceId,
szDefaultCcyId,
szFCustChgSalesCfgId,
---- Closing Info.,
szStartDoc ,
dtmStart ,
szContractDoc ,
dtmContract ,
szRenewalDoc ,
dtmRenewal ,
szStopDoc ,
dtmStop ,
szSalesId ,
bICP ,
bCheckMaxDropSize,
--- Doc Status.,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkPlaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated ,
bSystemCreated,
-- Data Status.,
dtmLastUpdated ,
bAlreadyTransferred,
szUserId,
-- Customer Validation,
bNeedInvoiceChange,
bInvoiceChangeWithReceipt,
bHasSpecialCollectionDay,
bHasSpecialCollectionDay_Sunday,
bHasSpecialCollectionDay_Monday,
bHasSpecialCollectionDay_Tuesday,
bHasSpecialCollectionDay_Wednesday,
bHasSpecialCollectionDay_Thursday,
bHasSpecialCollectionDay_Friday,
bHasSpecialCollectionDay_Saturday,
bPaymentType_Cash,
bPaymentType_CurrentAccount,
bPaymentType_Transfer,
bRequiredDocuments_PO,
bRequiredDocuments_Receipt,
bRequiredDocuments_StandardTaxInvoice,
bRequiredDocuments_Materai,
bRequiredDocuments_ReceiptNote,
bRequiredDocuments_Other,
szRequiredDocuments_Other,
szGuarantee,
bCheckMinDropSize,
szDeliveryGroupId,
szBarcodeId
)
VALUES
(
p_szFCustBIId,
p_szFCallId,
p_szCustId,
p_szSalesOrgId,
p_dtmDoc,
p_bNewCustomer,
p_szCustNm,
p_szDistrChannelId,
---- Customer Category.,
p_szCategoryId1,
p_szCategoryId2,
p_szCategoryId3,
p_szCategoryId4,
p_szCategoryId5,
p_szCategoryId6,
p_szCategoryId7,
p_szCategoryId8,
p_szCategoryId9,
p_szCategoryId10,
--- Basic Address.,
p_CustszContactPerson,
p_CustszRoomNo,
p_CustszFloor,
p_CustszBuilding,
p_CustszAddress_1,
p_CustszAddress_2,
p_CustszDistrict,
p_CustszCity,
p_CustszZipCode,
p_CustszState,
p_CustszCountry,
p_CustszPhoneNo_1,
p_CustszPhoneNo_2,
p_CustszFaxNo,
p_CustszMobileNo,
p_CustszEmail,
p_CustszWebSite,
p_szLatitude,
p_szLongitude,
p_bSoldToCust,
p_bDeliverToCust,
p_bInvoiceToCust,
p_bCollectToCust,
p_szSoldToCustId,
p_szDeliverToCustId,
p_szInvoiceToCustId,
p_szCollectToCustId,
p_szRemark,
p_bJoinInvoice,
p_bDelCust,
p_szStatus,
p_szReasonId,
p_szSalWorkplaceId,
p_szDefaultCcyId,
p_szFCustChgSalesCfgId,
---- Closing Info.,
p_szStartDoc ,
p_dtmStart ,
p_szContractDoc ,
p_dtmContract ,
p_szRenewalDoc ,
p_dtmRenewal ,
p_szStopDoc ,
p_dtmStop ,
p_szSalesId ,
p_bICP ,
p_bCheckMaxDropSize,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkPlaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated ,
p_bSystemCreated,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szUserId,
-- Customer Validation,
p_bNeedInvoiceChange,
p_bInvoiceChangeWithReceipt,
p_bHasSpecialCollectionDay,
p_bHasSpecialCollectionDay_Sunday,
p_bHasSpecialCollectionDay_Monday,
p_bHasSpecialCollectionDay_Tuesday,
p_bHasSpecialCollectionDay_Wednesday,
p_bHasSpecialCollectionDay_Thursday,
p_bHasSpecialCollectionDay_Friday,
p_bHasSpecialCollectionDay_Saturday,
p_bPaymentType_Cash,
p_bPaymentType_CurrentAccount,
p_bPaymentType_Transfer,
p_bRequiredDocuments_PO,
p_bRequiredDocuments_Receipt,
p_bRequiredDocuments_StandardTaxInvoice,
p_bRequiredDocuments_Materai,
p_bRequiredDocuments_ReceiptNote,
p_bRequiredDocuments_Other,
p_szRequiredDocuments_Other,
p_szGuarantee,
p_bCheckMinDropSize,
p_szDeliveryGroupId,
p_szBarcodeId
--SET ANSI_NULLS ON,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_CreateFCustBasicInformation_013(
p_szFCustBIId BOS_DT_szId,
p_szFCallId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_dtmDoc timestamp,
p_bNewCustomer bit,
p_szCustNm BOS_DT_szName,
p_szDistrChannelId BOS_DT_szId,
p_szCategoryId1 BOS_DT_szId,
p_szCategoryId2 BOS_DT_szId,
p_szCategoryId3 BOS_DT_szId,
p_szCategoryId4 BOS_DT_szId,
p_szCategoryId5 BOS_DT_szId,
p_szCategoryId6 BOS_DT_szId,
p_szCategoryId7 BOS_DT_szId,
p_szCategoryId8 BOS_DT_szId,
p_szCategoryId9 BOS_DT_szId,
p_szCategoryId10 BOS_DT_szId,
p_CustszContactPerson BOS_DT_szName,
p_CustszRoomNo BOS_DT_szSmallName,
p_CustszFloor BOS_DT_szSmallName,
p_CustszBuilding BOS_DT_szName,
p_CustszAddress_1 BOS_DT_szBigDescription,
p_CustszAddress_2 BOS_DT_szBigDescription,
p_CustszDistrict BOS_DT_szName,
p_CustszCity BOS_DT_szMediumName,
p_CustszZipCode BOS_DT_szSmallName,
p_CustszState BOS_DT_szMediumName,
p_CustszCountry BOS_DT_szMediumName,
p_CustszPhoneNo_1 BOS_DT_szMediumName,
p_CustszPhoneNo_2 BOS_DT_szMediumName,
p_CustszFaxNo BOS_DT_szMediumName,
p_CustszMobileNo BOS_DT_szMediumName,
p_CustszEmail BOS_DT_szMediumName,
p_CustszWebSite BOS_DT_szMediumName,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_bSoldToCust bit,
p_bDeliverToCust bit,
p_bInvoiceToCust bit,
p_bCollectToCust bit,
p_szSoldToCustId BOS_DT_szId,
p_szDeliverToCustId BOS_DT_szId,
p_szInvoiceToCustId BOS_DT_szId,
p_szCollectToCustId BOS_DT_szId,
p_szRemark BOS_DT_szDescription,
p_bJoinInvoice bit,
p_bDelCust bit,
p_szStatus varchar,
p_szReasonId BOS_DT_szId,
p_szSalWorkplaceId BOS_DT_szId,
p_szDefaultCcyId BOS_DT_szSmallId,
p_szFCustChgSalesCfgId BOS_DT_szId,
p_szStartDoc varchar,
p_dtmStart timestamp,
p_szContractDoc varchar,
p_dtmContract timestamp,
p_szRenewalDoc varchar,
p_dtmRenewal timestamp,
p_szStopDoc varchar,
p_dtmStop timestamp,
p_szSalesId BOS_DT_szId,
p_bICP bit,
p_bCheckMaxDropSize BOS_DT_bBoolean,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_bNeedInvoiceChange BOS_DT_bBoolean,
p_bInvoiceChangeWithReceipt BOS_DT_bBoolean,
p_bHasSpecialCollectionDay BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Sunday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Monday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Tuesday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Wednesday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Thursday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Friday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Saturday BOS_DT_bBoolean,
p_bPaymentType_Cash BOS_DT_bBoolean,
p_bPaymentType_CurrentAccount BOS_DT_bBoolean,
p_bPaymentType_Transfer BOS_DT_bBoolean,
p_bRequiredDocuments_PO BOS_DT_bBoolean,
p_bRequiredDocuments_Receipt BOS_DT_bBoolean,
p_bRequiredDocuments_StandardTaxInvoice BOS_DT_bBoolean,
p_bRequiredDocuments_Materai BOS_DT_bBoolean,
p_bRequiredDocuments_ReceiptNote BOS_DT_bBoolean,
p_bRequiredDocuments_Other BOS_DT_bBoolean,
p_szRequiredDocuments_Other BOS_DT_szBigDescription,
p_szGuarantee BOS_DT_szBigDescription,
p_bCheckMinDropSize BOS_DT_bBoolean,
p_szDeliveryGroupId BOS_DT_szId,
p_szBarcodeId BOS_DT_szId,
p_szActivityStatus BOS_DT_szId,
p_dtmLastChangeActivityStatus timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustBasicInformation
(
szFCustBIId,
szFCallId,
szCustId,
szSalesOrgId,
dtmDoc,
bNewCustomer,
szCustNm,
szDistrChannelId,
---- Customer Category.,
szCategory_1,
szCategory_2,
szCategory_3,
szCategory_4,
szCategory_5,
szCategory_6,
szCategory_7,
szCategory_8,
szCategory_9,
szCategory_10,
--- Basic Addresss.,
CustszContactPerson,
CustszRoomNo,
CustszFloor,
CustszBuilding,
CustszAddress_1,
CustszAddress_2,
CustszDistrict,
CustszCity,
CustszZipCode,
CustszState,
CustszCountry,
CustszPhoneNo_1,
CustszPhoneNo_2,
CustszFaxNo,
CustszMobileNo,
CustszEmail,
CustszWebSite,
szLatitude,
szLongitude,
bSoldToCust,
bDeliverToCust,
bInvoiceToCust,
bCollectToCust,
szSoldToCustId,
szDeliverToCustId,
szInvoiceToCustId,
szCollectToCustId,
szRemark,
bJoinInvoice,
bDelCust,
szStatus,
szReasonId,
szActivityStatus,
dtmLastChangeActivityStatus,
szSalWorkplaceId,
szDefaultCcyId,
szFCustChgSalesCfgId,
---- Closing Info.,
szStartDoc ,
dtmStart ,
szContractDoc ,
dtmContract ,
szRenewalDoc ,
dtmRenewal ,
szStopDoc ,
dtmStop ,
szSalesId ,
bICP ,
bCheckMaxDropSize,
--- Doc Status.,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkPlaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated ,
bSystemCreated,
-- Data Status.,
dtmLastUpdated ,
bAlreadyTransferred,
szUserId,
-- Customer Validation,
bNeedInvoiceChange,
bInvoiceChangeWithReceipt,
bHasSpecialCollectionDay,
bHasSpecialCollectionDay_Sunday,
bHasSpecialCollectionDay_Monday,
bHasSpecialCollectionDay_Tuesday,
bHasSpecialCollectionDay_Wednesday,
bHasSpecialCollectionDay_Thursday,
bHasSpecialCollectionDay_Friday,
bHasSpecialCollectionDay_Saturday,
bPaymentType_Cash,
bPaymentType_CurrentAccount,
bPaymentType_Transfer,
bRequiredDocuments_PO,
bRequiredDocuments_Receipt,
bRequiredDocuments_StandardTaxInvoice,
bRequiredDocuments_Materai,
bRequiredDocuments_ReceiptNote,
bRequiredDocuments_Other,
szRequiredDocuments_Other,
szGuarantee,
bCheckMinDropSize,
szDeliveryGroupId,
szBarcodeId
)
VALUES
(
p_szFCustBIId,
p_szFCallId,
p_szCustId,
p_szSalesOrgId,
p_dtmDoc,
p_bNewCustomer,
p_szCustNm,
p_szDistrChannelId,
---- Customer Category.,
p_szCategoryId1,
p_szCategoryId2,
p_szCategoryId3,
p_szCategoryId4,
p_szCategoryId5,
p_szCategoryId6,
p_szCategoryId7,
p_szCategoryId8,
p_szCategoryId9,
p_szCategoryId10,
--- Basic Address.,
p_CustszContactPerson,
p_CustszRoomNo,
p_CustszFloor,
p_CustszBuilding,
p_CustszAddress_1,
p_CustszAddress_2,
p_CustszDistrict,
p_CustszCity,
p_CustszZipCode,
p_CustszState,
p_CustszCountry,
p_CustszPhoneNo_1,
p_CustszPhoneNo_2,
p_CustszFaxNo,
p_CustszMobileNo,
p_CustszEmail,
p_CustszWebSite,
p_szLatitude,
p_szLongitude,
p_bSoldToCust,
p_bDeliverToCust,
p_bInvoiceToCust,
p_bCollectToCust,
p_szSoldToCustId,
p_szDeliverToCustId,
p_szInvoiceToCustId,
p_szCollectToCustId,
p_szRemark,
p_bJoinInvoice,
p_bDelCust,
p_szStatus,
p_szReasonId,
p_szActivityStatus,
p_dtmLastChangeActivityStatus,
p_szSalWorkplaceId,
p_szDefaultCcyId,
p_szFCustChgSalesCfgId,
---- Closing Info.,
p_szStartDoc ,
p_dtmStart ,
p_szContractDoc ,
p_dtmContract ,
p_szRenewalDoc ,
p_dtmRenewal ,
p_szStopDoc ,
p_dtmStop ,
p_szSalesId ,
p_bICP ,
p_bCheckMaxDropSize,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkPlaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated ,
p_bSystemCreated,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szUserId,
-- Customer Validation,
p_bNeedInvoiceChange,
p_bInvoiceChangeWithReceipt,
p_bHasSpecialCollectionDay,
p_bHasSpecialCollectionDay_Sunday,
p_bHasSpecialCollectionDay_Monday,
p_bHasSpecialCollectionDay_Tuesday,
p_bHasSpecialCollectionDay_Wednesday,
p_bHasSpecialCollectionDay_Thursday,
p_bHasSpecialCollectionDay_Friday,
p_bHasSpecialCollectionDay_Saturday,
p_bPaymentType_Cash,
p_bPaymentType_CurrentAccount,
p_bPaymentType_Transfer,
p_bRequiredDocuments_PO,
p_bRequiredDocuments_Receipt,
p_bRequiredDocuments_StandardTaxInvoice,
p_bRequiredDocuments_Materai,
p_bRequiredDocuments_ReceiptNote,
p_bRequiredDocuments_Other,
p_szRequiredDocuments_Other,
p_szGuarantee,
p_bCheckMinDropSize,
p_szDeliveryGroupId,
p_szBarcodeId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_CreateFCustBasicInformationArItem(
p_szFCustBIId BOS_DT_szId,
p_shItemNumber smallint,
p_szCcyId BOS_DT_szSmallId,
p_decValue BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustBasicInformationArItem
(
	szFCustBIId,
	shItemNumber,
	szCcyId,
	decValue
)
VALUES
(
p_szFCustBIId,
p_shItemNumber,
p_szCcyId,
p_decValue
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_CreateFCustBasicInformationDjrItem(
p_szFCustBIId BOS_DT_szId,
p_shItemNumber smallint,
p_szDjrTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustBasicInformationDjrTrackingItem
(
	szFCustBIId,
	shItemNumber,
	szDjrTrackingId
)
VALUES
(
p_szFCustBIId,
p_shItemNumber,
p_szDjrTrackingId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_CreateFCustBasicInformationDoItem(
p_szFCustBIId BOS_DT_szId,
p_shItemNumber smallint,
p_szFDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustBasicInformationDoItem
(
	szFCustBIId,
	shItemNumber,
	szFDoId
)
VALUES
(
p_szFCustBIId,
p_shItemNumber,
p_szFDoId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_CreateFCustBasicInformationDoItem_013(
p_szFCustBIId BOS_DT_szId,
p_shItemNumber smallint,
p_szFDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustBasicInformationDoItem
(
	szFCustBIId,
	shItemNumber,
	szFDoId
)
VALUES
(
p_szFCustBIId,
p_shItemNumber,
p_szFDoId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_CreateFCustBasicInformationProductItem(
p_szFCustBIId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szRefProductId BOS_DT_szId,
p_szRefProductName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustBasicInformationProductItem
(
szFCustBIId,
szProductId,
szRefProductId,
szRefProductName
)
VALUES
(
p_szFCustBIId,
p_szProductId,
p_szRefProductId,
p_szRefProductName
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_CreateFCustBasicInformationStockItem(
p_szFCustBIId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szStockTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustBasicInformationStockItem
(
	szFCustBIId,
	shItemNumber,
	szProductId,
	decQty,
	szStockTypeId
)
VALUES
(
p_szFCustBIId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szStockTypeId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_DeleteFCustBasicInformation(
p_szFCustBIId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_AR_FCustBasicInformation
WHERE
szFCustBIId = p_szFCustBIId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_DeleteFCustBasicInformationProductItem(
p_szFCustBIId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_AR_FCustBasicInformationProductItem
WHERE
 szFCustBIId = p_szFCustBIId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_GetFCustBasicInformation(
p_szFCustBIId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_AR_FCustBasicInformation.szFCallId,  
BOS_AR_FCustBasicInformation.szSalesOrgId,  
BOS_AR_FCustBasicInformation.szCustId,  
BOS_AR_FCustBasicInformation.dtmDoc,  
BOS_AR_FCustBasicInformation.bNewCustomer,  
BOS_AR_FCustBasicInformation.szCustNm,  
BOS_AR_FCustBasicInformation.szDistrChannelId,  
---- Customer Category.  
BOS_AR_FCustBasicInformation.szCategory_1,  
BOS_AR_FCustBasicInformation.szCategory_2,  
BOS_AR_FCustBasicInformation.szCategory_3,  
BOS_AR_FCustBasicInformation.szCategory_4,  
BOS_AR_FCustBasicInformation.szCategory_5,  
BOS_AR_FCustBasicInformation.szCategory_6,  
BOS_AR_FCustBasicInformation.szCategory_7,  
BOS_AR_FCustBasicInformation.szCategory_8,  
BOS_AR_FCustBasicInformation.szCategory_9,  
BOS_AR_FCustBasicInformation.szCategory_10,  
---- Basic Address.  
BOS_AR_FCustBasicInformation.CustszContactPerson,  
BOS_AR_FCustBasicInformation.CustszRoomNo,  
BOS_AR_FCustBasicInformation.CustszFloor,  
BOS_AR_FCustBasicInformation.CustszBuilding,  
BOS_AR_FCustBasicInformation.CustszAddress_1,  
BOS_AR_FCustBasicInformation.CustszAddress_2,  
BOS_AR_FCustBasicInformation.CustszDistrict,  
BOS_AR_FCustBasicInformation.CustszCity,  
BOS_AR_FCustBasicInformation.CustszZipCode,  
BOS_AR_FCustBasicInformation.CustszState,  
BOS_AR_FCustBasicInformation.CustszCountry,  
BOS_AR_FCustBasicInformation.CustszPhoneNo_1,  
BOS_AR_FCustBasicInformation.CustszPhoneNo_2,  
BOS_AR_FCustBasicInformation.CustszFaxNo,  
BOS_AR_FCustBasicInformation.CustszMobileNo,  
BOS_AR_FCustBasicInformation.CustszEmail,  
BOS_AR_FCustBasicInformation.CustszWebSite,  

--GPS address.  
BOS_AR_FCustBasicInformation.szLatitude,  
BOS_AR_FCustBasicInformation.szLongitude,  

BOS_AR_FCustBasicInformation.bSoldToCust,  
BOS_AR_FCustBasicInformation.bDeliverToCust,  
BOS_AR_FCustBasicInformation.bInvoiceToCust,  
BOS_AR_FCustBasicInformation.bCollectToCust,  
BOS_AR_FCustBasicInformation.szSoldToCustId,  
SOLD_TO.szName as szSoldToCustNm,  
BOS_AR_FCustBasicInformation.szDeliverToCustId,  
DLV_TO.szName as szDeliverToCustNm,  
BOS_AR_FCustBasicInformation.szInvoiceToCustId,  
INV_TO.szName as szInvoiceToCustNm,  
BOS_AR_FCustBasicInformation.szCollectToCustId,  
COLL_TO.szName as szCollectToCustNm,  
BOS_AR_FCustBasicInformation.szRemark,  
BOS_AR_FCustBasicInformation.bJoinInvoice,   
BOS_AR_FCustBasicInformation.bDelCust,  
BOS_AR_FCustBasicInformation.szStatus,  
BOS_AR_FCustBasicInformation.szReasonId,  

BOS_AR_FCustBasicInformation.szSalWorkplaceId,  
BOS_AR_FCustBasicInformation.szDefaultCcyId,  
BOS_CU_Currency.szAmountFormat AS szDefaultCcyAmountFormat_J,  
BOS_AR_FCustBasicInformation.szFCustChgSalesCfgId,  
---- Closing Info.  
BOS_AR_FCustBasicInformation.szStartDoc ,  
BOS_AR_FCustBasicInformation.dtmStart ,  
BOS_AR_FCustBasicInformation.szContractDoc ,  
BOS_AR_FCustBasicInformation.dtmContract ,  
BOS_AR_FCustBasicInformation.szRenewalDoc ,  
BOS_AR_FCustBasicInformation.dtmRenewal ,  
BOS_AR_FCustBasicInformation.szStopDoc ,  
BOS_AR_FCustBasicInformation.dtmStop ,  
BOS_AR_FCustBasicInformation.szSalesId ,  
BOS_PI_Employee.szName as szSalesNm,  
BOS_AR_FCustBasicInformation.bICP ,  

BOS_AR_FCustBasicInformation.bCheckMaxDropSize,  

----  Document Status.  
BOS_AR_FCustBasicInformation.bResultFrTransfer,  
BOS_AR_FCustBasicInformation.bVoid,  
BOS_GEN_Approved.bApproved,  
BOS_AR_FCustBasicInformation.bApplied,  
BOS_GL_FJournalTrans.szFJournalId as bJournal,  
BOS_GL_FJournalTrans.bPosted,  
BOS_AR_FCustBasicInformation.btPrintedCount,  
BOS_AR_FCustBasicInformation.bTransferred,  
BOS_AR_FCustBasicInformation.szCompanyId,  
BOS_AR_FCustBasicInformation.szWorkPlaceId,  
BOS_AR_FCustBasicInformation.szTaxEntityId,  

BOS_AR_FCustBasicInformation.bNeedApproval,   
BOS_GEN_Approved.gdApprovedId,  
BOS_GEN_Approved.szApprovalId,  
BOS_GL_FJournalTrans.szFJournalId,  
BOS_AR_FCustBasicInformation.dtmCreated,   
BOS_AR_FCustBasicInformation.bSystemCreated,  

BOS_GL_Company.szName as szCompanyNm ,  
BOS_GL_Workplace.szName as szWorkplaceNm,  

BOS_AR_FCustBasicInformation.dtmLastUpdated,  
BOS_AR_FCustBasicInformation.bAlreadyTransferred,  
BOS_AR_FCustBasicInformation.szUserId,  
BOS_SM_User.szName as szUserNm_J,  
-- Customer Validation  
BOS_AR_FCustBasicInformation.bNeedInvoiceChange,  
BOS_AR_FCustBasicInformation.bInvoiceChangeWithReceipt,  
BOS_AR_FCustBasicInformation.bHasSpecialCollectionDay,  
BOS_AR_FCustBasicInformation.bHasSpecialCollectionDay_Sunday,  
BOS_AR_FCustBasicInformation.bHasSpecialCollectionDay_Monday,  
BOS_AR_FCustBasicInformation.bHasSpecialCollectionDay_Tuesday,  
BOS_AR_FCustBasicInformation.bHasSpecialCollectionDay_Wednesday,  
BOS_AR_FCustBasicInformation.bHasSpecialCollectionDay_Thursday,  
BOS_AR_FCustBasicInformation.bHasSpecialCollectionDay_Friday,  
BOS_AR_FCustBasicInformation.bHasSpecialCollectionDay_Saturday,   
BOS_AR_FCustBasicInformation.bPaymentType_Cash,  
BOS_AR_FCustBasicInformation.bPaymentType_CurrentAccount,  
BOS_AR_FCustBasicInformation.bPaymentType_Transfer,  
BOS_AR_FCustBasicInformation.bRequiredDocuments_PO,  
BOS_AR_FCustBasicInformation.bRequiredDocuments_Receipt,  
BOS_AR_FCustBasicInformation.bRequiredDocuments_StandardTaxInvoice,  
BOS_AR_FCustBasicInformation.bRequiredDocuments_Materai,  
BOS_AR_FCustBasicInformation.bRequiredDocuments_ReceiptNote,  
BOS_AR_FCustBasicInformation.bRequiredDocuments_Other,  
BOS_AR_FCustBasicInformation.szRequiredDocuments_Other,  
BOS_AR_FCustBasicInformation.szGuarantee,  
BOS_AR_FCustBasicInformation.bCheckMinDropSize,
BOS_AR_FCustBasicInformation.szDeliveryGroupId,
ISNULL(DeliveryGroup.szDesc, '') AS szDeliveryGroupDesc_J,
BOS_AR_FCustBasicInformation.szBarcodeId  
FROM  
BOS_AR_FCustBasicInformation  
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustBasicInformation.szDefaultCcyId  
LEFT JOIN BOS_GEN_Approved on BOS_AR_FCustBasicInformation.gdApprovedId = BOS_GEN_Approved.gdApprovedId  
LEFT JOIN BOS_GL_FJournalTrans ON BOS_AR_FCustBasicInformation.szFJournalId = BOS_GL_FJournalTrans.szFJournalId  
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustBasicInformation.szSalesId  
LEFT JOIN BOS_AR_Customer AS SOLD_TO ON SOLD_TO.szCustId = BOS_AR_FCustBasicInformation.szSoldToCustId  
LEFT JOIN BOS_AR_Customer AS DLV_TO ON DLV_TO.szCustId = BOS_AR_FCustBasicInformation.szDeliverToCustId  
LEFT JOIN BOS_AR_Customer AS INV_TO ON INV_TO.szCustId = BOS_AR_FCustBasicInformation.szInvoiceToCustId  
LEFT JOIN BOS_AR_Customer AS COLL_TO ON COLL_TO.szCustId = BOS_AR_FCustBasicInformation.szCollectToCustId  

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkPlaceId = BOS_AR_FCustBasicInformation.szWorkPlaceId  
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId= BOS_AR_FCustBasicInformation.szCompanyId  
LEFT JOIN BOS_SD_DeliveryGroup AS DeliveryGroup ON DeliveryGroup.szWorkplaceId = DLV_TO.szDlvWorkplaceId AND DeliveryGroup.szDeliveryGroupId = BOS_AR_FCustBasicInformation.szDeliveryGroupId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_AR_FCustBasicInformation.szUserId 

WHERE  
szFCustBIId = p_szFCustBIId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_GetFCustBasicInformation_013(
p_szFCustBIId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_AR_FCustBasicInformation.szFCallId,  
BOS_AR_FCustBasicInformation.szSalesOrgId,  
BOS_AR_FCustBasicInformation.szCustId,  
BOS_AR_FCustBasicInformation.dtmDoc,  
BOS_AR_FCustBasicInformation.bNewCustomer,  
BOS_AR_FCustBasicInformation.szCustNm,  
BOS_AR_FCustBasicInformation.szDistrChannelId,  
---- Customer Category.  
BOS_AR_FCustBasicInformation.szCategory_1,  
BOS_AR_FCustBasicInformation.szCategory_2,  
BOS_AR_FCustBasicInformation.szCategory_3,  
BOS_AR_FCustBasicInformation.szCategory_4,  
BOS_AR_FCustBasicInformation.szCategory_5,  
BOS_AR_FCustBasicInformation.szCategory_6,  
BOS_AR_FCustBasicInformation.szCategory_7,  
BOS_AR_FCustBasicInformation.szCategory_8,  
BOS_AR_FCustBasicInformation.szCategory_9,  
BOS_AR_FCustBasicInformation.szCategory_10,  

---- Basic Address.  
BOS_AR_FCustBasicInformation.CustszContactPerson,  
BOS_AR_FCustBasicInformation.CustszRoomNo,  
BOS_AR_FCustBasicInformation.CustszFloor,  
BOS_AR_FCustBasicInformation.CustszBuilding,  
BOS_AR_FCustBasicInformation.CustszAddress_1,  
BOS_AR_FCustBasicInformation.CustszAddress_2,  
BOS_AR_FCustBasicInformation.CustszDistrict,  
BOS_AR_FCustBasicInformation.CustszCity,  
BOS_AR_FCustBasicInformation.CustszZipCode,  
BOS_AR_FCustBasicInformation.CustszState,  
BOS_AR_FCustBasicInformation.CustszCountry,  
BOS_AR_FCustBasicInformation.CustszPhoneNo_1,  
BOS_AR_FCustBasicInformation.CustszPhoneNo_2,  
BOS_AR_FCustBasicInformation.CustszFaxNo,  
BOS_AR_FCustBasicInformation.CustszMobileNo,  
BOS_AR_FCustBasicInformation.CustszEmail,  
BOS_AR_FCustBasicInformation.CustszWebSite,  

--GPS address.  
BOS_AR_FCustBasicInformation.szLatitude,  
BOS_AR_FCustBasicInformation.szLongitude,  

BOS_AR_FCustBasicInformation.bSoldToCust,  
BOS_AR_FCustBasicInformation.bDeliverToCust,  
BOS_AR_FCustBasicInformation.bInvoiceToCust,  
BOS_AR_FCustBasicInformation.bCollectToCust,  
BOS_AR_FCustBasicInformation.szSoldToCustId,  
SOLD_TO.szName as szSoldToCustNm,  
BOS_AR_FCustBasicInformation.szDeliverToCustId,  
DLV_TO.szName as szDeliverToCustNm,  
BOS_AR_FCustBasicInformation.szInvoiceToCustId,  
INV_TO.szName as szInvoiceToCustNm,  
BOS_AR_FCustBasicInformation.szCollectToCustId,  
COLL_TO.szName as szCollectToCustNm,  
BOS_AR_FCustBasicInformation.szRemark,  
BOS_AR_FCustBasicInformation.bJoinInvoice,   
BOS_AR_FCustBasicInformation.bDelCust,  
BOS_AR_FCustBasicInformation.szStatus,  
BOS_AR_FCustBasicInformation.szReasonId,  

BOS_AR_FCustBasicInformation.szSalWorkplaceId,  
BOS_AR_FCustBasicInformation.szDefaultCcyId,  
BOS_CU_Currency.szAmountFormat AS szDefaultCcyAmountFormat_J,  
BOS_AR_FCustBasicInformation.szFCustChgSalesCfgId,  
---- Closing Info.  
BOS_AR_FCustBasicInformation.szStartDoc ,  
BOS_AR_FCustBasicInformation.dtmStart ,  
BOS_AR_FCustBasicInformation.szContractDoc ,  
BOS_AR_FCustBasicInformation.dtmContract ,  
BOS_AR_FCustBasicInformation.szRenewalDoc ,  
BOS_AR_FCustBasicInformation.dtmRenewal ,  
BOS_AR_FCustBasicInformation.szStopDoc ,  
BOS_AR_FCustBasicInformation.dtmStop ,  
BOS_AR_FCustBasicInformation.szSalesId ,  
BOS_PI_Employee.szName as szSalesNm,  
BOS_AR_FCustBasicInformation.bICP ,  

BOS_AR_FCustBasicInformation.bCheckMaxDropSize,  

----  Document Status.  
BOS_AR_FCustBasicInformation.bResultFrTransfer,  
BOS_AR_FCustBasicInformation.bVoid,  
BOS_GEN_Approved.bApproved,  
BOS_AR_FCustBasicInformation.bApplied,  
BOS_GL_FJournalTrans.szFJournalId as bJournal,  
BOS_GL_FJournalTrans.bPosted,  
BOS_AR_FCustBasicInformation.btPrintedCount,  
BOS_AR_FCustBasicInformation.bTransferred,  
BOS_AR_FCustBasicInformation.szCompanyId,  
BOS_AR_FCustBasicInformation.szWorkPlaceId,  
BOS_AR_FCustBasicInformation.szTaxEntityId,  

BOS_AR_FCustBasicInformation.bNeedApproval,   
BOS_GEN_Approved.gdApprovedId,  
BOS_GEN_Approved.szApprovalId,  
BOS_GL_FJournalTrans.szFJournalId,  
BOS_AR_FCustBasicInformation.dtmCreated,   
BOS_AR_FCustBasicInformation.bSystemCreated,  

BOS_GL_Company.szName as szCompanyNm ,  
BOS_GL_Workplace.szName as szWorkplaceNm,  

BOS_AR_FCustBasicInformation.dtmLastUpdated,  
BOS_AR_FCustBasicInformation.bAlreadyTransferred,  
BOS_AR_FCustBasicInformation.szUserId,  
BOS_SM_User.szName as szUserNm_J,  
-- Customer Validation  
BOS_AR_FCustBasicInformation.bNeedInvoiceChange,  
BOS_AR_FCustBasicInformation.bInvoiceChangeWithReceipt,  
BOS_AR_FCustBasicInformation.bHasSpecialCollectionDay,  
BOS_AR_FCustBasicInformation.bHasSpecialCollectionDay_Sunday,  
BOS_AR_FCustBasicInformation.bHasSpecialCollectionDay_Monday,  
BOS_AR_FCustBasicInformation.bHasSpecialCollectionDay_Tuesday,  
BOS_AR_FCustBasicInformation.bHasSpecialCollectionDay_Wednesday,  
BOS_AR_FCustBasicInformation.bHasSpecialCollectionDay_Thursday,  
BOS_AR_FCustBasicInformation.bHasSpecialCollectionDay_Friday,  
BOS_AR_FCustBasicInformation.bHasSpecialCollectionDay_Saturday,   
BOS_AR_FCustBasicInformation.bPaymentType_Cash,  
BOS_AR_FCustBasicInformation.bPaymentType_CurrentAccount,  
BOS_AR_FCustBasicInformation.bPaymentType_Transfer,  
BOS_AR_FCustBasicInformation.bRequiredDocuments_PO,  
BOS_AR_FCustBasicInformation.bRequiredDocuments_Receipt,  
BOS_AR_FCustBasicInformation.bRequiredDocuments_StandardTaxInvoice,  
BOS_AR_FCustBasicInformation.bRequiredDocuments_Materai,  
BOS_AR_FCustBasicInformation.bRequiredDocuments_ReceiptNote,  
BOS_AR_FCustBasicInformation.bRequiredDocuments_Other,  
BOS_AR_FCustBasicInformation.szRequiredDocuments_Other,  
BOS_AR_FCustBasicInformation.szGuarantee,  
BOS_AR_FCustBasicInformation.bCheckMinDropSize,
BOS_AR_FCustBasicInformation.szDeliveryGroupId,
ISNULL(DeliveryGroup.szDesc, '') AS szDeliveryGroupDesc_J,
BOS_AR_FCustBasicInformation.szBarcodeId  ,
BOS_AR_FCustBasicInformation.szActivityStatus,
BOS_AR_FCustBasicInformation.dtmLastChangeActivityStatus
FROM  
BOS_AR_FCustBasicInformation  
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustBasicInformation.szDefaultCcyId  
LEFT JOIN BOS_GEN_Approved on BOS_AR_FCustBasicInformation.gdApprovedId = BOS_GEN_Approved.gdApprovedId  
LEFT JOIN BOS_GL_FJournalTrans ON BOS_AR_FCustBasicInformation.szFJournalId = BOS_GL_FJournalTrans.szFJournalId  
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustBasicInformation.szSalesId  
LEFT JOIN BOS_AR_Customer AS SOLD_TO ON SOLD_TO.szCustId = BOS_AR_FCustBasicInformation.szSoldToCustId  
LEFT JOIN BOS_AR_Customer AS DLV_TO ON DLV_TO.szCustId = BOS_AR_FCustBasicInformation.szDeliverToCustId  
LEFT JOIN BOS_AR_Customer AS INV_TO ON INV_TO.szCustId = BOS_AR_FCustBasicInformation.szInvoiceToCustId  
LEFT JOIN BOS_AR_Customer AS COLL_TO ON COLL_TO.szCustId = BOS_AR_FCustBasicInformation.szCollectToCustId  

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkPlaceId = BOS_AR_FCustBasicInformation.szWorkPlaceId  
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId= BOS_AR_FCustBasicInformation.szCompanyId  
LEFT JOIN BOS_SD_DeliveryGroup AS DeliveryGroup ON DeliveryGroup.szWorkplaceId = DLV_TO.szDlvWorkplaceId AND DeliveryGroup.szDeliveryGroupId = BOS_AR_FCustBasicInformation.szDeliveryGroupId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_AR_FCustBasicInformation.szUserId 

WHERE  
szFCustBIId = p_szFCustBIId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_GetFCustBasicInformationArItem(
p_szFCustBIId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_FCustBasicInformationArItem.szCcyId,
BOS_CU_Currency.szSymbol AS szCcySymbol,
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat,
BOS_AR_FCustBasicInformationArItem.decValue

FROM 
BOS_AR_FCustBasicInformationArItem
LEFT JOIN BOS_CU_Currency on BOS_AR_FCustBasicInformationAritem.szCcyId = BOS_CU_Currency.szCcyIdLEFT JOIN BOS_CU_Currency on BOS_AR_FCustBasicInformationAritem.szCcyId = BOS_CU_Currency.szCcyId
WHERE 
szFCustBIId = p_szFCustBIId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_GetFCustBasicInformationDjrItem(
p_szFCustBIId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_AR_FCustBasicInformationDjrTrackingItem.szDjrTrackingId,
BOS_SD_DjrTracking.szFDoId AS szDjrTrackingFDoId,
BOS_SD_DjrTracking.dtmNext AS dtmDjrTrackingNext,
BOS_SD_DjrTracking.szDriverId AS szDjrTrackingDriverId,
BOS_PI_Employee.szName AS szDjrTrackingDriverNm,
BOS_SD_DjrTracking.szCustId as szDjrTrackingCustId,
BOS_AR_Customer.szName AS szDjrTrackingCustNm
FROM
BOS_AR_FCustBasicInformationDjrTrackingItem
LEFT JOIN BOS_SD_DjrTracking ON BOS_SD_DjrTracking.szDjrTrackingId = BOS_AR_FCustBasicInformationDjrTrackingItem.szDjrTrackingId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_DjrTracking.szDriverId
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_DjrTracking.szCustId
WHERE
BOS_AR_FCustBasicInformationDjrTrackingItem.szFCustBIId = p_szFCustBIId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_GetFCustBasicInformationDoItem(
p_szFCustBIId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_FCustBasicInformationDoItem.szFDoId,
BOS_SD_FDo.dtmDelivery AS dtmFDoDelivery_J


FROM 
BOS_AR_FCustBasicInformationDoItem
LEFT JOIN BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_AR_FCustBasicInformationDoItem.szFDoIdLEFT JOIN BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_AR_FCustBasicInformationDoItem.szFDoId
WHERE 
BOS_AR_FCustBasicInformationDoItem.szFCustBIId = p_szFCustBIId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_GetFCustBasicInformationDoItem_014(
p_szFCustBIId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_FCustBasicInformationDoItem.szFDoId,
BOS_SD_FDo.dtmDelivery AS dtmFDoDelivery_J


FROM 
BOS_AR_FCustBasicInformationDoItem
LEFT JOIN BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_AR_FCustBasicInformationDoItem.szFDoIdLEFT JOIN BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_AR_FCustBasicInformationDoItem.szFDoId
WHERE 
BOS_AR_FCustBasicInformationDoItem.szFCustBIId = p_szFCustBIId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_GetFCustBasicInformationProductItem(
p_szFCustBIId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_FCustBasicInformationProductItem.szProductId,
BOS_INV_Product.szName, BOS_INV_Product.szUomId,
	BOS_AR_FCustBasicInformationProductItem.szRefProductId,
    BOS_AR_FCustBasicInformationProductItem.szRefProductName

FROM 
BOS_AR_FCustBasicInformationProductItem
INNER JOIN
 BOS_INV_Product ON BOS_AR_FCustBasicInformationProductItem.szProductId = BOS_INV_Product.szProductId
WHERE 
BOS_AR_FCustBasicInformationProductItem.szFCustBIId = p_szFCustBIId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_GetFCustBasicInformationStockItem(
p_szFCustBIId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_FCustBasicInformationStockItem.szProductId,
BOS_INV_Product.szName AS szProductNm,
BOS_AR_FCustBasicInformationStockItem.decQty,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_AR_FCustBasicInformationStockItem.szStockTypeId

FROM 
BOS_AR_FCustBasicInformationStockItem
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_AR_FCustBasicInformationStockItem.szProductIdLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_AR_FCustBasicInformationStockItem.szProductId
WHERE 
szFCustBIId = p_szFCustBIId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_GetListOfFCustBasicInformation()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCustBIId

FROM 
BOS_AR_FCustBasicInformation;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_GetListOfStockOnCustomer(
p_szLocationType varchar,
p_szLocationId BOS_DT_szId,
p_szReportedAsType varchar,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_Stock.szProductId,
isnull(BOS_INV_Product.szName,'') as szProductNm,
isnull(BOS_INV_Product.szQtyFormat,'') as qtyFormat,
isnull(BOS_INV_Product.szUomId,'') as szUomId,
BOS_INV_Stock.szLocationType,
BOS_INV_Stock.szLocationId,
BOS_INV_Stock.szReportedAsType,
BOS_INV_Stock.szReportedAsId,
sum(BOS_INV_Stock.decQtyOnHand) decQty,
isnull(BOS_INV_Stock.szStockTypeId,'')  as szStockTypeId

FROM
BOS_INV_Stock 
left join bos_inv_product on BOS_INV_Stock.szProductId = BOS_INV_Product.szProductId


WHERE 
 BOS_INV_Stock.szLocationType= p_szLocationType AND
BOS_INV_Stock.szLocationId = p_szLocationId AND
BOS_INV_Stock.szReportedAsType = p_szReportedAsType AND
BOS_INV_Stock.szReportedAsId = p_szReportedAsId

GROUP BY 
BOS_INV_Stock.szProductId,
BOS_INV_Stock.szLocationType,
BOS_INV_Stock.szLocationId,
BOS_INV_Stock.szReportedAsType,
BOS_INV_Stock.szReportedAsId,
BOS_INV_Stock.szStockTypeId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szUomId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_IsFCustBasicInformationExist(
p_szFCustBIId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCustBIId

FROM 
BOS_AR_FCustBasicInformation
WHERE 
szFCustBIId = p_szFCustBIId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_LockFCustBasicInformation(
p_szFCustBIId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustBasicInformation
SET 
bNeedApproval =  bNeedApproval
WHERE 
szFCustBIId = p_szFCustBIId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_MarkFCustBasicInformationApplied(
p_szFCustBIId BOS_DT_szId,
p_dtmDoc timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustBasicInformation
SET 
dtmDoc = p_dtmDoc,
bApplied = 1
WHERE 
szFCustBIId = p_szFCustBIId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_MarkFCustBasicInformationVoid(
p_szFCustBIId BOS_DT_szId,
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_Ar_FCustBasicInformation
SET 
bVoid = 1,
bNeedApproval = 0,
gdApprovedId = p_gdApprovedId
WHERE 
szFCustBIId = p_szFCustBIId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_UpdateCustomerFCustBasicInformation(
p_szFCustBIId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szSoldToCustId BOS_DT_szId,
p_szDeliverToCustId BOS_DT_szId,
p_szInvoiceToCustId BOS_DT_szId,
p_szCollectToCustId BOS_DT_szId,
p_szDeliveryGroupId BOS_DT_szId,
p_szBarcodeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustBasicInformation
SET 
szCustId = p_szCustId,

szSoldToCustId 	= p_szSoldToCustId,
szDeliverToCustId = p_szDeliverToCustId,
szInvoiceToCustId = p_szInvoiceToCustId,
szCollectToCustId = p_szCollectToCustId,
szDeliveryGroupId = p_szDeliveryGroupId,
szBarcodeId = p_szBarcodeId
WHERE 
szFCustBIId = p_szFCustBIId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_UpdateCustomerFCustBasicInformation_013(
p_szFCustBIId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szSoldToCustId BOS_DT_szId,
p_szDeliverToCustId BOS_DT_szId,
p_szInvoiceToCustId BOS_DT_szId,
p_szCollectToCustId BOS_DT_szId,
p_szDeliveryGroupId BOS_DT_szId,
p_szBarcodeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustBasicInformation
SET 
szCustId = p_szCustId,

szSoldToCustId 	= p_szSoldToCustId,
szDeliverToCustId = p_szDeliverToCustId,
szInvoiceToCustId = p_szInvoiceToCustId,
szCollectToCustId = p_szCollectToCustId,
szDeliveryGroupId = p_szDeliveryGroupId,
szBarcodeId = p_szBarcodeId
WHERE 
szFCustBIId = p_szFCustBIId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_UpdateFCustBasicInformation(
p_szFCustBIId BOS_DT_szId,
p_szFCallId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_dtmDoc timestamp,
p_bNewCustomer bit,
p_szCustNm BOS_DT_szName,
p_szDistrChannelId BOS_DT_szId,
p_szCategoryId1 BOS_DT_szId,
p_szCategoryId2 BOS_DT_szId,
p_szCategoryId3 BOS_DT_szId,
p_szCategoryId4 BOS_DT_szId,
p_szCategoryId5 BOS_DT_szId,
p_szCategoryId6 BOS_DT_szId,
p_szCategoryId7 BOS_DT_szId,
p_szCategoryId8 BOS_DT_szId,
p_szCategoryId9 BOS_DT_szId,
p_szCategoryId10 BOS_DT_szId,
p_CustszContactPerson BOS_DT_szName,
p_CustszRoomNo BOS_DT_szSmallName,
p_CustszFloor BOS_DT_szSmallName,
p_CustszBuilding BOS_DT_szName,
p_CustszAddress_1 BOS_DT_szBigDescription,
p_CustszAddress_2 BOS_DT_szBigDescription,
p_CustszDistrict BOS_DT_szMediumName,
p_CustszCity BOS_DT_szMediumName,
p_CustszZipCode BOS_DT_szSmallName,
p_CustszState BOS_DT_szMediumName,
p_CustszCountry BOS_DT_szMediumName,
p_CustszPhoneNo_1 BOS_DT_szMediumName,
p_CustszPhoneNo_2 BOS_DT_szMediumName,
p_CustszFaxNo BOS_DT_szMediumName,
p_CustszMobileNo BOS_DT_szMediumName,
p_CustszEmail BOS_DT_szMediumName,
p_CustszWebSite BOS_DT_szMediumName,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_bSoldToCust bit,
p_bDeliverToCust bit,
p_bInvoiceToCust bit,
p_bCollectToCust bit,
p_szSoldToCustId BOS_DT_szId,
p_szDeliverToCustId BOS_DT_szId,
p_szInvoiceToCustId BOS_DT_szId,
p_szCollectToCustId BOS_DT_szId,
p_szRemark BOS_DT_szDescription,
p_bJoinInvoice bit,
p_bDelCust bit,
p_szStatus varchar,
p_szReasonId BOS_DT_szId,
p_szSalWorkplaceId BOS_DT_szId,
p_szDefaultCcyId BOS_DT_szSmallId,
p_szFCustChgSalesCfgId BOS_DT_szId,
p_szStartDoc varchar,
p_dtmStart timestamp,
p_szContractDoc varchar,
p_dtmContract timestamp,
p_szRenewalDoc varchar,
p_dtmRenewal timestamp,
p_szStopDoc varchar,
p_dtmStop timestamp,
p_szSalesId BOS_DT_szId,
p_bICP bit,
p_bCheckMaxDropSize BOS_DT_bBoolean,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_bNeedInvoiceChange BOS_DT_bBoolean,
p_bInvoiceChangeWithReceipt BOS_DT_bBoolean,
p_bHasSpecialCollectionDay BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Sunday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Monday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Tuesday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Wednesday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Thursday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Friday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Saturday BOS_DT_bBoolean,
p_bPaymentType_Cash BOS_DT_bBoolean,
p_bPaymentType_CurrentAccount BOS_DT_bBoolean,
p_bPaymentType_Transfer BOS_DT_bBoolean,
p_bRequiredDocuments_PO BOS_DT_bBoolean,
p_bRequiredDocuments_Receipt BOS_DT_bBoolean,
p_bRequiredDocuments_StandardTaxInvoice BOS_DT_bBoolean,
p_bRequiredDocuments_Materai BOS_DT_bBoolean,
p_bRequiredDocuments_ReceiptNote BOS_DT_bBoolean,
p_bRequiredDocuments_Other BOS_DT_bBoolean,
p_szRequiredDocuments_Other BOS_DT_szBigDescription,
p_szGuarantee BOS_DT_szBigDescription,
p_bCheckMinDropSize BOS_DT_bBoolean,
p_szDeliveryGroupId BOS_DT_szId,
p_szBarcodeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustBasicInformation
SET 
szFCallId   = p_szFCallId,
szSalesOrgId   = p_szSalesOrgId,
szCustId   = p_szCustId,
dtmDoc   = p_dtmDoc,
bNewCustomer   = p_bNewCustomer,
szCustNm   = p_szCustNm,
szDistrChannelId = p_szDistrChannelId,
--- Customer Category.
szCategory_1 = p_szCategoryId1,
szCategory_2 = p_szCategoryId2,
szCategory_3 = p_szCategoryId3,
szCategory_4 = p_szCategoryId4,
szCategory_5 = p_szCategoryId5,
szCategory_6 = p_szCategoryId6,
szCategory_7 = p_szCategoryId7,
szCategory_8 = p_szCategoryId8,
szCategory_9 = p_szCategoryId9,
szCategory_10 = p_szCategoryId10,
--- Basic Address.
CustszContactPerson  = p_CustszContactPerson,
CustszRoomNo   = p_CustszRoomNo,
CustszFloor   = p_CustszFloor,
CustszBuilding  = p_CustszBuilding,
CustszAddress_1  = p_CustszAddress_1,
CustszAddress_2  = p_CustszAddress_2,
CustszDistrict  = p_CustszDistrict,
CustszCity   = p_CustszCity,
CustszZipCode   = p_CustszZipCode,
CustszState   = p_CustszState,
CustszCountry   = p_CustszCountry,
CustszPhoneNo_1  = p_CustszPhoneNo_1,
CustszPhoneNo_2  = p_CustszPhoneNo_2,
CustszFaxNo   = p_CustszFaxNo,
CustszMobileNo  = p_CustszMobileNo,
CustszEmail   = p_CustszEmail,
CustszWebSite   = p_CustszWebSite,

szLatitude  = p_szLatitude,
szLongitude  = p_szLongitude,

bSoldToCust   = p_bSoldToCust,
bDeliverToCust  = p_bDeliverToCust,
bInvoiceToCust  = p_bInvoiceToCust,
bCollectToCust  = p_bCollectToCust,
szSoldToCustId  = p_szSoldToCustId,
szDeliverToCustId  = p_szDeliverToCustId,
szInvoiceToCustId  = p_szInvoiceToCustId,
szCollectToCustId  = p_szCollectToCustId,

szRemark  = p_szRemark,
bJoinInvoice  = p_bJoinInvoice,
bDelCust  = p_bDelCust,
szStatus   = p_szStatus,
szReasonId             = p_szReasonId,

szSalWorkplaceId = p_szSalWorkplaceId,
szDefaultCcyId  = p_szDefaultCcyId,
szFCustChgSalesCfgId   = p_szFCustChgSalesCfgId,

szStartDoc  = p_szStartDoc ,
dtmStart  = p_dtmStart ,
szContractDoc  = p_szContractDoc ,
dtmContract  = p_dtmContract ,
szRenewalDoc  = p_szRenewalDoc ,
dtmRenewal  = p_dtmRenewal ,
szStopDoc  = p_szStopDoc ,
dtmStop   = p_dtmStop ,
szSalesId  = p_szSalesId ,
bICP   = p_bICP ,

bCheckMaxDropSize = p_bCheckMaxDropSize,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
dtmCreated = p_dtmCreated,
bSystemCreated = bSystemCreated,
szUserId = p_szUserId,
-- Customer Validation
bNeedInvoiceChange = p_bNeedInvoiceChange,
bInvoiceChangeWithReceipt = p_bInvoiceChangeWithReceipt,
bHasSpecialCollectionDay = p_bHasSpecialCollectionDay,
bHasSpecialCollectionDay_Sunday = p_bHasSpecialCollectionDay_Sunday,
bHasSpecialCollectionDay_Monday = p_bHasSpecialCollectionDay_Monday,
bHasSpecialCollectionDay_Tuesday = p_bHasSpecialCollectionDay_Tuesday,
bHasSpecialCollectionDay_Wednesday = p_bHasSpecialCollectionDay_Wednesday,
bHasSpecialCollectionDay_Thursday = p_bHasSpecialCollectionDay_Thursday,
bHasSpecialCollectionDay_Friday = p_bHasSpecialCollectionDay_Friday,
bHasSpecialCollectionDay_Saturday = p_bHasSpecialCollectionDay_Saturday,
bPaymentType_Cash = p_bPaymentType_Cash,
bPaymentType_CurrentAccount = p_bPaymentType_CurrentAccount,
bPaymentType_Transfer = p_bPaymentType_Transfer,
bRequiredDocuments_PO = p_bRequiredDocuments_PO,
bRequiredDocuments_Receipt = p_bRequiredDocuments_Receipt,
bRequiredDocuments_StandardTaxInvoice = p_bRequiredDocuments_StandardTaxInvoice,
bRequiredDocuments_Materai = p_bRequiredDocuments_Materai,
bRequiredDocuments_ReceiptNote = p_bRequiredDocuments_ReceiptNote,
bRequiredDocuments_Other = p_bRequiredDocuments_Other,
szRequiredDocuments_Other = p_szRequiredDocuments_Other,
szGuarantee = p_szGuarantee,
bCheckMinDropSize = p_bCheckMinDropSize,
szDeliveryGroupId = p_szDeliveryGroupId,
szBarcodeId = p_szBarcodeId
WHERE 
szFCustBIId = p_szFCustBIId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustBasicInformation_UpdateFCustBasicInformation_013(
p_szFCustBIId BOS_DT_szId,
p_szFCallId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_dtmDoc timestamp,
p_bNewCustomer bit,
p_szCustNm BOS_DT_szName,
p_szDistrChannelId BOS_DT_szId,
p_szCategoryId1 BOS_DT_szId,
p_szCategoryId2 BOS_DT_szId,
p_szCategoryId3 BOS_DT_szId,
p_szCategoryId4 BOS_DT_szId,
p_szCategoryId5 BOS_DT_szId,
p_szCategoryId6 BOS_DT_szId,
p_szCategoryId7 BOS_DT_szId,
p_szCategoryId8 BOS_DT_szId,
p_szCategoryId9 BOS_DT_szId,
p_szCategoryId10 BOS_DT_szId,
p_szActivityStatus BOS_DT_szId,
p_dtmLastChangeActivityStatus timestamp,
p_CustszContactPerson BOS_DT_szName,
p_CustszRoomNo BOS_DT_szSmallName,
p_CustszFloor BOS_DT_szSmallName,
p_CustszBuilding BOS_DT_szName,
p_CustszAddress_1 BOS_DT_szBigDescription,
p_CustszAddress_2 BOS_DT_szBigDescription,
p_CustszDistrict BOS_DT_szName,
p_CustszCity BOS_DT_szMediumName,
p_CustszZipCode BOS_DT_szSmallName,
p_CustszState BOS_DT_szMediumName,
p_CustszCountry BOS_DT_szMediumName,
p_CustszPhoneNo_1 BOS_DT_szMediumName,
p_CustszPhoneNo_2 BOS_DT_szMediumName,
p_CustszFaxNo BOS_DT_szMediumName,
p_CustszMobileNo BOS_DT_szMediumName,
p_CustszEmail BOS_DT_szMediumName,
p_CustszWebSite BOS_DT_szMediumName,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_bSoldToCust bit,
p_bDeliverToCust bit,
p_bInvoiceToCust bit,
p_bCollectToCust bit,
p_szSoldToCustId BOS_DT_szId,
p_szDeliverToCustId BOS_DT_szId,
p_szInvoiceToCustId BOS_DT_szId,
p_szCollectToCustId BOS_DT_szId,
p_szRemark BOS_DT_szDescription,
p_bJoinInvoice bit,
p_bDelCust bit,
p_szStatus varchar,
p_szReasonId BOS_DT_szId,
p_szSalWorkplaceId BOS_DT_szId,
p_szDefaultCcyId BOS_DT_szSmallId,
p_szFCustChgSalesCfgId BOS_DT_szId,
p_szStartDoc varchar,
p_dtmStart timestamp,
p_szContractDoc varchar,
p_dtmContract timestamp,
p_szRenewalDoc varchar,
p_dtmRenewal timestamp,
p_szStopDoc varchar,
p_dtmStop timestamp,
p_szSalesId BOS_DT_szId,
p_bICP bit,
p_bCheckMaxDropSize BOS_DT_bBoolean,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_bNeedInvoiceChange BOS_DT_bBoolean,
p_bInvoiceChangeWithReceipt BOS_DT_bBoolean,
p_bHasSpecialCollectionDay BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Sunday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Monday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Tuesday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Wednesday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Thursday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Friday BOS_DT_bBoolean,
p_bHasSpecialCollectionDay_Saturday BOS_DT_bBoolean,
p_bPaymentType_Cash BOS_DT_bBoolean,
p_bPaymentType_CurrentAccount BOS_DT_bBoolean,
p_bPaymentType_Transfer BOS_DT_bBoolean,
p_bRequiredDocuments_PO BOS_DT_bBoolean,
p_bRequiredDocuments_Receipt BOS_DT_bBoolean,
p_bRequiredDocuments_StandardTaxInvoice BOS_DT_bBoolean,
p_bRequiredDocuments_Materai BOS_DT_bBoolean,
p_bRequiredDocuments_ReceiptNote BOS_DT_bBoolean,
p_bRequiredDocuments_Other BOS_DT_bBoolean,
p_szRequiredDocuments_Other BOS_DT_szBigDescription,
p_szGuarantee BOS_DT_szBigDescription,
p_bCheckMinDropSize BOS_DT_bBoolean,
p_szDeliveryGroupId BOS_DT_szId,
p_szBarcodeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustBasicInformation
SET 
szFCallId   = p_szFCallId,
szSalesOrgId   = p_szSalesOrgId,
szCustId   = p_szCustId,
dtmDoc   = p_dtmDoc,
bNewCustomer   = p_bNewCustomer,
szCustNm   = p_szCustNm,
szDistrChannelId = p_szDistrChannelId,
--- Customer Category.
szCategory_1 = p_szCategoryId1,
szCategory_2 = p_szCategoryId2,
szCategory_3 = p_szCategoryId3,
szCategory_4 = p_szCategoryId4,
szCategory_5 = p_szCategoryId5,
szCategory_6 = p_szCategoryId6,
szCategory_7 = p_szCategoryId7,
szCategory_8 = p_szCategoryId8,
szCategory_9 = p_szCategoryId9,
szCategory_10 = p_szCategoryId10,

szActivityStatus = p_szActivityStatus,
dtmLastChangeActivityStatus = p_dtmLastChangeActivityStatus,

--- Basic Address.
CustszContactPerson  = p_CustszContactPerson,
CustszRoomNo   = p_CustszRoomNo,
CustszFloor   = p_CustszFloor,
CustszBuilding  = p_CustszBuilding,
CustszAddress_1  = p_CustszAddress_1,
CustszAddress_2  = p_CustszAddress_2,
CustszDistrict  = p_CustszDistrict,
CustszCity   = p_CustszCity,
CustszZipCode   = p_CustszZipCode,
CustszState   = p_CustszState,
CustszCountry   = p_CustszCountry,
CustszPhoneNo_1  = p_CustszPhoneNo_1,
CustszPhoneNo_2  = p_CustszPhoneNo_2,
CustszFaxNo   = p_CustszFaxNo,
CustszMobileNo  = p_CustszMobileNo,
CustszEmail   = p_CustszEmail,
CustszWebSite   = p_CustszWebSite,

szLatitude  = p_szLatitude,
szLongitude  = p_szLongitude,

bSoldToCust   = p_bSoldToCust,
bDeliverToCust  = p_bDeliverToCust,
bInvoiceToCust  = p_bInvoiceToCust,
bCollectToCust  = p_bCollectToCust,
szSoldToCustId  = p_szSoldToCustId,
szDeliverToCustId  = p_szDeliverToCustId,
szInvoiceToCustId  = p_szInvoiceToCustId,
szCollectToCustId  = p_szCollectToCustId,

szRemark  = p_szRemark,
bJoinInvoice  = p_bJoinInvoice,
bDelCust  = p_bDelCust,
szStatus   = p_szStatus,
szReasonId             = p_szReasonId,

szSalWorkplaceId = p_szSalWorkplaceId,
szDefaultCcyId  = p_szDefaultCcyId,
szFCustChgSalesCfgId   = p_szFCustChgSalesCfgId,

szStartDoc  = p_szStartDoc ,
dtmStart  = p_dtmStart ,
szContractDoc  = p_szContractDoc ,
dtmContract  = p_dtmContract ,
szRenewalDoc  = p_szRenewalDoc ,
dtmRenewal  = p_dtmRenewal ,
szStopDoc  = p_szStopDoc ,
dtmStop   = p_dtmStop ,
szSalesId  = p_szSalesId ,
bICP   = p_bICP ,

bCheckMaxDropSize = p_bCheckMaxDropSize,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
dtmCreated = p_dtmCreated,
bSystemCreated = bSystemCreated,
szUserId = p_szUserId,
-- Customer Validation
bNeedInvoiceChange = p_bNeedInvoiceChange,
bInvoiceChangeWithReceipt = p_bInvoiceChangeWithReceipt,
bHasSpecialCollectionDay = p_bHasSpecialCollectionDay,
bHasSpecialCollectionDay_Sunday = p_bHasSpecialCollectionDay_Sunday,
bHasSpecialCollectionDay_Monday = p_bHasSpecialCollectionDay_Monday,
bHasSpecialCollectionDay_Tuesday = p_bHasSpecialCollectionDay_Tuesday,
bHasSpecialCollectionDay_Wednesday = p_bHasSpecialCollectionDay_Wednesday,
bHasSpecialCollectionDay_Thursday = p_bHasSpecialCollectionDay_Thursday,
bHasSpecialCollectionDay_Friday = p_bHasSpecialCollectionDay_Friday,
bHasSpecialCollectionDay_Saturday = p_bHasSpecialCollectionDay_Saturday,
bPaymentType_Cash = p_bPaymentType_Cash,
bPaymentType_CurrentAccount = p_bPaymentType_CurrentAccount,
bPaymentType_Transfer = p_bPaymentType_Transfer,
bRequiredDocuments_PO = p_bRequiredDocuments_PO,
bRequiredDocuments_Receipt = p_bRequiredDocuments_Receipt,
bRequiredDocuments_StandardTaxInvoice = p_bRequiredDocuments_StandardTaxInvoice,
bRequiredDocuments_Materai = p_bRequiredDocuments_Materai,
bRequiredDocuments_ReceiptNote = p_bRequiredDocuments_ReceiptNote,
bRequiredDocuments_Other = p_bRequiredDocuments_Other,
szRequiredDocuments_Other = p_szRequiredDocuments_Other,
szGuarantee = p_szGuarantee,
bCheckMinDropSize = p_bCheckMinDropSize,
szDeliveryGroupId = p_szDeliveryGroupId,
szBarcodeId = p_szBarcodeId
WHERE 
szFCustBIId = p_szFCustBIId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgDlvAddress_CreateFCustChgDlvAddress(
p_szFCustCDAId BOS_DT_szId,
p_szFCallId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_dtmDoc timestamp,
p_szCustId BOS_DT_szId,
p_szCustDeliveryNm BOS_DT_szName,
p_CustszContactPerson BOS_DT_szName,
p_CustszRoomNo BOS_DT_szSmallName,
p_CustszFloor BOS_DT_szSmallName,
p_CustszBuilding BOS_DT_szName,
p_CustszAddress_1 BOS_DT_szName,
p_CustszAddress_2 BOS_DT_szName,
p_CustszDistrict BOS_DT_szName,
p_CustszCity BOS_DT_szMediumName,
p_CustszZipCode BOS_DT_szSmallName,
p_CustszState BOS_DT_szMediumName,
p_CustszCountry BOS_DT_szMediumName,
p_CustszPhoneNo_1 BOS_DT_szMediumName,
p_CustszPhoneNo_2 BOS_DT_szMediumName,
p_CustszFaxNo BOS_DT_szMediumName,
p_CustszMobileNo BOS_DT_szMediumName,
p_CustszEmail BOS_DT_szMediumName,
p_CustszWebSite BOS_DT_szMediumName,
p_bIsDiffDeliveryAddress bit,
p_DeliveryszContactPerson BOS_DT_szName,
p_DeliveryszRoomNo BOS_DT_szSmallName,
p_DeliveryszFloor BOS_DT_szSmallName,
p_DeliveryszBuilding BOS_DT_szName,
p_DeliveryszAddress_1 BOS_DT_szName,
p_DeliveryszAddress_2 BOS_DT_szName,
p_DeliveryszDistrict BOS_DT_szName,
p_DeliveryszCity BOS_DT_szMediumName,
p_DeliveryszZipCode BOS_DT_szSmallName,
p_DeliveryszState BOS_DT_szMediumName,
p_DeliveryszCountry BOS_DT_szMediumName,
p_DeliveryszPhoneNo_1 BOS_DT_szMediumName,
p_DeliveryszPhoneNo_2 BOS_DT_szMediumName,
p_DeliveryszFaxNo BOS_DT_szMediumName,
p_DeliveryszMobileNo BOS_DT_szMediumName,
p_DeliveryszEmail BOS_DT_szMediumName,
p_DeliveryszWebSite BOS_DT_szMediumName,
p_szRemark BOS_DT_szDescription,
p_szDlvWorkPlaceId BOS_DT_szId,
p_bIsMultiLocation bit,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustChgDlvAddress
(
szFCustCDAId,
szFCallId,
szSalesOrgId,
dtmDoc,
szCustId,
szCustDeliveryNm,
CustszContactPerson ,
CustszRoomNo ,
CustszFloor ,
CustszBuilding ,
CustszAddress_1 ,
CustszAddress_2 ,
CustszDistrict ,
CustszCity ,
CustszZipCode ,
CustszState ,
CustszCountry ,
CustszPhoneNo_1 ,
CustszPhoneNo_2 ,
CustszFaxNo ,
CustszMobileNo ,
CustszEmail ,
CustszWebSite ,
bIsDiffDeliveryAddress,
DeliveryszContactPerson,
DeliveryszRoomNo,
DeliveryszFloor,
DeliveryszBuilding,
DeliveryszAddress_1,
DeliveryszAddress_2,
DeliveryszDistrict,
DeliveryszCity,
DeliveryszZipCode,
DeliveryszState,
DeliveryszCountry,
DeliveryszPhoneNo_1,
DeliveryszPhoneNo_2,
DeliveryszFaxNo,
DeliveryszMobileNo,
DeliveryszEmail,
DeliveryszWebSite,
szRemark,
szDlvWorkPlaceId,
bIsMultiLocation,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkPlaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFCustCDAId,
p_szFCallId,
p_szSalesOrgId,
p_dtmDoc,
p_szCustId,
p_szCustDeliveryNm,
p_CustszContactPerson ,
p_CustszRoomNo ,
p_CustszFloor ,
p_CustszBuilding ,
p_CustszAddress_1 ,
p_CustszAddress_2 ,
p_CustszDistrict ,
p_CustszCity ,
p_CustszZipCode ,
p_CustszState ,
p_CustszCountry ,
p_CustszPhoneNo_1 ,
p_CustszPhoneNo_2 ,
p_CustszFaxNo ,
p_CustszMobileNo ,
p_CustszEmail ,
p_CustszWebSite,
p_bIsDiffDeliveryAddress,
p_DeliveryszContactPerson,
p_DeliveryszRoomNo,
p_DeliveryszFloor,
p_DeliveryszBuilding,
p_DeliveryszAddress_1,
p_DeliveryszAddress_2,
p_DeliveryszDistrict,
p_DeliveryszCity,
p_DeliveryszZipCode,
p_DeliveryszState,
p_DeliveryszCountry,
p_DeliveryszPhoneNo_1,
p_DeliveryszPhoneNo_2,
p_DeliveryszFaxNo,
p_DeliveryszMobileNo,
p_DeliveryszEmail,
p_DeliveryszWebSite,
p_szRemark,
p_szDlvWorkPlaceId,
p_bIsMultiLocation,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkPlaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgDlvAddress_CreateFCustChgDlvAddressItem(
p_szFCustCDAId BOS_DT_szId,
p_btItemNumber smallint,
p_LocationszContactPerson BOS_DT_szName,
p_LocationszRoomNo BOS_DT_szSmallName,
p_LocationszFloor BOS_DT_szSmallName,
p_LocationszBuilding BOS_DT_szName,
p_LocationszAddress_1 BOS_DT_szName,
p_LocationszAddress_2 BOS_DT_szName,
p_LocationszDistrict BOS_DT_szName,
p_LocationszCity BOS_DT_szMediumName,
p_LocationszZipCode BOS_DT_szSmallName,
p_LocationszState BOS_DT_szMediumName,
p_LocationszCountry BOS_DT_szMediumName,
p_LocationszPhoneNo_1 BOS_DT_szMediumName,
p_LocationszPhoneNo_2 BOS_DT_szMediumName,
p_LocationszFaxNo BOS_DT_szMediumName,
p_LocationszMobileNo BOS_DT_szMediumName,
p_LocationszEmail BOS_DT_szMediumName,
p_LocationszWebSite BOS_DT_szMediumName)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustChgDlvAddressItem
(
szFCustCDAId,
btItemNumber,
LocationszContactPerson,
LocationszRoomNo,
LocationszFloor,
LocationszBuilding,
LocationszAddress_1,
LocationszAddress_2,
LocationszDistrict,
LocationszCity,
LocationszZipCode,
LocationszState,
LocationszCountry,
LocationszPhoneNo_1,
LocationszPhoneNo_2,
LocationszFaxNo,
LocationszMobileNo,
LocationszEmail,
LocationszWebSite
)
VALUES
(
p_szFCustCDAId,
p_btItemNumber,
p_LocationszContactPerson,
p_LocationszRoomNo,
p_LocationszFloor,
p_LocationszBuilding,
p_LocationszAddress_1,
p_LocationszAddress_2,
p_LocationszDistrict,
p_LocationszCity,
p_LocationszZipCode,
p_LocationszState,
p_LocationszCountry,
p_LocationszPhoneNo_1,
p_LocationszPhoneNo_2,
p_LocationszFaxNo,
p_LocationszMobileNo,
p_LocationszEmail,
p_LocationszWebSite
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgDlvAddress_DeleteFCustChgDlvAddress(
p_szFCustCDAId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_AR_FCustChgDlvAddress
WHERE
szFCustCDAId = p_szFCustCDAId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgDlvAddress_DeleteFCustChgDlvAddressItem(
p_szFCustCDAId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_AR_FCustChgDlvAddressItem
WHERE
szFCustCDAId = p_szFCustCDAId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgDlvAddress_GetFCustChgDlvAddress(
p_szFCustCDAId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_AR_FCustChgDlvAddress.szFCustCDAId,
BOS_AR_FCustChgDlvAddress.szFCallId,
BOS_AR_FCustChgDlvAddress.szSalesOrgId,
BOS_AR_FCustChgDlvAddress.dtmDoc,
BOS_AR_FCustChgDlvAddress.szCustId,
BOS_AR_Customer.szName as szCustNm_J,
BOS_AR_FCustChgDlvAddress.szCustDeliveryNm,

BOS_AR_FCustChgDlvAddress.CustszContactPerson ,
BOS_AR_FCustChgDlvAddress.CustszRoomNo ,
BOS_AR_FCustChgDlvAddress.CustszFloor ,
BOS_AR_FCustChgDlvAddress.CustszBuilding ,
BOS_AR_FCustChgDlvAddress.CustszAddress_1 ,
BOS_AR_FCustChgDlvAddress.CustszAddress_2 ,
BOS_AR_FCustChgDlvAddress.CustszDistrict ,
BOS_AR_FCustChgDlvAddress.CustszCity ,
BOS_AR_FCustChgDlvAddress.CustszZipCode ,
BOS_AR_FCustChgDlvAddress.CustszState ,
BOS_AR_FCustChgDlvAddress.CustszCountry ,
BOS_AR_FCustChgDlvAddress.CustszPhoneNo_1 ,
BOS_AR_FCustChgDlvAddress.CustszPhoneNo_2 ,
BOS_AR_FCustChgDlvAddress.CustszFaxNo ,
BOS_AR_FCustChgDlvAddress.CustszMobileNo ,
BOS_AR_FCustChgDlvAddress.CustszEmail ,
BOS_AR_FCustChgDlvAddress.CustszWebSite ,

BOS_AR_FCustChgDlvAddress.bIsDiffDeliveryAddress,

BOS_AR_FCustChgDlvAddress.DeliveryszContactPerson,
BOS_AR_FCustChgDlvAddress.DeliveryszRoomNo,
BOS_AR_FCustChgDlvAddress.DeliveryszFloor,
BOS_AR_FCustChgDlvAddress.DeliveryszBuilding,
BOS_AR_FCustChgDlvAddress.DeliveryszAddress_1,
BOS_AR_FCustChgDlvAddress.DeliveryszAddress_2,
BOS_AR_FCustChgDlvAddress.DeliveryszDistrict,
BOS_AR_FCustChgDlvAddress.DeliveryszCity,
BOS_AR_FCustChgDlvAddress.DeliveryszZipCode,
BOS_AR_FCustChgDlvAddress.DeliveryszState,
BOS_AR_FCustChgDlvAddress.DeliveryszCountry,
BOS_AR_FCustChgDlvAddress.DeliveryszPhoneNo_1,
BOS_AR_FCustChgDlvAddress.DeliveryszPhoneNo_2,
BOS_AR_FCustChgDlvAddress.DeliveryszFaxNo,
BOS_AR_FCustChgDlvAddress.DeliveryszMobileNo,
BOS_AR_FCustChgDlvAddress.DeliveryszEmail,
BOS_AR_FCustChgDlvAddress.DeliveryszWebSite,
BOS_AR_FCustChgDlvAddress.szRemark,
BOS_AR_FCustChgDlvAddress.szDlvWorkPlaceId,
BOS_AR_FCustChgDlvAddress.bIsMultiLocation,
BOS_AR_FCustChgDlvAddress.bResultFrTransfer,
BOS_AR_FCustChgDlvAddress.bVoid,
BOS_GEN_Approved.bApproved,
BOS_AR_FCustChgDlvAddress.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_AR_FCustChgDlvAddress.btPrintedCount,
BOS_AR_FCustChgDlvAddress.bTransferred,
BOS_AR_FCustChgDlvAddress.szCompanyId,
BOS_AR_FCustChgDlvAddress.szWorkPlaceId,
BOS_AR_FCustChgDlvAddress.szTaxEntityId,
BOS_AR_FCustChgDlvAddress.bNeedApproval, 
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_AR_FCustChgDlvAddress.dtmCreated, 
BOS_AR_FCustChgDlvAddress.bSystemCreated,
BOS_GL_Company.szName as szCompanyNm ,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_AR_FCustChgDlvAddress.dtmLastUpdated,
BOS_AR_FCustChgDlvAddress.bAlreadyTransferred,
BOS_AR_FCustChgDlvAddress.szUserId,
BOS_SM_User.szName as szUserNm_J


FROM
(BOS_AR_FCustChgDlvAddress left join BOS_GEN_Approved on BOS_AR_FCustChgDlvAddress.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
LEFT JOIN BOS_GL_FJournalTrans ON BOS_AR_FCustChgDlvAddress.szFJournalId=BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_AR_FCustChgDlvAddress.szCustId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkPlaceId = BOS_AR_FCustChgDlvAddress.szWorkPlaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId= BOS_AR_FCustChgDlvAddress.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_AR_FCustChgDlvAddress.szUserId

WHERE
szFCustCDAId = p_szFCustCDAId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgDlvAddress_GetFCustChgDlvAddressItem(
p_szFCustCDAId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCustCDAId,
btItemNumber,
LocationszContactPerson,
LocationszRoomNo,
LocationszFloor,
LocationszBuilding,
LocationszAddress_1,
LocationszAddress_2,
LocationszDistrict,
LocationszCity,
LocationszZipCode,
LocationszState,
LocationszCountry,
LocationszPhoneNo_1,
LocationszPhoneNo_2,
LocationszFaxNo,
LocationszMobileNo,
LocationszEmail,
LocationszWebSite

FROM 
BOS_AR_FCustChgDlvAddressItem
WHERE 
szFCustCDAId = p_szFCustCDAId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgDlvAddress_GetListOfFCustChgDlvAddress()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCustCDAId,
dtmDoc

FROM 
BOS_AR_FCustChgDlvAddress;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgDlvAddress_IsFCustChgDlvAddressExist(
p_szFCustCDAId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCustCDAId

FROM 
BOS_AR_FCustChgDlvAddress
WHERE 
szFCustCDAId = p_szFCustCDAId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgDlvAddress_LockFCustChgDlvAddress(
p_szFCustCDAId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustChgDlvAddress
SET 
bTransferred = bTransferred
WHERE 
szFCustCDAId = p_szFCustCDAId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgDlvAddress_MarkFCustChgDlvAddressApplied(
p_szFCustCDAId BOS_DT_szId,
p_dtmDoc timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustChgDlvAddress
SET 
dtmDoc=p_dtmDoc,
bApplied=1
WHERE 
szFCustCDAId = p_szFCustCDAId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgDlvAddress_MarkFCustChgDlvAddressVoid(
p_szFCustCDAId BOS_DT_szId,
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_Ar_FCustChgDlvAddress
SET 
bVoid = 1,
bNeedApproval = 0,
gdApprovedId = p_gdApprovedId
WHERE 
szFCustCDAId = p_szFCustCDAId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgDlvAddress_UpdateFCustChgDlvAddress(
p_szFCustCDAId BOS_DT_szId,
p_szFCallId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_dtmDoc timestamp,
p_szCustId BOS_DT_szId,
p_szCustDeliveryNm BOS_DT_szName,
p_CustszContactPerson BOS_DT_szName,
p_CustszRoomNo BOS_DT_szSmallName,
p_CustszFloor BOS_DT_szSmallName,
p_CustszBuilding BOS_DT_szName,
p_CustszAddress_1 BOS_DT_szName,
p_CustszAddress_2 BOS_DT_szName,
p_CustszDistrict BOS_DT_szName,
p_CustszCity BOS_DT_szMediumName,
p_CustszZipCode BOS_DT_szSmallName,
p_CustszState BOS_DT_szMediumName,
p_CustszCountry BOS_DT_szMediumName,
p_CustszPhoneNo_1 BOS_DT_szMediumName,
p_CustszPhoneNo_2 BOS_DT_szMediumName,
p_CustszFaxNo BOS_DT_szMediumName,
p_CustszMobileNo BOS_DT_szMediumName,
p_CustszEmail BOS_DT_szMediumName,
p_CustszWebSite BOS_DT_szMediumName,
p_bIsDiffDeliveryAddress bit,
p_DeliveryszContactPerson BOS_DT_szName,
p_DeliveryszRoomNo BOS_DT_szSmallName,
p_DeliveryszFloor BOS_DT_szSmallName,
p_DeliveryszBuilding BOS_DT_szName,
p_DeliveryszAddress_1 BOS_DT_szName,
p_DeliveryszAddress_2 BOS_DT_szName,
p_DeliveryszDistrict BOS_DT_szName,
p_DeliveryszCity BOS_DT_szMediumName,
p_DeliveryszZipCode BOS_DT_szSmallName,
p_DeliveryszState BOS_DT_szMediumName,
p_DeliveryszCountry BOS_DT_szMediumName,
p_DeliveryszPhoneNo_1 BOS_DT_szMediumName,
p_DeliveryszPhoneNo_2 BOS_DT_szMediumName,
p_DeliveryszFaxNo BOS_DT_szMediumName,
p_DeliveryszMobileNo BOS_DT_szMediumName,
p_DeliveryszEmail BOS_DT_szMediumName,
p_DeliveryszWebSite BOS_DT_szMediumName,
p_szRemark BOS_DT_szDescription,
p_szDlvWorkPlaceId BOS_DT_szId,
p_bIsMultiLocation bit,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustChgDlvAddress
SET 
szSalesOrgId = p_szSalesOrgId,
szFCallId = p_szFCallId,
dtmDoc = p_dtmDoc,
szCustId = p_szCustId,
szCustDeliveryNm = p_szCustDeliveryNm,
bIsDiffDeliveryAddress = p_bIsDiffDeliveryAddress,

CustszContactPerson = p_CustszContactPerson,
CustszRoomNo = p_CustszRoomNo,
CustszFloor = p_CustszFloor,
CustszBuilding = p_CustszBuilding,
CustszAddress_1 = p_CustszAddress_1,
CustszAddress_2 = p_CustszAddress_2,
CustszDistrict = p_CustszDistrict,
CustszCity = p_CustszCity,
CustszZipCode = p_CustszZipCode,
CustszState = p_CustszState,
CustszCountry = p_CustszCountry,
CustszPhoneNo_1 = p_CustszPhoneNo_1,
CustszPhoneNo_2 = p_CustszPhoneNo_2,
CustszFaxNo = p_CustszFaxNo,
CustszMobileNo = p_CustszMobileNo,
CustszEmail = p_CustszEmail,
CustszWebSite = p_CustszWebSite,

DeliveryszContactPerson = p_DeliveryszContactPerson,
DeliveryszRoomNo = p_DeliveryszRoomNo,
DeliveryszFloor = p_DeliveryszFloor,
DeliveryszBuilding = p_DeliveryszBuilding,
DeliveryszAddress_1 = p_DeliveryszAddress_1,
DeliveryszAddress_2 = p_DeliveryszAddress_2,
DeliveryszDistrict = p_DeliveryszDistrict,
DeliveryszCity = p_DeliveryszCity,
DeliveryszZipCode = p_DeliveryszZipCode,
DeliveryszState = p_DeliveryszState,
DeliveryszCountry = p_DeliveryszCountry,
DeliveryszPhoneNo_1 = p_DeliveryszPhoneNo_1,
DeliveryszPhoneNo_2 = p_DeliveryszPhoneNo_2,
DeliveryszFaxNo = p_DeliveryszFaxNo,
DeliveryszMobileNo = p_DeliveryszMobileNo,
DeliveryszEmail = p_DeliveryszEmail,
DeliveryszWebSite = p_DeliveryszWebSite,
szDlvWorkPlaceId = p_szDlvWorkPlaceId,

szRemark = p_szRemark,
bIsMultiLocation = p_bIsMultiLocation,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
dtmCreated = p_dtmCreated,
bSystemCreated = p_bSystemCreated,
szUserId = p_szUserId

WHERE 
szFCustCDAId = p_szFCustCDAId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgInvAddress_CreateFCustChgInvAddress(
p_szFCustCIAId BOS_DT_szId,
p_szFCallId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_dtmDoc timestamp,
p_szCustId BOS_DT_szId,
p_szCustInvoiceNm BOS_DT_szName,
p_szCustTaxNm BOS_DT_szName,
p_szCustCollectNm BOS_DT_szName,
p_CustszContactPerson BOS_DT_szName,
p_CustszRoomNo BOS_DT_szSmallName,
p_CustszFloor BOS_DT_szSmallName,
p_CustszBuilding BOS_DT_szName,
p_CustszAddress_1 BOS_DT_szName,
p_CustszAddress_2 BOS_DT_szName,
p_CustszDistrict BOS_DT_szName,
p_CustszCity BOS_DT_szMediumName,
p_CustszZipCode BOS_DT_szSmallName,
p_CustszState BOS_DT_szMediumName,
p_CustszCountry BOS_DT_szMediumName,
p_CustszPhoneNo_1 BOS_DT_szMediumName,
p_CustszPhoneNo_2 BOS_DT_szMediumName,
p_CustszFaxNo BOS_DT_szMediumName,
p_CustszMobileNo BOS_DT_szMediumName,
p_CustszEmail BOS_DT_szMediumName,
p_CustszWebSite BOS_DT_szMediumName,
p_bIsDiffInvoiceAddress bit,
p_InvoiceszContactPerson BOS_DT_szName,
p_InvoiceszRoomNo BOS_DT_szSmallName,
p_InvoiceszFloor BOS_DT_szSmallName,
p_InvoiceszBuilding BOS_DT_szName,
p_InvoiceszAddress_1 BOS_DT_szName,
p_InvoiceszAddress_2 BOS_DT_szName,
p_InvoiceszDistrict BOS_DT_szName,
p_InvoiceszCity BOS_DT_szMediumName,
p_InvoiceszZipCode BOS_DT_szSmallName,
p_InvoiceszState BOS_DT_szMediumName,
p_InvoiceszCountry BOS_DT_szMediumName,
p_InvoiceszPhoneNo_1 BOS_DT_szMediumName,
p_InvoiceszPhoneNo_2 BOS_DT_szMediumName,
p_InvoiceszFaxNo BOS_DT_szMediumName,
p_InvoiceszMobileNo BOS_DT_szMediumName,
p_InvoiceszEmail BOS_DT_szMediumName,
p_InvoiceszWebSite BOS_DT_szMediumName,
p_bIsDiffTaxAddress bit,
p_TaxszContactPerson BOS_DT_szName,
p_TaxszRoomNo BOS_DT_szSmallName,
p_TaxszFloor BOS_DT_szSmallName,
p_TaxszBuilding BOS_DT_szName,
p_TaxszAddress_1 BOS_DT_szName,
p_TaxszAddress_2 BOS_DT_szName,
p_TaxszDistrict BOS_DT_szName,
p_TaxszCity BOS_DT_szMediumName,
p_TaxszZipCode BOS_DT_szSmallName,
p_TaxszState BOS_DT_szMediumName,
p_TaxszCountry BOS_DT_szMediumName,
p_TaxszPhoneNo_1 BOS_DT_szMediumName,
p_TaxszPhoneNo_2 BOS_DT_szMediumName,
p_TaxszFaxNo BOS_DT_szMediumName,
p_TaxszMobileNo BOS_DT_szMediumName,
p_TaxszEmail BOS_DT_szMediumName,
p_TaxszWebSite BOS_DT_szMediumName,
p_bIsDiffCollectAddress bit,
p_CollectszContactPerson BOS_DT_szName,
p_CollectszRoomNo BOS_DT_szSmallName,
p_CollectszFloor BOS_DT_szSmallName,
p_CollectszBuilding BOS_DT_szName,
p_CollectszAddress_1 BOS_DT_szName,
p_CollectszAddress_2 BOS_DT_szName,
p_CollectszDistrict BOS_DT_szName,
p_CollectszCity BOS_DT_szMediumName,
p_CollectszZipCode BOS_DT_szSmallName,
p_CollectszState BOS_DT_szMediumName,
p_CollectszCountry BOS_DT_szMediumName,
p_CollectszPhoneNo_1 BOS_DT_szMediumName,
p_CollectszPhoneNo_2 BOS_DT_szMediumName,
p_CollectszFaxNo BOS_DT_szMediumName,
p_CollectszMobileNo BOS_DT_szMediumName,
p_CollectszEmail BOS_DT_szMediumName,
p_CollectszWebSite BOS_DT_szMediumName,
p_szRemark BOS_DT_szDescription,
p_szInvWorkPlaceId BOS_DT_szId,
p_szCollWorkPlaceId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustChgInvAddress
(
szFCustCIAId,
szFCallId,
szSalesOrgId,
dtmDoc,
szCustId,
szCustInvoiceNm,
szCustTaxNm,
szCustCollectNm,
CustszContactPerson ,
CustszRoomNo ,
CustszFloor ,
CustszBuilding ,
CustszAddress_1 ,
CustszAddress_2 ,
CustszDistrict ,
CustszCity ,
CustszZipCode ,
CustszState ,
CustszCountry ,
CustszPhoneNo_1 ,
CustszPhoneNo_2 ,
CustszFaxNo ,
CustszMobileNo ,
CustszEmail ,
CustszWebSite ,
bIsDiffInvoiceAddress,
InvoiceszContactPerson,
InvoiceszRoomNo,
InvoiceszFloor,
InvoiceszBuilding,
InvoiceszAddress_1,
InvoiceszAddress_2,
InvoiceszDistrict,
InvoiceszCity,
InvoiceszZipCode,
InvoiceszState,
InvoiceszCountry,
InvoiceszPhoneNo_1,
InvoiceszPhoneNo_2,
InvoiceszFaxNo,
InvoiceszMobileNo,
InvoiceszEmail,
InvoiceszWebSite,
bIsDiffTaxAddress,
TaxszContactPerson,
TaxszRoomNo,
TaxszFloor,
TaxszBuilding,
TaxszAddress_1,
TaxszAddress_2,
TaxszDistrict,
TaxszCity,
TaxszZipCode,
TaxszState,
TaxszCountry,
TaxszPhoneNo_1,
TaxszPhoneNo_2,
TaxszFaxNo,
TaxszMobileNo,
TaxszEmail,
TaxszWebSite,
bIsDiffCollectAddress,
CollectszContactPerson,
CollectszRoomNo,
CollectszFloor,
CollectszBuilding,
CollectszAddress_1,
CollectszAddress_2,
CollectszDistrict,
CollectszCity,
CollectszZipCode,
CollectszState,
CollectszCountry,
CollectszPhoneNo_1,
CollectszPhoneNo_2,
CollectszFaxNo,
CollectszMobileNo,
CollectszEmail,
CollectszWebSite,
szRemark,
szInvWorkPlaceId,
szCollWorkPlaceId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkPlaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated ,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFCustCIAId,
p_szFCallId,
p_szSalesOrgId,
p_dtmDoc,
p_szCustId,
p_szCustInvoiceNm,
p_szCustTaxNm,
p_szCustCollectNm,
p_CustszContactPerson ,
p_CustszRoomNo ,
p_CustszFloor ,
p_CustszBuilding ,
p_CustszAddress_1 ,
p_CustszAddress_2 ,
p_CustszDistrict ,
p_CustszCity ,
p_CustszZipCode ,
p_CustszState ,
p_CustszCountry ,
p_CustszPhoneNo_1 ,
p_CustszPhoneNo_2 ,
p_CustszFaxNo ,
p_CustszMobileNo ,
p_CustszEmail ,
p_CustszWebSite ,
p_bIsDiffInvoiceAddress,
p_InvoiceszContactPerson,
p_InvoiceszRoomNo,
p_InvoiceszFloor,
p_InvoiceszBuilding,
p_InvoiceszAddress_1,
p_InvoiceszAddress_2,
p_InvoiceszDistrict,
p_InvoiceszCity,
p_InvoiceszZipCode,
p_InvoiceszState,
p_InvoiceszCountry,
p_InvoiceszPhoneNo_1,
p_InvoiceszPhoneNo_2,
p_InvoiceszFaxNo,
p_InvoiceszMobileNo,
p_InvoiceszEmail,
p_InvoiceszWebSite,
p_bIsDiffTaxAddress,
p_TaxszContactPerson,
p_TaxszRoomNo,
p_TaxszFloor,
p_TaxszBuilding,
p_TaxszAddress_1,
p_TaxszAddress_2,
p_TaxszDistrict,
p_TaxszCity,
p_TaxszZipCode,
p_TaxszState,
p_TaxszCountry,
p_TaxszPhoneNo_1,
p_TaxszPhoneNo_2,
p_TaxszFaxNo,
p_TaxszMobileNo,
p_TaxszEmail,
p_TaxszWebSite,
p_bIsDiffCollectAddress,
p_CollectszContactPerson,
p_CollectszRoomNo,
p_CollectszFloor,
p_CollectszBuilding,
p_CollectszAddress_1,
p_CollectszAddress_2,
p_CollectszDistrict,
p_CollectszCity,
p_CollectszZipCode,
p_CollectszState,
p_CollectszCountry,
p_CollectszPhoneNo_1,
p_CollectszPhoneNo_2,
p_CollectszFaxNo,
p_CollectszMobileNo,
p_CollectszEmail,
p_CollectszWebSite,
p_szRemark,
p_szInvWorkPlaceId ,
p_szCollWorkPlaceId ,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkPlaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated ,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated ,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgInvAddress_DeleteFCustChgInvAddress(
p_szFCustCIAId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_AR_FCustChgInvAddress
WHERE
szFCustCIAId = p_szFCustCIAId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgInvAddress_GetFCustChgInvAddress(
p_szFCustCIAId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

select
BOS_AR_FCustChgInvAddress.szFCustCIAId,
BOS_AR_FCustChgInvAddress.szFCallId,
BOS_AR_FCustChgInvAddress.szSalesOrgId,
BOS_AR_FCustChgInvAddress.dtmDoc,
BOS_AR_FCustChgInvAddress.szCustId,
BOS_AR_Customer.szName as szCustNm,
BOS_AR_FCustChgInvAddress.szCustInvoiceNm,
BOS_AR_FCustChgInvAddress.szCustTaxNm,
BOS_AR_FCustChgInvAddress.szCustCollectNm,

BOS_AR_FCustChgInvAddress.bIsDiffInvoiceAddress,

BOS_AR_FCustChgInvAddress.InvoiceszContactPerson,
BOS_AR_FCustChgInvAddress.InvoiceszRoomNo,
BOS_AR_FCustChgInvAddress.InvoiceszFloor,
BOS_AR_FCustChgInvAddress.InvoiceszBuilding,
BOS_AR_FCustChgInvAddress.InvoiceszAddress_1,
BOS_AR_FCustChgInvAddress.InvoiceszAddress_2,
BOS_AR_FCustChgInvAddress.InvoiceszDistrict,
BOS_AR_FCustChgInvAddress.InvoiceszCity,
BOS_AR_FCustChgInvAddress.InvoiceszZipCode,
BOS_AR_FCustChgInvAddress.InvoiceszState,
BOS_AR_FCustChgInvAddress.InvoiceszCountry,
BOS_AR_FCustChgInvAddress.InvoiceszPhoneNo_1,
BOS_AR_FCustChgInvAddress.InvoiceszPhoneNo_2,
BOS_AR_FCustChgInvAddress.InvoiceszFaxNo,
BOS_AR_FCustChgInvAddress.InvoiceszMobileNo,
BOS_AR_FCustChgInvAddress.InvoiceszEmail,
BOS_AR_FCustChgInvAddress.InvoiceszWebSite,

BOS_AR_FCustChgInvAddress.CustszContactPerson ,
BOS_AR_FCustChgInvAddress.CustszRoomNo ,
BOS_AR_FCustChgInvAddress.CustszFloor ,
BOS_AR_FCustChgInvAddress.CustszBuilding ,
BOS_AR_FCustChgInvAddress.CustszAddress_1 ,
BOS_AR_FCustChgInvAddress.CustszAddress_2 ,
BOS_AR_FCustChgInvAddress.CustszDistrict ,
BOS_AR_FCustChgInvAddress.CustszCity ,
BOS_AR_FCustChgInvAddress.CustszZipCode ,
BOS_AR_FCustChgInvAddress.CustszState ,
BOS_AR_FCustChgInvAddress.CustszCountry ,
BOS_AR_FCustChgInvAddress.CustszPhoneNo_1 ,
BOS_AR_FCustChgInvAddress.CustszPhoneNo_2 ,
BOS_AR_FCustChgInvAddress.CustszFaxNo ,
BOS_AR_FCustChgInvAddress.CustszMobileNo ,
BOS_AR_FCustChgInvAddress.CustszEmail ,
BOS_AR_FCustChgInvAddress.CustszWebSite ,

BOS_AR_FCustChgInvAddress.bIsDiffTaxAddress,

BOS_AR_FCustChgInvAddress.TaxszContactPerson,
BOS_AR_FCustChgInvAddress.TaxszRoomNo,
BOS_AR_FCustChgInvAddress.TaxszFloor,
BOS_AR_FCustChgInvAddress.TaxszBuilding,
BOS_AR_FCustChgInvAddress.TaxszAddress_1,
BOS_AR_FCustChgInvAddress.TaxszAddress_2,
BOS_AR_FCustChgInvAddress.TaxszDistrict,
BOS_AR_FCustChgInvAddress.TaxszCity,
BOS_AR_FCustChgInvAddress.TaxszZipCode,
BOS_AR_FCustChgInvAddress.TaxszState,
BOS_AR_FCustChgInvAddress.TaxszCountry,
BOS_AR_FCustChgInvAddress.TaxszPhoneNo_1,
BOS_AR_FCustChgInvAddress.TaxszPhoneNo_2,
BOS_AR_FCustChgInvAddress.TaxszFaxNo,
BOS_AR_FCustChgInvAddress.TaxszMobileNo,
BOS_AR_FCustChgInvAddress.TaxszEmail,
BOS_AR_FCustChgInvAddress.TaxszWebSite,

BOS_AR_FCustChgInvAddress.bIsDiffCollectAddress,

BOS_AR_FCustChgInvAddress.CollectszContactPerson,
BOS_AR_FCustChgInvAddress.CollectszRoomNo,
BOS_AR_FCustChgInvAddress.CollectszFloor,
BOS_AR_FCustChgInvAddress.CollectszBuilding,
BOS_AR_FCustChgInvAddress.CollectszAddress_1,
BOS_AR_FCustChgInvAddress.CollectszAddress_2,
BOS_AR_FCustChgInvAddress.CollectszDistrict,
BOS_AR_FCustChgInvAddress.CollectszCity,
BOS_AR_FCustChgInvAddress.CollectszZipCode,
BOS_AR_FCustChgInvAddress.CollectszState,
BOS_AR_FCustChgInvAddress.CollectszCountry,
BOS_AR_FCustChgInvAddress.CollectszPhoneNo_1,
BOS_AR_FCustChgInvAddress.CollectszPhoneNo_2,
BOS_AR_FCustChgInvAddress.CollectszFaxNo,
BOS_AR_FCustChgInvAddress.CollectszMobileNo,
BOS_AR_FCustChgInvAddress.CollectszEmail,
BOS_AR_FCustChgInvAddress.CollectszWebSite,

BOS_AR_FCustChgInvAddress.szRemark,
BOS_AR_FCustChgInvAddress.szInvWorkPlaceId ,
BOS_AR_FCustChgInvAddress.szCollWorkPlaceId ,
BOS_AR_FCustChgInvAddress.bResultFrTransfer,
BOS_AR_FCustChgInvAddress.bVoid,
BOS_GEN_Approved.bApproved,
BOS_AR_FCustChgInvAddress.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_AR_FCustChgInvAddress.btPrintedCount,
BOS_AR_FCustChgInvAddress.bTransferred,
BOS_AR_FCustChgInvAddress.szCompanyId,
BOS_AR_FCustChgInvAddress.szWorkPlaceId,
BOS_AR_FCustChgInvAddress.szTaxEntityId,
BOS_AR_FCustChgInvAddress.bNeedApproval, 
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_AR_FCustChgInvAddress.dtmCreated, 
BOS_AR_FCustChgInvAddress.bSystemCreated,
BOS_GL_Company.szName as szCompanyNm ,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_AR_FCustChgInvAddress.dtmLastUpdated,
BOS_AR_FCustChgInvAddress.bAlreadyTransferred,
BOS_AR_FCustChgInvAddress.szUserId,
BOS_SM_User.szName AS szUserNm_J	

From
(BOS_AR_FCustChgInvAddress left join BOS_GEN_Approved on BOS_AR_FCustChgInvAddress.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
LEFT JOIN BOS_GL_FJournalTrans ON BOS_AR_FCustChgInvAddress.szFJournalId=BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_AR_FCustChgInvAddress.szCustId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkPlaceId = BOS_AR_FCustChgInvAddress.szWorkPlaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId= BOS_AR_FCustChgInvAddress.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_AR_FCustChgInvAddress.szUserId

where
szFCustCIAId = p_szFCustCIAId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgInvAddress_GetListOfFCustChgInvAddress()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCustCIAId,
dtmDoc

FROM 
BOS_AR_FCustChgInvAddress;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgInvAddress_IsFCustChgInvAddressExist(
p_szFCustCIAId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCustCIAId

FROM 
BOS_AR_FCustChgInvAddress
WHERE 
szFCustCIAId = p_szFCustCIAId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgInvAddress_LockFCustChgInvAddress(
p_szFCustCIAId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustChgInvAddress
SET 
bTransferred = bTransferred
WHERE 
szFCustCIAId = p_szFCustCIAId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgInvAddress_MarkFCustChgInvAddressApplied(
p_szFCustCIAId BOS_DT_szId,
p_dtmDoc timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustChgInvAddress
SET 
bApplied=1,
dtmDoc =p_dtmDoc
WHERE 
szFCustCIAId = p_szFCustCIAId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgInvAddress_MarkFCustChgInvAddressVoid(
p_szFCustCIAId BOS_DT_szId,
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_Ar_FCustChgInvAddress
SET 
bVoid = 1,
bNeedApproval = 0,
gdApprovedId = p_gdApprovedId
WHERE 
szFCustCIAId = p_szFCustCIAId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgInvAddress_UpdateFCustChgInvAddress(
p_szFCustCIAId BOS_DT_szId,
p_szFCallId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_dtmDoc timestamp,
p_szCustId BOS_DT_szId,
p_szCustInvoiceNm BOS_DT_szName,
p_szCustTaxNm BOS_DT_szName,
p_szCustCollectNm BOS_DT_szName,
p_CustszContactPerson BOS_DT_szName,
p_CustszRoomNo BOS_DT_szSmallName,
p_CustszFloor BOS_DT_szSmallName,
p_CustszBuilding BOS_DT_szName,
p_CustszAddress_1 BOS_DT_szName,
p_CustszAddress_2 BOS_DT_szName,
p_CustszDistrict BOS_DT_szName,
p_CustszCity BOS_DT_szMediumName,
p_CustszZipCode BOS_DT_szSmallName,
p_CustszState BOS_DT_szMediumName,
p_CustszCountry BOS_DT_szMediumName,
p_CustszPhoneNo_1 BOS_DT_szMediumName,
p_CustszPhoneNo_2 BOS_DT_szMediumName,
p_CustszFaxNo BOS_DT_szMediumName,
p_CustszMobileNo BOS_DT_szMediumName,
p_CustszEmail BOS_DT_szMediumName,
p_CustszWebSite BOS_DT_szMediumName,
p_bIsDiffInvoiceAddress bit,
p_InvoiceszContactPerson BOS_DT_szName,
p_InvoiceszRoomNo BOS_DT_szSmallName,
p_InvoiceszFloor BOS_DT_szSmallName,
p_InvoiceszBuilding BOS_DT_szName,
p_InvoiceszAddress_1 BOS_DT_szName,
p_InvoiceszAddress_2 BOS_DT_szName,
p_InvoiceszDistrict BOS_DT_szName,
p_InvoiceszCity BOS_DT_szMediumName,
p_InvoiceszZipCode BOS_DT_szSmallName,
p_InvoiceszState BOS_DT_szMediumName,
p_InvoiceszCountry BOS_DT_szMediumName,
p_InvoiceszPhoneNo_1 BOS_DT_szMediumName,
p_InvoiceszPhoneNo_2 BOS_DT_szMediumName,
p_InvoiceszFaxNo BOS_DT_szMediumName,
p_InvoiceszMobileNo BOS_DT_szMediumName,
p_InvoiceszEmail BOS_DT_szMediumName,
p_InvoiceszWebSite BOS_DT_szMediumName,
p_bIsDiffTaxAddress bit,
p_TaxszContactPerson BOS_DT_szName,
p_TaxszRoomNo BOS_DT_szSmallName,
p_TaxszFloor BOS_DT_szSmallName,
p_TaxszBuilding BOS_DT_szName,
p_TaxszAddress_1 BOS_DT_szName,
p_TaxszAddress_2 BOS_DT_szName,
p_TaxszDistrict BOS_DT_szName,
p_TaxszCity BOS_DT_szMediumName,
p_TaxszZipCode BOS_DT_szSmallName,
p_TaxszState BOS_DT_szMediumName,
p_TaxszCountry BOS_DT_szMediumName,
p_TaxszPhoneNo_1 BOS_DT_szMediumName,
p_TaxszPhoneNo_2 BOS_DT_szMediumName,
p_TaxszFaxNo BOS_DT_szMediumName,
p_TaxszMobileNo BOS_DT_szMediumName,
p_TaxszEmail BOS_DT_szMediumName,
p_TaxszWebSite BOS_DT_szMediumName,
p_bIsDiffCollectAddress bit,
p_CollectszContactPerson BOS_DT_szName,
p_CollectszRoomNo BOS_DT_szSmallName,
p_CollectszFloor BOS_DT_szSmallName,
p_CollectszBuilding BOS_DT_szName,
p_CollectszAddress_1 BOS_DT_szName,
p_CollectszAddress_2 BOS_DT_szName,
p_CollectszDistrict BOS_DT_szName,
p_CollectszCity BOS_DT_szMediumName,
p_CollectszZipCode BOS_DT_szSmallName,
p_CollectszState BOS_DT_szMediumName,
p_CollectszCountry BOS_DT_szMediumName,
p_CollectszPhoneNo_1 BOS_DT_szMediumName,
p_CollectszPhoneNo_2 BOS_DT_szMediumName,
p_CollectszFaxNo BOS_DT_szMediumName,
p_CollectszMobileNo BOS_DT_szMediumName,
p_CollectszEmail BOS_DT_szMediumName,
p_CollectszWebSite BOS_DT_szMediumName,
p_szRemark BOS_DT_szDescription,
p_szInvWorkPlaceId BOS_DT_szId,
p_szCollWorkPlaceId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustChgInvAddress
SET 
szSalesOrgId = p_szSalesOrgId,
szFCallId = p_szFCallId,
dtmDoc = p_dtmDoc,
szCustId = p_szCustId,
szCustInvoiceNm = p_szCustInvoiceNm,
szCustTaxNm = p_szCustTaxNm,
szCustCollectNm = p_szCustCollectNm,

CustszContactPerson = p_CustszContactPerson,
CustszRoomNo = p_CustszRoomNo,
CustszFloor = p_CustszFloor,
CustszBuilding = p_CustszBuilding,
CustszAddress_1 = p_CustszAddress_1,
CustszAddress_2 = p_CustszAddress_2,
CustszDistrict = p_CustszDistrict,
CustszCity = p_CustszCity,
CustszZipCode = p_CustszZipCode,
CustszState = p_CustszState,
CustszCountry = p_CustszCountry,
CustszPhoneNo_1 = p_CustszPhoneNo_1,
CustszPhoneNo_2 = p_CustszPhoneNo_2,
CustszFaxNo = p_CustszFaxNo,
CustszMobileNo = p_CustszMobileNo,
CustszEmail = p_CustszEmail,
CustszWebSite = p_CustszWebSite,

bIsDiffInvoiceAddress = p_bIsDiffInvoiceAddress,

InvoiceszContactPerson = p_InvoiceszContactPerson,
InvoiceszRoomNo = p_InvoiceszRoomNo,
InvoiceszFloor = p_InvoiceszFloor,
InvoiceszBuilding = p_InvoiceszBuilding,
InvoiceszAddress_1 = p_InvoiceszAddress_1,
InvoiceszAddress_2 = p_InvoiceszAddress_2,
InvoiceszDistrict = p_InvoiceszDistrict,
InvoiceszCity = p_InvoiceszCity,
InvoiceszZipCode = p_InvoiceszZipCode,
InvoiceszState = p_InvoiceszState,
InvoiceszCountry = p_InvoiceszCountry,
InvoiceszPhoneNo_1 = p_InvoiceszPhoneNo_1,
InvoiceszPhoneNo_2 = p_InvoiceszPhoneNo_2,
InvoiceszFaxNo = p_InvoiceszFaxNo,
InvoiceszMobileNo = p_InvoiceszMobileNo,
InvoiceszEmail = p_InvoiceszEmail,
InvoiceszWebSite = p_InvoiceszWebSite,

bIsDiffTaxAddress = p_bIsDiffTaxAddress,

TaxszContactPerson = p_TaxszContactPerson,
TaxszRoomNo = p_TaxszRoomNo,
TaxszFloor = p_TaxszFloor,
TaxszBuilding = p_TaxszBuilding,
TaxszAddress_1 = p_TaxszAddress_1,
TaxszAddress_2 = p_TaxszAddress_2,
TaxszDistrict = p_TaxszDistrict,
TaxszCity = p_TaxszCity,
TaxszZipCode = p_TaxszZipCode,
TaxszState = p_TaxszState,
TaxszCountry = p_TaxszCountry,
TaxszPhoneNo_1 = p_TaxszPhoneNo_1,
TaxszPhoneNo_2 = p_TaxszPhoneNo_2,
TaxszFaxNo = p_TaxszFaxNo,
TaxszMobileNo = p_TaxszMobileNo,
TaxszEmail = p_TaxszEmail,
TaxszWebSite = p_TaxszWebSite,

bIsDiffCollectAddress = p_bIsDiffCollectAddress,

CollectszContactPerson = p_CollectszContactPerson,
CollectszRoomNo = p_CollectszRoomNo,
CollectszFloor = p_CollectszFloor,
CollectszBuilding = p_CollectszBuilding,
CollectszAddress_1 = p_CollectszAddress_1,
CollectszAddress_2 = p_CollectszAddress_2,
CollectszDistrict = p_CollectszDistrict,
CollectszCity = p_CollectszCity,
CollectszZipCode = p_CollectszZipCode,
CollectszState = p_CollectszState,
CollectszCountry = p_CollectszCountry,
CollectszPhoneNo_1 = p_CollectszPhoneNo_1,
CollectszPhoneNo_2 = p_CollectszPhoneNo_2,
CollectszFaxNo = p_CollectszFaxNo,
CollectszMobileNo = p_CollectszMobileNo,
CollectszEmail = p_CollectszEmail,
CollectszWebSite = p_CollectszWebSite,

szRemark = p_szRemark,
szInvWorkPlaceId = p_szInvWorkPlaceId,
szCollWorkPlaceId = p_szCollWorkPlaceId,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
dtmCreated = p_dtmCreated ,
bSystemCreated = p_bSystemCreated,
szUserId = p_szUserId

WHERE 
szFCustCIAId = p_szFCustCIAId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgSalesCfg_CreateFCustChgSalesCfg(
p_szFCustCSCId BOS_DT_szId,
p_szFCallId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_dtmDoc timestamp,
p_szCustId BOS_DT_szId,
p_bAllowToCredit bit,
p_decCreditLimit BOS_DT_decAmount,
p_szPaymentTermId BOS_DT_szId,
p_szInvoicingProcessId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szRemark BOS_DT_szDescription,
p_bInvoiceNote bit,
p_bNoVatApplied BOS_DT_bBoolean,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_bCheckMaxDropSize BOS_DT_bBoolean,
p_intMaxCountOpenInv smallint,
p_bCheckMinDropSize BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustChgSalesCfg
(
szFCustCSCId,
szFCallId,
szSalesOrgId,
dtmDoc,
szCustId,
bAllowToCredit,
decCreditLimit,
szPaymentTermId,
szInvoicingProcessId,
szPriceId,
szPriceOrderId,
szRemark,
bInvoiceNote,
bNoVatApplied,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkPlaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated ,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
szPromoPriceId,
szPromoPriceOrderId,
bCheckMaxDropSize,
intMaxCountOpenInv,
bCheckMinDropSize
)
VALUES
(
p_szFCustCSCId,
p_szFCallId,
p_szSalesOrgId,
p_dtmDoc,
p_szCustId,
p_bAllowToCredit,
p_decCreditLimit,
p_szPaymentTermId,
p_szInvoicingProcessId,
p_szPriceId,
p_szPriceOrderId,
p_szRemark,
p_bInvoiceNote,
p_bNoVatApplied,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkPlaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated ,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szPromoPriceId,
p_szPromoPriceOrderId,
p_bCheckMaxDropSize,
p_intMaxCountOpenInv,
p_bCheckMinDropSize
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgSalesCfg_CreateFCustChgSalesCfg_013(
p_szFCustCSCId BOS_DT_szId,
p_szFCallId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_dtmDoc timestamp,
p_szCustId BOS_DT_szId,
p_bAllowToCredit bit,
p_decCreditLimit BOS_DT_decAmount,
p_szPaymentTermId BOS_DT_szId,
p_szInvoicingProcessId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szRemark BOS_DT_szDescription,
p_bInvoiceNote bit,
p_bNoVatApplied BOS_DT_bBoolean,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_bCheckMaxDropSize BOS_DT_bBoolean,
p_intMaxCountOpenInv smallint,
p_bCheckMinDropSize BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustChgSalesCfg
(
szFCustCSCId,
szFCallId,
szSalesOrgId,
dtmDoc,
szCustId,
bAllowToCredit,
decCreditLimit,
szPaymentTermId,
szInvoicingProcessId,
szPriceId,
szPriceOrderId,
szRemark,
bInvoiceNote,
bNoVatApplied,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkPlaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated ,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
szPromoPriceId,
szPromoPriceOrderId,
bCheckMaxDropSize,
intMaxCountOpenInv,
bCheckMinDropSize
)
VALUES
(
p_szFCustCSCId,
p_szFCallId,
p_szSalesOrgId,
p_dtmDoc,
p_szCustId,
p_bAllowToCredit,
p_decCreditLimit,
p_szPaymentTermId,
p_szInvoicingProcessId,
p_szPriceId,
p_szPriceOrderId,
p_szRemark,
p_bInvoiceNote,
p_bNoVatApplied,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkPlaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated ,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szPromoPriceId,
p_szPromoPriceOrderId,
p_bCheckMaxDropSize,
p_intMaxCountOpenInv,
p_bCheckMinDropSize
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgSalesCfg_DeleteFCustChgSalesCfg(
p_szFCustCSCId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgSalesCfg_GetFCustChgSalesCfg(
p_szFCustCSCId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_AR_FCustChgSalesCfg.szFCustCSCId,
BOS_AR_FCustChgSalesCfg.szFCallId,
BOS_AR_FCustChgSalesCfg.szSalesOrgId,
BOS_AR_FCustChgSalesCfg.dtmDoc,
BOS_AR_FCustChgSalesCfg.szCustId,
BOS_AR_Customer.szName as szCustNm,
BOS_AR_FCustChgSalesCfg.bAllowToCredit,
BOS_AR_FCustChgSalesCfg.decCreditLimit,
BOS_AR_Customer.szDefaultCcyId AS szDefaultCcyId_J,
BOS_CU_Currency.szAmountFormat AS szDefaultCcyAmountFormat_J,
BOS_AR_FCustChgSalesCfg.szPaymentTermId,
BOS_AR_FCustChgSalesCfg.szInvoicingProcessId,
BOS_AR_FCustChgSalesCfg.szPriceId,
BOS_AR_FCustChgSalesCfg.szPriceOrderId,
BOS_AR_FCustChgSalesCfg.szRemark,
BOS_AR_FCustChgSalesCfg.bInvoiceNote,
BOS_AR_FCustChgSalesCfg.bNoVatApplied,
BOS_AR_FCustChgSalesCfg.bResultFrTransfer,
BOS_AR_FCustChgSalesCfg.bVoid,
BOS_GEN_Approved.bApproved,
BOS_AR_FCustChgSalesCfg.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_AR_FCustChgSalesCfg.btPrintedCount,
BOS_AR_FCustChgSalesCfg.bTransferred,
BOS_AR_FCustChgSalesCfg.szCompanyId,
BOS_AR_FCustChgSalesCfg.szWorkPlaceId,
BOS_AR_FCustChgSalesCfg.szTaxEntityId,
BOS_AR_FCustChgSalesCfg.bNeedApproval, 
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_AR_FCustChgSalesCfg.dtmCreated,
BOS_AR_FCustChgSalesCfg.bSystemCreated,
null as szCompanyNm ,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_AR_FCustChgSalesCfg.dtmLastUpdated,
BOS_AR_FCustChgSalesCfg.bAlreadyTransferred,
BOS_AR_FCustChgSalesCfg.szUserId,
BOS_SM_User.szName as szUserNm_J,

BOS_AR_FCustChgSalesCfg.szPromoPriceId,
BOS_AR_FCustChgSalesCfg.szPromoPriceOrderId,

BOS_AR_FCustChgSalesCfg.bCheckMaxDropSize,
BOS_AR_FCustChgSalesCfg.intMaxCountOpenInv,
BOS_AR_FCustChgSalesCfg.bCheckMinDropSize

FROM
(BOS_AR_FCustChgSalesCfg
LEFT join BOS_GEN_Approved on BOS_AR_FCustChgSalesCfg.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
LEFT JOIN BOS_GL_FJournalTrans ON BOS_AR_FCustChgSalesCfg.szFJournalId=BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_AR_FCustChgSalesCfg.szCustId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_Customer.szDefaultCcyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkPlaceId = BOS_AR_FCustChgSalesCfg.szWorkPlaceId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_AR_FCustChgSalesCfg.szUserId

WHERE
szFCustCSCId=p_szFCustCSCId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgSalesCfg_GetFCustChgSalesCfg_014(
p_szFCustCSCId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_AR_FCustChgSalesCfg.szFCustCSCId,
BOS_AR_FCustChgSalesCfg.szFCallId,
BOS_AR_FCustChgSalesCfg.szSalesOrgId,
BOS_AR_FCustChgSalesCfg.dtmDoc,
BOS_AR_FCustChgSalesCfg.szCustId,
BOS_AR_Customer.szName as szCustNm,
BOS_AR_FCustChgSalesCfg.bAllowToCredit,
BOS_AR_FCustChgSalesCfg.decCreditLimit,
BOS_AR_Customer.szDefaultCcyId AS szDefaultCcyId_J,
BOS_CU_Currency.szAmountFormat AS szDefaultCcyAmountFormat_J,
BOS_AR_FCustChgSalesCfg.szPaymentTermId,
BOS_AR_FCustChgSalesCfg.szInvoicingProcessId,
BOS_AR_FCustChgSalesCfg.szPriceId,
BOS_AR_FCustChgSalesCfg.szPriceOrderId,
BOS_AR_FCustChgSalesCfg.szRemark,
BOS_AR_FCustChgSalesCfg.bInvoiceNote,
BOS_AR_FCustChgSalesCfg.bNoVatApplied,
BOS_AR_FCustChgSalesCfg.bResultFrTransfer,
BOS_AR_FCustChgSalesCfg.bVoid,
BOS_GEN_Approved.bApproved,
BOS_AR_FCustChgSalesCfg.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_AR_FCustChgSalesCfg.btPrintedCount,
BOS_AR_FCustChgSalesCfg.bTransferred,
BOS_AR_FCustChgSalesCfg.szCompanyId,
BOS_AR_FCustChgSalesCfg.szWorkPlaceId,
BOS_AR_FCustChgSalesCfg.szTaxEntityId,
BOS_AR_FCustChgSalesCfg.bNeedApproval, 
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_AR_FCustChgSalesCfg.dtmCreated,
BOS_AR_FCustChgSalesCfg.bSystemCreated,
null as szCompanyNm ,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_AR_FCustChgSalesCfg.dtmLastUpdated,
BOS_AR_FCustChgSalesCfg.bAlreadyTransferred,
BOS_AR_FCustChgSalesCfg.szUserId,
BOS_SM_User.szName as szUserNm_J,

BOS_AR_FCustChgSalesCfg.szPromoPriceId,
BOS_AR_FCustChgSalesCfg.szPromoPriceOrderId,

BOS_AR_FCustChgSalesCfg.bCheckMaxDropSize,
BOS_AR_FCustChgSalesCfg.intMaxCountOpenInv,
BOS_AR_FCustChgSalesCfg.bCheckMinDropSize

FROM
(BOS_AR_FCustChgSalesCfg
LEFT join BOS_GEN_Approved on BOS_AR_FCustChgSalesCfg.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
LEFT JOIN BOS_GL_FJournalTrans ON BOS_AR_FCustChgSalesCfg.szFJournalId=BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_AR_FCustChgSalesCfg.szCustId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_Customer.szDefaultCcyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkPlaceId = BOS_AR_FCustChgSalesCfg.szWorkPlaceId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_AR_FCustChgSalesCfg.szUserId

WHERE
szFCustCSCId=p_szFCustCSCId;


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgSalesCfg_GetListOfFCustChgSalesCfg()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCustCSCId,
dtmDoc,
szCustId

FROM 
BOS_AR_FCustChgSalesCfg;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgSalesCfg_IsFCustChgSalesCfgExist(
p_szFCustCSCId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCustCSCId

FROM 
BOS_AR_FCustChgSalesCfg
WHERE 
szFCustCSCId = p_szFCustCSCId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgSalesCfg_LockFCustChgSalesCfg(
p_szFCustCSCId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustChgSalesCfg
SET 
bInvoiceNote=bInvoiceNote
WHERE 
szFCustCSCId = p_szFCustCSCId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgSalesCfg_MarkFCustChgSalesCfgVoid(
p_szFCustCSCId BOS_DT_szId,
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_Ar_FCustChgSalesCfg
SET 
bVoid = 1,
bNeedApproval = 0,
gdApprovedId = p_gdApprovedId
WHERE 
szFCustCSCId = p_szFCustCSCId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgSalesCfg_UpdateFCustChgSalesCfg(
p_szFCustCSCId BOS_DT_szId,
p_szFCallId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_dtmDoc timestamp,
p_szCustId BOS_DT_szId,
p_bAllowToCredit bit,
p_decCreditLimit BOS_DT_decAmount,
p_szPaymentTermId BOS_DT_szId,
p_szInvoicingProcessId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szRemark BOS_DT_szDescription,
p_bInvoiceNote bit,
p_bNoVatApplied BOS_DT_bBoolean,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_bCheckMaxDropSize BOS_DT_bBoolean,
p_intMaxCountOpenInv smallint,
p_bCheckMinDropSize BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustChgSalesCfg
SET 
szSalesOrgId=p_szSalesOrgId,
szFCallId=p_szFCallId,
dtmDoc=p_dtmDoc,
szCustId=p_szCustId,
bAllowToCredit=p_bAllowToCredit,
decCreditLimit = p_decCreditLimit,
szPaymentTermId=p_szPaymentTermId,
szInvoicingProcessId=p_szInvoicingProcessId,
szPriceId=p_szPriceId,
szPriceOrderId=p_szPriceOrderId,
szRemark=p_szRemark,
bInvoiceNote=p_bInvoiceNote,
bNoVatApplied = p_bNoVatApplied,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
dtmCreated = p_dtmCreated ,
bSystemCreated = p_bSystemCreated,
szUserId = p_szUserId,

szPromoPriceId= p_szPromoPriceId,
szPromoPriceOrderId= p_szPromoPriceOrderId,

bCheckMaxDropSize= p_bCheckMaxDropSize,
intMaxCountOpenInv = p_intMaxCountOpenInv,
bCheckMinDropSize = p_bCheckMinDropSize

WHERE 
szFCustCSCId = p_szFCustCSCId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgSalesCfg_UpdateFCustChgSalesCfg_013(
p_szFCustCSCId BOS_DT_szId,
p_szFCallId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_dtmDoc timestamp,
p_szCustId BOS_DT_szId,
p_bAllowToCredit bit,
p_decCreditLimit BOS_DT_decAmount,
p_szPaymentTermId BOS_DT_szId,
p_szInvoicingProcessId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szRemark BOS_DT_szDescription,
p_bInvoiceNote bit,
p_bNoVatApplied BOS_DT_bBoolean,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_bCheckMaxDropSize BOS_DT_bBoolean,
p_intMaxCountOpenInv smallint,
p_bCheckMinDropSize BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustChgSalesCfg
SET 
szSalesOrgId=p_szSalesOrgId,
szFCallId=p_szFCallId,
dtmDoc=p_dtmDoc,
szCustId=p_szCustId,
bAllowToCredit=p_bAllowToCredit,
decCreditLimit = p_decCreditLimit,
szPaymentTermId=p_szPaymentTermId,
szInvoicingProcessId=p_szInvoicingProcessId,
szPriceId=p_szPriceId,
szPriceOrderId=p_szPriceOrderId,
szRemark=p_szRemark,
bInvoiceNote=p_bInvoiceNote,
bNoVatApplied = p_bNoVatApplied,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
dtmCreated = p_dtmCreated ,
bSystemCreated = p_bSystemCreated,
szUserId = p_szUserId,

szPromoPriceId= p_szPromoPriceId,
szPromoPriceOrderId= p_szPromoPriceOrderId,

bCheckMaxDropSize= p_bCheckMaxDropSize,
intMaxCountOpenInv = p_intMaxCountOpenInv,
bCheckMinDropSize = p_bCheckMinDropSize

WHERE 
szFCustCSCId = p_szFCustCSCId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgStatus_CreateFCustChgStatus(
p_szFCustChgStatusId BOS_DT_szId,
p_dtmFCustChgStatus timestamp,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustChgStatus
(
szFCustChgStatusId,
dtmFCustChgStatus,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFCustChgStatusId,
p_dtmFCustChgStatus,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgStatus_CreateFCustChgStatusItem(
p_szFCustChgStatusId BOS_DT_szId,
p_shItemNumber smallint,
p_szCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_decDueAR BOS_DT_decAmount,
p_decCurrentAR BOS_DT_decAmount,
p_szStatus varchar)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustChgStatusItem
(
szFCustChgStatusId,
shItemNumber,
szCustId,
szCcyId,
decDueAR,
decCurrentAR,
szStatus
)
VALUES
(
p_szFCustChgStatusId,
p_shItemNumber,
p_szCustId,
p_szCcyId,
p_decDueAR,
p_decCurrentAR,
p_szStatus
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgStatus_DeleteFCustChgStatus(
p_szFCustChgStatusId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_AR_FCustChgStatus
WHERE
szFCustChgStatusId = p_szFCustChgStatusId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgStatus_DeleteFCustChgStatusItem(
p_szFCustChgStatusId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_AR_FCustChgStatusItem
WHERE
szFCustChgStatusId = p_szFCustChgStatusId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgStatus_GetFCustChgStatus(
p_szFCustChgStatusId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

Select
dtmFCustChgStatus,

BOS_AR_FCustChgStatus.bResultFrTransfer,
BOS_AR_FCustChgStatus.bVoid,
BOS_GEN_Approved.bApproved,
BOS_AR_FCustChgStatus.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_AR_FCustChgStatus.btPrintedCount,
BOS_AR_FCustChgStatus.bTransferred,
BOS_AR_FCustChgStatus.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_AR_FCustChgStatus.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_AR_FCustChgStatus.szTaxEntityId,
BOS_AR_FCustChgStatus.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_AR_FCustChgStatus.dtmCreated,
BOS_AR_FCustChgStatus.bSystemCreated,

BOS_AR_FCustChgStatus.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_AR_FCustChgStatus.dtmLastUpdated,
BOS_AR_FCustChgStatus.bAlreadyTransferred

From 
BOS_AR_FCustChgStatus
LEFT JOIN BOS_GEN_Approved ON BOS_GEN_Approved.gdApprovedId = BOS_AR_FCustChgStatus.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_GL_FJournalTrans.szFJournalId = BOS_AR_FCustChgStatus.szFJournalId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_AR_FCustChgStatus.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustChgStatus.szWorkplaceId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_AR_FCustChgStatus.szUserId

Where 
szFCustChgStatusId = p_szFCustChgStatusId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgStatus_GetFCustChgStatusItem(
p_szFCustChgStatusId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_FCustChgStatusItem.szCustId,
BOS_AR_Customer.szName AS szCustName_J,
BOS_AR_Customer.szStatus AS szCurrStatus_J,

BOS_AR_FCustChgStatusItem.szCcyId,
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat_J,

BOS_AR_FCustChgStatusItem.decDueAR,
BOS_AR_FCustChgStatusItem.decCurrentAR,

BOS_AR_FCustChgStatusItem.szStatus AS szNewStatus


FROM 
BOS_AR_FCustChgStatusItem
Left Join BOS_AR_Customer On BOS_AR_FCustChgStatusItem.szCustId = BOS_AR_Customer.szCustId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustChgStatusItem.szCcyIdLEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustChgStatusItem.szCcyId

WHERE 
BOS_AR_FCustChgStatusItem.szFCustChgStatusId = p_szFCustChgStatusId 
ORDER BY 
BOS_AR_FCustChgStatusItem.szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgStatus_GetListOfFCustChgStatus()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCustChgStatusId,
dtmFCustChgStatus

FROM 
BOS_AR_FCustChgStatus;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgStatus_IsFCustChgStatusExist(
p_szFCustChgStatusId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCustChgStatusId

FROM 
BOS_AR_FCustChgStatus
WHERE 
szFCustChgStatusId = p_szFCustChgStatusId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgStatus_LockFCustChgStatus(
p_szFCustChgStatusId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustChgStatus
SET 
dtmFCustChgStatus = dtmFCustChgStatus
WHERE 
szFCustChgStatusId = p_szFCustChgStatusId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgStatus_MarkFCustChgStatusApplied(
p_szFCustChgStatusId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustChgStatus
SET 
bApplied = 1
WHERE 
szFCustChgStatusId = p_szFCustChgStatusId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgStatus_MarkFCustChgStatusVoid(
p_szFCustChgStatusId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustChgStatus
SET 
bVoid = 1
WHERE 
szFCustChgStatusId = p_szFCustChgStatusId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustChgStatus_UpdateFCustChgStatus(
p_szFCustChgStatusId BOS_DT_szId,
p_dtmFCustChgStatus timestamp,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId varchar,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustChgStatus
SET 
dtmFCustChgStatus = p_dtmFCustChgStatus,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFCustChgStatusId = p_szFCustChgStatusId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_CountUnAppliedFCustPayment(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
count(szFCustPaymentId) as iPaymentCount
FROM
BOS_AR_FCustPayment
WHERE
bVoid = 0 AND bApplied = 0 AND
dtmFCustPayment >= p_dtmFrom AND dtmFCustPayment < DATEADD(DAY, 1, p_dtmTo)
--AND BOS_AR_FCustPayment.szDeposanId = p_szOpUserId
AND BOS_AR_FCustPayment.szWorkplaceId = p_szWorkplaceId;
ELSE
SELECT
count(szFCustPaymentId) as iPaymentCount
FROM
BOS_AR_FCustPayment
WHERE
bVoid = 0 AND bApplied = 0 AND
dtmFCustPayment >= p_dtmFrom AND dtmFCustPayment < DATEADD(DAY, 1, p_dtmTo)
AND BOS_AR_FCustPayment.szDeposanId = p_szOpUserId
AND BOS_AR_FCustPayment.szWorkplaceId = p_szWorkplaceId;

END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_CountUnAppliedFCustPayment_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
count(szFCustPaymentId) as iPaymentCount
FROM
BOS_AR_FCustPayment
WHERE
bVoid = 0 AND bApplied = 0 AND
dtmFCustPayment >= p_dtmFrom AND dtmFCustPayment < DATEADD(DAY, 1, p_dtmTo)
--AND BOS_AR_FCustPayment.szDeposanId = p_szOpUserId
AND BOS_AR_FCustPayment.szWorkplaceId = p_szWorkplaceId;
ELSE
SELECT
count(szFCustPaymentId) as iPaymentCount
FROM
BOS_AR_FCustPayment
WHERE
bVoid = 0 AND bApplied = 0 AND
dtmFCustPayment >= p_dtmFrom AND dtmFCustPayment < DATEADD(DAY, 1, p_dtmTo)
AND BOS_AR_FCustPayment.szDeposanId = p_szOpUserId
AND BOS_AR_FCustPayment.szWorkplaceId = p_szWorkplaceId;


END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_CreateFCustPayment(
p_szFCustPaymentId BOS_DT_szId,
p_dtmFCustPayment timestamp,
p_szFCashReceiptId BOS_DT_szId,
p_szDeposanId BOS_DT_szId,
p_szAccountId1 BOS_DT_szId,
p_szSubAccountId1 BOS_DT_szGLAccount,
p_decAmount1 BOS_DT_decAmount,
p_szAccountId2 BOS_DT_szId,
p_szSubAccountId2 BOS_DT_szGLAccount,
p_decAmount2 BOS_DT_decAmount,
p_szAccountId3 BOS_DT_szId,
p_szSubAccountId3 BOS_DT_szGLAccount,
p_decAmount3 BOS_DT_decAmount,
p_szAccountId4 BOS_DT_szId,
p_szSubAccountId4 BOS_DT_szGLAccount,
p_decAmount4 BOS_DT_decAmount,
p_decAmount BOS_DT_decAmount,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustPayment
(
szFCustPaymentId,
dtmFCustPayment,
szFCashReceiptId,
szDeposanId,
szAccountId1,
szSubAccountId1,
decAmount1,
szAccountId2,
szSubAccountId2,
decAmount2,
szAccountId3,
szSubAccountId3,
decAmount3,
szAccountId4,
szSubAccountId4,
decAmount4,
decAmount,
szCcyId,
szCcyRateId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFCustPaymentId,
p_dtmFCustPayment,
p_szFCashReceiptId,
p_szDeposanId,
p_szAccountId1,
p_szSubAccountId1,
p_decAmount1,
p_szAccountId2,
p_szSubAccountId2,
p_decAmount2,
p_szAccountId3,
p_szSubAccountId3,
p_decAmount3,
p_szAccountId4,
p_szSubAccountId4,
p_decAmount4,
p_decAmount,
p_szCcyId,
p_szCcyRateId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_CreateFCustPayment_013(
p_szFCustPaymentId BOS_DT_szId,
p_dtmFCustPayment timestamp,
p_szFCashReceiptId BOS_DT_szId,
p_szDeposanId BOS_DT_szId,
p_szAccountId1 BOS_DT_szId,
p_szSubAccountId1 BOS_DT_szGLAccount,
p_decAmount1 BOS_DT_decAmount,
p_szAccountId2 BOS_DT_szId,
p_szSubAccountId2 BOS_DT_szGLAccount,
p_decAmount2 BOS_DT_decAmount,
p_szAccountId3 BOS_DT_szId,
p_szSubAccountId3 BOS_DT_szGLAccount,
p_decAmount3 BOS_DT_decAmount,
p_szAccountId4 BOS_DT_szId,
p_szSubAccountId4 BOS_DT_szGLAccount,
p_decAmount4 BOS_DT_decAmount,
p_decAmount BOS_DT_decAmount,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustPayment
(
szFCustPaymentId,
dtmFCustPayment,
szFCashReceiptId,
szDeposanId,
szAccountId1,
szSubAccountId1,
decAmount1,
szAccountId2,
szSubAccountId2,
decAmount2,
szAccountId3,
szSubAccountId3,
decAmount3,
szAccountId4,
szSubAccountId4,
decAmount4,
decAmount,
szCcyId,
szCcyRateId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFCustPaymentId,
p_dtmFCustPayment,
p_szFCashReceiptId,
p_szDeposanId,
p_szAccountId1,
p_szSubAccountId1,
p_decAmount1,
p_szAccountId2,
p_szSubAccountId2,
p_decAmount2,
p_szAccountId3,
p_szSubAccountId3,
p_decAmount3,
p_szAccountId4,
p_szSubAccountId4,
p_decAmount4,
p_decAmount,
p_szCcyId,
p_szCcyRateId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_CreateFCustPaymentItem(
p_szFCustPaymentId BOS_DT_szId,
p_shItemNumber smallint,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_decPaidByCashReceipt BOS_DT_decAmount,
p_szFDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustPaymentItem
(
szFCustPaymentId,
shItemNumber,
szTrnId,
szDocId,
szCustId,
decAmount,
decPaidByCashReceipt,
szFDoId
)
VALUES
(
p_szFCustPaymentId,
p_shItemNumber,
p_szTrnId,
p_szDocId,
p_szCustId,
p_decAmount,
p_decPaidByCashReceipt,
p_szFDoId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_CreateFCustPaymentItem_013(
p_szFCustPaymentId BOS_DT_szId,
p_shItemNumber smallint,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_decPaidByCashReceipt BOS_DT_decAmount,
p_szFDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustPaymentItem
(
szFCustPaymentId,
shItemNumber,
szTrnId,
szDocId,
szCustId,
decAmount,
decPaidByCashReceipt,
szFDoId
)
VALUES
(
p_szFCustPaymentId,
p_shItemNumber,
p_szTrnId,
p_szDocId,
p_szCustId,
p_decAmount,
p_decPaidByCashReceipt,
p_szFDoId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_CreateFCustPaymentItemDetail(
p_szFCustPaymentId BOS_DT_szId,
p_shItemNumber smallint,
p_shDetailNumber smallint,
p_szBankId BOS_DT_szId,
p_szRefDocId BOS_DT_szId,
p_bValue smallint,
p_decAmount BOS_DT_decAmount,
p_bDeposit smallint,
p_szReasonId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustPaymentItemDetail
(
szFCustPaymentId,
shItemNumber,
shDetailNumber,
szBankId,
szRefDocId,
bValue,
decAmount,
bDeposit,
szReasonId
)
VALUES
(
p_szFCustPaymentId,
p_shItemNumber,
p_shDetailNumber,
p_szBankId,
p_szRefDocId,
p_bValue,
p_decAmount,
p_bDeposit,
p_szReasonId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_CreateFCustPaymentItemDetail_013(
p_szFCustPaymentId BOS_DT_szId,
p_shItemNumber smallint,
p_shDetailNumber smallint,
p_szBankId BOS_DT_szId,
p_szRefDocId BOS_DT_szId,
p_bValue smallint,
p_decAmount BOS_DT_decAmount,
p_bDeposit smallint,
p_szReasonId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_FCustPaymentItemDetail
(
szFCustPaymentId,
shItemNumber,
shDetailNumber,
szBankId,
szRefDocId,
bValue,
decAmount,
bDeposit,
szReasonId
)
VALUES
(
p_szFCustPaymentId,
p_shItemNumber,
p_shDetailNumber,
p_szBankId,
p_szRefDocId,
p_bValue,
p_decAmount,
p_bDeposit,
p_szReasonId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_DeleteFCustPayment(
p_szFCustPaymentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_AR_FCustPayment
WHERE
 szFCustPaymentId = p_szFCustPaymentId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_DeleteFCustPaymentItem(
p_szFCustPaymentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_AR_FCustPaymentItem
WHERE
 szFCustPaymentId = p_szFCustPaymentId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_DeleteFCustPaymentItemDetail(
p_szFCustPaymentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_AR_FCustPaymentItemDetail
WHERE
 szFCustPaymentId = p_szFCustPaymentId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_GetAmountOfUnsettledPdr(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szFCustPaymentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
sum(BOS_AR_FCustPaymentItemDetail.decAmount) as decAmount

FROM 
BOS_AR_FCustPayment
Inner Join BOS_AR_FCustPaymentItem On BOS_AR_FCustPayment.szFCustPaymentId = BOS_AR_FCustPaymentItem.szFCustPaymentId
Inner Join BOS_AR_FCustPaymentItemDetail On BOS_AR_FCustPaymentItem.szFCustPaymentId = BOS_AR_FCustPaymentItemDetail.szFCustPaymentId And
BOS_AR_FCustPaymentItem.shItemNumber = BOS_AR_FCustPaymentItemDetail.shItemNumber
Left Join BOS_CAS_Pdr on
BOS_CAS_Pdr.szBankId = BOS_AR_FCustPaymentItemDetail.szBankId and
BOS_CAS_Pdr.szRefId = BOS_AR_FCustPaymentItemDetail.szRefDocId
WHERE 
BOS_AR_FCustPaymentItem.szTrnId = p_szTrnId And BOS_AR_FCustPaymentItem.szDocId = p_szDocId And BOS_AR_FCustPayment.bApplied = 1 and BOS_AR_FCustPaymentItemDetail.bValue = 0 and BOS_CAS_Pdr.szStatus <> 'CLE' and BOS_CAS_Pdr.szStatus <> 'REJ' and BOS_CAS_Pdr.szStatus <> 'CAN' and BOS_AR_FCustPayment.szFCustPaymentId <> p_szFCustPaymentId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_GetAmountOfUnsettledPdr_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szFCustPaymentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
sum(BOS_AR_FCustPaymentItemDetail.decAmount) as decAmount

FROM 
BOS_AR_FCustPayment
Inner Join BOS_AR_FCustPaymentItem On BOS_AR_FCustPayment.szFCustPaymentId = BOS_AR_FCustPaymentItem.szFCustPaymentId
Inner Join BOS_AR_FCustPaymentItemDetail On BOS_AR_FCustPaymentItem.szFCustPaymentId = BOS_AR_FCustPaymentItemDetail.szFCustPaymentId And
BOS_AR_FCustPaymentItem.shItemNumber = BOS_AR_FCustPaymentItemDetail.shItemNumber
Left Join BOS_CAS_Pdr on
BOS_CAS_Pdr.szBankId = BOS_AR_FCustPaymentItemDetail.szBankId and
BOS_CAS_Pdr.szRefId = BOS_AR_FCustPaymentItemDetail.szRefDocId
WHERE 
BOS_AR_FCustPaymentItem.szTrnId = p_szTrnId And BOS_AR_FCustPaymentItem.szDocId = p_szDocId And BOS_AR_FCustPayment.bApplied = 1 and BOS_AR_FCustPaymentItemDetail.bValue = 0 and BOS_CAS_Pdr.szStatus <> 'CLE' and BOS_CAS_Pdr.szStatus <> 'REJ' and BOS_CAS_Pdr.szStatus <> 'CAN' and BOS_AR_FCustPayment.szFCustPaymentId <> p_szFCustPaymentId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_GetFCustPayment(
p_szFCustPaymentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

Select
BOS_AR_FCustPayment.dtmFCustPayment,
BOS_AR_FCustPayment.szFCashReceiptId,
BOS_AR_FCustPayment.szDeposanId,
BOS_PI_Employee.szName as szDeposanNm,

BOS_AR_FCustPayment.szAccountId1,
BOS_AR_FCustPayment.szSubAccountId1,
BOS_AR_FCustPayment.decAmount1,

BOS_AR_FCustPayment.szAccountId2,
BOS_AR_FCustPayment.szSubAccountId2,
BOS_AR_FCustPayment.decAmount2,

BOS_AR_FCustPayment.szAccountId3,
BOS_AR_FCustPayment.szSubAccountId3,
BOS_AR_FCustPayment.decAmount3,

BOS_AR_FCustPayment.szAccountId4,
BOS_AR_FCustPayment.szSubAccountId4,
BOS_AR_FCustPayment.decAmount4,

Acc1.szName as szAccName1_J,
SubAcc1.szDescription as szSubAccName1_J,

Acc2.szName as szAccName2_J,
SubAcc2.szDescription as szSubAccName2_J,

Acc3.szName as szAccName3_J,
SubAcc3.szDescription as szSubAccName3_J,

Acc4.szName as szAccName4_J,
SubAcc4.szDescription as szSubAccName4_J,

BOS_AR_FCustPayment.decAmount,

BOS_AR_FCustPayment.szCcyId,
BOS_CU_Currency.szSymbol as szCcySymbol,
BOS_CU_Currency.szAmountFormat,

BOS_AR_FCustPayment.szCcyRateId,

BOS_AR_FCustPayment.bResultFrTransfer,
BOS_AR_FCustPayment.bVoid,
BOS_GEN_Approved.bApproved,
BOS_AR_FCustPayment.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_AR_FCustPayment.btPrintedCount,
BOS_AR_FCustPayment.bTransferred,
BOS_AR_FCustPayment.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_AR_FCustPayment.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_AR_FCustPayment.szTaxEntityId,
BOS_AR_FCustPayment.bNeedApproval,
BOS_AR_FCustPayment.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_AR_FCustPayment.dtmCreated,
BOS_AR_FCustPayment.bSystemCreated,
BOS_AR_FCustPayment.szUserId,
BOS_SM_User.szName AS szUserNm_J,

BOS_AR_FCustPayment.dtmLastUpdated,
BOS_AR_FCustPayment.bAlreadyTransferred

From
BOS_AR_FCustPayment
LEFT JOIN BOS_GEN_Approved ON BOS_AR_FCustPayment.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_AR_FCustPayment.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustPayment.szDeposanId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustPayment.szCcyId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_AR_FCustPayment.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustPayment.szWorkplaceId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_AR_FCustPayment.szUserId

LEFT JOIN BOS_GL_Account AS Acc1 ON Acc1.szAccountId = BOS_AR_FCustPayment.szAccountId1
LEFT JOIN BOS_GL_GLSubAcc AS SubAcc1 ON SubAcc1.szGLSubAccId = BOS_AR_FCustPayment.szSubAccountId1

LEFT JOIN BOS_GL_Account AS Acc2 ON Acc2.szAccountId = BOS_AR_FCustPayment.szAccountId2
LEFT JOIN BOS_GL_GLSubAcc AS SubAcc2 ON SubAcc2.szGLSubAccId = BOS_AR_FCustPayment.szSubAccountId2

LEFT JOIN BOS_GL_Account AS Acc3 ON Acc3.szAccountId = BOS_AR_FCustPayment.szAccountId3
LEFT JOIN BOS_GL_GLSubAcc AS SubAcc3 ON SubAcc3.szGLSubAccId = BOS_AR_FCustPayment.szSubAccountId3

LEFT JOIN BOS_GL_Account AS Acc4 ON Acc4.szAccountId = BOS_AR_FCustPayment.szAccountId4
LEFT JOIN BOS_GL_GLSubAcc AS SubAcc4 ON SubAcc4.szGLSubAccId = BOS_AR_FCustPayment.szSubAccountId4

Where
BOS_AR_FCustPayment.szFCustPaymentId = p_szFCustPaymentId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_GetFCustPaymentItem(
p_szFCustPaymentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

Select
BOS_AR_FCustPaymentItem.shItemNumber,
BOS_AR_FCustPaymentItem.szTrnId,
BOS_AR_FCustPaymentItem.szDocId,
BOS_AR_FCustPaymentItem.szCustId,
BOS_AR_Customer.szName As szCustNm,
BOS_AR_FCustPaymentItem.decAmount,
BOS_AR_FCustPaymentItem.decPaidByCashReceipt,
BOS_AR_FCustPaymentItem.szFDoId

From 
BOS_AR_FCustPaymentItem 
LEFT JOIN BOS_AR_ArTrans ON BOS_AR_FCustPaymentItem.szTrnId = BOS_AR_ArTrans.szTrnId 
And BOS_AR_FCustPaymentItem.szDocId = BOS_AR_ArTrans.szDocId 
And BOS_AR_FCustPaymentItem.szCustId = BOS_AR_ArTrans.szCustId
LEFT JOIN BOS_AR_Customer ON BOS_AR_FCustPaymentItem.szCustId = BOS_AR_Customer.szCustId

Where 
BOS_AR_FCustPaymentItem.szFCustPaymentId = p_szFCustPaymentId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_GetFCustPaymentItemDetail(
p_szFCustPaymentId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_FCustPaymentItemDetail.szFCustPaymentId,
BOS_AR_FCustPaymentItemDetail.shItemNumber,
BOS_AR_FCustPaymentItemDetail.shDetailNumber,
BOS_AR_FCustPaymentItemDetail.szBankId,
COALESCE(BOS_CAS_Bank.szName, '') As szBankName,
BOS_AR_FCustPaymentItemDetail.szRefDocId,
BOS_AR_FCustPaymentItemDetail.bValue,
BOS_AR_FCustPaymentItemDetail.decAmount,
BOS_AR_FCustPaymentItemDetail.bDeposit,
BOS_AR_FCustPaymentItemDetail.szReasonId


FROM 
BOS_AR_FCustPaymentItemDetail
Left Join BOS_CAS_Bank On BOS_AR_FCustPaymentItemDetail.szBankId = BOS_CAS_Bank.szBankId
WHERE 
BOS_AR_FCustPaymentItemDetail.szFCustPaymentId = p_szFCustPaymentId and BOS_AR_FCustPaymentItemDetail.shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_GetFCustPaymentItemDetail_014(
p_szFCustPaymentId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_FCustPaymentItemDetail.szFCustPaymentId,
BOS_AR_FCustPaymentItemDetail.shItemNumber,
BOS_AR_FCustPaymentItemDetail.shDetailNumber,
BOS_AR_FCustPaymentItemDetail.szBankId,
COALESCE(BOS_CAS_Bank.szName, '') As szBankName,
BOS_AR_FCustPaymentItemDetail.szRefDocId,
BOS_AR_FCustPaymentItemDetail.bValue,
BOS_AR_FCustPaymentItemDetail.decAmount,
BOS_AR_FCustPaymentItemDetail.bDeposit,
BOS_AR_FCustPaymentItemDetail.szReasonId


FROM 
BOS_AR_FCustPaymentItemDetail
Left Join BOS_CAS_Bank On BOS_AR_FCustPaymentItemDetail.szBankId = BOS_CAS_Bank.szBankId
WHERE 
BOS_AR_FCustPaymentItemDetail.szFCustPaymentId = p_szFCustPaymentId and BOS_AR_FCustPaymentItemDetail.shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_GetListOfArTransTobePaid(
p_szDeposanId BOS_DT_szId,
p_dtmDate timestamp)
RETURNS void AS
$BODY$
BEGIN

Select
BAT.szTrnId,
BAT.szDocId,
BAT.szCustId,
BOS_AR_Customer.szName As szCustName,
BAT.decRemain As decArAmount --Remaining of AR

From
BOS_AR_ARTrans As BAT
Left Join BOS_AR_Customer On BAT.szCustId = BOS_AR_Customer.szCustId
Left Join BOS_SD_CjrTracking On BAT.szTrnId = BOS_SD_CjrTracking.szTrnId And BAT.szDocId = BOS_SD_CjrTracking.szDocId
Left Join BOS_SD_FCjrItem On BOS_SD_CjrTracking.szFCjrId = BOS_SD_FCjrItem.szFCjrId And 
BOS_SD_CjrTracking.szCjrTrackingId = BOS_SD_FCjrItem.szCjrTrackingId

Where
BAT.decRemain > 0 And
BAT.decAmount > 0 And
BAT.bClosed = 0 And
BAT.szDocId in (select distinct BST.szDocId
from BOS_SD_FCjr as BSC inner join BOS_SD_FCjrItem as BSCI on BSC.szFCjrId = BSCI.szFCjrId
inner join BOS_SD_CJrTracking as BST on BSCI.szCjrTrackingId = BST.szCjrTrackingId
where BST.szCollectorId = p_szDeposanId And BSC.dtmFCjr >= p_dtmDate AND
BSC.dtmFCjr < DATEADD(DAY, 1, p_dtmDate))

Order By
BOS_SD_CjrTracking.szFCjrId,
BOS_SD_FCjrItem.shItemNumber;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_GetListOfArTransTobePaidFDjr(
p_szDeposanId BOS_DT_szId,
p_dtmDate timestamp)
RETURNS void AS
$BODY$
BEGIN

Select
BAT.szTrnId,
BAT.szDocId,
BAT.szCustId,
BOS_AR_Customer.szName As szCustName,
BAT.decRemain As decArAmount
From
BOS_AR_ARTrans As BAT
Left Join BOS_AR_Customer On BAT.szCustId = BOS_AR_Customer.szCustId
Where
BAT.decRemain > 0 And
BAT.decAmount > 0 And
BAT.bClosed = 0 And
BAT.szCustId in 
(
select distinct BST.szCustId
from BOS_SD_FDjr as BSD inner join BOS_SD_FDjrItem as BSDI on BSD.szFDjrId = BSDI.szFDjrId
inner join BOS_SD_DJrTracking as BST on BSDI.szDjrTrackingId = BST.szDjrTrackingId
where BST.szDriverId = p_szDeposanId And BSD.dtmFDjr >= p_dtmDate AND
BSD.dtmFDjr < DATEADD(DAY, 1, p_dtmDate)
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_GetListOfFCustPayment()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCustPaymentId, dtmFCustPayment, szFCashReceiptId

FROM 
BOS_AR_FCustPayment;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_GetListOfFCustPaymentItemDetailForPdr(
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BAPI.szTrnId,
BAPI.szDocId,
BAPI.szCustId,
BCP.szUnclearPdrAccId As szAccountId,
BCP.szUnclearPdrSubAccId As szSubAccountId,
BCP.szClearingAccId,
BCP.szClearingSubAccId,
BAT.decRemain As decAmount,
Sum(BAPID.decAmount) As decAmountPaid

FROM 
BOS_AR_FCustPaymentItemDetail As BAPID
Inner Join BOS_AR_FCustPaymentItem As BAPI On BAPID.szFCustPaymentId = BAPI.szFCustPaymentId And BAPID.shItemNumber = BAPI.shItemNumber
Inner Join BOS_AR_FCustPayment As BAP On BAPID.szFCustPaymentId = BAP.szFCustPaymentId
Inner Join BOS_AR_ArTrans As BAT On BAPI.szTrnId = BAT.szTrnId And BAPI.szDocId = BAT.szDocId And BAPI.szCustId = BAPI.szCustId And BAP.szCcyId = BAT.szCcyId
Inner Join BOS_CAS_Pdr As BCP On BAPID.szBankId = BCP.szBankId And BAPID.szRefDocId = BCP.szRefId
WHERE 
BAP.bApplied = 1 And BAPID.szBankId = p_szBankId And BAPID.szRefDocId = p_szRefId And BAPID.bValue = 0 Group By BAPI.szTrnId, BAPI.szDocId, BAPI.szCustId, BCP.szUnclearPdrAccId, BCP.szUnclearPdrSubAccId, BCP.szClearingAccId, BCP.szClearingSubAccId, BAT.decRemain ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_GetListOfFCustPaymentItemDetailForPdr_013(
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BAPI.szTrnId,
BAPI.szDocId,
BAPI.szCustId,
BCP.szUnclearPdrAccId As szAccountId,
BCP.szUnclearPdrSubAccId As szSubAccountId,
BCP.szClearingAccId,
BCP.szClearingSubAccId,
BAT.decRemain As decAmount,
Sum(BAPID.decAmount) As decAmountPaid

FROM 
BOS_AR_FCustPaymentItemDetail As BAPID
Inner Join BOS_AR_FCustPaymentItem As BAPI On BAPID.szFCustPaymentId = BAPI.szFCustPaymentId And BAPID.shItemNumber = BAPI.shItemNumber
Inner Join BOS_AR_FCustPayment As BAP On BAPID.szFCustPaymentId = BAP.szFCustPaymentId
Inner Join BOS_AR_ArTrans As BAT On BAPI.szTrnId = BAT.szTrnId And BAPI.szDocId = BAT.szDocId And BAPI.szCustId = BAPI.szCustId And BAP.szCcyId = BAT.szCcyId
Inner Join BOS_CAS_Pdr As BCP On BAPID.szBankId = BCP.szBankId And BAPID.szRefDocId = BCP.szRefId
WHERE 
BAP.bApplied = 1 And BAPID.szBankId = p_szBankId And BAPID.szRefDocId = p_szRefId And BAPID.bValue = 0 Group By BAPI.szTrnId, BAPI.szDocId, BAPI.szCustId, BCP.szUnclearPdrAccId, BCP.szUnclearPdrSubAccId, BCP.szClearingAccId, BCP.szClearingSubAccId, BAT.decRemain ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_GetListOfUnAppliedFCustPayment(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
szFCustPaymentId
FROM
BOS_AR_FCustPayment
WHERE
szWorkplaceId = p_szWorkplaceId AND
bVoid = 0 AND bApplied = 0 AND
dtmFCustPayment >= p_dtmFrom AND dtmFCustPayment < DATEADD(DAY, 1, p_dtmTo)
--AND BOS_AR_FCustPayment.szDeposanId = p_szOpUserId

order by dtmFCustPayment;
ELSE
SELECT
szFCustPaymentId
FROM
BOS_AR_FCustPayment
WHERE
szWorkplaceId = p_szWorkplaceId AND
bVoid = 0 AND bApplied = 0 AND
dtmFCustPayment >= p_dtmFrom AND dtmFCustPayment < DATEADD(DAY, 1, p_dtmTo)
AND BOS_AR_FCustPayment.szDeposanId = p_szOpUserId

order by dtmFCustPayment;

END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_GetListOfUnAppliedFCustPayment_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
szFCustPaymentId
FROM
BOS_AR_FCustPayment
WHERE
szWorkplaceId = p_szWorkplaceId AND
bVoid = 0 AND bApplied = 0 AND
dtmFCustPayment >= p_dtmFrom AND dtmFCustPayment < DATEADD(DAY, 1, p_dtmTo)
--AND BOS_AR_FCustPayment.szDeposanId = p_szOpUserId

order by dtmFCustPayment;
ELSE
SELECT
szFCustPaymentId
FROM
BOS_AR_FCustPayment
WHERE
szWorkplaceId = p_szWorkplaceId AND
bVoid = 0 AND bApplied = 0 AND
dtmFCustPayment >= p_dtmFrom AND dtmFCustPayment < DATEADD(DAY, 1, p_dtmTo)
AND BOS_AR_FCustPayment.szDeposanId = p_szOpUserId

order by dtmFCustPayment;


END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_IsFCustPaymentExist(
p_szFCustPaymentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCustPaymentId

FROM 
BOS_AR_FCustPayment
WHERE 
 szFCustPaymentId = p_szFCustPaymentId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_IsInvAssignedToOtherFCustPayment(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szFCustPaymentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_FCustPayment.szFCustPaymentId


FROM 
BOS_AR_FCustPayment
Inner Join BOS_AR_FCustPaymentItem On BOS_AR_FCustPayment.szFCustPaymentId = BOS_AR_FCustPaymentItem.szFCustPaymentId

WHERE 
BOS_AR_FCustPaymentItem.szTrnId = p_szTrnId And BOS_AR_FCustPaymentItem.szDocId = p_szDocId And BOS_AR_FCustPayment.szFCustPaymentId <> p_szFCustPaymentId And BOS_AR_FCustPayment.bVoid = 0 ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_IsInvAssignedToOtherFCustPayment_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szFCustPaymentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_FCustPayment.szFCustPaymentId


FROM 
BOS_AR_FCustPayment
Inner Join BOS_AR_FCustPaymentItem On BOS_AR_FCustPayment.szFCustPaymentId = BOS_AR_FCustPaymentItem.szFCustPaymentId

WHERE 
BOS_AR_FCustPaymentItem.szTrnId = p_szTrnId And BOS_AR_FCustPaymentItem.szDocId = p_szDocId And BOS_AR_FCustPayment.szFCustPaymentId <> p_szFCustPaymentId And BOS_AR_FCustPayment.bVoid = 0 ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_LockFCustPayment(
p_szFCustPaymentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustPayment
SET 
szDeposanId = szDeposanId
WHERE 
szFCustPaymentId = p_szFCustPaymentId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_MarkFCustPaymentApplied(
p_szFCustPaymentId BOS_DT_szId,
p_bApplied bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustPayment
SET 
 bApplied = p_bApplied
WHERE 
 szFCustPaymentId = p_szFCustPaymentId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_UpdateFCustPayment(
p_szFCustPaymentId BOS_DT_szId,
p_dtmFCustPayment timestamp,
p_szFCashReceiptId BOS_DT_szId,
p_szDeposanId BOS_DT_szId,
p_szAccountId1 BOS_DT_szId,
p_szSubAccountId1 BOS_DT_szGLAccount,
p_decAmount1 BOS_DT_decAmount,
p_szAccountId2 BOS_DT_szId,
p_szSubAccountId2 BOS_DT_szGLAccount,
p_decAmount2 BOS_DT_decAmount,
p_szAccountId3 BOS_DT_szId,
p_szSubAccountId3 BOS_DT_szGLAccount,
p_decAmount3 BOS_DT_decAmount,
p_szAccountId4 BOS_DT_szId,
p_szSubAccountId4 BOS_DT_szGLAccount,
p_decAmount4 BOS_DT_decAmount,
p_decAmount BOS_DT_decAmount,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustPayment
SET 
dtmFCustPayment = p_dtmFCustPayment,
szFCashReceiptId = p_szFCashReceiptId,
szDeposanId = p_szDeposanId,
szAccountId1 = p_szAccountId1,
szSubAccountId1 = p_szSubAccountId1,
decAmount1 = p_decAmount1,
szAccountId2 = p_szAccountId2,
szSubAccountId2 = p_szSubAccountId2,
decAmount2 = p_decAmount2,
szAccountId3 = p_szAccountId3,
szSubAccountId3 = p_szSubAccountId3,
decAmount3 = p_decAmount3,
szAccountId4 = p_szAccountId4,
szSubAccountId4 = p_szSubAccountId4,
decAmount4 = p_decAmount4,
decAmount = p_decAmount,
szCcyId = p_szCcyId,
szCcyRateId = p_szCcyRateId,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

, szFJournalId = p_szFJournalId

WHERE 
szFCustPaymentId = p_szFCustPaymentId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_FCustPayment_UpdateFCustPayment_013(
p_szFCustPaymentId BOS_DT_szId,
p_dtmFCustPayment timestamp,
p_szFCashReceiptId BOS_DT_szId,
p_szDeposanId BOS_DT_szId,
p_szAccountId1 BOS_DT_szId,
p_szSubAccountId1 BOS_DT_szGLAccount,
p_decAmount1 BOS_DT_decAmount,
p_szAccountId2 BOS_DT_szId,
p_szSubAccountId2 BOS_DT_szGLAccount,
p_decAmount2 BOS_DT_decAmount,
p_szAccountId3 BOS_DT_szId,
p_szSubAccountId3 BOS_DT_szGLAccount,
p_decAmount3 BOS_DT_decAmount,
p_szAccountId4 BOS_DT_szId,
p_szSubAccountId4 BOS_DT_szGLAccount,
p_decAmount4 BOS_DT_decAmount,
p_decAmount BOS_DT_decAmount,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_FCustPayment
SET 
dtmFCustPayment = p_dtmFCustPayment,
szFCashReceiptId = p_szFCashReceiptId,
szDeposanId = p_szDeposanId,
szAccountId1 = p_szAccountId1,
szSubAccountId1 = p_szSubAccountId1,
decAmount1 = p_decAmount1,
szAccountId2 = p_szAccountId2,
szSubAccountId2 = p_szSubAccountId2,
decAmount2 = p_decAmount2,
szAccountId3 = p_szAccountId3,
szSubAccountId3 = p_szSubAccountId3,
decAmount3 = p_decAmount3,
szAccountId4 = p_szAccountId4,
szSubAccountId4 = p_szSubAccountId4,
decAmount4 = p_decAmount4,
decAmount = p_decAmount,
szCcyId = p_szCcyId,
szCcyRateId = p_szCcyRateId,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

, szFJournalId = p_szFJournalId

WHERE 
szFCustPaymentId = p_szFCustPaymentId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_NonVatCust_GetNonVatCust(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
a.szProductId,
b.szName,
b.szNickName

FROM 
BOS_AR_NonVatCustItem a
Inner Join BOS_INV_Product b on a.szProductId = b.szProductId
WHERE 
a.szProductId = p_szProductId; --/** Cjr Tracking **/ set ANSI_NULLS ON ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_NonVatCust_IsNonVatCustExist(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
szProductId

FROM 
BOS_AR_NonVatCustItem
WHERE 
szProductId = p_szProductId; -- set ANSI_NULLS ON ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_NonVatCust_IsNonVatProdExist(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
szCustId

FROM 
BOS_AR_NonVatCustItem
WHERE 
szCustId = p_szCustId; -- set ANSI_NULLS ON ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_NonVatCustItem_CreateNonVatCustItem(
p_szProductId BOS_DT_szId,
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_NonVatCustItem
(
szProductId,
szCustId
)
VALUES
(
p_szProductId,
p_szCustId
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_NonVatCustItem_DeleteNonVatCustItem(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_AR_NonVatCustItem
WHERE
szProductId = p_szProductId;
-- ==================================================================
--set ANSI_NULLS ON;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_NonVatCustItem_GetNonVatCustItem(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
a.szCustId,
b.szName,
a.szProductId

FROM 
BOS_AR_NonVatCustItem a
Inner Join BOS_AR_Customer b on a.szCustId = b.szCustId
WHERE 
a.szProductId = p_szProductId;
-- set ANSI_NULLS ON ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_NonVatCustItem_IsNonVatCustExist(
p_szProductId BOS_DT_szId,
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId, szCustId

FROM 
BOS_AR_NonVatCustItem
WHERE 
szProductId = p_szProductId and szCustId = p_szCustId;
-- set ANSI_NULLS ON ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_PaymentTerm_CreatePaymentTerm(
p_szPaymentTermId BOS_DT_szId,
p_szFailCheckActionType BOS_DT_szSmallId,
p_szOpenBlockApprovalId BOS_DT_szId,
p_decOverLimitAmount_2 BOS_DT_decAmount,
p_szFailCheckActionType_2 BOS_DT_szSmallId,
p_szOpenBlockApprovalId_2 BOS_DT_szId,
p_decOverLimitAmount_3 BOS_DT_decAmount,
p_szFailCheckActionType_3 BOS_DT_szSmallId,
p_szOpenBlockApprovalId_3 BOS_DT_szId,
p_decOverLimitAmount_4 BOS_DT_decAmount,
p_szFailCheckActionType_4 BOS_DT_szSmallId,
p_szOpenBlockApprovalId_4 BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_intMaxPaymentDay integer,
p_intPrintedMaxPaymentDay integer,
p_intDayBeforeDueDateToSendInvoice integer,
p_szPaymentDelayPenalty varchar,
p_decPenalty BOS_DT_decAmount,
p_decFixPenalty BOS_DT_decAmount,
p_szPenaltyOrderItemTypeId BOS_DT_szId,
p_szAdvancePaymentIncentive varchar,
p_decIncentive BOS_DT_decAmount,
p_decFixIncentive BOS_DT_decAmount,
p_szIncentiveOrderItemTypeId BOS_DT_szId,
p_decMultipleFactor numeric,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_PaymentTerm
(
szPaymentTermId,
szFailCheckActionType,
szOpenBlockApprovalId,
decOverLimitAmount_2,
szFailCheckActionType_2,
szOpenBlockApprovalId_2,
decOverLimitAmount_3,
szFailCheckActionType_3,
szOpenBlockApprovalId_3,
decOverLimitAmount_4,
szFailCheckActionType_4,
szOpenBlockApprovalId_4,
szCcyId,
intMaxPaymentDay,
intPrintedMaxPaymentDay,
intDayBeforeDueDateToSendInvoice,
szPaymentDelayPenalty,
decPenalty,
decFixPenalty,
szPenaltyOrderItemTypeId,
szAdvancePaymentIncentive,
decIncentive,
decFixIncentive,
szIncentiveOrderItemTypeId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
-- Multiple Factor,
decMultipleFactor
)
VALUES
(
p_szPaymentTermId,
p_szFailCheckActionType,
p_szOpenBlockApprovalId,
p_decOverLimitAmount_2,
p_szFailCheckActionType_2,
p_szOpenBlockApprovalId_2,
p_decOverLimitAmount_3,
p_szFailCheckActionType_3,
p_szOpenBlockApprovalId_3,
p_decOverLimitAmount_4,
p_szFailCheckActionType_4,
p_szOpenBlockApprovalId_4,
p_szCcyId,
p_intMaxPaymentDay,
p_intPrintedMaxPaymentDay,
p_intDayBeforeDueDateToSendInvoice,
p_szPaymentDelayPenalty,
p_decPenalty,
p_decFixPenalty,
p_szPenaltyOrderItemTypeId,
p_szAdvancePaymentIncentive,
p_decIncentive,
p_decFixIncentive,
p_szIncentiveOrderItemTypeId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
-- Multiple Factor,
p_decMultipleFactor
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_PaymentTerm_CreatePaymentTerm_013(
p_szPaymentTermId BOS_DT_szId,
p_szFailCheckActionType BOS_DT_szSmallId,
p_szOpenBlockApprovalId BOS_DT_szId,
p_decOverLimitAmount_2 BOS_DT_decAmount,
p_szFailCheckActionType_2 BOS_DT_szSmallId,
p_szOpenBlockApprovalId_2 BOS_DT_szId,
p_decOverLimitAmount_3 BOS_DT_decAmount,
p_szFailCheckActionType_3 BOS_DT_szSmallId,
p_szOpenBlockApprovalId_3 BOS_DT_szId,
p_decOverLimitAmount_4 BOS_DT_decAmount,
p_szFailCheckActionType_4 BOS_DT_szSmallId,
p_szOpenBlockApprovalId_4 BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_intMaxPaymentDay integer,
p_intPrintedMaxPaymentDay integer,
p_intDayBeforeDueDateToSendInvoice integer,
p_szPaymentDelayPenalty varchar,
p_decPenalty BOS_DT_decAmount,
p_decFixPenalty BOS_DT_decAmount,
p_szPenaltyOrderItemTypeId BOS_DT_szId,
p_szAdvancePaymentIncentive varchar,
p_decIncentive BOS_DT_decAmount,
p_decFixIncentive BOS_DT_decAmount,
p_szIncentiveOrderItemTypeId BOS_DT_szId,
p_decMultipleFactor numeric,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_AR_PaymentTerm
(
szPaymentTermId,
szFailCheckActionType,
szOpenBlockApprovalId,
decOverLimitAmount_2,
szFailCheckActionType_2,
szOpenBlockApprovalId_2,
decOverLimitAmount_3,
szFailCheckActionType_3,
szOpenBlockApprovalId_3,
decOverLimitAmount_4,
szFailCheckActionType_4,
szOpenBlockApprovalId_4,
szCcyId,
intMaxPaymentDay,
intPrintedMaxPaymentDay,
intDayBeforeDueDateToSendInvoice,
szPaymentDelayPenalty,
decPenalty,
decFixPenalty,
szPenaltyOrderItemTypeId,
szAdvancePaymentIncentive,
decIncentive,
decFixIncentive,
szIncentiveOrderItemTypeId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
-- Multiple Factor,
decMultipleFactor
)
VALUES
(
p_szPaymentTermId,
p_szFailCheckActionType,
p_szOpenBlockApprovalId,
p_decOverLimitAmount_2,
p_szFailCheckActionType_2,
p_szOpenBlockApprovalId_2,
p_decOverLimitAmount_3,
p_szFailCheckActionType_3,
p_szOpenBlockApprovalId_3,
p_decOverLimitAmount_4,
p_szFailCheckActionType_4,
p_szOpenBlockApprovalId_4,
p_szCcyId,
p_intMaxPaymentDay,
p_intPrintedMaxPaymentDay,
p_intDayBeforeDueDateToSendInvoice,
p_szPaymentDelayPenalty,
p_decPenalty,
p_decFixPenalty,
p_szPenaltyOrderItemTypeId,
p_szAdvancePaymentIncentive,
p_decIncentive,
p_decFixIncentive,
p_szIncentiveOrderItemTypeId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
-- Multiple Factor,
p_decMultipleFactor
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_PaymentTerm_DeletePaymentTerm(
p_szPaymentTermId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE FROM BOS_AR_PaymentTerm
WHERE 
	szPaymentTermId = p_szPaymentTermId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_PaymentTerm_GetListOfPaymentTerm()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPaymentTermId,
szFailCheckActionType,
szCcyId


FROM 
BOS_AR_PaymentTerm;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_PaymentTerm_GetPaymentTerm(
p_szPaymentTermId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFailCheckActionType,
szOpenBlockApprovalId,

decOverLimitAmount_2,
szFailCheckActionType_2,
szOpenBlockApprovalId_2,

decOverLimitAmount_3,
szFailCheckActionType_3,
szOpenBlockApprovalId_3,

decOverLimitAmount_4,
szFailCheckActionType_4,
szOpenBlockApprovalId_4,

PT.szCcyId,
Cu.szAmountFormat as szCcyAmountFormat_J,

intMaxPaymentDay,
intPrintedMaxPaymentDay,
intDayBeforeDueDateToSendInvoice,
szPaymentDelayPenalty,
decPenalty,
decFixPenalty,
szPenaltyOrderItemTypeId,
szAdvancePaymentIncentive,
decIncentive,
decFixIncentive,
szIncentiveOrderItemTypeId,

-- Data Status.
PT.dtmLastUpdated,
PT.bAlreadyTransferred,

decMultipleFactor


FROM 
BOS_AR_PaymentTerm AS PT
LEFT JOIN BOS_CU_Currency AS Cu ON Cu.szCcyId = PT.szCcyIdLEFT JOIN BOS_CU_Currency AS Cu ON Cu.szCcyId = PT.szCcyId
WHERE 
szPaymentTermId = p_szPaymentTermId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_PaymentTerm_GetPaymentTerm_013(
p_szPaymentTermId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFailCheckActionType,
szOpenBlockApprovalId,

decOverLimitAmount_2,
szFailCheckActionType_2,
szOpenBlockApprovalId_2,

decOverLimitAmount_3,
szFailCheckActionType_3,
szOpenBlockApprovalId_3,

decOverLimitAmount_4,
szFailCheckActionType_4,
szOpenBlockApprovalId_4,

PT.szCcyId,
Cu.szAmountFormat as szCcyAmountFormat_J,

intMaxPaymentDay,
intPrintedMaxPaymentDay,
intDayBeforeDueDateToSendInvoice,
szPaymentDelayPenalty,
decPenalty,
decFixPenalty,
szPenaltyOrderItemTypeId,
szAdvancePaymentIncentive,
decIncentive,
decFixIncentive,
szIncentiveOrderItemTypeId,

-- Data Status.
PT.dtmLastUpdated,
PT.bAlreadyTransferred,

decMultipleFactor


FROM 
BOS_AR_PaymentTerm AS PT
LEFT JOIN BOS_CU_Currency AS Cu ON Cu.szCcyId = PT.szCcyIdLEFT JOIN BOS_CU_Currency AS Cu ON Cu.szCcyId = PT.szCcyId
WHERE 
szPaymentTermId = p_szPaymentTermId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_PaymentTerm_IsPaymentTermExist(
p_szPaymentTermId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPaymentTermId


FROM 
BOS_AR_PaymentTerm
WHERE 
szPaymentTermId = p_szPaymentTermId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_PaymentTerm_LockPaymentTerm(
p_szPaymentTermId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_PaymentTerm
SET 
decPenalty = decPenalty
WHERE 
szPaymentTermId = p_szPaymentTermId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_PaymentTerm_UpdatePaymentTerm(
p_szPaymentTermId BOS_DT_szId,
p_szFailCheckActionType BOS_DT_szSmallId,
p_szOpenBlockApprovalId BOS_DT_szId,
p_decOverLimitAmount_2 BOS_DT_decAmount,
p_szFailCheckActionType_2 BOS_DT_szSmallId,
p_szOpenBlockApprovalId_2 BOS_DT_szId,
p_decOverLimitAmount_3 BOS_DT_decAmount,
p_szFailCheckActionType_3 BOS_DT_szSmallId,
p_szOpenBlockApprovalId_3 BOS_DT_szId,
p_decOverLimitAmount_4 BOS_DT_decAmount,
p_szFailCheckActionType_4 BOS_DT_szSmallId,
p_szOpenBlockApprovalId_4 BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_intMaxPaymentDay integer,
p_intPrintedMaxPaymentDay integer,
p_intDayBeforeDueDateToSendInvoice integer,
p_szPaymentDelayPenalty varchar,
p_decPenalty BOS_DT_decAmount,
p_decFixPenalty BOS_DT_decAmount,
p_szPenaltyOrderItemTypeId BOS_DT_szId,
p_szAdvancePaymentIncentive varchar,
p_decIncentive BOS_DT_decAmount,
p_decFixIncentive BOS_DT_decAmount,
p_szIncentiveOrderItemTypeId BOS_DT_szId,
p_decMultipleFactor numeric)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_PaymentTerm
SET 
szFailCheckActionType = p_szFailCheckActionType,
szOpenBlockApprovalId = p_szOpenBlockApprovalId,

decOverLimitAmount_2 = p_decOverLimitAmount_2,
szFailCheckActionType_2 = p_szFailCheckActionType_2,
szOpenBlockApprovalId_2 = p_szOpenBlockApprovalId_2,

decOverLimitAmount_3 = p_decOverLimitAmount_3,
szFailCheckActionType_3 = p_szFailCheckActionType_3,
szOpenBlockApprovalId_3 = p_szOpenBlockApprovalId_3,

decOverLimitAmount_4 = p_decOverLimitAmount_4,
szFailCheckActionType_4 = p_szFailCheckActionType_4,
szOpenBlockApprovalId_4 = p_szOpenBlockApprovalId_4,

szCcyId = p_szCcyId,
intMaxPaymentDay = p_intMaxPaymentDay,
intPrintedMaxPaymentDay = p_intPrintedMaxPaymentDay,
intDayBeforeDueDateToSendInvoice = p_intDayBeforeDueDateToSendInvoice,
szPaymentDelayPenalty = p_szPaymentDelayPenalty,
decPenalty = p_decPenalty,
decFixPenalty = p_decFixPenalty,
szPenaltyOrderItemTypeId = p_szPenaltyOrderItemTypeId,
szAdvancePaymentIncentive= p_szAdvancePaymentIncentive,
decIncentive = p_decIncentive,
decFixIncentive = p_decFixIncentive,
szIncentiveOrderItemTypeId = p_szIncentiveOrderItemTypeId,
decMultipleFactor = p_decMultipleFactor

WHERE 
szPaymentTermId = p_szPaymentTermId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_AR_PaymentTerm_UpdatePaymentTerm_013(
p_szPaymentTermId BOS_DT_szId,
p_szFailCheckActionType BOS_DT_szSmallId,
p_szOpenBlockApprovalId BOS_DT_szId,
p_decOverLimitAmount_2 BOS_DT_decAmount,
p_szFailCheckActionType_2 BOS_DT_szSmallId,
p_szOpenBlockApprovalId_2 BOS_DT_szId,
p_decOverLimitAmount_3 BOS_DT_decAmount,
p_szFailCheckActionType_3 BOS_DT_szSmallId,
p_szOpenBlockApprovalId_3 BOS_DT_szId,
p_decOverLimitAmount_4 BOS_DT_decAmount,
p_szFailCheckActionType_4 BOS_DT_szSmallId,
p_szOpenBlockApprovalId_4 BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_intMaxPaymentDay integer,
p_intPrintedMaxPaymentDay integer,
p_intDayBeforeDueDateToSendInvoice integer,
p_szPaymentDelayPenalty varchar,
p_decPenalty BOS_DT_decAmount,
p_decFixPenalty BOS_DT_decAmount,
p_szPenaltyOrderItemTypeId BOS_DT_szId,
p_szAdvancePaymentIncentive varchar,
p_decIncentive BOS_DT_decAmount,
p_decFixIncentive BOS_DT_decAmount,
p_szIncentiveOrderItemTypeId BOS_DT_szId,
p_decMultipleFactor numeric)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_AR_PaymentTerm
SET 
szFailCheckActionType = p_szFailCheckActionType,
szOpenBlockApprovalId = p_szOpenBlockApprovalId,

decOverLimitAmount_2 = p_decOverLimitAmount_2,
szFailCheckActionType_2 = p_szFailCheckActionType_2,
szOpenBlockApprovalId_2 = p_szOpenBlockApprovalId_2,

decOverLimitAmount_3 = p_decOverLimitAmount_3,
szFailCheckActionType_3 = p_szFailCheckActionType_3,
szOpenBlockApprovalId_3 = p_szOpenBlockApprovalId_3,

decOverLimitAmount_4 = p_decOverLimitAmount_4,
szFailCheckActionType_4 = p_szFailCheckActionType_4,
szOpenBlockApprovalId_4 = p_szOpenBlockApprovalId_4,

szCcyId = p_szCcyId,
intMaxPaymentDay = p_intMaxPaymentDay,
intPrintedMaxPaymentDay = p_intPrintedMaxPaymentDay,
intDayBeforeDueDateToSendInvoice = p_intDayBeforeDueDateToSendInvoice,
szPaymentDelayPenalty = p_szPaymentDelayPenalty,
decPenalty = p_decPenalty,
decFixPenalty = p_decFixPenalty,
szPenaltyOrderItemTypeId = p_szPenaltyOrderItemTypeId,
szAdvancePaymentIncentive= p_szAdvancePaymentIncentive,
decIncentive = p_decIncentive,
decFixIncentive = p_decFixIncentive,
szIncentiveOrderItemTypeId = p_szIncentiveOrderItemTypeId,
decMultipleFactor = p_decMultipleFactor

WHERE 
szPaymentTermId = p_szPaymentTermId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_Qualification_CreateQualification(
p_szQualificationClassId BOS_DT_szMediumId,
p_szQualificationId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_BIZ_Qualification
(
szQualificationClassId,
szQualificationId,
szDescription,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szQualificationClassId,
p_szQualificationId,
p_szDescription,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_Qualification_CreateQualification_014(
p_szQualificationClassId BOS_DT_szMediumId,
p_szQualificationId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_BIZ_Qualification
(
szQualificationClassId,
szQualificationId,
szDescription,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szQualificationClassId,
p_szQualificationId,
p_szDescription,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_Qualification_DeleteQualification(
p_szQualificationClassId BOS_DT_szMediumId,
p_szQualificationId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_BIZ_Qualification
WHERE
szQualificationClassId = p_szQualificationClassId AND 
szQualificationId = p_szQualificationId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_Qualification_GetListOfQualification(
p_szQualificationClassId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szQualificationId, szDescription

FROM 
BOS_BIZ_Qualification
WHERE 
szQualificationClassId = p_szQualificationClassId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_Qualification_GetQualification(
p_szQualificationClassId BOS_DT_szMediumId,
p_szQualificationId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_BIZ_Qualification
WHERE 
szQualificationClassId = p_szQualificationClassId AND szQualificationId = p_szQualificationId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_Qualification_GetQualification_014(
p_szQualificationClassId BOS_DT_szMediumId,
p_szQualificationId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_BIZ_Qualification
WHERE 
szQualificationClassId = p_szQualificationClassId AND szQualificationId = p_szQualificationId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_Qualification_IsQualificationExist(
p_szQualificationClassId BOS_DT_szMediumId,
p_szQualificationId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription

FROM 
BOS_BIZ_Qualification
WHERE 
szQualificationClassId = p_szQualificationClassId AND szQualificationId = p_szQualificationId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_Qualification_LockQualification(
p_szQualificationClassId BOS_DT_szMediumId,
p_szQualificationId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_BIZ_Qualification
SET 
szDescription = szDescription
WHERE 
szQualificationClassId = p_szQualificationClassId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_Qualification_UpdateQualification(
p_szQualificationClassId BOS_DT_szMediumId,
p_szQualificationId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_BIZ_Qualification
SET 
szDescription = p_szDescription
WHERE 
szQualificationClassId = p_szQualificationClassId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_QualificationClass_CreateQualificationClass(
p_szQualificationClassId BOS_DT_szMediumId,
p_szDescription BOS_DT_szBigDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_BIZ_QualificationClass
(
szQualificationClassId,
szDescription,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szQualificationClassId,
p_szDescription,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_QualificationClass_CreateQualificationClass_014(
p_szQualificationClassId BOS_DT_szMediumId,
p_szDescription BOS_DT_szBigDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_BIZ_QualificationClass
(
szQualificationClassId,
szDescription,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szQualificationClassId,
p_szDescription,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_QualificationClass_DeleteQualificationClass(
p_szQualificationClassId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_BIZ_QualificationClass
WHERE
 szQualificationClassId = p_szQualificationClassId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_QualificationClass_GetListOfQualificationClass()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szQualificationClassId, szDescription 

FROM 
BOS_BIZ_QualificationClass; 

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_QualificationClass_GetQualificationClass(
p_szQualificationClassId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
dtmLastUpdated,
bAlreadyTransferred
FROM 
BOS_BIZ_QualificationClass
WHERE 
 szQualificationClassId = p_szQualificationClassId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_QualificationClass_GetQualificationClass_014(
p_szQualificationClassId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
dtmLastUpdated,
bAlreadyTransferred
FROM 
BOS_BIZ_QualificationClass
WHERE 
 szQualificationClassId = p_szQualificationClassId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_QualificationClass_IsQualificationClassExist(
p_szQualificationClassId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription 

FROM 
BOS_BIZ_QualificationClass 
WHERE 
 szQualificationClassId = p_szQualificationClassId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_QualificationClass_LockQualificationClass(
p_szQualificationClassId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_BIZ_QualificationClass
SET 
 szDescription = szDescription
WHERE 
 szQualificationClassId = p_szQualificationClassId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_QualificationClass_UpdateQualificationClass(
p_szQualificationClassId BOS_DT_szMediumId,
p_szDescription BOS_DT_szBigDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_BIZ_QualificationClass
SET 
 szDescription = p_szDescription
WHERE 
 szQualificationClassId = p_szQualificationClassId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_Qualifier_CreateQualifier(
p_szQualificationClassId BOS_DT_szMediumId,
p_szQualifierId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_szQualifierFormula BOS_DT_szBigMessage,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_BIZ_Qualifier
(
szQualificationClassId,
szQualifierId,
szDescription,
szQualifierFormula,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szQualificationClassId,
p_szQualifierId,
p_szDescription,
p_szQualifierFormula,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_Qualifier_CreateQualifier_014(
p_szQualificationClassId BOS_DT_szMediumId,
p_szQualifierId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_szQualifierFormula BOS_DT_szBigMessage,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_BIZ_Qualifier
(
szQualificationClassId,
szQualifierId,
szDescription,
szQualifierFormula,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szQualificationClassId,
p_szQualifierId,
p_szDescription,
p_szQualifierFormula,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_Qualifier_DeleteQualifier(
p_szQualificationClassId BOS_DT_szMediumId,
p_szQualifierId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_BIZ_Qualifier
WHERE
szQualificationClassId = p_szQualificationClassId AND 
szQualifierId = p_szQualifierId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_Qualifier_GetListOfQualifier(
p_szQualificationClassId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szQualifierId, szDescription

FROM 
BOS_BIZ_Qualifier
WHERE 
szQualificationClassId = p_szQualificationClassId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_Qualifier_GetQualifier(
p_szQualificationClassId BOS_DT_szMediumId,
p_szQualifierId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
szQualifierFormula,
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_BIZ_Qualifier
WHERE 
szQualificationClassId = p_szQualificationClassId AND 
szQualifierId = p_szQualifierId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_Qualifier_GetQualifier_014(
p_szQualificationClassId BOS_DT_szMediumId,
p_szQualifierId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
szQualifierFormula,
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_BIZ_Qualifier
WHERE 
szQualificationClassId = p_szQualificationClassId AND szQualifierId = p_szQualifierId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_Qualifier_IsQualifierExist(
p_szQualificationClassId BOS_DT_szMediumId,
p_szQualifierId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription

FROM 
BOS_BIZ_Qualifier
WHERE 
szQualificationClassId = p_szQualificationClassId AND szQualifierId = p_szQualifierId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_Qualifier_LockQualifier(
p_szQualificationClassId BOS_DT_szMediumId,
p_szQualifierId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_BIZ_Qualifier
SET 
szDescription = szDescription
WHERE 
szQualificationClassId = p_szQualificationClassId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_BIZ_Qualifier_UpdateQualifier(
p_szQualificationClassId BOS_DT_szMediumId,
p_szQualifierId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_szQualifierFormula BOS_DT_szBigMessage)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_BIZ_Qualifier
SET 
szDescription = p_szDescription,
szQualifierFormula = p_szQualifierFormula
WHERE 
szQualificationClassId = p_szQualificationClassId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Bank_CreateBank(
p_szBankId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szAccount varchar,
p_BankszContactPerson BOS_DT_szName,
p_BankszRoomNo BOS_DT_szSmallName,
p_BankszFloor BOS_DT_szSmallName,
p_BankszBuilding BOS_DT_szName,
p_BankszAddress_1 BOS_DT_szName,
p_BankszAddress_2 BOS_DT_szName,
p_BankszDistrict BOS_DT_szName,
p_BankszCity BOS_DT_szMediumName,
p_BankszZipCode BOS_DT_szSmallName,
p_BankszState BOS_DT_szMediumName,
p_BankszCountry BOS_DT_szMediumName,
p_BankszPhoneNo_1 BOS_DT_szMediumName,
p_BankszPhoneNo_2 BOS_DT_szMediumName,
p_BankszFaxNo BOS_DT_szMediumName,
p_BankszMobileNo BOS_DT_szMediumName,
p_BankszEmail BOS_DT_szMediumName,
p_BankszWebSite BOS_DT_szMediumName,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_Bank
(
szBankId,
szName,
szAccount,
BankszContactPerson,
BankszRoomNo,
BankszFloor,
BankszBuilding,
BankszAddress_1,
BankszAddress_2,
BankszDistrict,
BankszCity,
BankszZipCode,
BankszState,
BankszCountry,
BankszPhoneNo_1,
BankszPhoneNo_2,
BankszFaxNo,
BankszMobileNo,
BankszEmail,
BankszWebSite,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szBankId,
p_szName,
p_szAccount,
p_BankszContactPerson,
p_BankszRoomNo,
p_BankszFloor,
p_BankszBuilding,
p_BankszAddress_1,
p_BankszAddress_2,
p_BankszDistrict,
p_BankszCity,
p_BankszZipCode,
p_BankszState,
p_BankszCountry,
p_BankszPhoneNo_1,
p_BankszPhoneNo_2,
p_BankszFaxNo,
p_BankszMobileNo,
p_BankszEmail,
p_BankszWebSite,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Bank_DeleteBank(
p_szBankId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Bank_GetBank(
p_szBankId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szBankId,
szName,
szAccount,
BankszContactPerson,
BankszRoomNo,
BankszFloor,
BankszBuilding,
BankszAddress_1,
BankszAddress_2,
BankszDistrict,
BankszCity,
BankszZipCode,
BankszState,
BankszCountry,
BankszPhoneNo_1,
BankszPhoneNo_2,
BankszFaxNo,
BankszMobileNo,
BankszEmail,
BankszWebSite,


dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_CAS_Bank
WHERE 
szBankId = p_szBankId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Bank_GetListOfBank()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szBankId, szName 

FROM 
BOS_CAS_Bank; 

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Bank_IsBankExist(
p_szBankId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szBankId

FROM 
BOS_CAS_Bank
WHERE 
szBankId = p_szBankId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Bank_LockBank(
p_szBankId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_Bank
SET 
szAccount = szAccount
WHERE 
szBankId=p_szBankId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Bank_UpdateBank(
p_szBankId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szAccount varchar,
p_BankszContactPerson BOS_DT_szName,
p_BankszRoomNo BOS_DT_szSmallName,
p_BankszFloor BOS_DT_szSmallName,
p_BankszBuilding BOS_DT_szName,
p_BankszAddress_1 BOS_DT_szName,
p_BankszAddress_2 BOS_DT_szName,
p_BankszDistrict BOS_DT_szName,
p_BankszCity BOS_DT_szMediumName,
p_BankszZipCode BOS_DT_szSmallName,
p_BankszState BOS_DT_szMediumName,
p_BankszCountry BOS_DT_szMediumName,
p_BankszPhoneNo_1 BOS_DT_szMediumName,
p_BankszPhoneNo_2 BOS_DT_szMediumName,
p_BankszFaxNo BOS_DT_szMediumName,
p_BankszMobileNo BOS_DT_szMediumName,
p_BankszEmail BOS_DT_szMediumName,
p_BankszWebSite BOS_DT_szMediumName)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_Bank
SET 
szName = p_szName,
szAccount = p_szAccount,
BankszContactPerson = p_BankszContactPerson,
BankszRoomNo = p_BankszRoomNo,
BankszFloor = p_BankszFloor,
BankszBuilding = p_BankszBuilding,
BankszAddress_1 = p_BankszAddress_1,
BankszAddress_2 = p_BankszAddress_2,
BankszDistrict = p_BankszDistrict,
BankszCity = p_BankszCity,
BankszZipCode = p_BankszZipCode,
BankszState = p_BankszState,
BankszCountry = p_BankszCountry,
BankszPhoneNo_1 = p_BankszPhoneNo_1,
BankszPhoneNo_2 = p_BankszPhoneNo_2,
BankszFaxNo = p_BankszFaxNo,
BankszMobileNo = p_BankszMobileNo,
BankszEmail = p_BankszEmail,
BankszWebSite = p_BankszWebSite
WHERE 
szBankId = p_szBankId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Cash_DEV_DeleteALL()
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_CAS_CashReceiptItem;
DELETE 
BOS_CAS_CashReceipt;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashOut_CreateFCashOut(
p_szCreateId BOS_DT_szId,
p_szOfficerId BOS_DT_szId,
p_szFCashOutId BOS_DT_szId,
p_dtmReleased timestamp,
p_szAccountId BOS_DT_szGLAccount,
p_szSubAccountId BOS_DT_szGLAccount,
p_szChequeNo BOS_DT_szId,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_decControlAmount BOS_DT_decAmount,
p_szRecUserId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FCashOut
(
szCreateId,
szOfficerId,
szFCashOutId,
dtmReleased,
szAccountId,
szSubAccountId,
szChequeNo,
szCcyRateId,
szCcyId,
szDescription,
decControlAmount,
szRecUserId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCreateId,
p_szOfficerId,
p_szFCashOutId,
p_dtmReleased,
p_szAccountId,
p_szSubAccountId,
p_szChequeNo,
p_szCcyRateId,
p_szCcyId,
p_szDescription,
p_decControlAmount,
p_szRecUserId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashOut_CreateFCashOut_013(
p_szCreateId BOS_DT_szId,
p_szOfficerId BOS_DT_szId,
p_szFCashOutId BOS_DT_szId,
p_dtmReleased timestamp,
p_szAccountId BOS_DT_szGLAccount,
p_szSubAccountId BOS_DT_szGLAccount,
p_szChequeNo BOS_DT_szId,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_decControlAmount BOS_DT_decAmount,
p_szRecUserId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FCashOut
(
szCreateId,
szOfficerId,
szFCashOutId,
dtmReleased,
szAccountId,
szSubAccountId,
szChequeNo,
szCcyRateId,
szCcyId,
szDescription,
decControlAmount,
szRecUserId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCreateId,
p_szOfficerId,
p_szFCashOutId,
p_dtmReleased,
p_szAccountId,
p_szSubAccountId,
p_szChequeNo,
p_szCcyRateId,
p_szCcyId,
p_szDescription,
p_decControlAmount,
p_szRecUserId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashOut_CreateFCashOutItem(
p_szCreateId BOS_DT_szId,
p_btItemNumber integer,
p_szAccountId BOS_DT_szGLAccount,
p_szSubAccountId BOS_DT_szGLAccount,
p_szDescription BOS_DT_szDescription,
p_decAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FCashOutItem
(
szCreateId,
btItemNumber,
szAccountId,
szSubAccountId,
szDescription,
decAmount
)
VALUES
(
p_szCreateId,
p_btItemNumber,
p_szAccountId,
p_szSubAccountId,
p_szDescription,
p_decAmount
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashOut_CreateFCashOutItem_013(
p_szCreateId BOS_DT_szId,
p_btItemNumber integer,
p_szAccountId BOS_DT_szGLAccount,
p_szSubAccountId BOS_DT_szGLAccount,
p_szDescription BOS_DT_szDescription,
p_decAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FCashOutItem
(
szCreateId,
btItemNumber,
szAccountId,
szSubAccountId,
szDescription,
decAmount
)
VALUES
(
p_szCreateId,
p_btItemNumber,
p_szAccountId,
p_szSubAccountId,
p_szDescription,
p_decAmount
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashOut_DeleteFCashOut(
p_szCreateId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_CAS_FCashOut
WHERE
szCreateId=p_szCreateId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashOut_DeleteFCashOutItem(
p_szCreateId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashOut_GetFCashOut(
p_szCreateId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_CAS_FCashOut.szOfficerId,
BOS_SM_User.szName as szOfficerNm,
BOS_CAS_FCashOut.szFCashOutId,
BOS_CAS_FCashOut.dtmReleased,

BOS_CAS_FCashOut.szAccountId,
BOS_GL_Account.szName as szAccountNm,

BOS_CAS_FCashOut.szSubAccountId,
BOS_GL_GLSubAcc.szDescription as szSubAccountNm,

BOS_CAS_FCashOut.szChequeNo,
BOS_CAS_FCashOut.szCcyRateId,
BOS_CAS_FCashOut.szCcyId,
BOS_CU_Currency.szAmountFormat,
BOS_CAS_FCashOut.szDescription,
BOS_CAS_FCashOut.decControlAmount,
BOS_CAS_FCashOut.bResultFrTransfer,
BOS_CAS_FCashOut.szRecUserId,
BOS_PI_Employee.szName as szRecUserNm,
BOS_CAS_FCashOut.bVoid,
BOS_GEN_Approved.bApproved,
BOS_CAS_FCashOut.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_CAS_FCashOut.btPrintedCount,
BOS_CAS_FCashOut.bTransferred,
BOS_CAS_FCashOut.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_CAS_FCashOut.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_CAS_FCashOut.szTaxEntityId,
BOS_CAS_FCashOut.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_CAS_FCashOut.dtmCreated,
BOS_CAS_FCashOut.bSystemCreated,

BOS_CAS_FCashOut.dtmLastUpdated,
BOS_CAS_FCashOut.bAlreadyTransferred

--,BOS_CAS_FCashOut.szFJournalId as szFCashOutFJournalId
FROM
BOS_CAS_FCashOut LEFT JOIN BOS_GEN_Approved ON BOS_GEN_Approved.gdApprovedId = BOS_CAS_FCashOut.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_CAS_FCashOut.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_CAS_FCashOut.szOfficerId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_FCashOut.szRecUserId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_FCashOut.szCcyId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_CAS_FCashOut.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_FCashOut.szWorkplaceId

LEFT JOIN BOS_GL_Account ON BOS_GL_Account.szAccountId = BOS_CAS_FCashOut.szAccountId
LEFT JOIN BOS_GL_GLSubAcc ON BOS_GL_GLSubAcc.szLedgerId = BOS_GL_Company.szLedgerId 
AND BOS_GL_GLSubAcc.szGLSubAccId = BOS_CAS_FCashOut.szSubAccountId

WHERE
BOS_CAS_FCashOut.szCreateId=p_szCreateId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashOut_GetFCashOutItem(
p_szCreateId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_CAS_FCashOutItem.btItemNumber,

BOS_CAS_FCashOutItem.szAccountId,
BOS_GL_Account.szName as szAccountNm,

BOS_CAS_FCashOutItem.szSubAccountId,
BOS_GL_GLSubAcc.szDescription as szSubAccountNm,

BOS_CAS_FCashOutItem.szDescription,
BOS_CAS_FCashOutItem.decAmount
FROM
BOS_CAS_FCashOutItem
LEFT JOIN BOS_CAS_FCashOut ON BOS_CAS_FCashOut.szCreateId = BOS_CAS_FCashOutItem.szCreateId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_CAS_FCashOut.szCompanyId
left join BOS_GL_Account on BOS_CAS_FCashOutItem.szAccountId = BOS_GL_Account.szAccountId
left join BOS_GL_GLSubAcc on BOS_GL_GLSubAcc.szLedgerId = BOS_GL_Company.szLedgerId
AND BOS_GL_GLSubAcc.szGLSubAccId = BOS_CAS_FCashOutItem.szSubAccountId

WHERE
BOS_CAS_FCashOutItem.szCreateId=p_szCreateId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashOut_GetFCashOutWhereFCashOutId(
p_szFCashOutId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_CAS_FCashOut.szCreateId,
BOS_CAS_FCashOut.dtmReleased,
BOS_CAS_FCashOut.szAccountId,
BOS_CAS_FCashOut.szSubAccountId,
BOS_CAS_FCashOut.szChequeNo,
BOS_CAS_FCashOut.szCcyRateId,
BOS_CAS_FCashOut.szCcyId,
BOS_CAS_FCashOut.szDescription,
BOS_CAS_FCashOut.decControlAmount,
BOS_CAS_FCashOut.bResultFrTransfer,
BOS_CAS_FCashOut.bVoid,
BOS_GEN_Approved.bApproved,
BOS_CAS_FCashOut.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_CAS_FCashOut.btPrintedCount,
BOS_CAS_FCashOut.bTransferred,
BOS_CAS_FCashOut.szCompanyId,
BOS_CAS_FCashOut.szWorkplaceId,
BOS_CAS_FCashOut.szTaxEntityId,
BOS_CAS_FCashOut.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_CAS_FCashOut.dtmCreated,
BOS_CAS_FCashOut.bSystemCreated
FROM
BOS_CAS_FCashOut 
LEFT JOIN BOS_GEN_Approved ON BOS_CAS_FCashOut.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_CAS_FCashOut.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
WHERE
BOS_CAS_FCashOut.szFCashOutId = p_szFCashOutId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashOut_GetListOfFCashOut()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCreateId,
dtmCreated,
szFCashOutId,
dtmReleased

FROM 
BOS_CAS_FCashOut;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashOut_GetListOfFCashOutItemWhereDate(
p_dtmBegin timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN

SELECT
	BOS_CAS_FCashOut.szRecUserId,
	BOS_PI_Employee.szName,
	BOS_CAS_FCashOut.szCcyId,
	Sum(BOS_CAS_FCashOutItem.decAmount) as Total
FROM
	(BOS_CAS_FCashOut LEFT JOIN BOS_CAS_FCashOutItem ON BOS_CAS_FCashOut.szCreateId = BOS_CAS_FCashOutItem.szCreateId)
	LEFT JOIN BOS_PI_Employee ON BOS_CAS_FCashOut.szRecUserId= BOS_PI_Employee.szEmployeeId
WHERE
BOS_CAS_FCashOut.dtmReleased >= p_dtmBegin and 
BOS_CAS_FCashOut.dtmReleased < DateAdd(day,1,p_dtmEnd) and BOS_CAS_FCashOut.bvoid = 0
GROUP BY
BOS_CAS_FCashOut.szCcyId, 
BOS_CAS_FCashOut.szRecUserId, 
BOS_PI_Employee.szName
ORDER BY
BOS_CAS_FCashOut.szRecUserId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashOut_IsFCashOutExist(
p_szCreateId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCreateId

FROM 
BOS_CAS_FCashOut
WHERE 
szCreateId=p_szCreateId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashOut_LockFCashOut(
p_szCreateId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FCashOut
SET 
dtmCreated = dtmCreated
WHERE 
szCreateId=p_szCreateId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashOut_LockFCashOutWhereFCashOutId(
p_szFCashOutId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FCashOut
SET 
dtmCreated = dtmCreated
WHERE 
szFCashOutId = p_szFCashOutId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashOut_MarkFCashOutApplied(
p_szCreateId BOS_DT_szId,
p_szFCashOutId BOS_DT_szId,
p_dtmReleased timestamp,
p_szFJournalId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FCashOut
SET 
szFCashOutId = p_szFCashOutId,
dtmReleased = p_dtmReleased,
bApplied=1,
szFJournalId = p_szFJournalId
WHERE 
szCreateId = p_szCreateId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashOut_MarkFCashOutVoid(
p_szFCashOutId BOS_DT_szId,
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FCashOut
SET 
bVoid = 1,
bNeedApproval = 0,
gdApprovedId = p_gdApprovedId
WHERE 
szFCashOutId=p_szFCashOutId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashOut_UpdateFCashOut(
p_szCreateId BOS_DT_szId,
p_szOfficerId BOS_DT_szId,
p_szAccountId BOS_DT_szId,
p_szSubAccountId BOS_DT_szGLAccount,
p_szChequeNo BOS_DT_szId,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_decControlAmount BOS_DT_decAmount,
p_szRecUserId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FCashOut
SET 
szOfficerId = p_szOfficerId,
szAccountId = p_szAccountId,
szSubAccountId = p_szSubAccountId,
szChequeNo = p_szChequeNo,
szCcyRateId = p_szCcyRateId,
szCcyId = p_szCcyId,
szDescription = p_szDescription ,
decControlAmount = p_decControlAmount ,
szRecUserId = p_szRecUserId,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId
WHERE 
szCreateId=p_szCreateId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashOut_UpdateFCashOut_013(
p_szCreateId BOS_DT_szId,
p_szOfficerId BOS_DT_szId,
p_szAccountId BOS_DT_szId,
p_szSubAccountId BOS_DT_szGLAccount,
p_szChequeNo BOS_DT_szId,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_decControlAmount BOS_DT_decAmount,
p_szRecUserId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FCashOut
SET 
szOfficerId = p_szOfficerId,
szAccountId = p_szAccountId,
szSubAccountId = p_szSubAccountId,
szChequeNo = p_szChequeNo,
szCcyRateId = p_szCcyRateId,
szCcyId = p_szCcyId,
szDescription = p_szDescription ,
decControlAmount = p_decControlAmount ,
szRecUserId = p_szRecUserId,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId
WHERE 
szCreateId=p_szCreateId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashReceipt_CreateFCashReceipt(
p_szFCashReceiptId BOS_DT_szId,
p_dtmReceipt timestamp,
p_szOfficerId BOS_DT_szId,
p_szAccountId BOS_DT_szId,
p_szSubAccountId BOS_DT_szGLAccount,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_decControlAmount BOS_DT_decAmount,
p_szDeposanId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FCashReceipt
(
szFCashReceiptId,
dtmReceipt,
szOfficerId,
szAccountId,
szSubAccountId,
szCcyRateId,
szCcyId,
szDescription,
decControlAmount,
szDeposanId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFCashReceiptId ,
p_dtmReceipt ,
p_szOfficerId,
p_szAccountId,
p_szSubAccountId,
p_szCcyRateId,
p_szCcyId,
p_szDescription,
p_decControlAmount,
p_szDeposanId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashReceipt_CreateFCashReceipt_013(
p_szFCashReceiptId BOS_DT_szId,
p_dtmReceipt timestamp,
p_szOfficerId BOS_DT_szId,
p_szAccountId BOS_DT_szId,
p_szSubAccountId BOS_DT_szGLAccount,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_decControlAmount BOS_DT_decAmount,
p_szDeposanId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FCashReceipt
(
szFCashReceiptId,
dtmReceipt,
szOfficerId,
szAccountId,
szSubAccountId,
szCcyRateId,
szCcyId,
szDescription,
decControlAmount,
szDeposanId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFCashReceiptId ,
p_dtmReceipt ,
p_szOfficerId,
p_szAccountId,
p_szSubAccountId,
p_szCcyRateId,
p_szCcyId,
p_szDescription,
p_decControlAmount,
p_szDeposanId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashReceipt_CreateFCashReceiptItem(
p_szFCashReceiptId BOS_DT_szId,
p_btItemNumber integer,
p_szAccountId BOS_DT_szId,
p_szSubAccountId BOS_DT_szGLAccount,
p_szDescription BOS_DT_szDescription,
p_decAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FCashReceiptItem
(
szFCashReceiptId,
btItemNumber,
szAccountId,
szSubAccountId,
szDescription,
decAmount
)
VALUES
(
p_szFCashReceiptId,
p_btItemNumber,
p_szAccountId,
p_szSubAccountId,
p_szDescription,
p_decAmount
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashReceipt_CreateFCashReceiptItem_013(
p_szFCashReceiptId BOS_DT_szId,
p_btItemNumber integer,
p_szAccountId BOS_DT_szId,
p_szSubAccountId BOS_DT_szGLAccount,
p_szDescription BOS_DT_szDescription,
p_decAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FCashReceiptItem
(
szFCashReceiptId,
btItemNumber,
szAccountId,
szSubAccountId,
szDescription,
decAmount
)
VALUES
(
p_szFCashReceiptId,
p_btItemNumber,
p_szAccountId,
p_szSubAccountId,
p_szDescription,
p_decAmount
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashReceipt_DeleteFCashReceipt(
p_szFCashReceiptId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_CAS_FCashReceipt
WHERE
szFCashReceiptId=p_szFCashReceiptId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashReceipt_DeleteFCashReceiptItem(
p_szFCashReceiptId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_CAS_FCashReceiptItem
WHERE
szFCashReceiptId=p_szFCashReceiptId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashReceipt_GetFCashReceipt(
p_szFCashReceiptId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_CAS_FCashReceipt.dtmReceipt,
BOS_CAS_FCashReceipt.szOfficerId,
BOS_SM_User.szName as szOfficerNm,

BOS_CAS_FCashReceipt.szAccountId,
BOS_GL_Account.szName as szAccountNm,

BOS_CAS_FCashReceipt.szSubAccountId,
BOS_GL_GLSubAcc.szDescription as szSubAccountNm,

BOS_CAS_FCashReceipt.szCcyRateId,
BOS_CAS_FCashReceipt.szCcyId,
BOS_CU_Currency.szAmountFormat,
BOS_CAS_FCashReceipt.szDescription,
BOS_CAS_FCashReceipt.decControlAmount,
BOS_CAS_FCashReceipt.szDeposanId,
BOS_PI_Employee.szName as szDeposanNm,

BOS_CAS_FCashReceipt.bResultFrTransfer,
BOS_CAS_FCashReceipt.bVoid,
BOS_GEN_Approved.bApproved,
BOS_CAS_FCashReceipt.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_CAS_FCashReceipt.btPrintedCount,
BOS_CAS_FCashReceipt.bTransferred,

BOS_CAS_FCashReceipt.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,

BOS_CAS_FCashReceipt.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,

BOS_CAS_FCashReceipt.szTaxEntityId,
BOS_CAS_FCashReceipt.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_CAS_FCashReceipt.dtmCreated,
BOS_CAS_FCashReceipt.bSystemCreated,

BOS_CAS_FCashReceipt.szUserId,
DsUser.szName AS szUserNm_J,

BOS_CAS_FCashReceipt.dtmLastUpdated,
BOS_CAS_FCashReceipt.bAlreadyTransferred

FROM
BOS_CAS_FCashReceipt LEFT JOIN BOS_GEN_Approved ON BOS_CAS_FCashReceipt.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_CAS_FCashReceipt.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_CAS_FCashReceipt.szOfficerId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_FCashReceipt.szDeposanId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_FCashReceipt.szCcyId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_CAS_FCashReceipt.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_FCashReceipt.szWorkplaceId

LEFT JOIN BOS_GL_Account ON BOS_GL_Account.szAccountId = BOS_CAS_FCashReceipt.szAccountId
LEFT JOIN BOS_GL_GLSubAcc ON BOS_GL_GLSubAcc.szLedgerId = BOS_GL_Company.szLedgerId
AND BOS_GL_GLSubAcc.szGLSubAccId = BOS_CAS_FCashReceipt.szSubAccountId

LEFT JOIN BOS_SM_User AS DsUser ON DsUser.szUserId = BOS_CAS_FCashReceipt.szUserId

WHERE
BOS_CAS_FCashReceipt.szFCashReceiptId=p_szFCashReceiptId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashReceipt_GetFCashReceiptItem(
p_szFCashReceiptId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_CAS_FCashReceiptItem.btItemNumber,

BOS_CAS_FCashReceiptItem.szAccountId,
BOS_GL_Account.szName as szAccountNm,

BOS_CAS_FCashReceiptItem.szSubAccountId,
BOS_GL_GLSubAcc.szDescription as szSubAccountNm,

BOS_CAS_FCashReceiptItem.szDescription,
BOS_CAS_FCashReceiptItem.decAmount
FROM
BOS_CAS_FCashReceiptItem 
LEFT JOIN BOS_CAS_FCashReceipt AS BCR ON BCR.szFCashReceiptId = BOS_CAS_FCashReceiptItem.szFCashReceiptId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BCR.szCompanyId

left join BOS_GL_Account on BOS_CAS_FCashReceiptItem.szAccountId = BOS_GL_Account.szAccountId
left join BOS_GL_GLSubAcc on BOS_GL_GLSubAcc.szLedgerId = BOS_GL_Company.szLedgerId
AND BOS_GL_GLSubAcc.szGLSubAccId = BOS_CAS_FCashReceiptItem.szSubAccountId
WHERE
BOS_CAS_FCashReceiptItem.szFCashReceiptId = p_szFCashReceiptId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashReceipt_GetListOfFCashReceipt()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCashReceiptId,
dtmReceipt

FROM 
BOS_CAS_FCashReceipt;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashReceipt_IsFCashReceiptExist(
p_szFCashReceiptId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCashReceiptId

FROM 
BOS_CAS_FCashReceipt
WHERE 
szFCashReceiptId=p_szFCashReceiptId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashReceipt_LockFCashReceipt(
p_szFCashReceiptId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FCashReceipt
SET 
dtmReceipt = dtmReceipt
WHERE 
szFCashReceiptId=p_szFCashReceiptId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashReceipt_MarkFCashReceiptApplied(
p_szFCashReceiptId BOS_DT_szId,
p_szFJournalId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FCashReceipt
SET 
bApplied = 1,
szFJournalId = p_szFJournalId
WHERE 
szFCashReceiptId = p_szFCashReceiptId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashReceipt_MarkFCashReceiptVoid(
p_szFCashReceiptId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FCashReceipt
SET 
bVoid = 1
WHERE 
szFCashReceiptId = p_szFCashReceiptId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashReceipt_UpdateFCashReceipt(
p_szFCashReceiptId BOS_DT_szId,
p_dtmReceipt timestamp,
p_szOfficerId BOS_DT_szId,
p_szAccountId BOS_DT_szId,
p_szSubAccountId BOS_DT_szGLAccount,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_decControlAmount BOS_DT_decAmount,
p_szDeposanId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FCashReceipt
SET 
dtmReceipt = p_dtmReceipt,
szOfficerId = p_szOfficerId,
szAccountId = p_szAccountId,
szSubAccountId = p_szSubAccountId,
szCcyRateId = p_szCcyRateId,
szCcyId = p_szCcyId,
szDescription = p_szDescription,
decControlAmount = p_decControlAmount,
szDeposanId = p_szDeposanId,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,

--Better use created date as last updated date.
dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFCashReceiptId = p_szFCashReceiptId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashReceipt_UpdateFCashReceipt_013(
p_szFCashReceiptId BOS_DT_szId,
p_dtmReceipt timestamp,
p_szOfficerId BOS_DT_szId,
p_szAccountId BOS_DT_szId,
p_szSubAccountId BOS_DT_szGLAccount,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_decControlAmount BOS_DT_decAmount,
p_szDeposanId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FCashReceipt
SET 
dtmReceipt = p_dtmReceipt,
szOfficerId = p_szOfficerId,
szAccountId = p_szAccountId,
szSubAccountId = p_szSubAccountId,
szCcyRateId = p_szCcyRateId,
szCcyId = p_szCcyId,
szDescription = p_szDescription,
decControlAmount = p_decControlAmount,
szDeposanId = p_szDeposanId,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,

--Better use created date as last updated date.
dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFCashReceiptId = p_szFCashReceiptId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_CreateFCashTemp(
p_szFCashTempId BOS_DT_szId,
p_dtmTransaction timestamp,
p_szOfficerId BOS_DT_szId,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szEmployeeId BOS_DT_szId,
p_szCashDirection varchar,
p_szFCashTrnId BOS_DT_szMediumId,
p_szFCashId BOS_DT_szId,
p_szFCashURL varchar,
p_szChequeNo BOS_DT_szId,
p_szSrcTrnId BOS_DT_szMediumId,
p_szSrcDocId BOS_DT_szId,
p_szSrcURL varchar,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_dtmMobileTransaction timestamp,
p_szJobRoutine BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FCashTemp
(
szFCashTempId,
dtmTransaction,
szOfficerId,
szCcyRateId,
szCcyId,
szEmployeeId,
szCashDirection,
szFCashTrnId,
szFCashId,
szFCashURL,
szChequeNo,
szSrcTrnId,
szSrcDocId,
szSrcURL,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
dtmMobileTransaction,
szJobRoutine
)
VALUES
(
p_szFCashTempId ,
p_dtmTransaction,
p_szOfficerId,
p_szCcyRateId,
p_szCcyId,
p_szEmployeeId,
p_szCashDirection,
p_szFCashTrnId,
p_szFCashId,
p_szFCashURL,
p_szChequeNo,
p_szSrcTrnId,
p_szSrcDocId,
p_szSrcURL,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_dtmMobileTransaction,
p_szJobRoutine
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_CreateFCashTemp_013(
p_szFCashTempId BOS_DT_szId,
p_dtmTransaction timestamp,
p_szOfficerId BOS_DT_szId,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szEmployeeId BOS_DT_szId,
p_szCashDirection varchar,
p_szFCashTrnId BOS_DT_szMediumId,
p_szFCashId BOS_DT_szId,
p_szFCashURL varchar,
p_szChequeNo BOS_DT_szId,
p_szSrcTrnId BOS_DT_szMediumId,
p_szSrcDocId BOS_DT_szId,
p_szSrcURL varchar,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_dtmMobileTransaction timestamp,
p_szJobRoutine BOS_DT_szId,
p_szCashAdvanceRequestId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FCashTemp
(
szFCashTempId,
dtmTransaction,
szOfficerId,
szCcyRateId,
szCcyId,
szEmployeeId,
szCashDirection,
szFCashTrnId,
szFCashId,
szFCashURL,
szChequeNo,
szSrcTrnId,
szSrcDocId,
szSrcURL,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
dtmMobileTransaction,
szJobRoutine,
szCashAdvanceRequestId
)
VALUES
(
p_szFCashTempId ,
p_dtmTransaction,
p_szOfficerId,
p_szCcyRateId,
p_szCcyId,
p_szEmployeeId,
p_szCashDirection,
p_szFCashTrnId,
p_szFCashId,
p_szFCashURL,
p_szChequeNo,
p_szSrcTrnId,
p_szSrcDocId,
p_szSrcURL,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_dtmMobileTransaction,
p_szJobRoutine,
p_szCashAdvanceRequestId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_CreateFCashTempItem(
p_szFCashTempId BOS_DT_szId,
p_btItemNumber smallint,
p_szAccountId BOS_DT_szId,
p_szSubAccountId BOS_DT_szGLAccount,
p_szDescription BOS_DT_szDescription,
p_decAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FCashTempItem
(
szFCashTempId,
btItemNumber,
szAccountId,
szSubAccountId,
szDescription,
decAmount
)
VALUES
(
p_szFCashTempId,
p_btItemNumber,
p_szAccountId,
p_szSubAccountId,
p_szDescription,
p_decAmount
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_CreateFCashTempItem_013(
p_szFCashTempId BOS_DT_szId,
p_btItemNumber smallint,
p_szAccountId BOS_DT_szId,
p_szSubAccountId BOS_DT_szGLAccount,
p_szDescription BOS_DT_szDescription,
p_decAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FCashTempItem
(
szFCashTempId,
btItemNumber,
szAccountId,
szSubAccountId,
szDescription,
decAmount
)
VALUES
(
p_szFCashTempId,
p_btItemNumber,
p_szAccountId,
p_szSubAccountId,
p_szDescription,
p_decAmount
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_DeleteFCashTemp(
p_szFCashTempId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_CAS_FCashTemp
WHERE
szFCashTempId=p_szFCashTempId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_DeleteFCashTempItem(
p_szFCashTempId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_CAS_FCashTempItem
WHERE
szFCashTempId=p_szFCashTempId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_GetFCashTemp(
p_szFCashTempId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_CAS_FCashTemp.dtmTransaction,
BOS_CAS_FCashTemp.szOfficerId,
BOS_SM_User.szName as szOfficerNm,
BOS_CAS_FCashTemp.szCcyRateId,
BOS_CAS_FCashTemp.szCcyId,
BOS_CU_Currency.szAmountFormat,
BOS_CAS_FCashTemp.szEmployeeId,
BOS_PI_Employee.szName as szEmployeeNm,
BOS_CAS_FCashTemp.szCashDirection,
BOS_CAS_FCashTemp.szFCashTrnId,
BOS_CAS_FCashTemp.szFCashId,
BOS_CAS_FCashTemp.szFCashURL,
BOS_CAS_FCashTemp.szChequeNo,
BOS_CAS_FCashTemp.szSrcTrnId,
BOS_CAS_FCashTemp.szSrcDocId,
BOS_CAS_FCashTemp.szSrcURL,

BOS_CAS_FCashTemp.bResultFrTransfer,
BOS_CAS_FCashTemp.bVoid,
BOS_GEN_Approved.bApproved,
BOS_CAS_FCashTemp.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_CAS_FCashTemp.btPrintedCount,
BOS_CAS_FCashTemp.bTransferred,
BOS_CAS_FCashTemp.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_CAS_FCashTemp.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_CAS_FCashTemp.szTaxEntityId,
BOS_CAS_FCashTemp.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_CAS_FCashTemp.dtmCreated,
BOS_CAS_FCashTemp.bSystemCreated,

BOS_CAS_FCashTemp.dtmLastUpdated,
BOS_CAS_FCashTemp.bAlreadyTransferred,
BOS_CAS_FCashTemp.dtmMobileTransaction,
BOS_CAS_FCashTemp.szJobRoutine,
BOS_CAS_FCashTemp.szCashAdvanceRequestId

FROM
BOS_CAS_FCashTemp LEFT JOIN BOS_GEN_Approved ON BOS_CAS_FCashTemp.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_CAS_FCashTemp.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_FCashTemp.szCcyId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_FCashTemp.szEmployeeId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_CAS_FCashTemp.szOfficerId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_CAS_FCashTemp.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_FCashTemp.szWorkplaceId
WHERE
BOS_CAS_FCashTemp.szFCashTempId = p_szFCashTempId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_GetFCashTemp_014(
p_szFCashTempId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_CAS_FCashTemp.dtmTransaction,
BOS_CAS_FCashTemp.szOfficerId,
BOS_SM_User.szName as szOfficerNm,
BOS_CAS_FCashTemp.szCcyRateId,
BOS_CAS_FCashTemp.szCcyId,
BOS_CU_Currency.szAmountFormat,
BOS_CAS_FCashTemp.szEmployeeId,
BOS_PI_Employee.szName as szEmployeeNm,
BOS_CAS_FCashTemp.szCashDirection,
BOS_CAS_FCashTemp.szFCashTrnId,
BOS_CAS_FCashTemp.szFCashId,
BOS_CAS_FCashTemp.szFCashURL,
BOS_CAS_FCashTemp.szChequeNo,
BOS_CAS_FCashTemp.szSrcTrnId,
BOS_CAS_FCashTemp.szSrcDocId,
BOS_CAS_FCashTemp.szSrcURL,

BOS_CAS_FCashTemp.bResultFrTransfer,
BOS_CAS_FCashTemp.bVoid,
BOS_GEN_Approved.bApproved,
BOS_CAS_FCashTemp.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_CAS_FCashTemp.btPrintedCount,
BOS_CAS_FCashTemp.bTransferred,
BOS_CAS_FCashTemp.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_CAS_FCashTemp.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_CAS_FCashTemp.szTaxEntityId,
BOS_CAS_FCashTemp.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_CAS_FCashTemp.dtmCreated,
BOS_CAS_FCashTemp.bSystemCreated,

BOS_CAS_FCashTemp.dtmLastUpdated,
BOS_CAS_FCashTemp.bAlreadyTransferred,
BOS_CAS_FCashTemp.dtmMobileTransaction,
BOS_CAS_FCashTemp.szJobRoutine,
BOS_CAS_FCashTemp.szCashAdvanceRequestId

FROM
BOS_CAS_FCashTemp LEFT JOIN BOS_GEN_Approved ON BOS_CAS_FCashTemp.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_CAS_FCashTemp.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_FCashTemp.szCcyId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_FCashTemp.szEmployeeId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_CAS_FCashTemp.szOfficerId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_CAS_FCashTemp.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_FCashTemp.szWorkplaceId
WHERE
BOS_CAS_FCashTemp.szFCashTempId = p_szFCashTempId;


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_GetFCashTempItem(
p_szFCashTempId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_CAS_FCashTempItem.btItemNumber,

BOS_CAS_FCashTempItem.szAccountId,
BOS_GL_Account.szName as szAccountNm,

BOS_CAS_FCashTempItem.szSubAccountId,
BOS_GL_GLSubAcc.szDescription as szSubAccountNm,

BOS_CAS_FCashTempItem.szDescription,
BOS_CAS_FCashTempItem.decAmount
FROM
BOS_CAS_FCashTempItem 
LEFT JOIN BOS_CAS_FCashTemp AS BCT ON BCT.szFCashTempId = BOS_CAS_FCashTempItem.szFCashTempId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BCT.szCompanyId

left join BOS_GL_Account on BOS_CAS_FCashTempItem.szAccountId = BOS_GL_Account.szAccountId
left join BOS_GL_GLSubAcc on BOS_GL_GLSubAcc.szLedgerId = BOS_GL_Company.szLedgerId
AND BOS_GL_GLSubAcc.szGLSubAccId = BOS_CAS_FCashTempItem.szSubAccountId
WHERE
BOS_CAS_FCashTempItem.szFCashTempId = p_szFCashTempId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_GetListOfCoSoOn(
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_szWorkplaceId BOS_DT_szId,
p_szAccId BOS_DT_szId,
p_szSubAccId BOS_DT_szGLAccount,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
BOS_CAS_FCashTemp.szCompanyId,
BOS_CAS_FCashTempItem.szAccountId,
	BOS_CAS_FCashTempItem.szSubAccountId,
	BOS_CAS_FCashTemp.szWorkplaceId,
	BOS_CAS_FCashTemp.szCcyRateId,
	BOS_CAS_FCashTemp.szCcyId,
	BOS_CAS_FCashTemp.szCashDirection

FROM 
BOS_CAS_FCashTemp
INNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempIdINNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempId
WHERE 
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmStart AND 
BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmEnd) AND 
BOS_CAS_FCashTemp.szFCashId = '' AND 
BOS_CAS_FCashTemp.bApplied = 1 AND 
BOS_CAS_FCashTempItem.btItemNumber = 0 AND 
BOS_CAS_FCashTemp.szWorkplaceId LIKE p_szWorkplaceId AND 
BOS_CAS_FCashTempItem.szAccountId LIKE p_szAccId AND 
OS_CAS_FCashTempItem.szSubAccountId LIKE p_szSubAccId AND 
BOS_CAS_FCashTemp.szOfficerId LIKE p_szUserId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_GetListOfCoSoOn_013(
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_szWorkplaceId BOS_DT_szId,
p_szAccId BOS_DT_szId,
p_szSubAccId BOS_DT_szGLAccount,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
BOS_CAS_FCashTemp.szCompanyId,
BOS_CAS_FCashTempItem.szAccountId,
	BOS_CAS_FCashTempItem.szSubAccountId,
	BOS_CAS_FCashTemp.szWorkplaceId,
	BOS_CAS_FCashTemp.szCcyRateId,
	BOS_CAS_FCashTemp.szCcyId,
	BOS_CAS_FCashTemp.szCashDirection
	
FROM 
BOS_CAS_FCashTemp
INNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempIdINNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempId
WHERE 
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmStart AND BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmEnd) AND BOS_CAS_FCashTemp.szFCashId = '' AND BOS_CAS_FCashTemp.bApplied = 1 AND BOS_CAS_FCashTempItem.btItemNumber = 0 AND BOS_CAS_FCashTemp.szWorkplaceId LIKE p_szWorkplaceId AND BOS_CAS_FCashTempItem.szAccountId LIKE p_szAccId AND BOS_CAS_FCashTempItem.szSubAccountId LIKE p_szSubAccId AND BOS_CAS_FCashTemp.szOfficerId LIKE p_szUserId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_GetListOfFCashTemp()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCashTempId,
dtmTransaction

FROM 
BOS_CAS_FCashTemp;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_GetListOfTempCashBalance(
p_szCompanyId BOS_DT_szMediumId,
p_szAccountId varchar,
p_szSubAccountId BOS_DT_szGLAccount,
p_szWorkplaceId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN

IF p_szWorkplaceId = ''
  THEN

BEGIN
SELECT DISTINCT
BOS_CAS_FCashTemp.szCompanyId,
BOS_CAS_FCashTempItem.szAccountId,
BOS_CAS_FCashTempItem.szSubAccountId
FROM
BOS_CAS_FCashTemp
INNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempId
WHERE
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmStart AND BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmEnd) AND
BOS_CAS_FCashTemp.szFCashId = '' AND
BOS_CAS_FCashTemp.bApplied = 1 AND
BOS_CAS_FCashTemp.szCompanyId = p_szCompanyId AND
BOS_CAS_FCashTempItem.szAccountId like p_szAccountId AND
BOS_CAS_FCashTempItem.szSubAccountId like p_szSubAccountId;
END;

ELSE

BEGIN
SELECT DISTINCT
BOS_CAS_FCashTemp.szCompanyId,
BOS_CAS_FCashTempItem.szAccountId,
BOS_CAS_FCashTempItem.szSubAccountId,
BOS_CAS_FCashTemp.szWorkplaceId

FROM
BOS_CAS_FCashTemp
INNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempId
WHERE
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmStart AND BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmEnd) AND
BOS_CAS_FCashTemp.szFCashId = '' AND
BOS_CAS_FCashTemp.bApplied = 1 AND
BOS_CAS_FCashTemp.szCompanyId = p_szCompanyId AND
BOS_CAS_FCashTempItem.szAccountId like p_szAccountId AND
BOS_CAS_FCashTempItem.szSubAccountId like p_szSubAccountId AND
BOS_CAS_FCashTemp.szWorkplaceId = p_szWorkplaceId;

END;

END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_GetListOfTempCashBalance_013(
p_szCompanyId BOS_DT_szMediumId,
p_szAccountId varchar,
p_szSubAccountId BOS_DT_szGLAccount,
p_szWorkplaceId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN

IF p_szWorkplaceId = ''
  THEN

BEGIN
SELECT DISTINCT
BOS_CAS_FCashTemp.szCompanyId,
BOS_CAS_FCashTempItem.szAccountId,
BOS_CAS_FCashTempItem.szSubAccountId
FROM
BOS_CAS_FCashTemp
INNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempId
WHERE
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmStart AND BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmEnd) AND
BOS_CAS_FCashTemp.szFCashId = '' AND
BOS_CAS_FCashTemp.bApplied = 1 AND
BOS_CAS_FCashTemp.szCompanyId = p_szCompanyId AND
BOS_CAS_FCashTempItem.szAccountId like p_szAccountId AND
BOS_CAS_FCashTempItem.szSubAccountId like p_szSubAccountId;
END;

ELSE

BEGIN
SELECT DISTINCT
BOS_CAS_FCashTemp.szCompanyId,
BOS_CAS_FCashTempItem.szAccountId,
BOS_CAS_FCashTempItem.szSubAccountId,
BOS_CAS_FCashTemp.szWorkplaceId

FROM
BOS_CAS_FCashTemp
INNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempId
WHERE
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmStart AND BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmEnd) AND
BOS_CAS_FCashTemp.szFCashId = '' AND
BOS_CAS_FCashTemp.bApplied = 1 AND
BOS_CAS_FCashTemp.szCompanyId = p_szCompanyId AND
BOS_CAS_FCashTempItem.szAccountId like p_szAccountId AND
BOS_CAS_FCashTempItem.szSubAccountId like p_szSubAccountId AND
BOS_CAS_FCashTemp.szWorkplaceId = p_szWorkplaceId;

END;

END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_GetListOfUnvouchered(
p_szCompanyId BOS_DT_szMediumId,
p_szAccountId BOS_DT_szId,
p_szSubAccountId BOS_DT_szGLAccount,
p_szWorkplaceId BOS_DT_szId,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szCashDirection BOS_DT_szSmallId,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_CAS_FCashTemp.szFCashTempId

FROM 
BOS_CAS_FCashTemp
INNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempIdINNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempId
WHERE 
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmStart AND BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmEnd) AND BOS_CAS_FCashTemp.szFCashId = '' AND BOS_CAS_FCashTemp.bApplied = 1 AND BOS_CAS_FCashTempItem.btItemNumber = 0 AND BOS_CAS_FCashTemp.szCompanyId = p_szCompanyId AND BOS_CAS_FCashTempItem.szAccountId = p_szAccountId AND BOS_CAS_FCashTempItem.szSubAccountId = p_szSubAccountId AND BOS_CAS_FCashTemp.szWorkplaceId = p_szWorkplaceId AND BOS_CAS_FCashTemp.szCcyRateId = p_szCcyRateId AND BOS_CAS_FCashTemp.szCcyId = p_szCcyId AND BOS_CAS_FCashTemp.szCashDirection = p_szCashDirection AND BOS_CAS_FCashTemp.szOfficerId LIKE p_szUserId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_GetListOfUnvouchered_013(
p_szCompanyId BOS_DT_szMediumId,
p_szAccountId BOS_DT_szId,
p_szSubAccountId BOS_DT_szGLAccount,
p_szWorkplaceId BOS_DT_szId,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szCashDirection BOS_DT_szSmallId,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_CAS_FCashTemp.szFCashTempId

FROM 
BOS_CAS_FCashTemp
INNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempIdINNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempId
WHERE 
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmStart AND BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmEnd) AND BOS_CAS_FCashTemp.szFCashId = '' AND BOS_CAS_FCashTemp.bApplied = 1 AND BOS_CAS_FCashTempItem.btItemNumber = 0 AND BOS_CAS_FCashTemp.szCompanyId = p_szCompanyId AND BOS_CAS_FCashTempItem.szAccountId = p_szAccountId AND BOS_CAS_FCashTempItem.szSubAccountId = p_szSubAccountId AND BOS_CAS_FCashTemp.szWorkplaceId = p_szWorkplaceId AND BOS_CAS_FCashTemp.szCcyRateId = p_szCcyRateId AND BOS_CAS_FCashTemp.szCcyId = p_szCcyId AND BOS_CAS_FCashTemp.szCashDirection = p_szCashDirection AND BOS_CAS_FCashTemp.szOfficerId LIKE p_szUserId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_GetSumOfAccountPayment(
p_szEmployeeId BOS_DT_szId,
p_dtmTransaction timestamp,
p_szCcyId BOS_DT_szSmallId,
p_szAccountId BOS_DT_szId,
p_szSubAccountId BOS_DT_szGLAccount,
p_szDirection_IN varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BCTI.szAccountId, BCTI.szSubAccountId, Sum(BCTI.decAmount) As decAmount

FROM 
BOS_CAS_FCashTemp As BCT
Left Join BOS_CAS_FCashTempItem As BCTI On BCT.szFCashTempId = BCTI.szFCashTempId
WHERE 
BCT.szEmployeeId = p_szEmployeeId And BCT.dtmTransaction >= p_dtmTransaction And BCT.dtmTransaction < DateAdd(Day, 1, p_dtmTransaction) And BCT.szCcyId = p_szCcyId And BCTI.decAmount < 0 And BCTI.szAccountId Like p_szAccountId And BCTI.szSubAccountId Like p_szSubAccountId And BCT.bApplied = 1 And BCT.szCashDirection = p_szDirection_IN AND BCT.bSystemCreated = 0 Group By BCTI.szAccountId, BCTI.szSubAccountId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_GetSumOfAccountPayment_013(
p_szEmployeeId BOS_DT_szId,
p_dtmTransaction timestamp,
p_szCcyId BOS_DT_szSmallId,
p_szAccountId BOS_DT_szId,
p_szSubAccountId BOS_DT_szGLAccount,
p_szDirection_IN varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BCTI.szAccountId, BCTI.szSubAccountId, Sum(BCTI.decAmount) As decAmount

FROM 
BOS_CAS_FCashTemp As BCT
Left Join BOS_CAS_FCashTempItem As BCTI On BCT.szFCashTempId = BCTI.szFCashTempId
WHERE 
BCT.szEmployeeId = p_szEmployeeId And BCT.dtmTransaction >= p_dtmTransaction And BCT.dtmTransaction < DateAdd(Day, 1, p_dtmTransaction) And BCT.szCcyId = p_szCcyId And BCTI.decAmount < 0 And BCTI.szAccountId Like p_szAccountId And BCTI.szSubAccountId Like p_szSubAccountId And BCT.bApplied = 1 And BCT.szCashDirection = p_szDirection_IN AND BCT.bSystemCreated = 0 Group By BCTI.szAccountId, BCTI.szSubAccountId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_GetSumOfAccountPayment_OUT(
p_szEmployeeId BOS_DT_szId,
p_dtmTransaction timestamp,
p_szCcyId BOS_DT_szSmallId,
p_szAccountId BOS_DT_szId,
p_szSubAccountId BOS_DT_szGLAccount,
p_szDirection_OUT varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BCTI.szAccountId, BCTI.szSubAccountId, Sum(BCTI.decAmount) As decAmount

FROM 
BOS_CAS_FCashTemp As BCT
Left Join BOS_CAS_FCashTempItem As BCTI On BCT.szFCashTempId = BCTI.szFCashTempId
WHERE 
BCT.szEmployeeId = p_szEmployeeId And BCT.dtmTransaction >= p_dtmTransaction And BCT.dtmTransaction < DateAdd(Day, 1, p_dtmTransaction) And BCT.szCcyId = p_szCcyId And BCTI.decAmount > 0 And BCTI.szAccountId Like p_szAccountId And BCTI.szSubAccountId Like p_szSubAccountId And BCT.bApplied = 1 And BCT.szCashDirection = p_szDirection_OUT AND BCT.bSystemCreated = 0 Group By BCTI.szAccountId, BCTI.szSubAccountId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_GetSumOfAccountPayment_OUT_013(
p_szEmployeeId BOS_DT_szId,
p_dtmTransaction timestamp,
p_szCcyId BOS_DT_szSmallId,
p_szAccountId BOS_DT_szId,
p_szSubAccountId BOS_DT_szGLAccount,
p_szDirection_OUT varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BCTI.szAccountId, BCTI.szSubAccountId, Sum(BCTI.decAmount) As decAmount

FROM 
BOS_CAS_FCashTemp As BCT
Left Join BOS_CAS_FCashTempItem As BCTI On BCT.szFCashTempId = BCTI.szFCashTempId
WHERE 
BCT.szEmployeeId = p_szEmployeeId And BCT.dtmTransaction >= p_dtmTransaction And BCT.dtmTransaction < DateAdd(Day, 1, p_dtmTransaction) And BCT.szCcyId = p_szCcyId And BCTI.decAmount > 0 And BCTI.szAccountId Like p_szAccountId And BCTI.szSubAccountId Like p_szSubAccountId And BCT.bApplied = 1 And BCT.szCashDirection = p_szDirection_OUT AND BCT.bSystemCreated = 0 Group By BCTI.szAccountId, BCTI.szSubAccountId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_GetTempCashBalance(
p_szCompanyId BOS_DT_szMediumId,
p_szAccountId BOS_DT_szId,
p_szSubAccountId BOS_DT_szGLAccount,
p_szWorkplaceId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN


IF p_szWorkplaceId = ''
  THEN

BEGIN
SELECT
BOS_CAS_FCashTemp.dtmTransaction,
BOS_CAS_FCashTemp.szFCashTempId,
BOS_CAS_FCashTemp.szCashDirection,
BOS_CAS_FCashTemp.szFCashTrnId,
BOS_CAS_FCashTemp.szFCashId,
BOS_CAS_FCashTemp.szFCashURL,
BOS_CAS_FCashTemp.szSrcTrnId,
BOS_CAS_FCashTemp.szSrcDocId,
BOS_CAS_FCashTemp.szSrcURL,
BOS_CAS_FCashTempItem.szDescription,
BOS_CAS_FCashTempItem.decAmount
FROM
BOS_CAS_FCashTempItem
LEFT JOIN BOS_CAS_FCashTemp ON BOS_CAS_FCashTemp.szFCashTempId = BOS_CAS_FCashTempItem.szFCashTempId
WHERE
BOS_CAS_FCashTemp.szCompanyId = p_szCompanyId AND
BOS_CAS_FCashTempItem.szAccountId LIKE p_szAccountId AND
BOS_CAS_FCashTempItem.szSubAccountId LIKE p_szSubAccountId AND
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmStart AND BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmEnd) AND
BOS_CAS_FCashTemp.bApplied = 1
ORDER BY
BOS_CAS_FCashTemp.dtmTransaction, BOS_CAS_FCashTemp.szFCashTempId;
END;

ELSE

BEGIN
SELECT
BOS_CAS_FCashTemp.dtmTransaction,
BOS_CAS_FCashTemp.szFCashTempId,
BOS_CAS_FCashTemp.szCashDirection,
BOS_CAS_FCashTemp.szFCashTrnId,
BOS_CAS_FCashTemp.szFCashId,
BOS_CAS_FCashTemp.szFCashURL,
BOS_CAS_FCashTemp.szSrcTrnId,
BOS_CAS_FCashTemp.szSrcDocId,
BOS_CAS_FCashTemp.szSrcURL,
BOS_CAS_FCashTempItem.szDescription,
BOS_CAS_FCashTempItem.decAmount
FROM
BOS_CAS_FCashTempItem
LEFT JOIN BOS_CAS_FCashTemp ON BOS_CAS_FCashTemp.szFCashTempId = BOS_CAS_FCashTempItem.szFCashTempId
WHERE
BOS_CAS_FCashTemp.szCompanyId = p_szCompanyId AND
BOS_CAS_FCashTempItem.szAccountId LIKE p_szAccountId AND
BOS_CAS_FCashTempItem.szSubAccountId LIKE p_szSubAccountId AND
BOS_CAS_FCashTemp.szWorkplaceId = p_szWorkplaceId AND
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmStart AND BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmEnd) AND
BOS_CAS_FCashTemp.bApplied = 1
ORDER BY
BOS_CAS_FCashTemp.dtmTransaction, BOS_CAS_FCashTemp.szFCashTempId;
END;

END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_GetTempCashBalance_013(
p_szCompanyId BOS_DT_szMediumId,
p_szAccountId BOS_DT_szId,
p_szSubAccountId BOS_DT_szGLAccount,
p_szWorkplaceId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN


IF p_szWorkplaceId = ''
  THEN

BEGIN
SELECT
BOS_CAS_FCashTemp.dtmTransaction,
BOS_CAS_FCashTemp.szFCashTempId,
BOS_CAS_FCashTemp.szCashDirection,
BOS_CAS_FCashTemp.szFCashTrnId,
BOS_CAS_FCashTemp.szFCashId,
BOS_CAS_FCashTemp.szFCashURL,
BOS_CAS_FCashTemp.szSrcTrnId,
BOS_CAS_FCashTemp.szSrcDocId,
BOS_CAS_FCashTemp.szSrcURL,
BOS_CAS_FCashTempItem.szDescription,
BOS_CAS_FCashTempItem.decAmount
FROM
BOS_CAS_FCashTempItem
LEFT JOIN BOS_CAS_FCashTemp ON BOS_CAS_FCashTemp.szFCashTempId = BOS_CAS_FCashTempItem.szFCashTempId
WHERE
BOS_CAS_FCashTemp.szCompanyId = p_szCompanyId AND
BOS_CAS_FCashTempItem.szAccountId LIKE p_szAccountId AND
BOS_CAS_FCashTempItem.szSubAccountId LIKE p_szSubAccountId AND
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmStart AND BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmEnd) AND
BOS_CAS_FCashTemp.bApplied = 1
ORDER BY
BOS_CAS_FCashTemp.dtmTransaction, BOS_CAS_FCashTemp.szFCashTempId;
END;

ELSE

BEGIN
SELECT
BOS_CAS_FCashTemp.dtmTransaction,
BOS_CAS_FCashTemp.szFCashTempId,
BOS_CAS_FCashTemp.szCashDirection,
BOS_CAS_FCashTemp.szFCashTrnId,
BOS_CAS_FCashTemp.szFCashId,
BOS_CAS_FCashTemp.szFCashURL,
BOS_CAS_FCashTemp.szSrcTrnId,
BOS_CAS_FCashTemp.szSrcDocId,
BOS_CAS_FCashTemp.szSrcURL,
BOS_CAS_FCashTempItem.szDescription,
BOS_CAS_FCashTempItem.decAmount
FROM
BOS_CAS_FCashTempItem
LEFT JOIN BOS_CAS_FCashTemp ON BOS_CAS_FCashTemp.szFCashTempId = BOS_CAS_FCashTempItem.szFCashTempId
WHERE
BOS_CAS_FCashTemp.szCompanyId = p_szCompanyId AND
BOS_CAS_FCashTempItem.szAccountId LIKE p_szAccountId AND
BOS_CAS_FCashTempItem.szSubAccountId LIKE p_szSubAccountId AND
BOS_CAS_FCashTemp.szWorkplaceId = p_szWorkplaceId AND
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmStart AND BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmEnd) AND
BOS_CAS_FCashTemp.bApplied = 1
ORDER BY
BOS_CAS_FCashTemp.dtmTransaction, BOS_CAS_FCashTemp.szFCashTempId;
END;

END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_IsFCashTempExist(
p_szFCashTempId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCashTempId

FROM 
BOS_CAS_FCashTemp
WHERE 
szFCashTempId=p_szFCashTempId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_LockFCashTemp(
p_szFCashTempId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FCashTemp
SET 
dtmTransaction = dtmTransaction
WHERE 
szFCashTempId=p_szFCashTempId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_UpdateFCashInfo(
p_szFCashTempId BOS_DT_szId,
p_szFCashTrnId BOS_DT_szMediumId,
p_szFCashId BOS_DT_szId,
p_szFCashURL BOS_DT_szUrl)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FCashTemp
SET 
szFCashTrnId = p_szFCashTrnId,
szFCashId = p_szFCashId,
szFCashURL = p_szFCashURL
WHERE 
szFCashTempId = p_szFCashTempId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_UpdateFCashInfo_013(
p_szFCashTempId BOS_DT_szId,
p_szFCashTrnId BOS_DT_szMediumId,
p_szFCashId BOS_DT_szId,
p_szFCashURL BOS_DT_szUrl)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FCashTemp
SET 
szFCashTrnId = p_szFCashTrnId,
szFCashId = p_szFCashId,
szFCashURL = p_szFCashURL
WHERE 
szFCashTempId = p_szFCashTempId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_UpdateFCashTemp(
p_szFCashTempId BOS_DT_szId,
p_dtmTransaction timestamp,
p_szOfficerId BOS_DT_szId,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szEmployeeId BOS_DT_szId,
p_szCashDirection varchar,
p_szChequeNo BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmMobileTransaction timestamp,
p_szJobRoutine BOS_DT_szId,
p_szCashAdvanceRequestId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FCashTemp
SET 
dtmTransaction = p_dtmTransaction,
szOfficerId = p_szOfficerId,
szCcyRateId = p_szCcyRateId,
szCcyId = p_szCcyId,
szEmployeeId = p_szEmployeeId,
szCashDirection = p_szCashDirection,
szChequeNo = p_szChequeNo,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
dtmMobileTransaction = p_dtmMobileTransaction,
szJobRoutine = p_szJobRoutine,
szCashAdvanceRequestId=p_szCashAdvanceRequestId
WHERE 
szFCashTempId = p_szFCashTempId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FCashTemp_UpdateFCashTemp_013(
p_szFCashTempId BOS_DT_szId,
p_dtmTransaction timestamp,
p_szOfficerId BOS_DT_szId,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szEmployeeId BOS_DT_szId,
p_szCashDirection varchar,
p_szChequeNo BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmMobileTransaction timestamp,
p_szJobRoutine BOS_DT_szId,
p_szCashAdvanceRequestId BOS_DT_szId,
p_szSrcTrnId BOS_DT_szMediumId,
p_szSrcDocId BOS_DT_szId,
p_szSrcURL varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FCashTemp
SET 
dtmTransaction = p_dtmTransaction,
szOfficerId = p_szOfficerId,
szCcyRateId = p_szCcyRateId,
szCcyId = p_szCcyId,
szEmployeeId = p_szEmployeeId,
szCashDirection = p_szCashDirection,
szChequeNo = p_szChequeNo,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
dtmMobileTransaction = p_dtmMobileTransaction,
szJobRoutine = p_szJobRoutine,
szCashAdvanceRequestId=p_szCashAdvanceRequestId,
szSrcTrnId=p_szSrcTrnId,
szSrcDocId=p_szSrcDocId,
szSrcURL=p_szSrcURL
WHERE 
szFCashTempId = p_szFCashTempId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrClearing_CreateFPdrClearing(
p_szFPdrClearingId BOS_DT_szId,
p_dtmClearing timestamp,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FPdrClearing
(
szFPdrClearingId,
dtmClearing,
szDescription,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFPdrClearingId,
p_dtmClearing,
p_szDescription,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrClearing_CreateFPdrClearingItem(
p_szFPdrClearingId BOS_DT_szId,
p_shItemNumber smallint,
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FPdrClearingItem
(
szFPdrClearingId,
shItemNumber,
szBankId,
szRefId
)
VALUES
(
p_szFPdrClearingId,
p_shItemNumber,
p_szBankId,
p_szRefId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrClearing_CreateFPdrClearingItem_013(
p_szFPdrClearingId BOS_DT_szId,
p_shItemNumber smallint,
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FPdrClearingItem
(
szFPdrClearingId,
shItemNumber,
szBankId,
szRefId
)
VALUES
(
p_szFPdrClearingId,
p_shItemNumber,
p_szBankId,
p_szRefId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrClearing_DeleteFPdrClearing(
p_szFPdrClearingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_CAS_FPdrClearing
WHERE
szFPdrClearingId = p_szFPdrClearingId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrClearing_DeleteFPdrClearingItem(
p_szFPdrClearingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_CAS_FPdrClearingItem
WHERE
szFPdrClearingId = p_szFPdrClearingId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrClearing_GetFPdrClearing(
p_szFPdrClearingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT 
BOS_CAS_FPdrClearing.dtmClearing,
BOS_CAS_FPdrClearing.szDescription,
BOS_CAS_FPdrClearing.bResultFrTransfer,
BOS_CAS_FPdrClearing.bVoid,
null AS bApproved,
BOS_CAS_FPdrClearing.bApplied,
null AS bJournal,
null AS bPosted,
BOS_CAS_FPdrClearing.btPrintedCount,
BOS_CAS_FPdrClearing.bTransferred,
BOS_CAS_FPdrClearing.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_CAS_FPdrClearing.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_CAS_FPdrClearing.szTaxEntityId,
BOS_CAS_FPdrClearing.bNeedApproval,
BOS_CAS_FPdrClearing.gdApprovedId,
'' AS szApprovalId,
null AS szFJournalId ,
BOS_CAS_FPdrClearing.dtmCreated,
null AS bSystemCreated,
BOS_CAS_FPdrClearing.dtmLastUpdated,
BOS_CAS_FPdrClearing.bAlreadyTransferred

FROM 
BOS_CAS_FPdrClearing
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_CAS_FPdrClearing.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_FPdrClearing.szWorkplaceId
WHERE
szFPdrClearingId = p_szFPdrClearingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrClearing_GetFPdrClearingItem(
p_szFPdrClearingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_CAS_FPdrClearingItem.szBankId,
BOS_CAS_FPdrClearingItem.szRefId

FROM 
BOS_CAS_FPdrClearingItem
WHERE 
szFPdrClearingId = p_szFPdrClearingId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrClearing_GetListOfFPdrClearing()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFPdrClearingId,
dtmClearing

FROM 
BOS_CAS_FPdrClearing;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrClearing_IsFPdrClearingExist(
p_szFPdrClearingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFPdrClearingId

FROM 
BOS_CAS_FPdrClearing
WHERE 
szFPdrClearingId = p_szFPdrClearingId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrClearing_LockFPdrClearing(
p_szFPdrClearingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FPdrClearing
SET 
szDescription = szDescription
WHERE 
szFPdrClearingId = p_szFPdrClearingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrClearing_UpdateFPdrClearing(
p_szFPdrClearingId BOS_DT_szId,
p_dtmClearing timestamp,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FPdrClearing
SET 
dtmClearing = p_dtmClearing,
szDescription = p_szDescription,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId
WHERE 
szFPdrClearingId = p_szFPdrClearingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrDeposit_CreateFPdrDeposit(
p_szFPdrDepositId BOS_DT_szId,
p_dtmDeposit timestamp,
p_szDescription BOS_DT_szDescription,
p_szDepositBankId BOS_DT_szId,
p_szClearingAccId BOS_DT_szId,
p_szClearingSubAccId BOS_DT_szGLAccount,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FPdrDeposit
(
szFPdrDepositId,
dtmDeposit,
szDescription,
szDepositBankId,
szClearingAccId,
szClearingSubAccId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
dtmCreated,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFPdrDepositId,
p_dtmDeposit,
p_szDescription,
p_szDepositBankId,
p_szClearingAccId,
p_szClearingSubAccId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_dtmCreated,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrDeposit_CreateFPdrDeposit_013(
p_szFPdrDepositId BOS_DT_szId,
p_dtmDeposit timestamp,
p_szDescription BOS_DT_szDescription,
p_szDepositBankId BOS_DT_szId,
p_szClearingAccId BOS_DT_szId,
p_szClearingSubAccId BOS_DT_szGLAccount,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FPdrDeposit
(
szFPdrDepositId,
dtmDeposit,
szDescription,
szDepositBankId,
szClearingAccId,
szClearingSubAccId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
dtmCreated,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFPdrDepositId,
p_dtmDeposit,
p_szDescription,
p_szDepositBankId,
p_szClearingAccId,
p_szClearingSubAccId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_dtmCreated,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrDeposit_CreateFPdrDepositItem(
p_szFPdrDepositId BOS_DT_szId,
p_shItemNumber smallint,
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FPdrDepositItem
(
szFPdrDepositId,
shItemNumber,
szBankId,
szRefId
)
VALUES
(
p_szFPdrDepositId,
p_shItemNumber,
p_szBankId,
p_szRefId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrDeposit_CreateFPdrDepositItem_013(
p_szFPdrDepositId BOS_DT_szId,
p_shItemNumber smallint,
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FPdrDepositItem
(
szFPdrDepositId,
shItemNumber,
szBankId,
szRefId
)
VALUES
(
p_szFPdrDepositId,
p_shItemNumber,
p_szBankId,
p_szRefId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrDeposit_DeleteFPdrDeposit(
p_szFPdrDepositId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_CAS_FPdrDeposit
WHERE
szFPdrDepositId = p_szFPdrDepositId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrDeposit_DeleteFPdrDepositItem(
p_szFPdrDepositId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_CAS_FPdrDepositItem
WHERE
szFPdrDepositId = p_szFPdrDepositId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrDeposit_GetFPdrDeposit(
p_szFPdrDepositId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_CAS_FPdrDeposit.szFPdrDepositId,
BOS_CAS_FPdrDeposit.dtmDeposit,
BOS_CAS_FPdrDeposit.szDescription,

BOS_CAS_FPdrDeposit.szDepositBankId,
BOS_CAS_Bank.szName as szDepositBankNm,

BOS_CAS_FPdrDeposit.szClearingAccId,
BOS_GL_Account.szName as szClearingAccNm,

BOS_CAS_FPdrDeposit.szClearingSubAccId,
BOS_GL_GLSubAcc.szDescription as szClearingSubAccNm,

BOS_CAS_FPdrDeposit.bResultFrTransfer,
BOS_CAS_FPdrDeposit.bVoid,
BOS_GEN_Approved.bApproved,
BOS_CAS_FPdrDeposit.bApplied,
BOS_CAS_FPdrDeposit.btPrintedCount,
BOS_CAS_FPdrDeposit.bTransferred,
BOS_CAS_FPdrDeposit.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_CAS_FPdrDeposit.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_CAS_FPdrDeposit.szTaxEntityId,
BOS_CAS_FPdrDeposit.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
null as szFJournalId,
null as bJournal,
null as bPosted,
BOS_CAS_FPdrDeposit.dtmCreated,
null as bSystemCreated,

BOS_CAS_FPdrDeposit.dtmLastUpdated,
BOS_CAS_FPdrDeposit.bAlreadyTransferred

FROM
BOS_CAS_FPdrDeposit
LEFT JOIN BOS_GEN_Approved ON BOS_CAS_FPdrDeposit .gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_CAS_Bank ON BOS_CAS_Bank.szBankId = BOS_CAS_FPdrDeposit.szDepositBankId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_CAS_FPdrDeposit.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_FPdrDeposit.szWorkplaceId

LEFT JOIN BOS_GL_Account ON BOS_GL_Account.szAccountId = BOS_CAS_FPdrDeposit.szClearingAccId
LEFT JOIN BOS_GL_GLSubAcc ON BOS_GL_GLSubAcc.szLedgerId = BOS_GL_Company.szLedgerId
AND BOS_GL_GLSubAcc.szGLSubAccId = BOS_CAS_FPdrDeposit.szClearingSubAccId

WHERE
BOS_CAS_FPdrDeposit.szFPdrDepositId = p_szFPdrDepositId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrDeposit_GetFPdrDepositItem(
p_szFPdrDepositId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_CAS_FPdrDepositItem.szBankId,
BOS_CAS_FPdrDepositItem.szRefId

FROM 
BOS_CAS_FPdrDepositItem
LEFT JOIN BOS_CAS_FPdrDeposit ON BOS_CAS_FPdrDepositItem.szFPdrDepositId = BOS_CAS_FPdrDeposit.szFPdrDepositIdLEFT JOIN BOS_CAS_FPdrDeposit ON BOS_CAS_FPdrDepositItem.szFPdrDepositId = BOS_CAS_FPdrDeposit.szFPdrDepositId
WHERE 
BOS_CAS_FPdrDepositItem.szFPdrDepositId = p_szFPdrDepositId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrDeposit_GetListOfFPdrDeposit()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFPdrDepositId,
dtmDeposit,
szDescription


FROM 
BOS_CAS_FPdrDeposit;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrDeposit_IsFPdrDepositExist(
p_szFPdrDepositId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFPdrDepositId

FROM 
BOS_CAS_FPdrDeposit
WHERE 
szFPdrDepositId = p_szFPdrDepositId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrDeposit_LockFPdrDeposit(
p_szFPdrDepositId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FPdrDeposit
SET 
szDescription= szDescription
WHERE 
szFPdrDepositId = p_szFPdrDepositId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrDeposit_UpdateFPdrDeposit(
p_szFPdrDepositId BOS_DT_szId,
p_dtmDeposit timestamp,
p_szDescription BOS_DT_szDescription,
p_szDepositBankId BOS_DT_szId,
p_szClearingAccId BOS_DT_szId,
p_szClearingSubAccId BOS_DT_szGLAccount,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FPdrDeposit
SET 
dtmDeposit = p_dtmDeposit,
szDescription = p_szDescription,
szDepositBankId = p_szDepositBankId,
szClearingAccId = p_szClearingAccId,
szClearingSubAccId = p_szClearingSubAccId,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

-- Data Status
dtmLastUpdated = p_dtmLastUpdated,
bAlreadyTransferred = p_bAlreadyTransferred

WHERE 
szFPdrDepositId = p_szFPdrDepositId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrDeposit_UpdateFPdrDeposit_013(
p_szFPdrDepositId BOS_DT_szId,
p_dtmDeposit timestamp,
p_szDescription BOS_DT_szDescription,
p_szDepositBankId BOS_DT_szId,
p_szClearingAccId BOS_DT_szId,
p_szClearingSubAccId BOS_DT_szGLAccount,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FPdrDeposit
SET 
dtmDeposit = p_dtmDeposit,
szDescription = p_szDescription,
szDepositBankId = p_szDepositBankId,
szClearingAccId = p_szClearingAccId,
szClearingSubAccId = p_szClearingSubAccId,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

-- Data Status
dtmLastUpdated = p_dtmLastUpdated,
bAlreadyTransferred = p_bAlreadyTransferred

WHERE 
szFPdrDepositId = p_szFPdrDepositId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReceipt_CreateFPdrReceipt(
p_szFPdrReceiptId BOS_DT_szId,
p_dtmPdrReceipt timestamp,
p_szDescription BOS_DT_szDescription,
p_decControlAmount BOS_DT_decAmount,
p_bAssumeValuable bit,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szDeposanId BOS_DT_szId,
p_szPayForAccId BOS_DT_szId,
p_szPayForSubAccId BOS_DT_szGLAccount,
p_szUnclearPdrAccId BOS_DT_szId,
p_szUnclearPdrSubAccId BOS_DT_szGLAccount,
p_szFCashTempId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_dtmMobileTransaction timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FPdrReceipt
(
szFPdrReceiptId ,
dtmPdrReceipt ,
szDescription ,
decControlAmount ,
bAssumeValuable ,
szCcyRateId,
szCcyId,
szDeposanId,
szPayForAccId,
szPayForSubAccId,
szUnclearPdrAccId,
szUnclearPdrSubAccId,
szFCashTempId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
dtmLastUpdated,
bAlreadyTransferred,
dtmMobileTransaction
)
VALUES
(
p_szFPdrReceiptId ,
p_dtmPdrReceipt ,
p_szDescription ,
p_decControlAmount ,
p_bAssumeValuable ,
p_szCcyRateId,
p_szCcyId,
p_szDeposanId,
p_szPayForAccId,
p_szPayForSubAccId,
p_szUnclearPdrAccId,
p_szUnclearPdrSubAccId,
p_szFCashTempId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_dtmMobileTransaction
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReceipt_CreateFPdrReceipt_013(
p_szFPdrReceiptId BOS_DT_szId,
p_dtmPdrReceipt timestamp,
p_szDescription BOS_DT_szDescription,
p_decControlAmount BOS_DT_decAmount,
p_bAssumeValuable bit,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szDeposanId BOS_DT_szId,
p_szPayForAccId BOS_DT_szId,
p_szPayForSubAccId BOS_DT_szGLAccount,
p_szUnclearPdrAccId BOS_DT_szId,
p_szUnclearPdrSubAccId BOS_DT_szGLAccount,
p_szFCashTempId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_dtmMobileTransaction timestamp,
p_szOfficerId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FPdrReceipt
(
szFPdrReceiptId ,
dtmPdrReceipt ,
szDescription ,
decControlAmount ,
bAssumeValuable ,
szCcyRateId,
szCcyId,
szDeposanId,
szPayForAccId,
szPayForSubAccId,
szUnclearPdrAccId,
szUnclearPdrSubAccId,
szFCashTempId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
dtmLastUpdated,
bAlreadyTransferred,
dtmMobileTransaction,
szOfficerId
)
VALUES
(
p_szFPdrReceiptId ,
p_dtmPdrReceipt ,
p_szDescription ,
p_decControlAmount ,
p_bAssumeValuable ,
p_szCcyRateId,
p_szCcyId,
p_szDeposanId,
p_szPayForAccId,
p_szPayForSubAccId,
p_szUnclearPdrAccId,
p_szUnclearPdrSubAccId,
p_szFCashTempId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_dtmMobileTransaction,
p_szOfficerId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReceipt_CreateFPdrReceiptItem(
p_szFPdrReceiptId BOS_DT_szId,
p_shItemNumber smallint,
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_dtmDue timestamp,
p_dtmPdr timestamp,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FPdrReceiptItem
(
szFPdrReceiptId,
shItemNumber,
szBankId,
szRefId,
szCustId,
decAmount,
dtmDue,
dtmPdr,
szDescription
)
VALUES
(
p_szFPdrReceiptId,
p_shItemNumber,
p_szBankId,
p_szRefId,
p_szCustId,
p_decAmount,
p_dtmDue,
p_dtmPdr,
p_szDescription
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReceipt_CreateFPdrReceiptItem_013(
p_szFPdrReceiptId BOS_DT_szId,
p_shItemNumber smallint,
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_dtmDue timestamp,
p_dtmPdr timestamp,
p_szDescription BOS_DT_szDescription,
p_custBankAccountNo BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FPdrReceiptItem  
(
szFPdrReceiptId,
shItemNumber,
szBankId,
szRefId,
szCustId,
decAmount,
dtmDue,
dtmPdr,
szDescription,
custBankAccountNo
)
VALUES
(
p_szFPdrReceiptId,
p_shItemNumber,
p_szBankId,
p_szRefId,
p_szCustId,
p_decAmount,
p_dtmDue,
p_dtmPdr,
p_szDescription,
p_custBankAccountNo
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReceipt_DeleteFPdrReceipt(
p_szFPdrReceiptId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReceipt_DeleteFPdrReceiptItem(
p_szFPdrReceiptId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_CAS_FPdrReceiptItem
WHERE
szFPdrReceiptId=p_szFPdrReceiptId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReceipt_GetFPdrReceipt(
p_szFPdrReceiptId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT  
BOS_CAS_FPdrReceipt.dtmPdrReceipt ,  
BOS_CAS_FPdrReceipt.szDescription ,  
BOS_CAS_FPdrReceipt.decControlAmount ,  
BOS_CAS_FPdrReceipt.bAssumeValuable ,  

BOS_CAS_FPdrReceipt.szCcyRateId,  

BOS_CAS_FPdrReceipt.szCcyId,  
BOS_CU_Currency.szSymbol as szCcySymbol,  
BOS_CU_Currency.szAmountFormat,  

BOS_CAS_FPdrReceipt.szDeposanId,  
BOS_PI_Employee.szName as szDeposanNm,  

BOS_CAS_FPdrReceipt.szPayForAccId,  
BOS_CAS_FPdrReceipt.szPayForSubAccId,  

PAY_FOR_ACC.szName as szPayForAccNm,  
PAY_FOR_SUB_ACC.szDescription as szPayForSubAccNm,  

BOS_CAS_FPdrReceipt.szUnclearPdrAccId,  
BOS_CAS_FPdrReceipt.szUnclearPdrSubAccId,  

UNCLEAR_ACC.szName as szUnclearPdrAccNm,  
UNCLEAR_SUB_ACC.szDescription as szUnclearPdrSubAccNm,  

BOS_CAS_FPdrReceipt.szFCashTempId,  

BOS_CAS_FPdrReceipt.bResultFrTransfer,  
BOS_CAS_FPdrReceipt.bVoid,  
BOS_GEN_Approved.bApproved,  
BOS_CAS_FPdrReceipt.bApplied,  
BOS_GL_FJournalTrans.szFJournalId as bJournal,  
BOS_GL_FJournalTrans.bPosted,  
BOS_CAS_FPdrReceipt.btPrintedCount,  
BOS_CAS_FPdrReceipt.bTransferred,  
BOS_CAS_FPdrReceipt.szCompanyId,  
BOS_GL_Company.szName as szCompanyNm,  
BOS_CAS_FPdrReceipt.szWorkplaceId,  
BOS_GL_Workplace.szName as szWorkplaceNm,  
BOS_CAS_FPdrReceipt.szTaxEntityId,  
BOS_CAS_FPdrReceipt.bNeedApproval,  
BOS_CAS_FPdrReceipt.gdApprovedId,  
BOS_GEN_Approved.szApprovalId,  
BOS_GL_FJournalTrans.szFJournalId,  
BOS_CAS_FPdrReceipt.dtmCreated,  
BOS_CAS_FPdrReceipt.bSystemCreated,  

BOS_CAS_FPdrReceipt.dtmLastUpdated,  
BOS_CAS_FPdrReceipt.bAlreadyTransferred,  
BOS_CAS_FPdrReceipt.dtmMobileTransaction,

BOS_CAS_FPdrReceipt.szOfficerId,
ISNULL(BOS_SM_User.szName, '') AS szOfficerNm 

FROM  
BOS_CAS_FPdrReceipt 
LEFT JOIN BOS_GEN_Approved ON BOS_CAS_FPdrReceipt.gdApprovedId = BOS_GEN_Approved.gdApprovedId  
LEFT JOIN BOS_GL_FJournalTrans ON BOS_CAS_FPdrReceipt.szFJournalId = BOS_GL_FJournalTrans.szFJournalId  
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_FPdrReceipt.szCcyId  
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_FPdrReceipt.szDeposanId  

LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_CAS_FPdrReceipt.szCompanyId  
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_FPdrReceipt.szWorkplaceId  

LEFT JOIN BOS_GL_Account AS PAY_FOR_ACC ON PAY_FOR_ACC.szAccountId = BOS_CAS_FPdrReceipt.szPayForAccId  
LEFT JOIN BOS_GL_GLSubAcc AS PAY_FOR_SUB_ACC ON PAY_FOR_SUB_ACC.szLedgerId = BOS_GL_Company.szLedgerId  
AND PAY_FOR_SUB_ACC.szGLSubAccId = BOS_CAS_FPdrReceipt.szPayForSubAccId  

LEFT JOIN BOS_GL_Account AS UNCLEAR_ACC ON UNCLEAR_ACC.szAccountId = BOS_CAS_FPdrReceipt.szUnclearPdrAccId  
LEFT JOIN BOS_GL_GLSubAcc AS UNCLEAR_SUB_ACC ON UNCLEAR_SUB_ACC.szLedgerId = BOS_GL_Company.szLedgerId  
AND UNCLEAR_SUB_ACC.szGLSubAccId = BOS_CAS_FPdrReceipt.szUnclearPdrSubAccId  

LEFT JOIN BOS_SM_User ON  BOS_SM_User.szUserId = BOS_CAS_FPdrReceipt.szOfficerId

WHERE  
BOS_CAS_FPdrReceipt.szFPdrReceiptId = p_szFPdrReceiptId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReceipt_GetFPdrReceipt_014(
p_szFPdrReceiptId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT  
BOS_CAS_FPdrReceipt.dtmPdrReceipt ,  
BOS_CAS_FPdrReceipt.szDescription ,  
BOS_CAS_FPdrReceipt.decControlAmount ,  
BOS_CAS_FPdrReceipt.bAssumeValuable ,  

BOS_CAS_FPdrReceipt.szCcyRateId,  

BOS_CAS_FPdrReceipt.szCcyId,  
BOS_CU_Currency.szSymbol as szCcySymbol,  
BOS_CU_Currency.szAmountFormat,  

BOS_CAS_FPdrReceipt.szDeposanId,  
BOS_PI_Employee.szName as szDeposanNm,  

BOS_CAS_FPdrReceipt.szPayForAccId,  
BOS_CAS_FPdrReceipt.szPayForSubAccId,  

PAY_FOR_ACC.szName as szPayForAccNm,  
PAY_FOR_SUB_ACC.szDescription as szPayForSubAccNm,  

BOS_CAS_FPdrReceipt.szUnclearPdrAccId,  
BOS_CAS_FPdrReceipt.szUnclearPdrSubAccId,  

UNCLEAR_ACC.szName as szUnclearPdrAccNm,  
UNCLEAR_SUB_ACC.szDescription as szUnclearPdrSubAccNm,  

BOS_CAS_FPdrReceipt.szFCashTempId,  

BOS_CAS_FPdrReceipt.bResultFrTransfer,  
BOS_CAS_FPdrReceipt.bVoid,  
BOS_GEN_Approved.bApproved,  
BOS_CAS_FPdrReceipt.bApplied,  
BOS_GL_FJournalTrans.szFJournalId as bJournal,  
BOS_GL_FJournalTrans.bPosted,  
BOS_CAS_FPdrReceipt.btPrintedCount,  
BOS_CAS_FPdrReceipt.bTransferred,  
BOS_CAS_FPdrReceipt.szCompanyId,  
BOS_GL_Company.szName as szCompanyNm,  
BOS_CAS_FPdrReceipt.szWorkplaceId,  
BOS_GL_Workplace.szName as szWorkplaceNm,  
BOS_CAS_FPdrReceipt.szTaxEntityId,  
BOS_CAS_FPdrReceipt.bNeedApproval,  
BOS_CAS_FPdrReceipt.gdApprovedId,  
BOS_GEN_Approved.szApprovalId,  
BOS_GL_FJournalTrans.szFJournalId,  
BOS_CAS_FPdrReceipt.dtmCreated,  
BOS_CAS_FPdrReceipt.bSystemCreated,  

BOS_CAS_FPdrReceipt.dtmLastUpdated,  
BOS_CAS_FPdrReceipt.bAlreadyTransferred,  
BOS_CAS_FPdrReceipt.dtmMobileTransaction,

BOS_CAS_FPdrReceipt.szOfficerId,
ISNULL(BOS_SM_User.szName, '') AS szOfficerNm 

FROM  
BOS_CAS_FPdrReceipt 
LEFT JOIN BOS_GEN_Approved ON BOS_CAS_FPdrReceipt.gdApprovedId = BOS_GEN_Approved.gdApprovedId  
LEFT JOIN BOS_GL_FJournalTrans ON BOS_CAS_FPdrReceipt.szFJournalId = BOS_GL_FJournalTrans.szFJournalId  
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_FPdrReceipt.szCcyId  
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_FPdrReceipt.szDeposanId  

LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_CAS_FPdrReceipt.szCompanyId  
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_FPdrReceipt.szWorkplaceId  

LEFT JOIN BOS_GL_Account AS PAY_FOR_ACC ON PAY_FOR_ACC.szAccountId = BOS_CAS_FPdrReceipt.szPayForAccId  
LEFT JOIN BOS_GL_GLSubAcc AS PAY_FOR_SUB_ACC ON PAY_FOR_SUB_ACC.szLedgerId = BOS_GL_Company.szLedgerId  
AND PAY_FOR_SUB_ACC.szGLSubAccId = BOS_CAS_FPdrReceipt.szPayForSubAccId  

LEFT JOIN BOS_GL_Account AS UNCLEAR_ACC ON UNCLEAR_ACC.szAccountId = BOS_CAS_FPdrReceipt.szUnclearPdrAccId  
LEFT JOIN BOS_GL_GLSubAcc AS UNCLEAR_SUB_ACC ON UNCLEAR_SUB_ACC.szLedgerId = BOS_GL_Company.szLedgerId  
AND UNCLEAR_SUB_ACC.szGLSubAccId = BOS_CAS_FPdrReceipt.szUnclearPdrSubAccId  

LEFT JOIN BOS_SM_User ON  BOS_SM_User.szUserId = BOS_CAS_FPdrReceipt.szOfficerId

WHERE  
BOS_CAS_FPdrReceipt.szFPdrReceiptId = p_szFPdrReceiptId;


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReceipt_GetFPdrReceiptItem(
p_szFPdrReceiptId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_CAS_FPdrReceiptItem.shItemNumber,
BOS_CAS_FPdrReceiptItem.szBankId,
BOS_CAS_Bank.szName AS szBankNm,
BOS_CAS_FPdrReceiptItem.szRefId,
BOS_CAS_FPdrReceiptItem.szCustId,
BOS_AR_Customer.szName AS szCustNm,
BOS_CAS_FPdrReceiptItem.decAmount,
BOS_CAS_FPdrReceiptItem.dtmDue,
BOS_CAS_FPdrReceiptItem.dtmPdr,
BOS_CAS_FPdrReceiptItem.szDescription
FROM
BOS_CAS_FPdrReceiptItem
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_CAS_FPdrReceiptItem.szCustId
LEFT JOIN BOS_CAS_Bank ON BOS_CAS_Bank.szBankId = BOS_CAS_FPdrReceiptItem.szBankId
WHERE
szFPdrReceiptId = p_szFPdrReceiptId
ORDER BY
BOS_CAS_FPdrReceiptItem.szBankId,	
BOS_CAS_FPdrReceiptItem.szRefId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReceipt_GetFPdrReceiptItem_013(
p_szFPdrReceiptId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_CAS_FPdrReceiptItem.shItemNumber,  
BOS_CAS_FPdrReceiptItem.szBankId,  
BOS_CAS_Bank.szName AS szBankNm,  
BOS_CAS_FPdrReceiptItem.szRefId,  
BOS_CAS_FPdrReceiptItem.szCustId,  
BOS_AR_Customer.szName AS szCustNm,  
BOS_CAS_FPdrReceiptItem.decAmount,  
BOS_CAS_FPdrReceiptItem.dtmDue,  
BOS_CAS_FPdrReceiptItem.dtmPdr,  
BOS_CAS_FPdrReceiptItem.szDescription,
BOS_CAS_FPdrReceiptItem.custBankAccountNo  
FROM  
BOS_CAS_FPdrReceiptItem  
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_CAS_FPdrReceiptItem.szCustId  
LEFT JOIN BOS_CAS_Bank ON BOS_CAS_Bank.szBankId = BOS_CAS_FPdrReceiptItem.szBankId  
WHERE  
szFPdrReceiptId = p_szFPdrReceiptId  
ORDER BY  
BOS_CAS_FPdrReceiptItem.szBankId,   
BOS_CAS_FPdrReceiptItem.szRefId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReceipt_GetListOfFPdrReceipt()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFPdrReceiptId,
szDescription,
dtmPdrReceipt

FROM 
BOS_CAS_FPdrReceipt;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReceipt_IsFPdrReceiptExist(
p_szFPdrReceiptId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFPdrReceiptId

FROM 
BOS_CAS_FPdrReceipt
WHERE 
szFPdrReceiptId = p_szFPdrReceiptId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReceipt_LockFPdrReceipt(
p_szFPdrReceiptId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FPdrReceipt
SET 
dtmPdrReceipt = dtmPdrReceipt
WHERE 
szFPdrReceiptId = p_szFPdrReceiptId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReceipt_MarkFPdrReceiptApplied(
p_szFPdrReceiptId BOS_DT_szId,
p_bApplied smallint)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FPdrReceipt
SET 
bApplied = p_bApplied
WHERE 
szFPdrReceiptId = p_szFPdrReceiptId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReceipt_UpdateFCashTempId(
p_szFPdrReceiptId BOS_DT_szId,
p_szFCashTempId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FPdrReceipt
SET 
szFCashTempId = p_szFCashTempId
WHERE 
szFPdrReceiptId=p_szFPdrReceiptId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReceipt_UpdateFPdrReceipt(
p_szFPdrReceiptId BOS_DT_szId,
p_dtmPdrReceipt timestamp,
p_szDescription BOS_DT_szDescription,
p_decControlAmount BOS_DT_decAmount,
p_bAssumeValuable bit,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szDeposanId BOS_DT_szId,
p_szPayForAccId BOS_DT_szId,
p_szPayForSubAccId BOS_DT_szGLAccount,
p_szUnclearPdrAccId BOS_DT_szId,
p_szUnclearPdrSubAccId BOS_DT_szGLAccount,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmMobileTransaction timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FPdrReceipt
SET 
dtmPdrReceipt = p_dtmPdrReceipt ,
szDescription = p_szDescription ,
decControlAmount = p_decControlAmount ,
bAssumeValuable = p_bAssumeValuable ,
szCcyRateId = p_szCcyRateId,
szCcyId = p_szCcyId,
szDeposanId = p_szDeposanId,
szPayForAccId = p_szPayForAccId,
szPayForSubAccId = p_szPayForSubAccId,
szUnclearPdrAccId = p_szUnclearPdrAccId,
szUnclearPdrSubAccId = p_szUnclearPdrSubAccId,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
dtmMobileTransaction =p_dtmMobileTransaction
WHERE 
szFPdrReceiptId=p_szFPdrReceiptId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReceipt_UpdateFPdrReceipt_013(
p_szFPdrReceiptId BOS_DT_szId,
p_dtmPdrReceipt timestamp,
p_szDescription BOS_DT_szDescription,
p_decControlAmount BOS_DT_decAmount,
p_bAssumeValuable bit,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szDeposanId BOS_DT_szId,
p_szPayForAccId BOS_DT_szId,
p_szPayForSubAccId BOS_DT_szGLAccount,
p_szUnclearPdrAccId BOS_DT_szId,
p_szUnclearPdrSubAccId BOS_DT_szGLAccount,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmMobileTransaction timestamp,
p_szOfficerId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FPdrReceipt
SET 
dtmPdrReceipt = p_dtmPdrReceipt ,
szDescription = p_szDescription ,
decControlAmount = p_decControlAmount ,
bAssumeValuable = p_bAssumeValuable ,
szCcyRateId = p_szCcyRateId,
szCcyId = p_szCcyId,
szDeposanId = p_szDeposanId,
szPayForAccId = p_szPayForAccId,
szPayForSubAccId = p_szPayForSubAccId,
szUnclearPdrAccId = p_szUnclearPdrAccId,
szUnclearPdrSubAccId = p_szUnclearPdrSubAccId,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
dtmMobileTransaction =p_dtmMobileTransaction,
szOfficerId = p_szOfficerId
WHERE 
szFPdrReceiptId=p_szFPdrReceiptId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReject_CreateFPdrReject(
p_szFPdrRejectId BOS_DT_szId,
p_dtmReject timestamp,
p_szDescription BOS_DT_szDescription,
p_szReasonId BOS_DT_szId,
p_bPDRCancellation smallint,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szOfficerId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FPdrReject
(
szFPdrRejectId,
dtmReject,
szDescription,
szReasonId,
bPDRCancellation,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
dtmCreated,
dtmLastUpdated,
bAlreadyTransferred,
szOfficerId
)
VALUES
(
p_szFPdrRejectId,
p_dtmReject,
p_szDescription,
p_szReasonId,
p_bPDRCancellation,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_dtmCreated,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szOfficerId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReject_CreateFPdrReject_014(
p_szFPdrRejectId BOS_DT_szId,
p_dtmReject timestamp,
p_szDescription BOS_DT_szDescription,
p_szReasonId BOS_DT_szId,
p_bPDRCancellation smallint,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szOfficerId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FPdrReject
(
szFPdrRejectId,
dtmReject,
szDescription,
szReasonId,
bPDRCancellation,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
dtmCreated,
dtmLastUpdated,
bAlreadyTransferred,
szOfficerId
)
VALUES
(
p_szFPdrRejectId,
p_dtmReject,
p_szDescription,
p_szReasonId,
p_bPDRCancellation,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_dtmCreated,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szOfficerId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReject_CreateFPdrRejectItem(
p_szFPdrRejectId BOS_DT_szId,
p_shItemNumber smallint,
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FPdrRejectItem
(
szFPdrRejectId,
shItemNumber,
szBankId,
szRefId
)
VALUES
(
p_szFPdrRejectId,
p_shItemNumber,
p_szBankId,
p_szRefId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReject_CreateFPdrRejectItem_013(
p_szFPdrRejectId BOS_DT_szId,
p_shItemNumber smallint,
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_FPdrRejectItem
(
szFPdrRejectId,
shItemNumber,
szBankId,
szRefId
)
VALUES
(
p_szFPdrRejectId,
p_shItemNumber,
p_szBankId,
p_szRefId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReject_DeleteFPdrReject(
p_szFPdrRejectId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_CAS_FPdrReject
WHERE
szFPdrRejectId = p_szFPdrRejectId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReject_DeleteFPdrRejectItem(
p_szFPdrRejectId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_CAS_FPdrRejectItem
WHERE
szFPdrRejectId = p_szFPdrRejectId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReject_GetFPdrReject(
p_szFPdrRejectId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT   
BOS_CAS_FPdrReject.dtmReject,  
BOS_CAS_FPdrReject.szDescription,  
BOS_CAS_FPdrReject.szReasonId,  
BOS_CAS_FPdrReject.bPDRCancellation,  
BOS_CAS_FPdrReject.bResultFrTransfer,  
BOS_CAS_FPdrReject.bVoid,  
BOS_GEN_Approved.bApproved,  
BOS_CAS_FPdrReject.bApplied,  
null AS bJournal,  
null AS bPosted,  
BOS_CAS_FPdrReject.btPrintedCount,  
BOS_CAS_FPdrReject.bTransferred,  
BOS_CAS_FPdrReject.szCompanyId,  
BOS_GL_Company.szName as szCompanyNm,  
BOS_CAS_FPdrReject.szWorkplaceId,  
BOS_GL_Workplace.szName as szWorkplaceNm,  
BOS_CAS_FPdrReject.szTaxEntityId,  
BOS_CAS_FPdrReject.bNeedApproval,  
BOS_GEN_Approved.gdApprovedId,  
BOS_GEN_Approved.szApprovalId,  
'' AS szFJournalId,  
BOS_CAS_FPdrReject.dtmCreated,  
null AS bSystemCreated,  

BOS_CAS_FPdrReject.dtmLastUpdated,  
BOS_CAS_FPdrReject.bAlreadyTransferred,

BOS_CAS_FPdrReject.szOfficerId,
ISNULL(BOS_SM_User.szName, '') AS szOfficerNm   

FROM   
BOS_CAS_FPdrReject 
left join BOS_GEN_Approved on BOS_CAS_FPdrReject.gdApprovedId = BOS_GEN_Approved.gdApprovedId  
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_CAS_FPdrReject.szCompanyId  
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_FPdrReject.szWorkplaceId  
LEFT JOIN BOS_SM_User ON  BOS_SM_User.szUserId = BOS_CAS_FPdrReject.szOfficerId
WHERE  
BOS_CAS_FPdrReject.szFPdrRejectId = p_szFPdrRejectId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReject_GetFPdrReject_014(
p_szFPdrRejectId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT   
BOS_CAS_FPdrReject.dtmReject,  
BOS_CAS_FPdrReject.szDescription,  
BOS_CAS_FPdrReject.szReasonId,  
BOS_CAS_FPdrReject.bPDRCancellation,  
BOS_CAS_FPdrReject.bResultFrTransfer,  
BOS_CAS_FPdrReject.bVoid,  
BOS_GEN_Approved.bApproved,  
BOS_CAS_FPdrReject.bApplied,  
null AS bJournal,  
null AS bPosted,  
BOS_CAS_FPdrReject.btPrintedCount,  
BOS_CAS_FPdrReject.bTransferred,  
BOS_CAS_FPdrReject.szCompanyId,  
BOS_GL_Company.szName as szCompanyNm,  
BOS_CAS_FPdrReject.szWorkplaceId,  
BOS_GL_Workplace.szName as szWorkplaceNm,  
BOS_CAS_FPdrReject.szTaxEntityId,  
BOS_CAS_FPdrReject.bNeedApproval,  
BOS_GEN_Approved.gdApprovedId,  
BOS_GEN_Approved.szApprovalId,  
'' AS szFJournalId,  
BOS_CAS_FPdrReject.dtmCreated,  
null AS bSystemCreated,  

BOS_CAS_FPdrReject.dtmLastUpdated,  
BOS_CAS_FPdrReject.bAlreadyTransferred,

BOS_CAS_FPdrReject.szOfficerId,
ISNULL(BOS_SM_User.szName, '') AS szOfficerNm   

FROM   
BOS_CAS_FPdrReject 
left join BOS_GEN_Approved on BOS_CAS_FPdrReject.gdApprovedId = BOS_GEN_Approved.gdApprovedId  
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_CAS_FPdrReject.szCompanyId  
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_FPdrReject.szWorkplaceId  
LEFT JOIN BOS_SM_User ON  BOS_SM_User.szUserId = BOS_CAS_FPdrReject.szOfficerId
WHERE  
BOS_CAS_FPdrReject.szFPdrRejectId = p_szFPdrRejectId;


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReject_GetFPdrRejectItem(
p_szFPdrRejectId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_CAS_FPdrRejectItem.szBankId,
BOS_CAS_FPdrRejectItem.szRefId

FROM 
BOS_CAS_FPdrRejectItem
LEFT JOIN BOS_CAS_Pdr ON BOS_CAS_Pdr.szBankId = BOS_CAS_FPdrRejectItem.szBankId AND BOS_CAS_Pdr.szRefId = BOS_CAS_FPdrRejectItem.szRefIdLEFT JOIN BOS_CAS_Pdr ON BOS_CAS_Pdr.szBankId = BOS_CAS_FPdrRejectItem.szBankId AND BOS_CAS_Pdr.szRefId = BOS_CAS_FPdrRejectItem.szRefId

WHERE 
szFPdrRejectId = p_szFPdrRejectId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReject_GetListOfFPdrReject()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFPdrRejectId,
dtmReject,
szDescription

FROM 
BOS_CAS_FPdrReject;
--G

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReject_IsFPdrRejectExist(
p_szFPdrRejectId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFPdrRejectId

FROM 
BOS_CAS_FPdrReject
WHERE 
szFPdrRejectId = p_szFPdrRejectId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReject_LockFPdrReject(
p_szFPdrRejectId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FPdrReject
SET 
dtmReject = dtmReject
WHERE 
szFPdrRejectId = p_szFPdrRejectId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReject_UpdateFPdrReject(
p_szFPdrRejectId BOS_DT_szId,
p_dtmReject timestamp,
p_szDescription BOS_DT_szDescription,
p_szReasonId BOS_DT_szId,
p_bPDRCancellation smallint,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szOfficerId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FPdrReject
SET 
dtmReject = p_dtmReject,
szDescription = p_szDescription,
szReasonId = p_szReasonId,
bPDRCancellation = p_bPDRCancellation,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
szOfficerId = p_szOfficerId
WHERE 
szFPdrRejectId = p_szFPdrRejectId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FPdrReject_UpdateFPdrReject_014(
p_szFPdrRejectId BOS_DT_szId,
p_dtmReject timestamp,
p_szDescription BOS_DT_szDescription,
p_szReasonId BOS_DT_szId,
p_bPDRCancellation smallint,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szOfficerId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_FPdrReject
SET 
dtmReject = p_dtmReject,
szDescription = p_szDescription,
szReasonId = p_szReasonId,
bPDRCancellation = p_bPDRCancellation,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
szOfficerId = p_szOfficerId
WHERE 
szFPdrRejectId = p_szFPdrRejectId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_FReceiptSchedule_GetFReceiptSchedule(
p_szFReceiptScheduleId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_SD_FReceiptSchedule.dtmReceipt,
BOS_SD_FReceiptSchedule.szReceiptToWpId,
BOS_SD_FReceiptSchedule.szDriverId,
BOS_PI_Employee.szName AS szDriverNm,
BOS_SD_FReceiptSchedule.szVehicleId,
BOS_INV_Vehicle.szPoliceNo AS szVehicleNo,
BOS_SD_FReceiptSchedule.szStockTypeId,
BOS_SD_FReceiptSchedule.bResultFrTransfer,
BOS_SD_FReceiptSchedule.bVoid,
BOS_GEN_Approved.bApproved,
BOS_SD_FReceiptSchedule.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_SD_FReceiptSchedule.btPrintedCount,
BOS_SD_FReceiptSchedule.bTransferred,
BOS_SD_FReceiptSchedule.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_SD_FReceiptSchedule.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_SD_FReceiptSchedule.szTaxEntityId,
BOS_SD_FReceiptSchedule.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_SD_FReceiptSchedule.dtmCreated,
BOS_SD_FReceiptSchedule.bSystemCreated
FROM
BOS_SD_FReceiptSchedule
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FReceiptSchedule.szDriverId
LEFT JOIN BOS_INV_Vehicle ON BOS_INV_Vehicle.szVehicleId = BOS_SD_FReceiptSchedule.szVehicleId
LEFT JOIN BOS_GEN_Approved ON BOS_SD_FReceiptSchedule.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FReceiptSchedule.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FReceiptSchedule.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FReceiptSchedule.szWorkplaceId
WHERE
BOS_SD_FReceiptSchedule.szFReceiptScheduleId = p_szFReceiptScheduleId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Pdr_CreatePdr(
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_dtmDue timestamp,
p_szDescription BOS_DT_szDescription,
p_szStatus varchar,
p_dtmClear timestamp,
p_dtmReceipt timestamp,
p_dtmPdr timestamp,
p_dtmDeposit timestamp,
p_szRecWorkplaceId BOS_DT_szId,
p_bAssumeValuable bit,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szDepositBankId BOS_DT_szId,
p_szDeposanId BOS_DT_szId,
p_szCompanyId BOS_DT_szMediumId,
p_szLedgerId BOS_DT_szId,
p_szPayForAccId BOS_DT_szId,
p_szPayForSubAccId BOS_DT_szGLAccount,
p_szUnclearPdrAccId BOS_DT_szId,
p_szUnclearPdrSubAccId BOS_DT_szGLAccount,
p_szClearingAccId BOS_DT_szId,
p_szClearingSubAccId BOS_DT_szGLAccount,
p_decRemain BOS_DT_decAmount,
p_szFBankSettlementId BOS_DT_szId,
p_bHasReconcile bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_Pdr
(
szBankId,
szRefId,
szCustId,
decAmount,
dtmDue,
szDescription,
szStatus,
dtmClear,
dtmReceipt,
dtmPdr,
dtmDeposit,
szRecWorkplaceId,
bAssumeValuable,
szCcyRateId,
szCcyId,
szDepositBankId,
szDeposanId,
szCompanyId,
szLedgerId,
szPayForAccId,
szPayForSubAccId,
szUnclearPdrAccId,
szUnclearPdrSubAccId,
szClearingAccId,
szClearingSubAccId,
--added new field jan 04,
decRemain,
szFBankSettlementId,
bHasReconcile,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szBankId,
p_szRefId,
p_szCustId,
p_decAmount,
p_dtmDue,
p_szDescription,
p_szStatus,
p_dtmClear,
p_dtmReceipt,
p_dtmPdr,
p_dtmDeposit,
p_szRecWorkplaceId,
p_bAssumeValuable,
p_szCcyRateId,
p_szCcyId,
p_szDepositBankId,
p_szDeposanId,
p_szCompanyId,
p_szLedgerId,
p_szPayForAccId,
p_szPayForSubAccId,
p_szUnclearPdrAccId,
p_szUnclearPdrSubAccId,
p_szClearingAccId,
p_szClearingSubAccId,
--added new field jan 04,
p_decRemain,
p_szFBankSettlementId,
p_bHasReconcile,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Pdr_CreatePdr_013(
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_dtmDue timestamp,
p_szDescription BOS_DT_szDescription,
p_szStatus varchar,
p_dtmClear timestamp,
p_dtmReceipt timestamp,
p_dtmPdr timestamp,
p_dtmDeposit timestamp,
p_szRecWorkplaceId BOS_DT_szId,
p_bAssumeValuable bit,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szDepositBankId BOS_DT_szId,
p_szDeposanId BOS_DT_szId,
p_szCompanyId BOS_DT_szMediumId,
p_szLedgerId BOS_DT_szId,
p_szPayForAccId BOS_DT_szId,
p_szPayForSubAccId BOS_DT_szGLAccount,
p_szUnclearPdrAccId BOS_DT_szId,
p_szUnclearPdrSubAccId BOS_DT_szGLAccount,
p_szClearingAccId BOS_DT_szId,
p_szClearingSubAccId BOS_DT_szGLAccount,
p_decRemain BOS_DT_decAmount,
p_szFBankSettlementId BOS_DT_szId,
p_bHasReconcile bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_custBankAccountNo BOS_DT_szId,
p_szOfficerId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CAS_Pdr
(
szBankId,
szRefId,
szCustId,
decAmount,
dtmDue,
szDescription,
szStatus,
dtmClear,
dtmReceipt,
dtmPdr,
dtmDeposit,
szRecWorkplaceId,
bAssumeValuable,
szCcyRateId,
szCcyId,
szDepositBankId,
szDeposanId,
szCompanyId,
szLedgerId,
szPayForAccId,
szPayForSubAccId,
szUnclearPdrAccId,
szUnclearPdrSubAccId,
szClearingAccId,
szClearingSubAccId,
--added new field jan 04,
decRemain,
szFBankSettlementId,
bHasReconcile,
dtmLastUpdated,
bAlreadyTransferred,
custBankAccountNo,
szOfficerId
)
VALUES
(
p_szBankId,
p_szRefId,
p_szCustId,
p_decAmount,
p_dtmDue,
p_szDescription,
p_szStatus,
p_dtmClear,
p_dtmReceipt,
p_dtmPdr,
p_dtmDeposit,
p_szRecWorkplaceId,
p_bAssumeValuable,
p_szCcyRateId,
p_szCcyId,
p_szDepositBankId,
p_szDeposanId,
p_szCompanyId,
p_szLedgerId,
p_szPayForAccId,
p_szPayForSubAccId,
p_szUnclearPdrAccId,
p_szUnclearPdrSubAccId,
p_szClearingAccId,
p_szClearingSubAccId,
--added new field jan 04,
p_decRemain,
p_szFBankSettlementId,
p_bHasReconcile,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_custBankAccountNo,
p_szOfficerId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Pdr_DeletePdr(
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_CAS_Pdr
WHERE
szRefId = p_szRefId AND szBankId = p_szBankId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Pdr_DeletePdr_013(
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_CAS_Pdr
WHERE
szRefId = p_szRefId AND szBankId = p_szBankId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Pdr_GetListOfPdr()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szBankId,
szRefId,
szDescription

FROM 
BOS_CAS_Pdr;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Pdr_GetPdr(
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
p_szBankId as szBankId,
BOS_CAS_Bank.szName as szBankNm,

p_szRefId as szRefId,

BOS_CAS_Pdr.szCustId,
BOS_AR_Customer.szName as szCustNm,

BOS_CAS_Pdr.decAmount,
BOS_CAS_Pdr.dtmDue,
BOS_CAS_Pdr.szDescription,
BOS_CAS_Pdr.szStatus,
BOS_CAS_Pdr.dtmClear,
BOS_CAS_Pdr.dtmReceipt,
BOS_CAS_Pdr.dtmPdr,
BOS_CAS_Pdr.dtmDeposit,

BOS_CAS_Pdr.szRecWorkplaceId,
BOS_GL_Workplace.szName as szRecWorkplaceNm,

BOS_CAS_Pdr.bAssumeValuable,

BOS_CAS_Pdr.szCcyRateId,
BOS_CAS_Pdr.szCcyId,
BOS_CU_Currency.szSymbol as szCcySymbol,
BOS_CU_Currency.szAmountFormat,

BOS_CAS_Pdr.szDepositBankId,
BANK_DEPOSIT.szName as szDepositBankNm,

BOS_CAS_Pdr.szDeposanId,
BOS_PI_Employee.szName as szDeposanNm,

BOS_CAS_Pdr.szCompanyId,
BOS_CAS_Pdr.szLedgerId,

BOS_CAS_Pdr.szPayForAccId,
PAY_FOR_ACC.szName as szPayForAccNm,

BOS_CAS_Pdr.szPayForSubAccId,
PAY_FOR_SUB_ACC.szDescription as szPayForSubAccNm,

BOS_CAS_Pdr.szUnclearPdrAccId,
UNCLEAR_ACC.szName as szUnclearPdrAccNm,

BOS_CAS_Pdr.szUnclearPdrSubAccId,
UNCLEAR_SUB_ACC.szDescription as szUnclearPdrSubAccNm,

BOS_CAS_Pdr.szClearingAccId,
CLEARING_ACC.szName as szClearingAccNm,

BOS_CAS_Pdr.szClearingSubAccId,
CLEARING_SUB_ACC.szDescription as szClearingSubAccNm,

--added new field jan 04
BOS_CAS_Pdr.decRemain,
BOS_CAS_Pdr.szFBankSettlementId,
BOS_CAS_Pdr.bHasReconcile,

BOS_CAS_Pdr.dtmLastUpdated,
BOS_CAS_Pdr.bAlreadyTransferred

FROM
BOS_CAS_Pdr
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_CAS_Pdr.szCustId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_Pdr.szRecWorkplaceId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_Pdr.szCcyId
LEFT JOIN BOS_CAS_Bank AS BANK_DEPOSIT ON BANK_DEPOSIT.szBankId = BOS_CAS_Pdr.szDepositBankId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_Pdr.szDeposanId
LEFT JOIN BOS_CAS_Bank ON BOS_CAS_Bank.szBankId = BOS_CAS_Pdr.szBankId

LEFT JOIN BOS_GL_Account AS PAY_FOR_ACC ON PAY_FOR_ACC.szAccountId = BOS_CAS_Pdr.szPayForAccId
LEFT JOIN BOS_GL_GLSubAcc AS PAY_FOR_SUB_ACC ON PAY_FOR_SUB_ACC.szLedgerId = BOS_CAS_Pdr.szLedgerId
AND PAY_FOR_SUB_ACC.szGLSubAccId = BOS_CAS_Pdr.szPayForSubAccId

LEFT JOIN BOS_GL_Account AS UNCLEAR_ACC ON UNCLEAR_ACC.szAccountId = BOS_CAS_Pdr.szUnclearPdrAccId
LEFT JOIN BOS_GL_GLSubAcc AS UNCLEAR_SUB_ACC ON UNCLEAR_SUB_ACC.szLedgerId = BOS_CAS_Pdr.szLedgerId
AND UNCLEAR_SUB_ACC.szGLSubAccId = BOS_CAS_Pdr.szUnclearPdrSubAccId

LEFT JOIN BOS_GL_Account AS CLEARING_ACC ON CLEARING_ACC.szAccountId = BOS_CAS_Pdr.szClearingAccId
LEFT JOIN BOS_GL_GLSubAcc AS CLEARING_SUB_ACC ON CLEARING_SUB_ACC.szLedgerId = BOS_CAS_Pdr.szLedgerId
AND CLEARING_SUB_ACC.szGLSubAccId = BOS_CAS_Pdr.szClearingSubAccId

WHERE
BOS_CAS_Pdr.szRefId = p_szRefId AND BOS_CAS_Pdr.szBankId = p_szBankId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Pdr_GetPdr_013(
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT    
p_szBankId as szBankId,    
BOS_CAS_Bank.szName as szBankNm,    

p_szRefId as szRefId,    

BOS_CAS_Pdr.szCustId,    
BOS_AR_Customer.szName as szCustNm,    

BOS_CAS_Pdr.decAmount,    
BOS_CAS_Pdr.dtmDue,    
BOS_CAS_Pdr.szDescription,    
BOS_CAS_Pdr.szStatus,    
BOS_CAS_Pdr.dtmClear,    
BOS_CAS_Pdr.dtmReceipt,    
BOS_CAS_Pdr.dtmPdr,    
BOS_CAS_Pdr.dtmDeposit,    

BOS_CAS_Pdr.szRecWorkplaceId,    
BOS_GL_Workplace.szName as szRecWorkplaceNm,    

BOS_CAS_Pdr.bAssumeValuable,    

BOS_CAS_Pdr.szCcyRateId,    
BOS_CAS_Pdr.szCcyId,    
BOS_CU_Currency.szSymbol as szCcySymbol,    
BOS_CU_Currency.szAmountFormat,    

BOS_CAS_Pdr.szDepositBankId,    
BANK_DEPOSIT.szName as szDepositBankNm,    

BOS_CAS_Pdr.szDeposanId,    
BOS_PI_Employee.szName as szDeposanNm,    

BOS_CAS_Pdr.szCompanyId,    
BOS_CAS_Pdr.szLedgerId,    

BOS_CAS_Pdr.szPayForAccId,    
PAY_FOR_ACC.szName as szPayForAccNm,    

BOS_CAS_Pdr.szPayForSubAccId,    
PAY_FOR_SUB_ACC.szDescription as szPayForSubAccNm,    

BOS_CAS_Pdr.szUnclearPdrAccId,    
UNCLEAR_ACC.szName as szUnclearPdrAccNm,    

BOS_CAS_Pdr.szUnclearPdrSubAccId,    
UNCLEAR_SUB_ACC.szDescription as szUnclearPdrSubAccNm,    

BOS_CAS_Pdr.szClearingAccId,    
CLEARING_ACC.szName as szClearingAccNm,    

BOS_CAS_Pdr.szClearingSubAccId,    
CLEARING_SUB_ACC.szDescription as szClearingSubAccNm,    

--added new field jan 04    
BOS_CAS_Pdr.decRemain,    
BOS_CAS_Pdr.szFBankSettlementId,    
BOS_CAS_Pdr.bHasReconcile,    

BOS_CAS_Pdr.dtmLastUpdated,    
BOS_CAS_Pdr.bAlreadyTransferred,  
BOS_CAS_Pdr.custBankAccountNo,

BOS_CAS_Pdr.szOfficerId,
ISNULL(BOS_SM_User.szName, '') AS szOfficerNm    

FROM    
BOS_CAS_Pdr    
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_CAS_Pdr.szCustId    
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_Pdr.szRecWorkplaceId    
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_Pdr.szCcyId    
LEFT JOIN BOS_CAS_Bank AS BANK_DEPOSIT ON BANK_DEPOSIT.szBankId = BOS_CAS_Pdr.szDepositBankId    
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_Pdr.szDeposanId    
LEFT JOIN BOS_CAS_Bank ON BOS_CAS_Bank.szBankId = BOS_CAS_Pdr.szBankId    

LEFT JOIN BOS_GL_Account AS PAY_FOR_ACC ON PAY_FOR_ACC.szAccountId = BOS_CAS_Pdr.szPayForAccId    
LEFT JOIN BOS_GL_GLSubAcc AS PAY_FOR_SUB_ACC ON PAY_FOR_SUB_ACC.szLedgerId = BOS_CAS_Pdr.szLedgerId    
AND PAY_FOR_SUB_ACC.szGLSubAccId = BOS_CAS_Pdr.szPayForSubAccId    

LEFT JOIN BOS_GL_Account AS UNCLEAR_ACC ON UNCLEAR_ACC.szAccountId = BOS_CAS_Pdr.szUnclearPdrAccId    
LEFT JOIN BOS_GL_GLSubAcc AS UNCLEAR_SUB_ACC ON UNCLEAR_SUB_ACC.szLedgerId = BOS_CAS_Pdr.szLedgerId    
AND UNCLEAR_SUB_ACC.szGLSubAccId = BOS_CAS_Pdr.szUnclearPdrSubAccId    

LEFT JOIN BOS_GL_Account AS CLEARING_ACC ON CLEARING_ACC.szAccountId = BOS_CAS_Pdr.szClearingAccId    
LEFT JOIN BOS_GL_GLSubAcc AS CLEARING_SUB_ACC ON CLEARING_SUB_ACC.szLedgerId = BOS_CAS_Pdr.szLedgerId    
AND CLEARING_SUB_ACC.szGLSubAccId = BOS_CAS_Pdr.szClearingSubAccId    

LEFT JOIN BOS_SM_User ON  BOS_SM_User.szUserId = BOS_CAS_Pdr.szOfficerId 

WHERE    
BOS_CAS_Pdr.szRefId = p_szRefId AND BOS_CAS_Pdr.szBankId = p_szBankId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Pdr_IsPdrExist(
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRefId

FROM 
BOS_CAS_Pdr
WHERE 
szRefId = p_szRefId and szBankId = p_szBankId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Pdr_IsPdrExist_013(
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRefId

FROM 
BOS_CAS_Pdr
WHERE 
szRefId = p_szRefId and szBankId = p_szBankId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Pdr_LockPdr(
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_Pdr
SET 
szCustId = szCustId
WHERE 
szRefId = p_szRefId AND szBankId = p_szBankId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Pdr_LockPdr_013(
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_Pdr
SET 
szCustId = szCustId
WHERE 
szRefId = p_szRefId AND szBankId = p_szBankId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Pdr_UpdatePdr(
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_dtmDue timestamp,
p_szDescription BOS_DT_szDescription,
p_szStatus varchar,
p_dtmClear timestamp,
p_dtmReceipt timestamp,
p_dtmPdr timestamp,
p_dtmDeposit timestamp,
p_szRecWorkplaceId BOS_DT_szId,
p_bAssumeValuable bit,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szDepositBankId BOS_DT_szId,
p_szDeposanId BOS_DT_szId,
p_szCompanyId BOS_DT_szMediumId,
p_szLedgerId BOS_DT_szId,
p_szPayForAccId BOS_DT_szId,
p_szPayForSubAccId BOS_DT_szGLAccount,
p_szUnclearPdrAccId BOS_DT_szId,
p_szUnclearPdrSubAccId BOS_DT_szGLAccount,
p_szClearingAccId BOS_DT_szId,
p_szClearingSubAccId BOS_DT_szGLAccount,
p_decRemain BOS_DT_decAmount,
p_szFBankSettlementId BOS_DT_szId,
p_bHasReconcile bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_Pdr
SET 
szCustId = p_szCustId,
decAmount = p_decAmount,
dtmDue = p_dtmDue,
szDescription = p_szDescription,
szStatus = p_szStatus,
dtmClear = p_dtmClear,
dtmReceipt = p_dtmReceipt,
dtmPdr = p_dtmPdr,
dtmDeposit = p_dtmDeposit,
szRecWorkplaceId = p_szRecWorkplaceId,
bAssumeValuable = p_bAssumeValuable,
szCcyRateId = p_szCcyRateId,
szCcyId = p_szCcyId,
szDepositBankId = p_szDepositBankId,
szDeposanId = p_szDeposanId,
szCompanyId = p_szCompanyId,
szLedgerId = p_szLedgerId,
szPayForAccId = p_szPayForAccId,
szPayForSubAccId = p_szPayForSubAccId,
szUnclearPdrAccId = p_szUnclearPdrAccId,
szUnclearPdrSubAccId = p_szUnclearPdrSubAccId,
szClearingAccId = p_szClearingAccId,
szClearingSubAccId = p_szClearingSubAccId,
decRemain = p_decRemain,
szFBankSettlementId = p_szFBankSettlementId,
bHasReconcile = p_bHasReconcile

WHERE 
szRefId = p_szRefId and szBankId = p_szBankId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CAS_Pdr_UpdatePdr_013(
p_szBankId BOS_DT_szId,
p_szRefId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_dtmDue timestamp,
p_szDescription BOS_DT_szDescription,
p_szStatus varchar,
p_dtmClear timestamp,
p_dtmReceipt timestamp,
p_dtmPdr timestamp,
p_dtmDeposit timestamp,
p_szRecWorkplaceId BOS_DT_szId,
p_bAssumeValuable bit,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szDepositBankId BOS_DT_szId,
p_szDeposanId BOS_DT_szId,
p_szCompanyId BOS_DT_szMediumId,
p_szLedgerId BOS_DT_szId,
p_szPayForAccId BOS_DT_szId,
p_szPayForSubAccId BOS_DT_szGLAccount,
p_szUnclearPdrAccId BOS_DT_szId,
p_szUnclearPdrSubAccId BOS_DT_szGLAccount,
p_szClearingAccId BOS_DT_szId,
p_szClearingSubAccId BOS_DT_szGLAccount,
p_decRemain BOS_DT_decAmount,
p_szFBankSettlementId BOS_DT_szId,
p_bHasReconcile bit,
p_custBankAccountNo BOS_DT_szId,
p_szOfficerId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CAS_Pdr
SET 
szCustId = p_szCustId,
decAmount = p_decAmount,
dtmDue = p_dtmDue,
szDescription = p_szDescription,
szStatus = p_szStatus,
dtmClear = p_dtmClear,
dtmReceipt = p_dtmReceipt,
dtmPdr = p_dtmPdr,
dtmDeposit = p_dtmDeposit,
szRecWorkplaceId = p_szRecWorkplaceId,
bAssumeValuable = p_bAssumeValuable,
szCcyRateId = p_szCcyRateId,
szCcyId = p_szCcyId,
szDepositBankId = p_szDepositBankId,
szDeposanId = p_szDeposanId,
szCompanyId = p_szCompanyId,
szLedgerId = p_szLedgerId,
szPayForAccId = p_szPayForAccId,
szPayForSubAccId = p_szPayForSubAccId,
szUnclearPdrAccId = p_szUnclearPdrAccId,
szUnclearPdrSubAccId = p_szUnclearPdrSubAccId,
szClearingAccId = p_szClearingAccId,
szClearingSubAccId = p_szClearingSubAccId,
decRemain = p_decRemain,
szFBankSettlementId = p_szFBankSettlementId,
bHasReconcile = p_bHasReconcile,
custBankAccountNo = p_custBankAccountNo,
szOfficerId = p_szOfficerId
WHERE 
szRefId = p_szRefId and szBankId = p_szBankId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_CallViewer_GetListOfCallViewerForSalesData(
p_szWorkplaceId BOS_DT_szId,
p_szGroupId BOS_DT_szId,
p_szCallType BOS_DT_szSmallId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szNoMoreFollowUp varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCallId,
szCustId,
szName,
szCallType,
dtmFollowUp,
szCallReasonId

FROM 
BOS_CRL_FCall
WHERE 
/* Condition(s): - szTrackingId = ''. - szCallType = 'PRO', -- Prospect. 'CST', -- Customer Stop. 'CBA', -- Customer Basic Address Change. 'DAC', -- Delivery Address Change. 'IAC', -- Invoice Address Change. 'CAC', -- Collection Address Change. 'TAC'. -- Tax Address Change. */ 
szTrackingId = '' and 
(szCallType = 'PRO' or szCallType = 'CST' or 
szCallType = 'CBI' or szCallType = 'DAC' or 
szCallType = 'IAC' or szCallType = 'CAC' or 
szCallType = 'TAC' ) and 
szForwardToWorkplaceId like p_szWorkplaceId and 
szForwardToGroupId like p_szGroupId and 
szCallType like p_szCallType and 
(dtmDate >= p_dtmFrom And dtmDate < DateAdd(Day, 1, p_dtmTo)) and 
bNoMoreFollowUp like p_szNoMoreFollowUp and bVoid = 0 
ORDER BY 
szZipCode,
szAddress_1,
szAddress_2;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_CallViewer_GetListOfFCall(
p_szWorkplaceId BOS_DT_szId,
p_szGroupId BOS_DT_szId,
p_szCallType BOS_DT_szSmallId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szNoMoreFollowUp varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCallId

FROM 
BOS_CRL_FCall
WHERE 
szForwardToWorkplaceId like p_szWorkplaceId and 
szForwardToGroupId like p_szGroupId and 
szCallType like p_szCallType and 
(dtmDate >= p_dtmFrom And dtmDate < DateAdd(Day, 1, p_dtmTo)) and 
bNoMoreFollowUp like p_szNoMoreFollowUp and bVoid = 0 
ORDER BY 
szFCallId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_CustFUp_CreateCustFUp(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_dtmDate timestamp,
p_szUrl BOS_DT_szUrl,
p_szCallType BOS_DT_szSmallId,
p_szReasonId BOS_DT_szId,
p_szDocDescription BOS_DT_szDescription,
p_szDescription BOS_DT_szDescription,
p_bProspect bit,
p_szCustId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CRL_CustFUp
(
szTrnId,
szDocId,
dtmDate,
szUrl,
szCallType,
szReasonId,
szDocDescription,
szDescription,
bProspect,
szCustId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szTrnId,
p_szDocId,
p_dtmDate,
p_szUrl,
p_szCallType,
p_szReasonId,
p_szDocDescription,
p_szDescription,
p_bProspect,
p_szCustId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_CustFUp_CreateCustFUp_013(
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_dtmDate timestamp,
p_szUrl BOS_DT_szUrl,
p_szCallType BOS_DT_szSmallId,
p_szReasonId BOS_DT_szId,
p_szDocDescription BOS_DT_szDescription,
p_szDescription BOS_DT_szDescription,
p_bProspect bit,
p_szCustId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CRL_CustFUp
(
szTrnId,
szDocId,
dtmDate,
szUrl,
szCallType,
szReasonId,
szDocDescription,
szDescription,
bProspect,
szCustId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szTrnId,
p_szDocId,
p_dtmDate,
p_szUrl,
p_szCallType,
p_szReasonId,
p_szDocDescription,
p_szDescription,
p_bProspect,
p_szCustId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_CustFUp_GetListOfCustFUpData(
p_szCustId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_CRL_CustFUp.szTrnId,
BOS_CRL_CustFUp.szDocId,
BOS_CRL_CustFUp.dtmDate,
BOS_CRL_CustFUp.szUrl,
BOS_CRL_CustFUp.szCallType,
BOS_CRL_CustFUp.szReasonId,
BOS_GEN_Reason.szDescription AS szReasonDescription,
BOS_CRL_CustFUp.szDocDescription,
BOS_CRL_CustFUp.szDescription,
BOS_CRL_CustFUp.bProspect,
BOS_CRL_CustFUp.szCustId,
BOS_AR_Customer.szName as szCustName,
BOS_CRL_CustFUp.dtmLastUpdated,
BOS_CRL_CustFUp.bAlreadyTransferred  
FROM
BOS_CRL_CustFUp 
left join BOS_GEN_Reason on BOS_CRL_CustFUp.szReasonId = BOS_GEN_Reason.szReasonId
left join BOS_AR_Customer on BOS_CRL_CustFUp.szCustId = BOS_AR_Customer.szCustId
WHERE
BOS_CRL_CustFUp.bProspect = 0 and
BOS_CRL_CustFUp.szCustId = p_szCustId and
BOS_CRL_CustFUp.dtmDate >= p_dtmFrom and BOS_CRL_CustFUp.dtmDate < DateAdd(Day, 1, p_dtmTo);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_CustFUp_GetListOfCustFUpData_013(
p_szCustId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_CRL_CustFUp.szTrnId,
BOS_CRL_CustFUp.szDocId,
BOS_CRL_CustFUp.dtmDate,
BOS_CRL_CustFUp.szUrl,
BOS_CRL_CustFUp.szCallType,
BOS_CRL_CustFUp.szReasonId,
BOS_GEN_Reason.szDescription AS szReasonDescription,
BOS_CRL_CustFUp.szDocDescription,
BOS_CRL_CustFUp.szDescription,
BOS_CRL_CustFUp.bProspect,
BOS_CRL_CustFUp.szCustId,
BOS_AR_Customer.szName as szCustName,
BOS_CRL_CustFUp.dtmLastUpdated,
BOS_CRL_CustFUp.bAlreadyTransferred  
FROM
BOS_CRL_CustFUp left join BOS_GEN_Reason on BOS_CRL_CustFUp.szReasonId = BOS_GEN_Reason.szReasonId
left join BOS_AR_Customer on BOS_CRL_CustFUp.szCustId = BOS_AR_Customer.szCustId
WHERE
BOS_CRL_CustFUp.bProspect = 0 and
BOS_CRL_CustFUp.szCustId = p_szCustId and
BOS_CRL_CustFUp.dtmDate >= p_dtmFrom and BOS_CRL_CustFUp.dtmDate < DateAdd(Day, 1, p_dtmTo);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_CustFUp_IsCustFUpExist(
p_szTrnId BOS_DT_szId,
p_szDocId BOS_DT_szId,
p_dtmDate timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szUrl,
szCallType,
	szReasonId,
	szDocDescription,
	szDescription,
	bProspect,
	szCustId

FROM 
BOS_CRL_CustFUp
WHERE 
szTrnId = p_szTrnId and 
szDocId = p_szDocId and 
dtmDate = p_dtmDate ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_CustFUp_IsCustFUpExist_013(
p_szTrnId BOS_DT_szId,
p_szDocId BOS_DT_szId,
p_dtmDate timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szUrl,
szCallType,
	szReasonId,
	szDocDescription,
	szDescription,
	bProspect,
	szCustId

FROM 
BOS_CRL_CustFUp
WHERE 
szTrnId = p_szTrnId and szDocId = p_szDocId and dtmDate = p_dtmDate ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_CustFUp_UpdateCustId(
p_szFCallId BOS_DT_szId,
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CRL_CustFUp
SET 
bProspect = 0,
szCustId = p_szCustId
WHERE 
bProspect = 1 and
szCustId = p_szFCallId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCall_CreateFCall(
p_szFCallId BOS_DT_szId,
p_dtmDate timestamp,
p_szCallRecipientId BOS_DT_szId,
p_szCallType BOS_DT_szSmallId,
p_szCallReasonId BOS_DT_szId,
p_shCallCount smallint,
p_szMessage BOS_DT_szMessage,
p_szCustId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szForwardToWorkplaceId BOS_DT_szId,
p_szForwardToGroupId BOS_DT_szId,
p_dtmFollowUp timestamp,
p_bNoMoreFollowUp bit,
p_dtmFinish timestamp,
p_bSuccess bit,
p_szTrackingId BOS_DT_szId,
p_bReplyDirectly bit,
p_szReply varchar,
p_dtmLastReminder timestamp,
p_szContactPerson BOS_DT_szName,
p_szRoomNo BOS_DT_szSmallName,
p_szFloor BOS_DT_szSmallName,
p_szBuilding BOS_DT_szName,
p_szAddress_1 BOS_DT_szName,
p_szAddress_2 BOS_DT_szName,
p_szDistrict BOS_DT_szName,
p_szCity BOS_DT_szMediumName,
p_szZipCode BOS_DT_szSmallName,
p_szState BOS_DT_szMediumName,
p_szCountry BOS_DT_szMediumName,
p_szPhoneNo_1 BOS_DT_szMediumName,
p_szPhoneNo_2 BOS_DT_szMediumName,
p_szFaxNo BOS_DT_szMediumName,
p_szMobileNo BOS_DT_szMediumName,
p_szEmail BOS_DT_szMediumName,
p_szWebSite BOS_DT_szMediumName,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CRL_FCall
(
szFCallId,
dtmDate,
szCallRecipientId,
szCallType,
szCallReasonId,
shCallCount,
szMessage,
szCustId,
szName,
szForwardToWorkplaceId,
szForwardToGroupId,
dtmFollowUp,
bNoMoreFollowUp,
dtmFinish,
bSuccess,
szTrackingId,
bReplyDirectly,
szReply,
dtmLastReminder,
szContactPerson,
szRoomNo,
szFloor,
szBuilding,
szAddress_1,
szAddress_2,
szDistrict,
szCity,
szZipCode,
szState,
szCountry,
szPhoneNo_1,
szPhoneNo_2,
szFaxNo,
szMobileNo,
szEmail,
szWebSite,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFCallId,
p_dtmDate,
p_szCallRecipientId,
p_szCallType,
p_szCallReasonId,
p_shCallCount,
p_szMessage,
p_szCustId,
p_szName,
p_szForwardToWorkplaceId,
p_szForwardToGroupId,
p_dtmFollowUp,
p_bNoMoreFollowUp,
p_dtmFinish,
p_bSuccess,
p_szTrackingId,
p_bReplyDirectly,
p_szReply,
p_dtmLastReminder,
p_szContactPerson,
p_szRoomNo,
p_szFloor,
p_szBuilding,
p_szAddress_1,
p_szAddress_2,
p_szDistrict,
p_szCity,
p_szZipCode,
p_szState,
p_szCountry,
p_szPhoneNo_1,
p_szPhoneNo_2,
p_szFaxNo,
p_szMobileNo,
p_szEmail,
p_szWebSite,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCall_CreateFCallProduct(
p_szFCallId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CRL_FCallProduct
(
szFCallId,
szProductId,
szOrderItemTypeId,
decQty,
szUomId
)
VALUES
(
p_szFCallId,
p_szProductId,
p_szOrderItemTypeId,
p_decQty,
p_szUomId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCall_DeleteFCall(
p_szFCallId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_CRL_FCall
WHERE
szFCallId=p_szFCallId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCall_DeleteFCallProduct(
p_szFCallId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_CRL_FCallProduct
WHERE
szFCallId=p_szFCallId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCall_GetFCall(
p_szFCallId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_CRL_FCall.dtmDate,
BOS_CRL_FCall.szCallRecipientId,
BOS_SM_User.szName as szCallRecipientName,
BOS_CRL_FCall.szCallType,
BOS_CRL_FCall.szCallReasonId,
BOS_CRL_FCall.shCallCount,
BOS_CRL_FCall.szMessage,
BOS_CRL_FCall.szCustId,
BOS_CRL_FCall.szName,
BOS_CRL_FCall.szForwardToWorkplaceId,
BOS_CRL_FCall.szForwardToGroupId,
BOS_CRL_FCall.dtmFollowUp,
BOS_CRL_FCall.bNoMoreFollowUp,
BOS_CRL_FCall.dtmFinish,
BOS_CRL_FCall.bSuccess,
BOS_CRL_FCall.szTrackingId,
BOS_CRL_FCall.bReplyDirectly,
BOS_CRL_FCall.szReply,
BOS_CRL_FCall.dtmLastReminder,

BOS_CRL_FCall.szContactPerson,
BOS_CRL_FCall.szRoomNo,
BOS_CRL_FCall.szFloor,
BOS_CRL_FCall.szBuilding,
BOS_CRL_FCall.szAddress_1,
BOS_CRL_FCall.szAddress_2,
BOS_CRL_FCall.szDistrict,
BOS_CRL_FCall.szCity,
BOS_CRL_FCall.szZipCode,
BOS_CRL_FCall.szState,
BOS_CRL_FCall.szCountry,
BOS_CRL_FCall.szPhoneNo_1,
BOS_CRL_FCall.szPhoneNo_2,
BOS_CRL_FCall.szFaxNo,
BOS_CRL_FCall.szMobileNo,
BOS_CRL_FCall.szEmail,
BOS_CRL_FCall.szWebSite,

BOS_CRL_FCall.bResultFrTransfer,
BOS_CRL_FCall.bVoid,
BOS_GEN_Approved.bApproved,
BOS_CRL_FCall.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_CRL_FCall.btPrintedCount,
BOS_CRL_FCall.bTransferred,
BOS_CRL_FCall.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_CRL_FCall.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_CRL_FCall.szTaxEntityId,
BOS_CRL_FCall.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_CRL_FCall.dtmCreated,
BOS_CRL_FCall.bSystemCreated,
BOS_CRL_FCall.szUserId,
user1.szName AS szUserNm_J,

-- Data Status.
BOS_CRL_FCall.dtmLastUpdated,
BOS_CRL_FCall.bAlreadyTransferred

FROM
(BOS_CRL_FCall LEFT JOIN BOS_GEN_Approved ON BOS_CRL_FCall.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
LEFT JOIN BOS_GL_FJournalTrans ON BOS_CRL_FCall.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_SM_User ON BOS_CRL_FCall.szCallRecipientId = BOS_SM_User.szUserId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_CRL_FCall.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CRL_FCall.szWorkplaceId
LEFT JOIN BOS_SM_User AS user1 ON user1.szUserId = BOS_CRL_FCall.szUserId

WHERE
BOS_CRL_FCall.szFCallId = p_szFCallId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCall_GetFCallProduct(
p_szFCallId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_CRL_FCallProduct.szProductId,
BOS_INV_Product.szName as szProductName,
BOS_CRL_FCallProduct.szOrderItemTypeId,
BOS_CRL_FCallProduct.decQty,
BOS_CRL_FCallProduct.szUomId,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J

FROM 
BOS_CRL_FCallProduct 
left join BOS_INV_Product on BOS_CRL_FCallProduct.szProductId = BOS_INV_Product.szProductId
WHERE 
szFCallId=p_szFCallId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCall_GetListOfFCall()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCallId,
dtmDate,
szCallType,
szCallReasonId

FROM 
BOS_CRL_FCall
WHERE 
bVoid = 0 ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCall_GetReplyCount(
p_szFCallId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
count(szFCallReplyId) as intReplyCount

FROM 
BOS_CRL_FCallReply
WHERE 
szFCallId = p_szFCallId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCall_IsFCallExist(
p_szFCallId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCallId

FROM 
BOS_CRL_FCall
WHERE 
szFCallId=p_szFCallId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCall_LockFCall(
p_szFCallId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CRL_FCall
SET 
bTransferred=bTransferred
WHERE 
szFCallId=p_szFCallId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCall_MarkFCallVoid(
p_szFCallId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CRL_FCall
SET 
bVoid = 1,
bApplied = 0
WHERE 
szFCallId = p_szFCallId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCall_MarkFCallVoid_014(
p_szFCallId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CRL_FCall
SET 
bVoid = 1,
bApplied = 0
WHERE 
szFCallId = p_szFCallId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCall_SearchCust(
p_szCustId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szAddress varchar,
p_szPhoneNo varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_Customer.szCustId AS BOS_AR_Customer_szCustId,
BOS_AR_Customer.szName AS BOS_AR_Customer_szName,
BOS_AR_Customer.CustszAddress_1  AS BOS_AR_Customer_CustszAddress_1,
BOS_AR_Customer.CustszAddress_2 AS BOS_AR_Customer_CustszAddress_2,
BOS_AR_Customer.CustszPhoneNo_1 AS BOS_AR_Customer_CustszPhoneNo_1,
BOS_AR_Customer.CustszPhoneNo_2 AS BOS_AR_Customer_CustszPhoneNo_2,

--	Delivery section
--
BOS_AR_Customer.szDeliverToCustId AS BOS_AR_Customer_szDeliverToCustId,
DLV_BOS_AR_CustLocation.szCustDeliveryNm AS DLV_BOS_AR_CustLocation_szCustDeliveryNm,
DLV_BOS_AR_CustLocation.LocationszAddress_1 AS DLV_BOS_AR_CustLocation_LocationszAddress_1,
DLV_BOS_AR_CustLocation.LocationszAddress_2 AS DLV_BOS_AR_CustLocation_LocationszAddress_2,
DLV_BOS_AR_CustLocation.LocationszPhoneNo_1 AS DLV_BOS_AR_CustLocation_LocationszPhoneNo_1,
DLV_BOS_AR_CustLocation.LocationszPhoneNo_2 AS DLV_BOS_AR_CustLocation_LocationszPhoneNo_2
--
--	End of delivery section


FROM 
BOS_AR_Customer

LEFT JOIN BOS_AR_CustLocation AS DLV_BOS_AR_CustLocation ON
DLV_BOS_AR_CustLocation.szCustId = BOS_AR_Customer.szDeliverToCustId AND 
DLV_BOS_AR_CustLocation.btLocId = 0

WHERE 
( 
BOS_AR_Customer.szCustId LIKE p_szCustId OR 
BOS_AR_Customer.szDeliverToCustId LIKE p_szCustId ) 
AND 
( BOS_AR_Customer.szName LIKE p_szName OR 
DLV_BOS_AR_CustLocation.szCustDeliveryNm LIKE p_szName ) 
AND 
( BOS_AR_Customer.CustszAddress_1 LIKE p_szAddress OR 
BOS_AR_Customer.CustszAddress_2 LIKE p_szAddress OR 
DLV_BOS_AR_CustLocation.LocationszAddress_1 LIKE p_szAddress OR 
DLV_BOS_AR_CustLocation.LocationszAddress_2 LIKE p_szAddress ) 
AND 
( BOS_AR_Customer.CustszPhoneNo_1 LIKE p_szPhoneNo OR 
BOS_AR_Customer.CustszPhoneNo_2 LIKE p_szPhoneNo OR 
DLV_BOS_AR_CustLocation.LocationszPhoneNo_1 LIKE p_szPhoneNo OR 
DLV_BOS_AR_CustLocation.LocationszPhoneNo_2 LIKE p_szPhoneNo ) 

ORDER BY 
BOS_AR_Customer.szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCall_SearchFCall(
p_szCustId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szAddress varchar,
p_szPhoneNo varchar)
RETURNS void AS
$BODY$
BEGIN
Select
RESULT.BOS_CRL_FCall_szFCallId,
RESULT.BOS_CRL_FCall_szCallType,
RESULT.BOS_CRL_FCall_szCustId,
RESULT.BOS_CRL_FCall_szName,

RESULT.BOS_AR_Customer_szName,
RESULT.BOS_AR_Customer_CustszAddress_1,
RESULT.BOS_AR_Customer_CustszAddress_2,
RESULT.BOS_AR_Customer_CustszPhoneNo_1,
RESULT.BOS_AR_Customer_CustszPhoneNo_2,

--	Delivery section
--
RESULT.BOS_AR_Customer_szDeliverToCustId,
RESULT.DLV_BOS_AR_CustLocation_szCustDeliveryNm,
RESULT.DLV_BOS_AR_CustLocation_LocationszAddress_1, 
RESULT.DLV_BOS_AR_CustLocation_LocationszAddress_2,
RESULT.DLV_BOS_AR_CustLocation_LocationszPhoneNo_1,
RESULT.DLV_BOS_AR_CustLocation_LocationszPhoneNo_2
--
--	End of delivery section
from

-- Select from query result.
(Select
BOS_CRL_FCall.szFCallId as BOS_CRL_FCall_szFCallId,
BOS_CRL_FCall.szCallType as BOS_CRL_FCall_szCallType,
BOS_CRL_FCall.szCustId as BOS_CRL_FCall_szCustId,
BOS_CRL_FCall.szName as BOS_CRL_FCall_szName,

IsNull(BOS_AR_Customer.szName, '') AS BOS_AR_Customer_szName, 
IsNull(BOS_AR_Customer.CustszAddress_1, '') AS BOS_AR_Customer_CustszAddress_1, 
IsNull(BOS_AR_Customer.CustszAddress_2, '') AS BOS_AR_Customer_CustszAddress_2,
IsNull(BOS_AR_Customer.CustszPhoneNo_1, '') AS BOS_AR_Customer_CustszPhoneNo_1,
IsNull(BOS_AR_Customer.CustszPhoneNo_2, '') AS BOS_AR_Customer_CustszPhoneNo_2,

--	Delivery section
--
IsNull(BOS_AR_Customer.szDeliverToCustId, '') AS BOS_AR_Customer_szDeliverToCustId,
IsNull(DLV_BOS_AR_CustLocation.szCustDeliveryNm, '') AS DLV_BOS_AR_CustLocation_szCustDeliveryNm,
IsNull(DLV_BOS_AR_CustLocation.LocationszAddress_1, '') AS DLV_BOS_AR_CustLocation_LocationszAddress_1, 
IsNull(DLV_BOS_AR_CustLocation.LocationszAddress_2, '') AS DLV_BOS_AR_CustLocation_LocationszAddress_2,
IsNull(DLV_BOS_AR_CustLocation.LocationszPhoneNo_1, '') AS DLV_BOS_AR_CustLocation_LocationszPhoneNo_1,
IsNull(DLV_BOS_AR_CustLocation.LocationszPhoneNo_2, '') AS DLV_BOS_AR_CustLocation_LocationszPhoneNo_2
--
--	End of delivery section

From
BOS_CRL_FCall
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_CRL_FCall.szCustId

LEFT JOIN BOS_AR_CustLocation AS DLV_BOS_AR_CustLocation ON
DLV_BOS_AR_CustLocation.szCustId = BOS_AR_Customer.szDeliverToCustId AND DLV_BOS_AR_CustLocation.btLocId = 0

Where
(
BOS_CRL_FCall.bNoMoreFollowUp = 0 AND
BOS_CRL_FCall.bVoid = 0
)
)
as RESULT

where
(
RESULT.BOS_CRL_FCall_szCustId LIKE p_szCustId
)
AND
(
RESULT.BOS_CRL_FCall_szName LIKE p_szName OR
RESULT.BOS_AR_Customer_szName LIKE p_szName OR
RESULT.DLV_BOS_AR_CustLocation_szCustDeliveryNm LIKE p_szName
)
AND
(
RESULT.BOS_AR_Customer_CustszAddress_1 LIKE p_szAddress OR
RESULT.BOS_AR_Customer_CustszAddress_2 LIKE p_szAddress OR
RESULT.DLV_BOS_AR_CustLocation_LocationszAddress_1 LIKE p_szAddress OR
RESULT.DLV_BOS_AR_CustLocation_LocationszAddress_2 LIKE p_szAddress
)
AND
(
RESULT.BOS_AR_Customer_CustszPhoneNo_1 LIKE p_szPhoneNo OR
RESULT.BOS_AR_Customer_CustszPhoneNo_2 LIKE p_szPhoneNo OR
RESULT.DLV_BOS_AR_CustLocation_LocationszPhoneNo_1 LIKE p_szPhoneNo OR
RESULT.DLV_BOS_AR_CustLocation_LocationszPhoneNo_2 LIKE p_szPhoneNo
)
Order by
RESULT.BOS_CRL_FCall_szFCallId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCall_UpdateFCall(
p_szFCallId BOS_DT_szId,
p_dtmDate timestamp,
p_szCallRecipientId BOS_DT_szId,
p_szCallType BOS_DT_szSmallId,
p_szCallReasonId BOS_DT_szId,
p_shCallCount smallint,
p_szMessage BOS_DT_szMessage,
p_szCustId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szForwardToWorkplaceId BOS_DT_szId,
p_szForwardToGroupId BOS_DT_szId,
p_dtmFollowUp timestamp,
p_bReplyDirectly bit,
p_szReply varchar,
p_dtmLastReminder timestamp,
p_szContactPerson BOS_DT_szName,
p_szRoomNo BOS_DT_szSmallName,
p_szFloor BOS_DT_szSmallName,
p_szBuilding BOS_DT_szName,
p_szAddress_1 BOS_DT_szName,
p_szAddress_2 BOS_DT_szName,
p_szDistrict BOS_DT_szName,
p_szCity BOS_DT_szMediumName,
p_szZipCode BOS_DT_szSmallName,
p_szState BOS_DT_szMediumName,
p_szCountry BOS_DT_szMediumName,
p_szPhoneNo_1 BOS_DT_szMediumName,
p_szPhoneNo_2 BOS_DT_szMediumName,
p_szFaxNo BOS_DT_szMediumName,
p_szMobileNo BOS_DT_szMediumName,
p_szEmail BOS_DT_szMediumName,
p_szWebSite BOS_DT_szMediumName,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CRL_FCall
SET 
dtmDate = p_dtmDate,
szCallRecipientId = p_szCallRecipientId,
szCallType = p_szCallType,
szCallReasonId = p_szCallReasonId,
shCallCount = p_shCallCount,
szMessage = p_szMessage,
szCustId = p_szCustId,
szName = p_szName,
szForwardToWorkplaceId = p_szForwardToWorkplaceId,
szForwardToGroupId = p_szForwardToGroupId,
dtmFollowUp = p_dtmFollowUp,
bReplyDirectly = p_bReplyDirectly,
szReply = p_szReply,
dtmLastReminder = p_dtmLastReminder,

szContactPerson = p_szContactPerson,
szRoomNo = p_szRoomNo,
szFloor = p_szFloor,
szBuilding = p_szBuilding,
szAddress_1 = p_szAddress_1,
szAddress_2 = p_szAddress_2,
szDistrict = p_szDistrict,
szCity = p_szCity,
szZipCode = p_szZipCode,
szState = p_szState,
szCountry = p_szCountry,
szPhoneNo_1 = p_szPhoneNo_1,
szPhoneNo_2 = p_szPhoneNo_2,
szFaxNo = p_szFaxNo,
szMobileNo = p_szMobileNo,
szEmail = p_szEmail,
szWebSite = p_szWebSite,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId
WHERE 
szFCallId = p_szFCallId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCall_UpdateFCallStatus(
p_szFCallId BOS_DT_szId,
p_bNoMoreFollowUp bit,
p_dtmFinish timestamp,
p_bSuccess bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CRL_FCall
SET 
bNoMoreFollowUp = p_bNoMoreFollowUp,
dtmFinish = p_dtmFinish,
bSuccess = p_bSuccess
WHERE 
szFCallId = p_szFCallId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCall_UpdateTracking(
p_szFCallId BOS_DT_szId,
p_szTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CRL_FCall
SET 
szTrackingId = p_szTrackingId
WHERE 
szFCallId = p_szFCallId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCallReply_CreateFCallReply(
p_szFCallReplyId BOS_DT_szId,
p_dtmDate timestamp,
p_szReplyUserId BOS_DT_szId,
p_szFCallId BOS_DT_szId,
p_bNoMoreFollowUp bit,
p_bSuccess bit,
p_szFailReasonId BOS_DT_szId,
p_szMessage BOS_DT_szMessage,
p_szRefTrnId BOS_DT_szMediumId,
p_szRefDocId BOS_DT_szId,
p_szRefUrl BOS_DT_szUrl,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CRL_FCallReply
(
szFCallReplyId,
dtmDate,
szReplyUserId,
szFCallId,
bNoMoreFollowUp,
bSuccess,
szFailReasonId,
szMessage,
szRefTrnId,
szRefDocId,
szRefUrl,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFCallReplyId,
p_dtmDate,
p_szReplyUserId,
p_szFCallId,
p_bNoMoreFollowUp,
p_bSuccess,
p_szFailReasonId,
p_szMessage,
p_szRefTrnId,
p_szRefDocId,
p_szRefUrl,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCallReply_DeleteFCallReply(
p_szFCallReplyId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_CRL_FCallReply
WHERE
szFCallReplyId=p_szFCallReplyId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCallReply_GetFCallReply(
p_szFCallReplyId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_CRL_FCallReply.dtmDate,
BOS_CRL_FCallReply.szReplyUserId,
BOS_SM_User.szName as szReplyUserName,
BOS_CRL_FCallReply.szFCallId,
BOS_CRL_FCallReply.bSuccess,
BOS_CRL_FCallReply.bNoMoreFollowUp,
BOS_CRL_FCallReply.szFailReasonId,
BOS_CRL_FCallReply.szMessage,
BOS_CRL_FCallReply.szRefTrnId,
BOS_CRL_FCallReply.szRefDocId,
BOS_CRL_FCallReply.szRefUrl,

BOS_CRL_FCallReply.bResultFrTransfer,
BOS_CRL_FCallReply.bVoid,
BOS_GEN_Approved.bApproved,
BOS_CRL_FCallReply.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_CRL_FCallReply.btPrintedCount,
BOS_CRL_FCallReply.bTransferred,
BOS_CRL_FCallReply.szCompanyId,
BOS_CRL_FCallReply.szWorkplaceId,
BOS_CRL_FCallReply.szTaxEntityId,
BOS_CRL_FCallReply.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_CRL_FCallReply.dtmCreated,
BOS_CRL_FCallReply.bSystemCreated,
BOS_CRL_FCallReply.szUserId,
user1.szName AS szUserNm_J,
BOS_GL_Company.szName as szCompanyNm,
BOS_GL_Workplace.szName as szWorkplaceNm,

-- Data Status.
BOS_CRL_FCallReply.dtmLastUpdated,
BOS_CRL_FCallReply.bAlreadyTransferred
FROM
(BOS_CRL_FCallReply LEFT JOIN BOS_GEN_Approved ON BOS_CRL_FCallReply.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
LEFT JOIN BOS_GL_FJournalTrans ON BOS_CRL_FCallReply.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_SM_User ON BOS_CRL_FCallReply.szReplyUserId = BOS_SM_User.szUserId
LEFT JOIN BOS_SM_User AS user1 ON user1.szUserId = BOS_CRL_FCallReply.szUserId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_CRL_FCallReply.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CRL_FCallReply.szWorkplaceId
WHERE
BOS_CRL_FCallReply.szFCallReplyId = p_szFCallReplyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCallReply_GetListOfFCallReply()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCallReplyId,
dtmDate,
szFCallId

FROM 
BOS_CRL_FCallReply
WHERE 
bVoid = 0 ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCallReply_GetListOfFCallReplyWhereFCallId(
p_szFCallId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCallReplyId

FROM 
BOS_CRL_FCallReply
WHERE 
szFCallId = p_szFCallId and bVoid = 0 
ORDER BY 
szFCallReplyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCallReply_IsFCallReplyExist(
p_szFCallReplyId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCallReplyId

FROM 
BOS_CRL_FCallReply
WHERE 
szFCallReplyId=p_szFCallReplyId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCallReply_LockFCallReply(
p_szFCallReplyId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CRL_FCallReply
SET 
bTransferred=bTransferred
WHERE 
szFCallReplyId=p_szFCallReplyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCallReply_MarkFCallReplyApplied(
p_szFCallReplyId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CRL_FCallReply
SET 
bApplied = 1
WHERE 
szFCallReplyId = p_szFCallReplyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCallReply_MarkFCallReplyVoid(
p_szFCallReplyId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CRL_FCallReply
SET 
bVoid = 1
WHERE 
szFCallReplyId = p_szFCallReplyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CRL_FCallReply_UpdateFCallReply(
p_szFCallReplyId BOS_DT_szId,
p_dtmDate timestamp,
p_szReplyUserId BOS_DT_szId,
p_szFCallId BOS_DT_szId,
p_bNoMoreFollowUp bit,
p_bSuccess bit,
p_szFailReasonId BOS_DT_szId,
p_szMessage BOS_DT_szMessage,
p_szRefTrnId BOS_DT_szMediumId,
p_szRefDocId BOS_DT_szId,
p_szRefUrl BOS_DT_szUrl,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CRL_FCallReply
SET 
dtmDate = p_dtmDate,
szReplyUserId = p_szReplyUserId,
szFCallId = p_szFCallId,
bNoMoreFollowUp = p_bNoMoreFollowUp,
bSuccess = p_bSuccess,
szFailReasonId = p_szFailReasonId,
szMessage = p_szMessage,
szRefTrnId = p_szRefTrnId,
szRefDocId = p_szRefDocId,
szRefUrl = p_szRefUrl,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
dtmCreated = p_dtmCreated,
szUserId = p_szUserId
WHERE 
szFCallReplyId = p_szFCallReplyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_CreateCurrency(
p_szCcyId BOS_DT_szSmallId,
p_szSymbol varchar,
p_szAmountFormat varchar,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CU_Currency
(
BOS_CU_Currency.szCcyId,
BOS_CU_Currency.szSymbol,
BOS_CU_Currency.szAmountFormat,
BOS_CU_Currency.dtmLastUpdated,
BOS_CU_Currency.bAlreadyTransferred
)
VALUES
(
p_szCcyId,
p_szSymbol,
p_szAmountFormat,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_CreateCurrencyRate(
p_szCcyRateId BOS_DT_szMediumId,
p_szDescription BOS_DT_szDescription,
p_dtmTime timestamp,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CU_CurrencyRate
(
BOS_CU_CurrencyRate.szCcyRateId,
BOS_CU_CurrencyRate.szDescription,
BOS_CU_CurrencyRate.dtmLastUpdated,
BOS_CU_CurrencyRate.bAlreadyTransferred,
BOS_CU_CurrencyRate.dtmTime
)
VALUES
(
p_szCcyRateId,
p_szDescription,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_dtmTime
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_CreateCurrencyRate_013(
p_szCcyRateId BOS_DT_szMediumId,
p_szDescription BOS_DT_szDescription,
p_dtmTime timestamp,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CU_CurrencyRate
(
BOS_CU_CurrencyRate.szCcyRateId,
BOS_CU_CurrencyRate.szDescription,
BOS_CU_CurrencyRate.dtmLastUpdated,
BOS_CU_CurrencyRate.bAlreadyTransferred,
BOS_CU_CurrencyRate.dtmTime
)
VALUES
(
p_szCcyRateId,
p_szDescription,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_dtmTime
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_CreateCurrencyRateItem(
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szToCcyId BOS_DT_szSmallId,
p_decValue BOS_DT_decCcyRate)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_CU_CurrencyRateItem
(
szCcyRateId,
szCcyId,
szToCcyId,
decValue 
)
VALUES
(
p_szCcyRateId,
p_szCcyId,
p_szToCcyId,
p_decValue
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_DeleteCurrency(
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_DeleteCurrencyRate(
p_szCcyRateId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_DeleteCurrencyRateItem(
p_szCcyRateId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_GetConversionValue(
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_szToCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decValue 

FROM 
BOS_CU_CurrencyRateItem 
WHERE 
 szCcyRateId = p_szCcyRateId and
 szToCcyId = p_szToCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_GetCurrency(
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_CU_Currency.szSymbol,
BOS_CU_Currency.szAmountFormat,

BOS_CU_Currency.dtmLastUpdated,
BOS_CU_Currency.bAlreadyTransferred

FROM 
BOS_CU_Currency
WHERE 
szCcyId = p_szCcyId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_GetCurrencyRate(
p_szCcyRateId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_CU_CurrencyRate.szDescription,
BOS_CU_CurrencyRate.dtmLastUpdated,
BOS_CU_CurrencyRate.bAlreadyTransferred

FROM 
BOS_CU_CurrencyRate
WHERE 
 szCcyRateId = p_szCcyRateId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_GetCurrencyRateItem(
p_szCcyRateId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCcyId, szToCcyId, decValue 

FROM 
BOS_CU_CurrencyRateItem 
WHERE 
 szCcyRateId = p_szCcyRateId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_GetListOfCurrency()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCcyId, szSymbol

FROM 
BOS_CU_Currency;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_GetListOfCurrencyRate()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCcyRateId, szDescription 

FROM 
BOS_CU_CurrencyRate;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_IsCurrencyExist(
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szSymbol 

FROM 
BOS_CU_Currency 
WHERE 
 szCcyId = p_szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_IsCurrencyRateExist(
p_szCcyRateId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
 szDescription 

FROM 
BOS_CU_CurrencyRate 
WHERE 
 szCcyRateId = p_szCcyRateId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_LockCurrency(
p_szCcyId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CU_Currency
SET 
szSymbol=szSymbol
WHERE 
 szCcyId = p_szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_LockCurrencyRate(
p_szCcyRateId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CU_CurrencyRate
SET 
szDescription = szDescription
WHERE 
 szCcyRateId = p_szCcyRateId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_UpdateCurrency(
p_szCcyId BOS_DT_szSmallId,
p_szSymbol varchar,
p_szAmountFormat varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CU_Currency
SET 
szSymbol = p_szSymbol, szAmountFormat = p_szAmountFormat
WHERE 
szCcyId = p_szCcyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_CU_Currency_UpdateCurrencyRate(
p_szCcyRateId BOS_DT_szMediumId,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_CU_CurrencyRate
SET 
szDescription = p_szDescription
WHERE 
 szCcyRateId = p_szCcyRateId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_CreateApproval(
p_szApprovalId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_Approval
(szApprovalId, szDescription, bLock, dtmLastUpdated, bAlreadyTransferred)
VALUES
(p_szApprovalId, p_szDescription, 0, p_dtmLastUpdated, p_bAlreadyTransferred);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_CreateApproval_014(
p_szApprovalId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_Approval
(szApprovalId, szDescription, bLock, dtmLastUpdated, bAlreadyTransferred)
VALUES
(p_szApprovalId, p_szDescription, 0, p_dtmLastUpdated, p_bAlreadyTransferred);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_CreateApprovalGroup(
p_szApprovalId BOS_DT_szId,
p_btLevel smallint,
p_szGroupId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_ApprovalGroup
(szApprovalId, btLevel, szGroupId)
VALUES
(@szApprovalId, @btLevel, @szGroupId);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_CreateApprovalLevel(
p_szApprovalId BOS_DT_szId,
p_btLevel smallint,
p_bAllowSkipToNext bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_ApprovalLevel
(szApprovalId, btLevel, bAllowSkipToNext)
VALUES
(@szApprovalId, @btLevel, @bAllowSkipToNext);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_CreateApproved(
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_bApproved bit,
p_bRejected bit,
p_szUrl BOS_DT_szUrl,
p_szDescription BOS_DT_szDescription,
p_szWorkplaceId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szURI BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_Approved
(
gdApprovedId,
szApprovalId,
bApproved,
bRejected,
szUrl,
szDescription,
szWorkplaceId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
szURI
)
VALUES
(
p_gdApprovedId,
p_szApprovalId,
p_bApproved,
p_bRejected,
p_szUrl,
p_szDescription,
p_szWorkplaceId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szURI
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_CreateApproved_014(
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_bApproved bit,
p_bRejected bit,
p_szUrl BOS_DT_szUrl,
p_szDescription BOS_DT_szDescription,
p_szWorkplaceId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szURI BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_Approved
(
gdApprovedId,
szApprovalId,
bApproved,
bRejected,
szUrl,
szDescription,
szWorkplaceId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
szURI
)
VALUES
(
p_gdApprovedId,
p_szApprovalId,
p_bApproved,
p_bRejected,
p_szUrl,
p_szDescription,
p_szWorkplaceId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szURI
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_CreateApprovedItem(
p_gdApprovedId bytea,
p_btApprovedLevel smallint,
p_szUserId BOS_DT_szId,
p_szGroupId BOS_DT_szId,
p_dtmApproved timestamp,
p_bApproved bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_ApprovedItem
(
gdApprovedId,
btApprovedLevel,
szUserId,
szGroupId,
dtmApproved,
bApproved
)
VALUES
(
p_gdApprovedId,
p_btApprovedLevel,
p_szUserId,
p_szGroupId,
p_dtmApproved,
p_bApproved
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_DeleteApproval(
p_szApprovalId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_GEN_Approval
WHERE
 szApprovalId = p_szApprovalId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_DeleteApprovalGroup(
p_szApprovalId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_GEN_ApprovalGroup
WHERE
 szApprovalId = p_szApprovalId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_DeleteApprovalLevel(
p_szApprovalId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_GEN_ApprovalLevel
WHERE
 szApprovalId = p_szApprovalId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_DeleteApproved(
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_GEN_Approved
WHERE
 gdApprovedId = p_gdApprovedId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_DeleteApprovedItem(
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_GEN_ApprovedItem
WHERE
 gdApprovedId = p_gdApprovedId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_GetApproval(
p_szApprovalId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
dtmLastUpdated,	
bAlreadyTransferred
FROM 
BOS_GEN_Approval
WHERE 
 szApprovalId = p_szApprovalId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_GetApproval_014(
p_szApprovalId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
dtmLastUpdated,
    bAlreadyTransferred
    
FROM 
BOS_GEN_Approval
WHERE 
 szApprovalId = p_szApprovalId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_GetApprovalGroup(
p_szApprovalId BOS_DT_szId,
p_btLevel smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
btLevel, szGroupId

FROM 
BOS_GEN_ApprovalGroup
WHERE 
 szApprovalId = p_szApprovalId And btLevel = p_btLevel;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_GetApprovalLevel(
p_szApprovalId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
btLevel, bAllowSkipToNext

FROM 
BOS_GEN_ApprovalLevel
WHERE 
 szApprovalId = p_szApprovalId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_GetApproved(
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szApprovalId,
bApproved,
bRejected,
szUrl,
szDescription,
szWorkplaceId,

-- Data Status.
dtmLastUpdated,
bAlreadyTransferred,
--new
szURI

FROM 
BOS_GEN_Approved
WHERE 
gdApprovedId = p_gdApprovedId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_GetApproved_014(
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szApprovalId,
bApproved,
bRejected,
szUrl,
szDescription,
szWorkplaceId,

-- Data Status.
dtmLastUpdated,
bAlreadyTransferred,
--new
szURI

FROM 
BOS_GEN_Approved
WHERE 
gdApprovedId = p_gdApprovedId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_GetApprovedItem(
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_GEN_ApprovedItem.btApprovedLevel,
BOS_GEN_ApprovedItem.szUserId,
BOS_SM_User.szName as szUserNm,
BOS_GEN_ApprovedItem.szGroupId,
BOS_GEN_ApprovedItem.dtmApproved,
BOS_GEN_ApprovedItem.bApproved

FROM 
BOS_GEN_ApprovedItem LEFT JOIN BOS_SM_User ON BOS_GEN_ApprovedItem.szUserId = BOS_SM_User.szUserIdBOS_GEN_ApprovedItem LEFT JOIN BOS_SM_User ON BOS_GEN_ApprovedItem.szUserId = BOS_SM_User.szUserId
WHERE 
BOS_GEN_ApprovedItem.gdApprovedId = p_gdApprovedId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_GetListOfApproval()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szApprovalId,
szDescription

FROM 
BOS_GEN_Approval;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_GetListOfApproved()
RETURNS void AS
$BODY$
BEGIN
SELECT 
gdApprovedId, szDescription

FROM 
BOS_GEN_Approved;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_GetListOfApprovedTobeApproved(
p_szUserId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_szUserId = ''
  THEN
select
BGAD.gdApprovedId,
BGAE.btLevel, BGAD.szUrl,
BGAD.szDescription
from
BOS_GEN_Approved as BGAD
inner join BOS_GEN_Approval as BGAL on BGAD.szApprovalId = BGAL.szApprovalId
inner join BOS_GEN_ApprovalLevel as BGAE on BGAL.szApprovalId = BGAE.szApprovalId
where
BGAD.bApproved = 0
and BGAD.bRejected = 0
AND 
(
BGAD.szWorkplaceId LIKE p_szWorkplaceId
OR BGAD.szWorkplaceId = ''			--FOR COMPATIBILITY PURPOSE.
)
And BGAE.btLevel not in (select btApprovedLevel from BOS_GEN_ApprovedItem where gdApprovedId = BGAD.gdApprovedId)
order by
BGAD.szUrl,
BGAD.gdApprovedId,
BGAE.btLevel;
ELSE
select
BGAD.gdApprovedId,
BGAE.btLevel,
BGAD.szUrl,
BGAD.szDescription
from
BOS_GEN_Approved as BGAD
inner join BOS_GEN_Approval as BGAL on BGAD.szApprovalId = BGAL.szApprovalId
inner join BOS_GEN_ApprovalLevel as BGAE on BGAL.szApprovalId = BGAE.szApprovalId
inner join BOS_GEN_ApprovalGroup as BGAG on BGAE.szApprovalId = BGAG.szApprovalId and BGAE.btLevel = BGAG.btLevel
where
BGAD.bApproved = 0
and BGAD.bRejected = 0
AND 
(
BGAD.szWorkplaceId LIKE p_szWorkplaceId
OR BGAD.szWorkplaceId = ''			--FOR COMPATIBILITY PURPOSE.
)
And BGAE.btLevel not in (select btApprovedLevel from BOS_GEN_ApprovedItem where gdApprovedId = BGAD.gdApprovedId)
and BGAG.szGroupId in (select szGroupId from BOS_SM_GroupUser where szUserId = p_szUserId)
order by
BGAD.szUrl,
BGAD.gdApprovedId,
BGAE.btLevel;

END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_IsApprovalExist(
p_szApprovalId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szApprovalId

FROM 
BOS_GEN_Approval
WHERE 
 szApprovalId = p_szApprovalId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_IsApprovedExist(
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
gdApprovedId

FROM 
BOS_GEN_Approved
WHERE 
 gdApprovedId = p_gdApprovedId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_LockApproval(
p_szApprovalId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Approval
SET 
 bLock = bLock
WHERE 
 szApprovalId = p_szApprovalId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_LockApproved(
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Approved
SET 
 szDescription = szDescription
WHERE 
 gdApprovedId = p_gdApprovedId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_UpdateApproval(
p_szApprovalId BOS_DT_szId,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Approval
SET 
szDescription = p_szDescription
WHERE 
szApprovalId = p_szApprovalId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_UpdateApproved(
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_bApproved bit,
p_bRejected bit,
p_szUrl BOS_DT_szUrl,
p_szDescription BOS_DT_szDescription,
p_szWorkplaceId BOS_DT_szId,
p_szURI BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Approved
SET 
szApprovalId = p_szApprovalId,
bApproved = p_bApproved,
bRejected = p_bRejected,
szUrl = p_szUrl,
szDescription = p_szDescription,
szWorkplaceId = p_szWorkplaceId
, szURI = p_szURI
WHERE 
gdApprovedId = p_gdApprovedId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Approval_UpdateApproved_014(
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_bApproved bit,
p_bRejected bit,
p_szUrl BOS_DT_szUrl,
p_szDescription BOS_DT_szDescription,
p_szWorkplaceId BOS_DT_szId,
p_szURI BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Approved
SET 
szApprovalId = p_szApprovalId,
bApproved = p_bApproved,
bRejected = p_bRejected,
szUrl = p_szUrl,
szDescription = p_szDescription,
szWorkplaceId = p_szWorkplaceId
, szURI = p_szURI
WHERE 
gdApprovedId = p_gdApprovedId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Calendar_CreateCalendar(
p_szCalendarId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bWorkOnSat bit,
p_bWorkOnSun bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_Calendar
(
szCalendarId,
szDescription,
bWorkOnSat,
bWorkOnSun,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCalendarId,
p_szDescription,
p_bWorkOnSat,
p_bWorkOnSun,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Calendar_CreateCalendar_014(
p_szCalendarId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bWorkOnSat bit,
p_bWorkOnSun bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_Calendar
(
szCalendarId,
szDescription,
bWorkOnSat,
bWorkOnSun,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCalendarId,
p_szDescription,
p_bWorkOnSat,
p_bWorkOnSun,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Calendar_CreateCalendarOverride(
p_szCalendarId BOS_DT_szId,
p_shItemNumber smallint,
p_dtmOverride timestamp,
p_bWorkingDay bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_CalendarOverride
(
szCalendarId,
shItemNumber,
dtmOverride,
bWorkingDay
)
VALUES
(
p_szCalendarId,
p_shItemNumber,
p_dtmOverride,
p_bWorkingDay
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Calendar_DeleteCalendar(
p_szCalendarId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_GEN_Calendar
WHERE
szCalendarId = p_szCalendarId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Calendar_DeleteCalendarOverride(
p_szCalendarId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_GEN_CalendarOverride
WHERE
szCalendarId = p_szCalendarId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Calendar_GetCalendar(
p_szCalendarId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
bWorkOnSat,
bWorkOnSun,
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_GEN_Calendar
WHERE 
szCalendarId = p_szCalendarId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Calendar_GetCalendar_014(
p_szCalendarId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
bWorkOnSat,
bWorkOnSun,
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_GEN_Calendar
WHERE 
szCalendarId = p_szCalendarId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Calendar_GetCalendarOverride(
p_szCalendarId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemNumber,
dtmOverride,
bWorkingDay

FROM 
BOS_GEN_CalendarOverride
WHERE 
szCalendarId = p_szCalendarId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Calendar_GetListOfCalendar()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCalendarId,
szDescription

FROM 
BOS_GEN_Calendar;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Calendar_IsCalendarExist(
p_szCalendarId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCalendarId

FROM 
BOS_GEN_Calendar
WHERE 
szCalendarId = p_szCalendarId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Calendar_LockCalendar(
p_szCalendarId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Calendar
SET 
bWorkOnSat = bWorkOnSat
WHERE 
szCalendarId = p_szCalendarId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Calendar_UpdateCalendar(
p_szCalendarId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bWorkOnSat bit,
p_bWorkOnSun bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Calendar
SET 
szDescription = p_szDescription,
bWorkOnSat = p_bWorkOnSat,
bWorkOnSun = p_bWorkOnSun
WHERE 
szCalendarId = p_szCalendarId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Closing_CreateClosing(
p_szWorkplaceId BOS_DT_szId,
p_szClosingType BOS_DT_szSmallId,
p_szLocationType varchar,
p_szLocationId BOS_DT_szId,
p_dtmClosing timestamp,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_Closing
(
szWorkplaceId,
szClosingType,
szLocationType,
szLocationId,
dtmClosing,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szWorkplaceId,
p_szClosingType,
p_szLocationType,
p_szLocationId,
p_dtmClosing,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Closing_CreateClosing_014(
p_szWorkplaceId BOS_DT_szId,
p_szClosingType BOS_DT_szSmallId,
p_szLocationType varchar,
p_szLocationId BOS_DT_szId,
p_dtmClosing timestamp,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_Closing
(
szWorkplaceId,
szClosingType,
szLocationType,
szLocationId,
dtmClosing,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szWorkplaceId,
p_szClosingType,
p_szLocationType,
p_szLocationId,
p_dtmClosing,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Closing_DeleteClosing(
p_szWorkplaceId BOS_DT_szId,
p_szClosingType BOS_DT_szSmallId,
p_szLocationType varchar,
p_szLocationId BOS_DT_szId,
p_dtmClosing timestamp)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_GEN_Closing
WHERE
szWorkplaceId = p_szWorkplaceId AND
szClosingType = p_szClosingType AND
szLocationType = p_szLocationType AND
szLocationId = p_szLocationId AND
dtmClosing = p_dtmClosing;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Closing_GetClosing(
p_szWorkplaceId BOS_DT_szId,
p_szClosingType BOS_DT_szSmallId,
p_szLocationType varchar,
p_szLocationId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szWorkplaceId
, szClosingType
, szLocationType
, szLocationId
, dtmClosing
, dtmLastUpdated
, bAlreadyTransferred

FROM 
BOS_GEN_Closing
WHERE 
szWorkplaceId = p_szWorkplaceId AND szClosingType = p_szClosingType AND szLocationType = p_szLocationType AND szLocationId = p_szLocationId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Closing_GetClosing_014(
p_szWorkplaceId BOS_DT_szId,
p_szClosingType BOS_DT_szSmallId,
p_szLocationType varchar,
p_szLocationId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szWorkplaceId
, szClosingType
, szLocationType
, szLocationId
, dtmClosing
, dtmLastUpdated
, bAlreadyTransferred

FROM 
BOS_GEN_Closing
WHERE 
szWorkplaceId = p_szWorkplaceId AND szClosingType = p_szClosingType AND szLocationType = p_szLocationType AND szLocationId = p_szLocationId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Closing_GetListClosing()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szWorkplaceId,szClosingType,szLocationType,szLocationId  

FROM 
BOS_GEN_Closing; 

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Closing_IsClosingExist(
p_szWorkplaceId BOS_DT_szId,
p_szClosingType BOS_DT_szSmallId,
p_szLocationType varchar,
p_szLocationId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
dtmClosing  

FROM 
BOS_GEN_Closing 
WHERE 
szWorkplaceId = p_szWorkplaceId AND szClosingType = p_szClosingType AND szLocationType = p_szLocationType AND szLocationId = p_szLocationId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Closing_LockClosing(
p_szWorkplaceId BOS_DT_szId,
p_szClosingType BOS_DT_szSmallId,
p_szLocationType varchar,
p_szLocationId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Closing
SET 
dtmClosing = dtmClosing
WHERE 
szWorkplaceId = @szWorkplaceId AND
	szClosingType = @szClosingType AND
	szLocationType = @szLocationType AND
	szLocationId = @szLocationId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Closing_UpdateClosing(
p_szWorkplaceId BOS_DT_szId,
p_szClosingType BOS_DT_szSmallId,
p_szLocationType varchar,
p_szLocationId BOS_DT_szId,
p_dtmClosing timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Closing
SET 
dtmClosing = p_dtmClosing
WHERE 
szWorkplaceId = p_szWorkplaceId AND
szClosingType = @szClosingType AND
	szLocationType = @szLocationType AND
	szLocationId = @szLocationId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Counter_CreateCounter(
p_szCounterId BOS_DT_szId,
p_lngLastCounterNumber bigint,
p_lngMaxNumber bigint,
p_szDescription varchar,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_Counter
(szCounterId, lngLastCounterNumber, lngMaxNumber, szDescription, dtmLastUpdated, bAlreadyTransferred)
VALUES
(@szCounterId, @lngLastCounterNumber, @lngMaxNumber, @szDescription, @dtmLastUpdated, @bAlreadyTransferred);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Counter_CreateCounter_014(
p_szCounterId BOS_DT_szId,
p_lngLastCounterNumber bigint,
p_lngMaxNumber bigint,
p_szDescription varchar,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_Counter
(szCounterId, lngLastCounterNumber, lngMaxNumber, szDescription, dtmLastUpdated, bAlreadyTransferred)
VALUES
(@szCounterId, @lngLastCounterNumber, @lngMaxNumber, @szDescription, @dtmLastUpdated, @bAlreadyTransferred);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Counter_DeleteCounter(
p_szCounterId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_GEN_Counter where szCounterId = p_szCounterId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Counter_GetCounter(
p_szCounterId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
select lngLastCounterNumber, lngMaxNumber, szDescription, dtmLastUpdated, bAlreadyTransferred

FROM 
BOS_GEN_Counter
WHERE 
 szCounterId = p_szCounterId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Counter_GetCounter_014(
p_szCounterId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
select lngLastCounterNumber, lngMaxNumber, szDescription, dtmLastUpdated, bAlreadyTransferred

FROM 
BOS_GEN_Counter
WHERE 
 szCounterId = p_szCounterId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Counter_GetListOfCounter()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCounterId, szDescription

FROM 
BOS_GEN_Counter

ORDER BY 
szCounterId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Counter_GetNextCounter(
p_szCounterId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Counter --with (rowlock)
SET 
lngLastCounterNumber = lngLastCounterNumber + 1

WHERE 
 szCounterId = p_szCounterId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Counter_GetNextCounter_013(
p_szCounterId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Counter --with (rowlock)
SET 
lngLastCounterNumber = lngLastCounterNumber + 1


WHERE 
 szCounterId = p_szCounterId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Counter_IsCounterExist(
p_szCounterId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
lngLastCounterNumber 

FROM 
BOS_GEN_Counter 
WHERE 
 szCounterId = p_szCounterId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Counter_LockCounter(
p_szCounterId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Counter
SET 
 lngLastCounterNumber = lngLastCounterNumber
WHERE 
 szCounterId = p_szCounterId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Counter_UpdateCounter(
p_szCounterId BOS_DT_szId,
p_lngLastCounterNumber bigint,
p_lngMaxNumber bigint,
p_szDescription varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Counter
SET 
 lngLastCounterNumber = p_lngLastCounterNumber, lngMaxNumber = p_lngMaxNumber, szDescription = p_szDescription
WHERE 
 szCounterId = p_szCounterId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_DataTrf_CreateDataTrf(
p_szWpId BOS_DT_szId,
p_szDataTrfId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_szFlexiKeyId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_DataTrf
(
szWpId,
szDataTrfId,
szDescription,
szFlexiKeyId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szWpId,
p_szDataTrfId,
p_szDescription,
p_szFlexiKeyId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_DataTrf_CreateDataTrfItem(
p_szWpId BOS_DT_szId,
p_szDataTrfId BOS_DT_szBigId,
p_shItemNumber smallint,
p_szUri BOS_DT_szUri,
p_bAllWp bit,
p_bDestWp bit,
p_szDestWpId BOS_DT_szId,
p_szFromId BOS_DT_szId,
p_szToId BOS_DT_szId,
p_szFromId2 BOS_DT_szId,
p_szToId2 BOS_DT_szId,
p_bNotVoidOnly bit,
p_bNeedNoApprovalOnly bit,
p_bApprovedOnly bit,
p_bAppliedOnly bit,
p_bToday bit,
p_bFromToDate bit,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_bUnexportedDataOnly bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_DataTrfItem
(
szWpId,
szDataTrfId,
shItemNumber,
szUri,
bAllWp,
bDestWp,
szDestWpId,
szFromId,
szToId,
szFromId2,
szToId2,
bNotVoidOnly,
bNeedNoApprovalOnly,
bApprovedOnly,
bAppliedOnly,
bToday,
bFromToDate,
dtmFrom,
dtmTo,
bUnexportedDataOnly
)
VALUES
(
p_szWpId,
p_szDataTrfId,
p_shItemNumber,
p_szUri,
p_bAllWp,
p_bDestWp,
p_szDestWpId,
p_szFromId,
p_szToId,
p_szFromId2,
p_szToId2,
p_bNotVoidOnly,
p_bNeedNoApprovalOnly,
p_bApprovedOnly,
p_bAppliedOnly,
p_bToday,
p_bFromToDate,
p_dtmFrom,
p_dtmTo,
p_bUnexportedDataOnly
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_DataTrf_DeleteDataTrf(
p_szWpId BOS_DT_szId,
p_szDataTrfId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_GEN_DataTrf
WHERE
szWpId = p_szWpId AndszDataTrfId = p_szDataTrfId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_DataTrf_DeleteDataTrfItem(
p_szWpId BOS_DT_szId,
p_szDataTrfId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_GEN_DataTrfItem
WHERE
szWpId = p_szWpId AndszDataTrfId = p_szDataTrfId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_DataTrf_GetDataTrf(
p_szWpId BOS_DT_szId,
p_szDataTrfId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
szFlexiKeyId,

-- Data Status.
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_GEN_DataTrf
WHERE 
szWpId = p_szWpId And szDataTrfId = p_szDataTrfId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_DataTrf_GetDataTrfItem(
p_szWpId BOS_DT_szId,
p_szDataTrfId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemNumber,
szUri,
bAllWp,
bDestWp,
szDestWpId,
szFromId,
szToId,
szFromId2,
szToId2,
bNotVoidOnly,
bNeedNoApprovalOnly,
bApprovedOnly,
bAppliedOnly,
bToday,
bFromToDate,
dtmFrom,
dtmTo,
bUnexportedDataOnly

FROM 
BOS_GEN_DataTrfItem
WHERE 
szWpId = p_szWpId And szDataTrfId = p_szDataTrfId ;ORDER BY 
shItemNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_DataTrf_GetListOfDataTrf(
p_szWpId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDataTrfId,
szDescription,
szFlexiKeyId

FROM 
BOS_GEN_DataTrf
WHERE 
szWpId = p_szWpId ;ORDER BY 
szDataTrfId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_DataTrf_IsDataTrfExist(
p_szWpId BOS_DT_szId,
p_szDataTrfId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szWpId

FROM 
BOS_GEN_DataTrf
WHERE 
szWpId = p_szWpId And szDataTrfId = p_szDataTrfId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_DataTrf_LockDataTrf(
p_szWpId BOS_DT_szId,
p_szDataTrfId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_DataTrf
SET 
szDescription = szDescription
WHERE 
szWpId = p_szWpId And;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_DataTrf_UpdateDataTrf(
p_szWpId BOS_DT_szId,
p_szDataTrfId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_szFlexiKeyId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_DataTrf
SET 
szDescription = p_szDescription,
szFlexiKeyId = p_szFlexiKeyId
WHERE 
szWpId = p_szWpId And;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FBackDateClosing_CreateFBackDateClosing(
p_szFBackDateClosingId BOS_DT_szId,
p_dtmDate timestamp,
p_dtmCashierLastClosing timestamp,
p_dtmDistrLastClosing timestamp,
p_dtmInvLastClosing timestamp,
p_dtmBackDate timestamp,
p_bCloseCashier BOS_DT_bBoolean,
p_bCloseDistr BOS_DT_bBoolean,
p_bCloseInv BOS_DT_bBoolean,
p_szReason BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_FBackDateClosing
(
szFBackDateClosingId,
dtmDate,
dtmCashierLastClosing,
dtmDistrLastClosing,
dtmInvLastClosing,
dtmBackDate,
bCloseCashier,
bCloseDistr,
bCloseInv,
szReason,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFBackDateClosingId,
p_dtmDate,
p_dtmCashierLastClosing,
p_dtmDistrLastClosing,
p_dtmInvLastClosing,
p_dtmBackDate,
p_bCloseCashier,
p_bCloseDistr,
p_bCloseInv,
p_szReason,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FBackDateClosing_UpdateFBackDateClosing(
p_szFBackDateClosingId BOS_DT_szId,
p_dtmDate timestamp,
p_dtmCashierLastClosing timestamp,
p_dtmDistrLastClosing timestamp,
p_dtmInvLastClosing timestamp,
p_dtmBackDate timestamp,
p_bCloseCashier BOS_DT_bBoolean,
p_bCloseDistr BOS_DT_bBoolean,
p_bCloseInv BOS_DT_bBoolean,
p_szReason BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_FBackDateClosing
SET 
dtmDate = p_dtmDate,
dtmBackDate = p_dtmBackDate,
dtmCashierLastClosing = p_dtmCashierLastClosing,
dtmDistrLastClosing = p_dtmDistrLastClosing,
dtmInvLastClosing = p_dtmInvLastClosing,
bCloseCashier = p_bCloseCashier,
bCloseDistr= p_bCloseDistr,
bCloseInv = p_bCloseInv,
szReason = p_szReason,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFBackDateClosingId = p_szFBackDateClosingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FClosing_CreateFClosing(
p_szFClosingId BOS_DT_szId,
p_dtmClosing timestamp,
p_bInventory bit,
p_bCashier bit,
p_szWhId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_FClosing
(
szFClosingId,
dtmClosing,
bInventory,
bCashier,
szWhId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
)
VALUES
(
p_szFClosingId,
p_dtmClosing,
p_bInventory,
p_bCashier,
p_szWhId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FClosing_DeleteFClosing(
p_szFClosingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_GEN_FClosing
WHERE
 szFClosingId = p_szFClosingId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FClosing_GetFClosing(
p_szFClosingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT

BOS_GEN_FClosing.szFClosingId,
BOS_GEN_FClosing.dtmClosing,
BOS_GEN_FClosing.bInventory,
BOS_GEN_FClosing.bCashier,
BOS_GEN_FClosing.szWhId,
BOS_GEN_FClosing.bResultFrTransfer,
BOS_GEN_FClosing.bVoid, 
BOS_GEN_Approved.bApproved,
BOS_GEN_FClosing.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_GEN_FClosing.btPrintedCount,
BOS_GEN_FClosing.bTransferred,
BOS_GEN_FClosing.szCompanyId,
BOS_GEN_FClosing.szWorkplaceId,
BOS_GEN_FClosing.szTaxEntityId,
BOS_GEN_FClosing.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId

FROM
BOS_GEN_FClosing LEFT JOIN BOS_GEN_Approved ON BOS_GEN_FClosing.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_GEN_FClosing.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
WHERE
BOS_GEN_FClosing.szFClosingId = p_szFClosingId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FClosing_GetListOfFClosing(
p_szFClosingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFClosingId, dtmClosing 

FROM 
BOS_GEN_FClosing 

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FClosing_IsFClosingExist(
p_szFClosingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
 szFClosingId 

FROM 
BOS_GEN_FClosing 
WHERE 
szFClosingId = p_szFClosingId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FClosing_LockFClosing(
p_szFClosingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_FClosing
SET 
bInventory = bInventory
WHERE 
szFClosingId = p_szFClosingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FClosing_MarkFClosingApplied(
p_szFClosingId BOS_DT_szId,
p_dtmClosing timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_FClosing
SET 
dtmClosing = p_dtmClosing,
bApplied=1
WHERE 
szFClosingId=p_szFClosingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FClosing_MarkFClosingVoid(
p_szFClosingId BOS_DT_szId,
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_FClosing
SET 
bVoid = 1,
bNeedApproval = 0,
gdApprovedId = p_gdApprovedId
WHERE 
szFClosingId = p_szFClosingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FClosing_UpdateFClosing(
p_szFClosingId BOS_DT_szId,
p_dtmClosing timestamp,
p_bInventory bit,
p_bCashier bit,
p_szWhId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount bit,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_FClosing
SET 

szFClosingId=p_szFClosingId,
dtmClosing=p_dtmClosing,
bInventory=p_bInventory,
bCashier=p_bCashier,
szWhId = p_szWhId,
bVoid=p_bVoid,
bApplied=p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId

WHERE 
szFClosingId=p_szFClosingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FDataTrfSettlement_CreateFDataTrfSettlement(
p_szFDataTrfSettlementId BOS_DT_szId,
p_szDocWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szQuerySource varchar,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_FDataTrfSettlement
(
szFDataTrfSettlementId,
szDocWorkplaceId,
dtmFrom,
dtmTo,
szQuerySource,
bResultFrTransfer,
bVoid,
bApproved,
bApplied,
bJournal,
bPosted,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szApprovalId,
szFJournalId,
dtmCreated,
bSystemCreated,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFDataTrfSettlementId,
p_szDocWorkplaceId,
p_dtmFrom,
p_dtmTo,
p_szQuerySource,
p_bResultFrTransfer,
p_bVoid,
p_bApproved,
p_bApplied,
p_bJournal,
p_bPosted,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szApprovalId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FDataTrfSettlement_CreateFDataTrfSettlementItem(
p_szFDataTrfSettlementId BOS_DT_szId,
p_shItemNumber smallint,
p_szTransaction varchar,
p_decTransactionQty BOS_DT_decAmount,
p_decAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_FDataTrfSettlementItem
(
szFDataTrfSettlementId,
shItemNumber,
szTransaction,
decTransactionQty,
decAmount
)
VALUES
(
p_szFDataTrfSettlementId,
p_shItemNumber,
p_szTransaction,
p_decTransactionQty,
p_decAmount
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FDataTrfSettlement_DeleteFDataTrfSettlement(
p_szFDataTrfSettlementId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_GEN_FDataTrfSettlement
WHERE
 szFDataTrfSettlementId = p_szFDataTrfSettlementId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FDataTrfSettlement_DeleteFDataTrfSettlementItem(
p_szFDataTrfSettlementId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_GEN_FDataTrfSettlementItem
WHERE
 szFDataTrfSettlementId = p_szFDataTrfSettlementId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FDataTrfSettlement_GetFDataTrfSettlement(
p_szFDataTrfSettlementId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
select
BOS_GEN_FDataTrfSettlement.szDocWorkplaceId,
BOS_GEN_FDataTrfSettlement.dtmFrom,
BOS_GEN_FDataTrfSettlement.dtmTo,
BOS_GEN_FDataTrfSettlement.szQuerySource,
BOS_GEN_FDataTrfSettlement.bResultFrTransfer,
BOS_GEN_FDataTrfSettlement.bVoid,
BOS_GEN_FDataTrfSettlement.bApproved,
BOS_GEN_FDataTrfSettlement.bApplied,
BOS_GL_FJournalTrans.szFJournalId AS bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_GEN_FDataTrfSettlement.btPrintedCount,
BOS_GEN_FDataTrfSettlement.bTransferred,
BOS_GEN_FDataTrfSettlement.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_GEN_FDataTrfSettlement.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_GEN_FDataTrfSettlement.szTaxEntityId,
BOS_GEN_FDataTrfSettlement.bNeedApproval,
BOS_GEN_Approved.szApprovalId,
BOS_GEN_FDataTrfSettlement.gdApprovedId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_GEN_FDataTrfSettlement.dtmCreated,
BOS_GEN_FDataTrfSettlement.bSystemCreated,
BOS_GEN_FDataTrfSettlement.dtmLastUpdated,
BOS_GEN_FDataTrfSettlement.bAlreadyTransferred
from BOS_GEN_FDataTrfSettlement LEFT JOIN BOS_GEN_Approved ON  BOS_GEN_FDataTrfSettlement.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_GEN_FDataTrfSettlement.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_GL_Company On BOS_GEN_FDataTrfSettlement.szCompanyId = BOS_GL_Company.szCompanyId
LEFT JOIN BOS_GL_Workplace On BOS_GEN_FDataTrfSettlement.szWorkplaceId = BOS_GL_Workplace.szWorkplaceId
where
BOS_GEN_FDataTrfSettlement.szFDataTrfSettlementId = p_szFDataTrfSettlementId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FDataTrfSettlement_GetFDataTrfSettlementItem(
p_szFDataTrfSettlementId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemNumber,
szTransaction,
decTransactionQty,
decAmount

FROM 
BOS_GEN_FDataTrfSettlementItem
WHERE 
 szFDataTrfSettlementId = p_szFDataTrfSettlementId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FDataTrfSettlement_GetListOfFDataTrfSettlement()
RETURNS void AS
$BODY$
BEGIN
SELECT 
select szFDataTrfSettlementId, szDocWorkplaceId

FROM 
BOS_GEN_FDataTrfSettlement

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FDataTrfSettlement_GetListOfFDataTrfSettlementThatIsOverlap(
p_szQuerySource varchar,
p_szDocWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szFDataTrfSettlementId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFDataTrfSettlementId

FROM 
BOS_GEN_FDataTrfSettlement
WHERE 
 ((dtmFrom >= p_dtmFrom And dtmTo < DateAdd(Day, 1, p_dtmTo)) Or;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FDataTrfSettlement_GetListOfFDataTrfSettlementThatIsOverlapForQuery(
p_szQuerySource varchar,
p_szDocWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szFDataTrfSettlementId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFDataTrfSettlementId

FROM 
BOS_GEN_FDataTrfSettlement
WHERE 
 ((dtmFrom < p_dtmFrom And dtmTo >= p_dtmFrom) Or;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FDataTrfSettlement_IsFDataTrfSettlementExist(
p_szFDataTrfSettlementId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFDataTrfSettlementId

FROM 
BOS_GEN_FDataTrfSettlement
WHERE 
szFDataTrfSettlementId = p_szFDataTrfSettlementId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FDataTrfSettlement_LockFDataTrfSettlement(
p_szFDataTrfSettlementId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_FDataTrfSettlement
SET 
szDocWorkplaceId = szDocWorkplaceId
WHERE 
szFDataTrfSettlementId = p_szFDataTrfSettlementId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FDataTrfSettlement_MarkFDataTrfSettlementApplied(
p_szFDataTrfSettlementId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_FDataTrfSettlement
SET 
bApplied = 1
WHERE 
szFDataTrfSettlementId = p_szFDataTrfSettlementId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FDataTrfSettlement_MarkFDataTrfSettlementUnapplied(
p_szFDataTrfSettlementId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_FDataTrfSettlement
SET 
bApplied = 0
WHERE 
szFDataTrfSettlementId = p_szFDataTrfSettlementId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FDataTrfSettlement_MarkFDataTrfSettlementVoid(
p_szFDataTrfSettlementId BOS_DT_szId,
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_FDataTrfSettlement
SET 
bVoid = 1,
bNeedApproval = 0,
gdApprovedId = p_gdApprovedId
WHERE 
szFDataTrfSettlementId = p_szFDataTrfSettlementId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FDataTrfSettlement_UpdateFDataTrfSettlement(
p_szFDataTrfSettlementId BOS_DT_szId,
p_szDocWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szQuerySource varchar,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_FDataTrfSettlement
SET 
szDocWorkplaceId = p_szDocWorkplaceId,
dtmFrom = p_dtmFrom,
dtmTo = p_dtmTo,
szQuerySource = p_szQuerySource,
bResultFrTransfer = p_bResultFrTransfer,
bVoid = p_bVoid,
bApproved = p_bApproved,
bApplied = p_bApplied,
bJournal = p_bJournal,
bPosted = p_bPosted,
btPrintedCount = p_btPrintedCount,
bTransferred = p_bTransferred,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
szApprovalId = p_szApprovalId,
szFJournalId = p_szFJournalId,
dtmCreated = dtmCreated,
bSystemCreated = bSystemCreated
WHERE 
szFDataTrfSettlementId = p_szFDataTrfSettlementId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldContent_CreateFieldContent(
p_szFieldClass BOS_DT_szBigId,
p_szFieldName BOS_DT_szBigId,
p_szFieldContent BOS_DT_szBigId,
p_szParentFieldName BOS_DT_szBigId,
p_szParentFieldContent BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_FieldContent
(
szFieldClass,
szFieldName,
szFieldContent,
szParentFieldName,
szParentFieldContent,
szDescription,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFieldClass,
p_szFieldName,
p_szFieldContent,
p_szParentFieldName,
p_szParentFieldContent,
p_szDescription,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldContent_CreateFieldContent_014(
p_szFieldClass BOS_DT_szBigId,
p_szFieldName BOS_DT_szBigId,
p_szFieldContent BOS_DT_szBigId,
p_szParentFieldName BOS_DT_szBigId,
p_szParentFieldContent BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_FieldContent
(
szFieldClass,
szFieldName,
szFieldContent,
szParentFieldName,
szParentFieldContent,
szDescription,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFieldClass,
p_szFieldName,
p_szFieldContent,
p_szParentFieldName,
p_szParentFieldContent,
p_szDescription,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldContent_DeleteFieldContent(
p_szFieldClass BOS_DT_szBigId,
p_szFieldName BOS_DT_szBigId,
p_szFieldContent BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_GEN_FieldContent
WHERE
szFieldClass = p_szFieldClassAND szFieldName = p_szFieldNameAND szFieldContent = p_szFieldContent;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldContent_GetFieldContent(
p_szFieldClass BOS_DT_szBigId,
p_szFieldName BOS_DT_szBigId,
p_szFieldContent BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szParentFieldName,
szParentFieldContent,
szDescription,
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_GEN_FieldContent
WHERE 
szFieldClass = p_szFieldClass AND szFieldName = p_szFieldname AND szFieldContent = p_szFieldContent ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldContent_GetFieldContent_014(
p_szFieldClass BOS_DT_szBigId,
p_szFieldName BOS_DT_szBigId,
p_szFieldContent BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szParentFieldName,
szParentFieldContent,
szDescription,
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_GEN_FieldContent
WHERE 
szFieldClass = p_szFieldClass AND szFieldName = p_szFieldname AND szFieldContent = p_szFieldContent ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldContent_GetListOfChildFieldContent(
p_szFieldClass BOS_DT_szBigId,
p_szFieldName BOS_DT_szBigId,
p_szParentFieldName BOS_DT_szBigId,
p_szParentFieldContent BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFieldContent, szDescription

FROM 
BOS_GEN_FieldContent
WHERE 
szFieldClass = p_szFieldClass AND szFieldName = p_szFieldName AND ( (szParentFieldName = p_szParentFieldName AND szParentFieldContent = p_szParentFieldContent) OR (szParentFieldName = '' AND szParentFieldContent = '') ) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldContent_GetListOfFieldContent(
p_szFieldClass BOS_DT_szBigId,
p_szFieldName BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFieldContent, szDescription

FROM 
BOS_GEN_FieldContent
WHERE 
szFieldClass = p_szFieldClass AND szFieldName = p_szFieldName ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldContent_IsFieldContentExist(
p_szFieldClass BOS_DT_szBigId,
p_szFieldName BOS_DT_szBigId,
p_szFieldContent BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription

FROM 
BOS_GEN_FieldContent
WHERE 
szFieldClass = p_szFieldClass AND szFieldName = p_szFieldName AND szFieldContent = p_szFieldContent ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldContent_LockFieldContent(
p_szFieldClass BOS_DT_szBigId,
p_szFieldName BOS_DT_szBigId,
p_szFieldContent BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_FieldContent
SET 
szDescription = szDescription
WHERE 
szFieldClass = p_szFieldClass;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldContent_UpdateFieldContent(
p_szFieldClass BOS_DT_szBigId,
p_szFieldName BOS_DT_szBigId,
p_szFieldContent BOS_DT_szBigId,
p_szParentFieldName BOS_DT_szBigId,
p_szParentFieldContent BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_FieldContent
SET 
szParentFieldName = p_szParentFieldName,
szParentFieldContent = p_szParentFieldContent,
szDescription = p_szDescription
WHERE 
szFieldClass = p_szFieldClass;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldName_CreateFieldName(
p_szFieldClass BOS_DT_szBigId,
p_szFieldName BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_FieldName
(
szFieldClass,
szFieldName,
szDescription,
dtmLastUpdated,
bALreadyTransferred
)
VALUES
(
p_szFieldClass,
p_szFieldName,
p_szDescription,
p_dtmLastUpdated,
p_bALreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldName_CreateFieldName_014(
p_szFieldClass BOS_DT_szBigId,
p_szFieldName BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_FieldName
(
szFieldClass,
szFieldName,
szDescription,
dtmLastUpdated,
bALreadyTransferred
)
VALUES
(
p_szFieldClass,
p_szFieldName,
p_szDescription,
p_dtmLastUpdated,
p_bALreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldName_DeleteFieldName(
p_szFieldClass BOS_DT_szBigId,
p_szFieldName BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_GEN_FieldName
WHERE
szFieldClass = p_szFieldClassAND szFieldName = p_szFieldName;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldName_GetFieldName(
p_szFieldClass BOS_DT_szBigId,
p_szFieldName BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription, dtmLastUpdated, bAlreadyTransferred

FROM 
BOS_GEN_FieldName
WHERE 
szFieldClass = p_szFieldClass AND szFieldName = p_szFieldName ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldName_GetFieldName_014(
p_szFieldClass BOS_DT_szBigId,
p_szFieldName BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription, dtmLastUpdated, bAlreadyTransferred

FROM 
BOS_GEN_FieldName
WHERE 
szFieldClass = p_szFieldClass AND szFieldName = p_szFieldName ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldName_GetListOfFieldName(
p_szFieldClass BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFieldName, szDescription

FROM 
BOS_GEN_FieldName
WHERE 
szFieldClass = p_szFieldClass ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldName_IsFieldNameExist(
p_szFieldClass BOS_DT_szBigId,
p_szFieldName BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription

FROM 
BOS_GEN_FieldName
WHERE 
szFieldClass = p_szFieldClass AND szFieldName = p_szFieldName ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldName_LockFieldName(
p_szFieldClass BOS_DT_szBigId,
p_szFieldName BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_FieldName
SET 
szDescription = szDescription
WHERE 
szFieldClass = p_szFieldClass;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FieldName_UpdateFieldName(
p_szFieldClass BOS_DT_szBigId,
p_szFieldName BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_FieldName
SET 
szDescription = p_szDescription
WHERE 
szFieldClass = p_szFieldClass;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FlexiKey_CreateFlexiKey(
p_szFlexiKeyId BOS_DT_szId,
p_btSegmentCount smallint,
p_szDescription varchar,
p_bAllowDynamicGLAccEntry smallint,
p_szFieldClass BOS_DT_szBigId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_FlexiKey
(
szFlexiKeyId,
btSegmentCount,
szDescription,
bAllowDynamicGLAccEntry,
szFieldClass,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFlexiKeyId,
p_btSegmentCount,
p_szDescription,
p_bAllowDynamicGLAccEntry,
p_szFieldClass,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FlexiKey_CreateFlexiKey_014(
p_szFlexiKeyId BOS_DT_szId,
p_btSegmentCount smallint,
p_szDescription varchar,
p_bAllowDynamicGLAccEntry smallint,
p_szFieldClass BOS_DT_szBigId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_FlexiKey
(
szFlexiKeyId,
btSegmentCount,
szDescription,
bAllowDynamicGLAccEntry,
szFieldClass,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFlexiKeyId,
p_btSegmentCount,
p_szDescription,
p_bAllowDynamicGLAccEntry,
p_szFieldClass,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FlexiKey_CreateFlexiKeyItem(
p_szFlexiKeyId BOS_DT_szId,
p_btSegmentNumber smallint,
p_szKeyType BOS_DT_szSmallId,
p_szContentId BOS_DT_szId,
p_btSegmentLength smallint,
p_szSeparator varchar,
p_szAlignment varchar,
p_szFillChar varchar,
p_bBalancingSegment smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_FlexiKeyItem
(
szFlexiKeyId,
btSegmentNumber,
szKeyType,
szContentId,
btSegmentLength,
szSeparator,
szAlignment,
szFillChar,
bBalancingSegment
)
VALUES
(
p_szFlexiKeyId,
p_btSegmentNumber,
p_szKeyType,
p_szContentId,
p_btSegmentLength,
p_szSeparator,
p_szAlignment,
p_szFillChar,
p_bBalancingSegment
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FlexiKey_DeleteFlexiKey(
p_szFlexiKeyId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_GEN_FlexiKey
WHERE
szFlexiKeyId = p_szFlexiKeyId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FlexiKey_DeleteFlexiKeyItem(
p_szFlexiKeyId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_GEN_FlexiKeyItem
WHERE
szFlexiKeyId = p_szFlexiKeyId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FlexiKey_GetFlexiKey(
p_szFlexiKeyId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
btSegmentCount,
szDescription,
bAllowDynamicGLAccEntry,
szFieldClass,
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_GEN_FlexiKey
WHERE 
szFlexiKeyId = p_szFlexiKeyId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FlexiKey_GetFlexiKey_014(
p_szFlexiKeyId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
btSegmentCount,
szDescription,
bAllowDynamicGLAccEntry,
szFieldClass,
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_GEN_FlexiKey
WHERE 
szFlexiKeyId = p_szFlexiKeyId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FlexiKey_GetFlexiKeyItem(
p_szFlexiKeyId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFlexiKeyId,
btSegmentNumber,
szKeyType,
szContentId,
btSegmentLength,
szSeparator,
szAlignment,
szFillChar,
bBalancingSegment

FROM 
BOS_GEN_FlexiKeyItem
WHERE 
szFlexiKeyId = p_szFlexiKeyId ;ORDER BY 
szFlexiKeyId,
btSegmentNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FlexiKey_GetListOfFlexiKey()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFlexiKeyId,
szDescription

FROM 
BOS_GEN_FlexiKey

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FlexiKey_IsFlexiKeyExist(
p_szFlexiKeyId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
btSegmentCount

FROM 
BOS_GEN_FlexiKey
WHERE 
szFlexiKeyId = p_szFlexiKeyId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FlexiKey_LockFlexiKey(
p_szFlexiKeyId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_FlexiKey
SET 
btSegmentCount = btSegmentCount
WHERE 
szFlexiKeyId = p_szFlexiKeyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_FlexiKey_UpdateFlexiKey(
p_szFlexiKeyId BOS_DT_szId,
p_btSegmentCount smallint,
p_szDescription varchar,
p_bAllowDynamicGLAccEntry smallint,
p_szFieldClass BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_FlexiKey
SET 
btSegmentCount = p_btSegmentCount,
szDescription = p_szDescription,
bAllowDynamicGLAccEntry = p_bAllowDynamicGLAccEntry,
szFieldClass = p_szFieldClass
WHERE 
szFlexiKeyId = p_szFlexiKeyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Menu_CreateMenu(
p_szMenuId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bLock bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_Menu
(
szMenuId,
szDescription,
bLock,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szMenuId,
p_szDescription,
p_bLock,
p_dtmLastUpdated,
p_bAlreadyTransferred,
SET ANSI_NULLS ON,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Menu_CreateMenu_013(
p_szMenuId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bLock bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_Menu
(
szMenuId,
szDescription,
bLock,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szMenuId,
p_szDescription,
p_bLock,
p_dtmLastUpdated,
p_bAlreadyTransferred,
SET ANSI_NULLS ON,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Menu_CreateMenuItem(
p_szMenuId BOS_DT_szId,
p_shItemNumber smallint,
p_szItemName BOS_DT_szName,
p_szLinkAddress BOS_DT_szUrl)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_MenuItem
(
szMenuId,
shItemNumber,
szItemName,
szLinkAddress
)
VALUES
(
p_szMenuId,
p_shItemNumber,
p_szItemName,
p_szLinkAddress
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Menu_CreateMenuItem_013(
p_szMenuId BOS_DT_szId,
p_shItemNumber smallint,
p_szItemName BOS_DT_szName,
p_szLinkAddress BOS_DT_szUrl)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_MenuItem
(
szMenuId,
shItemNumber,
szItemName,
szLinkAddress
)
VALUES
(
p_szMenuId,
p_shItemNumber,
p_szItemName,
p_szLinkAddress
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Menu_DeleteMenu(
p_szMenuId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_GEN_Menu
WHERE
szMenuId = p_szMenuId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Menu_DeleteMenuItem(
p_szMenuId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_GEN_MenuItem
WHERE
szMenuId = p_szMenuId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Menu_GetListOfMenu()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szMenuId,
szDescription

FROM 
BOS_GEN_Menu

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Menu_GetMenu(
p_szMenuId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription, dtmLastUpdated, bAlreadyTransferred

FROM 
BOS_GEN_Menu
WHERE 
szMenuId = p_szMenuId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Menu_GetMenu_014(
p_szMenuId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription, dtmLastUpdated, bAlreadyTransferred

FROM 
BOS_GEN_Menu
WHERE 
szMenuId = p_szMenuId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Menu_GetMenuItem(
p_szMenuId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemNumber,
szItemName,
szLinkAddress

FROM 
BOS_GEN_MenuItem
WHERE 
szMenuId = p_szMenuId ;ORDER BY 
szMenuId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Menu_IsMenuExist(
p_szMenuId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szMenuId

FROM 
BOS_GEN_Menu
WHERE 
szMenuId = p_szMenuId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Menu_LockMenu(
p_szMenuId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Menu
SET 
bLock = bLock
WHERE 
szMenuId = p_szMenuId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Menu_UpdateMenu(
p_szMenuId BOS_DT_szId,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Menu
SET 
szDescription = p_szDescription
WHERE 
szMenuId = p_szMenuId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Menu_UpdateMenu_013(
p_szMenuId BOS_DT_szId,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Menu
SET 
szDescription = p_szDescription
WHERE 
szMenuId = p_szMenuId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_CreateOlap(
p_szOlapTypeId BOS_DT_szBigId,
p_szOlapName BOS_DT_szName,
p_szOlapTitle BOS_DT_szName,
p_szOlapParameter BOS_DT_szBigId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_Olap
(
szOlapTypeId,
szOlapName,
szOlapTitle,
szOlapParameter,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szOlapTypeId,
p_szOlapName,
p_szOlapTitle,
p_szOlapParameter,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_CreateOlap_013(
p_szOlapTypeId BOS_DT_szBigId,
p_szOlapName BOS_DT_szName,
p_szOlapTitle BOS_DT_szName,
p_szOlapParameter BOS_DT_szBigId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_Olap
(
szOlapTypeId,
szOlapName,
szOlapTitle,
szOlapParameter,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szOlapTypeId,
p_szOlapName,
p_szOlapTitle,
p_szOlapParameter,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_CreateOlapItem(
p_szOlapTypeId BOS_DT_szBigId,
p_szOlapName BOS_DT_szName,
p_shItemNumber smallint,
p_szColumnName BOS_DT_szName,
p_shColumnWidth smallint,
p_bDetail bit,
p_bSummarized bit,
p_szPrintText BOS_DT_szName,
p_szSortType BOS_DT_szSmallId,
p_iMaxDisplayedRow integer,
p_szRowToDisplay BOS_DT_szSmallId,
p_szProductIdFieldNm BOS_DT_szName,
p_szCompUomIdForTotal BOS_DT_szId,
p_szStyle BOS_DT_szId,
p_bInline BOS_DT_bBoolean,
p_iIndentLength integer,
p_bFreeze BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_OlapItem
(
szOlapTypeId,
szOlapName,
shItemNumber,
szColumnName,
shColumnWidth,
bDetail,
bSummarized,
szPrintText,
szSortType,
iMaxDisplayedRow,
szRowToDisplay,
szProductIdFieldNm,
szCompUomIdForTotal,
szStyle,
bInline,
iIndentLength,
bFreeze
)
VALUES
(
p_szOlapTypeId,
p_szOlapName,
p_shItemNumber,
p_szColumnName,
p_shColumnWidth,
p_bDetail,
p_bSummarized,
p_szPrintText,
p_szSortType,
p_iMaxDisplayedRow,
p_szRowToDisplay,
p_szProductIdFieldNm,
p_szCompUomIdForTotal,
p_szStyle,
p_bInline,
p_iIndentLength,
p_bFreeze
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_CreateOlapItem_013(
p_szOlapTypeId BOS_DT_szBigId,
p_szOlapName BOS_DT_szName,
p_shItemNumber smallint,
p_szColumnName BOS_DT_szName,
p_shColumnWidth smallint,
p_bDetail bit,
p_bSummarized bit,
p_szPrintText BOS_DT_szName,
p_szSortType BOS_DT_szSmallId,
p_iMaxDisplayedRow integer,
p_szRowToDisplay BOS_DT_szSmallId,
p_szProductIdFieldNm BOS_DT_szName,
p_szCompUomIdForTotal BOS_DT_szId,
p_szStyle BOS_DT_szId,
p_bInline BOS_DT_bBoolean,
p_iIndentLength integer,
p_bFreeze BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_OlapItem
(
szOlapTypeId,
szOlapName,
shItemNumber,
szColumnName,
shColumnWidth,
bDetail,
bSummarized,
szPrintText,
szSortType,
iMaxDisplayedRow,
szRowToDisplay,
szProductIdFieldNm,
szCompUomIdForTotal,
szStyle,
bInline,
iIndentLength,
bFreeze
)
VALUES
(
p_szOlapTypeId,
p_szOlapName,
p_shItemNumber,
p_szColumnName,
p_shColumnWidth,
p_bDetail,
p_bSummarized,
p_szPrintText,
p_szSortType,
p_iMaxDisplayedRow,
p_szRowToDisplay,
p_szProductIdFieldNm,
p_szCompUomIdForTotal,
p_szStyle,
p_bInline,
p_iIndentLength,
p_bFreeze
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_DeleteOlap(
p_szOlapTypeId BOS_DT_szBigId,
p_szOlapName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_GEN_Olap
WHERE
szOlapTypeId = p_szOlapTypeId AndszOlapName = p_szOlapName;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_DeleteOlap_013(
p_szOlapTypeId BOS_DT_szBigId,
p_szOlapName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_GEN_Olap
WHERE
szOlapTypeId = p_szOlapTypeId AndszOlapName = p_szOlapName;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_DeleteOlapItem(
p_szOlapTypeId BOS_DT_szBigId,
p_szOlapName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_GEN_OlapItem
WHERE
szOlapTypeId = p_szOlapTypeId AndszOlapName = p_szOlapName;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_DeleteOlapItem_013(
p_szOlapTypeId BOS_DT_szBigId,
p_szOlapName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_GEN_OlapItem
WHERE
szOlapTypeId = p_szOlapTypeId AndszOlapName = p_szOlapName;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_GetListOfOlap()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szOlapTypeId,
szOlapName,
szOlapTitle

FROM 
BOS_GEN_Olap
order by
szOlapTypeId,
szOlapName
ORDER BY 
szOlapTypeId,
szOlapName

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_GetListOfOlapWhereOlapType(
p_szOlapTypeId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szOlapName,
szOlapTitle

FROM 
BOS_GEN_Olap
WHERE 
szOlapTypeId = p_szOlapTypeId ;ORDER BY 
szOlapName

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_GetOlap(
p_szOlapTypeId BOS_DT_szBigId,
p_szOlapName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szOlapTitle,
szOlapParameter,
-- Data Status.
dtmLastUpdated,
bAlreadyTransferred


FROM 
BOS_GEN_Olap
WHERE 
szOlapTypeId = p_szOlapTypeId And szOlapName = p_szOlapName ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_GetOlap_013(
p_szOlapTypeId BOS_DT_szBigId,
p_szOlapName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szOlapTitle,
szOlapParameter,

-- Data Status.
dtmLastUpdated,
bAlreadyTransferred


FROM 
BOS_GEN_Olap
WHERE 
szOlapTypeId = p_szOlapTypeId And szOlapName = p_szOlapName ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_GetOlapItem(
p_szOlapTypeId BOS_DT_szBigId,
p_szOlapName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemNumber,
szColumnName,
shColumnWidth,
bDetail,
bSummarized,
szPrintText,
szSortType,
iMaxDisplayedRow,
szRowToDisplay,
szProductIdFieldNm,
szCompUomIdForTotal,
szStyle,
bInline,
iIndentLength,
bFreeze

FROM 
BOS_GEN_OlapItem
WHERE 
szOlapTypeId = p_szOlapTypeId And szOlapName = p_szOlapName ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_GetOlapItem_013(
p_szOlapTypeId BOS_DT_szBigId,
p_szOlapName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemNumber,
szColumnName,
shColumnWidth,
bDetail,
bSummarized,
szPrintText,
szSortType,
iMaxDisplayedRow,
szRowToDisplay,
szProductIdFieldNm,
szCompUomIdForTotal,
szStyle,
bInline,
iIndentLength,
bFreeze

FROM 
BOS_GEN_OlapItem
WHERE 
szOlapTypeId = p_szOlapTypeId And szOlapName = p_szOlapName ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_IsOlapExist(
p_szOlapTypeId BOS_DT_szBigId,
p_szOlapName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szOlapTypeId

FROM 
BOS_GEN_Olap
WHERE 
szOlapTypeId = p_szOlapTypeId And szOlapName = p_szOlapName ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_IsOlapExist_013(
p_szOlapTypeId BOS_DT_szBigId,
p_szOlapName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szOlapTypeId

FROM 
BOS_GEN_Olap
WHERE 
szOlapTypeId = p_szOlapTypeId And szOlapName = p_szOlapName ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_LockOlap(
p_szOlapTypeId BOS_DT_szBigId,
p_szOlapName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Olap
SET 
szOlapTitle = szOlapTitle
WHERE 
szOlapTypeId = p_szOlapTypeId And;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_LockOlap_013(
p_szOlapTypeId BOS_DT_szBigId,
p_szOlapName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Olap
SET 
szOlapTitle = szOlapTitle
WHERE 
szOlapTypeId = p_szOlapTypeId And;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_UpdateOlap(
p_szOlapTypeId BOS_DT_szBigId,
p_szOlapName BOS_DT_szName,
p_szOlapTitle BOS_DT_szName,
p_szOlapParameter BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Olap
SET 
szOlapTitle = p_szOlapTitle
, szOlapParameter = p_szOlapParameter
WHERE 
szOlapTypeId = p_szOlapTypeId And;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Olap_UpdateOlap_013(
p_szOlapTypeId BOS_DT_szBigId,
p_szOlapName BOS_DT_szName,
p_szOlapTitle BOS_DT_szName,
p_szOlapParameter BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Olap
SET 
szOlapTitle = p_szOlapTitle
, szOlapParameter = p_szOlapParameter
WHERE 
szOlapTypeId = p_szOlapTypeId And;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Reason_CreateReason(
p_szReasonId BOS_DT_szId,
p_szReasonType BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_Reason
(
szReasonId,
szReasonType,
szDescription,
dtmLastUpdated,
bAlreadyTransferred,
)
VALUES
(
p_szReasonId,
p_szReasonType,
p_szDescription,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Reason_DeleteReason(
p_szReasonId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_GEN_Reason
WHERE
szReasonId = p_szReasonId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Reason_GetListOfReason()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szReasonId,
szReasonType,
szDescription

FROM 
BOS_GEN_Reason

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Reason_GetListOfReasonWhereTypeBad()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szReasonId,
szDescription

FROM 
BOS_GEN_Reason
WHERE 
szReasonType = 'BAD' ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Reason_GetReason(
p_szReasonId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szReasonId,
szReasonType,
szDescription,

dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_GEN_Reason
WHERE 
szReasonId = p_szReasonId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Reason_IsReasonExist(
p_szReasonId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szReasonId

FROM 
BOS_GEN_Reason
WHERE 
szReasonId = p_szReasonId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Reason_LockReason(
p_szReasonId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Reason
SET 
szDescription = szDescription
WHERE 
szReasonId = p_szReasonId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_Reason_UpdateReason(
p_szReasonId BOS_DT_szId,
p_szReasonType BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_Reason
SET 
szReasonType = p_szReasonType,
szDescription = p_szDescription
WHERE 
szReasonId = p_szReasonId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_RoutineSchedule_CreateRoutineSchedule(
p_szScheduleId BOS_DT_szId,
p_szScheduleUsage varchar,
p_szScheduleType BOS_DT_szSmallId,
p_bIncludeSat bit,
p_bIncludeSun bit,
p_szDescription BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_RoutineSchedule
(
szScheduleId,
szScheduleUsage,
szScheduleType,
bIncludeSat,
bIncludeSun,
szDescription,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szScheduleId,
p_szScheduleUsage,
p_szScheduleType,
p_bIncludeSat,
p_bIncludeSun,
p_szDescription,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_RoutineSchedule_CreateRoutineScheduleItem(
p_szScheduleId BOS_DT_szId,
p_shScheduleItem smallint,
p_decValue BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_RoutineScheduleItem
(
szScheduleId,
shScheduleItem,
decValue
)
VALUES
(
p_szScheduleId,
p_shScheduleItem,
p_decValue
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_RoutineSchedule_DeleteRoutineSchedule(
p_szScheduleId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_GEN_RoutineSchedule
WHERE
szScheduleId = p_szScheduleId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_RoutineSchedule_DeleteRoutineScheduleItem(
p_szScheduleId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_GEN_RoutineScheduleItem
WHERE
szScheduleId = p_szScheduleId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_RoutineSchedule_GetListOfRoutineSchedule(
p_szScheduleUsage varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szScheduleId,
szScheduleType,
szDescription


FROM 
BOS_GEN_RoutineSchedule

WHERE 
szScheduleUsage like p_szScheduleUsage ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_RoutineSchedule_GetRoutineSchedule(
p_szScheduleId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szScheduleId,
szScheduleUsage,
szScheduleType,
bIncludeSat,
bIncludeSun,
szDescription,

dtmLastUpdated,
bAlreadyTransferred


FROM 
BOS_GEN_RoutineSchedule
WHERE 
szScheduleId = p_szScheduleId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_RoutineSchedule_GetRoutineScheduleItem(
p_szScheduleId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BGRSI.szScheduleId,
BGRSI.shScheduleItem,
BGRSI.decValue,
BGRS.szScheduleType AS szScheduleType_J


FROM 
BOS_GEN_RoutineScheduleItem AS BGRSI
INNER JOIN BOS_GEN_RoutineSchedule AS BGRS ON BGRS.szScheduleId = BGRSI.szScheduleIdINNER JOIN BOS_GEN_RoutineSchedule AS BGRS ON BGRS.szScheduleId = BGRSI.szScheduleId;
WHERE 
BGRSI.szScheduleId = p_szScheduleId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_RoutineSchedule_IsRoutineScheduleExist(
p_szScheduleId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szScheduleId

FROM 
BOS_GEN_RoutineSchedule
WHERE 
szScheduleId = p_szScheduleId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_RoutineSchedule_LockRoutineSchedule(
p_szScheduleId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_RoutineSchedule
SET 
szDescription = szDescription
WHERE 
szScheduleId = p_szScheduleId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_RoutineSchedule_UpdateRoutineSchedule(
p_szScheduleId BOS_DT_szId,
p_szScheduleUsage varchar,
p_szScheduleType BOS_DT_szSmallId,
p_bIncludeSat bit,
p_bIncludeSun bit,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_RoutineSchedule
SET 
szScheduleType = p_szScheduleType,
szScheduleUsage = p_szScheduleUsage,
bIncludeSat = p_bIncludeSat,
bIncludeSun = p_bIncludeSun,
szDescription = p_szDescription
WHERE 
szScheduleId = p_szScheduleId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_TrnMaster_CreateTrnMaster(
p_szUri BOS_DT_szUri,
p_szTrnId BOS_DT_szMediumId,
p_szName BOS_DT_szName,
p_szAssemblyNm BOS_DT_szBigId,
p_szFqn BOS_DT_szBigId,
p_bShowAsTransferable bit,
p_bSupportDataMaintenance bit,
p_bSupportGLPosting bit,
p_supportDataMaster bit,
p_supportDataExtension bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_TrnMaster
(
szUri,
szTrnId,
szName,
szAssemblyNm,
szFqn,
bShowAsTransferable,
bSupportDataMaintenance,
bSupportGLPosting,
supportDataMaster,
supportDataExtension
)
VALUES
(
p_szUri,
p_szTrnId,
p_szName,
p_szAssemblyNm,
p_szFqn,
p_bShowAsTransferable,
p_bSupportDataMaintenance,
p_bSupportGLPosting,
p_supportDataMaster,
p_supportDataExtension
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_TrnMaster_CreateTrnMaster_013(
p_szUri BOS_DT_szUri,
p_szTrnId BOS_DT_szMediumId,
p_szName BOS_DT_szName,
p_szAssemblyNm BOS_DT_szBigId,
p_szFqn BOS_DT_szBigId,
p_bShowAsTransferable bit,
p_bSupportDataMaintenance bit,
p_bSupportGLPosting bit,
p_supportDataMaster bit,
p_supportDataExtension bit,
p_bSupportExportImport bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GEN_TrnMaster
(
szUri,
szTrnId,
szName,
szAssemblyNm,
szFqn,
bShowAsTransferable,
bSupportDataMaintenance,
bSupportGLPosting,
supportDataMaster,
supportDataExtension,
bSupportExportImport
)
VALUES
(
p_szUri,
p_szTrnId,
p_szName,
p_szAssemblyNm,
p_szFqn,
p_bShowAsTransferable,
p_bSupportDataMaintenance,
p_bSupportGLPosting,
p_supportDataMaster,
p_supportDataExtension,
p_bSupportExportImport
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_TrnMaster_DeleteTrnMaster(
p_szUri BOS_DT_szUri)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_GEN_TrnMaster
WHERE
szUri=p_szUri;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_TrnMaster_GetListOfDataMaster()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szUri,
szTrnId,
szName

FROM 
BOS_GEN_TrnMaster
WHERE 
supportDataMaster = 1 ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_TrnMaster_GetListOfTrnMaster()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szUri,
szTrnId,
szName

FROM 
BOS_GEN_TrnMaster

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_TrnMaster_GetTrnMaster(
p_szUri BOS_DT_szUri)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szTrnId,
szName,
szAssemblyNm,
szFqn,
bShowAsTransferable,
bSupportDataMaintenance,
bSupportGLPosting,
supportDataMaster,
supportDataExtension


FROM 
BOS_GEN_TrnMaster
WHERE 
szUri=p_szUri ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_TrnMaster_GetTrnMaster_013(
p_szUri BOS_DT_szUri)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szTrnId,
szName,
szAssemblyNm,
szFqn,
bShowAsTransferable,
bSupportDataMaintenance,
bSupportGLPosting,
supportDataMaster,
supportDataExtension,
bSupportExportImport


FROM 
BOS_GEN_TrnMaster
WHERE 
szUri=p_szUri ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_TrnMaster_IsTrnMasterExist(
p_szUri BOS_DT_szUri)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szUri

FROM 
BOS_GEN_TrnMaster
WHERE 
szUri=p_szUri ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_TrnMaster_LockTrnMaster(
p_szUri BOS_DT_szUri)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_TrnMaster
SET 
szTrnId=szTrnId
WHERE 
szUri=p_szUri;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_TrnMaster_UpdateTrnMaster(
p_szUri BOS_DT_szUri,
p_szName BOS_DT_szName,
p_szAssemblyNm BOS_DT_szBigId,
p_szFqn BOS_DT_szBigId,
p_bShowAsTransferable bit,
p_bSupportDataMaintenance bit,
p_bSupportGLPosting bit,
p_supportDataMaster bit,
p_supportDataExtension bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_TrnMaster
SET 
szName=p_szName,
szAssemblyNm = p_szAssemblyNm,
szFqn = p_szFqn,
bShowAsTransferable = p_bShowAsTransferable,
bSupportDataMaintenance = p_bSupportDataMaintenance,
bSupportGLPosting = p_bSupportGLPosting,
supportDataMaster = p_supportDataMaster,
supportDataExtension = p_supportDataExtension

WHERE 
szUri=p_szUri;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GEN_TrnMaster_UpdateTrnMaster_013(
p_szUri BOS_DT_szUri,
p_szName BOS_DT_szName,
p_szAssemblyNm BOS_DT_szBigId,
p_szFqn BOS_DT_szBigId,
p_bShowAsTransferable bit,
p_bSupportDataMaintenance bit,
p_bSupportGLPosting bit,
p_supportDataMaster bit,
p_supportDataExtension bit,
p_bSupportExportImport bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GEN_TrnMaster
SET 
szName=p_szName,
szAssemblyNm = p_szAssemblyNm,
szFqn = p_szFqn,
bShowAsTransferable = p_bShowAsTransferable,
bSupportDataMaintenance = p_bSupportDataMaintenance,
bSupportGLPosting = p_bSupportGLPosting,
supportDataMaster = p_supportDataMaster,
supportDataExtension = p_supportDataExtension,
bSupportExportImport = p_bSupportExportImport

WHERE 
szUri=p_szUri;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Account_CreateAccount(
p_szAccountId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szAccountType varchar,
p_szOnlyUsedForWorkplaceId BOS_DT_szId,
p_szOnlyUsedForUserId BOS_DT_szId,
p_szFullPathAccId BOS_DT_szFullPath,
p_byteLevel BOS_DT_byteLevel,
p_bGroup BOS_DT_bBoolean,
p_szDefaultBalance BOS_DT_szOneChar,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GL_Account
(
szAccountId,
szName,
szAccountType,
szOnlyUsedForWorkplaceId,
szOnlyUsedForUserId,
szFullPathAccId,
byteLevel,
bGroup,
szDefaultBalance,
dtmLastUpdated,
bAlreadyTransferred,
)
VALUES
(
p_szAccountId,
p_szName,
p_szAccountType,
p_szOnlyUsedForWorkplaceId,
p_szOnlyUsedForUserId,
p_szFullPathAccId,
p_byteLevel,
p_bGroup,
p_szDefaultBalance,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Account_DeleteAccount(
p_szAccountId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_GL_Account
WHERE
szAccountId=p_szAccountId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Account_GetAccount(
p_szAccountId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_GL_Account.szAccountId,
BOS_GL_Account.szName,
BOS_GL_Account.szAccountType,

BOS_GL_Account.szOnlyUsedForWorkplaceId,
WP.szName AS szOnlyUsedForWorkplaceNm_J,

BOS_GL_Account.szOnlyUsedForUserId,
USR.szName AS szOnlyUsedForUserNm_J,

BOS_GL_Account.szFullPathAccId,
BOS_GL_Account.bGroup,
BOS_GL_Account.byteLevel,
BOS_GL_Account.szDefaultBalance,


BOS_GL_Account.dtmLastUpdated,
BOS_GL_Account.bAlreadyTransferred

FROM
BOS_GL_Account 
LEFT JOIN BOS_GL_Workplace AS WP ON WP.szWorkplaceId = BOS_GL_Account.szOnlyUsedForWorkplaceId
LEFT JOIN BOS_SM_User AS USR ON USR.szUserId = BOS_GL_Account.szOnlyUsedForUserId
WHERE
szAccountId=p_szAccountId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Account_GetListOfAccount()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szAccountId,
szName

FROM 
BOS_GL_Account
order by
szAccountId
ORDER BY 
szAccountId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Account_IsAccountExist(
p_szAccountId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szName

FROM 
BOS_GL_Account
WHERE 
szAccountId=p_szAccountId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Account_LockAccount(
p_szAccountId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GL_Account
SET 
szAccountType = szAccountType
WHERE 
szAccountId=p_szAccountId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Account_UpdateAccount(
p_szAccountId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szAccountType varchar,
p_szOnlyUsedForWorkplaceId BOS_DT_szId,
p_szOnlyUsedForUserId BOS_DT_szId,
p_szFullPathAccId BOS_DT_szFullPath,
p_byteLevel BOS_DT_byteLevel,
p_bGroup BOS_DT_bBoolean,
p_szDefaultBalance BOS_DT_szOneChar,
p_szPrevFullPathAccId BOS_DT_szFullPath,
p_shDiffLevel integer)
RETURNS void AS
$BODY$
BEGIN
-- ### 2 update #####
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Account_UpdateAccount_013(
p_szAccountId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szAccountType varchar,
p_szOnlyUsedForWorkplaceId BOS_DT_szId,
p_szOnlyUsedForUserId BOS_DT_szId,
p_szFullPathAccId BOS_DT_szFullPath,
p_byteLevel BOS_DT_byteLevel,
p_bGroup BOS_DT_bBoolean,
p_szDefaultBalance BOS_DT_szOneChar,
p_szPrevFullPathAccId BOS_DT_szFullPath,
p_shDiffLevel integer)
RETURNS void AS
$BODY$
BEGIN
-- ### 2 update #####
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Company_CreateCompany(
p_szCompanyId BOS_DT_szMediumId,
p_szName BOS_DT_szName,
p_szTaxEntityId BOS_DT_szId,
p_szLedgerId BOS_DT_szId,
p_szTaxSerialNumber varchar,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_szCcyRateId BOS_DT_szMediumId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GL_Company
(
szCompanyId,
szName,
szTaxEntityId,
szLedgerId,
szTaxSerialNumber,
szPriceId,
szPriceOrderId,
szPromoPriceId,
szPromoPriceOrderId,
szCcyRateId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCompanyId,
p_szName,
p_szTaxEntityId,
p_szLedgerId,
p_szTaxSerialNumber,
p_szPriceId,
p_szPriceOrderId,
p_szPromoPriceId,
p_szPromoPriceOrderId,
p_szCcyRateId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Company_CreateCompany_013(
p_szCompanyId BOS_DT_szMediumId,
p_szName BOS_DT_szName,
p_szTaxEntityId BOS_DT_szId,
p_szLedgerId BOS_DT_szId,
p_szTaxSerialNumber varchar,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_szCcyRateId BOS_DT_szMediumId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GL_Company
(
szCompanyId,
szName,
szTaxEntityId,
szLedgerId,
szTaxSerialNumber,
szPriceId,
szPriceOrderId,
szPromoPriceId,
szPromoPriceOrderId,
szCcyRateId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCompanyId,
p_szName,
p_szTaxEntityId,
p_szLedgerId,
p_szTaxSerialNumber,
p_szPriceId,
p_szPriceOrderId,
p_szPromoPriceId,
p_szPromoPriceOrderId,
p_szCcyRateId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Company_DeleteCompany(
p_szCompanyId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_GL_Company
WHERE
szCompanyId = p_szCompanyId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Company_GetCompany(
p_szCompanyId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_GL_Company.szName,

BOS_GL_Company.szTaxEntityId,
szTaxSerialNumber,

BOS_GL_Company.szLedgerId,
BOS_GL_Ledger.szCcyId AS szLedgerCcyId_J,
BOS_CU_Currency.szAmountFormat AS szLedgerCcyAmountFormat_J,

szPriceId,
szPriceOrderId,
szPromoPriceId,
szPromoPriceOrderId,

szCcyRateId,

BOS_GL_Company.dtmLastUpdated,
BOS_GL_Company.bAlreadyTransferred

FROM
BOS_GL_Company
LEFT JOIN BOS_GL_Ledger ON BOS_GL_Ledger.szLedgerId = BOS_GL_Company.szLedgerId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_GL_Ledger.szCcyId

WHERE
BOS_GL_Company.szCompanyId = p_szCompanyId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Company_GetCompany_014(
p_szCompanyId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_GL_Company.szName,

BOS_GL_Company.szTaxEntityId,
szTaxSerialNumber,

BOS_GL_Company.szLedgerId,
BOS_GL_Ledger.szCcyId AS szLedgerCcyId_J,
BOS_CU_Currency.szAmountFormat AS szLedgerCcyAmountFormat_J,

szPriceId,
szPriceOrderId,
szPromoPriceId,
szPromoPriceOrderId,

szCcyRateId,

BOS_GL_Company.dtmLastUpdated,
BOS_GL_Company.bAlreadyTransferred

FROM
BOS_GL_Company
LEFT JOIN BOS_GL_Ledger ON BOS_GL_Ledger.szLedgerId = BOS_GL_Company.szLedgerId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_GL_Ledger.szCcyId

WHERE
BOS_GL_Company.szCompanyId = p_szCompanyId


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Company_GetListOfCompany()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCompanyId,
szName

FROM 
BOS_GL_Company

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Company_IsCompanyExist(
p_szCompanyId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCompanyId

FROM 
BOS_GL_Company
WHERE 
szCompanyId = p_szCompanyId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Company_LockCompany(
p_szCompanyId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GL_Company
SET 
szName = szName
WHERE 
szCompanyId = p_szCompanyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Company_UpdateCompany(
p_szCompanyId BOS_DT_szMediumId,
p_szName BOS_DT_szName,
p_szTaxEntityId BOS_DT_szId,
p_szLedgerId BOS_DT_szId,
p_szTaxSerialNumber varchar,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_szCcyRateId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GL_Company
SET 
szName= p_szName,
szTaxEntityId=p_szTaxEntityId,
szLedgerId = p_szLedgerId,
szTaxSerialNumber=p_szTaxSerialNumber,
szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
szPromoPriceId = p_szPromoPriceId,
szPromoPriceOrderId = p_szPromoPriceOrderId,
szCcyRateId = p_szCcyRateId

WHERE 
szCompanyId = p_szCompanyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Company_UpdateCompany_013(
p_szCompanyId BOS_DT_szMediumId,
p_szName BOS_DT_szName,
p_szTaxEntityId BOS_DT_szId,
p_szLedgerId BOS_DT_szId,
p_szTaxSerialNumber varchar,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_szCcyRateId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GL_Company
SET 
szName= p_szName,
szTaxEntityId=p_szTaxEntityId,
szLedgerId = p_szLedgerId,
szTaxSerialNumber=p_szTaxSerialNumber,
szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
szPromoPriceId = p_szPromoPriceId,
szPromoPriceOrderId = p_szPromoPriceOrderId,
szCcyRateId = p_szCcyRateId

WHERE 
szCompanyId = p_szCompanyId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_FJournalTrans_CreateFJournalTrans(
p_szMyFJournalId BOS_DT_szId,
p_dtmPost timestamp,
p_szAccPeriodNm BOS_DT_szName,
p_szFBatchId BOS_DT_szId,
p_szLedgerId BOS_DT_szId,
p_szJournalCategoryId BOS_DT_szId,
p_szCcyRateId BOS_DT_szId,
p_szCcyId BOS_DT_szId,
p_szTrnId BOS_DT_szId,
p_szDocId BOS_DT_szId,
p_szUrl BOS_DT_szUrl,
p_decTotalAmount BOS_DT_decAmount,
p_decDocTotalAmount BOS_DT_decAmount,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_bClosingJournal bit,
p_szFBankSettlementId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GL_FJournalTrans
(
szFJournalId,
dtmPost,
szAccPeriodNm,
szFBatchId,
szLedgerId,
szJournalCategoryId,
szCcyRateId,
szCcyId,
szTrnId,
szDocId,
szUrl,
decTotalAmount,
decDocTotalAmount,
szDescription,
-- Doc Status,
bResultFrTransfer,
bVoid,
bPosted,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
bClosingJournal,
szFBankSettlementId
)
VALUES
(
p_szMyFJournalId,
p_dtmPost,
p_szAccPeriodNm,
p_szFBatchId,
p_szLedgerId,
p_szJournalCategoryId,
p_szCcyRateId,
p_szCcyId,
p_szTrnId,
p_szDocId,
p_szUrl,
p_decTotalAmount,
p_decDocTotalAmount,
p_szDescription,
p_bResultFrTransfer,
p_bVoid,
p_bPosted,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_bClosingJournal,
p_szFBankSettlementId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_FJournalTrans_CreateFJournalTrans_013(
p_szMyFJournalId BOS_DT_szId,
p_dtmPost timestamp,
p_szAccPeriodNm BOS_DT_szName,
p_szFBatchId BOS_DT_szId,
p_szLedgerId BOS_DT_szId,
p_szJournalCategoryId BOS_DT_szId,
p_szCcyRateId BOS_DT_szId,
p_szCcyId BOS_DT_szId,
p_szTrnId BOS_DT_szId,
p_szDocId BOS_DT_szId,
p_szUrl BOS_DT_szUrl,
p_decTotalAmount BOS_DT_decAmount,
p_decDocTotalAmount BOS_DT_decAmount,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_bClosingJournal bit,
p_szFBankSettlementId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GL_FJournalTrans
(
szFJournalId,
dtmPost,
szAccPeriodNm,
szFBatchId,
szLedgerId,
szJournalCategoryId,
szCcyRateId,
szCcyId,
szTrnId,
szDocId,
szUrl,
decTotalAmount,
decDocTotalAmount,
szDescription,
-- Doc Status,
bResultFrTransfer,
bVoid,
bPosted,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
bClosingJournal,
szFBankSettlementId
)
VALUES
(
p_szMyFJournalId,
p_dtmPost,
p_szAccPeriodNm,
p_szFBatchId,
p_szLedgerId,
p_szJournalCategoryId,
p_szCcyRateId,
p_szCcyId,
p_szTrnId,
p_szDocId,
p_szUrl,
p_decTotalAmount,
p_decDocTotalAmount,
p_szDescription,
p_bResultFrTransfer,
p_bVoid,
p_bPosted,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_bClosingJournal,
p_szFBankSettlementId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_FJournalTrans_DeleteFJournalTrans(
p_szFJournalId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_GL_FJournalTrans
WHERE
szFJournalId=p_szFJournalId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_FJournalTrans_DeleteFJournalTransItem(
p_szFJournalId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_GL_FJournalTransItem
WHERE
szFJournalId = p_szFJournalId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_FJournalTrans_GetFJournalTrans(
p_szFJournalId BOS_DT_szId,
p_btTrue BOS_DT_bBoolean,
p_btFalse BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_GL_FJournalTrans.dtmPost,
BOS_GL_FJournalTrans.szAccPeriodNm,
BOS_GL_FJournalTrans.szFBatchId,
BOS_GL_FJournalTrans.szLedgerId,
BOS_GL_FJournalTrans.szJournalCategoryId,
BOS_GL_FJournalTrans.szCcyRateId,
BOS_GL_FJournalTrans.szCcyId,	
BOS_CU_Currency.szAmountFormat As szCcyAmountFormat_J,
BOS_GL_FJournalTrans.szTrnId,
BOS_GL_FJournalTrans.szDocId,
BOS_GL_FJournalTrans.szUrl,	

BOS_GL_FJournalTrans.decTotalAmount,
BOS_GL_FJournalTrans.decDocTotalAmount,

BOS_GL_FJournalTrans.szDescription,
BOS_GL_FJournalTrans.szFBankSettlementId,

BOS_GL_FJournalTrans.bResultFrTransfer,
BOS_GL_FJournalTrans.bVoid,
BOS_GEN_Approved.bApproved as bApproved,

p_btFalse as bApplied,		--Journal document is never applied.
p_btTrue as bJournal,		--Journal document is always journaled.

BOS_GL_FJournalTrans.bPosted,
BOS_GL_FJournalTrans.btPrintedCount,
BOS_GL_FJournalTrans.bTransferred,

BOS_GL_FJournalTrans.szCompanyId,
BOS_GL_Company.szName AS szCompanyNm,

BOS_GL_FJournalTrans.szWorkplaceId,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_GL_FJournalTrans.szTaxEntityId,

BOS_GL_FJournalTrans.bNeedApproval,
BOS_GEN_Approved.gdApprovedId as gdApprovedId,
BOS_GEN_Approved.szApprovalId as szApprovalId,

BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_FJournalTrans.dtmCreated,
BOS_GL_FJournalTrans.bSystemCreated,

BOS_GL_FJournalTrans.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_GL_FJournalTrans.dtmLastUpdated,
BOS_GL_FJournalTrans.bAlreadyTransferred,

BOS_GL_FJournalTrans.bClosingJournal

FROM
BOS_GL_FJournalTrans 
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_GL_FJournalTrans.szCcyId

LEFT JOIN BOS_GEN_Approved ON BOS_GEN_Approved.gdApprovedId = BOS_GL_FJournalTrans.gdApprovedId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_GL_FJournalTrans.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_GL_FJournalTrans.szWorkplaceId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_GL_FJournalTrans.szUserId


WHERE
szFJournalId=p_szFJournalId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_FJournalTrans_GetFJournalTrans_013(
p_szFJournalId BOS_DT_szId,
p_btTrue BOS_DT_bBoolean,
p_btFalse BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_GL_FJournalTrans.dtmPost,
BOS_GL_FJournalTrans.szAccPeriodNm,
BOS_GL_FJournalTrans.szFBatchId,
BOS_GL_FJournalTrans.szLedgerId,
BOS_GL_FJournalTrans.szJournalCategoryId,
BOS_GL_FJournalTrans.szCcyRateId,
BOS_GL_FJournalTrans.szCcyId,	
BOS_CU_Currency.szAmountFormat As szCcyAmountFormat_J,
BOS_GL_FJournalTrans.szTrnId,
BOS_GL_FJournalTrans.szDocId,
BOS_GL_FJournalTrans.szUrl,	

BOS_GL_FJournalTrans.decTotalAmount,
BOS_GL_FJournalTrans.decDocTotalAmount,

BOS_GL_FJournalTrans.szDescription,
BOS_GL_FJournalTrans.szFBankSettlementId,

BOS_GL_FJournalTrans.bResultFrTransfer,
BOS_GL_FJournalTrans.bVoid,
BOS_GEN_Approved.bApproved as bApproved,

p_btFalse as bApplied,		--Journal document is never applied.
p_btTrue as bJournal,		--Journal document is always journaled.

BOS_GL_FJournalTrans.bPosted,
BOS_GL_FJournalTrans.btPrintedCount,
BOS_GL_FJournalTrans.bTransferred,

BOS_GL_FJournalTrans.szCompanyId,
BOS_GL_Company.szName AS szCompanyNm,

BOS_GL_FJournalTrans.szWorkplaceId,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_GL_FJournalTrans.szTaxEntityId,

BOS_GL_FJournalTrans.bNeedApproval,
BOS_GEN_Approved.gdApprovedId as gdApprovedId,
BOS_GEN_Approved.szApprovalId as szApprovalId,

BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_FJournalTrans.dtmCreated,
BOS_GL_FJournalTrans.bSystemCreated,

BOS_GL_FJournalTrans.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_GL_FJournalTrans.dtmLastUpdated,
BOS_GL_FJournalTrans.bAlreadyTransferred,

BOS_GL_FJournalTrans.bClosingJournal

FROM
BOS_GL_FJournalTrans 
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_GL_FJournalTrans.szCcyId

LEFT JOIN BOS_GEN_Approved ON BOS_GEN_Approved.gdApprovedId = BOS_GL_FJournalTrans.gdApprovedId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_GL_FJournalTrans.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_GL_FJournalTrans.szWorkplaceId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_GL_FJournalTrans.szUserId


WHERE
szFJournalId=p_szFJournalId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_FJournalTrans_GetListOfFJournalTrans()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFJournalId, dtmPost

FROM 
BOS_GL_FJournalTrans

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_FJournalTrans_IsFJournalTransExist(
p_szFJournalId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFJournalId

FROM 
BOS_GL_FJournalTrans
WHERE 
szFJournalId=p_szFJournalId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_FJournalTrans_LockFJournalTrans(
p_szFJournalId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GL_FJournalTrans
SET 
szDescription=szDescription
WHERE 
szFJournalId=p_szFJournalId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_FJournalTrans_UpdateFJournalTrans(
p_szMyFJournalId BOS_DT_szId,
p_dtmPost timestamp,
p_szAccPeriodNm BOS_DT_szName,
p_szFBatchId BOS_DT_szId,
p_szLedgerId BOS_DT_szId,
p_szJournalCategoryId BOS_DT_szId,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_decTotalAmount BOS_DT_decAmount,
p_decDocTotalAmount BOS_DT_decAmount,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_bClosingJournal bit,
p_szFBankSettlementId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GL_FJournalTrans
SET 
dtmPost = p_dtmPost,
szAccPeriodNm = p_szAccPeriodNm,
szFBatchId = p_szFBatchId,
szLedgerId = p_szLedgerId,
szJournalCategoryId = p_szJournalCategoryId,
szCcyRateId = p_szCcyRateId,
szCcyId = p_szCcyId,
decTotalAmount = p_decTotalAmount,
decDocTotalAmount = p_decDocTotalAmount,
szDescription = p_szDescription,

bVoid = p_bVoid,
bPosted = p_bPosted,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
bSystemCreated = p_bSystemCreated,

szUserId = p_szUserId,
bClosingJournal = p_bClosingJournal,
szFBankSettlementId = p_szFBankSettlementId

WHERE 
szFJournalId = p_szMyFJournalId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_FJournalTrans_UpdateFJournalTrans_013(
p_szMyFJournalId BOS_DT_szId,
p_dtmPost timestamp,
p_szAccPeriodNm BOS_DT_szName,
p_szFBatchId BOS_DT_szId,
p_szLedgerId BOS_DT_szId,
p_szJournalCategoryId BOS_DT_szId,
p_szCcyRateId BOS_DT_szMediumId,
p_szCcyId BOS_DT_szSmallId,
p_decTotalAmount BOS_DT_decAmount,
p_decDocTotalAmount BOS_DT_decAmount,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_bClosingJournal bit,
p_szFBankSettlementId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GL_FJournalTrans
SET 
dtmPost = p_dtmPost,
szAccPeriodNm = p_szAccPeriodNm,
szFBatchId = p_szFBatchId,
szLedgerId = p_szLedgerId,
szJournalCategoryId = p_szJournalCategoryId,
szCcyRateId = p_szCcyRateId,
szCcyId = p_szCcyId,
decTotalAmount = p_decTotalAmount,
decDocTotalAmount = p_decDocTotalAmount,
szDescription = p_szDescription,

bVoid = p_bVoid,
bPosted = p_bPosted,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
bSystemCreated = p_bSystemCreated,

szUserId = p_szUserId,
bClosingJournal = p_bClosingJournal,
szFBankSettlementId = p_szFBankSettlementId

WHERE 
szFJournalId = p_szMyFJournalId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Ledger_CreateLedger(
p_szLedgerId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szLedgerType varchar,
p_szDescription BOS_DT_szDescription,
p_szCcyId BOS_DT_szId,
p_szAccCalendarId BOS_DT_szId,
p_szCOAId BOS_DT_szId,
p_szRetainedEarningAccId BOS_DT_szId,
p_szRetainedEarningGLSubAccId BOS_DT_szGLAccount,
p_szTranslationAdjustmentAccId BOS_DT_szId,
p_szTranslationAdjustmentGLSubAccId BOS_DT_szGLAccount,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GL_Ledger
(
szLedgerId,
szName,
szLedgerType,
szDescription,
szCcyId,
szAccCalendarId,
szCOAId,
szRetainedEarningAccId,
szRetainedEarningGLSubAccId,
szTranslationAdjustmentAccId,
szTranslationAdjustmentGLSubAccId,
-- Data Status.,
dtmLastUpdated ,
bAlreadyTransferred,
)
VALUES
(
p_szLedgerId,
p_szName,
p_szLedgerType,
p_szDescription,
p_szCcyId,
p_szAccCalendarId,
p_szCOAId,
p_szRetainedEarningAccId,
p_szRetainedEarningGLSubAccId,
p_szTranslationAdjustmentAccId,
p_szTranslationAdjustmentGLSubAccId,
-- Data Status.,
p_dtmLastUpdated ,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Ledger_CreateLedger_013(
p_szLedgerId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szLedgerType varchar,
p_szDescription BOS_DT_szDescription,
p_szCcyId BOS_DT_szId,
p_szAccCalendarId BOS_DT_szId,
p_szCOAId BOS_DT_szId,
p_szRetainedEarningAccId BOS_DT_szId,
p_szRetainedEarningGLSubAccId BOS_DT_szGLAccount,
p_szTranslationAdjustmentAccId BOS_DT_szId,
p_szTranslationAdjustmentGLSubAccId BOS_DT_szGLAccount,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GL_Ledger
(
szLedgerId,
szName,
szLedgerType,
szDescription,
szCcyId,
szAccCalendarId,
szCOAId,
szRetainedEarningAccId,
szRetainedEarningGLSubAccId,
szTranslationAdjustmentAccId,
szTranslationAdjustmentGLSubAccId,
-- Data Status.,
dtmLastUpdated ,
bAlreadyTransferred,
)
VALUES
(
p_szLedgerId,
p_szName,
p_szLedgerType,
p_szDescription,
p_szCcyId,
p_szAccCalendarId,
p_szCOAId,
p_szRetainedEarningAccId,
p_szRetainedEarningGLSubAccId,
p_szTranslationAdjustmentAccId,
p_szTranslationAdjustmentGLSubAccId,
-- Data Status.,
p_dtmLastUpdated ,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Ledger_DeleteLedger(
p_szLedgerId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_GL_Ledger
WHERE
szLedgerId=p_szLedgerId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Ledger_GetLedger(
p_szLedgerId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_GL_Ledger.szName,
BOS_GL_Ledger.szLedgerType,
BOS_GL_Ledger.szDescription,
BOS_GL_Ledger.dtmLastUpdated,
BOS_GL_Ledger.bAlreadyTransferred,

BOS_GL_Ledger.szCcyId,
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat_J,

BOS_GL_Ledger.szAccCalendarId,
BOS_GL_Ledger.szCOAId,

BOS_GL_Ledger.szRetainedEarningAccId,
ReAcc.szName AS szRetainedEarningAccNm_J,

BOS_GL_Ledger.szRetainedEarningGLSubAccId,
ReSubAcc.szDescription AS szRetainedEarningGLSubAccNm_J,

BOS_GL_Ledger.szTranslationAdjustmentAccId,
TaAcc.szName AS szTranslationAdjustmentAccNm_J,

BOS_GL_Ledger.szTranslationAdjustmentGLSubAccId,
TaSubAcc.szDescription AS szTranslationAdjustmentGLSubAccNm_J

FROM
BOS_GL_Ledger

LEFT JOIN BOS_GL_Account AS ReAcc ON ReAcc.szAccountId = BOS_GL_Ledger.szRetainedEarningAccId
LEFT JOIN BOS_GL_GLSubAcc As ReSubAcc ON ReSubAcc.szLedgerId = BOS_GL_Ledger.szLedgerId
AND ReSubAcc.szGLSubAccId = BOS_GL_Ledger.szRetainedEarningGLSubAccId

LEFT JOIN BOS_GL_Account AS TaAcc ON TaAcc.szAccountId = BOS_GL_Ledger.szTranslationAdjustmentAccId
LEFT JOIN BOS_GL_GLSubAcc As TaSubAcc ON TaSubAcc.szLedgerId = BOS_GL_Ledger.szLedgerId
AND TaSubAcc.szGLSubAccId = BOS_GL_Ledger.szTranslationAdjustmentGLSubAccId

LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_GL_Ledger.szCcyId

WHERE
BOS_GL_Ledger.szLedgerId = p_szLedgerId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Ledger_GetListOfLedger()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLedgerId,
szName,
szDescription

FROM 
BOS_GL_Ledger

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Ledger_IsLedgerExist(
p_szLedgerId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLedgerId

FROM 
BOS_GL_Ledger
WHERE 
szLedgerId=p_szLedgerId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Ledger_LockLedger(
p_szLedgerId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GL_Ledger
SET 
szLedgerType=szLedgerType
WHERE 
szLedgerId=p_szLedgerId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Ledger_UpdateLedger(
p_szLedgerId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szLedgerType varchar,
p_szDescription BOS_DT_szDescription,
p_szCcyId BOS_DT_szId,
p_szAccCalendarId BOS_DT_szId,
p_szCOAId BOS_DT_szId,
p_szRetainedEarningAccId BOS_DT_szId,
p_szRetainedEarningGLSubAccId BOS_DT_szGLAccount,
p_szTranslationAdjustmentAccId BOS_DT_szId,
p_szTranslationAdjustmentGLSubAccId BOS_DT_szGLAccount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GL_Ledger
SET 
szName=p_szName,
szLedgerType=p_szLedgerType,
szDescription=p_szDescription,
szCcyId=p_szCcyId,
szAccCalendarId=p_szAccCalendarId,
szCOAId=p_szCOAId,
szRetainedEarningAccId=p_szRetainedEarningAccId,
szRetainedEarningGLSubAccId=p_szRetainedEarningGLSubAccId,
szTranslationAdjustmentAccId=p_szTranslationAdjustmentAccId,
szTranslationAdjustmentGLSubAccId=p_szTranslationAdjustmentGLSubAccId

WHERE 
szLedgerId=p_szLedgerId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Ledger_UpdateLedger_013(
p_szLedgerId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szLedgerType varchar,
p_szDescription BOS_DT_szDescription,
p_szCcyId BOS_DT_szId,
p_szAccCalendarId BOS_DT_szId,
p_szCOAId BOS_DT_szId,
p_szRetainedEarningAccId BOS_DT_szId,
p_szRetainedEarningGLSubAccId BOS_DT_szGLAccount,
p_szTranslationAdjustmentAccId BOS_DT_szId,
p_szTranslationAdjustmentGLSubAccId BOS_DT_szGLAccount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GL_Ledger
SET 
szName=p_szName,
szLedgerType=p_szLedgerType,
szDescription=p_szDescription,
szCcyId=p_szCcyId,
szAccCalendarId=p_szAccCalendarId,
szCOAId=p_szCOAId,
szRetainedEarningAccId=p_szRetainedEarningAccId,
szRetainedEarningGLSubAccId=p_szRetainedEarningGLSubAccId,
szTranslationAdjustmentAccId=p_szTranslationAdjustmentAccId,
szTranslationAdjustmentGLSubAccId=p_szTranslationAdjustmentGLSubAccId

WHERE 
szLedgerId=p_szLedgerId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_TaxEntity_CreateTaxEntity(
p_szTaxId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szTaxNo BOS_DT_szTaxId,
p_szPKPNo BOS_DT_szTaxId,
p_dtmNPWPDate timestamp,
p_TaxszContactPerson BOS_DT_szName,
p_TaxszRoomNo BOS_DT_szSmallName,
p_TaxszFloor BOS_DT_szSmallName,
p_TaxszBuilding BOS_DT_szName,
p_TaxszAddress_1 BOS_DT_szName,
p_TaxszAddress_2 BOS_DT_szName,
p_TaxszDistrict BOS_DT_szName,
p_TaxszCity BOS_DT_szMediumName,
p_TaxszZipCode BOS_DT_szSmallName,
p_TaxszState BOS_DT_szMediumName,
p_TaxszCountry BOS_DT_szMediumName,
p_TaxszPhoneNo_1 BOS_DT_szMediumName,
p_TaxszPhoneNo_2 BOS_DT_szMediumName,
p_TaxszFaxNo BOS_DT_szMediumName,
p_TaxszMobileNo BOS_DT_szMediumName,
p_TaxszEmail BOS_DT_szMediumName,
p_TaxszWebSite BOS_DT_szMediumName,
p_CPszContactPerson BOS_DT_szName,
p_CPszRoomNo BOS_DT_szSmallName,
p_CPszFloor BOS_DT_szSmallName,
p_CPszBuilding BOS_DT_szName,
p_CPszAddress_1 BOS_DT_szName,
p_CPszAddress_2 BOS_DT_szName,
p_CPszDistrict BOS_DT_szName,
p_CPszCity BOS_DT_szMediumName,
p_CPszZipCode BOS_DT_szSmallName,
p_CPszState BOS_DT_szMediumName,
p_CPszCountry BOS_DT_szMediumName,
p_CPszPhoneNo_1 BOS_DT_szMediumName,
p_CPszPhoneNo_2 BOS_DT_szMediumName,
p_CPszFaxNo BOS_DT_szMediumName,
p_CPszMobileNo BOS_DT_szMediumName,
p_CPszEmail BOS_DT_szMediumName,
p_CPszWebSite BOS_DT_szMediumName,
p_TOszContactPerson BOS_DT_szName,
p_TOszRoomNo BOS_DT_szSmallName,
p_TOszFloor BOS_DT_szSmallName,
p_TOszBuilding BOS_DT_szName,
p_TOszAddress_1 BOS_DT_szName,
p_TOszAddress_2 BOS_DT_szName,
p_TOszDistrict BOS_DT_szName,
p_TOszCity BOS_DT_szMediumName,
p_TOszZipCode BOS_DT_szSmallName,
p_TOszState BOS_DT_szMediumName,
p_TOszCountry BOS_DT_szMediumName,
p_TOszPhoneNo_1 BOS_DT_szMediumName,
p_TOszPhoneNo_2 BOS_DT_szMediumName,
p_TOszFaxNo BOS_DT_szMediumName,
p_TOszMobileNo BOS_DT_szMediumName,
p_TOszEmail BOS_DT_szMediumName,
p_TOszWebSite BOS_DT_szMediumName,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GL_TaxEntity
(
szTaxId,
szName,
szTaxNo,
szPKPNo,
dtmNPWPDate,
TaxszContactPerson,
TaxszRoomNo,
TaxszFloor,
TaxszBuilding,
TaxszAddress_1,
TaxszAddress_2,
TaxszDistrict,
TaxszCity,
TaxszZipCode,
TaxszState,
TaxszCountry,
TaxszPhoneNo_1,
TaxszPhoneNo_2,
TaxszFaxNo,
TaxszMobileNo,
TaxszEmail,
TaxszWebSite,
CPszContactPerson,
CPszRoomNo,
CPszFloor,
CPszBuilding,
CPszAddress_1,
CPszAddress_2,
CPszDistrict,
CPszCity,
CPszZipCode,
CPszState,
CPszCountry,
CPszPhoneNo_1,
CPszPhoneNo_2,
CPszFaxNo,
CPszMobileNo,
CPszEmail,
CPszWebSite,
TOszContactPerson,
TOszRoomNo,
TOszFloor,
TOszBuilding,
TOszAddress_1,
TOszAddress_2,
TOszDistrict,
TOszCity,
TOszZipCode,
TOszState,
TOszCountry,
TOszPhoneNo_1,
TOszPhoneNo_2,
TOszFaxNo,
TOszMobileNo,
TOszEmail,
TOszWebSite,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szTaxId,
p_szName,
p_szTaxNo,
p_szPKPNo,
p_dtmNPWPDate,
p_TaxszContactPerson,
p_TaxszRoomNo,
p_TaxszFloor,
p_TaxszBuilding,
p_TaxszAddress_1,
p_TaxszAddress_2,
p_TaxszDistrict,
p_TaxszCity,
p_TaxszZipCode,
p_TaxszState,
p_TaxszCountry,
p_TaxszPhoneNo_1,
p_TaxszPhoneNo_2,
p_TaxszFaxNo,
p_TaxszMobileNo,
p_TaxszEmail,
p_TaxszWebSite,
p_CPszContactPerson,
p_CPszRoomNo,
p_CPszFloor,
p_CPszBuilding,
p_CPszAddress_1,
p_CPszAddress_2,
p_CPszDistrict,
p_CPszCity,
p_CPszZipCode,
p_CPszState,
p_CPszCountry,
p_CPszPhoneNo_1,
p_CPszPhoneNo_2,
p_CPszFaxNo,
p_CPszMobileNo,
p_CPszEmail,
p_CPszWebSite,
p_TOszContactPerson,
p_TOszRoomNo,
p_TOszFloor,
p_TOszBuilding,
p_TOszAddress_1,
p_TOszAddress_2,
p_TOszDistrict,
p_TOszCity,
p_TOszZipCode,
p_TOszState,
p_TOszCountry,
p_TOszPhoneNo_1,
p_TOszPhoneNo_2,
p_TOszFaxNo,
p_TOszMobileNo,
p_TOszEmail,
p_TOszWebSite,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_TaxEntity_DeleteTaxEntity(
p_szTaxId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_GL_TaxEntity
WHERE
szTaxId = p_szTaxId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_TaxEntity_GetListOfTaxEntity()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szTaxId,
szName

FROM 
BOS_GL_TaxEntity

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_TaxEntity_GetTaxEntity(
p_szTaxId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szTaxId,
szName,
szTaxNo,
szPKPNo,
dtmNPWPDate,
TaxszContactPerson,
TaxszRoomNo,
TaxszFloor,
TaxszBuilding,
TaxszAddress_1,
TaxszAddress_2,
TaxszDistrict,
TaxszCity,
TaxszZipCode,
TaxszState,
TaxszCountry,
TaxszPhoneNo_1,
TaxszPhoneNo_2,
TaxszFaxNo,
TaxszMobileNo,
TaxszEmail,
TaxszWebSite,
CPszContactPerson,
CPszRoomNo,
CPszFloor,
CPszBuilding,
CPszAddress_1,
CPszAddress_2,
CPszDistrict,
CPszCity,
CPszZipCode,
CPszState,
CPszCountry,
CPszPhoneNo_1,
CPszPhoneNo_2,
CPszFaxNo,
CPszMobileNo,
CPszEmail,
CPszWebSite,
TOszContactPerson,
TOszRoomNo,
TOszFloor,
TOszBuilding,
TOszAddress_1,
TOszAddress_2,
TOszDistrict,
TOszCity,
TOszZipCode,
TOszState,
TOszCountry,
TOszPhoneNo_1,
TOszPhoneNo_2,
TOszFaxNo,
TOszMobileNo,
TOszEmail,
TOszWebSite,
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_GL_TaxEntity
WHERE 
szTaxId = p_szTaxId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_TaxEntity_IsTaxEntityExist(
p_szTaxId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szTaxId

FROM 
BOS_GL_TaxEntity
WHERE 
szTaxId = p_szTaxId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_TaxEntity_LockTaxEntity(
p_szTaxId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GL_TaxEntity
SET 
TaxszWebSite = TaxszWebSite
WHERE 
szTaxId = p_szTaxId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_TaxEntity_UpdateTaxEntity(
p_szTaxId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szTaxNo BOS_DT_szTaxId,
p_szPKPNo BOS_DT_szTaxId,
p_dtmNPWPDate timestamp,
p_TaxszContactPerson BOS_DT_szName,
p_TaxszRoomNo BOS_DT_szSmallName,
p_TaxszFloor BOS_DT_szSmallName,
p_TaxszBuilding BOS_DT_szName,
p_TaxszAddress_1 BOS_DT_szName,
p_TaxszAddress_2 BOS_DT_szName,
p_TaxszDistrict BOS_DT_szName,
p_TaxszCity BOS_DT_szMediumName,
p_TaxszZipCode BOS_DT_szSmallName,
p_TaxszState BOS_DT_szMediumName,
p_TaxszCountry BOS_DT_szMediumName,
p_TaxszPhoneNo_1 BOS_DT_szMediumName,
p_TaxszPhoneNo_2 BOS_DT_szMediumName,
p_TaxszFaxNo BOS_DT_szMediumName,
p_TaxszMobileNo BOS_DT_szMediumName,
p_TaxszEmail BOS_DT_szMediumName,
p_TaxszWebSite BOS_DT_szMediumName,
p_CPszContactPerson BOS_DT_szName,
p_CPszRoomNo BOS_DT_szSmallName,
p_CPszFloor BOS_DT_szSmallName,
p_CPszBuilding BOS_DT_szName,
p_CPszAddress_1 BOS_DT_szName,
p_CPszAddress_2 BOS_DT_szName,
p_CPszDistrict BOS_DT_szName,
p_CPszCity BOS_DT_szMediumName,
p_CPszZipCode BOS_DT_szSmallName,
p_CPszState BOS_DT_szMediumName,
p_CPszCountry BOS_DT_szMediumName,
p_CPszPhoneNo_1 BOS_DT_szMediumName,
p_CPszPhoneNo_2 BOS_DT_szMediumName,
p_CPszFaxNo BOS_DT_szMediumName,
p_CPszMobileNo BOS_DT_szMediumName,
p_CPszEmail BOS_DT_szMediumName,
p_CPszWebSite BOS_DT_szMediumName,
p_TOszContactPerson BOS_DT_szName,
p_TOszRoomNo BOS_DT_szSmallName,
p_TOszFloor BOS_DT_szSmallName,
p_TOszBuilding BOS_DT_szName,
p_TOszAddress_1 BOS_DT_szName,
p_TOszAddress_2 BOS_DT_szName,
p_TOszDistrict BOS_DT_szName,
p_TOszCity BOS_DT_szMediumName,
p_TOszZipCode BOS_DT_szSmallName,
p_TOszState BOS_DT_szMediumName,
p_TOszCountry BOS_DT_szMediumName,
p_TOszPhoneNo_1 BOS_DT_szMediumName,
p_TOszPhoneNo_2 BOS_DT_szMediumName,
p_TOszFaxNo BOS_DT_szMediumName,
p_TOszMobileNo BOS_DT_szMediumName,
p_TOszEmail BOS_DT_szMediumName,
p_TOszWebSite BOS_DT_szMediumName)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GL_TaxEntity
SET 
szName = p_szName,
szTaxNo = p_szTaxNo,
szPKPNo = p_szPKPNo,
dtmNPWPDate = p_dtmNPWPDate,
TaxszContactPerson = p_TaxszContactPerson,
TaxszRoomNo = p_TaxszRoomNo,
TaxszFloor = p_TaxszFloor,
TaxszBuilding = p_TaxszBuilding,
TaxszAddress_1 = p_TaxszAddress_1,
TaxszAddress_2 = p_TaxszAddress_2,
TaxszDistrict = p_TaxszDistrict,
TaxszCity = p_TaxszCity,
TaxszZipCode = p_TaxszZipCode,
TaxszState = p_TaxszState,
TaxszCountry = p_TaxszCountry,
TaxszPhoneNo_1 = p_TaxszPhoneNo_1,
TaxszPhoneNo_2 = p_TaxszPhoneNo_2,
TaxszFaxNo = p_TaxszFaxNo,
TaxszMobileNo = p_TaxszMobileNo,
TaxszEmail = p_TaxszEmail,
TaxszWebSite = p_TaxszWebSite,
CPszContactPerson = p_CPszContactPerson,
CPszRoomNo = p_CPszRoomNo,
CPszFloor = p_CPszFloor,
CPszBuilding = p_CPszBuilding,
CPszAddress_1 = p_CPszAddress_1,
CPszAddress_2 = p_CPszAddress_2,
CPszDistrict = p_CPszDistrict,
CPszCity = p_CPszCity,
CPszZipCode = p_CPszZipCode,
CPszState = p_CPszState,
CPszCountry = p_CPszCountry,
CPszPhoneNo_1 = p_CPszPhoneNo_1,
CPszPhoneNo_2 = p_CPszPhoneNo_2,
CPszFaxNo = p_CPszFaxNo,
CPszMobileNo = p_CPszMobileNo,
CPszEmail = p_CPszEmail,
CPszWebSite = p_CPszWebSite,
TOszContactPerson = p_TOszContactPerson,
TOszRoomNo = p_TOszRoomNo,
TOszFloor = p_TOszFloor,
TOszBuilding = p_TOszBuilding,
TOszAddress_1 = p_TOszAddress_1,
TOszAddress_2 = p_TOszAddress_2,
TOszDistrict = p_TOszDistrict,
TOszCity = p_TOszCity,
TOszZipCode = p_TOszZipCode,
TOszState = p_TOszState,
TOszCountry = p_TOszCountry,
TOszPhoneNo_1 = p_TOszPhoneNo_1,
TOszPhoneNo_2 = p_TOszPhoneNo_2,
TOszFaxNo = p_TOszFaxNo,
TOszMobileNo = p_TOszMobileNo,
TOszEmail = p_TOszEmail,
TOszWebSite = p_TOszWebSite
WHERE 
szTaxId = p_szTaxId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_TaxType_CreateTaxType(
p_szTaxTypeId varchar,
p_szName BOS_DT_szName,
p_decRate BOS_DT_decAmount,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GL_TaxType
(
szTaxTypeId,
szName,
decRate,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szTaxTypeId,
p_szName,
p_decRate,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_TaxType_CreateTaxType_014(
p_szTaxTypeId varchar,
p_szName BOS_DT_szName,
p_decRate BOS_DT_decAmount,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GL_TaxType
(
szTaxTypeId,
szName,
decRate,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szTaxTypeId,
p_szName,
p_decRate,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_TaxType_DeleteTaxType(
p_szTaxTypeId varchar)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_GL_TaxType
WHERE
szTaxTypeId=p_szTaxTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_TaxType_GetListOfTaxType()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szTaxTypeId,
szName

FROM 
BOS_GL_TaxType

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_TaxType_GetTaxType(
p_szTaxTypeId varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szName,
decRate,
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_GL_TaxType
WHERE 
szTaxTypeId=p_szTaxTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_TaxType_GetTaxType_014(
p_szTaxTypeId varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szName,
decRate,
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_GL_TaxType
WHERE 
szTaxTypeId=p_szTaxTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_TaxType_IsTaxTypeExist(
p_szTaxTypeId varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szTaxTypeId

FROM 
BOS_GL_TaxType
WHERE 
szTaxTypeId=p_szTaxTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_TaxType_LockTaxType(
p_szTaxTypeId varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GL_TaxType
SET 
decRate=decRate
WHERE 
szTaxTypeId=p_szTaxTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_TaxType_UpdateTaxType(
p_szTaxTypeId varchar,
p_szName BOS_DT_szName,
p_decRate BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GL_TaxType
SET 
szName=p_szName,
decRate=p_decRate
WHERE 
szTaxTypeId=p_szTaxTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Workplace_CreateWorkplace(
p_szWorkplaceId BOS_DT_szId,
p_szWorkplaceTypeId varchar,
p_szName BOS_DT_szName,
p_WpszContactPerson BOS_DT_szName,
p_WpszRoomNo BOS_DT_szSmallName,
p_WpszFloor BOS_DT_szSmallName,
p_WpszBuilding BOS_DT_szName,
p_WpszAddress_1 BOS_DT_szName,
p_WpszAddress_2 BOS_DT_szName,
p_WpszDistrict BOS_DT_szMediumName,
p_WpszCity BOS_DT_szMediumName,
p_WpszZipCode BOS_DT_szSmallName,
p_WpszState BOS_DT_szMediumName,
p_WpszCountry BOS_DT_szMediumName,
p_WpszPhoneNo_1 BOS_DT_szMediumName,
p_WpszPhoneNo_2 BOS_DT_szMediumName,
p_WpszFaxNo BOS_DT_szMediumName,
p_WpszMobileNo BOS_DT_szMediumName,
p_WpszEmail BOS_DT_szMediumName,
p_WpszWebSite BOS_DT_szMediumName,
p_szCompanyId BOS_DT_szMediumId,
p_szTaxId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szCalenderId BOS_DT_szId,
p_szChiefOfWorkplace varchar,
p_szPaymentBankId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_szInvOrgId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GL_Workplace
(
szWorkplaceId,
szWorkplaceTypeId,
szName,
WpszContactPerson,
WpszRoomNo,
WpszFloor,
WpszBuilding,
WpszAddress_1,
WpszAddress_2,
WpszDistrict,
WpszCity,
WpszZipCode,
WpszState,
WpszCountry,
WpszPhoneNo_1,
WpszPhoneNo_2,
WpszFaxNo,
WpszMobileNo,
WpszEmail,
WpszWebSite,
szCompanyId,
szTaxId,
szSalesOrgId,
szCalenderId,
szChiefOfWorkplace,
szPaymentBankId,
szPriceId,
szPriceOrderId,
szPromoPriceId,
szPromoPriceOrderId,
szInvOrgId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szWorkplaceId,
p_szWorkplaceTypeId,
p_szName,
p_WpszContactPerson,
p_WpszRoomNo,
p_WpszFloor,
p_WpszBuilding,
p_WpszAddress_1,
p_WpszAddress_2,
p_WpszDistrict,
p_WpszCity,
p_WpszZipCode,
p_WpszState,
p_WpszCountry,
p_WpszPhoneNo_1,
p_WpszPhoneNo_2,
p_WpszFaxNo,
p_WpszMobileNo,
p_WpszEmail,
p_WpszWebSite,
p_szCompanyId,
p_szTaxId,
p_szSalesOrgId,
p_szCalenderId,
p_szChiefOfWorkplace,
p_szPaymentBankId,
p_szPriceId,
p_szPriceOrderId,
p_szPromoPriceId,
p_szPromoPriceOrderId,
p_szInvOrgId,
p_dtmLastUpdated,
p_bAlreadyTransferred,
SET ANSI_NULLS ON,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Workplace_CreateWorkplace_013(
p_szWorkplaceId BOS_DT_szId,
p_szWorkplaceTypeId varchar,
p_szName BOS_DT_szName,
p_WpszContactPerson BOS_DT_szName,
p_WpszRoomNo BOS_DT_szSmallName,
p_WpszFloor BOS_DT_szSmallName,
p_WpszBuilding BOS_DT_szName,
p_WpszAddress_1 BOS_DT_szName,
p_WpszAddress_2 BOS_DT_szName,
p_WpszDistrict BOS_DT_szName,
p_WpszCity BOS_DT_szMediumName,
p_WpszZipCode BOS_DT_szSmallName,
p_WpszState BOS_DT_szMediumName,
p_WpszCountry BOS_DT_szMediumName,
p_WpszPhoneNo_1 BOS_DT_szMediumName,
p_WpszPhoneNo_2 BOS_DT_szMediumName,
p_WpszFaxNo BOS_DT_szMediumName,
p_WpszMobileNo BOS_DT_szMediumName,
p_WpszEmail BOS_DT_szMediumName,
p_WpszWebSite BOS_DT_szMediumName,
p_szCompanyId BOS_DT_szMediumId,
p_szTaxId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szCalenderId BOS_DT_szId,
p_szChiefOfWorkplace varchar,
p_szPaymentBankId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_szInvOrgId BOS_DT_szId,
p_bActive BOS_DT_bBoolean,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_GL_Workplace
(
szWorkplaceId,
szWorkplaceTypeId,
szName,
WpszContactPerson,
WpszRoomNo,
WpszFloor,
WpszBuilding,
WpszAddress_1,
WpszAddress_2,
WpszDistrict,
WpszCity,
WpszZipCode,
WpszState,
WpszCountry,
WpszPhoneNo_1,
WpszPhoneNo_2,
WpszFaxNo,
WpszMobileNo,
WpszEmail,
WpszWebSite,
szCompanyId,
szTaxId,
szSalesOrgId,
szCalenderId,
szChiefOfWorkplace,
szPaymentBankId,
szPriceId,
szPriceOrderId,
szPromoPriceId,
szPromoPriceOrderId,
szInvOrgId,
dtmLastUpdated,
bAlreadyTransferred,
bActive
)
VALUES
(
p_szWorkplaceId,
p_szWorkplaceTypeId,
p_szName,
p_WpszContactPerson,
p_WpszRoomNo,
p_WpszFloor,
p_WpszBuilding,
p_WpszAddress_1,
p_WpszAddress_2,
p_WpszDistrict,
p_WpszCity,
p_WpszZipCode,
p_WpszState,
p_WpszCountry,
p_WpszPhoneNo_1,
p_WpszPhoneNo_2,
p_WpszFaxNo,
p_WpszMobileNo,
p_WpszEmail,
p_WpszWebSite,
p_szCompanyId,
p_szTaxId,
p_szSalesOrgId,
p_szCalenderId,
p_szChiefOfWorkplace,
p_szPaymentBankId,
p_szPriceId,
p_szPriceOrderId,
p_szPromoPriceId,
p_szPromoPriceOrderId,
p_szInvOrgId,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_bActive,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Workplace_DeleteWorkplace(
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_GL_Workplace
WHERE
szWorkplaceId = p_szWorkplaceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Workplace_GetListOfWorkplace()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szWorkplaceId,
szName

FROM 
BOS_GL_Workplace
ORDER BY
--In un-read-committed mode order of result is un-predictable.
--As list of workplaces is most loaded list, it is a good idea to
--define its order.
szWorkplaceId
ORDER BY 
--In un-read-committed mode order of result is un-predictable.

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Workplace_GetWorkplace(
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

select
Wo.szWorkplaceId,
Wo.szWorkplaceTypeId,
Wo.szName,
Wo.WpszContactPerson,
Wo.WpszRoomNo,
Wo.WpszFloor,
Wo.WpszBuilding,
Wo.WpszAddress_1,
Wo.WpszAddress_2,
Wo.WpszDistrict,
Wo.WpszCity,
Wo.WpszZipCode,
Wo.WpszState,
Wo.WpszCountry,
Wo.WpszPhoneNo_1,
Wo.WpszPhoneNo_2,
Wo.WpszFaxNo,
Wo.WpszMobileNo,
Wo.WpszEmail,
Wo.WpszWebSite,

Wo.szCompanyId,
Co.szName AS szCompanyNm_J,
Co.szLedgerId AS szCompanyLedgerId_J,
Le.szCcyId AS szCompanyLedgerCcyId_J,
Cu.szAmountFormat AS szCompanyLedgerCcyAmountFormat_J,
Co.szCcyRateId AS szCompanyCcyRateId_J,

Wo.szTaxId,

Wo.szSalesOrgId,
SO.szParentSalesOrgId AS szSalesOrgId_2_J,

Wo.szCalenderId,
Wo.szChiefOfWorkplace,
Wo.szPaymentBankId,
Wo.szPriceId,
Wo.szPriceOrderId,
Wo.szPromoPriceId,
Wo.szPromoPriceOrderId,

Wo.szInvOrgId,
IO.szCostingMethod AS szInvOrgCostingMethod_J,
IO.bDisableLotTracking AS bInvOrgDisableLotTracking_J,
IO.bDisableSnTracking AS bInvOrgDisableSnTracking_J,

Wo.dtmLastUpdated,
Wo.bAlreadyTransferred
from
BOS_GL_Workplace AS Wo
LEFT JOIN BOS_GL_Company AS Co ON Co.szCompanyId = Wo.szCompanyId
LEFT JOIN BOS_GL_Ledger AS Le ON Le.szLedgerId = Co.szLedgerId
LEFT JOIN BOS_CU_Currency AS Cu ON Cu.szCcyId = Le.szCcyId
LEFT JOIN BOS_INV_InvOrg AS IO ON IO.szInvOrgId = Wo.szInvOrgId
LEFT JOIN BOS_SD_SalesOrganization AS SO ON SO.szSalesOrgId = Wo.szSalesOrgId
where
Wo.szWorkplaceId = p_szWorkplaceId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Workplace_GetWorkplace_013(
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

select
Wo.szWorkplaceId,
Wo.szWorkplaceTypeId,
Wo.szName,
Wo.WpszContactPerson,
Wo.WpszRoomNo,
Wo.WpszFloor,
Wo.WpszBuilding,
Wo.WpszAddress_1,
Wo.WpszAddress_2,
Wo.WpszDistrict,
Wo.WpszCity,
Wo.WpszZipCode,
Wo.WpszState,
Wo.WpszCountry,
Wo.WpszPhoneNo_1,
Wo.WpszPhoneNo_2,
Wo.WpszFaxNo,
Wo.WpszMobileNo,
Wo.WpszEmail,
Wo.WpszWebSite,

Wo.szCompanyId,
Co.szName AS szCompanyNm_J,
Co.szLedgerId AS szCompanyLedgerId_J,
Le.szCcyId AS szCompanyLedgerCcyId_J,
Cu.szAmountFormat AS szCompanyLedgerCcyAmountFormat_J,
Co.szCcyRateId AS szCompanyCcyRateId_J,

Wo.szTaxId,

Wo.szSalesOrgId,
SO.szParentSalesOrgId AS szSalesOrgId_2_J,

Wo.szCalenderId,
Wo.szChiefOfWorkplace,
Wo.szPaymentBankId,
Wo.szPriceId,
Wo.szPriceOrderId,
Wo.szPromoPriceId,
Wo.szPromoPriceOrderId,

Wo.szInvOrgId,
IO.szCostingMethod AS szInvOrgCostingMethod_J,
IO.bDisableLotTracking AS bInvOrgDisableLotTracking_J,
IO.bDisableSnTracking AS bInvOrgDisableSnTracking_J,

Wo.dtmLastUpdated,
Wo.bAlreadyTransferred,
Wo.bActive
from
BOS_GL_Workplace AS Wo
LEFT JOIN BOS_GL_Company AS Co ON Co.szCompanyId = Wo.szCompanyId
LEFT JOIN BOS_GL_Ledger AS Le ON Le.szLedgerId = Co.szLedgerId
LEFT JOIN BOS_CU_Currency AS Cu ON Cu.szCcyId = Le.szCcyId
LEFT JOIN BOS_INV_InvOrg AS IO ON IO.szInvOrgId = Wo.szInvOrgId
LEFT JOIN BOS_SD_SalesOrganization AS SO ON SO.szSalesOrgId = Wo.szSalesOrgId
where
Wo.szWorkplaceId = p_szWorkplaceId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Workplace_IsWorkplaceExist(
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szWorkplaceId

FROM 
BOS_GL_Workplace
WHERE 
szWorkplaceId = p_szWorkplaceId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Workplace_LockWorkplace(
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GL_Workplace
SET 
szTaxId = szTaxId
WHERE 
szWorkplaceId = p_szWorkplaceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Workplace_UpdateWorkplace(
p_szWorkplaceId BOS_DT_szId,
p_szWorkplaceTypeId varchar,
p_szName BOS_DT_szName,
p_WpszContactPerson BOS_DT_szName,
p_WpszRoomNo BOS_DT_szSmallName,
p_WpszFloor BOS_DT_szSmallName,
p_WpszBuilding BOS_DT_szName,
p_WpszAddress_1 BOS_DT_szName,
p_WpszAddress_2 BOS_DT_szName,
p_WpszDistrict BOS_DT_szMediumName,
p_WpszCity BOS_DT_szMediumName,
p_WpszZipCode BOS_DT_szSmallName,
p_WpszState BOS_DT_szMediumName,
p_WpszCountry BOS_DT_szMediumName,
p_WpszPhoneNo_1 BOS_DT_szMediumName,
p_WpszPhoneNo_2 BOS_DT_szMediumName,
p_WpszFaxNo BOS_DT_szMediumName,
p_WpszMobileNo BOS_DT_szMediumName,
p_WpszEmail BOS_DT_szMediumName,
p_WpszWebSite BOS_DT_szMediumName,
p_szCompanyId BOS_DT_szMediumId,
p_szTaxId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szCalenderId BOS_DT_szId,
p_szChiefOfWorkplace varchar,
p_szPaymentBankId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_szInvOrgId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GL_Workplace
SET 
szWorkplaceTypeId = p_szWorkplaceTypeId,
szName = p_szName,
WpszContactPerson = p_WpszContactPerson,
WpszRoomNo = p_WpszRoomNo,
WpszFloor = p_WpszFloor,
WpszBuilding = p_WpszBuilding,
WpszAddress_1 = p_WpszAddress_1,
WpszAddress_2 = p_WpszAddress_2,
WpszDistrict = p_WpszDistrict,
WpszCity = p_WpszCity,
WpszZipCode = p_WpszZipCode,
WpszState = p_WpszState,
WpszCountry = p_WpszCountry,
WpszPhoneNo_1 = p_WpszPhoneNo_1,
WpszPhoneNo_2 = p_WpszPhoneNo_2,
WpszFaxNo = p_WpszFaxNo,
WpszMobileNo = p_WpszMobileNo,
WpszEmail = p_WpszEmail,
WpszWebSite = p_WpszWebSite,
szCompanyId = p_szCompanyId,
szTaxId = p_szTaxId,
szSalesOrgId = p_szSalesOrgId,
szCalenderId=p_szCalenderId,
szChiefOfWorkplace = p_szChiefOfWorkplace,
szPaymentBankId = p_szPaymentBankId,
szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
szPromoPriceId = p_szPromoPriceId,
szPromoPriceOrderId = p_szPromoPriceOrderId,
szInvOrgId = p_szInvOrgId
WHERE 
szWorkplaceId = p_szWorkplaceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_GL_Workplace_UpdateWorkplace_013(
p_szWorkplaceId BOS_DT_szId,
p_szWorkplaceTypeId varchar,
p_szName BOS_DT_szName,
p_WpszContactPerson BOS_DT_szName,
p_WpszRoomNo BOS_DT_szSmallName,
p_WpszFloor BOS_DT_szSmallName,
p_WpszBuilding BOS_DT_szName,
p_WpszAddress_1 BOS_DT_szName,
p_WpszAddress_2 BOS_DT_szName,
p_WpszDistrict BOS_DT_szName,
p_WpszCity BOS_DT_szMediumName,
p_WpszZipCode BOS_DT_szSmallName,
p_WpszState BOS_DT_szMediumName,
p_WpszCountry BOS_DT_szMediumName,
p_WpszPhoneNo_1 BOS_DT_szMediumName,
p_WpszPhoneNo_2 BOS_DT_szMediumName,
p_WpszFaxNo BOS_DT_szMediumName,
p_WpszMobileNo BOS_DT_szMediumName,
p_WpszEmail BOS_DT_szMediumName,
p_WpszWebSite BOS_DT_szMediumName,
p_szCompanyId BOS_DT_szMediumId,
p_szTaxId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szCalenderId BOS_DT_szId,
p_szChiefOfWorkplace varchar,
p_szPaymentBankId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_szInvOrgId BOS_DT_szId,
p_bActive BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_GL_Workplace
SET 
szWorkplaceTypeId = p_szWorkplaceTypeId,
szName = p_szName,
WpszContactPerson = p_WpszContactPerson,
WpszRoomNo = p_WpszRoomNo,
WpszFloor = p_WpszFloor,
WpszBuilding = p_WpszBuilding,
WpszAddress_1 = p_WpszAddress_1,
WpszAddress_2 = p_WpszAddress_2,
WpszDistrict = p_WpszDistrict,
WpszCity = p_WpszCity,
WpszZipCode = p_WpszZipCode,
WpszState = p_WpszState,
WpszCountry = p_WpszCountry,
WpszPhoneNo_1 = p_WpszPhoneNo_1,
WpszPhoneNo_2 = p_WpszPhoneNo_2,
WpszFaxNo = p_WpszFaxNo,
WpszMobileNo = p_WpszMobileNo,
WpszEmail = p_WpszEmail,
WpszWebSite = p_WpszWebSite,
szCompanyId = p_szCompanyId,
szTaxId = p_szTaxId,
szSalesOrgId = p_szSalesOrgId,
szCalenderId=p_szCalenderId,
szChiefOfWorkplace = p_szChiefOfWorkplace,
szPaymentBankId = p_szPaymentBankId,
szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
szPromoPriceId = p_szPromoPriceId,
szPromoPriceOrderId = p_szPromoPriceOrderId,
szInvOrgId = p_szInvOrgId,
bActive = p_bActive
WHERE 
szWorkplaceId = p_szWorkplaceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Carrier_CreateCarrier(
p_szCarrierId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szContactPerson BOS_DT_szName,
p_szRoomNo BOS_DT_szSmallName,
p_szFloor BOS_DT_szSmallName,
p_szBuilding BOS_DT_szName,
p_szAddress_1 BOS_DT_szName,
p_szAddress_2 BOS_DT_szName,
p_szDistrict BOS_DT_szName,
p_szCity BOS_DT_szMediumName,
p_szZipCode BOS_DT_szSmallName,
p_szState BOS_DT_szMediumName,
p_szCountry BOS_DT_szMediumName,
p_szPhoneNo_1 BOS_DT_szMediumName,
p_szPhoneNo_2 BOS_DT_szMediumName,
p_szFaxNo BOS_DT_szMediumName,
p_szMobileNo BOS_DT_szMediumName,
p_szEmail BOS_DT_szMediumName,
p_szWebSite BOS_DT_szMediumName,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_Carrier
(
szCarrierId,
szName,
szContactPerson,
szRoomNo,
szFloor,
szBuilding,
szAddress_1,
szAddress_2,
szDistrict,
szCity,
szZipCode,
szState,
szCountry,
szPhoneNo_1,
szPhoneNo_2,
szFaxNo,
szMobileNo,
szEmail,
szWebSite,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCarrierId,
p_szName,
p_szContactPerson,
p_szRoomNo,
p_szFloor,
p_szBuilding,
p_szAddress_1,
p_szAddress_2,
p_szDistrict,
p_szCity,
p_szZipCode,
p_szState,
p_szCountry,
p_szPhoneNo_1,
p_szPhoneNo_2,
p_szFaxNo,
p_szMobileNo,
p_szEmail,
p_szWebSite,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Carrier_DeleteCarrier(
p_szCarrierId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_INV_Carrier
WHERE
szCarrierId = p_szCarrierId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Carrier_GetCarrier(
p_szCarrierId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCarrierId,
szName,
szContactPerson,
szRoomNo,
szFloor,
szBuilding,
szAddress_1,
szAddress_2,
szDistrict,
szCity,
szZipCode,
szState,
szCountry,
szPhoneNo_1,
szPhoneNo_2,
szFaxNo,
szMobileNo,
szEmail,
szWebSite,

dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_INV_Carrier
WHERE 
szCarrierId = p_szCarrierId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Carrier_GetListOfCarrier()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCarrierId,
szName,
szContactPerson,
szRoomNo,
szFloor,
szBuilding,
szAddress_1,
szAddress_2,
szDistrict,
szCity,
szZipCode,
szState,
szCountry,
szPhoneNo_1,
szPhoneNo_2,
szFaxNo,
szMobileNo,
szEmail,
szWebSite

FROM 
BOS_INV_Carrier

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Carrier_IsCarrierExist(
p_szCarrierId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCarrierId

FROM 
BOS_INV_Carrier
WHERE 
szCarrierId = p_szCarrierId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Carrier_LockCarrier(
p_szCarrierId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Carrier
SET 
szWebSite = szWebSite
WHERE 
szCarrierId = p_szCarrierId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Carrier_UpdateCarrier(
p_szCarrierId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szContactPerson BOS_DT_szName,
p_szRoomNo BOS_DT_szSmallName,
p_szFloor BOS_DT_szSmallName,
p_szBuilding BOS_DT_szName,
p_szAddress_1 BOS_DT_szName,
p_szAddress_2 BOS_DT_szName,
p_szDistrict BOS_DT_szName,
p_szCity BOS_DT_szMediumName,
p_szZipCode BOS_DT_szSmallName,
p_szState BOS_DT_szMediumName,
p_szCountry BOS_DT_szMediumName,
p_szPhoneNo_1 BOS_DT_szMediumName,
p_szPhoneNo_2 BOS_DT_szMediumName,
p_szFaxNo BOS_DT_szMediumName,
p_szMobileNo BOS_DT_szMediumName,
p_szEmail BOS_DT_szMediumName,
p_szWebSite BOS_DT_szMediumName,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Carrier
SET 
szName = p_szName,
szContactPerson = p_szContactPerson,
szRoomNo = p_szRoomNo,
szFloor = p_szFloor,
szBuilding = p_szBuilding,
szAddress_1 = p_szAddress_1,
szAddress_2 = p_szAddress_2,
szDistrict = p_szDistrict,
szCity = p_szCity,
szZipCode = p_szZipCode,
szState = p_szState,
szCountry = p_szCountry,
szPhoneNo_1 = p_szPhoneNo_1,
szPhoneNo_2 = p_szPhoneNo_2,
szFaxNo = p_szFaxNo,
szMobileNo = p_szMobileNo,
szEmail = p_szEmail,
szWebSite = p_szWebSite,

dtmLastUpdated = p_dtmLastUpdated,
bAlreadyTransferred = p_bAlreadyTransferred
WHERE 
szCarrierId = p_szCarrierId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ConditionType_GetListOfConditionType()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szConditionTypeId, szDescription 

FROM 
 BOS_INV_ConditionType 

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_CreateFAdjustment(
p_szFAdjustmentId BOS_DT_szId,
p_dtmAdjustment timestamp,
p_szReffTrnType BOS_DT_szMediumId,
p_szReffTrnId BOS_DT_szId,
p_szReffTrnNewId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FAdjustment
(
szFAdjustmentId,
dtmAdjustment,
szReffTrnType,
szReffTrnId,
szReffTrnNewId,
szDescription,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFAdjustmentId,
p_dtmAdjustment,
p_szReffTrnType,
p_szReffTrnId,
p_szReffTrnNewId,
p_szDescription,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_CreateFAdjustmentItem(
p_szFAdjustmentId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FAdjustmentItem
(
szFAdjustmentId,
shItemNumber,
szProductId,
decQty,
szUomId,
szParentId
)
VALUES
(
p_szFAdjustmentId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_szParentId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_CreateFAdjustmentItem_014(
p_szFAdjustmentId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FAdjustmentItem
(
szFAdjustmentId,
shItemNumber,
szProductId,
decQty,
szUomId,
szParentId
)
VALUES
(
p_szFAdjustmentId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_szParentId,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_CreateFAdjustmentItemLot(
p_szFAdjustmentId BOS_DT_szId,
p_shItemNumber smallint,
p_szLotId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FAdjustmentItemLot
(
szFAdjustmentId,
shItemNumber,
szLotId
decQty,
)
VALUES
(
p_szFAdjustmentId,
p_shItemNumber,
p_szLotId
p_decQty,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_CreateFAdjustmentItemSn(
p_szFAdjustmentId BOS_DT_szId,
p_shItemNumber smallint,
p_shItem2Number smallint,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FAdjustmentItemSn
(
szFAdjustmentId,
shItemNumber,
shItem2Number,
szProductSn
)
VALUES
(
p_szFAdjustmentId,
p_shItemNumber,
p_shItem2Number,
p_szProductSn
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_DeleteFAdjustment(
p_szFAdjustmentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_INV_FAdjustment
WHERE
szFAdjustmentId = p_szFAdjustmentId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_DeleteFAdjustmentItem(
p_szFAdjustmentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FAdjustmentItem
WHERE
szFAdjustmentId=p_szFAdjustmentId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_DeleteFAdjustmentItemLot(
p_szFAdjustmentId varchar)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_INV_FAdjustmentItemLot
WHERE
 szFAdjustmentId = p_szFAdjustmentId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_DeleteFAdjustmentItemSn(
p_szFAdjustmentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FAdjustmentItemSn
WHERE
szFAdjustmentId=p_szFAdjustmentId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_GetFAdjustment(
p_szFAdjustmentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

select
BOS_INV_FAdjustment.szFAdjustmentId,
BOS_INV_FAdjustment.dtmAdjustment,
BOS_INV_FAdjustment.szReffTrnType,
BOS_INV_FAdjustment.szReffTrnId,
BOS_INV_FAdjustment.szReffTrnNewId,
BOS_AP_Supplier.szName as szSupplierNm,
BOS_INV_FAdjustment.szDescription,
BOS_INV_FAdjustment.bResultFrTransfer,
BOS_INV_FAdjustment.bVoid,
BOS_GEN_Approved.bApproved,
BOS_INV_FAdjustment.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FAdjustment.btPrintedCount,
BOS_INV_FAdjustment.bTransferred,
BOS_INV_FAdjustment.szCompanyId, 
BOS_INV_FAdjustment.szWorkplaceId,
BOS_INV_FAdjustment.szTaxEntityId,
BOS_INV_FAdjustment.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FAdjustment.dtmCreated,
BOS_INV_FAdjustment.bSystemCreated,
BOS_INV_FAdjustment.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FAdjustment.dtmLastUpdated,
BOS_INV_FAdjustment.bAlreadyTransferred
from
(BOS_INV_FAdjustment left join BOS_GEN_Approved on BOS_INV_FAdjustment.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
left join BOS_GL_FJournalTrans on BOS_INV_FAdjustment.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
left join BOS_AP_Supplier on BOS_INV_FAdjustment.szReffTrnId = BOS_AP_Supplier.szSuppId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FAdjustment.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FAdjustment.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FAdjustment.szUserId

where
szFAdjustmentId = p_szFAdjustmentId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_GetFAdjustmentItem(
p_szFAdjustmentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_FAdjustmentItem.shItemNumber,
BOS_INV_FAdjustmentItem.szProductId,

BOS_INV_Product.szName AS szProductName_J,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,

BOS_INV_FAdjustmentItem.decQty,
BOS_INV_FAdjustmentItem.szUomId,
BOS_INV_FAdjustmentItem.szParentId,
BOS_INV_Product.szName AS szParentNm_J


FROM 
BOS_INV_FAdjustmentItem LEFT JOIN BOS_INV_Product ON BOS_INV_FAdjustmentItem.szProductId=BOS_INV_Product.szProductIdBOS_INV_FAdjustmentItem LEFT JOIN BOS_INV_Product ON BOS_INV_FAdjustmentItem.szProductId=BOS_INV_Product.szProductId;
WHERE 
BOS_INV_FAdjustmentItem.szFAdjustmentId = p_szFAdjustmentId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_GetFAdjustmentItem_014(
p_szFAdjustmentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_FAdjustmentItem.shItemNumber,
BOS_INV_FAdjustmentItem.szProductId,

BOS_INV_Product.szName AS szProductName_J,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,

BOS_INV_FAdjustmentItem.decQty,
BOS_INV_FAdjustmentItem.szUomId,
BOS_INV_FAdjustmentItem.szParentId,
BOS_INV_Product.szName AS szParentNm_J


FROM 
BOS_INV_FAdjustmentItem LEFT JOIN BOS_INV_Product ON BOS_INV_FAdjustmentItem.szProductId=BOS_INV_Product.szProductIdBOS_INV_FAdjustmentItem LEFT JOIN BOS_INV_Product ON BOS_INV_FAdjustmentItem.szProductId=BOS_INV_Product.szProductId;
WHERE 
BOS_INV_FAdjustmentItem.szFAdjustmentId = p_szFAdjustmentId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_GetFAdjustmentItemLot(
p_szFAdjustmentId varchar,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLotId,
decQty

FROM 
BOS_INV_FAdjustmentItemLot
WHERE 
 szFAdjustmentId = p_szFAdjustmentId And shItemNumber = p_shItemNumber;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_GetFAdjustmentItemSn(
p_szFAdjustmentId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItem2Number,
szProductSn


FROM 
BOS_INV_FAdjustmentItemSn
WHERE 
szFAdjustmentId = p_szFAdjustmentId AND shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_GetListOfFAdjustment()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFAdjustmentId,
dtmAdjustment

FROM 
BOS_INV_FAdjustment

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_IsFAdjustmentExist(
p_szFAdjustmentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFAdjustmentId

FROM 
BOS_INV_FAdjustment
WHERE 
szFAdjustmentId = p_szFAdjustmentId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_LockFAdjustment(
p_szFAdjustmentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FAdjustment
SET 
bTransferred = bTransferred
WHERE 
szFAdjustmentId = p_szFAdjustmentId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_UpdateFAdjustment(
p_szFAdjustmentId BOS_DT_szId,
p_dtmAdjustment timestamp,
p_szReffTrnType BOS_DT_szMediumId,
p_szReffTrnId BOS_DT_szId,
p_szReffTrnNewId BOS_DT_szId,
p_szDescription varchar,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FAdjustment
SET 
dtmAdjustment = p_dtmAdjustment,
szReffTrnType = p_szReffTrnType,
szReffTrnId = p_szReffTrnId,
szDescription = p_szDescription,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFAdjustmentId = p_szFAdjustmentId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FAdjustment_UpdateReffTrnNewId(
p_szFAdjustmentId BOS_DT_szId,
p_szReffTrnNewId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FAdjustment
SET 
szReffTrnNewId = p_szReffTrnNewId
WHERE 
szFAdjustmentId = p_szFAdjustmentId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FChgLotStatus_CreateFChgLotStatus(
p_szFChgStatusLotId BOS_DT_szId,
p_dtmFChgStatusLotId timestamp,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FChgLotStatus
(
szFChgStatusLotId,
dtmFChgStatusLotId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFChgStatusLotId,
p_dtmFChgStatusLotId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FChgLotStatus_CreateFChgLotStatusItem(
p_szFChgStatusLotId BOS_DT_szId,
p_szLotId BOS_DT_szId,
p_szCurrentStatus BOS_DT_szId,
p_szNewStatus BOS_DT_szId,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FChgLotStatusItem
(
szFChgStatusLotId,
szLotId,
szCurrentStatus,
szNewStatus,
szProductId
)
VALUES
(
p_szFChgStatusLotId,
p_szLotId,
p_szCurrentStatus,
p_szNewStatus,
p_szProductId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FChgLotStatus_DeleteFChgLotStatus(
p_szFChgStatusLotId varchar)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_INV_FChgLotStatus
WHERE
 szFChgStatusLotId = p_szFChgStatusLotId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FChgLotStatus_DeleteFChgLotStatusItem(
p_szFChgStatusLotId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_INV_FChgLotStatusItem
WHERE
 szFChgStatusLotId = p_szFChgStatusLotId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FChgLotStatus_GetFChgLotStatus(
p_szFChgStatusLotId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

select
BOS_INV_FChgLotStatus.szFChgStatusLotId,
BOS_INV_FChgLotStatus.dtmFChgStatusLotId,


BOS_INV_FChgLotStatus.bResultFrTransfer,
BOS_INV_FChgLotStatus.bVoid,

BOS_GEN_Approved.bApproved,
BOS_INV_FChgLotStatus.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FChgLotStatus.btPrintedCount,
BOS_INV_FChgLotStatus.bTransferred,
BOS_INV_FChgLotStatus.szCompanyId, 
BOS_INV_FChgLotStatus.szWorkplaceId,
BOS_INV_FChgLotStatus.szTaxEntityId,
BOS_INV_FChgLotStatus.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FChgLotStatus.dtmCreated,
BOS_INV_FChgLotStatus.bSystemCreated,
BOS_INV_FChgLotStatus.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FChgLotStatus.dtmLastUpdated,
BOS_INV_FChgLotStatus.bAlreadyTransferred
from
(BOS_INV_FChgLotStatus left join BOS_GEN_Approved on BOS_INV_FChgLotStatus.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
left join BOS_GL_FJournalTrans on BOS_INV_FChgLotStatus.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FChgLotStatus.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FChgLotStatus.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FChgLotStatus.szUserId

where
szFChgStatusLotId = p_szFChgStatusLotId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FChgLotStatus_GetFChgLotStatusItem(
p_szFChgStatusLotId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFChgStatusLotId,
szLotId,
szCurrentStatus,
szNewStatus,
szProductId

FROM 
BOS_INV_FChgLotStatusItem
WHERE 
szFChgStatusLotId = p_szFChgStatusLotId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FChgLotStatus_GetListOfFChgLotStatus()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFChgStatusLotId,
dtmFChgStatusLotId

FROM 
BOS_INV_FChgLotStatus

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FChgLotStatus_IsFChgLotStatusExist(
p_szFChgStatusLotId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFChgStatusLotId

FROM 
BOS_INV_FChgLotStatus
WHERE 
szFChgStatusLotId = p_szFChgStatusLotId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FChgLotStatus_LockFChgLotStatus(
p_szFChgStatusLotId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FChgLotStatus
SET 
bTransferred = bTransferred
WHERE 
szFChgStatusLotId = p_szFChgStatusLotId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FChgLotStatus_UpdateFChgLotStatus(
p_szFChgStatusLotId BOS_DT_szId,
p_dtmFChgStatusLotId timestamp,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FChgLotStatus
SET 
szFChgStatusLotId = p_szFChgStatusLotId,
dtmFChgStatusLotId = p_dtmFChgStatusLotId,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFChgStatusLotId = p_szFChgStatusLotId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_CreateFDn(
p_szFDnId BOS_DT_szId,
p_dtmDelivery timestamp,
p_szFDoId BOS_DT_szId,
p_szDestinationType BOS_DT_szSmallId,
p_szDestinationId BOS_DT_szId,
p_DlvszContactPerson BOS_DT_szName,
p_DlvszRoomNo BOS_DT_szSmallName,
p_DlvszFloor BOS_DT_szSmallName,
p_DlvszBuilding BOS_DT_szName,
p_DlvszAddress_1 BOS_DT_szName,
p_DlvszAddress_2 BOS_DT_szName,
p_DlvszDistrict BOS_DT_szMediumName,
p_DlvszCity BOS_DT_szMediumName,
p_DlvszZipCode BOS_DT_szSmallName,
p_DlvszState BOS_DT_szMediumName,
p_DlvszCountry BOS_DT_szMediumName,
p_DlvszPhoneNo_1 BOS_DT_szMediumName,
p_DlvszPhoneNo_2 BOS_DT_szMediumName,
p_DlvszFaxNo BOS_DT_szMediumName,
p_DlvszMobileNo BOS_DT_szMediumName,
p_DlvszEmail BOS_DT_szMediumName,
p_DlvszWebSite BOS_DT_szMediumName,
p_szCarrierId BOS_DT_szId,
p_szVehicleNumber varchar,
p_szDriverName BOS_DT_szName,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szCustPoId bit,
p_dtmCustPo timestamp,
p_szDriverId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szFStInId BOS_DT_szId,
p_bFromDistribution bit,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FDn
(
szFDnId,
dtmDelivery,
szFDoId,
szDestinationType,
szDestinationId,
DlvszContactPerson,
DlvszRoomNo,
DlvszFloor,
DlvszBuilding,
DlvszAddress_1,
DlvszAddress_2,
DlvszDistrict,
DlvszCity,
DlvszZipCode,
DlvszState,
DlvszCountry,
DlvszPhoneNo_1,
DlvszPhoneNo_2,
DlvszFaxNo,
DlvszMobileNo,
DlvszEmail,
DlvszWebSite,
szCarrierId,
szVehicleNumber,
szDriverName,
szLocationType,
szLocationId,
szStockTypeId,
szCustPoId,
dtmCustPo,
szDriverId,
szVehicleId,
szFStInId,
bFromDistribution,
szFAdjustmentId,
szAdjustedById,
szAdjustToId,
szDescription,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFDnId,
p_dtmDelivery,
p_szFDoId,
p_szDestinationType,
p_szDestinationId,
p_DlvszContactPerson,
p_DlvszRoomNo,
p_DlvszFloor,
p_DlvszBuilding,
p_DlvszAddress_1,
p_DlvszAddress_2,
p_DlvszDistrict,
p_DlvszCity,
p_DlvszZipCode,
p_DlvszState,
p_DlvszCountry,
p_DlvszPhoneNo_1,
p_DlvszPhoneNo_2,
p_DlvszFaxNo,
p_DlvszMobileNo,
p_DlvszEmail,
p_DlvszWebSite,
p_szCarrierId,
p_szVehicleNumber,
p_szDriverName,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_szCustPoId,
p_dtmCustPo,
p_szDriverId,
p_szVehicleId,
p_szFStInId,
p_bFromDistribution,
p_szFAdjustmentId,
p_szAdjustedById,
p_szAdjustToId,
p_szDescription,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_CreateFDn_013(
p_szFDnId BOS_DT_szId,
p_dtmDelivery timestamp,
p_szFDoId BOS_DT_szId,
p_szDestinationType BOS_DT_szSmallId,
p_szDestinationId BOS_DT_szId,
p_DlvszContactPerson BOS_DT_szName,
p_DlvszRoomNo BOS_DT_szSmallName,
p_DlvszFloor BOS_DT_szSmallName,
p_DlvszBuilding BOS_DT_szName,
p_DlvszAddress_1 BOS_DT_szName,
p_DlvszAddress_2 BOS_DT_szName,
p_DlvszDistrict BOS_DT_szName,
p_DlvszCity BOS_DT_szMediumName,
p_DlvszZipCode BOS_DT_szSmallName,
p_DlvszState BOS_DT_szMediumName,
p_DlvszCountry BOS_DT_szMediumName,
p_DlvszPhoneNo_1 BOS_DT_szMediumName,
p_DlvszPhoneNo_2 BOS_DT_szMediumName,
p_DlvszFaxNo BOS_DT_szMediumName,
p_DlvszMobileNo BOS_DT_szMediumName,
p_DlvszEmail BOS_DT_szMediumName,
p_DlvszWebSite BOS_DT_szMediumName,
p_szCarrierId BOS_DT_szId,
p_szVehicleNumber varchar,
p_szDriverName BOS_DT_szName,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szCustPoId bit,
p_dtmCustPo timestamp,
p_szDriverId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szFStInId BOS_DT_szId,
p_bFromDistribution bit,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FDn
(
szFDnId,
dtmDelivery,
szFDoId,
szDestinationType,
szDestinationId,
DlvszContactPerson,
DlvszRoomNo,
DlvszFloor,
DlvszBuilding,
DlvszAddress_1,
DlvszAddress_2,
DlvszDistrict,
DlvszCity,
DlvszZipCode,
DlvszState,
DlvszCountry,
DlvszPhoneNo_1,
DlvszPhoneNo_2,
DlvszFaxNo,
DlvszMobileNo,
DlvszEmail,
DlvszWebSite,
szCarrierId,
szVehicleNumber,
szDriverName,
szLocationType,
szLocationId,
szStockTypeId,
szCustPoId,
dtmCustPo,
szDriverId,
szVehicleId,
szFStInId,
bFromDistribution,
szFAdjustmentId,
szAdjustedById,
szAdjustToId,
szDescription,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFDnId,
p_dtmDelivery,
p_szFDoId,
p_szDestinationType,
p_szDestinationId,
p_DlvszContactPerson,
p_DlvszRoomNo,
p_DlvszFloor,
p_DlvszBuilding,
p_DlvszAddress_1,
p_DlvszAddress_2,
p_DlvszDistrict,
p_DlvszCity,
p_DlvszZipCode,
p_DlvszState,
p_DlvszCountry,
p_DlvszPhoneNo_1,
p_DlvszPhoneNo_2,
p_DlvszFaxNo,
p_DlvszMobileNo,
p_DlvszEmail,
p_DlvszWebSite,
p_szCarrierId,
p_szVehicleNumber,
p_szDriverName,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_szCustPoId,
p_dtmCustPo,
p_szDriverId,
p_szVehicleId,
p_szFStInId,
p_bFromDistribution,
p_szFAdjustmentId,
p_szAdjustedById,
p_szAdjustToId,
p_szDescription,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_CreateFDnItem(
p_szFDnId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decCOGS BOS_DT_decAmount,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FDnItem
(
szFDnId,
shItemNumber,
szProductId,
decQty,
decUomQty,
szUomId,
decCOGS,
szParentId
)
VALUES
(
p_szFDnId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_decCOGS,
p_szParentId,
-- ==================================================================,
SET ANSI_NULLS ON,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_CreateFDnItem_013(
p_szFDnId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decCOGS BOS_DT_decAmount,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FDnItem
(
szFDnId,
shItemNumber,
szProductId,
decQty,
decUomQty,
szUomId,
decCOGS,
szParentId
)
VALUES
(
p_szFDnId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_decCOGS,
p_szParentId,
-- ==================================================================,
SET ANSI_NULLS ON,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_CreateFDnItemLotQty(
p_szFDnId BOS_DT_szId,
p_shItemNumber smallint,
p_szLotId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FDnItemLotQty
(
szFDnId,
shItemNumber,
szLotId
decQty,
)
VALUES
(
p_szFDnId,
p_shItemNumber,
p_szLotId
p_decQty,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_CreateFDnItemSn(
p_szFDnId BOS_DT_szId,
p_shItemNumber smallint,
p_shItem2Number smallint,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FDnItemSn
(
szFDnId,
shItemNumber,
shItem2Number,
szProductSn
)
VALUES
(
p_szFDnId,
p_shItemNumber,
p_shItem2Number,
p_szProductSn
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_DeleteFDn(
p_szFDnId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FDn
WHERE
szFDnId=p_szFDnId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_DeleteFDnItem(
p_szFDnId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FDnItem
WHERE
szFDnId=p_szFDnId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_DeleteFDnItemLotQty(
p_szFDnId varchar)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_INV_FDnItemLotQty
WHERE
 szFDnId = p_szFDnId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_DeleteFDnItemSn(
p_szFDnId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FDnItemSn
WHERE
szFDnId=p_szFDnId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_GetFDn(
p_szFDnId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_FDn.dtmDelivery,
BOS_INV_FDn.szFDoId,

BOS_INV_FDn.szDestinationType,
BOS_INV_FDn.szDestinationId,

DestWp.szName AS szDestWorkplaceNm_J,
DestCust.szName AS szDestCustomerNm_J,

BOS_INV_FDn.DlvszContactPerson,
BOS_INV_FDn.DlvszRoomNo,
BOS_INV_FDn.DlvszFloor,
BOS_INV_FDn.DlvszBuilding,
BOS_INV_FDn.DlvszAddress_1,
BOS_INV_FDn.DlvszAddress_2,
BOS_INV_FDn.DlvszDistrict,
BOS_INV_FDn.DlvszCity,
BOS_INV_FDn.DlvszZipCode,
BOS_INV_FDn.DlvszState,
BOS_INV_FDn.DlvszCountry,
BOS_INV_FDn.DlvszPhoneNo_1,
BOS_INV_FDn.DlvszPhoneNo_2,
BOS_INV_FDn.DlvszFaxNo,
BOS_INV_FDn.DlvszMobileNo,
BOS_INV_FDn.DlvszEmail,
BOS_INV_FDn.DlvszWebSite,

BOS_INV_FDn.szCarrierId,
Carr.szName AS szCarrierNm_J,

BOS_INV_FDn.szVehicleNumber,
BOS_INV_FDn.szDriverName,

BOS_INV_FDn.szLocationType,
BOS_INV_FDn.szLocationId,

Wh.szName AS szWarehouseNm_J,

BOS_INV_FDn.szStockTypeId,
BOS_INV_FDn.szCustPoId,
BOS_INV_FDn.dtmCustPo,
BOS_INV_FDn.szDriverId,
BOS_INV_FDn.szVehicleId,
BOS_INV_FDn.szFStInId,
BOS_INV_FDn.bFromDistribution,
BOS_INV_FDn.szFAdjustmentId,
BOS_INV_FDn.szAdjustedById,
BOS_INV_FDn.szAdjustToId,

BOS_INV_FDn.bResultFrTransfer,
BOS_INV_FDn.bVoid,
BOS_GEN_Approved.bApproved,
BOS_INV_FDn.bApplied,
BOS_GL_FJournalTrans.szFJournalId AS bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FDn.btPrintedCount,
BOS_INV_FDn.bTransferred,

BOS_INV_FDn.szCompanyId,
BOS_GL_Company.szName AS szCompanyNm,

BOS_INV_FDn.szWorkplaceId,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FDn.szTaxEntityId,
BOS_INV_FDn.bNeedApproval,
BOS_INV_FDn.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_INV_FDn.dtmCreated,
BOS_INV_FDn.bSystemCreated,
BOS_INV_FDn.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FDn.dtmLastUpdated,
BOS_INV_FDn.bAlreadyTransferred,

-- Description
BOS_INV_FDn.szDescription

FROM
BOS_INV_FDn 
LEFT JOIN BOS_GEN_Approved ON BOS_INV_FDn.gdApprovedId=BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_INV_FDn.szFJournalId=BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FDn.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FDn.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FDn.szUserId

LEFT JOIN BOS_GL_Workplace AS DestWp ON DestWp.szWorkplaceId = BOS_INV_FDn.szDestinationId
LEFT JOIN BOS_AR_Customer AS DestCust ON DestCust.szCustId = BOS_INV_FDn.szDestinationId

LEFT JOIN BOS_INV_Warehouse AS Wh ON Wh.szWarehouseId = BOS_INV_FDn.szLocationId

LEFT JOIN BOS_INV_Carrier AS Carr ON Carr.szCarrierId = BOS_INV_FDn.szCarrierId

WHERE
BOS_INV_FDn.szFDnId=p_szFDnId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_GetFDn_013(
p_szFDnId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_FDn.dtmDelivery,
BOS_INV_FDn.szFDoId,

BOS_INV_FDn.szDestinationType,
BOS_INV_FDn.szDestinationId,

DestWp.szName AS szDestWorkplaceNm_J,
DestCust.szName AS szDestCustomerNm_J,

BOS_INV_FDn.DlvszContactPerson,
BOS_INV_FDn.DlvszRoomNo,
BOS_INV_FDn.DlvszFloor,
BOS_INV_FDn.DlvszBuilding,
BOS_INV_FDn.DlvszAddress_1,
BOS_INV_FDn.DlvszAddress_2,
BOS_INV_FDn.DlvszDistrict,
BOS_INV_FDn.DlvszCity,
BOS_INV_FDn.DlvszZipCode,
BOS_INV_FDn.DlvszState,
BOS_INV_FDn.DlvszCountry,
BOS_INV_FDn.DlvszPhoneNo_1,
BOS_INV_FDn.DlvszPhoneNo_2,
BOS_INV_FDn.DlvszFaxNo,
BOS_INV_FDn.DlvszMobileNo,
BOS_INV_FDn.DlvszEmail,
BOS_INV_FDn.DlvszWebSite,

BOS_INV_FDn.szCarrierId,
Carr.szName AS szCarrierNm_J,

BOS_INV_FDn.szVehicleNumber,
BOS_INV_FDn.szDriverName,

BOS_INV_FDn.szLocationType,
BOS_INV_FDn.szLocationId,

Wh.szName AS szWarehouseNm_J,

BOS_INV_FDn.szStockTypeId,
BOS_INV_FDn.szCustPoId,
BOS_INV_FDn.dtmCustPo,
BOS_INV_FDn.szDriverId,
BOS_INV_FDn.szVehicleId,
BOS_INV_FDn.szFStInId,
BOS_INV_FDn.bFromDistribution,
BOS_INV_FDn.szFAdjustmentId,
BOS_INV_FDn.szAdjustedById,
BOS_INV_FDn.szAdjustToId,

BOS_INV_FDn.bResultFrTransfer,
BOS_INV_FDn.bVoid,
BOS_GEN_Approved.bApproved,
BOS_INV_FDn.bApplied,
BOS_GL_FJournalTrans.szFJournalId AS bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FDn.btPrintedCount,
BOS_INV_FDn.bTransferred,

BOS_INV_FDn.szCompanyId,
BOS_GL_Company.szName AS szCompanyNm,

BOS_INV_FDn.szWorkplaceId,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FDn.szTaxEntityId,
BOS_INV_FDn.bNeedApproval,
BOS_INV_FDn.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_INV_FDn.dtmCreated,
BOS_INV_FDn.bSystemCreated,
BOS_INV_FDn.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FDn.dtmLastUpdated,
BOS_INV_FDn.bAlreadyTransferred,

-- Description
BOS_INV_FDn.szDescription

FROM
BOS_INV_FDn 
LEFT JOIN BOS_GEN_Approved ON BOS_INV_FDn.gdApprovedId=BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_INV_FDn.szFJournalId=BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FDn.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FDn.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FDn.szUserId

LEFT JOIN BOS_GL_Workplace AS DestWp ON DestWp.szWorkplaceId = BOS_INV_FDn.szDestinationId
LEFT JOIN BOS_AR_Customer AS DestCust ON DestCust.szCustId = BOS_INV_FDn.szDestinationId

LEFT JOIN BOS_INV_Warehouse AS Wh ON Wh.szWarehouseId = BOS_INV_FDn.szLocationId

LEFT JOIN BOS_INV_Carrier AS Carr ON Carr.szCarrierId = BOS_INV_FDn.szCarrierId

WHERE
BOS_INV_FDn.szFDnId=p_szFDnId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_GetFDnItem(
p_szFDnId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_FDnItem.shItemNumber,
BOS_INV_FDnItem.szProductId,

BOS_INV_Product.szName AS szProductName,
BOS_INV_Product.szNickName As szProductNickName_J,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,

BOS_INV_FDnItem.decQty,
BOS_INV_FDnItem.decUomQty,

BOS_INV_FDnItem.szUomId,
BOS_INV_FDnItem.decCOGS,

BOS_INV_FDnItem.szParentId,
BIP2.szName AS szParentNm_J

FROM
BOS_INV_FDnItem
LEFT JOIN BOS_INV_Product ON BOS_INV_FDnItem.szProductId=BOS_INV_Product.szProductId
LEFT JOIN BOS_INV_Product AS BIP2 ON BIP2.szProductId = BOS_INV_FDnItem.szParentId

WHERE
BOS_INV_FDnItem.szFDnId = p_szFDnId

-- ==================================================================

SET ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_GetFDnItem_013(
p_szFDnId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_FDnItem.shItemNumber,
BOS_INV_FDnItem.szProductId,

BOS_INV_Product.szName AS szProductName,
BOS_INV_Product.szNickName As szProductNickName_J,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,

BOS_INV_FDnItem.decQty,
BOS_INV_FDnItem.decUomQty,

BOS_INV_FDnItem.szUomId,
BOS_INV_FDnItem.decCOGS,

BOS_INV_FDnItem.szParentId,
BIP2.szName AS szParentNm_J


FROM
BOS_INV_FDnItem
LEFT JOIN BOS_INV_Product ON BOS_INV_FDnItem.szProductId=BOS_INV_Product.szProductId
LEFT JOIN BOS_INV_Product AS BIP2 ON BIP2.szProductId = BOS_INV_FDnItem.szParentId

WHERE
BOS_INV_FDnItem.szFDnId = p_szFDnId

-- ==================================================================

SET ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_GetFDnItemLotQty(
p_szFDnId varchar,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLotId,
decQty

FROM 
BOS_INV_FDnItemLotQty
WHERE 
 szFDnId = p_szFDnId And shItemNumber = p_shItemNumber;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_GetFDnItemSn(
p_szFDnId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItem2Number,
szProductSn


FROM 
BOS_INV_FDnItemSn
WHERE 
szFDnId = p_szFDnId AND shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_GetListOfFDn()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFDnId,
dtmDelivery

FROM 
BOS_INV_FDn

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_IsFDnExist(
p_szFDnId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFDnId

FROM 
BOS_INV_FDn
WHERE 
szFDnId=p_szFDnId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_LockFDn(
p_szFDnId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FDn
SET 
bTransferred = bTransferred

WHERE 
szFDnId = p_szFDnId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_UpdateFDn(
p_szFDnId BOS_DT_szId,
p_dtmDelivery timestamp,
p_szFDoId BOS_DT_szId,
p_szDestinationType BOS_DT_szSmallId,
p_szDestinationId BOS_DT_szId,
p_DlvszContactPerson BOS_DT_szName,
p_DlvszRoomNo BOS_DT_szSmallName,
p_DlvszFloor BOS_DT_szSmallName,
p_DlvszBuilding BOS_DT_szName,
p_DlvszAddress_1 BOS_DT_szName,
p_DlvszAddress_2 BOS_DT_szName,
p_DlvszDistrict BOS_DT_szMediumName,
p_DlvszCity BOS_DT_szMediumName,
p_DlvszZipCode BOS_DT_szSmallName,
p_DlvszState BOS_DT_szMediumName,
p_DlvszCountry BOS_DT_szMediumName,
p_DlvszPhoneNo_1 BOS_DT_szMediumName,
p_DlvszPhoneNo_2 BOS_DT_szMediumName,
p_DlvszFaxNo BOS_DT_szMediumName,
p_DlvszMobileNo BOS_DT_szMediumName,
p_DlvszEmail BOS_DT_szMediumName,
p_DlvszWebSite BOS_DT_szMediumName,
p_szCarrierId BOS_DT_szId,
p_szVehicleNumber varchar,
p_szDriverName BOS_DT_szName,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szCustPoId bit,
p_dtmCustPo timestamp,
p_szDriverId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_bFromDistribution bit,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FDn
SET 
dtmDelivery = p_dtmDelivery,
szFDoId = p_szFDoId,
szDestinationType = p_szDestinationType,
szDestinationId = p_szDestinationId,
DlvszContactPerson = p_DlvszContactPerson,
DlvszRoomNo = p_DlvszRoomNo,
DlvszFloor = p_DlvszFloor,
DlvszBuilding = p_DlvszBuilding,
DlvszAddress_1 = p_DlvszAddress_1,
DlvszAddress_2 = p_DlvszAddress_2,
DlvszDistrict = p_DlvszDistrict,
DlvszCity = p_DlvszCity,
DlvszZipCode = p_DlvszZipCode,
DlvszState = p_DlvszState,
DlvszCountry = p_DlvszCountry,
DlvszPhoneNo_1 = p_DlvszPhoneNo_1,
DlvszPhoneNo_2 = p_DlvszPhoneNo_2,
DlvszFaxNo = p_DlvszFaxNo,
DlvszMobileNo = p_DlvszMobileNo,
DlvszEmail = p_DlvszEmail,
DlvszWebSite = p_DlvszWebSite,
szCarrierId=p_szCarrierId,
szVehicleNumber = p_szVehicleNumber,
szDriverName = p_szDriverName,
szLocationType = p_szLocationType,
szLocationId = p_szLocationId,
szStockTypeId = p_szStockTypeId,
szCustPoId = p_szCustPoId,
dtmCustPo = p_dtmCustPo,
szDriverId = p_szDriverId,
szVehicleId = p_szVehicleId,
bFromDistribution = p_bFromDistribution,
szFAdjustmentId=p_szFAdjustmentId,
szAdjustedById=p_szAdjustedById,
szAdjustToId=p_szAdjustToId,
szDescription = p_szDescription,

bVoid=p_bVoid,
bApplied=p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFDnId = p_szFDnId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_UpdateFDn_013(
p_szFDnId BOS_DT_szId,
p_dtmDelivery timestamp,
p_szFDoId BOS_DT_szId,
p_szDestinationType BOS_DT_szSmallId,
p_szDestinationId BOS_DT_szId,
p_DlvszContactPerson BOS_DT_szName,
p_DlvszRoomNo BOS_DT_szSmallName,
p_DlvszFloor BOS_DT_szSmallName,
p_DlvszBuilding BOS_DT_szName,
p_DlvszAddress_1 BOS_DT_szName,
p_DlvszAddress_2 BOS_DT_szName,
p_DlvszDistrict BOS_DT_szName,
p_DlvszCity BOS_DT_szMediumName,
p_DlvszZipCode BOS_DT_szSmallName,
p_DlvszState BOS_DT_szMediumName,
p_DlvszCountry BOS_DT_szMediumName,
p_DlvszPhoneNo_1 BOS_DT_szMediumName,
p_DlvszPhoneNo_2 BOS_DT_szMediumName,
p_DlvszFaxNo BOS_DT_szMediumName,
p_DlvszMobileNo BOS_DT_szMediumName,
p_DlvszEmail BOS_DT_szMediumName,
p_DlvszWebSite BOS_DT_szMediumName,
p_szCarrierId BOS_DT_szId,
p_szVehicleNumber varchar,
p_szDriverName BOS_DT_szName,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szCustPoId bit,
p_dtmCustPo timestamp,
p_szDriverId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_bFromDistribution bit,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FDn
SET 
dtmDelivery = p_dtmDelivery,
szFDoId = p_szFDoId,
szDestinationType = p_szDestinationType,
szDestinationId = p_szDestinationId,
DlvszContactPerson = p_DlvszContactPerson,
DlvszRoomNo = p_DlvszRoomNo,
DlvszFloor = p_DlvszFloor,
DlvszBuilding = p_DlvszBuilding,
DlvszAddress_1 = p_DlvszAddress_1,
DlvszAddress_2 = p_DlvszAddress_2,
DlvszDistrict = p_DlvszDistrict,
DlvszCity = p_DlvszCity,
DlvszZipCode = p_DlvszZipCode,
DlvszState = p_DlvszState,
DlvszCountry = p_DlvszCountry,
DlvszPhoneNo_1 = p_DlvszPhoneNo_1,
DlvszPhoneNo_2 = p_DlvszPhoneNo_2,
DlvszFaxNo = p_DlvszFaxNo,
DlvszMobileNo = p_DlvszMobileNo,
DlvszEmail = p_DlvszEmail,
DlvszWebSite = p_DlvszWebSite,
szCarrierId=p_szCarrierId,
szVehicleNumber = p_szVehicleNumber,
szDriverName = p_szDriverName,
szLocationType = p_szLocationType,
szLocationId = p_szLocationId,
szStockTypeId = p_szStockTypeId,
szCustPoId = p_szCustPoId,
dtmCustPo = p_dtmCustPo,
szDriverId = p_szDriverId,
szVehicleId = p_szVehicleId,
bFromDistribution = p_bFromDistribution,
szFAdjustmentId=p_szFAdjustmentId,
szAdjustedById=p_szAdjustedById,
szAdjustToId=p_szAdjustToId,
szDescription = p_szDescription,

bVoid=p_bVoid,
bApplied=p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFDnId = p_szFDnId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDn_UpdateFDnForAdjustment(
p_szFDnId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FDn
SET 
szFAdjustmentId = p_szFAdjustmentId,
szAdjustedById = p_szAdjustedById

WHERE 
szFDnId = p_szFDnId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FDnMonitor_QueryData(
p_szWpId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN

select
isnull(fdn2FDnCreated.szFDn2Id, '') as szFDn2Id, fdn.szFDnId, fdn.dtmDelivery
, fdn.szWorkplaceId as szOriginWpId, originWp.szName as szOriginWpNm_J
, fdn.szDestinationId as szDestWpId, destWp.szName as szDestWpNm_J
, fdni.szProductId, prod.szName as szProductNm_J
, prod.szNickName as szProductNickName_J, prod.szQtyFormat as szProductQtyFormat_J
, prod.szUomId as szProductUomId_J, prod.szCompUomId as szProductCompUomId_J
, prod.szUomClassId as szProductUomClassId_J
, fdni.decQty as decQtyDelivered, isnull(fstini.decQty, 0) as decQtyReceived
, (fdni.decQty-isnull(fstini.decQty, 0)) as decQtyRemain
, isnull(fstin.dtmtransfer,'') as dtmTransfer_J

from bos_inv_fdn as fdn
left join bos_gl_workplace as originWp on fdn.szWorkplaceId = originWp.szWorkplaceId
left join bos_gl_workplace as destWp on fdn.szDestinationId = destWp.szWorkplaceId
left join bos_inv_fdnitem as fdni on fdn.szFDnId = fdni.szFDnId
left join bos_inv_product as prod on fdni.szProductId = prod.szProductId
left join bos_inv_fstinItem as fstini on fdn.szFStInId = fstini.szFStInId
and fdni.szProductId = fstini.szProductId
left join bos_inv_fdn2FDnCreated as fdn2FDnCreated on fdn.szFDnId = fdn2FDnCreated.szFDnId
and fdn.szDestinationId = fdn2FDnCreated.szWpId
left join bos_inv_fstin as fstin on fstini.szFStInId = fstin.szFStInId

where
fdn.szWorkplaceId like p_szWpId
and fdn.dtmDelivery >= p_dtmStart
and fdn.dtmDelivery < p_dtmEnd
and fdn.bApplied = 1
and fdn.szDestinationType = 'WOR'

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_CreateFSid(
p_szFSidId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_dtmIn timestamp,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szHelperId BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_szNoBKB BOS_DT_szId,
p_decRitKe numeric,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSid
(
szFSidId,
szSalesOrgId,
dtmIn,
szLocationType,
szLocationId,
szStockTypeId,
szVehicleId,
szDriverId,
szFAdjustmentId,
szAdjustedById,
szAdjustToId,
szDescription,
szHelperId,
szHelperId_2,
szHelperId_3,
szNoBKB,
decRitKe,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFSidId,
p_szSalesOrgId,
p_dtmIn,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_szVehicleId,
p_szDriverId,
p_szFAdjustmentId,
p_szAdjustedById,
p_szAdjustToId,
p_szDescription,
p_szHelperId,
p_szHelperId_2,
p_szHelperId_3,
p_szNoBKB,
p_decRitKe,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_CreateFSid_014(
p_szFSidId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_dtmIn timestamp,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szHelperId BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_szNoBKB BOS_DT_szId,
p_decRitKe numeric,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSid
(
szFSidId,
szSalesOrgId,
dtmIn,
szLocationType,
szLocationId,
szStockTypeId,
szVehicleId,
szDriverId,
szFAdjustmentId,
szAdjustedById,
szAdjustToId,
szDescription,
szHelperId,
szHelperId_2,
szHelperId_3,
szNoBKB,
decRitKe,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFSidId,
p_szSalesOrgId,
p_dtmIn,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_szVehicleId,
p_szDriverId,
p_szFAdjustmentId,
p_szAdjustedById,
p_szAdjustToId,
p_szDescription,
p_szHelperId,
p_szHelperId_2,
p_szHelperId_3,
p_szNoBKB,
p_decRitKe,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_CreateFSidItem(
p_szFSidId BOS_DT_szId,
p_btItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSidItem
(
szFSidId,
btItemNumber,
szProductId,
decQty,
decUomQty,
szUomId,
szParentId
)
VALUES
(
p_szFSidId,
p_btItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_szParentId,
-- ==================================================================,
SET ANSI_NULLS ON,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_CreateFSidItem_013(
p_szFSidId BOS_DT_szId,
p_btItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSidItem
(
szFSidId,
btItemNumber,
szProductId,
decQty,
decUomQty,
szUomId,
szParentId
)
VALUES
(
p_szFSidId,
p_btItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_szParentId,
-- ==================================================================,
SET ANSI_NULLS ON,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_CreateFSidItemLotQty(
p_szFSidId BOS_DT_szId,
p_btItemNumber smallint,
p_szLotId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSidItemLotQty
(
szFSidId,
btItemNumber,
szLotId,
decQty,
)
VALUES
(
p_szFSidId,
p_btItemNumber,
p_szLotId,
p_decQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_CreateFSidItemSn(
p_szFSidId BOS_DT_szId,
p_btItemNumber smallint,
p_shItemSnNumber smallint,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSidItemSn
(
szFSidId,
btItemNumber,
shItemSnNumber,
szProductSn
)
VALUES
(
p_szFSidId,
p_btItemNumber,
p_shItemSnNumber,
p_szProductSn
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_DeleteFSid(
p_szFSidId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FSid
WHERE
szFSidId = p_szFSidId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_DeleteFSidItem(
p_szFSidId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FSidItem
WHERE
szFSidId = p_szFSidId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_DeleteFSidItemLotQty(
p_szFSidId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_INV_FSidItemLotQty
WHERE
szFSidId = p_szFSidId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_DeleteFSidItemSn(
p_szFSidId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FSidItemSn
WHERE
szFSidId = p_szFSidId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_GetFSid(
p_szFSidId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_INV_FSid.szSalesOrgId,
BOS_INV_FSid.dtmIn,
BOS_INV_FSid.szLocationType,
BOS_INV_FSid.szLocationId,
BOS_INV_FSid.szStockTypeId,
BOS_INV_FSid.szVehicleId,
BOS_INV_Vehicle.szPoliceNo as szVehicleNo,
BOS_INV_FSid.szDriverId,
BOS_PI_Employee.szName as szDriverNm,
BOS_INV_FSid.szFAdjustmentId,
BOS_INV_FSid.szAdjustedById,
BOS_INV_FSid.szAdjustToId,
BOS_INV_FSid.szDescription,

BOS_INV_FSid.szHelperId,
BOS_PI_Employee1.szName as szHelperNm,

BOS_INV_FSid.szHelperId_2,
BOS_PI_Employee2.szName as szHelperNm_2,

BOS_INV_FSid.szHelperId_3,
BOS_PI_Employee3.szName as szHelperNm_3,

BOS_INV_FSid.szNoBKB,
BOS_INV_FSid.decRitKe,

BOS_INV_FSid.bResultFrTransfer,
BOS_INV_FSid.bVoid,
BOS_GEN_Approved.bApproved,
BOS_INV_FSid.bApplied,
BOS_GL_FJournalTrans.szFJournalId AS bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FSid.btPrintedCount,
BOS_INV_FSid.bTransferred,
BOS_INV_FSid.szCompanyId,
BOS_INV_FSid.szWorkplaceId,
BOS_INV_FSid.szTaxEntityId,
BOS_INV_FSid.bNeedApproval,
BOS_INV_FSid.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FSid.dtmCreated,
BOS_INV_FSid.bSystemCreated,
BOS_INV_FSid.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FSid.dtmLastUpdated,
BOS_INV_FSid.bAlreadyTransferred

FROM BOS_INV_FSid 
LEFT JOIN BOS_GEN_Approved ON BOS_INV_FSid.gdApprovedId=BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_INV_FSid.szFJournalId=BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_PI_Employee ON BOS_INV_FSid.szDriverId = BOS_PI_Employee.szEmployeeId

LEFT JOIN BOS_PI_Employee BOS_PI_Employee1 ON BOS_INV_FSid.szHelperId   = BOS_PI_Employee1.szEmployeeId
LEFT JOIN BOS_PI_Employee BOS_PI_Employee2 ON BOS_INV_FSid.szHelperId_2 = BOS_PI_Employee2.szEmployeeId
LEFT JOIN BOS_PI_Employee BOS_PI_Employee3 ON BOS_INV_FSid.szHelperId_3 = BOS_PI_Employee3.szEmployeeId

LEFT JOIN BOS_INV_Vehicle ON BOS_INV_FSid.szVehicleId = BOS_INV_Vehicle.szVehicleId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FSid.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FSid.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FSid.szUserId

WHERE
BOS_INV_FSid.szFSidId = p_szFSidId


-- ==================================================================

set ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_GetFSid_014(
p_szFSidId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_INV_FSid.szSalesOrgId,
BOS_INV_FSid.dtmIn,
BOS_INV_FSid.szLocationType,
BOS_INV_FSid.szLocationId,
BOS_INV_FSid.szStockTypeId,
BOS_INV_FSid.szVehicleId,
BOS_INV_Vehicle.szPoliceNo as szVehicleNo,
BOS_INV_FSid.szDriverId,
BOS_PI_Employee.szName as szDriverNm,
BOS_INV_FSid.szFAdjustmentId,
BOS_INV_FSid.szAdjustedById,
BOS_INV_FSid.szAdjustToId,
BOS_INV_FSid.szDescription,

BOS_INV_FSid.szHelperId,
BOS_PI_Employee1.szName as szHelperNm,

BOS_INV_FSid.szHelperId_2,
BOS_PI_Employee2.szName as szHelperNm_2,

BOS_INV_FSid.szHelperId_3,
BOS_PI_Employee3.szName as szHelperNm_3,

BOS_INV_FSid.szNoBKB,
BOS_INV_FSid.decRitKe,

BOS_INV_FSid.bResultFrTransfer,
BOS_INV_FSid.bVoid,
BOS_GEN_Approved.bApproved,
BOS_INV_FSid.bApplied,
BOS_GL_FJournalTrans.szFJournalId AS bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FSid.btPrintedCount,
BOS_INV_FSid.bTransferred,
BOS_INV_FSid.szCompanyId,
BOS_INV_FSid.szWorkplaceId,
BOS_INV_FSid.szTaxEntityId,
BOS_INV_FSid.bNeedApproval,
BOS_INV_FSid.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FSid.dtmCreated,
BOS_INV_FSid.bSystemCreated,
BOS_INV_FSid.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FSid.dtmLastUpdated,
BOS_INV_FSid.bAlreadyTransferred

FROM BOS_INV_FSid 
LEFT JOIN BOS_GEN_Approved ON BOS_INV_FSid.gdApprovedId=BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_INV_FSid.szFJournalId=BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_PI_Employee ON BOS_INV_FSid.szDriverId = BOS_PI_Employee.szEmployeeId

LEFT JOIN BOS_PI_Employee BOS_PI_Employee1 ON BOS_INV_FSid.szHelperId   = BOS_PI_Employee1.szEmployeeId
LEFT JOIN BOS_PI_Employee BOS_PI_Employee2 ON BOS_INV_FSid.szHelperId_2 = BOS_PI_Employee2.szEmployeeId
LEFT JOIN BOS_PI_Employee BOS_PI_Employee3 ON BOS_INV_FSid.szHelperId_3 = BOS_PI_Employee3.szEmployeeId

LEFT JOIN BOS_INV_Vehicle ON BOS_INV_FSid.szVehicleId = BOS_INV_Vehicle.szVehicleId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FSid.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FSid.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FSid.szUserId

WHERE
BOS_INV_FSid.szFSidId = p_szFSidId


-- ==================================================================

set ANSI_NULLS ON


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_GetFSidItem(
p_szFSidId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_INV_FSidItem.btItemNumber,
BOS_INV_FSidItem.szProductId,
BOS_INV_Product.szName AS szProductName,
BOS_INV_Product.szNickName As szProductNickName_J,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_FSidItem.decQty,
BOS_INV_FSidItem.decUomQty,
BOS_INV_FSidItem.szUomId,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szUomId as szProductUomId,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
BOS_INV_FSidItem.szParentId AS szParentId,
BIP2.szname AS szParentNm

FROM
BOS_INV_FSidItem
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FSidItem.szProductId
LEFT JOIN BOS_INV_Product AS BIP2 ON BIP2.szProductId = BOS_INV_FSidItem.szProductId

WHERE
szFSidId = p_szFSidId

-- ==================================================================

set ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_GetFSidItem_014(
p_szFSidId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_INV_FSidItem.btItemNumber,
BOS_INV_FSidItem.szProductId,
BOS_INV_Product.szName AS szProductName,
BOS_INV_Product.szNickName As szProductNickName_J,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_FSidItem.decQty,
BOS_INV_FSidItem.decUomQty,
BOS_INV_FSidItem.szUomId,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szUomId as szProductUomId,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
BOS_INV_FSidItem.szParentId AS szParentId,
BIP2.szname AS szParentNm

FROM
BOS_INV_FSidItem
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FSidItem.szProductId
LEFT JOIN BOS_INV_Product AS BIP2 ON BIP2.szProductId = BOS_INV_FSidItem.szProductId

WHERE
szFSidId = p_szFSidId

-- ==================================================================

set ANSI_NULLS ON


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_GetFSidItemLotQty(
p_szFSidId BOS_DT_szId,
p_btItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLotId,
decQty


FROM 
BOS_INV_FSidItemLotQty

WHERE 
szFSidId = p_szFSidId And btItemNumber = p_btItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_GetFSidItemSn(
p_szFSidId BOS_DT_szId,
p_btItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemSnNumber,
szProductSn


FROM 
BOS_INV_FSidItemSn
WHERE 
szFSidId = p_szFSidId AND btItemNumber = p_btItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_GetListOfFSid()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSidId,
dtmIn

FROM 
BOS_INV_FSid

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_IsFSidExist(
p_szFSidId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSidId

FROM 
BOS_INV_FSid
WHERE 
szFSidId = p_szFSidId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_LockFSid(
p_szFSidId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FSid
SET 
bTransferred = bTransferred
WHERE 
szFSidId = p_szFSidId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_UpdateFSid(
p_szFSidId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_dtmIn timestamp,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szHelperId BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_szNoBKB BOS_DT_szId,
p_decRitKe numeric,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FSid
SET 
szSalesOrgId = p_szSalesOrgId,
dtmIn = p_dtmIn,
szLocationType = p_szLocationType,
szLocationId = p_szLocationId,
szStockTypeId = p_szStockTypeId,
szVehicleId = p_szVehicleId,
szDriverId = p_szDriverId,
bVoid=p_bVoid,
bApplied=p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
szFAdjustmentId = p_szFAdjustmentId,
szAdjustedById = p_szAdjustedById,
szAdjustToId = p_szAdjustToId,
szDescription=p_szDescription,

szHelperId = p_szHelperId,
szHelperId_2 = p_szHelperId_2,
szHelperId_3 = p_szHelperId_3,

szNoBKB	= p_szNoBKB,
decRitKe = p_decRitKe,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFSidId = p_szFSidId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_UpdateFSid_014(
p_szFSidId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_dtmIn timestamp,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szHelperId BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_szNoBKB BOS_DT_szId,
p_decRitKe numeric,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FSid
SET 
szSalesOrgId = p_szSalesOrgId,
dtmIn = p_dtmIn,
szLocationType = p_szLocationType,
szLocationId = p_szLocationId,
szStockTypeId = p_szStockTypeId,
szVehicleId = p_szVehicleId,
szDriverId = p_szDriverId,
bVoid=p_bVoid,
bApplied=p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
szFAdjustmentId = p_szFAdjustmentId,
szAdjustedById = p_szAdjustedById,
szAdjustToId = p_szAdjustToId,
szDescription=p_szDescription,

szHelperId = p_szHelperId,
szHelperId_2 = p_szHelperId_2,
szHelperId_3 = p_szHelperId_3,

szNoBKB    = p_szNoBKB,
decRitKe = p_decRitKe,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFSidId = p_szFSidId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSid_UpdateFSidForAdjustment(
p_szFSidId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FSID
SET 
szFAdjustmentId = p_szFAdjustmentId,
szAdjustedById = p_szAdjustedById

WHERE 
szFSidId = p_szFSidId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_CreateFSod(
p_szFSodId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szRefDocId BOS_DT_szId,
p_dtmOut timestamp,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szHelperId BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSod
(
szFSodId,
szSalesOrgId,
szRefDocId,
dtmOut,
szLocationType,
szLocationId,
szStockTypeId,
szVehicleId,
szDriverId,
szFAdjustmentId,
szAdjustedById,
szAdjustToId,
szDescription,
szHelperId,
szHelperId_2,
szHelperId_3,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFSodId,
p_szSalesOrgId,
p_szRefDocId,
p_dtmOut,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_szVehicleId,
p_szDriverId,
p_szFAdjustmentId,
p_szAdjustedById,
p_szAdjustToId,
p_szDescription,
p_szHelperId,
p_szHelperId_2,
p_szHelperId_3,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_CreateFSod_014(
p_szFSodId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szRefDocId BOS_DT_szId,
p_dtmOut timestamp,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szHelperId BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSod
(
szFSodId,
szSalesOrgId,
szRefDocId,
dtmOut,
szLocationType,
szLocationId,
szStockTypeId,
szVehicleId,
szDriverId,
szFAdjustmentId,
szAdjustedById,
szAdjustToId,
szDescription,
szHelperId,
szHelperId_2,
szHelperId_3,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFSodId,
p_szSalesOrgId,
p_szRefDocId,
p_dtmOut,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_szVehicleId,
p_szDriverId,
p_szFAdjustmentId,
p_szAdjustedById,
p_szAdjustToId,
p_szDescription,
p_szHelperId,
p_szHelperId_2,
p_szHelperId_3,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_CreateFSodItem(
p_szFSodId BOS_DT_szId,
p_btItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSodItem
(
szFSodId,
btItemNumber,
szProductId,
decQty,
decUomQty,
szUomId,
szParentId
)
VALUES
(
p_szFSodId,
p_btItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_szParentId,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_CreateFSodItem_014(
p_szFSodId BOS_DT_szId,
p_btItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSodItem
(
szFSodId,
btItemNumber,
szProductId,
decQty,
decUomQty,
szUomId,
szParentId
)
VALUES
(
p_szFSodId,
p_btItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_szParentId,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_CreateFSodItemLotQty(
p_szFSodId BOS_DT_szId,
p_btItemNumber smallint,
p_szLotId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSodItemLotQty
(
szFSodId,
btItemNumber,
szLotId,
decQty,
)
VALUES
(
p_szFSodId,
p_btItemNumber,
p_szLotId,
p_decQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_CreateFSodItemSn(
p_szFSodId BOS_DT_szId,
p_btItemNumber smallint,
p_shItemSnNumber smallint,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSodItemSn
(
szFSodId,
btItemNumber,
shItemSnNumber,
szProductSn
)
VALUES
(
p_szFSodId,
p_btItemNumber,
p_shItemSnNumber,
p_szProductSn
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_DeleteFSod(
p_szFSodId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FSod
WHERE
szFSodId=p_szFSodId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_DeleteFSodItem(
p_szFSodId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FSodItem
WHERE
szFSodId=p_szFSodId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_DeleteFSodItemLotQty(
p_szFSodId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_INV_FSodItemLotQty
WHERE
szFSodId = p_szFSodId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_DeleteFSodItemSn(
p_szFSodId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FSodItemSn
WHERE
szFSodId=p_szFSodId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_GetFSod(
p_szFSodId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_FSod.szFSodId,
BOS_INV_FSod.szSalesOrgId,
BOS_INV_FSod.szRefDocId,
BOS_INV_FSod.dtmOut,

BOS_INV_FSod.szLocationType,
BOS_INV_FSod.szLocationId,
Wh.szName as szWarehouseNm_J,

BOS_INV_FSod.szStockTypeId,

BOS_INV_FSod.szVehicleId,
BOS_INV_Vehicle.szPoliceNo as szVehiclePoliceNo_J,

BOS_INV_FSod.szDriverId,
BOS_PI_Employee.szName as szDriverNm_J,

BOS_INV_FSod.szFAdjustmentId,
BOS_INV_FSod.szAdjustedById,
BOS_INV_FSod.szAdjustToId,
BOS_INV_FSod.szDescription,

BOS_INV_FSod.szHelperId,
BOS_PI_Employee1.szName as szHelperNm,

BOS_INV_FSod.szHelperId_2,
BOS_PI_Employee2.szName as szHelperNm_2,

BOS_INV_FSod.szHelperId_3,
BOS_PI_Employee3.szName as szHelperNm_3,

BOS_INV_FSod.bResultFrTransfer,
BOS_INV_FSod.bVoid,
BOS_GEN_Approved.bApproved,
BOS_INV_FSod.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FSod.btPrintedCount,
BOS_INV_FSod.bTransferred,
BOS_INV_FSod.szCompanyId,
BOS_INV_FSod.szWorkplaceId,
BOS_INV_FSod.szTaxEntityId,
BOS_INV_FSod.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FSod.dtmCreated,
BOS_INV_FSod.bSystemCreated,

BOS_INV_FSod.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FSod.dtmLastUpdated,
BOS_INV_FSod.bAlreadyTransferred

FROM
(BOS_INV_FSod LEFT JOIN BOS_GEN_Approved ON BOS_INV_FSod.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
LEFT JOIN BOS_GL_FJournalTrans ON BOS_INV_FSod.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_PI_Employee ON BOS_INV_FSod.szDriverId = BOS_PI_Employee.szEmployeeId

LEFT JOIN BOS_PI_Employee BOS_PI_Employee1 ON BOS_INV_FSod.szHelperId   = BOS_PI_Employee1.szEmployeeId
LEFT JOIN BOS_PI_Employee BOS_PI_Employee2 ON BOS_INV_FSod.szHelperId_2 = BOS_PI_Employee2.szEmployeeId
LEFT JOIN BOS_PI_Employee BOS_PI_Employee3 ON BOS_INV_FSod.szHelperId_3 = BOS_PI_Employee3.szEmployeeId

LEFT JOIN BOS_INV_Vehicle ON BOS_INV_FSod.szVehicleId = BOS_INV_Vehicle.szVehicleId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FSod.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FSod.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FSod.szUserId

LEFT JOIN BOS_INV_Warehouse AS Wh ON Wh.szWarehouseId = BOS_INV_FSod.szLocationId
WHERE
BOS_INV_FSod.szFSodId = p_szFSodId

-- ==================================================================

set ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_GetFSod_014(
p_szFSodId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_FSod.szFSodId,
BOS_INV_FSod.szSalesOrgId,
BOS_INV_FSod.szRefDocId,
BOS_INV_FSod.dtmOut,

BOS_INV_FSod.szLocationType,
BOS_INV_FSod.szLocationId,
Wh.szName as szWarehouseNm_J,

BOS_INV_FSod.szStockTypeId,

BOS_INV_FSod.szVehicleId,
BOS_INV_Vehicle.szPoliceNo as szVehiclePoliceNo_J,

BOS_INV_FSod.szDriverId,
BOS_PI_Employee.szName as szDriverNm_J,

BOS_INV_FSod.szFAdjustmentId,
BOS_INV_FSod.szAdjustedById,
BOS_INV_FSod.szAdjustToId,
BOS_INV_FSod.szDescription,

BOS_INV_FSod.szHelperId,
BOS_PI_Employee1.szName as szHelperNm,

BOS_INV_FSod.szHelperId_2,
BOS_PI_Employee2.szName as szHelperNm_2,

BOS_INV_FSod.szHelperId_3,
BOS_PI_Employee3.szName as szHelperNm_3,

BOS_INV_FSod.bResultFrTransfer,
BOS_INV_FSod.bVoid,
BOS_GEN_Approved.bApproved,
BOS_INV_FSod.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FSod.btPrintedCount,
BOS_INV_FSod.bTransferred,
BOS_INV_FSod.szCompanyId,
BOS_INV_FSod.szWorkplaceId,
BOS_INV_FSod.szTaxEntityId,
BOS_INV_FSod.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FSod.dtmCreated,
BOS_INV_FSod.bSystemCreated,

BOS_INV_FSod.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FSod.dtmLastUpdated,
BOS_INV_FSod.bAlreadyTransferred

FROM
(BOS_INV_FSod LEFT JOIN BOS_GEN_Approved ON BOS_INV_FSod.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
LEFT JOIN BOS_GL_FJournalTrans ON BOS_INV_FSod.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_PI_Employee ON BOS_INV_FSod.szDriverId = BOS_PI_Employee.szEmployeeId

LEFT JOIN BOS_PI_Employee BOS_PI_Employee1 ON BOS_INV_FSod.szHelperId   = BOS_PI_Employee1.szEmployeeId
LEFT JOIN BOS_PI_Employee BOS_PI_Employee2 ON BOS_INV_FSod.szHelperId_2 = BOS_PI_Employee2.szEmployeeId
LEFT JOIN BOS_PI_Employee BOS_PI_Employee3 ON BOS_INV_FSod.szHelperId_3 = BOS_PI_Employee3.szEmployeeId

LEFT JOIN BOS_INV_Vehicle ON BOS_INV_FSod.szVehicleId = BOS_INV_Vehicle.szVehicleId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FSod.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FSod.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FSod.szUserId

LEFT JOIN BOS_INV_Warehouse AS Wh ON Wh.szWarehouseId = BOS_INV_FSod.szLocationId
WHERE
BOS_INV_FSod.szFSodId = p_szFSodId

-- ==================================================================

set ANSI_NULLS ON


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_GetFSodItemLotQty(
p_szFSodId BOS_DT_szId,
p_btItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLotId,
decQty


FROM 
BOS_INV_FSodItemLotQty

WHERE 
szFSodId = p_szFSodId And btItemNumber = p_btItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_GetFSodItemSn(
p_szFSodId BOS_DT_szId,
p_btItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemSnNumber,
szProductSn


FROM 
BOS_INV_FSodItemSn

WHERE 
szFSodId=p_szFSodId AND btItemNumber=p_btItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_GetListOfFSod()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSodId,
dtmOut

FROM 
BOS_INV_FSod

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_IsFSodExist(
p_szFSodId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSodId

FROM 
BOS_INV_FSod
WHERE 
szFSodId=p_szFSodId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_LockFSod(
p_szFSodId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FSod
SET 
szDescription=szDescription
WHERE 
szFSodId=p_szFSodId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_UpdateFSod(
p_szFSodId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szRefDocId BOS_DT_szId,
p_dtmOut timestamp,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szHelperId BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FSod
SET 
szSalesOrgId = p_szSalesOrgId,
szRefDocId = p_szRefDocId,
dtmOut = p_dtmOut,
szLocationType = p_szLocationType,
szLocationId = p_szLocationId,
szStockTypeId = p_szStockTypeId,
szVehicleId = p_szVehicleId,
szDriverId = p_szDriverId,
szDescription = p_szDescription,

szHelperId = p_szHelperId,
szHelperId_2 = p_szHelperId_2,
szHelperId_3 = p_szHelperId_3,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
szFAdjustmentId = p_szFAdjustmentId,
szAdjustedById = p_szAdjustedById ,
szAdjustToId = p_szAdjustToId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFSodId = p_szFSodId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_UpdateFSod_014(
p_szFSodId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szRefDocId BOS_DT_szId,
p_dtmOut timestamp,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szHelperId BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FSod
SET 
szSalesOrgId = p_szSalesOrgId,
szRefDocId = p_szRefDocId,
dtmOut = p_dtmOut,
szLocationType = p_szLocationType,
szLocationId = p_szLocationId,
szStockTypeId = p_szStockTypeId,
szVehicleId = p_szVehicleId,
szDriverId = p_szDriverId,
szDescription = p_szDescription,

szHelperId = p_szHelperId,
szHelperId_2 = p_szHelperId_2,
szHelperId_3 = p_szHelperId_3,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
szFAdjustmentId = p_szFAdjustmentId,
szAdjustedById = p_szAdjustedById ,
szAdjustToId = p_szAdjustToId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFSodId = p_szFSodId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSod_UpdateFSodForAdjustment(
p_szFSodId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FSOD
SET 
szFAdjustmentId = p_szFAdjustmentId,
szAdjustedById = p_szAdjustedById
WHERE 
szFSodId = p_szFSodId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_CreateFSrc(
p_szFSrcId BOS_DT_szId,
p_dtmReceipt timestamp,
p_szPoId BOS_DT_szId,
p_szSupplierId BOS_DT_szId,
p_szWarehouseId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szRefDn varchar,
p_szCarrierId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szVehicleNumber varchar,
p_szDriverNm varchar,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szCcyId BOS_DT_szSmallId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSrc
(
szFSrcId,
dtmReceipt,
szPoId,
szSupplierId,
szWarehouseId,
szStockTypeId,
szRefDn,
szCarrierId,
szVehicleId,
szDriverId,
szVehicleNumber,
szDriverNm,
szFAdjustmentId,
szAdjustedById,
szAdjustToId,
szDescription,
szCcyId,
-- Doc status.,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
)
VALUES
(
p_szFSrcId,
p_dtmReceipt,
p_szPoId,
p_szSupplierId,
p_szWarehouseId,
p_szStockTypeId,
p_szRefDn,
p_szCarrierId,
p_szVehicleId,
p_szDriverId,
p_szVehicleNumber,
p_szDriverNm,
p_szFAdjustmentId,
p_szAdjustedById,
p_szAdjustToId,
p_szDescription,
p_szCcyId,
-- Doc status.,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_CreateFSrcItem(
p_szFSrcId BOS_DT_szId,
p_shItemNumber smallint,
p_szRefProductId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decAmount,
p_bTaxable BOS_DT_bBoolean,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSrcItem
(
szFSrcId,
shItemNumber,
szRefProductId,
szProductId,
decQty,
decUomQty,
szUomId,
decPrice,
bTaxable,
szParentId
)
VALUES
(
p_szFSrcId,
p_shItemNumber,
p_szRefProductId,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_decPrice,
p_bTaxable,
p_szParentId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_CreateFSrcItem_014(
p_szFSrcId BOS_DT_szId,
p_shItemNumber smallint,
p_szRefProductId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decAmount,
p_bTaxable BOS_DT_bBoolean,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSrcItem
(
szFSrcId,
shItemNumber,
szRefProductId,
szProductId,
decQty,
decUomQty,
szUomId,
decPrice,
bTaxable,
szParentId
)
VALUES
(
p_szFSrcId,
p_shItemNumber,
p_szRefProductId,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_decPrice,
p_bTaxable,
p_szParentId,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_CreateFSrcItem_015(
p_szFSrcId BOS_DT_szId,
p_shItemNumber smallint,
p_szRefProductId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decAmount,
p_bTaxable BOS_DT_bBoolean,
p_szParentId BOS_DT_szId,
p_szDistProductId BOS_DT_szId,
p_decDistQty BOS_DT_decAmount,
p_decDistPrice BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSrcItem
(
szFSrcId,
shItemNumber,
szRefProductId,
szProductId,
decQty,
decUomQty,
szUomId,
decPrice,
bTaxable,
szParentId,
szDistProductId,
decDistQty,
decDistPrice
)
VALUES
(
p_szFSrcId,
p_shItemNumber,
p_szRefProductId,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_decPrice,
p_bTaxable,
p_szParentId,
p_szDistProductId,
p_decDistQty,
p_decDistPrice,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_CreateFSrcItemLotInfo(
p_szFSrcId BOS_DT_szId,
p_shItemNumber smallint,
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szLotTypeId BOS_DT_szId,
p_szProductionCode varchar,
p_decLotStrength BOS_DT_decAmount,
p_dtmExpired timestamp,
p_szLotStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSrcItemLotInfo
(
szFSrcId,
shItemNumber,
szLotId,
szProductId,
szLotTypeId,
szProductionCode,
decLotStrength,
dtmExpired,
szLotStatus
)
VALUES
(
p_szFSrcId,
p_shItemNumber,
p_szLotId,
p_szProductId,
p_szLotTypeId,
p_szProductionCode,
p_decLotStrength,
p_dtmExpired,
p_szLotStatus
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_CreateFSrcItemLotInfo_014(
p_szFSrcId BOS_DT_szId,
p_shItemNumber smallint,
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szLotTypeId BOS_DT_szId,
p_szProductionCode varchar,
p_decLotStrength BOS_DT_decAmount,
p_dtmExpired timestamp,
p_szLotStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSrcItemLotInfo
(
szFSrcId,
shItemNumber,
szLotId,
szProductId,
szLotTypeId,
szProductionCode,
decLotStrength,
dtmExpired,
szLotStatus
)
VALUES
(
p_szFSrcId,
p_shItemNumber,
p_szLotId,
p_szProductId,
p_szLotTypeId,
p_szProductionCode,
p_decLotStrength,
p_dtmExpired,
p_szLotStatus,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_CreateFSrcItemLotQty(
p_szFSrcId BOS_DT_szId,
p_shItemNumber smallint,
p_szLotId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSrcItemLotQty
(
szFSrcId,
shItemNumber,
szLotId,
decQty
)
VALUES
(
p_szFSrcId,
p_shItemNumber,
p_szLotId,
p_decQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_CreateFSrcItemSn(
p_szFSrcId BOS_DT_szId,
p_shItemNumber smallint,
p_shItemSnNumber smallint,
p_szProductSn varchar)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSrcItemSn
(
szFSrcId,
shItemNumber,
shItemSnNumber,
szProductSn
)
VALUES
(
p_szFSrcId,
p_shItemNumber,
p_shItemSnNumber,
p_szProductSn
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_DeleteFSrc(
p_szFSrcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_INV_FSrc
WHERE
szFSrcId = p_szFSrcId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_DeleteFSrcItem(
p_szFSrcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_INV_FSrcItem
WHERE
szFSrcId = p_szFSrcId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_DeleteFSrcItemLotInfo(
p_szFSrcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FSrcItemLotInfo
WHERE
szFSrcId = p_szFSrcId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_DeleteFSrcItemLotQty(
p_szFSrcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_FSrcItemLotQty
WHERE
szFSrcId = p_szFSrcId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_DeleteFSrcItemSn(
p_szFSrcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_INV_FSrcItemSn
WHERE
szFSrcId = p_szFSrcId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_GetFSrc(
p_szFSrcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
select
BOS_INV_FSrc.szFSrcId,
BOS_INV_FSrc.dtmReceipt,
BOS_INV_FSrc.szPoId,
BOS_INV_FSrc.szSupplierId,
BOS_AP_Supplier.szName as szSupplierNm,
BOS_INV_FSrc.szWarehouseId,
BOS_INV_FSrc.szStockTypeId,
BOS_INV_FSrc.szRefDn,
BOS_INV_FSrc.szCarrierId,
BOS_INV_FSrc.szVehicleId,
BOS_INV_FSrc.szDriverId,
BOS_INV_FSrc.szVehicleNumber,
BOS_INV_FSrc.szDriverNm,
BOS_INV_FSrc.szFAdjustmentId,
BOS_INV_FSrc.szAdjustedById,
BOS_INV_FSrc.szAdjustToId,
BOS_INV_FSrc.szDescription,

BOS_INV_FSrc.szCcyId,
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat_J,

-- Doc status.
BOS_INV_FSrc.bResultFrTransfer,
BOS_INV_FSrc.bVoid,
BOS_GEN_Approved.bApproved,
BOS_INV_FSrc.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FSrc.btPrintedCount,
BOS_INV_FSrc.bTransferred,
BOS_INV_FSrc.szCompanyId, 
BOS_INV_FSrc.szWorkplaceId,
BOS_INV_FSrc.szTaxEntityId,
BOS_INV_FSrc.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FSrc.dtmCreated,
BOS_INV_FSrc.bSystemCreated,
BOS_INV_FSrc.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FSrc.dtmLastUpdated,
BOS_INV_FSrc.bAlreadyTransferred

from
BOS_INV_FSrc 
left join BOS_GEN_Approved on BOS_INV_FSrc.gdApprovedId = BOS_GEN_Approved.gdApprovedId
left join BOS_GL_FJournalTrans on BOS_INV_FSrc.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
left join BOS_AP_Supplier on BOS_INV_FSrc.szSupplierId = BOS_AP_Supplier.szSuppId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FSrc.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FSrc.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FSrc.szUserId
left join BOS_CU_Currency on BOS_CU_Currency.szCcyId = BOS_INV_FSrc.szCcyId

where
szFSrcId = p_szFSrcId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_GetFSrcItem(
p_szFSrcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_GetFSrcItem_014(
p_szFSrcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

select
BOS_INV_FSrcItem.szFSrcId,
BOS_INV_FSrcItem.shItemNumber,
BOS_INV_FSrcItem.szRefProductId,
BOS_INV_FSrcItem.szProductId,

BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szNickName As szProductNickName_J,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
PPI.szUomId AS szProductPurchInfoUomId_J,

BOS_INV_FSrcItem.decQty,
BOS_INV_FSrcItem.decUomQty,

BOS_INV_FSrcItem.szUomId,
BOS_INV_FSrcItem.decPrice,
BOS_INV_FSrcItem.bTaxable,

BOS_INV_FSrcItem.szParentId,
parent.szName AS szParentNm_J

from
BOS_INV_FSrcItem 
left join BOS_INV_Product on BOS_INV_Product.szProductId = 

BOS_INV_FSrcItem.szProductId
LEFT JOIN BOS_INV_ProductPurchaseInfo AS PPI ON PPI.szProductId = 

BOS_INV_FSrcItem.szProductId
left join BOS_INV_FSrc on BOS_INV_FSrc.szFSrcId = BOS_INV_FSrcItem.szFSrcId
left join BOS_INV_Product AS parent on BOS_INV_FSrcItem.szParentId = 

parent.szProductId

where
BOS_INV_FSrcItem.szFSrcId = p_szFSrcId


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_GetFSrcItem_015(
p_szFSrcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

select
BOS_INV_FSrcItem.szFSrcId,
BOS_INV_FSrcItem.shItemNumber,
BOS_INV_FSrcItem.szRefProductId,
BOS_INV_FSrcItem.szProductId,

BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szNickName As szProductNickName_J,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
PPI.szUomId AS szProductPurchInfoUomId_J,

BOS_INV_FSrcItem.decQty,
BOS_INV_FSrcItem.decUomQty,

BOS_INV_FSrcItem.szUomId,
BOS_INV_FSrcItem.decPrice,
BOS_INV_FSrcItem.bTaxable,

BOS_INV_FSrcItem.szParentId,
parent.szName AS szParentNm_J,

BOS_INV_FSrcItem.szDistProductId,
BOS_INV_FSrcItem.decDistQty,
BOS_INV_FSrcItem.decDistPrice

from
BOS_INV_FSrcItem 
left join BOS_INV_Product on BOS_INV_Product.szProductId = 

BOS_INV_FSrcItem.szProductId
LEFT JOIN BOS_INV_ProductPurchaseInfo AS PPI ON PPI.szProductId = 

BOS_INV_FSrcItem.szProductId
left join BOS_INV_FSrc on BOS_INV_FSrc.szFSrcId = BOS_INV_FSrcItem.szFSrcId
left join BOS_INV_Product AS parent on BOS_INV_FSrcItem.szParentId = 

parent.szProductId

where
BOS_INV_FSrcItem.szFSrcId = p_szFSrcId


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_GetFSrcItemLotInfo(
p_szFSrcId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_FSrcItemLotInfo.szLotId,
BOS_INV_FSrcItemLotInfo.szProductId,
BOS_INV_Product.szName as szProductNm,
BOS_INV_FSrcItemLotInfo.szLotTypeId,
BOS_INV_FSrcItemLotInfo.szProductionCode,
BOS_INV_FSrcItemLotInfo.decLotStrength,
BOS_INV_FSrcItemLotInfo.dtmExpired,
BOS_INV_FSrcItemLotInfo.szLotStatus

FROM 
BOS_INV_FSrcItemLotInfo left join BOS_INV_Product on BOS_INV_FSrcItemLotInfo.szProductId = BOS_INV_Product.szProductId
WHERE 
szFSrcId = p_szFSrcId And shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_GetFSrcItemLotQty(
p_szFSrcId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLotId,
decQty

FROM 
BOS_INV_FSrcItemLotQty
WHERE 
szFSrcId = p_szFSrcId AND shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_GetFSrcItemSn(
p_szFSrcId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemSnNumber,
szProductSn


FROM 
BOS_INV_FSrcItemSn
WHERE 
szFSrcId = p_szFSrcId and shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_GetListOfFSrc()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSrcId,
dtmReceipt

FROM 
BOS_INV_FSrc

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_IsFSrcExist(
p_szFSrcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSrcId

FROM 
BOS_INV_FSrc
WHERE 
szFSrcId = p_szFSrcId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_LockFSrc(
p_szFSrcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FSrc
SET 
bTransferred = bTransferred
WHERE 
szFSrcId = p_szFSrcId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_UpdateFSrc(
p_szFSrcId BOS_DT_szId,
p_dtmReceipt timestamp,
p_szPoId BOS_DT_szId,
p_szSupplierId BOS_DT_szId,
p_szWarehouseId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szRefDn varchar,
p_szCarrierId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szVehicleNumber varchar,
p_szDriverNm varchar,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szCcyId BOS_DT_szSmallId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FSrc
SET 
dtmReceipt = p_dtmReceipt,
szPoId = p_szPoId,
szSupplierId = p_szSupplierId,
szWarehouseId = p_szWarehouseId,
szStockTypeId = p_szStockTypeId,
szRefDn = p_szRefDn,
szCarrierId = p_szCarrierId,
szVehicleId = p_szVehicleId,
szDriverId = p_szDriverId,
szVehicleNumber = p_szVehicleNumber,
szDriverNm = p_szDriverNm,
szFAdjustmentId=p_szFAdjustmentId,
szAdjustedById=p_szAdjustedById,
szAdjustToId=p_szAdjustToId,
szDescription = p_szDescription,
szCcyId = p_szCcyId,

-- Doc status.
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFSrcId = p_szFSrcId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrc_UpdateFSrcForAdjustment(
p_szFSrcId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FSRC
SET 
szFAdjustmentId = p_szFAdjustmentId,
szAdjustedById = p_szAdjustedById
WHERE 
szFSrcId = p_szFSrcId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_CreateFSrt(
p_szFSrtId BOS_DT_szId,
p_dtmReturn timestamp,
p_szStRetType BOS_DT_szSmallId,
p_szPoId BOS_DT_szId,
p_szSupplierId BOS_DT_szId,
p_szWarehouseId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szRefDn varchar,
p_szCarrierId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szVehicleNo varchar,
p_szDriverNm varchar,
p_szTrnId varchar,
p_szDocId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSrt
(
szFSrtId,
dtmReturn,
szStRetType,
szPoId,
szSupplierId,
szWarehouseId,
szStockTypeId,
szRefDn,
szCarrierId,
szVehicleId,
szDriverId,
szVehicleNo,
szDriverNm,
szTrnId,
szDocId,
szFAdjustmentId,
szAdjustedById,
szAdjustToId,
szDescription,
-- Doc status.,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
)
VALUES
(
p_szFSrtId,
p_dtmReturn,
p_szStRetType,
p_szPoId,
p_szSupplierId,
p_szWarehouseId,
p_szStockTypeId,
p_szRefDn,
p_szCarrierId,
p_szVehicleId,
p_szDriverId,
p_szVehicleNo,
p_szDriverNm,
p_szTrnId,
p_szDocId,
p_szFAdjustmentId,
p_szAdjustedById,
p_szAdjustToId,
p_szDescription,
-- Doc status.,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_CreateFSrt_013(
p_szFSrtId BOS_DT_szId,
p_dtmReturn timestamp,
p_szStRetType BOS_DT_szSmallId,
p_szPoId BOS_DT_szId,
p_szSupplierId BOS_DT_szId,
p_szWarehouseId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szRefDn varchar,
p_szCarrierId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szVehicleNo varchar,
p_szDriverNm varchar,
p_szTrnId varchar,
p_szDocId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSrt
(
szFSrtId,
dtmReturn,
szStRetType,
szPoId,
szSupplierId,
szWarehouseId,
szStockTypeId,
szRefDn,
szCarrierId,
szVehicleId,
szDriverId,
szVehicleNo,
szDriverNm,
szTrnId,
szDocId,
szFAdjustmentId,
szAdjustedById,
szAdjustToId,
szDescription,
-- Doc status.,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
)
VALUES
(
p_szFSrtId,
p_dtmReturn,
p_szStRetType,
p_szPoId,
p_szSupplierId,
p_szWarehouseId,
p_szStockTypeId,
p_szRefDn,
p_szCarrierId,
p_szVehicleId,
p_szDriverId,
p_szVehicleNo,
p_szDriverNm,
p_szTrnId,
p_szDocId,
p_szFAdjustmentId,
p_szAdjustedById,
p_szAdjustToId,
p_szDescription,
-- Doc status.,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_CreateFSrtItem(
p_szFSrtId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSrtItem
(
szFSrtId,
shItemNumber,
szProductId,
decQty,
decUomQty,
szUomId
)
VALUES
(
p_szFSrtId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_CreateFSrtItem_013(
p_szFSrtId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szDistProductId BOS_DT_szId,
p_decDistQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSrtItem
(
szFSrtId,
shItemNumber,
szProductId,
decQty,
decUomQty,
szUomId,
szDistProductId,
decDistQty
)
VALUES
(
p_szFSrtId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_szDistProductId,
p_decDistQty,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_CreateFSrtItemLotQty(
p_szFSrtId BOS_DT_szId,
p_shItemNumber smallint,
p_szLotId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSrtItemLotQty
(
szFSrtId,
shItemNumber,
szLotId,
decQty
)
VALUES
(
p_szFSrtId,
p_shItemNumber,
p_szLotId,
p_decQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_CreateFSrtItemSn(
p_szFSrtId BOS_DT_szId,
p_shItemNumber smallint,
p_shItemSnNumber smallint,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FSrtItemSn
(
szFSrtId,
shItemNumber,
shItemSnNumber,
szProductSn
)
VALUES
(
p_szFSrtId,
p_shItemNumber,
p_shItemSnNumber,
p_szProductSn
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_DeleteFSrt(
p_szFSrtId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FSrt
WHERE
szFSrtId = p_szFSrtId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_DeleteFSrtItem(
p_szFSrtId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FSrtItem
WHERE
szFSrtId = p_szFSrtId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_DeleteFSrtItemLotQty(
p_szFSrtId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FSrtItemLotQty
WHERE
szFSrtId = p_szFSrtId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_DeleteFSrtItemSn(
p_szFSrtId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FSrtItemSn
WHERE
szFSrtId = p_szFSrtId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_GetFSrt(
p_szFSrtId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
select
BOS_INV_FSrt.szFSrtId,
BOS_INV_FSrt.szStRetType,
BOS_INV_FSrt.dtmReturn,
BOS_INV_FSrt.szPoId,
BOS_INV_FSrt.szSupplierId,
BOS_AP_Supplier.szName as szSupplierNm,
BOS_INV_FSrt.szWarehouseId,
BOS_INV_FSrt.szStockTypeId,
BOS_INV_FSrt.szRefDn,
BOS_INV_FSrt.szCarrierId,
BOS_INV_FSrt.szVehicleId,
BOS_INV_FSrt.szDriverId,
BOS_INV_FSrt.szVehicleNo,
BOS_INV_FSrt.szDriverNm,
BOS_INV_FSrt.szTrnId,
BOS_INV_FSrt.szDocId,
BOS_INV_FSrt.szFAdjustmentId,
BOS_INV_FSrt.szAdjustedById,
BOS_INV_FSrt.szAdjustToId,
BOS_INV_FSrt.szDescription,

-- Doc status.
BOS_INV_FSrt.bResultFrTransfer,
BOS_INV_FSrt.bVoid,
BOS_GEN_Approved.bApproved,
BOS_INV_FSrt.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FSrt.btPrintedCount,
BOS_INV_FSrt.bTransferred,
BOS_INV_FSrt.szCompanyId, 
BOS_INV_FSrt.szWorkplaceId,
BOS_INV_FSrt.szTaxEntityId,
BOS_INV_FSrt.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FSrt.dtmCreated,
BOS_INV_FSrt.bSystemCreated,
BOS_INV_FSrt.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FSrt.dtmLastUpdated,
BOS_INV_FSrt.bAlreadyTransferred
from
(BOS_INV_FSrt left join BOS_GEN_Approved on BOS_INV_FSrt.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
left join BOS_GL_FJournalTrans on BOS_INV_FSrt.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
left join BOS_AP_Supplier on BOS_INV_FSrt.szSupplierId = BOS_AP_Supplier.szSuppId 
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FSrt.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FSrt.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FSrt.szUserId
where
szFSrtId = p_szFSrtId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_GetFSrtItem(
p_szFSrtId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_INV_FSrtItem.szFSrtId,
BOS_INV_FSrtItem.shItemNumber,
BOS_INV_FSrtItem.szProductId,

BOS_INV_Product.szName AS szProductNm,
BOS_INV_Product.szNickName As szProductNickName_J,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
PPI.szUomId AS szProductPurchInfoUomId_J,

BOS_INV_FSrtItem.decQty,
BOS_INV_FSrtItem.decUomQty,

BOS_INV_FSrtItem.szUomId
FROM
BOS_INV_FSrtItem 
LEFT JOIN BOS_INV_Product on BOS_INV_Product.szProductId = BOS_INV_FSrtItem.szProductId
LEFT JOIN BOS_INV_ProductPurchaseInfo AS PPI ON PPI.szProductId = BOS_INV_FSrtItem.szProductId
WHERE
szFSrtId = p_szFSrtId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_GetFSrtItem_013(
p_szFSrtId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_INV_FSrtItem.szFSrtId,
BOS_INV_FSrtItem.shItemNumber,
BOS_INV_FSrtItem.szProductId,

BOS_INV_Product.szName AS szProductNm,
BOS_INV_Product.szNickName As szProductNickName_J,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
PPI.szUomId AS szProductPurchInfoUomId_J,

BOS_INV_FSrtItem.decQty,
BOS_INV_FSrtItem.decUomQty,

BOS_INV_FSrtItem.szUomId,

BOS_INV_FSrtItem.szDistProductId,
BOS_INV_FSrtItem.decDistQty
FROM
BOS_INV_FSrtItem 
LEFT JOIN BOS_INV_Product on BOS_INV_Product.szProductId = BOS_INV_FSrtItem.szProductId
LEFT JOIN BOS_INV_ProductPurchaseInfo AS PPI ON PPI.szProductId = BOS_INV_FSrtItem.szProductId
WHERE
szFSrtId = p_szFSrtId


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_GetFSrtItemLotQty(
p_szFSrtId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLotId,
decQty

FROM 
BOS_INV_FSrtItemLotQty
WHERE 
szFSrtId = p_szFSrtId and shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_GetFSrtItemSn(
p_szFSrtId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemSnNumber,
szProductSn

FROM 
BOS_INV_FSrtItemSn
WHERE 
szFSrtId = p_szFSrtId AND shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_GetListOfFSrt()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSrtId,
dtmReturn

FROM 
BOS_INV_FSrt

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_IsFSrtExist(
p_szFSrtId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSrtId

FROM 
BOS_INV_FSrt
WHERE 
szFSrtId = p_szFSrtId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_LockFSrt(
p_szFSrtId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FSrt
SET 
bvoid = bvoid
WHERE 
szFSrtId = p_szFSrtId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_UpdateFSrt(
p_szFSrtId BOS_DT_szId,
p_dtmReturn timestamp,
p_szStRetType BOS_DT_szSmallId,
p_szPoId BOS_DT_szId,
p_szSupplierId BOS_DT_szId,
p_szWarehouseId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szRefDn varchar,
p_szCarrierId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szVehicleNo varchar,
p_szDriverNm varchar,
p_szTrnId varchar,
p_szDocId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FSrt
SET 
dtmReturn = p_dtmReturn,
szStRetType = p_szStRetType,
szPoId = p_szPoId,
szSupplierId = p_szSupplierId,
szWarehouseId = p_szWarehouseId,
szStockTypeId = p_szStockTypeId,
szRefDn = p_szRefDn,
szCarrierId = p_szCarrierId,
szVehicleId = p_szVehicleId,
szDriverId = p_szDriverId,
szVehicleNo = p_szVehicleNo,
szDriverNm = p_szDriverNm,
szFAdjustmentId=p_szFAdjustmentId,
szAdjustedById=p_szAdjustedById,
szAdjustToId =p_szAdjustToId,
szDescription = p_szDescription,

-- Doc status.
szTrnId = p_szTrnId,
szDocId = p_szDocId,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId
WHERE 
szFSrtId = p_szFSrtId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_UpdateFSrt_013(
p_szFSrtId BOS_DT_szId,
p_dtmReturn timestamp,
p_szStRetType BOS_DT_szSmallId,
p_szPoId BOS_DT_szId,
p_szSupplierId BOS_DT_szId,
p_szWarehouseId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szRefDn varchar,
p_szCarrierId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szVehicleNo varchar,
p_szDriverNm varchar,
p_szTrnId varchar,
p_szDocId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FSrt
SET 
dtmReturn = p_dtmReturn,
szStRetType = p_szStRetType,
szPoId = p_szPoId,
szSupplierId = p_szSupplierId,
szWarehouseId = p_szWarehouseId,
szStockTypeId = p_szStockTypeId,
szRefDn = p_szRefDn,
szCarrierId = p_szCarrierId,
szVehicleId = p_szVehicleId,
szDriverId = p_szDriverId,
szVehicleNo = p_szVehicleNo,
szDriverNm = p_szDriverNm,
szFAdjustmentId=p_szFAdjustmentId,
szAdjustedById=p_szAdjustedById,
szAdjustToId =p_szAdjustToId,
szDescription = p_szDescription,

-- Doc status.
szTrnId = p_szTrnId,
szDocId = p_szDocId,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId
WHERE 
szFSrtId = p_szFSrtId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FSrt_UpdateFSrtForAdjustment(
p_szFSrtId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FSRT
SET 
szFAdjustmentId = p_szFAdjustmentId,
szAdjustedById = p_szAdjustedById
WHERE 
szFSrtId = p_szFSrtId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_CreateFStCor(
p_szFStCorId BOS_DT_szId,
p_dtmCorrection timestamp,
p_szWarehouseId BOS_DT_szId,
p_szReason varchar,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStCor
(
szFStCorId,
dtmCorrection,
szWarehouseId,
szReason,
szDescription,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFStCorId,
p_dtmCorrection,
p_szWarehouseId,
p_szReason,
p_szDescription,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_CreateFStCorItem(
p_szFStCorId BOS_DT_szId,
p_btItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_decStockQty BOS_DT_decAmount,
p_decActualQty BOS_DT_decAmount,
p_decUomStockQty BOS_DT_decAmount,
p_decUomActualQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decCOGS BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStCorItem
(
szFStCorId,
btItemNumber,
szProductId,
szStockTypeId,
decStockQty,
decActualQty,
decUomStockQty,
decUomActualQty,
szUomId,
decCOGS
)
VALUES
(
p_szFStCorId,
p_btItemNumber,
p_szProductId,
p_szStockTypeId,
p_decStockQty,
p_decActualQty,
p_decUomStockQty,
p_decUomActualQty,
p_szUomId,
p_decCOGS
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_CreateFStCorItemLotInfo(
p_szFStCorId BOS_DT_szId,
p_btItemNumber smallint,
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szLotTypeId BOS_DT_szId,
p_szProductionCode varchar,
p_decLotStrength BOS_DT_decAmount,
p_dtmExpired timestamp,
p_szLotStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStCorItemLotInfo
(
szFStCorId,
btItemNumber,
szLotId,
szProductId,
szLotTypeId,
szProductionCode,
decLotStrength,
dtmExpired,
szLotStatus
)
VALUES
(
p_szFStCorId,
p_btItemNumber,
p_szLotId,
p_szProductId,
p_szLotTypeId,
p_szProductionCode,
p_decLotStrength,
p_dtmExpired,
p_szLotStatus
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_CreateFStCorItemLotInfo_014(
p_szFStCorId BOS_DT_szId,
p_btItemNumber smallint,
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szLotTypeId BOS_DT_szId,
p_szProductionCode varchar,
p_decLotStrength BOS_DT_decAmount,
p_dtmExpired timestamp,
p_szLotStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStCorItemLotInfo
(
szFStCorId,
btItemNumber,
szLotId,
szProductId,
szLotTypeId,
szProductionCode,
decLotStrength,
dtmExpired,
szLotStatus
)
VALUES
(
p_szFStCorId,
p_btItemNumber,
p_szLotId,
p_szProductId,
p_szLotTypeId,
p_szProductionCode,
p_decLotStrength,
p_dtmExpired,
p_szLotStatus,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_CreateFStCorItemLotQty(
p_szFStCorId BOS_DT_szId,
p_btItemNumber smallint,
p_szLotId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStCorItemLotQty
(
szFStCorId,
btItemNumber,
szLotId
decQty,
)
VALUES
(
p_szFStCorId,
p_btItemNumber,
p_szLotId
p_decQty,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_CreateFStCorItemSn(
p_szFStCorId BOS_DT_szId,
p_btItemNumber smallint,
p_shItemSnNumber smallint,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStCorItemSn
(
szFStCorId,
btItemNumber,
shItemSnNumber,
szProductSn
)
VALUES
(
p_szFStCorId,
p_btItemNumber,
p_shItemSnNumber,
p_szProductSn
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_DeleteFStCor(
p_szFStCorId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_DeleteFStCorItem(
p_szFStCorId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_FStCorItem
WHERE
szFStCorId = p_szFStCorId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_DeleteFStCorItemLotInfo(
p_szFStCorId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FStCorItemLotInfo
WHERE
szFStCorId = p_szFStCorId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_DeleteFStCorItemLotQty(
p_szFStCorId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_INV_FStCorItemLotQty
WHERE
szFStCorId = p_szFStCorId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_DeleteFStCorItemSn(
p_szFStCorId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FStCorItemSn
WHERE
szFStCorId=p_szFStCorId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_GetFStCor(
p_szFStCorId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT 
BOS_INV_FStCor.dtmCorrection,
BOS_INV_FStCor.szWarehouseId,
BOS_INV_FStCor.szReason,
BOS_INV_FStCor.szDescription,

BOS_INV_FStCor.bResultFrTransfer,
BOS_INV_FStCor.bVoid,
BOS_GEN_Approved.bApproved,
BOS_INV_FStCor.bApplied,
BOS_GL_FJournalTrans.szFJournalId AS bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FStCor.btPrintedCount,
BOS_INV_FStCor.bTransferred,
BOS_INV_FStCor.szCompanyId,
BOS_INV_FStCor.szWorkplaceId,
BOS_INV_FStCor.szTaxEntityId,
BOS_INV_FStCor.bNeedApproval,
BOS_INV_FStCor.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FStCor.dtmCreated,
BOS_INV_FStCor.bSystemCreated,
BOS_INV_FStCor.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FStCor.dtmLastUpdated,
BOS_INV_FStCor.bAlreadyTransferred

FROM
BOS_INV_FStCor LEFT JOIN BOS_GEN_Approved ON BOS_INV_FStCor.gdApprovedId=BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_INV_FStCor.szFJournalId=BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FStCor.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FStCor.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FStCor.szUserId

WHERE
BOS_INV_FStCor.szFStCorId = p_szFStCorId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_GetFStCorItem(
p_szFStCorId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_FStCorItem.btItemNumber,
BOS_INV_FStCorItem.szProductId,

BOS_INV_Product.szName AS szProductName,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,

BOS_INV_FStCorItem.szStockTypeId,

BOS_INV_FStCorItem.decStockQty,
BOS_INV_FStCorItem.decActualQty,

BOS_INV_FStCorItem.decUomStockQty,
BOS_INV_FStCorItem.decUomActualQty,

BOS_INV_FStCorItem.szUomId,

BOS_INV_FStCorItem.decCOGS


FROM 
BOS_INV_FStCorItem
LEFT JOIN BOS_INV_Product on BOS_INV_FStCorItem.szProductId = BOS_INV_Product.szProductIdLEFT JOIN BOS_INV_Product on BOS_INV_FStCorItem.szProductId = BOS_INV_Product.szProductId;

WHERE 
BOS_INV_FStCorItem.szFStCorId = p_szFStCorId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_GetFStCorItemLotInfo(
p_szFStCorId BOS_DT_szId,
p_btItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_FStCorItemLotInfo.szLotId,
BOS_INV_FStCorItemLotInfo.szProductId,
BOS_INV_Product.szName as szProductNm,
BOS_INV_FStCorItemLotInfo.szLotTypeId,
BOS_INV_FStCorItemLotInfo.szProductionCode,
BOS_INV_FStCorItemLotInfo.decLotStrength,
BOS_INV_FStCorItemLotInfo.dtmExpired,
BOS_INV_FStCorItemLotInfo.szLotStatus

FROM 
BOS_INV_FStCorItemLotInfo left join BOS_INV_Product on BOS_INV_FStCorItemLotInfo.szProductId = BOS_INV_Product.szProductId
WHERE 
szFStCorId = p_szFStCorId And btItemNumber = p_btItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_GetFStCorItemLotQty(
p_szFStCorId BOS_DT_szId,
p_btItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLotId,
decQty

FROM 
BOS_INV_FStCorItemLotQty
WHERE 
szFStCorId = p_szFStCorId And btItemNumber = p_btItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_GetFStCorItemSn(
p_szFStCorId BOS_DT_szId,
p_btItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemSnNumber,
szProductSn


FROM 
BOS_INV_FStCorItemSn
WHERE 
szFStCorId=p_szFStCorId AND btItemNumber=p_btItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_GetListOfFStCor()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFStCorId,
dtmCorrection

FROM 
BOS_INV_FStCor

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_IsFStCorExist(
p_szFStCorId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFStCorId

FROM 
BOS_INV_FStCor
WHERE 
szFStCorId=p_szFStCorId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_LockFStCor(
p_szFStCorId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FStCor
SET 
szWarehouseId = szWarehouseId
WHERE 
szFStCorId=p_szFStCorId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStCor_UpdateFStCor(
p_szFStCorId BOS_DT_szId,
p_dtmCorrection timestamp,
p_szWarehouseId BOS_DT_szId,
p_szReason varchar,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FStCor
SET 
szFStCorId=p_szFStCorId,
dtmCorrection=p_dtmCorrection,
szWarehouseId=p_szWarehouseId,
szReason=p_szReason,
szDescription = p_szDescription,

bVoid=p_bVoid,
bApplied=p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFStCorId=p_szFStCorId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_CreateFStIn(
p_szFStInId BOS_DT_szId,
p_dtmTransfer timestamp,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szCarrierId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szDriverNm BOS_DT_szName,
p_szPoliceNo BOS_DT_szSmallName,
p_szRefDoc BOS_DT_szId,
p_szFDnFileName BOS_DT_szFullPath,
p_szFDnId BOS_DT_szId,
p_szFDn2Id BOS_DT_szId,
p_szSenderWorkplaceId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer smallint,
p_bVoid smallint,
p_bApproved smallint,
p_bApplied smallint,
p_bJournal smallint,
p_bPosted smallint,
p_btPrintedCount smallint,
p_bTransferred smallint,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval smallint,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated smallint,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStIn
(
szFStInId,
dtmTransfer,
szLocationType,
szLocationId,
szStockTypeId,
szCarrierId,
szVehicleId,
szDriverId,
szDriverNm,
szPoliceNo,
szRefDoc,
szFDnFileName,
szFDnId,
szFDn2Id,
szSenderWorkplaceId,
szFAdjustmentId,
szAdjustedById,
szAdjustToId,
szDescription,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFStInId,
p_dtmTransfer,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_szCarrierId,
p_szVehicleId,
p_szDriverId,
p_szDriverNm,
p_szPoliceNo,
p_szRefDoc,
p_szFDnFileName,
p_szFDnId,
p_szFDn2Id,
p_szSenderWorkplaceId,
p_szFAdjustmentId,
p_szAdjustedById,
p_szAdjustToId,
p_szDescription,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_CreateFStIn_013(
p_szFStInId BOS_DT_szId,
p_dtmTransfer timestamp,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szCarrierId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szDriverNm BOS_DT_szName,
p_szPoliceNo BOS_DT_szSmallName,
p_szRefDoc BOS_DT_szId,
p_szFDnFileName BOS_DT_szFullPath,
p_szFDnId BOS_DT_szId,
p_szFDn2Id BOS_DT_szId,
p_szSenderWorkplaceId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer smallint,
p_bVoid smallint,
p_bApproved smallint,
p_bApplied smallint,
p_bJournal smallint,
p_bPosted smallint,
p_btPrintedCount smallint,
p_bTransferred smallint,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval smallint,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated smallint,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStIn
(
szFStInId,
dtmTransfer,
szLocationType,
szLocationId,
szStockTypeId,
szCarrierId,
szVehicleId,
szDriverId,
szDriverNm,
szPoliceNo,
szRefDoc,
szFDnFileName,
szFDnId,
szFDn2Id,
szSenderWorkplaceId,
szFAdjustmentId,
szAdjustedById,
szAdjustToId,
szDescription,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFStInId,
p_dtmTransfer,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_szCarrierId,
p_szVehicleId,
p_szDriverId,
p_szDriverNm,
p_szPoliceNo,
p_szRefDoc,
p_szFDnFileName,
p_szFDnId,
p_szFDn2Id,
p_szSenderWorkplaceId,
p_szFAdjustmentId,
p_szAdjustedById,
p_szAdjustToId,
p_szDescription,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_CreateFStInItem(
p_szFStInId BOS_DT_szId,
p_btItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decCOGS BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStInItem
(
szFStInId,
btItemNumber,
szProductId,
decQty,
decUomQty,
szUomId,
decCOGS
)
VALUES
(
p_szFStInId,
p_btItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_decCOGS
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_CreateFStInItem_013(
p_szFStInId BOS_DT_szId,
p_btItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decCOGS BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStInItem
(
szFStInId,
btItemNumber,
szProductId,
decQty,
decUomQty,
szUomId,
decCOGS
)
VALUES
(
p_szFStInId,
p_btItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_decCOGS
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_CreateFStInItemLotInfo(
p_szFStInId BOS_DT_szId,
p_btItemNumber smallint,
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szLotTypeId BOS_DT_szId,
p_szProductionCode varchar,
p_decLotStrength BOS_DT_decAmount,
p_dtmExpired timestamp,
p_szLotStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStInItemLotInfo
(
szFStInId,
btItemNumber,
szLotId,
szProductId,
szLotTypeId,
szProductionCode,
decLotStrength,
dtmExpired,
szLotStatus
)
VALUES
(
p_szFStInId,
p_btItemNumber,
p_szLotId,
p_szProductId,
p_szLotTypeId,
p_szProductionCode,
p_decLotStrength,
p_dtmExpired,
p_szLotStatus
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_CreateFStInItemLotInfo_014(
p_szFStInId BOS_DT_szId,
p_btItemNumber smallint,
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szLotTypeId BOS_DT_szId,
p_szProductionCode varchar,
p_decLotStrength BOS_DT_decAmount,
p_dtmExpired timestamp,
p_szLotStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStInItemLotInfo
(
szFStInId,
btItemNumber,
szLotId,
szProductId,
szLotTypeId,
szProductionCode,
decLotStrength,
dtmExpired,
szLotStatus
)
VALUES
(
p_szFStInId,
p_btItemNumber,
p_szLotId,
p_szProductId,
p_szLotTypeId,
p_szProductionCode,
p_decLotStrength,
p_dtmExpired,
p_szLotStatus,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_CreateFStInItemLotQty(
p_szFStInId BOS_DT_szId,
p_btItemNumber smallint,
p_szLotId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStInItemLotQty
(
szFStInId,
btItemNumber,
szLotId
decQty,
)
VALUES
(
p_szFStInId,
p_btItemNumber,
p_szLotId
p_decQty,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_CreateFStInItemSn(
p_szFStInId BOS_DT_szId,
p_btItemNumber smallint,
p_shItemSnNumber smallint,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStInItemSn
(
szFStInId,
btItemNumber,
shItemSnNumber,
szProductSn
)
VALUES
(
p_szFStInId,
p_btItemNumber,
p_shItemSnNumber,
p_szProductSn
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_DeleteFStIn(
p_szFStInId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_FStIn
WHERE
szFStInId=p_szFStInId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_DeleteFStInItem(
p_szFStInId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_FStInItem
WHERE
szFStInId=p_szFStInId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_DeleteFStInItemLotInfo(
p_szFStInId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_INV_FStInItemLotInfo
WHERE
szFStInId = p_szFStInId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_DeleteFStInItemLotQty(
p_szFStInId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_INV_FStInItemLotQty
WHERE
szFStInId = p_szFStInId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_DeleteFStInItemSn(
p_szFStInId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_FStInItemSn
WHERE
szFStInId=p_szFStInId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_GetFStIn(
p_szFStInId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_FStIn.dtmTransfer,
BOS_INV_FStIn.szLocationType,
BOS_INV_FStIn.szLocationId,
BOS_INV_FStIn.szStockTypeId,
BOS_INV_FStIn.szCarrierId,
BOS_INV_FStIn.szVehicleId,
BOS_INV_FStIn.szDriverId,
BOS_INV_FStIn.szDriverNm,
BOS_INV_FStIn.szPoliceNo,
BOS_INV_FStIn.szRefDoc,
BOS_INV_FStIn.szFDnFileName,
BOS_INV_FStIn.szFDnId,
BOS_INV_FStIn.szFDn2Id,
BOS_INV_FStIn.szSenderWorkplaceId,
BOS_INV_FStIn.szFAdjustmentId,
BOS_INV_FStIn.szAdjustedById,
BOS_INV_FStIn.szAdjustToId,
BOS_INV_FStIn.szDescription,

BOS_INV_FStIn.bResultFrTransfer,
BOS_INV_FStIn.bVoid,
BOS_GEN_Approved.bApproved,
BOS_INV_FStIn.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FStIn.btPrintedCount,
BOS_INV_FStIn.bTransferred,
BOS_INV_FStIn.szCompanyId,
BOS_INV_FStIn.szWorkplaceId,
BOS_INV_FStIn.szTaxEntityId,
BOS_INV_FStIn.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FStIn.dtmCreated,
BOS_INV_FStIn.bSystemCreated,
BOS_INV_FStIn.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FStIn.dtmLastUpdated,
BOS_INV_FStIn.bAlreadyTransferred

FROM
(BOS_INV_FStIn LEFT JOIN BOS_GEN_Approved ON BOS_INV_FStIn.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
LEFT JOIN BOS_GL_FJournalTrans ON BOS_INV_FStIn.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FStIn.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FStIn.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FStIn.szUserId

WHERE
BOS_INV_FStIn.szFStInId = p_szFStInId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_GetFStIn_013(
p_szFStInId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_FStIn.dtmTransfer,
BOS_INV_FStIn.szLocationType,
BOS_INV_FStIn.szLocationId,
BOS_INV_FStIn.szStockTypeId,
BOS_INV_FStIn.szCarrierId,
BOS_INV_FStIn.szVehicleId,
BOS_INV_FStIn.szDriverId,
BOS_INV_FStIn.szDriverNm,
BOS_INV_FStIn.szPoliceNo,
BOS_INV_FStIn.szRefDoc,
BOS_INV_FStIn.szFDnFileName,
BOS_INV_FStIn.szFDnId,
BOS_INV_FStIn.szFDn2Id,
BOS_INV_FStIn.szSenderWorkplaceId,
BOS_INV_FStIn.szFAdjustmentId,
BOS_INV_FStIn.szAdjustedById,
BOS_INV_FStIn.szAdjustToId,
BOS_INV_FStIn.szDescription,

BOS_INV_FStIn.bResultFrTransfer,
BOS_INV_FStIn.bVoid,
BOS_GEN_Approved.bApproved,
BOS_INV_FStIn.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FStIn.btPrintedCount,
BOS_INV_FStIn.bTransferred,
BOS_INV_FStIn.szCompanyId,
BOS_INV_FStIn.szWorkplaceId,
BOS_INV_FStIn.szTaxEntityId,
BOS_INV_FStIn.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FStIn.dtmCreated,
BOS_INV_FStIn.bSystemCreated,
BOS_INV_FStIn.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FStIn.dtmLastUpdated,
BOS_INV_FStIn.bAlreadyTransferred

FROM
(BOS_INV_FStIn LEFT JOIN BOS_GEN_Approved ON BOS_INV_FStIn.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
LEFT JOIN BOS_GL_FJournalTrans ON BOS_INV_FStIn.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FStIn.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FStIn.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FStIn.szUserId

WHERE
BOS_INV_FStIn.szFStInId = p_szFStInId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_GetFStInItem(
p_szFStInId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_FStInItem.btItemNumber,
BOS_INV_FStInItem.szProductId,

BOS_INV_Product.szName as szProductName,
BOS_INV_Product.szNickName As szProductNickName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szTrackingType AS szProductTrackingType,

BOS_INV_FStInItem.decQty,
BOS_INV_FStInItem.decUomQty,

BOS_INV_FStInItem.szUomId,

BOS_INV_FStInItem.decCOGS


FROM 
BOS_INV_FStInItem
left join BOS_INV_Product on BOS_INV_FStInItem.szProductId = BOS_INV_Product.szProductId

WHERE 
szFStInId=p_szFStInId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_GetFStInItem_013(
p_szFStInId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_FStInItem.btItemNumber,
BOS_INV_FStInItem.szProductId,

BOS_INV_Product.szName as szProductName,
BOS_INV_Product.szNickName As szProductNickName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szTrackingType AS szProductTrackingType,

BOS_INV_FStInItem.decQty,
BOS_INV_FStInItem.decUomQty,

BOS_INV_FStInItem.szUomId,

BOS_INV_FStInItem.decCOGS


FROM 
BOS_INV_FStInItem
left join BOS_INV_Product on BOS_INV_FStInItem.szProductId = BOS_INV_Product.szProductId

WHERE 
szFStInId=p_szFStInId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_GetFStInItemLotInfo(
p_szFStInId BOS_DT_szId,
p_btItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_FStInItemLotInfo.szLotId,
BOS_INV_FStInItemLotInfo.szProductId,
BOS_INV_Product.szName as szProductNm,
BOS_INV_FStInItemLotInfo.szLotTypeId,
BOS_INV_FStInItemLotInfo.szProductionCode,
BOS_INV_FStInItemLotInfo.decLotStrength,
BOS_INV_FStInItemLotInfo.dtmExpired,
BOS_INV_FStInItemLotInfo.szLotStatus

FROM 
BOS_INV_FStInItemLotInfo
left join BOS_INV_Product on BOS_INV_FStInItemLotInfo.szProductId = BOS_INV_Product.szProductId

WHERE 
szFStInId = p_szFStInId And btItemNumber = p_btItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_GetFStInItemLotQty(
p_szFStInId BOS_DT_szId,
p_btItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLotId,
decQty

FROM 
BOS_INV_FStInItemLotQty
WHERE 
szFStInId = p_szFStInId And btItemNumber = p_btItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_GetFStInItemSn(
p_szFStInId BOS_DT_szId,
p_btItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemSnNumber,
szProductSn

FROM 
BOS_INV_FStInItemSn
WHERE 
szFStInId=p_szFStInId AND btItemNumber=p_btItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_GetListOfFStIn()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFStInId,
dtmTransfer

FROM 
BOS_INV_FStIn

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_IsFStInExist(
p_szFStInId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFStInId

FROM 
BOS_INV_FStIn
WHERE 
szFStInId=p_szFStInId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_LockFStIn(
p_szFStInId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FStIn
SET 
szVehicleId = szVehicleId
WHERE 
szFStInId=p_szFStInId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_UpdateFStIn(
p_szFStInId BOS_DT_szId,
p_dtmTransfer timestamp,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szCarrierId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szDriverNm BOS_DT_szName,
p_szPoliceNo BOS_DT_szSmallName,
p_szRefDoc BOS_DT_szId,
p_szFDnFileName BOS_DT_szFullPath,
p_szFDnId BOS_DT_szId,
p_szFDn2Id BOS_DT_szId,
p_szSenderWorkplaceId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer smallint,
p_bVoid smallint,
p_bApproved smallint,
p_bApplied smallint,
p_bJournal smallint,
p_bPosted smallint,
p_btPrintedCount smallint,
p_bTransferred smallint,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval smallint,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated smallint,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FStIn
SET 
dtmTransfer=p_dtmTransfer,
szLocationType=p_szLocationType,
szLocationId=p_szLocationId,
szStockTypeId=p_szStockTypeId,
szCarrierId=p_szCarrierId,
szVehicleId=p_szVehicleId,
szDriverId=p_szDriverId,
szDriverNm = p_szDriverNm,
szPoliceNo = p_szPoliceNo,
szRefDoc = p_szRefDoc,
szFDnFileName = p_szFDnFileName,
szFDnId = p_szFDnId,
szFDn2Id = p_szFDn2Id,
szSenderWorkplaceId=p_szSenderWorkplaceId,
szFAdjustmentId=p_szFAdjustmentId,
szAdjustedById=p_szAdjustedById,
szAdjustToId=p_szAdjustToId,
szDescription=p_szDescription,

bVoid=p_bVoid,
bApplied=p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFStInId=p_szFStInId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_UpdateFStIn_013(
p_szFStInId BOS_DT_szId,
p_dtmTransfer timestamp,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szCarrierId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szDriverNm BOS_DT_szName,
p_szPoliceNo BOS_DT_szSmallName,
p_szRefDoc BOS_DT_szId,
p_szFDnFileName BOS_DT_szFullPath,
p_szFDnId BOS_DT_szId,
p_szFDn2Id BOS_DT_szId,
p_szSenderWorkplaceId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer smallint,
p_bVoid smallint,
p_bApproved smallint,
p_bApplied smallint,
p_bJournal smallint,
p_bPosted smallint,
p_btPrintedCount smallint,
p_bTransferred smallint,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval smallint,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated smallint,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FStIn
SET 
dtmTransfer=p_dtmTransfer,
szLocationType=p_szLocationType,
szLocationId=p_szLocationId,
szStockTypeId=p_szStockTypeId,
szCarrierId=p_szCarrierId,
szVehicleId=p_szVehicleId,
szDriverId=p_szDriverId,
szDriverNm = p_szDriverNm,
szPoliceNo = p_szPoliceNo,
szRefDoc = p_szRefDoc,
szFDnFileName = p_szFDnFileName,
szFDnId = p_szFDnId,
szFDn2Id = p_szFDn2Id,
szSenderWorkplaceId=p_szSenderWorkplaceId,
szFAdjustmentId=p_szFAdjustmentId,
szAdjustedById=p_szAdjustedById,
szAdjustToId=p_szAdjustToId,
szDescription=p_szDescription,

bVoid=p_bVoid,
bApplied=p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFStInId=p_szFStInId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIn_UpdateFStInForAdjustment(
p_szFStInId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FSTIN
SET 
szFAdjustmentId = p_szFAdjustmentId,
szAdjustedById = p_szAdjustedById
WHERE 
szFStInId=p_szFStInId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_CreateFStIntern(
p_szFStInternId BOS_DT_szId,
p_dtmTransfer timestamp,
p_szRefDocType varchar,
p_szRefDocId BOS_DT_szId,
p_szEmployeeId BOS_DT_szId,
p_szFrWhId BOS_DT_szId,
p_szFrStockTypeId BOS_DT_szId,
p_szToWhId BOS_DT_szId,
p_szToStockTypeId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szDescription BOS_DT_szDescription,
p_bTransportationDetail smallint,
p_szExpedition BOS_DT_szName,
p_szDriverName BOS_DT_szId,
p_szVehicleNumber BOS_DT_szId,
p_szDriver BOS_DT_szId,
p_szVehicle BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStIntern
(
szFStInternId,
dtmTransfer,
szRefDocType,
szRefDocId,
szEmployeeId,
szFrWhId,
szFrStockTypeId ,
szToWhId ,
szToStockTypeId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
szDescription,
--Adding Fields for SP,
bTransportationDetail,
szExpedition,
szDriverName,
szVehicleNumber,
szDriver,
szVehicle
)
VALUES
(
p_szFStInternId,
p_dtmTransfer,
p_szRefDocType,
p_szRefDocId,
p_szEmployeeId,
p_szFrWhId,
p_szFrStockTypeId ,
p_szToWhId ,
p_szToStockTypeId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szDescription,
--Adding Fields for SP,
p_bTransportationDetail,
p_szExpedition,
p_szDriverName,
p_szVehicleNumber,
p_szDriver,
p_szVehicle
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_CreateFStIntern_014(
p_szFStInternId BOS_DT_szId,
p_dtmTransfer timestamp,
p_szRefDocType varchar,
p_szRefDocId BOS_DT_szId,
p_szEmployeeId BOS_DT_szId,
p_szFrWhId BOS_DT_szId,
p_szFrStockTypeId BOS_DT_szId,
p_szToWhId BOS_DT_szId,
p_szToStockTypeId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szDescription BOS_DT_szDescription,
p_bTransportationDetail smallint,
p_szExpedition BOS_DT_szName,
p_szDriverName BOS_DT_szId,
p_szVehicleNumber BOS_DT_szId,
p_szDriver BOS_DT_szId,
p_szVehicle BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStIntern
(
szFStInternId,
dtmTransfer,
szRefDocType,
szRefDocId,
szEmployeeId,
szFrWhId,
szFrStockTypeId ,
szToWhId ,
szToStockTypeId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
szDescription,
--Adding Fields for SP,
bTransportationDetail,
szExpedition,
szDriverName,
szVehicleNumber,
szDriver,
szVehicle
)
VALUES
(
p_szFStInternId,
p_dtmTransfer,
p_szRefDocType,
p_szRefDocId,
p_szEmployeeId,
p_szFrWhId,
p_szFrStockTypeId ,
p_szToWhId ,
p_szToStockTypeId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szDescription,
--Adding Fields for SP,
p_bTransportationDetail,
p_szExpedition,
p_szDriverName,
p_szVehicleNumber,
p_szDriver,
p_szVehicle,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_CreateFStInternItem(
p_szFStInternId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStInternItem
(
szFStInternId,
shItemNumber,
szProductId,
decQty,
decUomQty,
szUomId,
szParentId
)
VALUES
(
p_szFStInternId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_szParentId,
-- ==================================================================,
SET ANSI_NULLS ON,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_CreateFStInternItem_014(
p_szFStInternId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStInternItem
(
szFStInternId,
shItemNumber,
szProductId,
decQty,
decUomQty,
szUomId,
szParentId
)
VALUES
(
p_szFStInternId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_szParentId,
-- ==================================================================,
SET ANSI_NULLS ON
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_CreateFStInternItemLotQty(
p_szFStInternId BOS_DT_szId,
p_shItemNumber smallint,
p_szLotId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStInternItemLotQty
(
szFStInternId,
shItemNumber,
szLotId,
decQty
)
VALUES
(
p_szFStInternId,
p_shItemNumber,
p_szLotId,
p_decQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_CreateFStInternItemReason(
p_szFStInternId BOS_DT_szId,
p_shItemNumber smallint,
p_szReasonId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStInternItemReason
(
szFStInternId,
shItemNumber,
szReasonId,
decQty
)
VALUES
(
p_szFStInternId,
p_shItemNumber,
p_szReasonId,
p_decQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_CreateFStInternItemSn(
p_szFStInternId BOS_DT_szId,
p_shItemNumber smallint,
p_shItemSnNumber smallint,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStInternItemSn
(
szFStInternId,
shItemNumber,
shItemSnNumber,
szProductSn
)
VALUES
(
p_szFStInternId,
p_shItemNumber,
p_shItemSnNumber,
p_szProductSn
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_DeleteFStIntern(
p_szFStInternId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FStIntern
WHERE
szFStInternId=p_szFStInternId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_DeleteFStInternItem(
p_szFStInternId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FStInternItem
WHERE
szFStInternId=p_szFStInternId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_DeleteFStInternItemLotQty(
p_szFStInternId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FStInternItemLotQty
WHERE
szFStInternId=p_szFStInternId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_DeleteFStInternItemReason(
p_szFStInternId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FStInternItemReason
WHERE
szFStInternId = p_szFStInternId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_DeleteFStInternItemSn(
p_szFStInternId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FStInternItemSn
WHERE
szFStInternId=p_szFStInternId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_GetFStIntern(
p_szFStInternId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_INV_FStIntern.dtmTransfer,
BOS_INV_FStIntern.szRefDocType,
BOS_INV_FStIntern.szRefDocId,
BOS_INV_FStIntern.szEmployeeId,
BOS_PI_Employee.szName as szEmployeeNm,
BOS_INV_FStIntern.szFrWhId,
BOS_INV_FStIntern.szFrStockTypeId,
BOS_INV_FStIntern.szToWhId,
BOS_INV_FStIntern.szToStockTypeId,
BOS_INV_FStIntern.bResultFrTransfer,
BOS_INV_FStIntern.bVoid,
BOS_GEN_Approved.bApproved,
BOS_INV_FStIntern.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FStIntern.btPrintedCount,
BOS_INV_FStIntern.bTransferred,
BOS_INV_FStIntern.szCompanyId,
BOS_INV_FStIntern.szWorkplaceId,
BOS_INV_FStIntern.szTaxEntityId,
BOS_INV_FStIntern.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FStIntern.dtmCreated,
BOS_INV_FStIntern.bSystemCreated,
BOS_INV_FStIntern.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FStIntern.dtmLastUpdated,
BOS_INV_FStIntern.bAlreadyTransferred,
BOS_INV_FStIntern.szDescription,

-- Adding details data
BOS_INV_FStIntern.bTransportationDetail,
BOS_INV_FStIntern.szExpedition, 
BOS_INV_FStIntern.szDriverName,
BOS_INV_FStIntern.szVehicleNumber,
BOS_INV_FStIntern.szDriver,
BOS_INV_FStIntern.szVehicle

FROM
(BOS_INV_FStIntern LEFT JOIN BOS_GEN_Approved ON BOS_INV_FStIntern.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
LEFT JOIN BOS_GL_FJournalTrans ON BOS_INV_FStIntern.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_PI_Employee ON BOS_INV_FStIntern.szEmployeeId = BOS_PI_Employee.szEmployeeId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FStIntern.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FStIntern.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FStIntern.szUserId

WHERE
BOS_INV_FStIntern.szFStInternId = p_szFStInternId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_GetFStIntern_014(
p_szFStInternId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_INV_FStIntern.dtmTransfer,
BOS_INV_FStIntern.szRefDocType,
BOS_INV_FStIntern.szRefDocId,
BOS_INV_FStIntern.szEmployeeId,
BOS_PI_Employee.szName as szEmployeeNm,
BOS_INV_FStIntern.szFrWhId,
BOS_INV_FStIntern.szFrStockTypeId,
BOS_INV_FStIntern.szToWhId,
BOS_INV_FStIntern.szToStockTypeId,
BOS_INV_FStIntern.bResultFrTransfer,
BOS_INV_FStIntern.bVoid,
BOS_GEN_Approved.bApproved,
BOS_INV_FStIntern.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FStIntern.btPrintedCount,
BOS_INV_FStIntern.bTransferred,
BOS_INV_FStIntern.szCompanyId,
BOS_INV_FStIntern.szWorkplaceId,
BOS_INV_FStIntern.szTaxEntityId,
BOS_INV_FStIntern.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FStIntern.dtmCreated,
BOS_INV_FStIntern.bSystemCreated,
BOS_INV_FStIntern.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FStIntern.dtmLastUpdated,
BOS_INV_FStIntern.bAlreadyTransferred,
BOS_INV_FStIntern.szDescription,

-- Adding details data
BOS_INV_FStIntern.bTransportationDetail,
BOS_INV_FStIntern.szExpedition, 
BOS_INV_FStIntern.szDriverName,
BOS_INV_FStIntern.szVehicleNumber,
BOS_INV_FStIntern.szDriver,
BOS_INV_FStIntern.szVehicle

FROM
(BOS_INV_FStIntern LEFT JOIN BOS_GEN_Approved ON BOS_INV_FStIntern.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
LEFT JOIN BOS_GL_FJournalTrans ON BOS_INV_FStIntern.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_PI_Employee ON BOS_INV_FStIntern.szEmployeeId = BOS_PI_Employee.szEmployeeId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FStIntern.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FStIntern.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FStIntern.szUserId

WHERE
BOS_INV_FStIntern.szFStInternId = p_szFStInternId


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_GetFStInternItem(
p_szFStInternId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_FStInternItem.shItemNumber,
BOS_INV_FStInternItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szNickName As szProductNickName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat,
BOS_INV_FStInternItem.decQty,
BOS_INV_FStInternItem.decUomQty,
BOS_INV_FStInternItem.szUomId,

BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
BOS_INV_FStInternItem.szParentId,
BIP2.szName AS szParentNm_J

FROM
BOS_INV_FStInternItem
left join BOS_INV_Product on BOS_INV_FStInternItem.szProductId = BOS_INV_Product.szProductId
LEFT JOIN BOS_INV_Product AS BIP2 ON BIP2.szProductId = BOS_INV_FStInternItem.szParentId
WHERE
szFStInternId=p_szFStInternId

-- ==================================================================

SET ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_GetFStInternItem_014(
p_szFStInternId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_FStInternItem.shItemNumber,
BOS_INV_FStInternItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szNickName As szProductNickName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat,
BOS_INV_FStInternItem.decQty,
BOS_INV_FStInternItem.decUomQty,
BOS_INV_FStInternItem.szUomId,

BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
BOS_INV_FStInternItem.szParentId,
BIP2.szName AS szParentNm_J

FROM
BOS_INV_FStInternItem
left join BOS_INV_Product on BOS_INV_FStInternItem.szProductId = BOS_INV_Product.szProductId
LEFT JOIN BOS_INV_Product AS BIP2 ON BIP2.szProductId = BOS_INV_FStInternItem.szParentId
WHERE
szFStInternId=p_szFStInternId

-- ==================================================================

SET ANSI_NULLS ON


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_GetFStInternItemLotQty(
p_szFStInternId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemNumber,
szLotId,
decQty

FROM 
BOS_INV_FStInternItemLotQty
WHERE 
szFStInternId=p_szFStInternId AND shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_GetFStInternItemLotQty_014(
p_szFStInternId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemNumber,
szLotId,
decQty

FROM 
BOS_INV_FStInternItemLotQty
WHERE 
szFStInternId=p_szFStInternId AND shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_GetFStInternItemReason(
p_szFStInternId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
fdir.szReasonId,
reason.szDescription as szReasonDesc_J,
fdir.decQty

FROM 
BOS_INV_FStInternItemReason as fdir
WHERE 
fdir.szFStInternId = p_szFStInternId and fdir.shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_GetFStInternItemSn(
p_szFStInternId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemSnNumber,
szProductSn

FROM 
BOS_INV_FStInternItemSn
WHERE 
szFStInternId=p_szFStInternId and shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_GetListOfFStIntern()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFStInternId,
dtmTransfer

FROM 
BOS_INV_FStIntern

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_IsFStInternExist(
p_szFStInternId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFStInternId

FROM 
BOS_INV_FStIntern
WHERE 
szFStInternId=p_szFStInternId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_LockFStIntern(
p_szFStInternId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FStIntern
SET 
bTransferred=bTransferred
WHERE 
szFStInternId=p_szFStInternId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_UpdateFStIntern(
p_szFStInternId BOS_DT_szId,
p_dtmTransfer timestamp,
p_szRefDocType varchar,
p_szRefDocId BOS_DT_szId,
p_szEmployeeId BOS_DT_szId,
p_szFrWhId BOS_DT_szId,
p_szFrStockTypeId BOS_DT_szId,
p_szToWhId BOS_DT_szId,
p_szToStockTypeId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bTransportationDetail smallint,
p_szExpedition BOS_DT_szId,
p_szDriverName BOS_DT_szId,
p_szVehicleNumber BOS_DT_szId,
p_szDriver BOS_DT_szId,
p_szVehicle BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
-- ### 2 update #####
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStIntern_UpdateFStIntern_014(
p_szFStInternId BOS_DT_szId,
p_dtmTransfer timestamp,
p_szRefDocType varchar,
p_szRefDocId BOS_DT_szId,
p_szEmployeeId BOS_DT_szId,
p_szFrWhId BOS_DT_szId,
p_szFrStockTypeId BOS_DT_szId,
p_szToWhId BOS_DT_szId,
p_szToStockTypeId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bTransportationDetail smallint,
p_szExpedition BOS_DT_szId,
p_szDriverName BOS_DT_szId,
p_szVehicleNumber BOS_DT_szId,
p_szDriver BOS_DT_szId,
p_szVehicle BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
-- ### 2 update #####
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_CreateFStMorph(
p_szFStMorphId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szRefDocId BOS_DT_szId,
p_dtmMorph timestamp,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStMorph
(
szFStMorphId,
szSalesOrgId,
szRefDocId,
dtmMorph,
szLocationType,
szLocationId,
szStockTypeId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
szDescription
)
VALUES
(
p_szFStMorphId,
p_szSalesOrgId,
p_szRefDocId,
p_dtmMorph,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szDescription,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_CreateFStMorphItem(
p_szFStMorphId BOS_DT_szId,
p_btItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_bIsSnExist bit,
p_szToProductId BOS_DT_szId,
p_szToUomId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStMorphItem
(
szFStMorphId,
btItemNumber,
szProductId,
decQty,
decUomQty,
szUomId,
bIsSnExist,
szToProductId,
szToUomId
)
VALUES
(
p_szFStMorphId,
p_btItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_bIsSnExist,
p_szToProductId,
p_szToUomId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_CreateFStMorphItemLotInfo(
p_szFStMorphId BOS_DT_szId,
p_btItemNumber smallint,
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szLotTypeId BOS_DT_szId,
p_szProductionCode varchar,
p_decLotStrength BOS_DT_decAmount,
p_dtmExpired timestamp,
p_szLotStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStMorphItemLotInfo
(
szFStMorphId,
btItemNumber,
szLotId,
szProductId,
szLotTypeId,
szProductionCode,
decLotStrength,
dtmExpired,
szLotStatus
)
VALUES
(
p_szFStMorphId,
p_btItemNumber,
p_szLotId,
p_szProductId,
p_szLotTypeId,
p_szProductionCode,
p_decLotStrength,
p_dtmExpired,
p_szLotStatus
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_CreateFStMorphItemLotQty(
p_szFStMorphId BOS_DT_szId,
p_btItemNumber smallint,
p_szLotId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStMorphItemLotQty
(
szFStMorphId,
btItemNumber,
szLotId,
decQty,
)
VALUES
(
p_szFStMorphId,
p_btItemNumber,
p_szLotId,
p_decQty,
SET QUOTED_IDENTIFIER OFF,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_CreateFStMorphItemSn(
p_szFStMorphId BOS_DT_szId,
p_btItemNumber smallint,
p_shItemSnNumber smallint,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStMorphItemSn
(
szFStMorphId,
btItemNumber,
shItemSnNumber,
szProductSn
)
VALUES
(
p_szFStMorphId,
p_btItemNumber,
p_shItemSnNumber,
p_szProductSn
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_DeleteFStMorph(
p_szFStMorphId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FStMorph
WHERE
szFStMorphId=p_szFStMorphId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_DeleteFStMorphItem(
p_szFStMorphId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FStMorphItem
WHERE
szFStMorphId=p_szFStMorphId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_DeleteFStMorphItemLotInfo(
p_szFStMorphId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FStMorphItemLotInfo
WHERE
szFStMorphId = p_szFStMorphId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_DeleteFStMorphItemLotQty(
p_szFStMorphId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_INV_FStMorphItemLotQty
WHERE
szFStMorphId = p_szFStMorphId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_DeleteFStMorphItemSn(
p_szFStMorphId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FStMorphItemSn
WHERE
szFStMorphId=p_szFStMorphId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_GetFStMorph(
p_szFStMorphId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_INV_FStMorph.szSalesOrgId,
BOS_INV_FStMorph.szRefDocId,
BOS_INV_FStMorph.dtmMorph,
BOS_INV_FStMorph.szLocationType,
BOS_INV_FStMorph.szLocationId,
BOS_INV_FStMorph.szStockTypeId,
BOS_INV_FStMorph.bResultFrTransfer,
BOS_INV_FStMorph.bVoid,
BOS_GEN_Approved.bApproved,
BOS_INV_FStMorph.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FStMorph.btPrintedCount,
BOS_INV_FStMorph.bTransferred,
BOS_INV_FStMorph.szCompanyId,
BOS_INV_FStMorph.szWorkplaceId,
BOS_INV_FStMorph.szTaxEntityId,
BOS_INV_FStMorph.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,
BOS_INV_FStMorph.dtmCreated,
BOS_INV_FStMorph.bSystemCreated,
BOS_INV_FStMorph.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FStMorph.dtmLastUpdated,
BOS_INV_FStMorph.bAlreadyTransferred,
BOS_INV_FStMorph.szDescription
FROM
(BOS_INV_FStMorph LEFT JOIN BOS_GEN_Approved ON BOS_INV_FStMorph.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
LEFT JOIN BOS_GL_FJournalTrans ON BOS_INV_FStMorph.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FStMorph.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FStMorph.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FStMorph.szUserId

WHERE
BOS_INV_FStMorph.szFStMorphId = p_szFStMorphId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_GetFStMorphItem(
p_szFStMorphId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_INV_FStMorphItem.btItemNumber,
BOS_INV_FStMorphItem.szProductId,
b1.szName as szProductName,
b1.szQtyFormat as szProductQtyFormat,

BOS_INV_FStMorphItem.decQty,
BOS_INV_FStMorphItem.decUomQty,

BOS_INV_FStMorphItem.szUomId,

b1.szUomId AS szProductUomId,
b1.szUomClassId AS szProductUomClassId_J,
b1.szCompUomId AS szProductCompUomId,
b1.szTrackingType AS szProductTrackingType,

BOS_INV_FStMorphItem.bIsSnExist,

BOS_INV_FStMorphItem.szToProductId,
b2.szName as szToProductName,
BOS_INV_FStMorphItem.szToUomId,
b2.szUomId AS szToProductUomId,
b2.szUomClassId AS szToProductUomClassId_J,
b2.szCompUomId AS szToProductCompUomId

FROM
BOS_INV_FStMorphItem
left join BOS_INV_Product as b1 on BOS_INV_FStMorphItem.szProductId = b1.szProductId
left join BOS_INV_Product as b2 on BOS_INV_FStMorphItem.szToProductId = b2.szProductId
WHERE
szFStMorphId=p_szFStMorphId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_GetFStMorphItemLotInfo(
p_szFStMorphId BOS_DT_szId,
p_btItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_FStMorphItemLotInfo.szLotId,
BOS_INV_FStMorphItemLotInfo.szProductId,
BOS_INV_Product.szName as szProductNm,
BOS_INV_FStMorphItemLotInfo.szLotTypeId,
BOS_INV_FStMorphItemLotInfo.szProductionCode,
BOS_INV_FStMorphItemLotInfo.decLotStrength,
BOS_INV_FStMorphItemLotInfo.dtmExpired,
BOS_INV_FStMorphItemLotInfo.szLotStatus

FROM 
BOS_INV_FStMorphItemLotInfo left join BOS_INV_Product on BOS_INV_FStMorphItemLotInfo.szProductId = BOS_INV_Product.szProductId
WHERE 
szFStMorphId = p_szFStMorphId And btItemNumber = p_btItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_GetFStMorphItemLotQty(
p_szFStMorphId BOS_DT_szId,
p_btItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLotId,
decQty


FROM 
BOS_INV_FStMorphItemLotQty

WHERE 
szFStMorphId = p_szFStMorphId And btItemNumber = p_btItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_GetFStMorphItemSn(
p_szFStMorphId BOS_DT_szId,
p_btItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemSnNumber,
szProductSn


FROM 
BOS_INV_FStMorphItemSn
WHERE 
szFStMorphId=p_szFStMorphId AND btItemNumber=p_btItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_GetListOfFStMorph()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFStMorphId,
dtmMorph

FROM 
BOS_INV_FStMorph

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_IsFStMorphExist(
p_szFStMorphId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFStMorphId

FROM 
BOS_INV_FStMorph
WHERE 
szFStMorphId=p_szFStMorphId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_LockFStMorph(
p_szFStMorphId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FStMorph
SET 
bTransferred=bTransferred
WHERE 
szFStMorphId=p_szFStMorphId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStMorph_UpdateFStMorph(
p_szFStMorphId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szRefDocId BOS_DT_szId,
p_dtmMorph timestamp,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FStMorph
SET 
szSalesOrgId = p_szSalesOrgId,
szRefDocId = p_szRefDocId,
dtmMorph = p_dtmMorph,
szLocationType = p_szLocationType,
szLocationId = p_szLocationId,
szStockTypeId = p_szStockTypeId,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId,

szDescription = p_szDescription
WHERE 
szFStMorphId = p_szFStMorphId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_CreateFStReject(
p_szFStRejectId BOS_DT_szId,
p_dtmDocument timestamp,
p_szRefDocType varchar,
p_szRefDoc varchar,
p_szWhId BOS_DT_szId,
p_szDepartmentId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szEmployeeId BOS_DT_szId,
p_szQcDocId BOS_DT_szId,
p_dtmQcDoc timestamp,
p_szDescription varchar,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStReject
(
szFStRejectId,
dtmDocument,
szRefDocType,
szRefDoc,
szWhId,
szDepartmentId,
szStockTypeId,
szEmployeeId,
szQcDocId,
dtmQcDoc,
szDescription,
szFAdjustmentId,
szAdjustedById,
szAdjustToId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
)
VALUES
(
p_szFStRejectId,
p_dtmDocument,
p_szRefDocType,
p_szRefDoc,
p_szWhId,
p_szDepartmentId,
p_szStockTypeId,
p_szEmployeeId,
p_szQcDocId,
p_dtmQcDoc,
p_szDescription,
p_szFAdjustmentId,
p_szAdjustedById,
p_szAdjustToId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated ,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_CreateFStReject_013(
p_szFStRejectId BOS_DT_szId,
p_dtmDocument timestamp,
p_szRefDocType varchar,
p_szRefDoc varchar,
p_szWhId BOS_DT_szId,
p_szDepartmentId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szEmployeeId BOS_DT_szId,
p_szQcDocId BOS_DT_szId,
p_dtmQcDoc timestamp,
p_szDescription varchar,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStReject
(
szFStRejectId,
dtmDocument,
szRefDocType,
szRefDoc,
szWhId,
szDepartmentId,
szStockTypeId,
szEmployeeId,
szQcDocId,
dtmQcDoc,
szDescription,
szFAdjustmentId,
szAdjustedById,
szAdjustToId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
)
VALUES
(
p_szFStRejectId,
p_dtmDocument,
p_szRefDocType,
p_szRefDoc,
p_szWhId,
p_szDepartmentId,
p_szStockTypeId,
p_szEmployeeId,
p_szQcDocId,
p_dtmQcDoc,
p_szDescription,
p_szFAdjustmentId,
p_szAdjustedById,
p_szAdjustToId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated ,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_CreateFStRejectItem(
p_szFStRejectId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szConditionTypeId varchar,
p_szSuggestionTypeId varchar,
p_szProductIdTobeSold varchar,
p_szStockTypeIdToBeSold varchar,
p_decQtyToBeSold BOS_DT_decAmount,
p_decUomQtyToBeSold BOS_DT_decAmount,
p_decCOGS BOS_DT_decAmount,
p_decNewProductCOGS BOS_DT_decAmount,
p_szUomIdToBeSold varchar,
p_szReasonId varchar,
p_szParentId BOS_DT_szId,
p_szParentIdToBeSold BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStRejectItem
(
szFStRejectId,
shItemNumber,
szProductId,
decQty,
decUomQty,
szUomId,
szConditionTypeId,
szSuggestionTypeId,
szProductIdTobeSold,
szStockTypeIdToBeSold,
decQtyToBeSold,
decUomQtyToBeSold,
decCOGS,
decNewProductCOGS,
szUomIdToBeSold,
szReasonId,
szParentId,
szParentIdToBeSold
)
VALUES
(
p_szFStRejectId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_szConditionTypeId,
p_szSuggestionTypeId,
p_szProductIdTobeSold,
p_szStockTypeIdToBeSold,
p_decQtyToBeSold,
p_decUomQtyToBeSold,
p_decCOGS,
p_decNewProductCOGS,
p_szUomIdToBeSold,
p_szReasonId,
p_szParentId,
p_szParentIdToBeSold,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_CreateFStRejectItem_013(
p_szFStRejectId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szConditionTypeId varchar,
p_szSuggestionTypeId varchar,
p_szProductIdTobeSold varchar,
p_szStockTypeIdToBeSold varchar,
p_decQtyToBeSold BOS_DT_decAmount,
p_decUomQtyToBeSold BOS_DT_decAmount,
p_decCOGS BOS_DT_decAmount,
p_decNewProductCOGS BOS_DT_decAmount,
p_szUomIdToBeSold varchar,
p_szReasonId varchar,
p_szParentId BOS_DT_szId,
p_szParentIdToBeSold BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStRejectItem
(
szFStRejectId,
shItemNumber,
szProductId,
decQty,
decUomQty,
szUomId,
szConditionTypeId,
szSuggestionTypeId,
szProductIdTobeSold,
szStockTypeIdToBeSold,
decQtyToBeSold,
decUomQtyToBeSold,
decCOGS,
decNewProductCOGS,
szUomIdToBeSold,
szReasonId,
szParentId,
szParentIdToBeSold
)
VALUES
(
p_szFStRejectId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_szConditionTypeId,
p_szSuggestionTypeId,
p_szProductIdTobeSold,
p_szStockTypeIdToBeSold,
p_decQtyToBeSold,
p_decUomQtyToBeSold,
p_decCOGS,
p_decNewProductCOGS,
p_szUomIdToBeSold,
p_szReasonId,
p_szParentId,
p_szParentIdToBeSold,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_CreateFStRejectItemLotQty(
p_szFStRejectId BOS_DT_szId,
p_shItemNumber smallint,
p_szLotId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStRejectItemLotQty
(
szFStRejectId,
shItemNumber,
szLotId,
decQty,
)
VALUES
(
p_szFStRejectId,
p_shItemNumber,
p_szLotId,
p_decQty,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_CreateFStRejectItemSn(
p_szFStRejectId BOS_DT_szId,
p_shItemNumber smallint,
p_shItem2Number smallint,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStRejectItemSn
(
szFStRejectId,
shItemNumber,
shItem2Number,
szProductSn
)
VALUES
(
p_szFStRejectId,
p_shItemNumber,
p_shItem2Number,
p_szProductSn
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_CreateFStRejectItemSn_014(
p_szFStRejectId BOS_DT_szId,
p_shItemNumber smallint,
p_shItem2Number smallint,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FStRejectItemSn
(
szFStRejectId,
shItemNumber,
shItem2Number,
szProductSn
)
VALUES
(
p_szFStRejectId,
p_shItemNumber,
p_shItem2Number,
p_szProductSn,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_DeleteFStReject(
p_szFStRejectId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FStReject
WHERE
szFStRejectId=p_szFStRejectId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_DeleteFStRejectItem(
p_szFStRejectId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FStRejectItem
WHERE
szFStRejectId=p_szFStRejectId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_DeleteFStRejectItemLotQty(
p_szFStRejectId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FStRejectItemLotQty
WHERE
szFStRejectId=p_szFStRejectId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_DeleteFStRejectItemSn(
p_szFStRejectId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_FStRejectItemSn
WHERE
szFStRejectId=p_szFStRejectId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_GetFStReject(
p_szFStRejectId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT

BOS_INV_FStReject.szFStRejectId,
BOS_INV_FStReject.dtmDocument,
BOS_INV_FStReject.szRefDocType,
BOS_INV_FStReject.szRefDoc,
BOS_INV_FStReject.szWhId,
BOS_INV_FStReject.szDepartmentId,
BOS_INV_FStReject.szStockTypeId,
BOS_INV_FStReject.szEmployeeId,
IsNull(BOS_PI_Employee.szName, '') as szEmployeeName,
BOS_INV_FStReject.szQcDocId,
BOS_INV_FStReject.dtmQcDoc,
BOS_INV_FStReject.szDescription,
BOS_INV_FStReject.szFAdjustmentId,
BOS_INV_FStReject.szAdjustedById,
BOS_INV_FStReject.szAdjustToId,
BOS_INV_FStReject.bResultFrTransfer,
BOS_INV_FStReject.bVoid, 
BOS_GEN_Approved.bApproved,
BOS_INV_FStReject.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FStReject.btPrintedCount,
BOS_INV_FStReject.bTransferred,
BOS_INV_FStReject.szCompanyId,
BOS_INV_FStReject.szWorkplaceId,
BOS_INV_FStReject.szTaxEntityId,
BOS_INV_FStReject.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FStReject.dtmCreated,
BOS_INV_FStReject.bSystemCreated,
BOS_INV_FStReject.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FStReject.dtmLastUpdated,
BOS_INV_FStReject.bAlreadyTransferred


FROM
BOS_INV_FStReject LEFT JOIN BOS_GEN_Approved ON BOS_INV_FStReject.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_INV_FStReject.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_PI_Employee ON BOS_INV_FStReject.szEmployeeId = BOS_PI_Employee.szEmployeeId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FStReject.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FStReject.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FStReject.szUserId

WHERE
BOS_INV_FStReject.szFStRejectId = p_szFStRejectId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_GetFStReject_013(
p_szFStRejectId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT

BOS_INV_FStReject.szFStRejectId,
BOS_INV_FStReject.dtmDocument,
BOS_INV_FStReject.szRefDocType,
BOS_INV_FStReject.szRefDoc,
BOS_INV_FStReject.szWhId,
BOS_INV_FStReject.szDepartmentId,
BOS_INV_FStReject.szStockTypeId,
BOS_INV_FStReject.szEmployeeId,
IsNull(BOS_PI_Employee.szName, '') as szEmployeeName,
BOS_INV_FStReject.szQcDocId,
BOS_INV_FStReject.dtmQcDoc,
BOS_INV_FStReject.szDescription,
BOS_INV_FStReject.szFAdjustmentId,
BOS_INV_FStReject.szAdjustedById,
BOS_INV_FStReject.szAdjustToId,
BOS_INV_FStReject.bResultFrTransfer,
BOS_INV_FStReject.bVoid, 
BOS_GEN_Approved.bApproved,
BOS_INV_FStReject.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FStReject.btPrintedCount,
BOS_INV_FStReject.bTransferred,
BOS_INV_FStReject.szCompanyId,
BOS_INV_FStReject.szWorkplaceId,
BOS_INV_FStReject.szTaxEntityId,
BOS_INV_FStReject.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FStReject.dtmCreated,
BOS_INV_FStReject.bSystemCreated,
BOS_INV_FStReject.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FStReject.dtmLastUpdated,
BOS_INV_FStReject.bAlreadyTransferred


FROM
BOS_INV_FStReject LEFT JOIN BOS_GEN_Approved ON BOS_INV_FStReject.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_INV_FStReject.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_PI_Employee ON BOS_INV_FStReject.szEmployeeId = BOS_PI_Employee.szEmployeeId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FStReject.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FStReject.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FStReject.szUserId

WHERE
BOS_INV_FStReject.szFStRejectId = p_szFStRejectId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_GetFStRejectItem(
p_szFStRejectId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_FStRejectItem.shItemNumber,
BOS_INV_FStRejectItem.szProductId,
b1.szName as szProductName,
b1.szNickName As szProductNickName_J,
b1.szQtyFormat as szProductQtyFormat,
b1.szTrackingType as szProductTrackingType,

BOS_INV_FStRejectItem.decQty,
BOS_INV_FStRejectItem.decUomQty,

BOS_INV_FStRejectItem.szUomId,

b1.szCompUomId,
b1.szUomClassId AS szProductUomClassId_J,
b1.szUomId AS szProductUomId,

BOS_INV_FStRejectItem.szConditionTypeId,
BOS_INV_FStRejectItem.szSuggestionTypeId,

BOS_INV_FStRejectItem.szProductIdTobeSold,
b2.szName as szProductNmToBeSold,
b2.szNickName As szProductNickNameToBeSold_J,
b2.szQtyFormat as szProductQtyFormatToBeSold,
BOS_INV_FStRejectItem.szStockTypeIdToBeSold,

BOS_INV_FStRejectItem.decQtyToBeSold,
BOS_INV_FStRejectItem.decUomQtyToBeSold,

BOS_INV_FStRejectItem.szUomIdToBeSold,

b2.szCompUomId AS szCompUomId_ToBeSold,
b2.szUomClassId AS szProductUomClassIdTobeSold_J,
b2.szUomId AS szProductUomId_ToBeSold,

BOS_INV_FStRejectItem.decCOGS,
BOS_INV_FStRejectItem.decNewProductCOGS,
BOS_INV_FStRejectItem.szReasonId,

BOS_INV_FStRejectItem.szParentId,
BOS_INV_FStRejectItem.szParentIdToBeSold,
b3.szName AS szParentNm,
b4.szName AS szParentNmToBeSold

FROM
BOS_INV_FStRejectItem 
left join BOS_INV_Product as b1 on BOS_INV_FStRejectItem.szProductId = b1.szProductId
left join BOS_INV_Product as b2 on BOS_INV_FStRejectItem.szProductIdTobeSold = b2.szProductId
left join BOS_INV_Product as b3 on BOS_INV_FStRejectItem.szParentId = b3.szProductId
left join BOS_INV_Product as b4 on BOS_INV_FStRejectItem.szParentIdTobeSold = b4.szProductId

WHERE
szFStRejectId=p_szFStRejectId

-- ==================================================================

set ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_GetFStRejectItem_014(
p_szFStRejectId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_FStRejectItem.shItemNumber,
BOS_INV_FStRejectItem.szProductId,
b1.szName as szProductName,
b1.szNickName As szProductNickName_J,
b1.szQtyFormat as szProductQtyFormat,
b1.szTrackingType as szProductTrackingType,

BOS_INV_FStRejectItem.decQty,
BOS_INV_FStRejectItem.decUomQty,

BOS_INV_FStRejectItem.szUomId,

b1.szCompUomId,
b1.szUomClassId AS szProductUomClassId_J,
b1.szUomId AS szProductUomId,

BOS_INV_FStRejectItem.szConditionTypeId,
BOS_INV_FStRejectItem.szSuggestionTypeId,

BOS_INV_FStRejectItem.szProductIdTobeSold,
b2.szName as szProductNmToBeSold,
b2.szNickName As szProductNickNameToBeSold_J,
b2.szQtyFormat as szProductQtyFormatToBeSold,
BOS_INV_FStRejectItem.szStockTypeIdToBeSold,

BOS_INV_FStRejectItem.decQtyToBeSold,
BOS_INV_FStRejectItem.decUomQtyToBeSold,

BOS_INV_FStRejectItem.szUomIdToBeSold,

b2.szCompUomId AS szCompUomId_ToBeSold,
b2.szUomClassId AS szProductUomClassIdTobeSold_J,
b2.szUomId AS szProductUomId_ToBeSold,

BOS_INV_FStRejectItem.decCOGS,
BOS_INV_FStRejectItem.decNewProductCOGS,
BOS_INV_FStRejectItem.szReasonId,

BOS_INV_FStRejectItem.szParentId,
BOS_INV_FStRejectItem.szParentIdToBeSold,
b3.szName AS szParentNm,
b4.szName AS szParentNmToBeSold

FROM
BOS_INV_FStRejectItem 
left join BOS_INV_Product as b1 on BOS_INV_FStRejectItem.szProductId = b1.szProductId
left join BOS_INV_Product as b2 on BOS_INV_FStRejectItem.szProductIdTobeSold = b2.szProductId
left join BOS_INV_Product as b3 on BOS_INV_FStRejectItem.szParentId = b3.szProductId
left join BOS_INV_Product as b4 on BOS_INV_FStRejectItem.szParentIdTobeSold = b4.szProductId

WHERE
szFStRejectId=p_szFStRejectId

-- ==================================================================

set ANSI_NULLS ON


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_GetFStRejectItemLotQty(
p_szFStRejectId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLotId,
decQty


FROM 
BOS_INV_FStRejectItemLotQty
WHERE 
szFStRejectId=p_szFStRejectId AND shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_GetFStRejectItemSn(
p_szFStRejectId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemNumber,
shItem2Number,
szProductSn


FROM 
BOS_INV_FStRejectItemSn
WHERE 
szFStRejectId=p_szFStRejectId AND shItemNumber=p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_GetListOfFStReject(
p_szFStRejectId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 

szFStRejectId,
dtmDocument


FROM 
BOS_INV_FStReject

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_IsFStRejectExist(
p_szFStRejectId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 

szFStRejectId


FROM 
BOS_INV_FStReject
WHERE 
szFStRejectId = p_szFStRejectId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_LockFStReject(
p_szFStRejectId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FStReject
SET 
szEmployeeId=szEmployeeId
WHERE 
szFStRejectId=p_szFStRejectId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_UpdateFStReject(
p_szFStRejectId BOS_DT_szId,
p_dtmDocument timestamp,
p_szRefDocType varchar,
p_szRefDoc varchar,
p_szWhId BOS_DT_szId,
p_szDepartmentId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szEmployeeId BOS_DT_szId,
p_szQcDocId BOS_DT_szId,
p_dtmQcDoc timestamp,
p_szDescription varchar,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount bit,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FStReject
SET 

szFStRejectId=p_szFStRejectId,
dtmDocument=p_dtmDocument,
szRefDocType=p_szRefDocType,
szRefDoc=p_szRefDoc,
szWhId=p_szWhId,
szDepartmentId=p_szDepartmentId,
szStockTypeId=p_szStockTypeId,
szEmployeeId=p_szEmployeeId,
szQcDocId=p_szQcDocId,
dtmQcDoc=p_dtmQcDoc,
szDescription=p_szDescription,
bVoid=p_bVoid,
bApplied=p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFStRejectId=p_szFStRejectId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FStReject_UpdateFStReject_013(
p_szFStRejectId BOS_DT_szId,
p_dtmDocument timestamp,
p_szRefDocType varchar,
p_szRefDoc varchar,
p_szWhId BOS_DT_szId,
p_szDepartmentId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szEmployeeId BOS_DT_szId,
p_szQcDocId BOS_DT_szId,
p_dtmQcDoc timestamp,
p_szDescription varchar,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount bit,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FStReject
SET 

szFStRejectId=p_szFStRejectId,
dtmDocument=p_dtmDocument,
szRefDocType=p_szRefDocType,
szRefDoc=p_szRefDoc,
szWhId=p_szWhId,
szDepartmentId=p_szDepartmentId,
szStockTypeId=p_szStockTypeId,
szEmployeeId=p_szEmployeeId,
szQcDocId=p_szQcDocId,
dtmQcDoc=p_dtmQcDoc,
szDescription=p_szDescription,
bVoid=p_bVoid,
bApplied=p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFStRejectId=p_szFStRejectId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_CreateFVRema(
p_szFVRemaId BOS_DT_szId,
p_dtmRemain timestamp,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FVRema
(
szFVRemaId,
dtmRemain,
szVehicleId,
szDriverId,
szDescription,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
szFAdjustmentId,
szAdjustedById,
szAdjustToId
)
VALUES
(
p_szFVRemaId,
p_dtmRemain,
p_szVehicleId,
p_szDriverId,
p_szDescription,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szFAdjustmentId,
p_szAdjustedById,
p_szAdjustToId,
SET ANSI_NULLS ON,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_CreateFVRema_013(
p_szFVRemaId BOS_DT_szId,
p_dtmRemain timestamp,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FVRema
(
szFVRemaId,
dtmRemain,
szVehicleId,
szDriverId,
szDescription,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
szFAdjustmentId,
szAdjustedById,
szAdjustToId
)
VALUES
(
p_szFVRemaId,
p_dtmRemain,
p_szVehicleId,
p_szDriverId,
p_szDescription,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szFAdjustmentId,
p_szAdjustedById,
p_szAdjustToId,
SET ANSI_NULLS ON,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_CreateFVRemaItem(
p_szFVRemaId BOS_DT_szId,
p_btItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FVRemaItem
(
szFVRemaId,
btItemNumber,
szProductId,
decQty,
decUomQty,
szUomId,
szParentId
)
VALUES
(
p_szFVRemaId,
p_btItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_szParentId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_CreateFVRemaItem_014(
p_szFVRemaId BOS_DT_szId,
p_btItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FVRemaItem
(
szFVRemaId,
btItemNumber,
szProductId,
decQty,
decUomQty,
szUomId,
szParentId
)
VALUES
(
p_szFVRemaId,
p_btItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_szUomId,
p_szParentId,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_CreateFVRemaItemLotQty(
p_szFVRemaId BOS_DT_szId,
p_btItemNumber smallint,
p_szLotId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FVRemaItemLotQty
(
szFVRemaId,
btItemNumber,
szLotId,
decQty,
)
VALUES
(
p_szFVRemaId,
p_btItemNumber,
p_szLotId,
p_decQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_CreateFVRemaItemSn(
p_szFVRemaId BOS_DT_szId,
p_btItemNumber smallint,
p_shItemSnNumber smallint,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_FVRemaItemSn
(
szFVRemaId,
btItemNumber,
shItemSnNumber,
szProductSn
)
VALUES
(
p_szFVRemaId,
p_btItemNumber,
p_shItemSnNumber,
p_szProductSn
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_DeleteFVRema(
p_szFVRemaId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_INV_FVRema
WHERE
szFVRemaId = p_szFVRemaId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_DeleteFVRemaItem(
p_szFVRemaId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_INV_FVRemaItem
WHERE
szFVRemaId = p_szFVRemaId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_DeleteFVRemaItemLotQty(
p_szFVRemaId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_INV_FVRemaItemLotQty
WHERE
szFVRemaId = p_szFVRemaId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_DeleteFVRemaItemSn(
p_szFVRemaId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_INV_FVRemaItemSn
WHERE
szFVRemaId = p_szFVRemaId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_GetFVRema(
p_szFVRemaId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_FVRema.dtmRemain,
BOS_INV_FVRema.szVehicleId,
BOS_INV_Vehicle.szPoliceNo as szVehicleNo,
BOS_INV_FVRema.szDriverId,
BOS_PI_Employee.szName as szDriverNm,
BOS_INV_FVRema.szDescription,

BOS_INV_FVRema.bResultFrTransfer,
BOS_INV_FVRema.bVoid,
BOS_GEN_Approved.bApproved,
BOS_INV_FVRema.bApplied,
BOS_GL_FJournalTrans.szFJournalId AS bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FVRema.btPrintedCount,
BOS_INV_FVRema.bTransferred,
BOS_INV_FVRema.szCompanyId,
BOS_INV_FVRema.szWorkplaceId,
BOS_INV_FVRema.szTaxEntityId,
BOS_INV_FVRema.bNeedApproval,
BOS_INV_FVRema.gdApprovedId,
BOS_INV_FVRema.szFAdjustmentId,
BOS_INV_FVRema.szAdjustedById,
BOS_INV_FVRema.szAdjustToId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FVRema.dtmCreated,
BOS_INV_FVRema.bSystemCreated,
BOS_INV_FVRema.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FVRema.dtmLastUpdated,
BOS_INV_FVRema.bAlreadyTransferred

FROM
BOS_INV_FVRema LEFT JOIN BOS_GEN_Approved ON BOS_INV_FVRema.gdApprovedId=BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_INV_FVRema.szFJournalId=BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_PI_Employee ON BOS_INV_FVRema.szDriverId = BOS_PI_Employee.szEmployeeId
LEFT JOIN BOS_INV_Vehicle ON BOS_INV_FVRema.szVehicleId = BOS_INV_Vehicle.szVehicleId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FVRema.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FVRema.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FVRema.szUserId

WHERE
BOS_INV_FVRema.szFVRemaId = p_szFVRemaId


SET ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_GetFVRema_013(
p_szFVRemaId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_FVRema.dtmRemain,
BOS_INV_FVRema.szVehicleId,
BOS_INV_Vehicle.szPoliceNo as szVehicleNo,
BOS_INV_FVRema.szDriverId,
BOS_PI_Employee.szName as szDriverNm,
BOS_INV_FVRema.szDescription,

BOS_INV_FVRema.bResultFrTransfer,
BOS_INV_FVRema.bVoid,
BOS_GEN_Approved.bApproved,
BOS_INV_FVRema.bApplied,
BOS_GL_FJournalTrans.szFJournalId AS bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_INV_FVRema.btPrintedCount,
BOS_INV_FVRema.bTransferred,
BOS_INV_FVRema.szCompanyId,
BOS_INV_FVRema.szWorkplaceId,
BOS_INV_FVRema.szTaxEntityId,
BOS_INV_FVRema.bNeedApproval,
BOS_INV_FVRema.gdApprovedId,
BOS_INV_FVRema.szFAdjustmentId,
BOS_INV_FVRema.szAdjustedById,
BOS_INV_FVRema.szAdjustToId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_INV_FVRema.dtmCreated,
BOS_INV_FVRema.bSystemCreated,
BOS_INV_FVRema.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_INV_FVRema.dtmLastUpdated,
BOS_INV_FVRema.bAlreadyTransferred

FROM
BOS_INV_FVRema LEFT JOIN BOS_GEN_Approved ON BOS_INV_FVRema.gdApprovedId=BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_INV_FVRema.szFJournalId=BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_PI_Employee ON BOS_INV_FVRema.szDriverId = BOS_PI_Employee.szEmployeeId
LEFT JOIN BOS_INV_Vehicle ON BOS_INV_FVRema.szVehicleId = BOS_INV_Vehicle.szVehicleId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FVRema.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_INV_FVRema.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_INV_FVRema.szUserId

WHERE
BOS_INV_FVRema.szFVRemaId = p_szFVRemaId


SET ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_GetFVRemaItemLotQty(
p_szFVRemaId BOS_DT_szId,
p_btItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLotId,
decQty


FROM 
BOS_INV_FVRemaItemLotQty

WHERE 
szFVRemaId = p_szFVRemaId And btItemNumber = p_btItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_GetFVRemaItemSn(
p_szFVRemaId BOS_DT_szId,
p_btItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemSnNumber,
szProductSn

FROM 
BOS_INV_FVRemaItemSn
WHERE 
szFVRemaId = p_szFVRemaId AND btItemNumber = p_btItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_GetListOfFVRema()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFVRemaId,
dtmRemain

FROM 
BOS_INV_FVRema

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_IsFVRemaExist(
p_szFVRemaId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFVRemaId

FROM 
BOS_INV_FVRema
WHERE 
szFVRemaId = p_szFVRemaId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_LockFVRema(
p_szFVRemaId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FVRema
SET 
bTransferred = bTransferred
WHERE 
szFVRemaId = p_szFVRemaId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_UpdateFVRema(
p_szFVRemaId BOS_DT_szId,
p_dtmRemain timestamp,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FVRema
SET 
dtmRemain = p_dtmRemain,
szVehicleId = p_szVehicleId,
szDriverId = p_szDriverId,
bVoid=p_bVoid,
bApplied=p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
szDescription=p_szDescription,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId,

szFAdjustmentId = p_szFAdjustmentId,
szAdjustedById =  p_szAdjustedById,
szAdjustToId = p_szAdjustToId

WHERE 
szFVRemaId = p_szFVRemaId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_FVRema_UpdateFVRema_013(
p_szFVRemaId BOS_DT_szId,
p_dtmRemain timestamp,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_szFAdjustmentId BOS_DT_szId,
p_szAdjustedById BOS_DT_szId,
p_szAdjustToId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_FVRema
SET 
dtmRemain = p_dtmRemain,
szVehicleId = p_szVehicleId,
szDriverId = p_szDriverId,
bVoid=p_bVoid,
bApplied=p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
szDescription=p_szDescription,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId,

szFAdjustmentId = p_szFAdjustmentId,
szAdjustedById =  p_szAdjustedById,
szAdjustToId = p_szAdjustToId

WHERE 
szFVRemaId = p_szFVRemaId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_LotInfo_CreateLotInfo(
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_decLotStrength BOS_DT_decAmount,
p_szLotTypeId BOS_DT_szId,
p_szProductionCode varchar,
p_dtmExpired timestamp,
p_szLotStatus varchar,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_LotInfo
(
  ,
szLotId  ,
szProductId  ,
decLotStrength  ,
szLotTypeId  ,
szProductionCode  ,
dtmExpired  ,
szLotStatus,
dtmLastUpdated  
  ,
)
VALUES
(
p_szLotId,
p_szProductId,
p_decLotStrength,
p_szLotTypeId,
p_szProductionCode,
p_dtmExpired,
p_szLotStatus,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_LotInfo_CreateLotInfo_014(
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_decLotStrength BOS_DT_decAmount,
p_szLotTypeId BOS_DT_szId,
p_szProductionCode varchar,
p_dtmExpired timestamp,
p_szLotStatus varchar,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_LotInfo
(
  ,
szLotId  ,
szProductId  ,
decLotStrength  ,
szLotTypeId  ,
szProductionCode  ,
dtmExpired  ,
szLotStatus,
dtmLastUpdated  
  ,
)
VALUES
(
p_szLotId,
p_szProductId,
p_decLotStrength,
p_szLotTypeId,
p_szProductionCode,
p_dtmExpired,
p_szLotStatus,
p_dtmLastUpdated,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_LotInfo_DeleteLotInfo(
p_szLotId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_LotInfo
WHERE
szLotId=p_szLotId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_LotInfo_GetListLotInfoByProduct()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLotId

FROM 
BOS_INV_LotInfo

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_LotInfo_GetLotInfo(
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_LotInfo.szLotTypeId,

FROM 
BOS_INV_LotInfo left join BOS_INV_Product on BOS_INV_LotInfo.szProductId=BOS_INV_Product.szProductId
WHERE 
BOS_INV_LotInfo.szLotId = p_szLotId and BOS_INV_LotInfo.szProductId = p_szProductId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_LotInfo_IsLotInfoExist(
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLotId 

FROM 
BOS_INV_LotInfo 
WHERE 
szLotId = p_szLotId and szProductId = p_szProductId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_LotInfo_LockLotInfo(
p_szLotId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_LotInfo
SET 
szLotStatus= szLotStatus
WHERE 
szLotId=p_szLotId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_CreateOrderItemType(
p_szOrderItemTypeId BOS_DT_szId,
p_bTaxable bit,
p_bSubjectToInvoice bit,
p_szTrnType BOS_DT_szSmallId,
p_szRentChargeCalcId BOS_DT_szId,
p_szPaymentTermId BOS_DT_szId,
p_szInvoiceGroupId BOS_DT_szId,
p_bApplicable4AllProduct bit,
p_bApplicable4AllDistrChannel bit,
p_bApplicable4AllSalesOrg bit,
p_bApplicable4AllWorkplace bit,
p_bApplicable4AllCust bit,
p_gdAuditTrailId bytea,
p_szReturnOrderItemTypeId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_bMustFillTrnReason BOS_DT_bBoolean,
p_bAllowEmptyTrnReason BOS_DT_bBoolean,
p_bAllowDifferentSignInQty BOS_DT_bBoolean,
p_bAllowZeroPrice BOS_DT_bBoolean,
p_bAllowNegativeQty BOS_DT_bBoolean,
p_bAllowPositiveQty BOS_DT_bBoolean,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_OrderItemType
(
szOrderItemTypeId,
bTaxable,
bSubjectToInvoice,
szTrnType,
szRentChargeCalcId,
szPaymentTermId,
szInvoiceGroupId,
bApplicable4AllProduct,
bApplicable4AllDistrChannel,
bApplicable4AllSalesOrg,
bApplicable4AllWorkplace,
bApplicable4AllCust,
gdAuditTrailId,
szReturnOrderItemTypeId,
szPriceId,
szPromoPriceId,
bMustFillTrnReason,
bAllowEmptyTrnReason,
bAllowDifferentSignInQty,
bAllowZeroPrice,
bAllowNegativeQty,
bAllowPositiveQty,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szOrderItemTypeId,
p_bTaxable,
p_bSubjectToInvoice,
p_szTrnType,
p_szRentChargeCalcId,
p_szPaymentTermId,
p_szInvoiceGroupId,
p_bApplicable4AllProduct,
p_bApplicable4AllDistrChannel,
p_bApplicable4AllSalesOrg,
p_bApplicable4AllWorkplace,
p_bApplicable4AllCust,
p_gdAuditTrailId,
p_szReturnOrderItemTypeId,
p_szPriceId,
p_szPromoPriceId,
p_bMustFillTrnReason,
p_bAllowEmptyTrnReason,
p_bAllowDifferentSignInQty,
p_bAllowZeroPrice,
p_bAllowNegativeQty,
p_bAllowPositiveQty,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_CreateOrderItemType_013(
p_szOrderItemTypeId BOS_DT_szId,
p_bTaxable bit,
p_bSubjectToInvoice bit,
p_szTrnType BOS_DT_szSmallId,
p_szRentChargeCalcId BOS_DT_szId,
p_szPaymentTermId BOS_DT_szId,
p_szInvoiceGroupId BOS_DT_szId,
p_bApplicable4AllProduct bit,
p_bApplicable4AllDistrChannel bit,
p_bApplicable4AllSalesOrg bit,
p_bApplicable4AllWorkplace bit,
p_bApplicable4AllCust bit,
p_gdAuditTrailId bytea,
p_szReturnOrderItemTypeId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_bMustFillTrnReason BOS_DT_bBoolean,
p_bAllowEmptyTrnReason BOS_DT_bBoolean,
p_bAllowDifferentSignInQty BOS_DT_bBoolean,
p_bAllowZeroPrice BOS_DT_bBoolean,
p_bAllowNegativeQty BOS_DT_bBoolean,
p_bAllowPositiveQty BOS_DT_bBoolean,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_OrderItemType
(
szOrderItemTypeId,
bTaxable,
bSubjectToInvoice,
szTrnType,
szRentChargeCalcId,
szPaymentTermId,
szInvoiceGroupId,
bApplicable4AllProduct,
bApplicable4AllDistrChannel,
bApplicable4AllSalesOrg,
bApplicable4AllWorkplace,
bApplicable4AllCust,
gdAuditTrailId,
szReturnOrderItemTypeId,
szPriceId,
szPromoPriceId,
bMustFillTrnReason,
bAllowEmptyTrnReason,
bAllowDifferentSignInQty,
bAllowZeroPrice,
bAllowNegativeQty,
bAllowPositiveQty,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szOrderItemTypeId,
p_bTaxable,
p_bSubjectToInvoice,
p_szTrnType,
p_szRentChargeCalcId,
p_szPaymentTermId,
p_szInvoiceGroupId,
p_bApplicable4AllProduct,
p_bApplicable4AllDistrChannel,
p_bApplicable4AllSalesOrg,
p_bApplicable4AllWorkplace,
p_bApplicable4AllCust,
p_gdAuditTrailId,
p_szReturnOrderItemTypeId,
p_szPriceId,
p_szPromoPriceId,
p_bMustFillTrnReason,
p_bAllowEmptyTrnReason,
p_bAllowDifferentSignInQty,
p_bAllowZeroPrice,
p_bAllowNegativeQty,
p_bAllowPositiveQty,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_CreateOrderItemTypeCust(
p_szOrderItemTypeId BOS_DT_szId,
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_OrderItemTypeCust
(
szOrderItemTypeId,
szCustId
)
VALUES
(
p_szOrderItemTypeId,
p_szCustId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_CreateOrderItemTypeDistrChannel(
p_szOrderItemTypeId BOS_DT_szId,
p_btItemNumber smallint,
p_szDistrChannelId varchar)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_OrderItemTypeDistrChannel
(
szOrderItemTypeId,
btItemNumber,
szDistrChannelId
)
VALUES
(
p_szOrderItemTypeId,
p_btItemNumber,
p_szDistrChannelId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_CreateOrderItemTypeProduct(
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_OrderItemTypeProduct
(
szOrderItemTypeId,
szProductId
)
VALUES
(
p_szOrderItemTypeId,
p_szProductId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_CreateOrderItemTypeSalesOrg(
p_szOrderItemTypeId BOS_DT_szId,
p_btItemNumber smallint,
p_szSalesOrgId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_OrderItemTypeSalesOrg
(
szOrderItemTypeId,
btItemNumber,
szSalesOrgId
)
VALUES
(
p_szOrderItemTypeId,
p_btItemNumber,
p_szSalesOrgId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_CreateOrderItemTypeWorkplace(
p_szOrderItemTypeId BOS_DT_szId,
p_btItemNumber smallint,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_OrderItemTypeWorkplace
(
szOrderItemTypeId,
btItemNumber,
szWorkplaceId
)
VALUES
(
p_szOrderItemTypeId,
p_btItemNumber,
p_szWorkplaceId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_DeleteOrderItemType(
p_szOrderItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_INV_OrderItemType
WHERE
szOrderItemTypeId=p_szOrderItemTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_DeleteOrderItemTypeCust(
p_szOrderItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_INV_OrderItemTypeCust
WHERE
szOrderItemTypeId=p_szOrderItemTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_DeleteOrderItemTypeDistrChannel(
p_szOrderItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_INV_OrderItemTypeDistrChannel
WHERE
szOrderItemTypeId=p_szOrderItemTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_DeleteOrderItemTypeProduct(
p_szOrderItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_INV_OrderItemTypeProduct
WHERE
szOrderItemTypeId=p_szOrderItemTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_DeleteOrderItemTypeSalesOrg(
p_szOrderItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_INV_OrderItemTypeSalesOrg
WHERE
szOrderItemTypeId=p_szOrderItemTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_DeleteOrderItemTypeWorkplace(
p_szOrderItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_INV_OrderItemTypeWorkplace
WHERE
szOrderItemTypeId=p_szOrderItemTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_GetListOfOrderItemType(
p_szTrnType BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szOrderItemTypeId, szTrnType


FROM 
BOS_INV_OrderItemType

WHERE 
szTrnType LIKE p_szTrnType ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_GetOrderItemType(
p_szOrderItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
bTaxable,
bSubjectToInvoice,
szTrnType,
szRentChargeCalcId,
BOS_INV_OrderItemType.szPaymentTermId,
BOS_AR_PaymentTerm.intMaxPaymentDay AS intPaymentTermMaxPaymentDay_J,
BOS_INV_OrderItemType.szInvoiceGroupId,
bApplicable4AllProduct,
bApplicable4AllDistrChannel,
bApplicable4AllSalesOrg,
bApplicable4AllWorkplace,
bApplicable4AllCust,
gdAuditTrailId,
szReturnOrderItemTypeId,
szPriceId,
szPromoPriceId,
bMustFillTrnReason,
bAllowEmptyTrnReason,
bAllowDifferentSignInQty,
bAllowZeroPrice,
bAllowNegativeQty,
bAllowPositiveQty,

BOS_INV_OrderItemType.dtmLastUpdated,
BOS_INV_OrderItemType.bAlreadyTransferred

FROM 
BOS_INV_OrderItemType
LEFT JOIN BOS_AR_PaymentTerm ON BOS_AR_PaymentTerm.szPaymentTermId = BOS_INV_OrderItemType.szPaymentTermIdLEFT JOIN BOS_AR_PaymentTerm ON BOS_AR_PaymentTerm.szPaymentTermId = BOS_INV_OrderItemType.szPaymentTermId;
WHERE 
szOrderItemTypeId=p_szOrderItemTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_GetOrderItemTypeCust(
p_szOrderItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_OrderItemTypeCust.szCustId,
ISNULL(BOS_AR_Category.szDescription,'') AS szCustNm_J


FROM 
BOS_INV_OrderItemTypeCust
LEFT JOIN BOS_AR_Category ON BOS_AR_Category.szCategoryId = BOS_INV_OrderItemTypeCust.szCustIdLEFT JOIN BOS_AR_Category ON BOS_AR_Category.szCategoryId = BOS_INV_OrderItemTypeCust.szCustId;

WHERE 
BOS_INV_OrderItemTypeCust.szOrderItemTypeId = p_szOrderItemTypeId /****** Object:  StoredProcedure [dbo].[BOS_INV_OrderType_GetOrderTypeCust]    Script Date: 04/20/2015 17:10:47 ******/ SET ANSI_NULLS ON ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_GetOrderItemTypeCust_014(
p_szOrderItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_OrderItemTypeCust.szCustId,
ISNULL(BOS_AR_Category.szDescription,'') AS szCustNm_J


FROM 
BOS_INV_OrderItemTypeCust
LEFT JOIN BOS_AR_Category ON BOS_AR_Category.szCategoryId = BOS_INV_OrderItemTypeCust.szCustIdLEFT JOIN BOS_AR_Category ON BOS_AR_Category.szCategoryId = BOS_INV_OrderItemTypeCust.szCustId;

WHERE 
BOS_INV_OrderItemTypeCust.szOrderItemTypeId = p_szOrderItemTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_GetOrderItemTypeDistrChannel(
p_szOrderItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
btItemNumber,
szDistrChannelId

FROM 
BOS_INV_OrderItemTypeDistrChannel
WHERE 
szOrderItemTypeId=p_szOrderItemTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_GetOrderItemTypeProduct(
p_szOrderItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_OrderItemTypeProduct.szProductId,
BOS_INV_Product.szName AS szProductNm_J



FROM 
BOS_INV_OrderItemTypeProduct
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_OrderItemTypeProduct.szProductIdLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_OrderItemTypeProduct.szProductId;

WHERE 
BOS_INV_OrderItemTypeProduct.szOrderItemTypeId = p_szOrderItemTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_GetOrderItemTypeSalesOrg(
p_szOrderItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
btItemNumber,
szSalesOrgId

FROM 
BOS_INV_OrderItemTypeSalesOrg
WHERE 
szOrderItemTypeId=p_szOrderItemTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_GetOrderItemTypeWorkplace(
p_szOrderItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
btItemNumber,
szWorkplaceId

FROM 
BOS_INV_OrderItemTypeWorkplace
WHERE 
szOrderItemTypeId=p_szOrderItemTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_IsOrderItemTypeExist(
p_szOrderItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szOrderItemTypeId

FROM 
BOS_INV_OrderItemType
WHERE 
szOrderItemTypeId=p_szOrderItemTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_LockOrderItemType(
p_szOrderItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_OrderItemType
SET 
bTaxable=bTaxable
WHERE 
szOrderItemTypeId=p_szOrderItemTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_UpdateOrderItemType(
p_szOrderItemTypeId BOS_DT_szId,
p_bTaxable bit,
p_bSubjectToInvoice bit,
p_szTrnType BOS_DT_szSmallId,
p_szRentChargeCalcId BOS_DT_szId,
p_szPaymentTermId BOS_DT_szId,
p_szInvoiceGroupId BOS_DT_szId,
p_bApplicable4AllProduct bit,
p_bApplicable4AllDistrChannel bit,
p_bApplicable4AllSalesOrg bit,
p_bApplicable4AllWorkplace bit,
p_bApplicable4AllCust bit,
p_szReturnOrderItemTypeId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_bMustFillTrnReason BOS_DT_bBoolean,
p_bAllowEmptyTrnReason BOS_DT_bBoolean,
p_bAllowDifferentSignInQty BOS_DT_bBoolean,
p_bAllowZeroPrice BOS_DT_bBoolean,
p_bAllowNegativeQty BOS_DT_bBoolean,
p_bAllowPositiveQty BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_OrderItemType
SET 
bTaxable=p_bTaxable,
bSubjectToInvoice=p_bSubjectToInvoice,
szTrnType=p_szTrnType,
szRentChargeCalcId = p_szRentChargeCalcId,
szPaymentTermId = p_szPaymentTermId,
szInvoiceGroupId = p_szInvoiceGroupId,
bApplicable4AllProduct=p_bApplicable4AllProduct,
bApplicable4AllDistrChannel=p_bApplicable4AllDistrChannel,
bApplicable4AllSalesOrg=p_bApplicable4AllSalesOrg,
bApplicable4AllWorkplace=p_bApplicable4AllWorkplace,
bApplicable4AllCust=p_bApplicable4AllCust,
szReturnOrderItemTypeId = p_szReturnOrderItemTypeId,
szPriceId = p_szPriceId,
szPromoPriceId = p_szPromoPriceId,
bMustFillTrnReason = p_bMustFillTrnReason,
bAllowEmptyTrnReason = p_bAllowEmptyTrnReason,
bAllowDifferentSignInQty = p_bAllowDifferentSignInQty,
bAllowZeroPrice = p_bAllowZeroPrice,
bAllowNegativeQty = p_bAllowNegativeQty,
bAllowPositiveQty = p_bAllowPositiveQty
WHERE 
szOrderItemTypeId=p_szOrderItemTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderItemType_UpdateOrderItemType_013(
p_szOrderItemTypeId BOS_DT_szId,
p_bTaxable bit,
p_bSubjectToInvoice bit,
p_szTrnType BOS_DT_szSmallId,
p_szRentChargeCalcId BOS_DT_szId,
p_szPaymentTermId BOS_DT_szId,
p_szInvoiceGroupId BOS_DT_szId,
p_bApplicable4AllProduct bit,
p_bApplicable4AllDistrChannel bit,
p_bApplicable4AllSalesOrg bit,
p_bApplicable4AllWorkplace bit,
p_bApplicable4AllCust bit,
p_szReturnOrderItemTypeId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_bMustFillTrnReason BOS_DT_bBoolean,
p_bAllowEmptyTrnReason BOS_DT_bBoolean,
p_bAllowDifferentSignInQty BOS_DT_bBoolean,
p_bAllowZeroPrice BOS_DT_bBoolean,
p_bAllowNegativeQty BOS_DT_bBoolean,
p_bAllowPositiveQty BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_OrderItemType
SET 
bTaxable=p_bTaxable,
bSubjectToInvoice=p_bSubjectToInvoice,
szTrnType=p_szTrnType,
szRentChargeCalcId = p_szRentChargeCalcId,
szPaymentTermId = p_szPaymentTermId,
szInvoiceGroupId = p_szInvoiceGroupId,
bApplicable4AllProduct=p_bApplicable4AllProduct,
bApplicable4AllDistrChannel=p_bApplicable4AllDistrChannel,
bApplicable4AllSalesOrg=p_bApplicable4AllSalesOrg,
bApplicable4AllWorkplace=p_bApplicable4AllWorkplace,
bApplicable4AllCust=p_bApplicable4AllCust,
szReturnOrderItemTypeId = p_szReturnOrderItemTypeId,
szPriceId = p_szPriceId,
szPromoPriceId = p_szPromoPriceId,
bMustFillTrnReason = p_bMustFillTrnReason,
bAllowEmptyTrnReason = p_bAllowEmptyTrnReason,
bAllowDifferentSignInQty = p_bAllowDifferentSignInQty,
bAllowZeroPrice = p_bAllowZeroPrice,
bAllowNegativeQty = p_bAllowNegativeQty,
bAllowPositiveQty = p_bAllowPositiveQty
WHERE 
szOrderItemTypeId=p_szOrderItemTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_CreateOrderType(
p_szOrderTypeId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bAllowManualPrice bit,
p_bAllowToChangeLinePriceDate BOS_DT_bBoolean,
p_szApprovalId BOS_DT_szId,
p_szFlexiKeyId BOS_DT_szId,
p_bApplicable4AllOrderItemType bit,
p_bApplicable4AllProduct bit,
p_bApplicable4AllDistrChannel bit,
p_bApplicable4AllSalesOrg bit,
p_bApplicable4AllWorkplace bit,
p_bApplicable4AllCust bit,
p_szReturnOrderTypeId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_OrderType
(
szOrderTypeId ,
szDescription ,
bAllowManualPrice ,
bAllowToChangeLinePriceDate,
szApprovalId ,
szFlexiKeyId ,
bApplicable4AllOrderItemType ,
bApplicable4AllProduct ,
bApplicable4AllDistrChannel ,
bApplicable4AllSalesOrg ,
bApplicable4AllWorkplace ,
bApplicable4AllCust,
szReturnOrderTypeId,
szPriceId,
szPriceOrderId,
szPromoPriceId,
szPromoPriceOrderId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szOrderTypeId ,
p_szDescription ,
p_bAllowManualPrice ,
p_bAllowToChangeLinePriceDate,
p_szApprovalId ,
p_szFlexiKeyId ,
p_bApplicable4AllOrderItemType ,
p_bApplicable4AllProduct ,
p_bApplicable4AllDistrChannel ,
p_bApplicable4AllSalesOrg ,
p_bApplicable4AllWorkplace ,
p_bApplicable4AllCust,
p_szReturnOrderTypeId,
p_szPriceId,
p_szPriceOrderId,
p_szPromoPriceId,
p_szPromoPriceOrderId,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_CreateOrderType_013(
p_szOrderTypeId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bAllowManualPrice bit,
p_bAllowToChangeLinePriceDate BOS_DT_bBoolean,
p_szApprovalId BOS_DT_szId,
p_szFlexiKeyId BOS_DT_szId,
p_bApplicable4AllOrderItemType bit,
p_bApplicable4AllProduct bit,
p_bApplicable4AllDistrChannel bit,
p_bApplicable4AllSalesOrg bit,
p_bApplicable4AllWorkplace bit,
p_bApplicable4AllCust bit,
p_szReturnOrderTypeId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_OrderType
(
szOrderTypeId ,
szDescription ,
bAllowManualPrice ,
bAllowToChangeLinePriceDate,
szApprovalId ,
szFlexiKeyId ,
bApplicable4AllOrderItemType ,
bApplicable4AllProduct ,
bApplicable4AllDistrChannel ,
bApplicable4AllSalesOrg ,
bApplicable4AllWorkplace ,
bApplicable4AllCust,
szReturnOrderTypeId,
szPriceId,
szPriceOrderId,
szPromoPriceId,
szPromoPriceOrderId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szOrderTypeId ,
p_szDescription ,
p_bAllowManualPrice ,
p_bAllowToChangeLinePriceDate,
p_szApprovalId ,
p_szFlexiKeyId ,
p_bApplicable4AllOrderItemType ,
p_bApplicable4AllProduct ,
p_bApplicable4AllDistrChannel ,
p_bApplicable4AllSalesOrg ,
p_bApplicable4AllWorkplace ,
p_bApplicable4AllCust,
p_szReturnOrderTypeId,
p_szPriceId,
p_szPriceOrderId,
p_szPromoPriceId,
p_szPromoPriceOrderId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_CreateOrderTypeCust(
p_szOrderTypeId BOS_DT_szId,
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_OrderTypeCust
(
szOrderTypeId ,
szCustId
)
VALUES
(
p_szOrderTypeId ,
p_szCustId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_CreateOrderTypeDistrChannel(
p_szOrderTypeId BOS_DT_szId,
p_btItemNumber smallint,
p_szDistrChannelId varchar)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_OrderTypeDistrChannel
(
szOrderTypeId ,
btItemNumber ,
szDistrChannelId
)
VALUES
(
p_szOrderTypeId ,
p_btItemNumber ,
p_szDistrChannelId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_CreateOrderTypeOrderItemType(
p_szOrderTypeId BOS_DT_szId,
p_btItemNumber smallint,
p_szOrderItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_OrderTypeOrderItemType
(
szOrderTypeId ,
btItemNumber ,
szOrderItemTypeId
)
VALUES
(
p_szOrderTypeId ,
p_btItemNumber ,
p_szOrderItemTypeId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_CreateOrderTypeProduct(
p_szOrderTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_OrderTypeProduct
(
szOrderTypeId ,
szProductId
)
VALUES
(
p_szOrderTypeId ,
p_szProductId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_CreateOrderTypeSalesOrg(
p_szOrderTypeId BOS_DT_szId,
p_btItemNumber smallint,
p_szSalesOrgId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_OrderTypeSalesOrg
(
szOrderTypeId ,
btItemNumber ,
szSalesOrgId
)
VALUES
(
p_szOrderTypeId ,
p_btItemNumber ,
p_szSalesOrgId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_CreateOrderTypeWorkplace(
p_szOrderTypeId BOS_DT_szId,
p_btItemNumber smallint,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_OrderTypeWorkplace
(
szOrderTypeId ,
btItemNumber ,
szWorkplaceId
)
VALUES
(
p_szOrderTypeId ,
p_btItemNumber ,
p_szWorkplaceId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_DeleteOrderType(
p_szOrderTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_OrderType
WHERE
szOrderTypeId=p_szOrderTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_DeleteOrderTypeCust(
p_szOrderTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_OrderTypeCust
WHERE
szOrderTypeId=p_szOrderTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_DeleteOrderTypeDistrChannel(
p_szOrderTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_OrderTypeDistrChannel
WHERE
szOrderTypeId=p_szOrderTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_DeleteOrderTypeOrderItemType(
p_szOrderTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_OrderTypeOrderItemType
WHERE
szOrderTypeId=p_szOrderTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_DeleteOrderTypeProduct(
p_szOrderTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_OrderTypeProduct
WHERE
szOrderTypeId=p_szOrderTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_DeleteOrderTypeSalesOrg(
p_szOrderTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_OrderTypeSalesOrg
WHERE
szOrderTypeId=p_szOrderTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_DeleteOrderTypeWorkplace(
p_szOrderTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_OrderTypeWorkplace
WHERE
szOrderTypeId=p_szOrderTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_DEV_DeleteALL()
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_OrderTypeCust;
DELETE 
BOS_INV_OrderTypeDistrChannel;
DELETE 
BOS_INV_OrderTypeOrderItemType;
DELETE 
BOS_INV_OrderTypeProduct;
DELETE 
BOS_INV_OrderTypeSalesOrg;
DELETE 
BOS_INV_OrderTypeWorkplace;
DELETE 
BOS_INV_OrderType;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_GetListOfOrderType()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szOrderTypeId,
szDescription

FROM 
BOS_INV_OrderType

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_GetOrderType(
p_szOrderTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_OrderType.szDescription,

BOS_INV_OrderType.bAllowManualPrice,
BOS_INV_OrderType.bAllowToChangeLinePriceDate,

BOS_INV_OrderType.szApprovalId,
BOS_INV_OrderType.szFlexiKeyId,
BOS_INV_OrderType.bApplicable4AllOrderItemType,
BOS_INV_OrderType.bApplicable4AllProduct,
BOS_INV_OrderType.bApplicable4AllDistrChannel,
BOS_INV_OrderType.bApplicable4AllSalesOrg,
BOS_INV_OrderType.bApplicable4AllWorkplace,
BOS_INV_OrderType.bApplicable4AllCust,

BOS_INV_OrderType.szReturnOrderTypeId,
ROT.bAllowManualPrice AS bReturnOrderTypeAllowManualPrice_J,

BOS_INV_OrderType.szPriceId,
BOS_INV_OrderType.szPriceOrderId,
BOS_INV_OrderType.szPromoPriceId,
BOS_INV_OrderType.szPromoPriceOrderId,

BOS_INV_OrderType.dtmLastUpdated,
BOS_INV_OrderType.bAlreadyTransferred


FROM 
BOS_INV_OrderType
LEFT JOIN BOS_INV_OrderType AS ROT ON ROT.szOrderTypeId = BOS_INV_OrderType.szReturnOrderTypeIdLEFT JOIN BOS_INV_OrderType AS ROT ON ROT.szOrderTypeId = BOS_INV_OrderType.szReturnOrderTypeId;

WHERE 
BOS_INV_OrderType.szOrderTypeId = p_szOrderTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_GetOrderTypeCust(
p_szOrderTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_OrderTypeCust.szCustId,
ISNULL(BOS_AR_Category.szDescription,'') AS szCustNm_J


FROM 
BOS_INV_OrderTypeCust
LEFT JOIN BOS_AR_Category ON BOS_AR_Category.szCategoryId = BOS_INV_OrderTypeCust.szCustIdLEFT JOIN BOS_AR_Category ON BOS_AR_Category.szCategoryId = BOS_INV_OrderTypeCust.szCustId;

WHERE 
BOS_INV_OrderTypeCust.szOrderTypeId = p_szOrderTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_GetOrderTypeCust_014(
p_szOrderTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_OrderTypeCust.szCustId,
ISNULL(BOS_AR_Category.szDescription,'') AS szCustNm_J


FROM 
BOS_INV_OrderTypeCust
LEFT JOIN BOS_AR_Category ON BOS_AR_Category.szCategoryId = BOS_INV_OrderTypeCust.szCustIdLEFT JOIN BOS_AR_Category ON BOS_AR_Category.szCategoryId = BOS_INV_OrderTypeCust.szCustId;

WHERE 
BOS_INV_OrderTypeCust.szOrderTypeId = p_szOrderTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_GetOrderTypeDistrChannel(
p_szOrderTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
btItemNumber ,
szDistrChannelId

FROM 
BOS_INV_OrderTypeDistrChannel
WHERE 
szOrderTypeId=p_szOrderTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_GetOrderTypeOrderItemType(
p_szOrderTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
btItemNumber ,
szOrderItemTypeId

FROM 
BOS_INV_OrderTypeOrderItemType
WHERE 
szOrderTypeId=p_szOrderTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_GetOrderTypeProduct(
p_szOrderTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_OrderTypeProduct.szProductId,
BOS_INV_Product.szName AS szProductNm_J


FROM 
BOS_INV_OrderTypeProduct
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_OrderTypeProduct.szProductIdLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_OrderTypeProduct.szProductId;

WHERE 
BOS_INV_OrderTypeProduct.szOrderTypeId = p_szOrderTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_GetOrderTypeSalesOrg(
p_szOrderTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
btItemNumber ,
szSalesOrgId

FROM 
BOS_INV_OrderTypeSalesOrg
WHERE 
szOrderTypeId=p_szOrderTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_GetOrderTypeWorkplace(
p_szOrderTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
btItemNumber ,
szWorkplaceId

FROM 
BOS_INV_OrderTypeWorkplace
WHERE 
szOrderTypeId=p_szOrderTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_IsOrderTypeExist(
p_szOrderTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szOrderTypeId

FROM 
BOS_INV_OrderType
WHERE 
szOrderTypeId=p_szOrderTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_LockOrderType(
p_szOrderTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_OrderType
SET 
szDescription = szDescription
WHERE 
szOrderTypeId=p_szOrderTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_UpdateOrderType(
p_szOrderTypeId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bAllowManualPrice bit,
p_bAllowToChangeLinePriceDate BOS_DT_bBoolean,
p_szApprovalId BOS_DT_szId,
p_szFlexiKeyId BOS_DT_szId,
p_bApplicable4AllOrderItemType bit,
p_bApplicable4AllProduct bit,
p_bApplicable4AllDistrChannel bit,
p_bApplicable4AllSalesOrg bit,
p_bApplicable4AllWorkplace bit,
p_bApplicable4AllCust bit,
p_szReturnOrderTypeId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_OrderType
SET 
szDescription = p_szDescription ,

bAllowManualPrice = p_bAllowManualPrice ,
bAllowToChangeLinePriceDate = p_bAllowToChangeLinePriceDate,

szApprovalId = p_szApprovalId ,
szFlexiKeyId = p_szFlexiKeyId ,
bApplicable4AllOrderItemType = p_bApplicable4AllOrderItemType ,
bApplicable4AllProduct = p_bApplicable4AllProduct ,
bApplicable4AllDistrChannel = p_bApplicable4AllDistrChannel ,
bApplicable4AllSalesOrg = p_bApplicable4AllSalesOrg ,
bApplicable4AllWorkplace = p_bApplicable4AllWorkplace ,
bApplicable4AllCust = p_bApplicable4AllCust,
szReturnOrderTypeId = p_szReturnOrderTypeId,
szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
szPromoPriceId = p_szPromoPriceId,
szPromoPriceOrderId = p_szPromoPriceOrderId

WHERE 
szOrderTypeId = p_szOrderTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_OrderType_UpdateOrderType_013(
p_szOrderTypeId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bAllowManualPrice bit,
p_bAllowToChangeLinePriceDate BOS_DT_bBoolean,
p_szApprovalId BOS_DT_szId,
p_szFlexiKeyId BOS_DT_szId,
p_bApplicable4AllOrderItemType bit,
p_bApplicable4AllProduct bit,
p_bApplicable4AllDistrChannel bit,
p_bApplicable4AllSalesOrg bit,
p_bApplicable4AllWorkplace bit,
p_bApplicable4AllCust bit,
p_szReturnOrderTypeId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_OrderType
SET 
szDescription = p_szDescription ,

bAllowManualPrice = p_bAllowManualPrice ,
bAllowToChangeLinePriceDate = p_bAllowToChangeLinePriceDate,

szApprovalId = p_szApprovalId ,
szFlexiKeyId = p_szFlexiKeyId ,
bApplicable4AllOrderItemType = p_bApplicable4AllOrderItemType ,
bApplicable4AllProduct = p_bApplicable4AllProduct ,
bApplicable4AllDistrChannel = p_bApplicable4AllDistrChannel ,
bApplicable4AllSalesOrg = p_bApplicable4AllSalesOrg ,
bApplicable4AllWorkplace = p_bApplicable4AllWorkplace ,
bApplicable4AllCust = p_bApplicable4AllCust,
szReturnOrderTypeId = p_szReturnOrderTypeId,
szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
szPromoPriceId = p_szPromoPriceId,
szPromoPriceOrderId = p_szPromoPriceOrderId

WHERE 
szOrderTypeId = p_szOrderTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_CreatePrice(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szUsageType BOS_DT_szSmallId,
p_szStatus BOS_DT_szSmallId,
p_szWorkplaceId BOS_DT_szId,
p_szSalesOrgId_1 BOS_DT_szId,
p_szSalesOrgId_2 BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_dtmValidStart timestamp,
p_bIsSpecificEndDate bit,
p_dtmValidEnd timestamp,
p_szNextOwnerTrnId BOS_DT_szMediumId,
p_szNextPriceId BOS_DT_szId,
p_szProductCat_1 BOS_DT_szId,
p_szProductCat_2 BOS_DT_szId,
p_szProductCat_3 BOS_DT_szId,
p_szPriceCombCd BOS_DT_szMediumId,
p_shPriceCombOrder smallint,
p_szQualifierId BOS_DT_szBigId,
p_szQualifierId_2 BOS_DT_szBigId,
p_szQualifierId_3 BOS_DT_szBigId,
p_szDiscGroupId BOS_DT_szId,
p_szDiscGroupId_2 BOS_DT_szId,
p_szDiscGroupId_3 BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_Price
(
szOwnerTrnId,
szPriceId,
gdHistory,
szUsageType,
szStatus,
szWorkplaceId,
szSalesOrgId_1,
szSalesOrgId_2,
szDescription,
dtmValidStart,
bIsSpecificEndDate,
dtmValidEnd,
szNextOwnerTrnId,
szNextPriceId,
szProductCat_1,
szProductCat_2,
szProductCat_3,
szPriceCombCd,
shPriceCombOrder,
szQualifierId,
szQualifierId_2,
szQualifierId_3,
szDiscGroupId,
szDiscGroupId_2,
szDiscGroupId_3,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szOwnerTrnId,
p_szPriceId,
p_gdHistory,
p_szUsageType,
p_szStatus,
p_szWorkplaceId,
p_szSalesOrgId_1,
p_szSalesOrgId_2,
p_szDescription,
p_dtmValidStart,
p_bIsSpecificEndDate,
p_dtmValidEnd,
p_szNextOwnerTrnId,
p_szNextPriceId,
p_szProductCat_1,
p_szProductCat_2,
p_szProductCat_3,
p_szPriceCombCd,
p_shPriceCombOrder,
p_szQualifierId,
p_szQualifierId_2,
p_szQualifierId_3,
p_szDiscGroupId,
p_szDiscGroupId_2,
p_szDiscGroupId_3,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_CreatePrice_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szUsageType BOS_DT_szSmallId,
p_szStatus BOS_DT_szSmallId,
p_szWorkplaceId BOS_DT_szId,
p_szSalesOrgId_1 BOS_DT_szId,
p_szSalesOrgId_2 BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_dtmValidStart timestamp,
p_bIsSpecificEndDate bit,
p_dtmValidEnd timestamp,
p_szNextOwnerTrnId BOS_DT_szMediumId,
p_szNextPriceId BOS_DT_szId,
p_szProductCat_1 BOS_DT_szId,
p_szProductCat_2 BOS_DT_szId,
p_szProductCat_3 BOS_DT_szId,
p_szPriceCombCd BOS_DT_szMediumId,
p_shPriceCombOrder smallint,
p_szQualifierId BOS_DT_szBigId,
p_szQualifierId_2 BOS_DT_szBigId,
p_szQualifierId_3 BOS_DT_szBigId,
p_szDiscGroupId BOS_DT_szId,
p_szDiscGroupId_2 BOS_DT_szId,
p_szDiscGroupId_3 BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_Price
(
szOwnerTrnId,
szPriceId,
gdHistory,
szUsageType,
szStatus,
szWorkplaceId,
szSalesOrgId_1,
szSalesOrgId_2,
szDescription,
dtmValidStart,
bIsSpecificEndDate,
dtmValidEnd,
szNextOwnerTrnId,
szNextPriceId,
szProductCat_1,
szProductCat_2,
szProductCat_3,
szPriceCombCd,
shPriceCombOrder,
szQualifierId,
szQualifierId_2,
szQualifierId_3,
szDiscGroupId,
szDiscGroupId_2,
szDiscGroupId_3,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szOwnerTrnId,
p_szPriceId,
p_gdHistory,
p_szUsageType,
p_szStatus,
p_szWorkplaceId,
p_szSalesOrgId_1,
p_szSalesOrgId_2,
p_szDescription,
p_dtmValidStart,
p_bIsSpecificEndDate,
p_dtmValidEnd,
p_szNextOwnerTrnId,
p_szNextPriceId,
p_szProductCat_1,
p_szProductCat_2,
p_szProductCat_3,
p_szPriceCombCd,
p_shPriceCombOrder,
p_szQualifierId,
p_szQualifierId_2,
p_szQualifierId_3,
p_szDiscGroupId,
p_szDiscGroupId_2,
p_szDiscGroupId_3,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_CreatePriceItem(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_szUomId BOS_DT_szMediumId,
p_bBaseOnAmount BOS_DT_bBoolean,
p_bUnitBaseOnAmount BOS_DT_bBoolean,
p_bUseForPriceCalculation bit,
p_bUsePriceWTax bit,
p_bHasDiscountBonus bit,
p_bHasProductBonus bit,
p_dtmItemValidStart timestamp,
p_bIsSpecificEndDate bit,
p_dtmItemValidEnd timestamp,
p_bProgressive bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceItem
(
szOwnerTrnId,
szPriceId,
gdHistory,
szProductId,
szCcyId,
szUomId,
bBaseOnAmount,
bUnitBaseOnAmount,
bUseForPriceCalculation,
bUsePriceWTax,
bHasDiscountBonus,
bHasProductBonus,
dtmItemValidStart,
bIsSpecificEndDate,
dtmItemValidEnd,
bProgressive
)
VALUES
(
p_szOwnerTrnId,
p_szPriceId,
p_gdHistory,
p_szProductId,
p_szCcyId,
p_szUomId,
p_bBaseOnAmount,
p_bUnitBaseOnAmount,
p_bUseForPriceCalculation,
p_bUsePriceWTax,
p_bHasDiscountBonus,
p_bHasProductBonus,
p_dtmItemValidStart,
p_bIsSpecificEndDate,
p_dtmItemValidEnd,
p_bProgressive
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_CreatePriceItem_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_szUomId BOS_DT_szMediumId,
p_bBaseOnAmount BOS_DT_bBoolean,
p_bUnitBaseOnAmount BOS_DT_bBoolean,
p_bUseForPriceCalculation bit,
p_bUsePriceWTax bit,
p_bHasDiscountBonus bit,
p_bHasProductBonus bit,
p_dtmItemValidStart timestamp,
p_bIsSpecificEndDate bit,
p_dtmItemValidEnd timestamp,
p_bProgressive bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceItem
(
szOwnerTrnId,
szPriceId,
gdHistory,
szProductId,
szCcyId,
szUomId,
bBaseOnAmount,
bUnitBaseOnAmount,
bUseForPriceCalculation,
bUsePriceWTax,
bHasDiscountBonus,
bHasProductBonus,
dtmItemValidStart,
bIsSpecificEndDate,
dtmItemValidEnd,
bProgressive
)
VALUES
(
p_szOwnerTrnId,
p_szPriceId,
p_gdHistory,
p_szProductId,
p_szCcyId,
p_szUomId,
p_bBaseOnAmount,
p_bUnitBaseOnAmount,
p_bUseForPriceCalculation,
p_bUsePriceWTax,
p_bHasDiscountBonus,
p_bHasProductBonus,
p_dtmItemValidStart,
p_bIsSpecificEndDate,
p_dtmItemValidEnd,
p_bProgressive
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_CreatePriceItemDiscBonus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId,
p_decMinQty BOS_DT_decQty,
p_decUnitQty BOS_DT_decQty,
p_decInitialQty BOS_DT_decQty,
p_decBonusDisc BOS_DT_decPrice,
p_szDiscType BOS_DT_szSmallId,
p_szOrderItemType BOS_DT_szId,
p_bSeparateDiscItem bit,
p_bCalcFrPrevDiscAmt bit,
p_szPrincipalDiscRefId BOS_DT_szId,
p_dtmItemValidStart timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceItemDiscBonus
(
szOwnerTrnId,
szPriceId,
gdHistory,
szProductId,
decMinQty,
decUnitQty,
decBonusDisc,
szDiscType,
szOrderItemType,
bSeparateDiscItem,
bCalcFrPrevDiscAmt,
szPrincipalDiscRefId,
dtmItemValidStart,
decInitialQty
)
VALUES
(
p_szOwnerTrnId,
p_szPriceId,
p_gdHistory,
p_szProductId,
p_decMinQty,
p_decUnitQty,
p_decBonusDisc,
p_szDiscType,
p_szOrderItemType,
p_bSeparateDiscItem,
p_bCalcFrPrevDiscAMt,
p_szPrincipalDiscRefId,
p_dtmItemValidStart,
p_decInitialQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_CreatePriceItemDiscBonus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId,
p_decMinQty BOS_DT_decQty,
p_decUnitQty BOS_DT_decQty,
p_decInitialQty BOS_DT_decQty,
p_decBonusDisc BOS_DT_decPrice,
p_szDiscType BOS_DT_szSmallId,
p_szOrderItemType BOS_DT_szId,
p_bSeparateDiscItem bit,
p_bCalcFrPrevDiscAmt bit,
p_szPrincipalDiscRefId BOS_DT_szId,
p_dtmItemValidStart timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceItemDiscBonus
(
szOwnerTrnId,
szPriceId,
gdHistory,
szProductId,
decMinQty,
decUnitQty,
decBonusDisc,
szDiscType,
szOrderItemType,
bSeparateDiscItem,
bCalcFrPrevDiscAmt,
szPrincipalDiscRefId,
dtmItemValidStart,
decInitialQty
)
VALUES
(
p_szOwnerTrnId,
p_szPriceId,
p_gdHistory,
p_szProductId,
p_decMinQty,
p_decUnitQty,
p_decBonusDisc,
p_szDiscType,
p_szOrderItemType,
p_bSeparateDiscItem,
p_bCalcFrPrevDiscAMt,
p_szPrincipalDiscRefId,
p_dtmItemValidStart,
p_decInitialQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_CreatePriceItemPricing(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId,
p_decMinQty BOS_DT_decAmount,
p_decPrice BOS_DT_decPrice,
p_dtmItemValidStart timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceItemPricing
(
szOwnerTrnId,
szPriceId,
gdHistory,
szProductId,
decMinQty,
decPrice,
dtmItemValidStart
)
VALUES
(
p_szOwnerTrnId,
p_szPriceId,
p_gdHistory,
p_szProductId,
p_decMinQty,
p_decPrice,
p_dtmItemValidStart
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_CreatePriceItemPricing_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId,
p_decMinQty BOS_DT_decAmount,
p_decPrice BOS_DT_decPrice,
p_dtmItemValidStart timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceItemPricing
(
szOwnerTrnId,
szPriceId,
gdHistory,
szProductId,
decMinQty,
decPrice,
dtmItemValidStart
)
VALUES
(
p_szOwnerTrnId,
p_szPriceId,
p_gdHistory,
p_szProductId,
p_decMinQty,
p_decPrice,
p_dtmItemValidStart
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_CreatePriceItemProductBonus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId,
p_decMinQty BOS_DT_decQty,
p_decUnitQty BOS_DT_decQty,
p_dtmItemValidStart timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceItemProductBonus
(
szOwnerTrnId,
szPriceId,
gdHistory,
szProductId,
decMinQty,
decUnitQty,
dtmItemValidStart
)
VALUES
(
p_szOwnerTrnId,
p_szPriceId,
p_gdHistory,
p_szProductId,
p_decMinQty,
p_decUnitQty,
p_dtmItemValidStart
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_CreatePriceItemProductBonus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId,
p_decMinQty BOS_DT_decQty,
p_decUnitQty BOS_DT_decQty,
p_dtmItemValidStart timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceItemProductBonus
(
szOwnerTrnId,
szPriceId,
gdHistory,
szProductId,
decMinQty,
decUnitQty,
dtmItemValidStart
)
VALUES
(
p_szOwnerTrnId,
p_szPriceId,
p_gdHistory,
p_szProductId,
p_decMinQty,
p_decUnitQty,
p_dtmItemValidStart
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_CreatePriceItemProductBonusItem(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId,
p_decMinQty BOS_DT_decAmount,
p_szBonusProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_decBonusQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szBonusType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId,
p_dtmItemValidStart timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceItemProductBonusItem
(
szOwnerTrnId,
szPriceId,
gdHistory,
szProductId,
decMinQty,
szBonusProductId,
szOrderItemTypeId,
decBonusQty,
szUomId,
szBonusType,
szPrincipalDiscRefId,
dtmItemValidStart
)
VALUES
(
p_szOwnerTrnId,
p_szPriceId,
p_gdHistory,
p_szProductId,
p_decMinQty,
p_szBonusProductId,
p_szOrderItemTypeId,
p_decBonusQty,
p_szUomId,
p_szBonusType,
p_szPrincipalDiscRefId,
p_dtmItemValidStart
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_CreatePriceItemProductBonusItem_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId,
p_decMinQty BOS_DT_decAmount,
p_szBonusProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_decBonusQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szBonusType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId,
p_dtmItemValidStart timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceItemProductBonusItem
(
szOwnerTrnId,
szPriceId,
gdHistory,
szProductId,
decMinQty,
szBonusProductId,
szOrderItemTypeId,
decBonusQty,
szUomId,
szBonusType,
szPrincipalDiscRefId,
dtmItemValidStart
)
VALUES
(
p_szOwnerTrnId,
p_szPriceId,
p_gdHistory,
p_szProductId,
p_decMinQty,
p_szBonusProductId,
p_szOrderItemTypeId,
p_decBonusQty,
p_szUomId,
p_szBonusType,
p_szPrincipalDiscRefId,
p_dtmItemValidStart
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePrice(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_Price
WHERE
szOwnerTrnId = p_szOwnerTrnIdAND szPriceId = p_szPriceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePrice_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_Price
WHERE
szOwnerTrnId = p_szOwnerTrnIdAND szPriceId = p_szPriceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItem(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItem
WHERE
szOwnerTrnId = p_szOwnerTrnIdAND szPriceId = p_szPriceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItem_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItem
WHERE
szOwnerTrnId = p_szOwnerTrnIdAND szPriceId = p_szPriceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItemDiscBonus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItemDiscBonus
WHERE
szOwnerTrnId = p_szOwnerTrnIdAND szPriceId = p_szPriceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItemDiscBonus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItemDiscBonus
WHERE
szOwnerTrnId = p_szOwnerTrnIdAND szPriceId = p_szPriceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItemDiscBonusWhereGdHistory(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItemDiscBonus
WHERE
szOwnerTrnId = p_szOwnerTrnIdAND szPriceId = p_szPriceIdAND gdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItemDiscBonusWhereGdHistory_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItemDiscBonus
WHERE
szOwnerTrnId = p_szOwnerTrnIdAND szPriceId = p_szPriceIdAND gdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItemPricing(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItemPricing
WHERE
szOwnerTrnId = p_szOwnerTrnIdAND szPriceId=p_szPriceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItemPricing_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItemPricing
WHERE
szOwnerTrnId = p_szOwnerTrnIdAND szPriceId=p_szPriceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItemPricingWhereGdHistory(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItemPricing
WHERE
szOwnerTrnId = p_szOwnerTrnIdAND szPriceId = p_szPriceIdAND gdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItemPricingWhereGdHistory_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItemPricing
WHERE
szOwnerTrnId = p_szOwnerTrnIdAND szPriceId = p_szPriceIdAND gdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItemProductBonus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItemProductBonus
WHERE
szOwnerTrnId = p_szOwnerTrnIdAND szPriceId=p_szPriceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItemProductBonus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItemProductBonus
WHERE
szOwnerTrnId = p_szOwnerTrnIdAND szPriceId=p_szPriceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItemProductBonusItem(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItemProductBonusItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceId=p_szPriceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItemProductBonusItem_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItemProductBonusItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceId=p_szPriceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItemProductBonusItemWhereGdHistory(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItemProductBonusItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceId = p_szPriceId ANDp_gdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItemProductBonusItemWhereGdHistory_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItemProductBonusItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceId = p_szPriceId ANDp_gdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItemProductBonusWhereGdHistory(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItemProductBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceId = p_szPriceId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItemProductBonusWhereGdHistory_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItemProductBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceId = p_szPriceId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItemWhereGdHistory(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceId = p_szPriceId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_DeletePriceItemWhereGdHistory_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceId = p_szPriceId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_GetListOfPrice(
p_szStatus BOS_DT_szSmallId,
p_szUsageType BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPriceId,
szDescription


FROM 
BOS_INV_Price

WHERE 
szOwnerTrnId = '' AND szStatus = p_szStatus AND szUsageType like p_szUsageType ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_GetPriceItem(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_PriceItem.szProductId,

BOS_INV_Product.szName AS szProductNm,
BOS_INV_Product.szQtyFormat as szProductQtyFormat,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,

BOS_INV_PriceItem.szCcyId,
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat,

BOS_INV_PriceItem.szUomId,

BOS_INV_PriceItem.bBaseOnAmount,
BOS_INV_PriceItem.bUnitBaseOnAmount,

BOS_INV_PriceItem.bUseForPriceCalculation,
BOS_INV_PriceItem.bUsePriceWTax,
BOS_INV_PriceItem.bHasDiscountBonus,
BOS_INV_PriceItem.bHasProductBonus,

--new
BOS_INV_PriceItem.dtmItemValidStart,
BOS_INV_PriceItem.bIsSpecificEndDate,
BOS_INV_PriceItem.dtmItemValidEnd,

BOS_INV_PriceItem.bProgressive

FROM
BOS_INV_PriceItem
LEFT JOIN BOS_INV_Product ON BOS_INV_PriceItem.szProductId = BOS_INV_Product.szProductId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_INV_PriceItem.szCcyId

WHERE
szOwnerTrnId = p_szOwnerTrnId AND
BOS_INV_PriceItem.szPriceId = p_szPriceId and
BOS_INV_PriceItem.gdHistory = p_gdHistory
AND 
(
BOS_INV_PriceItem.szProductId LIKE p_szProductId 
OR 
--Of course, item for all products must always be retrieved.
BOS_INV_PriceItem.szProductId = ''
)

ORDER BY
BOS_INV_PriceItem.szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_GetPriceItem_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_PriceItem.szProductId,

BOS_INV_Product.szName AS szProductNm,
BOS_INV_Product.szQtyFormat as szProductQtyFormat,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,

BOS_INV_PriceItem.szCcyId,
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat,

BOS_INV_PriceItem.szUomId,

BOS_INV_PriceItem.bBaseOnAmount,
BOS_INV_PriceItem.bUnitBaseOnAmount,

BOS_INV_PriceItem.bUseForPriceCalculation,
BOS_INV_PriceItem.bUsePriceWTax,
BOS_INV_PriceItem.bHasDiscountBonus,
BOS_INV_PriceItem.bHasProductBonus,

--new
BOS_INV_PriceItem.dtmItemValidStart,
BOS_INV_PriceItem.bIsSpecificEndDate,
BOS_INV_PriceItem.dtmItemValidEnd,

BOS_INV_PriceItem.bProgressive

FROM
BOS_INV_PriceItem
LEFT JOIN BOS_INV_Product ON BOS_INV_PriceItem.szProductId = BOS_INV_Product.szProductId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_INV_PriceItem.szCcyId

WHERE
szOwnerTrnId = p_szOwnerTrnId AND
BOS_INV_PriceItem.szPriceId = p_szPriceId and
BOS_INV_PriceItem.gdHistory = p_gdHistory
AND 
(
BOS_INV_PriceItem.szProductId LIKE p_szProductId 
OR 
--Of course, item for all products must always be retrieved.
BOS_INV_PriceItem.szProductId = ''
)

ORDER BY
BOS_INV_PriceItem.szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_GetPriceItemDiscBonus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId,
p_dtmItemValidStart timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decMinQty,
decUnitQty,
decInitialQty,
decBonusDisc,
szDiscType,
szOrderItemType,
bSeparateDiscItem,
bCalcFrPrevDiscAmt,
BOS_INV_PriceItemDiscBonus.szPrincipalDiscRefId,
PrDiscRef.szDescription as szPrincipalDiscRefDesc_J


FROM 
BOS_INV_PriceItemDiscBonus
left join BOS_SD_OrgStru_PrincipalDiscRef as PrDiscRef on BOS_INV_PriceItemDiscBonus.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceId = p_szPriceId AND gdHistory = p_gdHistory AND szProductId = p_szProductId AND dtmItemValidStart = p_dtmItemValidStart ;ORDER BY 
decMinQty

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_GetPriceItemDiscBonus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId,
p_dtmItemValidStart timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decMinQty,
decUnitQty,
decInitialQty,
decBonusDisc,
szDiscType,
szOrderItemType,
bSeparateDiscItem,
bCalcFrPrevDiscAmt,
BOS_INV_PriceItemDiscBonus.szPrincipalDiscRefId,
PrDiscRef.szDescription as szPrincipalDiscRefDesc_J


FROM 
BOS_INV_PriceItemDiscBonus
left join BOS_SD_OrgStru_PrincipalDiscRef as PrDiscRef on BOS_INV_PriceItemDiscBonus.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceId = p_szPriceId AND gdHistory = p_gdHistory AND szProductId = p_szProductId AND dtmItemValidStart = p_dtmItemValidStart ;ORDER BY 
decMinQty

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_GetPriceItemPricing(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId,
p_dtmItemValidStart timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decMinQty,
decPrice


FROM 
BOS_INV_PriceItemPricing

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceId = p_szPriceId AND gdHistory = p_gdHistory AND szProductId = p_szProductId AND dtmItemValidStart = p_dtmItemValidStart ;ORDER BY 
decMinQty

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_GetPriceItemPricing_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId,
p_dtmItemValidStart timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decMinQty,
decPrice


FROM 
BOS_INV_PriceItemPricing

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceId = p_szPriceId AND gdHistory = p_gdHistory AND szProductId = p_szProductId AND dtmItemValidStart = p_dtmItemValidStart ;ORDER BY 
decMinQty

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_GetPriceItemProductBonus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId,
p_dtmItemValidStart timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decMinQty,
decUnitQty


FROM 
BOS_INV_PriceItemProductBonus

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceId = p_szPriceId AND gdHistory = p_gdHistory AND szProductId = p_szProductId AND dtmItemValidStart = p_dtmItemValidStart ;ORDER BY 
decMinQty

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_GetPriceItemProductBonus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId,
p_dtmItemValidStart timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decMinQty,
decUnitQty


FROM 
BOS_INV_PriceItemProductBonus

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceId = p_szPriceId AND gdHistory = p_gdHistory AND szProductId = p_szProductId AND dtmItemValidStart = p_dtmItemValidStart ;ORDER BY 
decMinQty

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_GetPriceItemProductBonusItem(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId,
p_decMinQty BOS_DT_decAmount,
p_dtmItemValidStart timestamp)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_PriceItemProductBonusItem.szBonusProductId,

BOS_INV_Product.szName AS szBonusProductNm_J,
BOS_INV_Product.szDiscountGroupId AS szBonusProductDiscGroupId_J,
BOS_INV_Product.szQtyFormat as szBonusProductQtyFormat_J,
BOS_INV_Product.szUomClassId AS szBonusProductUomClassId_J,
BOS_INV_Product.szUomId AS szBonusProductUomId_J,
BOS_INV_Product.szCompUomId AS szBonusProductCompUomId_J,
BOS_INV_Product.szTrackingType AS szBonusProductTrackingType_J,
BOS_GL_TaxType.decRate AS decBonusProductTaxRate_J,

BOS_INV_PriceItemProductBonusItem.szOrderItemTypeId,
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,
BOS_INV_OrderItemType.bTaxable AS bOrderItemTypeTaxable_J,

BOS_INV_PriceItemProductBonusItem.decBonusQty,
BOS_INV_PriceItemProductBonusItem.szUomId,
BOS_INV_PriceItemProductBonusItem.szBonusType,
BOS_INV_PriceItemProductBonusItem.szPrincipalDiscRefId,
PrDiscRef.szDescription as szPrincipalDiscRefDesc_J

FROM 
BOS_INV_PriceItemProductBonusItem 
LEFT JOIN BOS_INV_Product ON BOS_INV_PriceItemProductBonusItem.szBonusProductId = BOS_INV_Product.szProductId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_INV_PriceItemProductBonusItem.szOrderItemTypeId
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId
left join BOS_SD_OrgStru_PrincipalDiscRef as PrDiscRef on BOS_INV_PriceItemProductBonusItem.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId

WHERE
szOwnerTrnId = p_szOwnerTrnId AND
BOS_INV_PriceItemProductBonusItem.szPriceId = p_szPriceId AND
BOS_INV_PriceItemProductBonusItem.gdHistory = p_gdHistory AND
BOS_INV_PriceItemProductBonusItem.szProductId = p_szProductId AND
BOS_INV_PriceItemProductBonusItem.decMinQty = p_decMinQty AND
BOS_INV_PriceItemProductBonusItem.dtmItemValidStart = p_dtmItemValidStart

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_GetPriceItemProductBonusItem_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId BOS_DT_szId,
p_decMinQty BOS_DT_decAmount,
p_dtmItemValidStart timestamp)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_PriceItemProductBonusItem.szBonusProductId,

BOS_INV_Product.szName AS szBonusProductNm_J,
BOS_INV_Product.szDiscountGroupId AS szBonusProductDiscGroupId_J,
BOS_INV_Product.szQtyFormat as szBonusProductQtyFormat_J,
BOS_INV_Product.szUomClassId AS szBonusProductUomClassId_J,
BOS_INV_Product.szUomId AS szBonusProductUomId_J,
BOS_INV_Product.szCompUomId AS szBonusProductCompUomId_J,
BOS_INV_Product.szTrackingType AS szBonusProductTrackingType_J,
BOS_GL_TaxType.decRate AS decBonusProductTaxRate_J,

BOS_INV_PriceItemProductBonusItem.szOrderItemTypeId,
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,
BOS_INV_OrderItemType.bTaxable AS bOrderItemTypeTaxable_J,

BOS_INV_PriceItemProductBonusItem.decBonusQty,
BOS_INV_PriceItemProductBonusItem.szUomId,
BOS_INV_PriceItemProductBonusItem.szBonusType,
BOS_INV_PriceItemProductBonusItem.szPrincipalDiscRefId,
PrDiscRef.szDescription as szPrincipalDiscRefDesc_J

FROM 
BOS_INV_PriceItemProductBonusItem 
LEFT JOIN BOS_INV_Product ON BOS_INV_PriceItemProductBonusItem.szBonusProductId = BOS_INV_Product.szProductId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_INV_PriceItemProductBonusItem.szOrderItemTypeId
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId
left join BOS_SD_OrgStru_PrincipalDiscRef as PrDiscRef on BOS_INV_PriceItemProductBonusItem.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId

WHERE
szOwnerTrnId = p_szOwnerTrnId AND
BOS_INV_PriceItemProductBonusItem.szPriceId = p_szPriceId AND
BOS_INV_PriceItemProductBonusItem.gdHistory = p_gdHistory AND
BOS_INV_PriceItemProductBonusItem.szProductId = p_szProductId AND
BOS_INV_PriceItemProductBonusItem.decMinQty = p_decMinQty AND
BOS_INV_PriceItemProductBonusItem.dtmItemValidStart = p_dtmItemValidStart

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_GetPriceWhereGuid(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
gdHistory,
szStatus,
szUsageType,
szWorkplaceId,
szSalesOrgId_1,
szSalesOrgId_2,
szDescription,
dtmValidStart,
bIsSpecificEndDate,
dtmValidEnd,
szNextOwnerTrnId,
szNextPriceId,

szProductCat_1,
szProductCat_2,
szProductCat_3,

szPriceCombCd,
shPriceCombOrder,

szQualifierId,
szQualifierId_2,
szQualifierId_3,

szDiscGroupId,
szDiscGroupId_2,
szDiscGroupId_3,

-- Data Status.
dtmLastUpdated,
bAlreadyTransferred


FROM 
BOS_INV_Price

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceId = p_szPriceId and gdHistory = p_gdHistory ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_GetPriceWhereGuid_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
gdHistory,
szStatus,
szUsageType,
szWorkplaceId,
szSalesOrgId_1,
szSalesOrgId_2,
szDescription,
dtmValidStart,
bIsSpecificEndDate,
dtmValidEnd,
szNextOwnerTrnId,
szNextPriceId,

szProductCat_1,
szProductCat_2,
szProductCat_3,

szPriceCombCd,
shPriceCombOrder,

szQualifierId,
szQualifierId_2,
szQualifierId_3,

szDiscGroupId,
szDiscGroupId_2,
szDiscGroupId_3,

-- Data Status.
dtmLastUpdated,
bAlreadyTransferred


FROM 
BOS_INV_Price

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceId = p_szPriceId and gdHistory = p_gdHistory ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_GetPriceWhereStatus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
gdHistory,
szStatus,
szUsageType,
szWorkplaceId,
szSalesOrgId_1,
szSalesOrgId_2,
szDescription,
dtmValidStart,
bIsSpecificEndDate,
dtmValidEnd,
szNextOwnerTrnId,
szNextPriceId,

szProductCat_1,
szProductCat_2,
szProductCat_3,

szPriceCombCd,
shPriceCombOrder,

szQualifierId,
szQualifierId_2,
szQualifierId_3,

szDiscGroupId,
szDiscGroupId_2,
szDiscGroupId_3,

-- Data Status.
dtmLastUpdated,
bAlreadyTransferred


FROM 
BOS_INV_Price

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceId = p_szPriceId and szStatus = p_szStatus ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_GetPriceWhereStatus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
gdHistory,
szStatus,
szUsageType,
szWorkplaceId,
szSalesOrgId_1,
szSalesOrgId_2,
szDescription,
dtmValidStart,
bIsSpecificEndDate,
dtmValidEnd,
szNextOwnerTrnId,
szNextPriceId,

szProductCat_1,
szProductCat_2,
szProductCat_3,

szPriceCombCd,
shPriceCombOrder,

szQualifierId,
szQualifierId_2,
szQualifierId_3,

szDiscGroupId,
szDiscGroupId_2,
szDiscGroupId_3,

-- Data Status.
dtmLastUpdated,
bAlreadyTransferred


FROM 
BOS_INV_Price

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceId = p_szPriceId and szStatus = p_szStatus ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_IsPriceExistWhereGuid(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPriceId


FROM 
BOS_INV_Price

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceId = p_szPriceId AND gdHistory = p_gdHistory ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_IsPriceExistWhereGuid_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPriceId


FROM 
BOS_INV_Price

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceId = p_szPriceId AND gdHistory = p_gdHistory ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_IsPriceExistWhereStatus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPriceId


FROM 
BOS_INV_Price

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceId = p_szPriceId AND szStatus = p_szStatus ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_IsPriceExistWhereStatus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPriceId


FROM 
BOS_INV_Price

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceId = p_szPriceId AND szStatus = p_szStatus ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_LockPriceWhereGuid(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Price
SET 
szDescription = szDescription

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_LockPriceWhereGuid_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Price
SET 
szDescription = szDescription

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_LockPriceWhereStatus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Price
SET 
szDescription = szDescription

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_LockPriceWhereStatus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Price
SET 
szDescription = szDescription

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_UpdatePrice(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szUsageType BOS_DT_szSmallId,
p_szStatus BOS_DT_szSmallId,
p_szWorkplaceId BOS_DT_szId,
p_szSalesOrgId_1 BOS_DT_szId,
p_szSalesOrgId_2 BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_dtmValidStart timestamp,
p_bIsSpecificEndDate bit,
p_dtmValidEnd timestamp,
p_szNextOwnerTrnId BOS_DT_szMediumId,
p_szNextPriceId BOS_DT_szId,
p_szProductCat_1 BOS_DT_szId,
p_szProductCat_2 BOS_DT_szId,
p_szProductCat_3 BOS_DT_szId,
p_szPriceCombCd BOS_DT_szMediumId,
p_shPriceCombOrder smallint,
p_szQualifierId BOS_DT_szBigId,
p_szQualifierId_2 BOS_DT_szBigId,
p_szQualifierId_3 BOS_DT_szBigId,
p_szDiscGroupId BOS_DT_szId,
p_szDiscGroupId_2 BOS_DT_szId,
p_szDiscGroupId_3 BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Price
SET 
szUsageType = p_szUsageType,
szStatus = p_szStatus,
szWorkplaceId = p_szWorkplaceId,
szSalesOrgId_1 = p_szSalesOrgId_1,
szSalesOrgId_2 = p_szSalesOrgId_2,
szDescription = p_szDescription,
dtmValidStart = p_dtmValidStart,
bIsSpecificEndDate = p_bIsSpecificEndDate,
dtmValidEnd = p_dtmValidEnd,
szNextOwnerTrnId = p_szNextOwnerTrnId,
szNextPriceId = p_szNextPriceId,

szProductCat_1 = p_szProductCat_1,
szProductCat_2 = p_szProductCat_2,
szProductCat_3 = p_szProductCat_3,

szPriceCombCd = p_szPriceCombCd,
shPriceCombOrder = p_shPriceCombOrder,

szQualifierId = p_szQualifierId,
szQualifierId_2 = p_szQualifierId_2,
szQualifierId_3 = p_szQualifierId_3,

szDiscGroupId = p_szDiscGroupId,
szDiscGroupId_2 = p_szDiscGroupId_2,
szDiscGroupId_3 = p_szDiscGroupId_3

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_UpdatePrice_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szUsageType BOS_DT_szSmallId,
p_szStatus BOS_DT_szSmallId,
p_szWorkplaceId BOS_DT_szId,
p_szSalesOrgId_1 BOS_DT_szId,
p_szSalesOrgId_2 BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_dtmValidStart timestamp,
p_bIsSpecificEndDate bit,
p_dtmValidEnd timestamp,
p_szNextOwnerTrnId BOS_DT_szMediumId,
p_szNextPriceId BOS_DT_szId,
p_szProductCat_1 BOS_DT_szId,
p_szProductCat_2 BOS_DT_szId,
p_szProductCat_3 BOS_DT_szId,
p_szPriceCombCd BOS_DT_szMediumId,
p_shPriceCombOrder smallint,
p_szQualifierId BOS_DT_szBigId,
p_szQualifierId_2 BOS_DT_szBigId,
p_szQualifierId_3 BOS_DT_szBigId,
p_szDiscGroupId BOS_DT_szId,
p_szDiscGroupId_2 BOS_DT_szId,
p_szDiscGroupId_3 BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Price
SET 
szUsageType = p_szUsageType,
szStatus = p_szStatus,
szWorkplaceId = p_szWorkplaceId,
szSalesOrgId_1 = p_szSalesOrgId_1,
szSalesOrgId_2 = p_szSalesOrgId_2,
szDescription = p_szDescription,
dtmValidStart = p_dtmValidStart,
bIsSpecificEndDate = p_bIsSpecificEndDate,
dtmValidEnd = p_dtmValidEnd,
szNextOwnerTrnId = p_szNextOwnerTrnId,
szNextPriceId = p_szNextPriceId,

szProductCat_1 = p_szProductCat_1,
szProductCat_2 = p_szProductCat_2,
szProductCat_3 = p_szProductCat_3,

szPriceCombCd = p_szPriceCombCd,
shPriceCombOrder = p_shPriceCombOrder,

szQualifierId = p_szQualifierId,
szQualifierId_2 = p_szQualifierId_2,
szQualifierId_3 = p_szQualifierId_3,

szDiscGroupId = p_szDiscGroupId,
szDiscGroupId_2 = p_szDiscGroupId_2,
szDiscGroupId_3 = p_szDiscGroupId_3

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_UpdatePriceStatus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szStatus varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Price
SET 
szStatus = p_szStatus

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Price_UpdatePriceStatus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceId BOS_DT_szId,
p_gdHistory bytea,
p_szStatus varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Price
SET 
szStatus = p_szStatus

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_CreatePriceOrder(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szUsageType BOS_DT_szSmallId,
p_szStatus BOS_DT_szSmallId,
p_szWorkplaceId BOS_DT_szId,
p_szSalesOrgId_1 BOS_DT_szId,
p_szSalesOrgId_2 BOS_DT_szId,
p_szDescription varchar,
p_bIsSpecificEndDate bit,
p_dtmvalidStart timestamp,
p_dtmValidEnd timestamp,
p_szCcyId BOS_DT_szSmallId,
p_bHasCombinationBonus bit,
p_bOnlyCalculateFrCombination bit,
p_bHasAmountDiscBonus bit,
p_bHasAmountProductBonus bit,
p_bHasProvisionBonus bit,
p_bMinDiscBaseOnAmount BOS_DT_bBoolean,
p_bUnitDiscBaseOnAmount BOS_DT_bBoolean,
p_bMinBonusBaseOnAmount BOS_DT_bBoolean,
p_bUnitBonusBaseOnAmount BOS_DT_bBoolean,
p_szUomId BOS_DT_szMediumId,
p_szNextOwnerTrnId BOS_DT_szMediumId,
p_szNextPriceOrderId BOS_DT_szId,
p_szPriceCombCd BOS_DT_szMediumId,
p_shPriceCombOrder smallint,
p_szQualifierId BOS_DT_szBigId,
p_szQualifierId_2 BOS_DT_szBigId,
p_szQualifierId_3 BOS_DT_szBigId,
p_szDiscGroupId BOS_DT_szBigId,
p_szDiscGroupId_2 BOS_DT_szBigId,
p_szDiscGroupId_3 BOS_DT_szBigId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrder
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
szUsageType,
szStatus,
szWorkplaceId,
szSalesOrgId_1,
szSalesOrgId_2,
szDescription,
bIsSpecificEndDate,
dtmvalidStart,
dtmValidEnd,
szCcyId,
bHasCombinationBonus,
bOnlyCalculateFrCombination,
bHasAmountDiscBonus,
bHasAmountProductBonus,
bHasProvisionBonus,
bMinDiscBaseOnAmount,
bUnitDiscBaseOnAmount,
bMinBonusBaseOnAmount,
bUnitBonusBaseOnAmount,
szUomId,
szNextOwnerTrnId,
szNextPriceOrderId,
szPriceCombCd,
shPriceCombOrder,
szQualifierId,
szQualifierId_2,
szQualifierId_3,
szDiscGroupId,
szDiscGroupId_2,
szDiscGroupId_3,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_szUsageType,
p_szStatus,
p_szWorkplaceId,
p_szSalesOrgId_1,
p_szSalesOrgId_2,
p_szDescription,
p_bIsSpecificEndDate,
p_dtmvalidStart,
p_dtmValidEnd,
p_szCcyId,
p_bHasCombinationBonus,
p_bOnlyCalculateFrCombination,
p_bHasAmountDiscBonus,
p_bHasAmountProductBonus,
p_bHasProvisionBonus,
p_bMinDiscBaseOnAmount,
p_bUnitDiscBaseOnAmount,
p_bMinBonusBaseOnAmount,
p_bUnitBonusBaseOnAmount,
p_szUomId,
p_szNextOwnerTrnId,
p_szNextPriceOrderId,
p_szPriceCombCd,
p_shPriceCombOrder,
p_szQualifierId,
p_szQualifierId_2,
p_szQualifierId_3,
p_szDiscGroupId,
p_szDiscGroupId_2,
p_szDiscGroupId_3,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_CreatePriceOrder_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szUsageType BOS_DT_szSmallId,
p_szStatus BOS_DT_szSmallId,
p_szWorkplaceId BOS_DT_szId,
p_szSalesOrgId_1 BOS_DT_szId,
p_szSalesOrgId_2 BOS_DT_szId,
p_szDescription varchar,
p_bIsSpecificEndDate bit,
p_dtmvalidStart timestamp,
p_dtmValidEnd timestamp,
p_szCcyId BOS_DT_szSmallId,
p_bHasCombinationBonus bit,
p_bOnlyCalculateFrCombination bit,
p_bHasAmountDiscBonus bit,
p_bHasAmountProductBonus bit,
p_bHasProvisionBonus bit,
p_bMinDiscBaseOnAmount BOS_DT_bBoolean,
p_bUnitDiscBaseOnAmount BOS_DT_bBoolean,
p_bMinBonusBaseOnAmount BOS_DT_bBoolean,
p_bUnitBonusBaseOnAmount BOS_DT_bBoolean,
p_szUomId BOS_DT_szMediumId,
p_szNextOwnerTrnId BOS_DT_szMediumId,
p_szNextPriceOrderId BOS_DT_szId,
p_szPriceCombCd BOS_DT_szMediumId,
p_shPriceCombOrder smallint,
p_szQualifierId BOS_DT_szBigId,
p_szQualifierId_2 BOS_DT_szBigId,
p_szQualifierId_3 BOS_DT_szBigId,
p_szDiscGroupId BOS_DT_szBigId,
p_szDiscGroupId_2 BOS_DT_szBigId,
p_szDiscGroupId_3 BOS_DT_szBigId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrder
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
szUsageType,
szStatus,
szWorkplaceId,
szSalesOrgId_1,
szSalesOrgId_2,
szDescription,
bIsSpecificEndDate,
dtmvalidStart,
dtmValidEnd,
szCcyId,
bHasCombinationBonus,
bOnlyCalculateFrCombination,
bHasAmountDiscBonus,
bHasAmountProductBonus,
bHasProvisionBonus,
bMinDiscBaseOnAmount,
bUnitDiscBaseOnAmount,
bMinBonusBaseOnAmount,
bUnitBonusBaseOnAmount,
szUomId,
szNextOwnerTrnId,
szNextPriceOrderId,
szPriceCombCd,
shPriceCombOrder,
szQualifierId,
szQualifierId_2,
szQualifierId_3,
szDiscGroupId,
szDiscGroupId_2,
szDiscGroupId_3,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_szUsageType,
p_szStatus,
p_szWorkplaceId,
p_szSalesOrgId_1,
p_szSalesOrgId_2,
p_szDescription,
p_bIsSpecificEndDate,
p_dtmvalidStart,
p_dtmValidEnd,
p_szCcyId,
p_bHasCombinationBonus,
p_bOnlyCalculateFrCombination,
p_bHasAmountDiscBonus,
p_bHasAmountProductBonus,
p_bHasProvisionBonus,
p_bMinDiscBaseOnAmount,
p_bUnitDiscBaseOnAmount,
p_bMinBonusBaseOnAmount,
p_bUnitBonusBaseOnAmount,
p_szUomId,
p_szNextOwnerTrnId,
p_szNextPriceOrderId,
p_szPriceCombCd,
p_shPriceCombOrder,
p_szQualifierId,
p_szQualifierId_2,
p_szQualifierId_3,
p_szDiscGroupId,
p_szDiscGroupId_2,
p_szDiscGroupId_3,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_CreatePriceOrderAmountDiscBonus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_decMinAmount BOS_DT_decAmount,
p_decUnitAmount BOS_DT_decAmount,
p_decBonusDisc BOS_DT_decPrice,
p_szDiscType BOS_DT_szSmallId,
p_szOrderItemTypeId BOS_DT_szId,
p_bCalcFrPrevDiscAmt smallint,
p_szPrincipalDiscRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderAmountDiscBonus
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
decMinAmount,
decUnitAmount,
decBonusDisc,
szDiscType,
szOrderItemTypeId,
bCalcFrPrevDiscAmt,
szPrincipalDiscRefId
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_decMinAmount,
p_decUnitAmount,
p_decBonusDisc,
p_szDiscType,
p_szOrderItemTypeId,
p_bCalcFrPrevDiscAmt,
p_szPrincipalDiscRefId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_CreatePriceOrderAmountDiscBonus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_decMinAmount BOS_DT_decAmount,
p_decUnitAmount BOS_DT_decAmount,
p_decBonusDisc BOS_DT_decPrice,
p_szDiscType BOS_DT_szSmallId,
p_szOrderItemTypeId BOS_DT_szId,
p_bCalcFrPrevDiscAmt smallint,
p_szPrincipalDiscRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderAmountDiscBonus
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
decMinAmount,
decUnitAmount,
decBonusDisc,
szDiscType,
szOrderItemTypeId,
bCalcFrPrevDiscAmt,
szPrincipalDiscRefId
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_decMinAmount,
p_decUnitAmount,
p_decBonusDisc,
p_szDiscType,
p_szOrderItemTypeId,
p_bCalcFrPrevDiscAmt,
p_szPrincipalDiscRefId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_CreatePriceOrderAmountProductBonus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_decMinAmount BOS_DT_decAmount,
p_decUnitAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderAmountProductBonus
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
decMinAmount,
decUnitAmount
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_decMinAmount,
p_decUnitAmount
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_CreatePriceOrderAmountProductBonus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_decMinAmount BOS_DT_decAmount,
p_decUnitAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderAmountProductBonus
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
decMinAmount,
decUnitAmount
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_decMinAmount,
p_decUnitAmount
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_CreatePriceOrderAmountProductBonusItem(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_decMinAmount BOS_DT_decAmount,
p_szBonusProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_decBonusQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szBonusType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderAmountProductBonusItem
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
decMinAmount,
szBonusProductId,
szOrderItemTypeId,
decBonusQty,
szUomId,
szBonusType,
szPrincipalDiscRefId
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_decMinAmount,
p_szBonusProductId,
p_szOrderItemTypeId,
p_decBonusQty,
p_szUomId,
p_szBonusType,
p_szPrincipalDiscRefId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_CreatePriceOrderAmountProductBonusItem_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_decMinAmount BOS_DT_decAmount,
p_szBonusProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_decBonusQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szBonusType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderAmountProductBonusItem
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
decMinAmount,
szBonusProductId,
szOrderItemTypeId,
decBonusQty,
szUomId,
szBonusType,
szPrincipalDiscRefId
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_decMinAmount,
p_szBonusProductId,
p_szOrderItemTypeId,
p_decBonusQty,
p_szUomId,
p_szBonusType,
p_szPrincipalDiscRefId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_CreatePriceOrderItem(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId_1 BOS_DT_szId,
p_szProductId_2 BOS_DT_szId,
p_szProductId_3 BOS_DT_szId,
p_szProductId_4 BOS_DT_szId,
p_szProductId_5 BOS_DT_szId,
p_decQty_1 BOS_DT_decAmount,
p_decQty_2 BOS_DT_decAmount,
p_decQty_3 BOS_DT_decAmount,
p_decQty_4 BOS_DT_decAmount,
p_decQty_5 BOS_DT_decAmount,
p_bHasDiscountBonus bit,
p_bHasProductBonus bit,
p_szUomId_1 BOS_DT_szMediumId,
p_szUomId_2 BOS_DT_szMediumId,
p_szUomId_3 BOS_DT_szMediumId,
p_szUomId_4 BOS_DT_szMediumId,
p_szUomId_5 BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderItem
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
szProductId_1,
szProductId_2,
szProductId_3,
szProductId_4,
szProductId_5,
decQty_1,
decQty_2,
decQty_3,
decQty_4,
decQty_5,
bHasDiscountBonus,
bHasProductBonus,
szUomId_1,
szUomId_2,
szUomId_3,
szUomId_4,
szUomId_5
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_szProductId_1,
p_szProductId_2,
p_szProductId_3,
p_szProductId_4,
p_szProductId_5,
p_decQty_1,
p_decQty_2,
p_decQty_3,
p_decQty_4,
p_decQty_5,
p_bHasDiscountBonus,
p_bHasProductBonus,
p_szUomId_1,
p_szUomId_2,
p_szUomId_3,
p_szUomId_4,
p_szUomId_5
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_CreatePriceOrderItem_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId_1 BOS_DT_szId,
p_szProductId_2 BOS_DT_szId,
p_szProductId_3 BOS_DT_szId,
p_szProductId_4 BOS_DT_szId,
p_szProductId_5 BOS_DT_szId,
p_decQty_1 BOS_DT_decAmount,
p_decQty_2 BOS_DT_decAmount,
p_decQty_3 BOS_DT_decAmount,
p_decQty_4 BOS_DT_decAmount,
p_decQty_5 BOS_DT_decAmount,
p_bHasDiscountBonus bit,
p_bHasProductBonus bit,
p_szUomId_1 BOS_DT_szMediumId,
p_szUomId_2 BOS_DT_szMediumId,
p_szUomId_3 BOS_DT_szMediumId,
p_szUomId_4 BOS_DT_szMediumId,
p_szUomId_5 BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderItem
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
szProductId_1,
szProductId_2,
szProductId_3,
szProductId_4,
szProductId_5,
decQty_1,
decQty_2,
decQty_3,
decQty_4,
decQty_5,
bHasDiscountBonus,
bHasProductBonus,
szUomId_1,
szUomId_2,
szUomId_3,
szUomId_4,
szUomId_5
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_szProductId_1,
p_szProductId_2,
p_szProductId_3,
p_szProductId_4,
p_szProductId_5,
p_decQty_1,
p_decQty_2,
p_decQty_3,
p_decQty_4,
p_decQty_5,
p_bHasDiscountBonus,
p_bHasProductBonus,
p_szUomId_1,
p_szUomId_2,
p_szUomId_3,
p_szUomId_4,
p_szUomId_5
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_CreatePriceOrderItemDiscBonus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId_1 BOS_DT_szId,
p_szProductId_2 BOS_DT_szId,
p_szProductId_3 BOS_DT_szId,
p_szProductId_4 BOS_DT_szId,
p_szProductId_5 BOS_DT_szId,
p_decMinQty BOS_DT_decQty,
p_decUnitQty BOS_DT_decQty,
p_decBonusDisc BOS_DT_decPrice,
p_szDiscType BOS_DT_szSmallId,
p_szOrderItemTypeId BOS_DT_szId,
p_bCalcFrPrevDiscAmt smallint,
p_szPrincipalDiscRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderItemDiscBonus
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
szProductId_1,
szProductId_2,
szProductId_3,
szProductId_4,
szProductId_5,
decMinQty,
decUnitQty,
decBonusDisc,
szDiscType,
szOrderItemTypeId,
bCalcFrPrevDiscAmt,
szPrincipalDiscRefId
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_szProductId_1,
p_szProductId_2,
p_szProductId_3,
p_szProductId_4,
p_szProductId_5,
p_decMinQty,
p_decUnitQty,
p_decBonusDisc,
p_szDiscType,
p_szOrderItemTypeId,
p_bCalcFrPrevDiscAmt,
p_szPrincipalDiscRefId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_CreatePriceOrderItemDiscBonus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId_1 BOS_DT_szId,
p_szProductId_2 BOS_DT_szId,
p_szProductId_3 BOS_DT_szId,
p_szProductId_4 BOS_DT_szId,
p_szProductId_5 BOS_DT_szId,
p_decMinQty BOS_DT_decQty,
p_decUnitQty BOS_DT_decQty,
p_decBonusDisc BOS_DT_decPrice,
p_szDiscType BOS_DT_szSmallId,
p_szOrderItemTypeId BOS_DT_szId,
p_bCalcFrPrevDiscAmt smallint,
p_szPrincipalDiscRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderItemDiscBonus
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
szProductId_1,
szProductId_2,
szProductId_3,
szProductId_4,
szProductId_5,
decMinQty,
decUnitQty,
decBonusDisc,
szDiscType,
szOrderItemTypeId,
bCalcFrPrevDiscAmt,
szPrincipalDiscRefId
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_szProductId_1,
p_szProductId_2,
p_szProductId_3,
p_szProductId_4,
p_szProductId_5,
p_decMinQty,
p_decUnitQty,
p_decBonusDisc,
p_szDiscType,
p_szOrderItemTypeId,
p_bCalcFrPrevDiscAmt,
p_szPrincipalDiscRefId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_CreatePriceOrderItemProductBonus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId_1 BOS_DT_szId,
p_szProductId_2 BOS_DT_szId,
p_szProductId_3 BOS_DT_szId,
p_szProductId_4 BOS_DT_szId,
p_szProductId_5 BOS_DT_szId,
p_decMinQty BOS_DT_decQty,
p_decUnitQty BOS_DT_decQty)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderItemProductBonus
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
szProductId_1,
szProductId_2,
szProductId_3,
szProductId_4,
szProductId_5,
decMinQty,
decUnitQty
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_szProductId_1,
p_szProductId_2,
p_szProductId_3,
p_szProductId_4,
p_szProductId_5,
p_decMinQty,
p_decUnitQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_CreatePriceOrderItemProductBonus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId_1 BOS_DT_szId,
p_szProductId_2 BOS_DT_szId,
p_szProductId_3 BOS_DT_szId,
p_szProductId_4 BOS_DT_szId,
p_szProductId_5 BOS_DT_szId,
p_decMinQty BOS_DT_decQty,
p_decUnitQty BOS_DT_decQty)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderItemProductBonus
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
szProductId_1,
szProductId_2,
szProductId_3,
szProductId_4,
szProductId_5,
decMinQty,
decUnitQty
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_szProductId_1,
p_szProductId_2,
p_szProductId_3,
p_szProductId_4,
p_szProductId_5,
p_decMinQty,
p_decUnitQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_CreatePriceOrderItemProductBonusItem(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId_1 BOS_DT_szId,
p_szProductId_2 BOS_DT_szId,
p_szProductId_3 BOS_DT_szId,
p_szProductId_4 BOS_DT_szId,
p_szProductId_5 BOS_DT_szId,
p_decMinQty BOS_DT_decAmount,
p_szBonusProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_decBonusQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szBonusType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderItemProductBonusItem
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
szProductId_1,
szProductId_2,
szProductId_3,
szProductId_4,
szProductId_5,
decMinQty,
szBonusProductId,
szOrderItemTypeId,
decBonusQty,
szUomId,
szBonusType,
szPrincipalDiscRefId
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_szProductId_1,
p_szProductId_2,
p_szProductId_3,
p_szProductId_4,
p_szProductId_5,
p_decMinQty,
p_szBonusProductId,
p_szOrderItemTypeId,
p_decBonusQty,
p_szUomId,
p_szBonusType,
p_szPrincipalDiscRefId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_CreatePriceOrderItemProductBonusItem_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId_1 BOS_DT_szId,
p_szProductId_2 BOS_DT_szId,
p_szProductId_3 BOS_DT_szId,
p_szProductId_4 BOS_DT_szId,
p_szProductId_5 BOS_DT_szId,
p_decMinQty BOS_DT_decAmount,
p_szBonusProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_decBonusQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szBonusType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderItemProductBonusItem
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
szProductId_1,
szProductId_2,
szProductId_3,
szProductId_4,
szProductId_5,
decMinQty,
szBonusProductId,
szOrderItemTypeId,
decBonusQty,
szUomId,
szBonusType,
szPrincipalDiscRefId
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_szProductId_1,
p_szProductId_2,
p_szProductId_3,
p_szProductId_4,
p_szProductId_5,
p_decMinQty,
p_szBonusProductId,
p_szOrderItemTypeId,
p_decBonusQty,
p_szUomId,
p_szBonusType,
p_szPrincipalDiscRefId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrder(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrder
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrder_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrder
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderAmountDiscBonus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceOrderAmountDiscBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderAmountDiscBonus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceOrderAmountDiscBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderAmountDiscBonusWhereGdHistory(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceOrderAmountDiscBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderAmountDiscBonusWhereGdHistory_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceOrderAmountDiscBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderAmountProductBonus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceOrderAmountProductBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderAmountProductBonus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceOrderAmountProductBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderAmountProductBonusItem(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderAmountProductBonusItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderAmountProductBonusItem_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderAmountProductBonusItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderAmountProductBonusItemWhereGdHistory(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderAmountProductBonusItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderAmountProductBonusItemWhereGdHistory_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderAmountProductBonusItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderAmountProductBonusWhereGdHistory(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceOrderAmountProductBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderAmountProductBonusWhereGdHistory_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_PriceOrderAmountProductBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderItem(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderItem_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderItemDiscBonus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderItemDiscBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderItemDiscBonus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderItemDiscBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderItemDiscBonusWhereGdHistory(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderItemDiscBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderItemDiscBonusWhereGdHistory_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderItemDiscBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderItemProductBonus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderItemProductBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderItemProductBonus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderItemProductBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderItemProductBonusItem(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderItemProductBonusItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderItemProductBonusItem_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderItemProductBonusItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderItemProductBonusItemWhereGdHistory(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderItemProductBonusItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderItemProductBonusItemWhereGdHistory_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderItemProductBonusItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderItemProductBonusWhereGdHistory(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderItemProductBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderItemProductBonusWhereGdHistory_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderItemProductBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderItemWhereGdHistory(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_DeletePriceOrderItemWhereGdHistory_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetListOfPriceOrder(
p_szStatus BOS_DT_szSmallId,
p_szUsageType BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPriceOrderId,
szDescription


FROM 
BOS_INV_PriceOrder

WHERE 
szOwnerTrnId = '' AND szStatus = p_szStatus AND szUsageType like p_szUsageType ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetPriceOrderAmountDiscBonus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decMinAmount,
decUnitAmount,
decBonusDisc,
szDiscType,
szOrderItemTypeId,
bCalcFrPrevDiscAmt,
BOS_INV_PriceOrderAmountDiscBonus.szPrincipalDiscRefId,
PrDiscRef.szDescription as szPrincipalDiscRefDesc_J


FROM 
BOS_INV_PriceOrderAmountDiscBonus
left join BOS_SD_OrgStru_PrincipalDiscRef as PrDiscRef on BOS_INV_PriceOrderAmountDiscBonus.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId and gdHistory = p_gdHistory ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetPriceOrderAmountDiscBonus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decMinAmount,
decUnitAmount,
decBonusDisc,
szDiscType,
szOrderItemTypeId,
bCalcFrPrevDiscAmt,
BOS_INV_PriceOrderAmountDiscBonus.szPrincipalDiscRefId,
PrDiscRef.szDescription as szPrincipalDiscRefDesc_J


FROM 
BOS_INV_PriceOrderAmountDiscBonus
left join BOS_SD_OrgStru_PrincipalDiscRef as PrDiscRef on BOS_INV_PriceOrderAmountDiscBonus.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId and gdHistory = p_gdHistory ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetPriceOrderAmountProductBonus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decMinAmount,
decUnitAmount


FROM 
BOS_INV_PriceOrderAmountProductBonus
WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId and gdHistory = p_gdHistory ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetPriceOrderAmountProductBonus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decMinAmount,
decUnitAmount


FROM 
BOS_INV_PriceOrderAmountProductBonus
WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId and gdHistory = p_gdHistory ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetPriceOrderAmountProductBonusItem(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_decMinAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN

select
BOS_INV_PriceOrderAmountProductBonusItem.szPriceOrderId,
BOS_INV_PriceOrderAmountProductBonusItem.decMinAmount,

BOS_INV_PriceOrderAmountProductBonusItem.szBonusProductId,

BOS_INV_Product.szName AS szBonusProductNm_J,
BOS_INV_Product.szDiscountGroupId AS szBonusProductDiscGroupId_J,
BOS_INV_Product.szQtyFormat as szBonusProductQtyFormat_J,
BOS_INV_Product.szUomClassId AS szBonusProductUomClassId_J,
BOS_INV_Product.szUomId AS szBonusProductUomId_J,
BOS_INV_Product.szCompUomId AS szBonusProductCompUomId_J,
BOS_INV_Product.szTrackingType AS szBonusProductTrackingType_J,
BOS_GL_TaxType.decRate AS decBonusProductTaxRate_J,

BOS_INV_PriceOrderAmountProductBonusItem.szOrderItemTypeId,
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,
BOS_INV_OrderItemType.bTaxable AS bOrderItemTypeTaxable_J,

BOS_INV_PriceOrderAmountProductBonusItem.decBonusQty,
BOS_INV_PriceOrderAmountProductBonusItem.szUomId,
BOS_INV_PriceOrderAmountProductBonusItem.szBonusType,
BOS_INV_PriceOrderAmountProductBonusItem.szPrincipalDiscRefId,
PrDiscRef.szDescription as szPrincipalDiscRefDesc_J

from 
BOS_INV_PriceOrderAmountProductBonusItem
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_PriceOrderAmountProductBonusItem.szBonusProductId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_INV_PriceOrderAmountProductBonusItem.szOrderItemTypeId
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId
left join BOS_SD_OrgStru_PrincipalDiscRef as PrDiscRef on BOS_INV_PriceOrderAmountProductBonusItem.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId

where
szOwnerTrnId = p_szOwnerTrnId AND
szPriceOrderId = p_szPriceOrderId and 
gdHistory = p_gdHistory and
decMinAmount = p_decMinAmount

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetPriceOrderAmountProductBonusItem_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_decMinAmount BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN

select
BOS_INV_PriceOrderAmountProductBonusItem.szPriceOrderId,
BOS_INV_PriceOrderAmountProductBonusItem.decMinAmount,

BOS_INV_PriceOrderAmountProductBonusItem.szBonusProductId,

BOS_INV_Product.szName AS szBonusProductNm_J,
BOS_INV_Product.szDiscountGroupId AS szBonusProductDiscGroupId_J,
BOS_INV_Product.szQtyFormat as szBonusProductQtyFormat_J,
BOS_INV_Product.szUomClassId AS szBonusProductUomClassId_J,
BOS_INV_Product.szUomId AS szBonusProductUomId_J,
BOS_INV_Product.szCompUomId AS szBonusProductCompUomId_J,
BOS_INV_Product.szTrackingType AS szBonusProductTrackingType_J,
BOS_GL_TaxType.decRate AS decBonusProductTaxRate_J,

BOS_INV_PriceOrderAmountProductBonusItem.szOrderItemTypeId,
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,
BOS_INV_OrderItemType.bTaxable AS bOrderItemTypeTaxable_J,

BOS_INV_PriceOrderAmountProductBonusItem.decBonusQty,
BOS_INV_PriceOrderAmountProductBonusItem.szUomId,
BOS_INV_PriceOrderAmountProductBonusItem.szBonusType,
BOS_INV_PriceOrderAmountProductBonusItem.szPrincipalDiscRefId,
PrDiscRef.szDescription as szPrincipalDiscRefDesc_J

from 
BOS_INV_PriceOrderAmountProductBonusItem
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_PriceOrderAmountProductBonusItem.szBonusProductId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_INV_PriceOrderAmountProductBonusItem.szOrderItemTypeId
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId
left join BOS_SD_OrgStru_PrincipalDiscRef as PrDiscRef on BOS_INV_PriceOrderAmountProductBonusItem.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId

where
szOwnerTrnId = p_szOwnerTrnId AND
szPriceOrderId = p_szPriceOrderId and 
gdHistory = p_gdHistory and
decMinAmount = p_decMinAmount

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetPriceOrderItem(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
select
BOS_INV_PriceOrderItem.szPriceOrderId,

BOS_INV_PriceOrderItem.szProductId_1,
P1.szName as szProductNm_1,
P1.szQtyFormat as szProductQtyFormat_1,
P1.szUomClassId AS szProductUomClassId_1_J,
P1.szUomId AS szProductUomId_1,
BOS_INV_PriceOrderItem.decQty_1,

BOS_INV_PriceOrderItem.szProductId_2,
P2.szName as szProductNm_2,
P2.szQtyFormat as szProductQtyFormat_2,
P2.szUomClassId AS szProductUomClassId_2_J,
P2.szUomId AS szProductUomId_2,
BOS_INV_PriceOrderItem.decQty_2,

BOS_INV_PriceOrderItem.szProductId_3,
P3.szName as szProductNm_3,
P3.szQtyFormat as szProductQtyFormat_3,
P3.szUomClassId AS szProductUomClassId_3_J,
P3.szUomId AS szProductUomId_3,
BOS_INV_PriceOrderItem.decQty_3,

BOS_INV_PriceOrderItem.szProductId_4,
P4.szName as szProductNm_4,
P4.szQtyFormat as szProductQtyFormat_4,
P4.szUomClassId AS szProductUomClassId_4_J,
P4.szUomId AS szProductUomId_4,
BOS_INV_PriceOrderItem.decQty_4,

BOS_INV_PriceOrderItem.szProductId_5,
P5.szName as szProductNm_5,
P5.szQtyFormat as szProductQtyFormat_5,
P5.szUomClassId AS szProductUomClassId_5_J,
P5.szUomId AS szProductUomId_5,
BOS_INV_PriceOrderItem.decQty_5,

BOS_INV_PriceOrderItem.bHasDiscountBonus,
BOS_INV_PriceOrderItem.bHasProductBonus,

BOS_INV_PriceOrderItem.szUomId_1,
BOS_INV_PriceOrderItem.szUomId_2,
BOS_INV_PriceOrderItem.szUomId_3,
BOS_INV_PriceOrderItem.szUomId_4,
BOS_INV_PriceOrderItem.szUomId_5

FROM BOS_INV_PriceOrderItem
left join BOS_INV_Product as P1 on BOS_INV_PriceOrderItem.szProductId_1 = P1.szProductId
left join BOS_INV_Product as P2 on BOS_INV_PriceOrderItem.szProductId_2 = P2.szProductId
left join BOS_INV_Product as P3 on BOS_INV_PriceOrderItem.szProductId_3 = P3.szProductId
left join BOS_INV_Product as P4 on BOS_INV_PriceOrderItem.szProductId_4 = P4.szProductId
left join BOS_INV_Product as P5 on BOS_INV_PriceOrderItem.szProductId_5 = P5.szProductId

WHERE
szOwnerTrnId = p_szOwnerTrnId AND
szPriceOrderId = p_szPriceOrderId AND
gdHistory = p_gdHistory

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetPriceOrderItem_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
select
BOS_INV_PriceOrderItem.szPriceOrderId,

BOS_INV_PriceOrderItem.szProductId_1,
P1.szName as szProductNm_1,
P1.szQtyFormat as szProductQtyFormat_1,
P1.szUomClassId AS szProductUomClassId_1_J,
P1.szUomId AS szProductUomId_1,
BOS_INV_PriceOrderItem.decQty_1,

BOS_INV_PriceOrderItem.szProductId_2,
P2.szName as szProductNm_2,
P2.szQtyFormat as szProductQtyFormat_2,
P2.szUomClassId AS szProductUomClassId_2_J,
P2.szUomId AS szProductUomId_2,
BOS_INV_PriceOrderItem.decQty_2,

BOS_INV_PriceOrderItem.szProductId_3,
P3.szName as szProductNm_3,
P3.szQtyFormat as szProductQtyFormat_3,
P3.szUomClassId AS szProductUomClassId_3_J,
P3.szUomId AS szProductUomId_3,
BOS_INV_PriceOrderItem.decQty_3,

BOS_INV_PriceOrderItem.szProductId_4,
P4.szName as szProductNm_4,
P4.szQtyFormat as szProductQtyFormat_4,
P4.szUomClassId AS szProductUomClassId_4_J,
P4.szUomId AS szProductUomId_4,
BOS_INV_PriceOrderItem.decQty_4,

BOS_INV_PriceOrderItem.szProductId_5,
P5.szName as szProductNm_5,
P5.szQtyFormat as szProductQtyFormat_5,
P5.szUomClassId AS szProductUomClassId_5_J,
P5.szUomId AS szProductUomId_5,
BOS_INV_PriceOrderItem.decQty_5,

BOS_INV_PriceOrderItem.bHasDiscountBonus,
BOS_INV_PriceOrderItem.bHasProductBonus,

BOS_INV_PriceOrderItem.szUomId_1,
BOS_INV_PriceOrderItem.szUomId_2,
BOS_INV_PriceOrderItem.szUomId_3,
BOS_INV_PriceOrderItem.szUomId_4,
BOS_INV_PriceOrderItem.szUomId_5

FROM BOS_INV_PriceOrderItem
left join BOS_INV_Product as P1 on BOS_INV_PriceOrderItem.szProductId_1 = P1.szProductId
left join BOS_INV_Product as P2 on BOS_INV_PriceOrderItem.szProductId_2 = P2.szProductId
left join BOS_INV_Product as P3 on BOS_INV_PriceOrderItem.szProductId_3 = P3.szProductId
left join BOS_INV_Product as P4 on BOS_INV_PriceOrderItem.szProductId_4 = P4.szProductId
left join BOS_INV_Product as P5 on BOS_INV_PriceOrderItem.szProductId_5 = P5.szProductId

WHERE
szOwnerTrnId = p_szOwnerTrnId AND
szPriceOrderId = p_szPriceOrderId AND
gdHistory = p_gdHistory

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetPriceOrderItemDiscBonus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId_1 BOS_DT_szId,
p_szProductId_2 BOS_DT_szId,
p_szProductId_3 BOS_DT_szId,
p_szProductId_4 BOS_DT_szId,
p_szProductId_5 BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decMinQty,
decUnitQty,
decBonusDisc,
szDiscType,
szOrderItemTypeId,
bCalcFrPrevDiscAmt,
BOS_INV_PriceOrderItemDiscBonus.szPrincipalDiscRefId,
PrDiscRef.szDescription as szPrincipalDiscRefDesc_J


FROM 
BOS_INV_PriceOrderItemDiscBonus
left join BOS_SD_OrgStru_PrincipalDiscRef as PrDiscRef on BOS_INV_PriceOrderItemDiscBonus.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId and gdHistory = p_gdHistory AND szProductId_1 = p_szProductId_1 AND szProductId_2 = p_szProductId_2 AND szProductId_3 = p_szProductId_3 AND szProductId_4 = p_szProductId_4 AND szProductId_5 = p_szProductId_5 ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetPriceOrderItemDiscBonus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId_1 BOS_DT_szId,
p_szProductId_2 BOS_DT_szId,
p_szProductId_3 BOS_DT_szId,
p_szProductId_4 BOS_DT_szId,
p_szProductId_5 BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decMinQty,
decUnitQty,
decBonusDisc,
szDiscType,
szOrderItemTypeId,
bCalcFrPrevDiscAmt,
BOS_INV_PriceOrderItemDiscBonus.szPrincipalDiscRefId,
PrDiscRef.szDescription as szPrincipalDiscRefDesc_J


FROM 
BOS_INV_PriceOrderItemDiscBonus
left join BOS_SD_OrgStru_PrincipalDiscRef as PrDiscRef on BOS_INV_PriceOrderItemDiscBonus.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId and gdHistory = p_gdHistory AND szProductId_1 = p_szProductId_1 AND szProductId_2 = p_szProductId_2 AND szProductId_3 = p_szProductId_3 AND szProductId_4 = p_szProductId_4 AND szProductId_5 = p_szProductId_5 ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetPriceOrderItemProductBonus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId_1 BOS_DT_szId,
p_szProductId_2 BOS_DT_szId,
p_szProductId_3 BOS_DT_szId,
p_szProductId_4 BOS_DT_szId,
p_szProductId_5 BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPriceOrderId,
decMinQty,
decUnitQty


FROM 
BOS_INV_PriceOrderItemProductBonus

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId and gdHistory = p_gdHistory AND szProductId_1 = p_szProductId_1 AND szProductId_2 = p_szProductId_2 AND szProductId_3 = p_szProductId_3 AND szProductId_4 = p_szProductId_4 AND szProductId_5 = p_szProductId_5 ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetPriceOrderItemProductBonus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId_1 BOS_DT_szId,
p_szProductId_2 BOS_DT_szId,
p_szProductId_3 BOS_DT_szId,
p_szProductId_4 BOS_DT_szId,
p_szProductId_5 BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPriceOrderId,
decMinQty,
decUnitQty


FROM 
BOS_INV_PriceOrderItemProductBonus

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId and gdHistory = p_gdHistory AND szProductId_1 = p_szProductId_1 AND szProductId_2 = p_szProductId_2 AND szProductId_3 = p_szProductId_3 AND szProductId_4 = p_szProductId_4 AND szProductId_5 = p_szProductId_5 ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetPriceOrderItemProductBonusItem(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId_1 BOS_DT_szId,
p_szProductId_2 BOS_DT_szId,
p_szProductId_3 BOS_DT_szId,
p_szProductId_4 BOS_DT_szId,
p_szProductId_5 BOS_DT_szId,
p_decMinQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
select
BOS_INV_PriceOrderItemProductBonusItem.szPriceOrderId,
BOS_INV_PriceOrderItemProductBonusItem.decMinQty,

BOS_INV_PriceOrderItemProductBonusItem.szBonusProductId,
BOS_INV_Product.szName AS szBonusProductNm_J,
BOS_INV_Product.szDiscountGroupId AS szBonusProductDiscGroupId_J,
BOS_INV_Product.szQtyFormat as szBonusProductQtyFormat_J,
BOS_INV_Product.szUomClassId AS szBonusProductUomClassId_J,
BOS_INV_Product.szUomId AS szBonusProductUomId_J,
BOS_INV_Product.szCompUomId AS szBonusProductCompUomId_J,
BOS_INV_Product.szTrackingType AS szBonusProductTrackingType_J,
BOS_GL_TaxType.decRate AS decBonusProductTaxRate_J,

BOS_INV_PriceOrderItemProductBonusItem.szOrderItemTypeId,
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,
BOS_INV_OrderItemType.bTaxable AS bOrderItemTypeTaxable_J,

BOS_INV_PriceOrderItemProductBonusItem.decBonusQty,
BOS_INV_PriceOrderItemProductBonusItem.szUomId,
BOS_INV_PriceOrderItemProductBonusItem.szBonusType,
BOS_INV_PriceOrderItemProductBonusItem.szPrincipalDiscRefId,
PrDiscRef.szDescription as szPrincipalDiscRefDesc_J

from 
BOS_INV_PriceOrderItemProductBonusItem
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_PriceOrderItemProductBonusItem.szBonusProductId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_INV_PriceOrderItemProductBonusItem.szOrderItemTypeId
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId
left join BOS_SD_OrgStru_PrincipalDiscRef as PrDiscRef on BOS_INV_PriceOrderItemProductBonusItem.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId

where
szOwnerTrnId = p_szOwnerTrnId AND
szPriceOrderId = p_szPriceOrderId and 
gdHistory = p_gdHistory
AND szProductId_1 = p_szProductId_1
AND szProductId_2 = p_szProductId_2
AND szProductId_3 = p_szProductId_3
AND szProductId_4 = p_szProductId_4
AND szProductId_5 = p_szProductId_5
AND decMinQty = p_decMinQty

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetPriceOrderItemProductBonusItem_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szProductId_1 BOS_DT_szId,
p_szProductId_2 BOS_DT_szId,
p_szProductId_3 BOS_DT_szId,
p_szProductId_4 BOS_DT_szId,
p_szProductId_5 BOS_DT_szId,
p_decMinQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
select
BOS_INV_PriceOrderItemProductBonusItem.szPriceOrderId,
BOS_INV_PriceOrderItemProductBonusItem.decMinQty,

BOS_INV_PriceOrderItemProductBonusItem.szBonusProductId,
BOS_INV_Product.szName AS szBonusProductNm_J,
BOS_INV_Product.szDiscountGroupId AS szBonusProductDiscGroupId_J,
BOS_INV_Product.szQtyFormat as szBonusProductQtyFormat_J,
BOS_INV_Product.szUomClassId AS szBonusProductUomClassId_J,
BOS_INV_Product.szUomId AS szBonusProductUomId_J,
BOS_INV_Product.szCompUomId AS szBonusProductCompUomId_J,
BOS_INV_Product.szTrackingType AS szBonusProductTrackingType_J,
BOS_GL_TaxType.decRate AS decBonusProductTaxRate_J,

BOS_INV_PriceOrderItemProductBonusItem.szOrderItemTypeId,
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,
BOS_INV_OrderItemType.bTaxable AS bOrderItemTypeTaxable_J,

BOS_INV_PriceOrderItemProductBonusItem.decBonusQty,
BOS_INV_PriceOrderItemProductBonusItem.szUomId,
BOS_INV_PriceOrderItemProductBonusItem.szBonusType,
BOS_INV_PriceOrderItemProductBonusItem.szPrincipalDiscRefId,
PrDiscRef.szDescription as szPrincipalDiscRefDesc_J

from 
BOS_INV_PriceOrderItemProductBonusItem
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_PriceOrderItemProductBonusItem.szBonusProductId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_INV_PriceOrderItemProductBonusItem.szOrderItemTypeId
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId
left join BOS_SD_OrgStru_PrincipalDiscRef as PrDiscRef on BOS_INV_PriceOrderItemProductBonusItem.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId

where
szOwnerTrnId = p_szOwnerTrnId AND
szPriceOrderId = p_szPriceOrderId and 
gdHistory = p_gdHistory
AND szProductId_1 = p_szProductId_1
AND szProductId_2 = p_szProductId_2
AND szProductId_3 = p_szProductId_3
AND szProductId_4 = p_szProductId_4
AND szProductId_5 = p_szProductId_5
AND decMinQty = p_decMinQty

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetPriceOrderWhereGuid(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPriceOrderId,
gdHistory,
szStatus,
szUsageType,
szWorkplaceId,
szSalesOrgId_1,
szSalesOrgId_2,
szDescription,
bIsSpecificEndDate,
dtmvalidStart,
dtmValidEnd,
BOS_INV_PriceOrder.szCcyId,
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat,
bHasCombinationBonus,
bOnlyCalculateFrCombination,
bHasAmountDiscBonus,
bHasAmountProductBonus,
bHasProvisionBonus,

bMinDiscBaseOnAmount,
bUnitDiscBaseOnAmount,

bMinBonusBaseOnAmount,
bUnitBonusBaseOnAmount,

szUomId,

szNextOwnerTrnId,
szNextPriceOrderId,

szPriceCombCd,
shPriceCombOrder,

szQualifierId,
szQualifierId_2,
szQualifierId_3,

szDiscGroupId,
szDiscGroupId_2,
szDiscGroupId_3,

-- Data Status.
BOS_INV_PriceOrder.dtmLastUpdated,
BOS_INV_PriceOrder.bAlreadyTransferred

FROM 
BOS_INV_PriceOrder
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_INV_PriceOrder.szCcyIdLEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_INV_PriceOrder.szCcyId;

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId AND gdHistory = p_gdHistory ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetPriceOrderWhereGuid_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPriceOrderId,
gdHistory,
szStatus,
szUsageType,
szWorkplaceId,
szSalesOrgId_1,
szSalesOrgId_2,
szDescription,
bIsSpecificEndDate,
dtmvalidStart,
dtmValidEnd,
BOS_INV_PriceOrder.szCcyId,
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat,
bHasCombinationBonus,
bOnlyCalculateFrCombination,
bHasAmountDiscBonus,
bHasAmountProductBonus,
bHasProvisionBonus,

bMinDiscBaseOnAmount,
bUnitDiscBaseOnAmount,

bMinBonusBaseOnAmount,
bUnitBonusBaseOnAmount,

szUomId,

szNextOwnerTrnId,
szNextPriceOrderId,

szPriceCombCd,
shPriceCombOrder,

szQualifierId,
szQualifierId_2,
szQualifierId_3,

szDiscGroupId,
szDiscGroupId_2,
szDiscGroupId_3,

-- Data Status.
BOS_INV_PriceOrder.dtmLastUpdated,
BOS_INV_PriceOrder.bAlreadyTransferred

FROM 
BOS_INV_PriceOrder
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_INV_PriceOrder.szCcyIdLEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_INV_PriceOrder.szCcyId;

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId AND gdHistory = p_gdHistory ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetPriceOrderWhereStatus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPriceOrderId,
gdHistory,
szStatus,
szUsageType,
szWorkplaceId,
szSalesOrgId_1,
szSalesOrgId_2,
szDescription,
bIsSpecificEndDate,
dtmvalidStart,
dtmValidEnd,
BOS_INV_PriceOrder.szCcyId,
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat,
bHasCombinationBonus,
bOnlyCalculateFrCombination,
bHasAmountDiscBonus,
bHasAmountProductBonus,
bHasProvisionBonus,

bMinDiscBaseOnAmount,
bUnitDiscBaseOnAmount,

bMinBonusBaseOnAmount,
bUnitBonusBaseOnAmount,

szUomId,

szNextOwnerTrnId,
szNextPriceOrderId,

szPriceCombCd,
shPriceCombOrder,

szQualifierId,
szQualifierId_2,
szQualifierId_3,

szDiscGroupId,
szDiscGroupId_2,
szDiscGroupId_3,

-- Data Status.
BOS_INV_PriceOrder.dtmLastUpdated,
BOS_INV_PriceOrder.bAlreadyTransferred

FROM 
BOS_INV_PriceOrder
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_INV_PriceOrder.szCcyIdLEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_INV_PriceOrder.szCcyId;

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId AND szStatus = p_szStatus ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_GetPriceOrderWhereStatus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPriceOrderId,
gdHistory,
szStatus,
szUsageType,
szWorkplaceId,
szSalesOrgId_1,
szSalesOrgId_2,
szDescription,
bIsSpecificEndDate,
dtmvalidStart,
dtmValidEnd,
BOS_INV_PriceOrder.szCcyId,
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat,
bHasCombinationBonus,
bOnlyCalculateFrCombination,
bHasAmountDiscBonus,
bHasAmountProductBonus,
bHasProvisionBonus,

bMinDiscBaseOnAmount,
bUnitDiscBaseOnAmount,

bMinBonusBaseOnAmount,
bUnitBonusBaseOnAmount,

szUomId,

szNextOwnerTrnId,
szNextPriceOrderId,

szPriceCombCd,
shPriceCombOrder,

szQualifierId,
szQualifierId_2,
szQualifierId_3,

szDiscGroupId,
szDiscGroupId_2,
szDiscGroupId_3,

-- Data Status.
BOS_INV_PriceOrder.dtmLastUpdated,
BOS_INV_PriceOrder.bAlreadyTransferred

FROM 
BOS_INV_PriceOrder
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_INV_PriceOrder.szCcyIdLEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_INV_PriceOrder.szCcyId;

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId AND szStatus = p_szStatus ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_IsPriceOrderExistWhereGuid(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPriceOrderId


FROM 
BOS_INV_PriceOrder

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId AND gdHistory = p_gdHistory ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_IsPriceOrderExistWhereGuid_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPriceOrderId


FROM 
BOS_INV_PriceOrder

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId AND gdHistory = p_gdHistory ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_IsPriceOrderExistWhereStatus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPriceOrderId


FROM 
BOS_INV_PriceOrder

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId AND szStatus = p_szStatus ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_IsPriceOrderExistWhereStatus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPriceOrderId


FROM 
BOS_INV_PriceOrder

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId AND szStatus = p_szStatus ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_LockPriceOrderWhereGuid(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_PriceOrder
SET 
szDescription = szDescription
WHERE 
szOwnerTrnId = p_szOwnerTrnId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_LockPriceOrderWhereGuid_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_PriceOrder
SET 
szDescription = szDescription
WHERE 
szOwnerTrnId = p_szOwnerTrnId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_LockPriceOrderWhereStatus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_szStatus varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_PriceOrder
SET 
szDescription = szDescription

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_LockPriceOrderWhereStatus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_szStatus varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_PriceOrder
SET 
szDescription = szDescription

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_UpdatePriceOrder(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szUsageType BOS_DT_szSmallId,
p_szStatus BOS_DT_szSmallId,
p_szWorkplaceId BOS_DT_szId,
p_szSalesOrgId_1 BOS_DT_szId,
p_szSalesOrgId_2 BOS_DT_szId,
p_szDescription varchar,
p_bIsSpecificEndDate bit,
p_dtmvalidStart timestamp,
p_dtmValidEnd timestamp,
p_szCcyId BOS_DT_szSmallId,
p_bHasCombinationBonus bit,
p_bOnlyCalculateFrCombination bit,
p_bHasAmountDiscBonus bit,
p_bHasAmountProductBonus bit,
p_bHasProvisionBonus bit,
p_bMinDiscBaseOnAmount BOS_DT_bBoolean,
p_bUnitDiscBaseOnAmount BOS_DT_bBoolean,
p_bMinBonusBaseOnAmount BOS_DT_bBoolean,
p_bUnitBonusBaseOnAmount BOS_DT_bBoolean,
p_szUomId BOS_DT_szMediumId,
p_szNextOwnerTrnId BOS_DT_szMediumId,
p_szNextPriceOrderId BOS_DT_szId,
p_szPriceCombCd BOS_DT_szMediumId,
p_shPriceCombOrder smallint,
p_szQualifierId BOS_DT_szBigId,
p_szQualifierId_2 BOS_DT_szBigId,
p_szQualifierId_3 BOS_DT_szBigId,
p_szDiscGroupId BOS_DT_szBigId,
p_szDiscGroupId_2 BOS_DT_szBigId,
p_szDiscGroupId_3 BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_PriceOrder
SET 
szUsageType = p_szUsageType,
szStatus = p_szStatus,
szWorkplaceId = p_szWorkplaceId,
szSalesOrgId_1 = p_szSalesOrgId_1,
szSalesOrgId_2 = p_szSalesOrgId_2,
szDescription = p_szDescription,
bIsSpecificEndDate = p_bIsSpecificEndDate,
dtmvalidStart = p_dtmvalidStart,
dtmValidEnd = p_dtmValidEnd,
szCcyId = p_szCcyId,
bHasCombinationBonus = p_bHasCombinationBonus,
bOnlyCalculateFrCombination = p_bOnlyCalculateFrCombination,
bHasAmountDiscBonus = p_bHasAmountDiscBonus,
bHasAmountProductBonus = p_bHasAmountProductBonus,
bHasProvisionBonus = p_bHasProvisionBonus,

bMinDiscBaseOnAmount = p_bMinDiscBaseOnAmount,
bUnitDiscBaseOnAmount = p_bUnitDiscBaseOnAmount,

bMinBonusBaseOnAmount = p_bMinBonusBaseOnAmount,
bUnitBonusBaseOnAmount = p_bUnitBonusBaseOnAmount,

szUomId = p_szUomId,

szNextOwnerTrnId = p_szNextOwnerTrnId,
szNextPriceOrderId = p_szNextPriceOrderId,

szPriceCombCd = p_szPriceCombCd,
shPriceCombOrder = p_shPriceCombOrder,

szQualifierId = p_szQualifierId,
szQualifierId_2 = p_szQualifierId_2,
szQualifierId_3 = p_szQualifierId_3,

szDiscGroupId = p_szDiscGroupId,
szDiscGroupId_2 = p_szDiscGroupId_2,
szDiscGroupId_3 = p_szDiscGroupId_3

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_UpdatePriceOrder_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szUsageType BOS_DT_szSmallId,
p_szStatus BOS_DT_szSmallId,
p_szWorkplaceId BOS_DT_szId,
p_szSalesOrgId_1 BOS_DT_szId,
p_szSalesOrgId_2 BOS_DT_szId,
p_szDescription varchar,
p_bIsSpecificEndDate bit,
p_dtmvalidStart timestamp,
p_dtmValidEnd timestamp,
p_szCcyId BOS_DT_szSmallId,
p_bHasCombinationBonus bit,
p_bOnlyCalculateFrCombination bit,
p_bHasAmountDiscBonus bit,
p_bHasAmountProductBonus bit,
p_bHasProvisionBonus bit,
p_bMinDiscBaseOnAmount BOS_DT_bBoolean,
p_bUnitDiscBaseOnAmount BOS_DT_bBoolean,
p_bMinBonusBaseOnAmount BOS_DT_bBoolean,
p_bUnitBonusBaseOnAmount BOS_DT_bBoolean,
p_szUomId BOS_DT_szMediumId,
p_szNextOwnerTrnId BOS_DT_szMediumId,
p_szNextPriceOrderId BOS_DT_szId,
p_szPriceCombCd BOS_DT_szMediumId,
p_shPriceCombOrder smallint,
p_szQualifierId BOS_DT_szBigId,
p_szQualifierId_2 BOS_DT_szBigId,
p_szQualifierId_3 BOS_DT_szBigId,
p_szDiscGroupId BOS_DT_szBigId,
p_szDiscGroupId_2 BOS_DT_szBigId,
p_szDiscGroupId_3 BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_PriceOrder
SET 
szUsageType = p_szUsageType,
szStatus = p_szStatus,
szWorkplaceId = p_szWorkplaceId,
szSalesOrgId_1 = p_szSalesOrgId_1,
szSalesOrgId_2 = p_szSalesOrgId_2,
szDescription = p_szDescription,
bIsSpecificEndDate = p_bIsSpecificEndDate,
dtmvalidStart = p_dtmvalidStart,
dtmValidEnd = p_dtmValidEnd,
szCcyId = p_szCcyId,
bHasCombinationBonus = p_bHasCombinationBonus,
bOnlyCalculateFrCombination = p_bOnlyCalculateFrCombination,
bHasAmountDiscBonus = p_bHasAmountDiscBonus,
bHasAmountProductBonus = p_bHasAmountProductBonus,
bHasProvisionBonus = p_bHasProvisionBonus,

bMinDiscBaseOnAmount = p_bMinDiscBaseOnAmount,
bUnitDiscBaseOnAmount = p_bUnitDiscBaseOnAmount,

bMinBonusBaseOnAmount = p_bMinBonusBaseOnAmount,
bUnitBonusBaseOnAmount = p_bUnitBonusBaseOnAmount,

szUomId = p_szUomId,

szNextOwnerTrnId = p_szNextOwnerTrnId,
szNextPriceOrderId = p_szNextPriceOrderId,

szPriceCombCd = p_szPriceCombCd,
shPriceCombOrder = p_shPriceCombOrder,

szQualifierId = p_szQualifierId,
szQualifierId_2 = p_szQualifierId_2,
szQualifierId_3 = p_szQualifierId_3,

szDiscGroupId = p_szDiscGroupId,
szDiscGroupId_2 = p_szDiscGroupId_2,
szDiscGroupId_3 = p_szDiscGroupId_3

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_UpdatePriceOrderStatus(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_PriceOrder
SET 
szStatus = p_szStatus

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrder_UpdatePriceOrderStatus_013(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_szStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_PriceOrder
SET 
szStatus = p_szStatus

WHERE 
szOwnerTrnId = p_szOwnerTrnId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvision_Create(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_shProvisionId integer,
p_shMinProductOrder integer,
p_bBaseOnAmount smallint,
p_bHasDiscountBonus smallint,
p_bHasProductBonus smallint,
p_bHasMinOrderOnAmount smallint,
p_szUomId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderProvision
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
shProvisionId,
shMinProductOrder,
bBaseOnAmount,
bHasDiscountBonus,
bHasProductBonus,
bHasMinOrderOnAmount,
szUomId
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_shProvisionId,
p_shMinProductOrder,
p_bBaseOnAmount,
p_bHasDiscountBonus,
p_bHasProductBonus,
p_bHasMinOrderOnAmount,
p_szUomId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvision_Delete(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderProvision
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvision_DeleteHistoryOnly(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderProvision
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvision_GetList(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shProvisionId,
shMinProductOrder,
bBaseOnAmount,
bHasDiscountBonus,
bHasProductBonus,
bHasMinOrderOnAmount,
szUomId

FROM 
BOS_INV_PriceOrderProvision
WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId AND gdHistory = p_gdHistory ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvisionItem_Create(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_shProvisionId integer,
p_shProvisionItemId integer,
p_szProductId BOS_DT_szId,
p_decMinOrder BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_bMustOrder smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderProvisionItem
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
shProvisionId,
shProvisionItemId,
szProductId,
decMinOrder,
szUomId,
bMustOrder
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_shProvisionId,
p_shProvisionItemId,
p_szProductId,
p_decMinOrder,
p_szUomId,
p_bMustOrder
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvisionItem_Delete(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_INV_PriceOrderProvisionItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvisionItem_DeleteHistoryOnly(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_INV_PriceOrderProvisionItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvisionItem_GetList(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_shProvisionId integer)
RETURNS void AS
$BODY$
BEGIN
SELECT 
a.shProvisionItemId,
a.szProductId,
a.decMinOrder,
a.szUomId,
a.bMustOrder,
isnull(b.szName, '') as szProductName_J

FROM 
BOS_INV_PriceOrderProvisionItem a
WHERE 
a.szOwnerTrnId = p_szOwnerTrnId AND a.szPriceOrderId = p_szPriceOrderId AND a.gdHistory = p_gdHistory AND a.shProvisionId = p_shProvisionId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvisionItemDiscount_Create(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_shProvisionId integer,
p_shProvisionItemId integer,
p_decMinQty BOS_DT_decAmount,
p_decUnitQty BOS_DT_decAmount,
p_szDiscType BOS_DT_szId,
p_decBonusDisc BOS_DT_decAmount,
p_szOrderItemTypeId BOS_DT_szId,
p_bCalcFrPrevDiscAmt smallint,
p_szPrincipalDiscRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderProvisionItemDiscount
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
shProvisionId,
shProvisionItemId,
decMinQty,
decUnitQty,
szDiscType,
decBonusDisc,
szOrderItemTypeId,
bCalcFrPrevDiscAmt,
szPrincipalDiscRefId
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_shProvisionId,
p_shProvisionItemId,
p_decMinQty,
p_decUnitQty,
p_szDiscType,
p_decBonusDisc,
p_szOrderItemTypeId,
p_bCalcFrPrevDiscAmt,
p_szPrincipalDiscRefId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvisionItemDiscount_Create_014(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_shProvisionId integer,
p_shProvisionItemId integer,
p_decMinQty BOS_DT_decAmount,
p_decUnitQty BOS_DT_decAmount,
p_szDiscType BOS_DT_szId,
p_decBonusDisc BOS_DT_decAmount,
p_szOrderItemTypeId BOS_DT_szId,
p_bCalcFrPrevDiscAmt smallint,
p_szPrincipalDiscRefId BOS_DT_szId,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderProvisionItemDiscount
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
shProvisionId,
shProvisionItemId,
decMinQty,
decUnitQty,
szDiscType,
decBonusDisc,
szOrderItemTypeId,
bCalcFrPrevDiscAmt,
szPrincipalDiscRefId,
szProductId
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_shProvisionId,
p_shProvisionItemId,
p_decMinQty,
p_decUnitQty,
p_szDiscType,
p_decBonusDisc,
p_szOrderItemTypeId,
p_bCalcFrPrevDiscAmt,
p_szPrincipalDiscRefId,
p_szProductId,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvisionItemDiscount_Delete(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderProvisionItemDiscount
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvisionItemDiscount_DeleteHistoryOnly(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_PriceOrderProvisionItemDiscount
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvisionItemDiscount_GetList(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_shProvisionId integer)
RETURNS void AS
$BODY$
BEGIN
SELECT 
a.shProvisionItemId,
a.decMinQty,
a.decUnitQty,
a.szDiscType,
a.decBonusDisc,
a.szOrderItemTypeId,
a.bCalcFrPrevDiscAmt,
a.szPrincipalDiscRefId,
isnull(b.szDescription,'') as szPrincipalDiscRefDesc_J

FROM 
BOS_INV_PriceOrderProvisionItemDiscount a
WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId AND gdHistory = p_gdHistory AND shProvisionId = p_shProvisionId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvisionItemDiscount_GetList_014(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_shProvisionId integer)
RETURNS void AS
$BODY$
BEGIN
SELECT 
a.shProvisionItemId,
a.decMinQty,
a.decUnitQty,
a.szDiscType,
a.decBonusDisc,
a.szOrderItemTypeId,
a.bCalcFrPrevDiscAmt,
a.szPrincipalDiscRefId,
isnull(b.szDescription,'') as szPrincipalDiscRefDesc_J,
a.szProductId

FROM 
BOS_INV_PriceOrderProvisionItemDiscount a
WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId AND gdHistory = p_gdHistory AND shProvisionId = p_shProvisionId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvisionItemProductBonus_Create(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_shProvisionId integer,
p_shProvisionItemId integer,
p_decMinQty BOS_DT_decAmount,
p_decUnitQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderProvisionItemProductBonus
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
shProvisionId,
shProvisionItemId,
decMinQty,
decUnitQty
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_shProvisionId,
p_shProvisionItemId,
p_decMinQty,
p_decUnitQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvisionItemProductBonus_Delete(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_INV_PriceOrderProvisionItemProductBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvisionItemProductBonus_DeleteHistoryOnly(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_INV_PriceOrderProvisionItemProductBonus
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvisionItemProductBonus_GetList(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_shProvisionId integer)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shProvisionItemId,
decMinQty,
decUnitQty

FROM 
BOS_INV_PriceOrderProvisionItemProductBonus
WHERE 
szOwnerTrnId = p_szOwnerTrnId AND szPriceOrderId = p_szPriceOrderId AND gdHistory = p_gdHistory AND shProvisionId = p_shProvisionId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvisionItemProductBonusItem_Create(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_shProvisionId integer,
p_shProvisionItemId integer,
p_shProvisionProductBonusItemId integer,
p_szBonusProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_decBonusQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_szBonusType BOS_DT_szId,
p_szPrincipalDiscRefId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_PriceOrderProvisionItemProductBonusItem
(
szOwnerTrnId,
szPriceOrderId,
gdHistory,
shProvisionId,
shProvisionItemId,
shProvisionProductBonusItemId,
szBonusProductId,
szOrderItemTypeId,
decBonusQty,
szUomId,
szBonusType,
szPrincipalDiscRefId
)
VALUES
(
p_szOwnerTrnId,
p_szPriceOrderId,
p_gdHistory,
p_shProvisionId,
p_shProvisionItemId,
p_shProvisionProductBonusItemId,
p_szBonusProductId,
p_szOrderItemTypeId,
p_decBonusQty,
p_szUomId,
p_szBonusType,
p_szPrincipalDiscRefId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvisionItemProductBonusItem_Delete(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_INV_PriceOrderProvisionItemProductBonusItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvisionItemProductBonusItem_DeleteHistoryOnly(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_INV_PriceOrderProvisionItemProductBonusItem
WHERE
szOwnerTrnId = p_szOwnerTrnId ANDszPriceOrderId = p_szPriceOrderId ANDgdHistory = p_gdHistory;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_PriceOrderProvisionItemProductBonusItem_GetList(
p_szOwnerTrnId BOS_DT_szMediumId,
p_szPriceOrderId BOS_DT_szId,
p_gdHistory bytea,
p_shProvisionId integer,
p_shProvisionItemId integer)
RETURNS void AS
$BODY$
BEGIN
select
a.shProvisionItemId,
a.szBonusProductId,

isnull(b.szName,'') AS szBonusProductNm_J,
isnull(b.szDiscountGroupId,'') AS szBonusProductDiscGroupId_J,
isnull(b.szQtyFormat,'') as szBonusProductQtyFormat_J,
isnull(b.szUomClassId,'') AS szBonusProductUomClassId_J,
isnull(b.szUomId,'') AS szBonusProductUomId_J,
isnull(b.szCompUomId,'') AS szBonusProductCompUomId_J,
isnull(b.szTrackingType,'') AS szBonusProductTrackingType_J,

a.szOrderItemTypeId,
isnull(c.szTrnType,'') AS szOrderItemTypeTrnType_J,
isnull(c.bTaxable,0) AS bOrderItemTypeTaxable_J,

isnull(d.decRate,0) AS decBonusProductTaxRate_J,

a.decBonusQty,
a.szUomId,
a.szBonusType,
a.szPrincipalDiscRefId,
isnull(e.szDescription,'') as szPrincipalDiscRefDesc_J
from BOS_INV_PriceOrderProvisionItemProductBonusItem a
left join BOS_INV_Product b on b.szProductId = a.szBonusProductId
left join BOS_INV_OrderItemType c ON c.szOrderItemTypeId = a.szOrderItemTypeId
left join BOS_GL_TaxType d ON d.szTaxTypeId = b.szTaxTypeId
left join BOS_SD_OrgStru_PrincipalDiscRef as e on a.szPrincipalDiscRefId = e.szPrincipalDiscRefId
where
szOwnerTrnId = p_szOwnerTrnId AND
szPriceOrderId = p_szPriceOrderId AND
gdHistory = p_gdHistory AND
shProvisionId = p_shProvisionId AND
shProvisionItemId = p_shProvisionItemId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_CreateProduct(
p_szProductId BOS_DT_szId,
p_szName varchar,
p_szNickName BOS_DT_szName,
p_bService bit,
p_szUomClassId BOS_DT_szMediumId,
p_szUomId BOS_DT_szMediumId,
p_bKit bit,
p_bExplodeKit bit,
p_bBreakNonExplodeKit BOS_DT_bBoolean,
p_szTrackingType BOS_DT_szSmallId,
p_szCategory_1 BOS_DT_szId,
p_szCategory_2 BOS_DT_szId,
p_szCategory_3 BOS_DT_szId,
p_szCategory_4 BOS_DT_szId,
p_szCategory_5 BOS_DT_szId,
p_szCategory_6 BOS_DT_szId,
p_szCategory_7 BOS_DT_szId,
p_szCategory_8 BOS_DT_szId,
p_szCategory_9 BOS_DT_szId,
p_szCategory_10 BOS_DT_szId,
p_szQtyFormat varchar,
p_szOrderItemTypeId BOS_DT_szId,
p_szArClassId BOS_DT_szId,
p_szTaxTypeId BOS_DT_szId,
p_szCompUomId BOS_DT_szId,
p_szSupplyType BOS_DT_szSmallId,
p_bDoNotCheckQtyWhenDoProductBooking bit,
p_dtmValidStart timestamp,
p_dtmValidEnd timestamp,
p_bShowKit bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szDiscountGroupId BOS_DT_szId,
p_bUsedByAllWorkplace BOS_DT_bBoolean,
p_bPromo BOS_DT_bBoolean,
p_dtmPromoStart timestamp,
p_dtmPromoEnd timestamp,
p_szBarcode BOS_DT_szId,
p_szBarcodeSekunder BOS_DT_szId,
p_szBarcodeTersier BOS_DT_szId,
p_szApplicationClass BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_Product
(
szProductId ,
szName,
szNickName,
bService,
szUomClassId,
szUomId,
bKit,
bExplodeKit  ,
bBreakNonExplodeKit,
szTrackingType,
szCategory_1 ,
szCategory_2 ,
szCategory_3 ,
szCategory_4 ,
szCategory_5,
szCategory_6 ,
szCategory_7 ,
szCategory_8 ,
szCategory_9 ,
szCategory_10,
szQtyFormat,
szOrderItemTypeId,
szArClassId,
szTaxTypeId,
szCompUomId,
szSupplyType,
bDoNotCheckQtyWhenDoProductBooking,
dtmValidStart,
dtmValidEnd,
bShowKit,
dtmLastUpdated,
bAlreadyTransferred,
szDiscountGroupId,
bUsedByAllWorkplace,
bPromo,
dtmPromoStart,
dtmPromoEnd,
szBarcode,
-- add szBarcodeSekunder and szBarcodeTersier --,
 szBarcodeSekunder,
szBarcodeTersier,
szApplicationClass,
)
VALUES
(
p_szProductId ,
p_szName,
p_szNickName,
p_bService,
p_szUomClassId,
p_szUomId,
p_bKit,
p_bExplodeKit  ,
p_bBreakNonExplodeKit,
p_szTrackingType,
p_szCategory_1,
p_szCategory_2 ,
p_szCategory_3 ,
p_szCategory_4,
p_szCategory_5,
p_szCategory_6,
p_szCategory_7 ,
p_szCategory_8 ,
p_szCategory_9,
p_szCategory_10,
p_szQtyFormat,
p_szOrderItemTypeId,
p_szArClassId,
p_szTaxTypeId,
p_szCompUomId,
p_szSupplyType,
p_bDoNotCheckQtyWhenDoProductBooking,
p_dtmValidStart,
p_dtmValidEnd,
p_bShowKit,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szDiscountGroupId,
p_bUsedByAllWorkplace,
p_bPromo,
p_dtmPromoStart,
p_dtmPromoEnd,
p_szBarcode,
-- add szBarcodeSekunder and szBarcodeTersier --,
 p_szBarcodeSekunder,
p_szBarcodeTersier,
p_szApplicationClass,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_CreateProduct_013(
p_szProductId BOS_DT_szId,
p_szName varchar,
p_szNickName BOS_DT_szName,
p_bService bit,
p_szUomClassId BOS_DT_szMediumId,
p_szUomId BOS_DT_szMediumId,
p_bKit bit,
p_bExplodeKit bit,
p_bBreakNonExplodeKit BOS_DT_bBoolean,
p_szTrackingType BOS_DT_szSmallId,
p_szCategory_1 BOS_DT_szId,
p_szCategory_2 BOS_DT_szId,
p_szCategory_3 BOS_DT_szId,
p_szCategory_4 BOS_DT_szId,
p_szCategory_5 BOS_DT_szId,
p_szCategory_6 BOS_DT_szId,
p_szCategory_7 BOS_DT_szId,
p_szCategory_8 BOS_DT_szId,
p_szCategory_9 BOS_DT_szId,
p_szCategory_10 BOS_DT_szId,
p_szQtyFormat varchar,
p_szOrderItemTypeId BOS_DT_szId,
p_szArClassId BOS_DT_szId,
p_szTaxTypeId BOS_DT_szId,
p_szCompUomId BOS_DT_szId,
p_szSupplyType BOS_DT_szSmallId,
p_bDoNotCheckQtyWhenDoProductBooking bit,
p_dtmValidStart timestamp,
p_dtmValidEnd timestamp,
p_bShowKit bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szDiscountGroupId BOS_DT_szId,
p_bUsedByAllWorkplace BOS_DT_bBoolean,
p_bPromo BOS_DT_bBoolean,
p_dtmPromoStart timestamp,
p_dtmPromoEnd timestamp,
p_szBarcode BOS_DT_szId,
p_szBarcodeSekunder BOS_DT_szId,
p_szBarcodeTersier BOS_DT_szId,
p_szApplicationClass BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_Product
(
szProductId ,
szName,
szNickName,
bService,
szUomClassId,
szUomId,
bKit,
bExplodeKit  ,
bBreakNonExplodeKit,
szTrackingType,
szCategory_1 ,
szCategory_2 ,
szCategory_3 ,
szCategory_4 ,
szCategory_5,
szCategory_6 ,
szCategory_7 ,
szCategory_8 ,
szCategory_9 ,
szCategory_10,
szQtyFormat,
szOrderItemTypeId,
szArClassId,
szTaxTypeId,
szCompUomId,
szSupplyType,
bDoNotCheckQtyWhenDoProductBooking,
dtmValidStart,
dtmValidEnd,
bShowKit,
dtmLastUpdated,
bAlreadyTransferred,
szDiscountGroupId,
bUsedByAllWorkplace,
bPromo,
dtmPromoStart,
dtmPromoEnd,
szBarcode,
-- add szBarcodeSekunder and szBarcodeTersier --,
 szBarcodeSekunder,
szBarcodeTersier,
szApplicationClass,
)
VALUES
(
p_szProductId ,
p_szName,
p_szNickName,
p_bService,
p_szUomClassId,
p_szUomId,
p_bKit,
p_bExplodeKit  ,
p_bBreakNonExplodeKit,
p_szTrackingType,
p_szCategory_1,
p_szCategory_2 ,
p_szCategory_3 ,
p_szCategory_4,
p_szCategory_5,
p_szCategory_6,
p_szCategory_7 ,
p_szCategory_8 ,
p_szCategory_9,
p_szCategory_10,
p_szQtyFormat,
p_szOrderItemTypeId,
p_szArClassId,
p_szTaxTypeId,
p_szCompUomId,
p_szSupplyType,
p_bDoNotCheckQtyWhenDoProductBooking,
p_dtmValidStart,
p_dtmValidEnd,
p_bShowKit,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szDiscountGroupId,
p_bUsedByAllWorkplace,
p_bPromo,
p_dtmPromoStart,
p_dtmPromoEnd,
p_szBarcode,
-- add szBarcodeSekunder and szBarcodeTersier --,
 p_szBarcodeSekunder,
p_szBarcodeTersier,
p_szApplicationClass,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_CreateProductItemKit(
p_szProductId BOS_DT_szId,
p_szKitItemProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_ProductKitItem
(
szProductId,
szKitItemProductId,
decQty,
szUomId
)
VALUES
(
p_szProductId,
p_szKitItemProductId,
p_decQty,
p_szUomId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_CreateProductPosInfo(
p_szProductId BOS_DT_szId,
p_szMediaType BOS_DT_szSmallId,
p_szMediaTitle varchar,
p_szMachineBrandId BOS_DT_szId,
p_szMachineType varchar,
p_shYear smallint,
p_szMachineSN varchar,
p_szDrawingNumber varchar,
p_szPositionNumber varchar)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_ProductPositionInfo
(
szProductId,
szMediaType,
szMediaTitle,
szMachineBrandId,
szMachineType,
shYear,
szMachineSN,
szDrawingNumber,
szPositionNumber
)
VALUES
(
p_szProductId,
p_szMediaType,
p_szMediaTitle,
p_szMachineBrandId,
p_szMachineType,
p_shYear,
p_szMachineSN,
p_szDrawingNumber,
p_szPositionNumber
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_CreateProductPrice(
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szUomId BOS_DT_szMediumId,
p_bUsePriceWTax bit,
p_decPrice BOS_DT_decPrice,
p_szPriceCcyId BOS_DT_szSmallId,
p_szPromoPriceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_ProductPrice
(
szProductId,
szPriceId,
szUomId,
bUsePriceWTax,
decPrice,
szPriceCcyId,
szPromoPriceId
)
VALUES
(
p_szProductId,
p_szPriceId,
p_szUomId,
p_bUsePriceWTax,
p_decPrice,
p_szPriceCcyId,
p_szPromoPriceId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_CreateProductPrice_013(
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szUomId BOS_DT_szMediumId,
p_bUsePriceWTax bit,
p_decPrice BOS_DT_decPrice,
p_szPriceCcyId BOS_DT_szSmallId,
p_szPromoPriceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_ProductPrice
(
szProductId,
szPriceId,
szUomId,
bUsePriceWTax,
decPrice,
szPriceCcyId,
szPromoPriceId
)
VALUES
(
p_szProductId,
p_szPriceId,
p_szUomId,
p_bUsePriceWTax,
p_decPrice,
p_szPriceCcyId,
p_szPromoPriceId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_CreateProductPurchInfo(
p_szProductId BOS_DT_szId,
p_szUomId BOS_DT_szMediumId,
p_szTaxTypeId BOS_DT_szId,
p_bUsePriceWTax bit,
p_decPurchPrice BOS_DT_decPrice,
p_szPriceCcyId BOS_DT_szId,
p_decLastPurchPrice BOS_DT_decPrice,
p_dtmLastPurchDate timestamp,
p_szLastSupplierId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szDefaultSuppId BOS_DT_szId,
p_decBasePurchPrice_S BOS_DT_decPrice)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_ProductPurchaseInfo
(
szProductId,
szUomId,
szTaxTypeId,
bUsePriceWTax,
decPurchPrice,
szPriceCcyId,
decLastPurchPrice,
dtmLastPurchDate,
szLastSupplierId,
szPriceId,
szPromoPriceId,
szDefaultSuppId,
decBasePurchPrice_S
)
VALUES
(
p_szProductId,
p_szUomId,
p_szTaxTypeId,
p_bUsePriceWTax,
p_decPurchPrice,
p_szPriceCcyId,
p_decLastPurchPrice,
p_dtmLastPurchDate,
p_szLastSupplierId,
p_szPriceId,
p_szPromoPriceId,
p_szDefaultSuppId,
p_decBasePurchPrice_S,
SET ANSI_NULLS ON,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_CreateProductPurchInfo_013(
p_szProductId BOS_DT_szId,
p_szUomId BOS_DT_szMediumId,
p_szTaxTypeId BOS_DT_szId,
p_bUsePriceWTax bit,
p_decPurchPrice BOS_DT_decPrice,
p_szPriceCcyId BOS_DT_szId,
p_decLastPurchPrice BOS_DT_decPrice,
p_dtmLastPurchDate timestamp,
p_szLastSupplierId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szDefaultSuppId BOS_DT_szId,
p_decBasePurchPrice_S BOS_DT_decPrice)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_ProductPurchaseInfo
(
szProductId,
szUomId,
szTaxTypeId,
bUsePriceWTax,
decPurchPrice,
szPriceCcyId,
decLastPurchPrice,
dtmLastPurchDate,
szLastSupplierId,
szPriceId,
szPromoPriceId,
szDefaultSuppId,
decBasePurchPrice_S
)
VALUES
(
p_szProductId,
p_szUomId,
p_szTaxTypeId,
p_bUsePriceWTax,
p_decPurchPrice,
p_szPriceCcyId,
p_decLastPurchPrice,
p_dtmLastPurchDate,
p_szLastSupplierId,
p_szPriceId,
p_szPromoPriceId,
p_szDefaultSuppId,
p_decBasePurchPrice_S,
SET ANSI_NULLS ON,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_CreateProductSerNum(
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_ProductSerNum
(
szProductId ,
szProductSN ,
szDescription
)
VALUES
(
p_szProductId,
p_szProductSN,
p_szDescription
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_CreateProductTechInfo(
p_szProductId BOS_DT_szId,
p_decWeight numeric,
p_szUomWeight varchar,
p_decVolume numeric,
p_szUomVolume varchar,
p_decLength numeric,
p_szUomLength varchar,
p_decWidth numeric,
p_szUomWidth varchar,
p_decHeight numeric,
p_szUomHeight varchar,
p_decStoreTemp numeric,
p_szUomTemp varchar,
p_decStoreHuminity numeric,
p_szUomHuminity varchar,
p_szDescription varchar)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_ProductTechnicalSpecInfo
(
szProductId,
decWeight,
szUomWeight,
decVolume,
szUomVolume,
decLength,
szUomLength,
decWidth,
szUomWidth,
decHeight,
szUomHeight,
decStoreTemp,
szUomTemp,
decStoreHuminity,
szUomHuminity,
szDescription
)
VALUES
(
p_szProductId,
p_decWeight,
p_szUomWeight,
p_decVolume,
p_szUomVolume,
p_decLength,
p_szUomLength,
p_decWidth,
p_szUomWidth,
p_decHeight,
p_szUomHeight,
p_decStoreTemp,
p_szUomTemp,
p_decStoreHuminity,
p_szUomHuminity,
p_szDescription
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_DeleteProduct(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_DeleteProductItemKit(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_INV_ProductKitItem
WHERE
szProductId = p_szProductId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_DeleteProductPosInfo(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_ProductPositionInfo
WHERE
szProductId = p_szProductId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_DeleteProductPrice(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_DeleteProductPurchInfo(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_ProductPurchaseInfo
WHERE
szProductId = p_szProductId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_DeleteProductSerNum(
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_DeleteProductTechInfo(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_INV_ProductTechnicalSpecInfo
WHERE
szProductId = p_szProductId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_GetListOfProduct()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId,

FROM 
BOS_INV_Product

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_GetListOfProductPosInfo()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId

FROM 
BOS_INV_ProductPositionInfo

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_GetListOfProductPrice()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId

FROM 
BOS_INV_ProductPrice

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_GetListOfProductPurchInfo()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId

FROM 
BOS_INV_ProductPurchaseInfo

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_GetListOfProductSerNum()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId, szProductSN, szDescription 

FROM 
BOS_INV_ProductSerNum 

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_GetListOfProductTechInfo()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId

FROM 
BOS_INV_ProductTechnicalSpecInfo

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_GetProduct(
p_szProductId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT 
BOS_INV_Product.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szNickName,
BOS_INV_Product.bService,
BOS_INV_Product.szUomClassId,
BOS_INV_UomClass.szDescription AS szUomClassDescription_J,
BOS_INV_Product.szUomId,

BOS_INV_Product.bKit,
BOS_INV_Product.bExplodeKit,
BOS_INV_Product.bBreakNonExplodeKit,

BOS_INV_Product.szTrackingType,	
BOS_INV_Product.szCategory_1,
BOS_INV_Product.szCategory_2,
BOS_INV_Product.szCategory_3,
BOS_INV_Product.szCategory_4,
BOS_INV_Product.szCategory_5,
BOS_INV_Product.szCategory_6,
BOS_INV_Product.szCategory_7,
BOS_INV_Product.szCategory_8,
BOS_INV_Product.szCategory_9,
BOS_INV_Product.szCategory_10,
TBL_CAT1.szPriceId AS szCategory_1_PriceId_J,
TBL_CAT1.szPromoPriceId AS szCategory_1_PromoPriceId_J,
TBL_CAT2.szPriceId AS szCategory_2_PriceId_J,
TBL_CAT2.szPromoPriceId AS szCategory_2_PromoPriceId_J,
TBL_CAT3.szPriceId AS szCategory_3_PriceId_J,
TBL_CAT3.szPromoPriceId AS szCategory_3_PromoPriceId_J,
TBL_CAT4.szPriceId AS szCategory_4_PriceId_J,
TBL_CAT4.szPromoPriceId AS szCategory_4_PromoPriceId_J,
TBL_CAT5.szPriceId AS szCategory_5_PriceId_J,
TBL_CAT5.szPromoPriceId AS szCategory_5_PromoPriceId_J,
TBL_CAT6.szPriceId AS szCategory_6_PriceId_J,
TBL_CAT6.szPromoPriceId AS szCategory_6_PromoPriceId_J,
TBL_CAT7.szPriceId AS szCategory_7_PriceId_J,
TBL_CAT7.szPromoPriceId AS szCategory_7_PromoPriceId_J,
TBL_CAT8.szPriceId AS szCategory_8_PriceId_J,
TBL_CAT8.szPromoPriceId AS szCategory_8_PromoPriceId_J,
TBL_CAT9.szPriceId AS szCategory_9_PriceId_J,
TBL_CAT9.szPromoPriceId AS szCategory_9_PromoPriceId_J,
TBL_CAT10.szPriceId AS szCategory_10_PriceId_J,
TBL_CAT10.szPromoPriceId AS szCategory_10_PromoPriceId_J,

BOS_INV_Product.szQtyFormat,

BOS_INV_Product.szOrderItemTypeId,
BOS_INV_Product.szArClassId,
BOS_INV_OrderItemType.bTaxable AS bOrderItemTypeTaxable_J,	
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,
BOS_INV_OrderItemType.szRentChargeCalcId AS szOrderItemTypeRentChargeCalcId_J,
BOS_INV_OrderItemType.bMustFillTrnReason AS bOrderItemTypeMustFillTrnReason_J,

BOS_INV_Product.szTaxTypeId,
BOS_GL_TaxType.decRate as decTaxTypeRate_J,

BOS_INV_Product.szCompUomId,
BOS_INV_Product.szSupplyType,
BOS_INV_Product.bDoNotCheckQtyWhenDoProductBooking,

BOS_INV_Product.dtmValidStart,
BOS_INV_Product.dtmValidEnd,

BOS_INV_Product.bShowKit,

PP.szUomId AS szProductPriceUomId_J,

BIPT.decVolume AS decProductVolume_J,
BIPT.szUomVolume AS szProductVolumeUomId_J,
BIPT.decWeight AS decProductWeight_J,
BIPT.szUomWeight AS szProductWeightUomId_J,

BOS_INV_Product.dtmLastUpdated,
BOS_INV_Product.bAlreadyTransferred,

BOS_INV_Product.szDiscountGroupId
, isnull(GWP.szDiscountGroupId, '') AS szWorkplaceDiscountGroupId_J

, BOS_INV_Product.bUsedByAllWorkplace,

BOS_INV_Product.bPromo,
BOS_INV_Product.dtmPromoStart,
BOS_INV_Product.dtmPromoEnd,
BOS_INV_Product.szBarcode

-- add szBarcodeSekunder and szBarcodeTersier --
, BOS_INV_Product.szBarcodeSekunder,
BOS_INV_Product.szBarcodeTersier,
BOS_INV_Product.szApplicationClass

FROM
BOS_INV_Product
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_INV_Product.szOrderItemTypeId
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT1 ON TBL_CAT1.szProductCategoryId = BOS_INV_Product.szCategory_1
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT2 ON TBL_CAT2.szProductCategoryId = BOS_INV_Product.szCategory_2
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT3 ON TBL_CAT3.szProductCategoryId = BOS_INV_Product.szCategory_3
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT4 ON TBL_CAT4.szProductCategoryId = BOS_INV_Product.szCategory_4
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT5 ON TBL_CAT5.szProductCategoryId = BOS_INV_Product.szCategory_5
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT6 ON TBL_CAT5.szProductCategoryId = BOS_INV_Product.szCategory_6
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT7 ON TBL_CAT5.szProductCategoryId = BOS_INV_Product.szCategory_7
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT8 ON TBL_CAT5.szProductCategoryId = BOS_INV_Product.szCategory_8
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT9 ON TBL_CAT5.szProductCategoryId = BOS_INV_Product.szCategory_9
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT10 ON TBL_CAT5.szProductCategoryId = BOS_INV_Product.szCategory_10
LEFT JOIN BOS_INV_ProductTechnicalSpecInfo AS BIPT ON BIPT.szProductId = BOS_INV_Product.szProductId
LEFT JOIN BOS_INV_ProductPrice AS PP ON PP.szProductId = BOS_INV_Product.szProductId
LEFT JOIN BOS_INV_UomClass ON BOS_INV_UomClass.szUomClassId = BOS_INV_Product.szUomClassId
LEFT JOIN BOS_GL_WorkplaceProduct AS GWP ON GWP.szWorkplaceId = p_szWorkplaceId
AND GWP.szProductId = BOS_INV_Product.szProductId

WHERE
BOS_INV_Product.szProductId  = p_szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_GetProduct_013(
p_szProductId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT   
BOS_INV_Product.szProductId,  
BOS_INV_Product.szName,  
BOS_INV_Product.szNickName,  
BOS_INV_Product.bService,  
BOS_INV_Product.szUomClassId,  
BOS_INV_UomClass.szDescription AS szUomClassDescription_J,  
BOS_INV_Product.szUomId,  

BOS_INV_Product.bKit,  
BOS_INV_Product.bExplodeKit,  
BOS_INV_Product.bBreakNonExplodeKit,  

BOS_INV_Product.szTrackingType,   
BOS_INV_Product.szCategory_1,  
BOS_INV_Product.szCategory_2,  
BOS_INV_Product.szCategory_3,  
BOS_INV_Product.szCategory_4,  
BOS_INV_Product.szCategory_5,  
BOS_INV_Product.szCategory_6,  
BOS_INV_Product.szCategory_7,  
BOS_INV_Product.szCategory_8,  
BOS_INV_Product.szCategory_9,  
BOS_INV_Product.szCategory_10,  
TBL_CAT1.szPriceId AS szCategory_1_PriceId_J,  
TBL_CAT1.szPromoPriceId AS szCategory_1_PromoPriceId_J,  
TBL_CAT2.szPriceId AS szCategory_2_PriceId_J,  
TBL_CAT2.szPromoPriceId AS szCategory_2_PromoPriceId_J,  
TBL_CAT3.szPriceId AS szCategory_3_PriceId_J,  
TBL_CAT3.szPromoPriceId AS szCategory_3_PromoPriceId_J,  
TBL_CAT4.szPriceId AS szCategory_4_PriceId_J,  
TBL_CAT4.szPromoPriceId AS szCategory_4_PromoPriceId_J,  
TBL_CAT5.szPriceId AS szCategory_5_PriceId_J,  
TBL_CAT5.szPromoPriceId AS szCategory_5_PromoPriceId_J,  
TBL_CAT6.szPriceId AS szCategory_6_PriceId_J,  
TBL_CAT6.szPromoPriceId AS szCategory_6_PromoPriceId_J,  
TBL_CAT7.szPriceId AS szCategory_7_PriceId_J,  
TBL_CAT7.szPromoPriceId AS szCategory_7_PromoPriceId_J,  
TBL_CAT8.szPriceId AS szCategory_8_PriceId_J,  
TBL_CAT8.szPromoPriceId AS szCategory_8_PromoPriceId_J,  
TBL_CAT9.szPriceId AS szCategory_9_PriceId_J,  
TBL_CAT9.szPromoPriceId AS szCategory_9_PromoPriceId_J,  
TBL_CAT10.szPriceId AS szCategory_10_PriceId_J,  
TBL_CAT10.szPromoPriceId AS szCategory_10_PromoPriceId_J,  

BOS_INV_Product.szQtyFormat,  

BOS_INV_Product.szOrderItemTypeId,  
BOS_INV_Product.szArClassId,  
BOS_INV_OrderItemType.bTaxable AS bOrderItemTypeTaxable_J,   
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,  
BOS_INV_OrderItemType.szRentChargeCalcId AS szOrderItemTypeRentChargeCalcId_J,  
BOS_INV_OrderItemType.bMustFillTrnReason AS bOrderItemTypeMustFillTrnReason_J,  

BOS_INV_Product.szTaxTypeId,  
BOS_GL_TaxType.decRate as decTaxTypeRate_J,  

BOS_INV_Product.szCompUomId,  
BOS_INV_Product.szSupplyType,  
BOS_INV_Product.bDoNotCheckQtyWhenDoProductBooking,  

BOS_INV_Product.dtmValidStart,  
BOS_INV_Product.dtmValidEnd,  

BOS_INV_Product.bShowKit,  

PP.szUomId AS szProductPriceUomId_J,  

BIPT.decVolume AS decProductVolume_J,  
BIPT.szUomVolume AS szProductVolumeUomId_J,  
BIPT.decWeight AS decProductWeight_J,  
BIPT.szUomWeight AS szProductWeightUomId_J,  

BOS_INV_Product.dtmLastUpdated,  
BOS_INV_Product.bAlreadyTransferred,  

BOS_INV_Product.szDiscountGroupId  
, isnull(GWP.szDiscountGroupId, '') AS szWorkplaceDiscountGroupId_J  

, BOS_INV_Product.bUsedByAllWorkplace,  

BOS_INV_Product.bPromo,  
BOS_INV_Product.dtmPromoStart,  
BOS_INV_Product.dtmPromoEnd,  
BOS_INV_Product.szBarcode  

-- add szBarcodeSekunder and szBarcodeTersier --  
, BOS_INV_Product.szBarcodeSekunder,  
BOS_INV_Product.szBarcodeTersier,  
BOS_INV_Product.szApplicationClass  

FROM  
BOS_INV_Product  
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId  
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_INV_Product.szOrderItemTypeId  
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT1 ON TBL_CAT1.szProductCategoryId = BOS_INV_Product.szCategory_1  
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT2 ON TBL_CAT2.szProductCategoryId = BOS_INV_Product.szCategory_2  
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT3 ON TBL_CAT3.szProductCategoryId = BOS_INV_Product.szCategory_3  
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT4 ON TBL_CAT4.szProductCategoryId = BOS_INV_Product.szCategory_4  
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT5 ON TBL_CAT5.szProductCategoryId = BOS_INV_Product.szCategory_5  
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT6 ON TBL_CAT5.szProductCategoryId = BOS_INV_Product.szCategory_6  
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT7 ON TBL_CAT5.szProductCategoryId = BOS_INV_Product.szCategory_7  
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT8 ON TBL_CAT5.szProductCategoryId = BOS_INV_Product.szCategory_8  
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT9 ON TBL_CAT5.szProductCategoryId = BOS_INV_Product.szCategory_9  
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT10 ON TBL_CAT5.szProductCategoryId = BOS_INV_Product.szCategory_10  
LEFT JOIN BOS_INV_ProductTechnicalSpecInfo AS BIPT ON BIPT.szProductId = BOS_INV_Product.szProductId  
LEFT JOIN BOS_INV_ProductPrice AS PP ON PP.szProductId = BOS_INV_Product.szProductId  
LEFT JOIN BOS_INV_UomClass ON BOS_INV_UomClass.szUomClassId = BOS_INV_Product.szUomClassId  
LEFT JOIN BOS_GL_WorkplaceProduct AS GWP ON GWP.szWorkplaceId = p_szWorkplaceId  
AND GWP.szProductId = BOS_INV_Product.szProductId  

WHERE  
BOS_INV_Product.szProductId  = p_szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_GetProductItemKit(
p_szProductId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_ProductKitItem.szKitItemProductId,

BOS_INV_Product.szName as szProductNm,
BOS_INV_ProductKitItem.decQty,
BOS_INV_ProductKitItem.szUomId,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
BOS_GL_TaxType.decRate AS decProductTaxTypeTaxRate_J,
BOS_INV_Product.szOrderItemTypeId AS szProductOrderItemTypeId_J,

BOS_INV_Product.szDiscountGroupId AS szProductDiscGroupId_J
, isnull(GWP.szDiscountGroupId, '') AS szWorkplaceDiscGroupId_J

, BOS_INV_OrderItemType.bTaxable AS bProductOrderItemTypeTaxable_J,
BOS_INV_OrderItemType.szTrnType AS szProductOrderItemTypeTrnType_J,
BOS_INV_OrderItemType.szRentChargeCalcId AS szProductOrderItemTypeRentChargeCalcId_J,
BOS_INV_OrderItemType.bMustFillTrnReason AS bProductOrderItemTypeMustFillTrnReason_J,

BIPT.decVolume AS decProductVolume_J,
BIPT.szUomVolume AS szProductVolumeUomId_J,
BIPT.decWeight AS decProductWeight_J,
BIPT.szUomWeight AS szProductWeightUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J
FROM
BOS_INV_ProductKitItem
LEFT JOIN BOS_INV_Product on BOS_INV_Product.szProductId = BOS_INV_ProductKitItem.szKitItemProductId
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_INV_Product.szOrderItemTypeId
LEFT JOIN BOS_INV_ProductTechnicalSpecInfo AS BIPT ON BIPT.szProductId = BOS_INV_ProductKitItem.szKitItemProductId
LEFT JOIN BOS_GL_WorkplaceProduct AS GWP ON GWP.szWorkplaceId = p_szWorkplaceId
AND GWP.szProductId = BOS_INV_ProductKitItem.szProductId
WHERE	
BOS_INV_ProductKitItem.szProductId = p_szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_GetProductItemKit_014(
p_szProductId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_ProductKitItem.szKitItemProductId,

BOS_INV_Product.szName as szProductNm,
BOS_INV_ProductKitItem.decQty,
BOS_INV_ProductKitItem.szUomId,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
BOS_GL_TaxType.decRate AS decProductTaxTypeTaxRate_J,
BOS_INV_Product.szOrderItemTypeId AS szProductOrderItemTypeId_J,

BOS_INV_Product.szDiscountGroupId AS szProductDiscGroupId_J
, isnull(GWP.szDiscountGroupId, '') AS szWorkplaceDiscGroupId_J

, BOS_INV_OrderItemType.bTaxable AS bProductOrderItemTypeTaxable_J,
BOS_INV_OrderItemType.szTrnType AS szProductOrderItemTypeTrnType_J,
BOS_INV_OrderItemType.szRentChargeCalcId AS szProductOrderItemTypeRentChargeCalcId_J,
BOS_INV_OrderItemType.bMustFillTrnReason AS bProductOrderItemTypeMustFillTrnReason_J,

BIPT.decVolume AS decProductVolume_J,
BIPT.szUomVolume AS szProductVolumeUomId_J,
BIPT.decWeight AS decProductWeight_J,
BIPT.szUomWeight AS szProductWeightUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J
FROM
BOS_INV_ProductKitItem
LEFT JOIN BOS_INV_Product on BOS_INV_Product.szProductId = BOS_INV_ProductKitItem.szKitItemProductId
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_INV_Product.szOrderItemTypeId
LEFT JOIN BOS_INV_ProductTechnicalSpecInfo AS BIPT ON BIPT.szProductId = BOS_INV_ProductKitItem.szKitItemProductId
LEFT JOIN BOS_GL_WorkplaceProduct AS GWP ON GWP.szWorkplaceId = p_szWorkplaceId
AND GWP.szProductId = BOS_INV_ProductKitItem.szProductId
WHERE    
BOS_INV_ProductKitItem.szProductId = p_szProductId


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_GetProductName(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szName,

FROM 
BOS_INV_Product
WHERE 
 szProductId  = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_GetProductPosInfo(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId,

FROM 
BOS_INV_ProductPositionInfo
WHERE 
 szProductId  = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_GetProductPrice(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
select
BOS_INV_ProductPrice.szProductId,

BOS_INV_Product.szUomClassId AS szProductUomClassId_J,

BOS_INV_ProductPrice.szPriceId,
BOS_INV_ProductPrice.szUomId,
BOS_INV_ProductPrice.bUsePriceWTax,
BOS_INV_ProductPrice.decPrice,
BOS_INV_ProductPrice.szPriceCcyId,
BOS_CU_Currency.szAmountFormat AS szPriceFormat_J,
BOS_INV_ProductPrice.szPromoPriceId,

TBL_CAT1.szPriceId AS szCategory_1_PriceId_J,
TBL_CAT1.szPromoPriceId AS szCategory_1_PromoPriceId_J,
TBL_CAT2.szPriceId AS szCategory_2_PriceId_J,
TBL_CAT2.szPromoPriceId AS szCategory_2_PromoPriceId_J,
TBL_CAT3.szPriceId AS szCategory_3_PriceId_J,
TBL_CAT3.szPromoPriceId AS szCategory_3_PromoPriceId_J,
TBL_CAT4.szPriceId AS szCategory_4_PriceId_J,
TBL_CAT4.szPromoPriceId AS szCategory_4_PromoPriceId_J,
TBL_CAT5.szPriceId AS szCategory_5_PriceId_J,
TBL_CAT5.szPromoPriceId AS szCategory_5_PromoPriceId_J,
TBL_CAT6.szPriceId AS szCategory_6_PriceId_J,
TBL_CAT6.szPromoPriceId AS szCategory_6_PromoPriceId_J,
TBL_CAT7.szPriceId AS szCategory_7_PriceId_J,
TBL_CAT7.szPromoPriceId AS szCategory_7_PromoPriceId_J,
TBL_CAT8.szPriceId AS szCategory_8_PriceId_J,
TBL_CAT8.szPromoPriceId AS szCategory_8_PromoPriceId_J,
TBL_CAT9.szPriceId AS szCategory_9_PriceId_J,
TBL_CAT9.szPromoPriceId AS szCategory_9_PromoPriceId_J,
TBL_CAT10.szPriceId AS szCategory_10_PriceId_J,
TBL_CAT10.szPromoPriceId AS szCategory_10_PromoPriceId_J


from
BOS_INV_ProductPrice
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = szPriceCcyId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_ProductPrice.szProductId
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT1 ON TBL_CAT1.szProductCategoryId = BOS_INV_Product.szCategory_1
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT2 ON TBL_CAT2.szProductCategoryId = BOS_INV_Product.szCategory_2
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT3 ON TBL_CAT3.szProductCategoryId = BOS_INV_Product.szCategory_3
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT4 ON TBL_CAT4.szProductCategoryId = BOS_INV_Product.szCategory_4
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT5 ON TBL_CAT5.szProductCategoryId = BOS_INV_Product.szCategory_5
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT6 ON TBL_CAT6.szProductCategoryId = BOS_INV_Product.szCategory_6
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT7 ON TBL_CAT7.szProductCategoryId = BOS_INV_Product.szCategory_7
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT8 ON TBL_CAT8.szProductCategoryId = BOS_INV_Product.szCategory_8
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT9 ON TBL_CAT9.szProductCategoryId = BOS_INV_Product.szCategory_9
LEFT JOIN BOS_INV_ProductCategory AS TBL_CAT10 ON TBL_CAT10.szProductCategoryId = BOS_INV_Product.szCategory_10

where
BOS_INV_ProductPrice.szProductId = p_szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_GetProductPurchInfo(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
BOS_INV_ProductPurchaseInfo.szProductId,
BOS_INV_ProductPurchaseInfo.szUomId,
BOS_INV_ProductPurchaseInfo.szTaxTypeId,
BOS_INV_ProductPurchaseInfo.bUsePriceWTax,
BOS_INV_ProductPurchaseInfo.decPurchPrice,
BOS_INV_ProductPurchaseInfo.szPriceCcyId,
BOS_INV_ProductPurchaseInfo.decLastPurchPrice,
BOS_INV_ProductPurchaseInfo.dtmLastPurchDate,
BOS_INV_ProductPurchaseInfo.szLastSupplierId,
BOS_AP_Supplier.szName AS szLastSupplierNm,
BOS_INV_ProductPurchaseInfo.szPriceId,
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat,
BOS_INV_ProductPurchaseInfo.szPromoPriceId,
BOS_INV_ProductPurchaseInfo.szDefaultSuppId,
IsNull(DefSupp.szName, '') as szDefaultSuppNm_J,
decBasePurchPrice_S

FROM BOS_INV_ProductPurchaseInfo
LEFT JOIN BOS_AP_Supplier ON BOS_AP_Supplier.szSuppId = BOS_INV_ProductPurchaseInfo.szLastSupplierId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_INV_ProductPurchaseInfo.szPriceCcyId
LEFT JOIN BOS_AP_Supplier DefSupp ON DefSupp.szSuppId = BOS_INV_ProductPurchaseInfo.szDefaultSuppId
WHERE szProductId  = p_szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_GetProductPurchInfo_013(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
BOS_INV_ProductPurchaseInfo.szProductId,  
BOS_INV_ProductPurchaseInfo.szUomId,  
BOS_INV_ProductPurchaseInfo.szTaxTypeId,  
BOS_INV_ProductPurchaseInfo.bUsePriceWTax,  
BOS_INV_ProductPurchaseInfo.decPurchPrice,  
BOS_INV_ProductPurchaseInfo.szPriceCcyId,  
BOS_INV_ProductPurchaseInfo.decLastPurchPrice,  
BOS_INV_ProductPurchaseInfo.dtmLastPurchDate,  
BOS_INV_ProductPurchaseInfo.szLastSupplierId,  
BOS_AP_Supplier.szName AS szLastSupplierNm,  
BOS_INV_ProductPurchaseInfo.szPriceId,  
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat,  
BOS_INV_ProductPurchaseInfo.szPromoPriceId,  
BOS_INV_ProductPurchaseInfo.szDefaultSuppId,  
IsNull(DefSupp.szName, '') as szDefaultSuppNm_J,  
decBasePurchPrice_S  

FROM BOS_INV_ProductPurchaseInfo  
LEFT JOIN BOS_AP_Supplier ON BOS_AP_Supplier.szSuppId = BOS_INV_ProductPurchaseInfo.szLastSupplierId  
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_INV_ProductPurchaseInfo.szPriceCcyId  
LEFT JOIN BOS_AP_Supplier DefSupp ON DefSupp.szSuppId = BOS_INV_ProductPurchaseInfo.szDefaultSuppId  
WHERE szProductId  = p_szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_GetProductSerNum(
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription 

FROM 
BOS_INV_ProductSerNum 
WHERE 
szProductId = p_szProductId and szProductSN = p_szProductSN ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_GetProductTechInfo(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId,

FROM 
BOS_INV_ProductTechnicalSpecInfo
WHERE 
 szProductId  = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_IsProductExist(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szName

FROM 
BOS_INV_Product
WHERE 
szProductId  = p_szProductId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_IsProductPosInfoExist(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId

FROM 
BOS_INV_ProductPositionInfo
WHERE 
szProductId  = p_szProductId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_IsProductPriceExist(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId

FROM 
BOS_INV_ProductPrice
WHERE 
szProductId  = p_szProductId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_IsProductPurchInfoExist(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId

FROM 
BOS_INV_ProductPurchaseInfo
WHERE 
szProductId  = p_szProductId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_IsProductSerNumExist(
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription 

FROM 
BOS_INV_ProductSerNum 
WHERE 
szProductId = p_szProductId and szProductSN = p_szProductSN ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_IsProductTechInfoExist(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId

FROM 
BOS_INV_ProductTechnicalSpecInfo
WHERE 
szProductId  = p_szProductId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_LockProduct(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Product
SET 
bKit = bKit
WHERE 
szProductId = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_LockProductPosInfo(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductPositionInfo
SET 
szMediaType = szMediaType
WHERE 
szProductId = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_LockProductPrice(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductPrice
SET 
bUsePriceWTax = bUsePriceWTax
WHERE 
szProductId = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_LockProductPurchInfo(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductPurchaseInfo
SET 
bUsePriceWTax  = bUsePriceWTax
WHERE 
szProductId = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_LockProductSerNum(
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductSerNum
SET 
szDescription = szDescription
WHERE 
szProductId = p_szProductId and;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_LockProductTechInfo(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductTechnicalSpecInfo
SET 
decWeight = decWeight
WHERE 
szProductId = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_UpdateProduct(
p_szProductId BOS_DT_szId,
p_szName varchar,
p_szNickName BOS_DT_szName,
p_bService bit,
p_szUomClassId BOS_DT_szMediumId,
p_szUomId BOS_DT_szMediumId,
p_bKit bit,
p_bExplodeKit bit,
p_bBreakNonExplodeKit BOS_DT_bBoolean,
p_szTrackingType BOS_DT_szSmallId,
p_szCategory_1 BOS_DT_szId,
p_szCategory_2 BOS_DT_szId,
p_szCategory_3 BOS_DT_szId,
p_szCategory_4 BOS_DT_szId,
p_szCategory_5 BOS_DT_szId,
p_szCategory_6 BOS_DT_szId,
p_szCategory_7 BOS_DT_szId,
p_szCategory_8 BOS_DT_szId,
p_szCategory_9 BOS_DT_szId,
p_szCategory_10 BOS_DT_szId,
p_szQtyFormat varchar,
p_szOrderItemTypeId BOS_DT_szId,
p_szArClassId BOS_DT_szId,
p_szTaxTypeId BOS_DT_szId,
p_szCompUomId BOS_DT_szId,
p_szSupplyType BOS_DT_szSmallId,
p_bDoNotCheckQtyWhenDoProductBooking bit,
p_dtmValidStart timestamp,
p_dtmValidEnd timestamp,
p_bShowKit bit,
p_szDiscountGroupId BOS_DT_szId,
p_bUsedByAllWorkplace BOS_DT_bBoolean,
p_bPromo BOS_DT_bBoolean,
p_dtmPromoStart timestamp,
p_dtmPromoEnd timestamp,
p_szBarcode BOS_DT_szId,
p_szBarcodeSekunder BOS_DT_szId,
p_szBarcodeTersier BOS_DT_szId,
p_szApplicationClass BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Product
SET 
szName = p_szName,
szNickName = p_szNickName,
bService = p_bService,
szUomClassId = p_szUomClassId,
szUomId = p_szUomId,

bKit = p_bKit,
bExplodeKit = p_bExplodeKit,
bBreakNonExplodeKit = p_bBreakNonExplodeKit,

szTrackingType = p_szTrackingType,
szCategory_1  = p_szCategory_1,
szCategory_2  = p_szCategory_2,
szCategory_3  = p_szCategory_3,
szCategory_4  = p_szCategory_4,
szCategory_5  = p_szCategory_5,
szCategory_6  = p_szCategory_6,
szCategory_7  = p_szCategory_7,
szCategory_8  = p_szCategory_8,
szCategory_9  = p_szCategory_9,
szCategory_10  = p_szCategory_10,

szQtyFormat = p_szQtyFormat,
szOrderItemTypeId = p_szOrderItemTypeId,
szArClassId = p_szArClassId,
szTaxTypeId = p_szTaxTypeId,

szCompUomId = p_szCompUomId,
szSupplyType=p_szSupplyType,
bDoNotCheckQtyWhenDoProductBooking = p_bDoNotCheckQtyWhenDoProductBooking,

dtmValidStart = p_dtmValidStart,
dtmValidEnd = p_dtmValidEnd,

bShowKit=p_bShowKit,

szDiscountGroupId = p_szDiscountGroupId,
bUsedByAllWorkplace = p_bUsedByAllWorkplace,
bPromo=p_bPromo,
dtmPromoStart=p_dtmPromoStart,
dtmPromoEnd=p_dtmPromoEnd,
szBarcode=p_szBarcode

-- add szBarcodeSekunder and szBarcodeTersier
, szBarcodeSekunder = p_szBarcodeSekunder,
szBarcodeTersier = p_szBarcodeTersier,
szApplicationClass = p_szApplicationClass


WHERE 
szProductId = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_UpdateProduct_013(
p_szProductId BOS_DT_szId,
p_szName varchar,
p_szNickName BOS_DT_szName,
p_bService bit,
p_szUomClassId BOS_DT_szMediumId,
p_szUomId BOS_DT_szMediumId,
p_bKit bit,
p_bExplodeKit bit,
p_bBreakNonExplodeKit BOS_DT_bBoolean,
p_szTrackingType BOS_DT_szSmallId,
p_szCategory_1 BOS_DT_szId,
p_szCategory_2 BOS_DT_szId,
p_szCategory_3 BOS_DT_szId,
p_szCategory_4 BOS_DT_szId,
p_szCategory_5 BOS_DT_szId,
p_szCategory_6 BOS_DT_szId,
p_szCategory_7 BOS_DT_szId,
p_szCategory_8 BOS_DT_szId,
p_szCategory_9 BOS_DT_szId,
p_szCategory_10 BOS_DT_szId,
p_szQtyFormat varchar,
p_szOrderItemTypeId BOS_DT_szId,
p_szArClassId BOS_DT_szId,
p_szTaxTypeId BOS_DT_szId,
p_szCompUomId BOS_DT_szId,
p_szSupplyType BOS_DT_szSmallId,
p_bDoNotCheckQtyWhenDoProductBooking bit,
p_dtmValidStart timestamp,
p_dtmValidEnd timestamp,
p_bShowKit bit,
p_szDiscountGroupId BOS_DT_szId,
p_bUsedByAllWorkplace BOS_DT_bBoolean,
p_bPromo BOS_DT_bBoolean,
p_dtmPromoStart timestamp,
p_dtmPromoEnd timestamp,
p_szBarcode BOS_DT_szId,
p_szBarcodeSekunder BOS_DT_szId,
p_szBarcodeTersier BOS_DT_szId,
p_szApplicationClass BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Product
SET 
szName = p_szName,
szNickName = p_szNickName,
bService = p_bService,
szUomClassId = p_szUomClassId,
szUomId = p_szUomId,

bKit = p_bKit,
bExplodeKit = p_bExplodeKit,
bBreakNonExplodeKit = p_bBreakNonExplodeKit,

szTrackingType = p_szTrackingType,
szCategory_1  = p_szCategory_1,
szCategory_2  = p_szCategory_2,
szCategory_3  = p_szCategory_3,
szCategory_4  = p_szCategory_4,
szCategory_5  = p_szCategory_5,
szCategory_6  = p_szCategory_6,
szCategory_7  = p_szCategory_7,
szCategory_8  = p_szCategory_8,
szCategory_9  = p_szCategory_9,
szCategory_10  = p_szCategory_10,

szQtyFormat = p_szQtyFormat,
szOrderItemTypeId = p_szOrderItemTypeId,
szArClassId = p_szArClassId,
szTaxTypeId = p_szTaxTypeId,

szCompUomId = p_szCompUomId,
szSupplyType=p_szSupplyType,
bDoNotCheckQtyWhenDoProductBooking = p_bDoNotCheckQtyWhenDoProductBooking,

dtmValidStart = p_dtmValidStart,
dtmValidEnd = p_dtmValidEnd,

bShowKit=p_bShowKit,

szDiscountGroupId = p_szDiscountGroupId,
bUsedByAllWorkplace = p_bUsedByAllWorkplace,
bPromo=p_bPromo,
dtmPromoStart=p_dtmPromoStart,
dtmPromoEnd=p_dtmPromoEnd,
szBarcode=p_szBarcode

-- add szBarcodeSekunder and szBarcodeTersier
, szBarcodeSekunder = p_szBarcodeSekunder,
szBarcodeTersier = p_szBarcodeTersier,
szApplicationClass = p_szApplicationClass


WHERE 
szProductId = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_UpdateProductPosInfo(
p_szProductId BOS_DT_szId,
p_szMediaType BOS_DT_szSmallId,
p_szMediaTitle varchar,
p_szMachineBrandId BOS_DT_szId,
p_szMachineType varchar,
p_shYear smallint,
p_szMachineSN varchar,
p_szDrawingNumber varchar,
p_szPositionNumber varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductPositionInfo
SET 
szMediaType=p_szMediaType,
szMediaTitle=p_szMediaTitle,
szMachineBrandId=p_szMachineBrandId,
szMachineType=p_szMachineType,
shYear=p_shYear,
szMachineSN=p_szMachineSN,
szDrawingNumber=p_szDrawingNumber,
szPositionNumber=p_szPositionNumber
WHERE 
szProductId = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_UpdateProductPrice(
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szUomId BOS_DT_szMediumId,
p_bUsePriceWTax bit,
p_decPrice BOS_DT_decPrice,
p_szPriceCcyId BOS_DT_szSmallId,
p_szPromoPriceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductPrice
SET 
szPriceId=p_szPriceId,
szUomId=p_szUomId,
bUsePriceWTax=p_bUsePriceWTax,
decPrice=p_decPrice,
szPriceCcyId=p_szPriceCcyId,
szPromoPriceId=p_szPromoPriceId
WHERE 
szProductId = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_UpdateProductPrice_013(
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szUomId BOS_DT_szMediumId,
p_bUsePriceWTax bit,
p_decPrice BOS_DT_decPrice,
p_szPriceCcyId BOS_DT_szSmallId,
p_szPromoPriceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductPrice
SET 
szPriceId=p_szPriceId,
szUomId=p_szUomId,
bUsePriceWTax=p_bUsePriceWTax,
decPrice=p_decPrice,
szPriceCcyId=p_szPriceCcyId,
szPromoPriceId=p_szPromoPriceId
WHERE 
szProductId = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_UpdateProductPurchInfo(
p_szProductId BOS_DT_szId,
p_szUomId BOS_DT_szMediumId,
p_szTaxTypeId BOS_DT_szId,
p_bUsePriceWTax bit,
p_decPurchPrice BOS_DT_decPrice,
p_szPriceCcyId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szDefaultSuppId BOS_DT_szId,
p_decBasePurchPrice_S BOS_DT_decPrice)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductPurchaseInfo
SET 
szProductId = p_szProductId,
szUomId = p_szUomId,
szTaxTypeId = p_szTaxTypeId,
bUsePriceWTax = p_bUsePriceWTax,
decPurchPrice = p_decPurchPrice,
szPriceCcyId = p_szPriceCcyId,
szPriceId = p_szPriceId,
szPromoPriceId = p_szPromoPriceId,
szDefaultSuppId = p_szDefaultSuppId,
decBasePurchPrice_S = p_decBasePurchPrice_S
WHERE 
szProductId = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_UpdateProductPurchInfo_013(
p_szProductId BOS_DT_szId,
p_szUomId BOS_DT_szMediumId,
p_szTaxTypeId BOS_DT_szId,
p_bUsePriceWTax bit,
p_decPurchPrice BOS_DT_decPrice,
p_szPriceCcyId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szDefaultSuppId BOS_DT_szId,
p_decBasePurchPrice_S BOS_DT_decPrice)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductPurchaseInfo
SET 
szProductId = p_szProductId,
szUomId = p_szUomId,
szTaxTypeId = p_szTaxTypeId,
bUsePriceWTax = p_bUsePriceWTax,
decPurchPrice = p_decPurchPrice,
szPriceCcyId = p_szPriceCcyId,
szPriceId = p_szPriceId,
szPromoPriceId = p_szPromoPriceId,
szDefaultSuppId = p_szDefaultSuppId,
decBasePurchPrice_S = p_decBasePurchPrice_S
WHERE 
szProductId = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_UpdateProductSerNum(
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductSerNum
SET 
szDescription = p_szDescription
WHERE 
szProductId = p_szProductId and;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Product_UpdateProductTechInfo(
p_szProductId BOS_DT_szId,
p_decWeight numeric,
p_szUomWeight varchar,
p_decVolume numeric,
p_szUomVolume varchar,
p_decLength numeric,
p_szUomLength varchar,
p_decWidth numeric,
p_szUomWidth varchar,
p_decHeight numeric,
p_szUomHeight varchar,
p_decStoreTemp numeric,
p_szUomTemp varchar,
p_decStoreHuminity numeric,
p_szUomHuminity varchar,
p_szDescription varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductTechnicalSpecInfo
SET 
decWeight=p_decWeight,
szUomWeight=p_szUomWeight,
decVolume=p_decVolume,
szUomVolume=p_szUomVolume,
decLength=p_decLength,
szUomLength=p_szUomLength,
decWidth=p_decWidth,
szUomWidth=p_szUomWidth,
decHeight=p_decHeight,
szUomHeight=p_szUomHeight,
decStoreTemp=p_decStoreTemp,
szUomTemp=p_szUomTemp,
decStoreHuminity=p_decStoreHuminity,
szUomHuminity=p_szUomHuminity,
szDescription=p_szDescription
WHERE 
szProductId = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategory_CreateProductCategory(
p_szProductCategoryId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szCategoryType BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_ProductCategory
(
szProductCategoryId,
szDescription,
szPriceId,
szPromoPriceId,
szCategoryType,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szProductCategoryId,
p_szDescription,
p_szPriceId,
p_szPromoPriceId,
p_szCategoryType,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategory_CreateProductCategory_013(
p_szProductCategoryId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szCategoryType BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_ProductCategory
(
szProductCategoryId,
szDescription,
szPriceId,
szPromoPriceId,
szCategoryType,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szProductCategoryId,
p_szDescription,
p_szPriceId,
p_szPromoPriceId,
p_szCategoryType,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategory_DeleteProductCategory(
p_szProductCategoryId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_INV_ProductCategory
WHERE
szProductCategoryId = p_szProductCategoryId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategory_DeleteProductCategoryWithType(
p_szProductCategoryId BOS_DT_szId,
p_szCategoryType BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_INV_ProductCategory
WHERE
szProductCategoryId = p_szProductCategoryIdAND szCategoryType = p_szCategoryType;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategory_GetListOfProductCategory()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductCategoryId,
szDescription

FROM 
BOS_INV_ProductCategory
order by
szProductCategoryId
ORDER BY 
szProductCategoryId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategory_GetProductCategory(
p_szProductCategoryId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
A.szProductCategoryId,
A.szDescription,
A.szPriceId,
A.szPromoPriceId,
A.szCategoryType,
B.szDescription as szCategoryTypeDesc_J

FROM 
BOS_INV_ProductCategory A
WHERE 
A.szProductCategoryId = p_szProductCategoryId SET ANSI_NULLS ON ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategory_GetProductCategory_013(
p_szProductCategoryId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
A.szProductCategoryId,
A.szDescription,
A.szPriceId,
A.szPromoPriceId,
A.szCategoryType,
B.szDescription as szCategoryTypeDesc_J

FROM 
BOS_INV_ProductCategory A
WHERE 
A.szProductCategoryId = p_szProductCategoryId SET ANSI_NULLS ON ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategory_GetProductCategoryWithType(
p_szProductCategoryId BOS_DT_szId,
p_szCategoryType BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
CAT.szProductCategoryId,
CAT.szDescription,
CAT.szPriceId,
CAT.szPromoPriceId,
CAT.szCategoryType,
TYP.szDescription AS szCategoryTypeDesc_J,
CAT.dtmLastUpdated,
CAT.bAlreadyTransferred


FROM 
BOS_INV_ProductCategory CAT
WHERE 
CAT.szProductCategoryId = p_szProductCategoryId AND CAT.szCategoryType = p_szCategoryType ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategory_IsProductCategoryExist(
p_szProductCategoryId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductCategoryId

FROM 
BOS_INV_ProductCategory
WHERE 
szProductCategoryId = p_szProductCategoryId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategory_IsProductCategoryExistWithType(
p_szProductCategoryId BOS_DT_szId,
p_szCategoryType BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductCategoryId

FROM 
BOS_INV_ProductCategory
WHERE 
szProductCategoryId = p_szProductCategoryId and szCategoryType = p_szCategoryType ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategory_LockProductCategory(
p_szProductCategoryId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductCategory
SET 
szDescription = szDescription
WHERE 
szProductCategoryId = p_szProductCategoryId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategory_UpdateProductCategory(
p_szProductCategoryId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szCategoryType BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductCategory
SET 
szDescription = p_szDescription,
szPriceId = p_szPriceId,
szPromoPriceId = p_szPromoPriceId,
szCategoryType = p_szCategoryType
WHERE 
szProductCategoryId = p_szProductCategoryId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategory_UpdateProductCategory_013(
p_szProductCategoryId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szCategoryType BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductCategory
SET 
szDescription = p_szDescription,
szPriceId = p_szPriceId,
szPromoPriceId = p_szPromoPriceId,
szCategoryType = p_szCategoryType
WHERE 
szProductCategoryId = p_szProductCategoryId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategory_UpdateProductCategoryWithType(
p_szProductCategoryId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szCategoryType BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductCategory
SET 
szDescription = p_szDescription,
szPriceId = p_szPriceId,
szPromoPriceId = p_szPromoPriceId
WHERE 
szProductCategoryId = p_szProductCategoryId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategory_UpdateProductCategoryWithType_013(
p_szProductCategoryId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szCategoryType BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductCategory
SET 
szDescription = p_szDescription,
szPriceId = p_szPriceId,
szPromoPriceId = p_szPromoPriceId
WHERE 
szProductCategoryId = p_szProductCategoryId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategoryType_CreateProductCategoryType(
p_szCategoryType varchar,
p_szDescription BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_ProductCategoryType
(
szCategoryType,
szDescription,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCategoryType,
p_szDescription,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategoryType_DeleteProductCategoryType(
p_szCategoryType varchar)
RETURNS void AS
$BODY$
BEGIN
DELETE 
  FROM BOS_INV_ProductCategoryType
WHERE
szCategoryType = p_szCategoryType;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategoryType_GetListOfProductCategoryType()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCategoryType, szDescription

FROM 
BOS_INV_ProductCategoryType

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategoryType_GetProductCategoryType(
p_szCategoryType varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,

dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_INV_ProductCategoryType
WHERE 
szCategoryType=p_szCategoryType ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategoryType_IsProductCategoryTypeExist(
p_szCategoryType varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription

FROM 
BOS_INV_ProductCategoryType
WHERE 
szCategoryType=p_szCategoryType ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategoryType_LockProductCategoryType(
p_szCategoryType varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductCategoryType
SET 
szDescription = szDescription
WHERE 
szCategoryType=p_szCategoryType;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductCategoryType_UpdateProductCategoryType(
p_szCategoryType varchar,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_ProductCategoryType
SET 
szDescription = p_szDescription
WHERE 
szCategoryType = p_szCategoryType;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_ProductTechnicalSpecInfo_GetTechnicalSpecInfo(
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decWeight,
szUomWeight,
decVolume,
szUomVolume,
decLength,
szUomLength,
decWidth,
szUomWidth,
decHeight,
szUomHeight,
szDescription

FROM 
BOS_INV_ProductTechnicalSpecInfo
WHERE 
szProductId = p_szProductId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_AllocateStock(
p_szProductId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_dtmExpired timestamp,
p_decAllocatedQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockAllocation
SET 
decAllocatedQty = decAllocatedQty + p_decAllocatedQty,
decWpAllocatedQty = decWpAllocatedQty + p_decAllocatedQty

WHERE 
szProductId = p_szProductId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_AllocateStock_014(
p_szProductId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_dtmExpired timestamp,
p_decAllocatedQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockAllocation
SET 
decAllocatedQty = decAllocatedQty + p_decAllocatedQty,
decWpAllocatedQty = decWpAllocatedQty + p_decAllocatedQty

WHERE 
szProductId = p_szProductId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStock(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_decQtyOnHand BOS_DT_decAmount,
p_bFreeze smallint,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_Stock
(
szProductId,
szLocationType,
szLocationId,
szStockTypeId,
szReportedAsType,
szReportedAsId,
decQtyOnHand,
-- stock opname parameter,
bFreeze,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
)
VALUES
(
p_szProductId,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_szReportedAsType,
p_szReportedAsId,
p_decQtyOnHand,
-- stock opname parameter,
p_bFreeze,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStock_014(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_decQtyOnHand BOS_DT_decAmount,
p_bFreeze smallint,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_Stock
(
szProductId,
szLocationType,
szLocationId,
szStockTypeId,
szReportedAsType,
szReportedAsId,
decQtyOnHand,
-- stock opname parameter,
bFreeze,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
)
VALUES
(
p_szProductId,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_szReportedAsType,
p_szReportedAsId,
p_decQtyOnHand,
-- stock opname parameter,
p_bFreeze,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStock_015(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_decQtyOnHand BOS_DT_decAmount,
p_bFreeze smallint,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint,
p_szDistProductId BOS_DT_szId,
p_decDistQtyOnHand BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_Stock
(
szProductId,
szLocationType,
szLocationId,
szStockTypeId,
szReportedAsType,
szReportedAsId,
decQtyOnHand,
-- stock opname parameter,
bFreeze,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
-- distributor original data,
szDistProductId,
decDistQtyOnHand
)
VALUES
(
p_szProductId,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_szReportedAsType,
p_szReportedAsId,
p_decQtyOnHand,
-- stock opname parameter,
p_bFreeze,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
-- distributor original data,
p_szDistProductId,
p_decDistQtyOnHand,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStockAllocation(
p_szProductId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_dtmExpired timestamp,
p_decAllocatedQty BOS_DT_decAmount,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockAllocation
(
  ,
szProductId  ,
szWorkplaceId  ,
dtmExpired  ,
decAllocatedQty  ,
dtmLastUpdated,
decWpAllocatedQty  
  ,
)
VALUES
(
p_szProductId,
p_szWorkplaceId,
p_dtmExpired,
p_decAllocatedQty,
p_dtmLastUpdated,
p_decAllocatedQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStockAllocation_014(
p_szProductId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_dtmExpired timestamp,
p_decAllocatedQty BOS_DT_decAmount,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockAllocation
(
  ,
szProductId  ,
szWorkplaceId  ,
dtmExpired  ,
decAllocatedQty  ,
dtmLastUpdated,
decWpAllocatedQty  
  ,
)
VALUES
(
p_szProductId,
p_szWorkplaceId,
p_dtmExpired,
p_decAllocatedQty,
p_dtmLastUpdated,
p_decAllocatedQty,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStockHistory(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_dtmTransaction timestamp,
p_gdHistoryId bytea,
p_shOrder smallint,
p_decQty BOS_DT_decAmount,
p_decDocQty BOS_DT_decAmount,
p_szDocUomId BOS_DT_szMediumId,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szStockTransferReason varchar,
p_szOrderTypeId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szUrl BOS_DT_szUrl,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_szPartyType BOS_DT_szSmallId,
p_szPartyId BOS_DT_szId,
p_szEmployeeId BOS_DT_szId,
p_szRefDocId BOS_DT_szId,
p_szPartyLocType BOS_DT_szSmallId,
p_szPartyLocId BOS_DT_szId,
p_szFakturPajakId BOS_DT_szId,
p_decCOGS BOS_DT_decAmount,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockHistory
(
szProductId,
szLocationType,
szLocationId,
szStockTypeId,
dtmTransaction,
gdHistoryId,
shOrder,
decQty,
decDocQty,
szDocUomId,
szTrnId,
szDocId,
szStockTransferReason,
szOrderTypeId,
szOrderItemTypeId,
szURL,
szReportedAsType,
szReportedAsId,
szPartyType,
szPartyId,
szEmployeeId,
szRefDocId,
szPartyLocType,
szPartyLocId,
szFakturPajakId,
decCOGS,
dtmLastUpdated,
)
VALUES
(
p_szProductId,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_dtmTransaction,
p_gdHistoryId,
p_shOrder,
p_decQty,
p_decDocQty,
p_szDocUomId,
p_szTrnId,
p_szDocId,
p_szStockTransferReason,
p_szOrderTypeId,
p_szOrderItemTypeId,
p_szURL,
p_szReportedAsType,
p_szReportedAsId,
p_szPartyType,
p_szPartyId,
p_szEmployeeId,
p_szRefDocId,
p_szPartyLocType,
p_szPartyLocId,
p_szFakturPajakId,
p_decCOGS,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStockHistory_013(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_dtmTransaction timestamp,
p_gdHistoryId bytea,
p_shOrder smallint,
p_decQty BOS_DT_decAmount,
p_decDocQty BOS_DT_decAmount,
p_szDocUomId BOS_DT_szMediumId,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szStockTransferReason varchar,
p_szOrderTypeId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szUrl BOS_DT_szUrl,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_szPartyType BOS_DT_szSmallId,
p_szPartyId BOS_DT_szId,
p_szEmployeeId BOS_DT_szId,
p_szRefDocId BOS_DT_szId,
p_szPartyLocType BOS_DT_szSmallId,
p_szPartyLocId BOS_DT_szId,
p_szFakturPajakId BOS_DT_szId,
p_decCOGS BOS_DT_decAmount,
p_bFreeze smallint,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockHistory
(
szProductId,
szLocationType,
szLocationId,
szStockTypeId,
dtmTransaction,
gdHistoryId,
shOrder,
decQty,
decDocQty,
szDocUomId,
szTrnId,
szDocId,
szStockTransferReason,
szOrderTypeId,
szOrderItemTypeId,
szURL,
szReportedAsType,
szReportedAsId,
szPartyType,
szPartyId,
szEmployeeId,
szRefDocId,
szPartyLocType,
szPartyLocId,
szFakturPajakId,
decCOGS,
bFreeze,
dtmLastUpdated
)
VALUES
(
p_szProductId,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_dtmTransaction,
p_gdHistoryId,
p_shOrder,
p_decQty,
p_decDocQty,
p_szDocUomId,
p_szTrnId,
p_szDocId,
p_szStockTransferReason,
p_szOrderTypeId,
p_szOrderItemTypeId,
p_szURL,
p_szReportedAsType,
p_szReportedAsId,
p_szPartyType,
p_szPartyId,
p_szEmployeeId,
p_szRefDocId,
p_szPartyLocType,
p_szPartyLocId,
p_szFakturPajakId,
p_decCOGS,
p_bFreeze,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStockHistory_014(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_dtmTransaction timestamp,
p_gdHistoryId bytea,
p_shOrder smallint,
p_decQty BOS_DT_decAmount,
p_decDocQty BOS_DT_decAmount,
p_szDocUomId BOS_DT_szMediumId,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szStockTransferReason varchar,
p_szOrderTypeId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szUrl BOS_DT_szUrl,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_szPartyType BOS_DT_szSmallId,
p_szPartyId BOS_DT_szId,
p_szEmployeeId BOS_DT_szId,
p_szRefDocId BOS_DT_szId,
p_szPartyLocType BOS_DT_szSmallId,
p_szPartyLocId BOS_DT_szId,
p_szFakturPajakId BOS_DT_szId,
p_decCOGS BOS_DT_decAmount,
p_bFreeze smallint,
p_dtmLastUpdated timestamp,
p_szDistProductId BOS_DT_szId,
p_decDistQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockHistory
(
szProductId,
szLocationType,
szLocationId,
szStockTypeId,
dtmTransaction,
gdHistoryId,
shOrder,
decQty,
decDocQty,
szDocUomId,
szTrnId,
szDocId,
szStockTransferReason,
szOrderTypeId,
szOrderItemTypeId,
szURL,
szReportedAsType,
szReportedAsId,
szPartyType,
szPartyId,
szEmployeeId,
szRefDocId,
szPartyLocType,
szPartyLocId,
szFakturPajakId,
decCOGS,
bFreeze,
dtmLastUpdated,
szDistProductId,
decDistQty
)
VALUES
(
p_szProductId,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_dtmTransaction,
p_gdHistoryId,
p_shOrder,
p_decQty,
p_decDocQty,
p_szDocUomId,
p_szTrnId,
p_szDocId,
p_szStockTransferReason,
p_szOrderTypeId,
p_szOrderItemTypeId,
p_szURL,
p_szReportedAsType,
p_szReportedAsId,
p_szPartyType,
p_szPartyId,
p_szEmployeeId,
p_szRefDocId,
p_szPartyLocType,
p_szPartyLocId,
p_szFakturPajakId,
p_decCOGS,
p_bFreeze,
p_dtmLastUpdated,
p_szDistProductId,
p_decDistQty,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStockSN(
p_szProductSn BOS_DT_szSN,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_shQty smallint,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockSN
(
szProductSN,
szLocationType,
szLocationId,
szStockTypeId,
szReportedAsType,
szReportedAsId,
shQty,
dtmLastUpdated,
iSyncTransferStatus
)
VALUES
(
p_szProductSN,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_szReportedAsType,
p_szReportedAsId,
p_shQty,
p_dtmLastUpdated,
0,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStockSN_014(
p_szProductSn BOS_DT_szSN,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_shQty smallint,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockSN
(
szProductSN,
szLocationType,
szLocationId,
szStockTypeId,
szReportedAsType,
szReportedAsId,
shQty,
dtmLastUpdated,
iSyncTransferStatus
)
VALUES
(
p_szProductSN,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_szReportedAsType,
p_szReportedAsId,
p_shQty,
p_dtmLastUpdated,
0,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStockSNHistory(
p_szProductSn BOS_DT_szSN,
p_szProductId BOS_DT_szId,
p_gdStockHistoryId bytea,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_shQty smallint,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockSNHistory
(
szProductSN,
szProductId,
gdStockHistoryId,
szLocationType,
szLocationId,
szStockTypeId,
szReportedAsType,
szReportedAsId,
shQty,
dtmLastUpdated
)
VALUES
(
p_szProductSN,
p_szProductId,
p_gdStockHistoryId,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_szReportedAsType,
p_szReportedAsId,
p_shQty,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStockSNHistory_013(
p_szProductSn BOS_DT_szSN,
p_szProductId BOS_DT_szId,
p_gdStockHistoryId bytea,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_shQty smallint,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockSNHistory
(
szProductSN,
szProductId,
gdStockHistoryId,
szLocationType,
szLocationId,
szStockTypeId,
szReportedAsType,
szReportedAsId,
shQty,
dtmLastUpdated,
iSyncTransferStatus
)
VALUES
(
p_szProductSN,
p_szProductId,
p_gdStockHistoryId,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_szReportedAsType,
p_szReportedAsId,
p_shQty,
p_dtmLastUpdated,
0,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStockSnProduct(
p_szProductSn BOS_DT_szSN,
p_szProductId BOS_DT_szId,
p_dtmLastChecked timestamp,
p_szSuppId BOS_DT_szId,
p_szCheckerId BOS_DT_szId,
p_szChassisNumber BOS_DT_szMediumName)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockSnProduct
(
szProductSN,
szProductId,
dtmLastChecked,
szSuppId,
szCheckerId,
szChassisNumber,
iSyncTransferStatus
)
VALUES
(
p_szProductSN,
p_szProductId,
p_dtmLastChecked,
p_szSuppId,
p_szCheckerId,
p_szChassisNumber,
0,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStockSnProduct_014(
p_szProductSn BOS_DT_szSN,
p_szProductId BOS_DT_szId,
p_dtmLastChecked timestamp,
p_szSuppId BOS_DT_szId,
p_szCheckerId BOS_DT_szId,
p_szChassisNumber BOS_DT_szMediumName)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockSnProduct
(
szProductSN,
szProductId,
dtmLastChecked,
szSuppId,
szCheckerId,
szChassisNumber,
iSyncTransferStatus
)
VALUES
(
p_szProductSN,
p_szProductId,
p_dtmLastChecked,
p_szSuppId,
p_szCheckerId,
p_szChassisNumber,
0,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStockToDeliver(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmDelivery timestamp,
p_decQtyToDeliver BOS_DT_decAmount,
p_decQtyDelivered BOS_DT_decAmount,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockToDeliver
(
szProductId,
szLocationType,
szLocationId,
dtmDelivery,
decQtyToDeliver,
decQtyDelivered,
-- Data Status.,
dtmLastUpdated
)
VALUES
(
p_szProductId,
p_szLocationType,
p_szLocationId,
p_dtmDelivery,
p_decQtyToDeliver,
p_decQtyDelivered,
-- Data Status.,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStockToDeliver_014(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmDelivery timestamp,
p_decQtyToDeliver BOS_DT_decAmount,
p_decQtyDelivered BOS_DT_decAmount,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockToDeliver
(
szProductId,
szLocationType,
szLocationId,
dtmDelivery,
decQtyToDeliver,
decQtyDelivered,
-- Data Status.,
dtmLastUpdated
)
VALUES
(
p_szProductId,
p_szLocationType,
p_szLocationId,
p_dtmDelivery,
p_decQtyToDeliver,
p_decQtyDelivered,
-- Data Status.,
p_dtmLastUpdated,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStockToReceive(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmReceive timestamp,
p_decQtyToReceive BOS_DT_decAmount,
p_decQtyReceived BOS_DT_decAmount,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockToReceive
(
szProductId,
szLocationType,
szLocationId,
dtmReceive,
decQtyToReceive,
decQtyReceived,
-- Data Status.,
dtmLastUpdated
)
VALUES
(
p_szProductId,
p_szLocationType,
p_szLocationId,
p_dtmReceive,
p_decQtyToReceive,
p_decQtyReceived,
-- Data Status.,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStockToReceive_014(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmReceive timestamp,
p_decQtyToReceive BOS_DT_decAmount,
p_decQtyReceived BOS_DT_decAmount,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockToReceive
(
szProductId,
szLocationType,
szLocationId,
dtmReceive,
decQtyToReceive,
decQtyReceived,
-- Data Status.,
dtmLastUpdated
)
VALUES
(
p_szProductId,
p_szLocationType,
p_szLocationId,
p_dtmReceive,
p_decQtyToReceive,
p_decQtyReceived,
-- Data Status.,
p_dtmLastUpdated,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStockType(
p_szStockTypeId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bAvailableForSales smallint,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockType
(
szStockTypeId,
szDescription,
bAvailableForSales,
 dtmLastUpdated,
 bAlreadyTransferred
)
VALUES
(
p_szStockTypeId,
p_szDescription,
p_bAvailableForSales,
 p_dtmLastUpdated,
 p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_CreateStockType_013(
p_szStockTypeId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bAvailableForSales smallint,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockType
(
szStockTypeId,
szDescription,
bAvailableForSales,
 dtmLastUpdated,
 bAlreadyTransferred
)
VALUES
(
p_szStockTypeId,
p_szDescription,
p_bAvailableForSales,
 p_dtmLastUpdated,
 p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_DecrStock(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_decQtyDecr BOS_DT_decAmount,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Stock
SET 
decQtyOnHand = decQtyOnHand - p_decQtyDecr,
dtmLastUpdated = p_dtmLastUpdated
WHERE 
szProductId = p_szProductId and;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_DecrStock_013(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_decQtyDecr BOS_DT_decAmount,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Stock
SET 
decQtyOnHand = decQtyOnHand - p_decQtyDecr,
dtmLastUpdated = p_dtmLastUpdated
WHERE 
szProductId = p_szProductId and;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_DecrStock_014(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_decQtyDecr BOS_DT_decAmount,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint,
p_decDistQtyDecr BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Stock
SET 
decQtyOnHand = decQtyOnHand - p_decQtyDecr,
dtmLastUpdated = p_dtmLastUpdated,
decDistQtyOnHand = decDistQtyOnHand - p_decDistQtyDecr
WHERE 
szProductId = p_szProductId and;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_DeleteStockSN(
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_INV_StockSN
WHERE
szProductSN = p_szProductSN;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_DeleteStockToDeliver(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmDelivery timestamp)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_DeleteStockToReceive(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmReceive timestamp)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_DeleteStockType(
p_szStockTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_INV_StockType
WHERE
szStockTypeId = p_szStockTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetListOfQtyOfStockAllocation(
p_szProductId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_dtmDate timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_StockAllocation.szProductId,

BOS_INV_Product.szName as szProductNm,
BOS_INV_Product.szQtyFormat as szProductQtyFormat,
BOS_INV_Product.szTrackingType as szProductTrackingType,
BOS_INV_Product.szUomId as szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,

BOS_INV_StockAllocation.szWorkplaceId,

sum(BOS_INV_StockAllocation.decAllocatedQty) as SumOfdecAllocatedQty


FROM 
BOS_INV_StockAllocation
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockAllocation.szProductId


WHERE 
BOS_INV_StockAllocation.szProductId like p_szProductId and BOS_INV_StockAllocation.szWorkplaceId like p_szWorkplaceId and BOS_INV_StockAllocation.dtmExpired >= p_dtmDate 

GROUP BY 
BOS_INV_StockAllocation.szProductId, 
BOS_INV_Product.szName, 
BOS_INV_Product.szQtyFormat, 
BOS_INV_Product.szTrackingType, 
BOS_INV_Product.szUomId, 
BOS_INV_Product.szCompUomId, 
BOS_INV_Product.szUomClassId, 
BOS_INV_StockAllocation.szWorkplaceId ;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetListOfQtyOfStockToDeliver(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_StockToDeliver.szProductId,

BOS_INV_Product.szName as szProductNm,
BOS_INV_Product.szQtyFormat as szProductQtyFormat,
BOS_INV_Product.szTrackingType as szProductTrackingType,
BOS_INV_Product.szUomId as szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,

BOS_INV_StockToDeliver.szLocationType,
BOS_INV_StockToDeliver.szLocationId,
sum(BOS_INV_StockToDeliver.decQtyToDeliver) as SumOfdecQtyToDeliver,
sum(BOS_INV_StockToDeliver.decQtyDelivered) as SumOfdecQtyDelivered


FROM 
BOS_INV_StockToDeliver LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockToDeliver.szProductId


WHERE 
BOS_INV_StockToDeliver.szProductId like p_szProductId and BOS_INV_StockToDeliver.szLocationType like p_szLocationType and BOS_INV_StockToDeliver.szLocationId like p_szLocationId and (BOS_INV_StockToDeliver.dtmDelivery >= p_dtmStart and BOS_INV_StockToDeliver.dtmDelivery < dateadd(day, 1, p_dtmEnd)) 

GROUP BY 
BOS_INV_StockToDeliver.szProductId, 
BOS_INV_Product.szName, 
BOS_INV_Product.szQtyFormat, 
BOS_INV_Product.szTrackingType, 
BOS_INV_Product.szUomId, 
BOS_INV_Product.szCompUomId, 
BOS_INV_Product.szUomClassId, 
BOS_INV_StockToDeliver.szLocationType, 
BOS_INV_StockToDeliver.szLocationId ;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetListOfQtyOfStockToReceive(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_StockToReceive.szProductId,

BOS_INV_Product.szName as szProductNm,
BOS_INV_Product.szQtyFormat as szProductQtyFormat,
BOS_INV_Product.szTrackingType as szProductTrackingType,
BOS_INV_Product.szUomId as szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,

BOS_INV_StockToReceive.szLocationType,
BOS_INV_StockToReceive.szLocationId,
sum(BOS_INV_StockToReceive.decQtyToReceive) as SumOfdecQtyToReceive,
sum(BOS_INV_StockToReceive.decQtyReceived) as SumOfdecQtyReceived


FROM 
BOS_INV_StockToReceive LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockToReceive.szProductId


WHERE 
BOS_INV_StockToReceive.szProductId like p_szProductId and BOS_INV_StockToReceive.szLocationType like p_szLocationType and BOS_INV_StockToReceive.szLocationId like p_szLocationId and (BOS_INV_StockToReceive.dtmReceive >= p_dtmStart and BOS_INV_StockToReceive.dtmReceive < dateadd(day, 1, p_dtmEnd)) 

GROUP BY 
BOS_INV_StockToReceive.szProductId, 
BOS_INV_Product.szName, 
BOS_INV_Product.szQtyFormat, 
BOS_INV_Product.szTrackingType, 
BOS_INV_Product.szUomId, 
BOS_INV_Product.szCompUomId, 
BOS_INV_Product.szUomClassId, 
BOS_INV_StockToReceive.szLocationType, 
BOS_INV_StockToReceive.szLocationId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetListOfSnViewerData(
p_szWorkplaceId BOS_DT_szId,
p_szLocationType varchar,
p_szLocationId BOS_DT_szId,
p_szSerialNumber varchar,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
BOS_INV_StockSn.szReportedAsId as szWorkplaceId,
isNull(BOS_GL_Workplace.szName,'') as szWorkplaceNm,
	isNull(dbo.KGenLocationTypeToName(BOS_INV_StockSn.szLocationType),'') as szLocationType,
	BOS_INV_StockSn.szLocationId,
	isNull(
	BOS_AR_CustLocation.szCustDeliveryNm,
		isNull(
		BOS_PI_Employee.szName,
			isNull(
			BOS_AP_Supplier.szName,
				isNull(
				BOS_INV_Carrier.szName,
					isNull(
					BOS_INV_Warehouse.szName,
						isNull(
						BOS_INV_Vehicle.szPoliceNo,''
						))))))
	as szLocationNm,
	isNull(BOS_AR_CustLocation.LocationszAddress_1+' '+
		   BOS_AR_CustLocation.LocationszAddress_2+' '+
		   BOS_AR_CustLocation.LocationszCity+' '+
		   BOS_AR_CustLocation.LocationszZipCode,'') as szAddress,
	BOS_INV_StockSn.szProductSn as szProductSn,
	isNull(BOS_INV_StockSNProduct.szProductId,'') as szProductId,
	isNull(BOS_INV_Product.szName,'') as szProductNm,
	BOS_INV_StockSn.szStockTypeId,
	isNull(dbo.KGenPaymentTypeToName(BOS_SD_FDoItem.szPaymentType),'') as szPaymentType,
	isNull(BOS_SD_RentalProduct.szTrnId+' '+BOS_SD_RentalProduct.szDocId,' ') as szReffDoc,
	isNull(dbo.KGenReturnDateNoTime(BOS_SD_FDo.dtmDelivery),'1900-01-01') as dtmInstalled,
	isNull(dbo.KGenReturnDateNoTime(BOS_SD_RentalProduct.dtmLastInvoiced),'1900-01-01') as dtmInvoiced,
	isNull(BOS_SD_RentalProduct.decCharge,0) as decPrice,
	isNull(dbo.KGenBitTroubleToStringTrouble(BOS_SD_RentalProduct.bTrouble),'') as szTrouble


FROM 
BOS_INV_StockSn
left Join BOS_SD_RentalProduct on BOS_SD_RentalProduct.szSerNum=BOS_INV_StockSn.szProductSn
left Join BOS_INV_StockSNProduct on BOS_INV_StockSNProduct.szProductSn=BOS_INV_StockSn.szProductSn
left Join BOS_SD_FDoItemSn on BOS_SD_FDoItemSn.szProductSn=BOS_SD_RentalProduct.szSerNum
left Join BOS_SD_FDoItem on BOS_SD_FDoItem.szDoId=BOS_SD_FDoItemSn.szDoId and BOS_SD_FDoItem.shItemNumber=BOS_SD_FDoItemSn.shItemNumber
left Join BOS_SD_FDo on BOS_SD_FDo.szDoId=BOS_SD_RentalProduct.szDocId
left Join BOS_GL_Workplace on BOS_GL_Workplace.szWorkplaceId = BOS_INV_StockSn.szReportedAsId
left Join BOS_INV_Warehouse on BOS_INV_Warehouse.szWarehouseId = BOS_INV_StockSn.szLocationId
left Join BOS_INV_Vehicle on BOS_INV_Vehicle.szVehicleId = BOS_INV_StockSn.szLocationId
left Join BOS_AR_CustLocation on BOS_AR_CustLocation.szCustId = BOS_INV_StockSn.szLocationId
left Join BOS_AP_Supplier on BOS_AP_Supplier.szSuppId = BOS_INV_StockSn.szLocationId
left Join BOS_INV_Carrier on BOS_INV_Carrier.szCarrierId = BOS_INV_StockSn.szLocationId
left Join BOS_PI_Employee on BOS_PI_Employee.szEmployeeId=BOS_INV_StockSNProduct.szProductId
left Join BOS_INV_Product on BOS_INV_Product.szProductId=BOS_INV_StockSNProduct.szProductId

WHERE 
BOS_INV_StockSn.shQty>0 and BOS_INV_StockSn.szReportedAsType='WOR' and BOS_INV_StockSn.szReportedAsId like p_szWorkplaceId and BOS_INV_StockSn.szLocationType like p_szLocationType and BOS_INV_StockSn.szLocationId like p_szLocationId and BOS_INV_StockSn.szProductSn like p_szSerialNumber and BOS_INV_StockSNProduct.szProductId like p_szProductId 

ORDER BY 
szWorkplaceId,
szLocationType,
szLocationId,
szProductId,
szProductSN;

END;
$BODY$
LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetListOfSnViewerData_013(
p_szWorkplaceId BOS_DT_szId,
p_szLocationType varchar,
p_szLocationId BOS_DT_szId,
p_szSerialNumber varchar,
p_szProductId BOS_DT_szId,
p_dtmTransaction timestamp,	
p_szStockTypeId varchar)

RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
BOS_INV_StockSn.szReportedAsId as szWorkplaceId,
	isNull(BOS_GL_Workplace.szName,'') as szWorkplaceNm,
	isNull(dbo.KGenLocationTypeToName(BOS_INV_StockSn.szLocationType),'') as szLocationType,
	BOS_INV_StockSn.szLocationId,
	isNull(BOS_AR_CustLocation.szCustDeliveryNm,
		isNull(BOS_PI_Employee.szName,
			isNull(BOS_AP_Supplier.szName,
				isNull(BOS_INV_Carrier.szName,
					isNull(BOS_INV_Warehouse.szName,
						isNull(BOS_INV_Vehicle.szPoliceNo,'')))))) as szLocationNm,
	isNull(BOS_AR_CustLocation.LocationszAddress_1+' '+
		   BOS_AR_CustLocation.LocationszAddress_2+' '+
		   BOS_AR_CustLocation.LocationszCity+' '+
		   BOS_AR_CustLocation.LocationszZipCode,'') as szAddress,
	BOS_INV_StockSn.szProductSn as szProductSn,
	isNull(BOS_INV_StockSN.szProductId,'') as szProductId,
	isNull(BOS_INV_Product.szName,'') as szProductNm,
	BOS_INV_StockSn.szStockTypeId,
	isNull(dbo.KGenPaymentTypeToName(BOS_SD_FDoItem.szPaymentType),'') as szPaymentType,
	isNull(BOS_SD_RentalProduct.szTrnId+' '+BOS_SD_RentalProduct.szDocId,' ') as szReffDoc,
	isNull(dbo.KGenReturnDateNoTime(BOS_SD_FDo.dtmDelivery),'1900-01-01') as dtmInstalled,
	isNull(dbo.KGenReturnDateNoTime(BOS_SD_RentalProduct.dtmLastInvoiced),'1900-01-01') as dtmInvoiced,
	isNull(BOS_SD_RentalProduct.decCharge,0) as decPrice,
	isNull(dbo.KGenBitTroubleToStringTrouble(BOS_SD_RentalProduct.bTrouble),'') as szTrouble


FROM 
(
        SELECT 
			szproductsn,
			szReportedAsId,
			szProductId,
			szReportedAsType,
			szLocationType,
			szLocationId,
			szStockTypeId
        from
			(	SELECT 
					a.szproductsn,
					shqty*-1 as flag, 
					a.szReportedAsId, 
					a.szProductId, 
					a.szReportedAsType, 
					a.szLocationType, 
					a.szLocationId, 
					a.szStockTypeId
				from bos_inv_stocksnhistory a
				inner join bos_inv_stockhistory b on b.[gdHistoryId] = a.[gdStockHistoryId]
				where cast(b.dtmTransaction as date) > p_dtmTransaction
					and a.szReportedAsId like p_szWorkplaceId
					and a.szProductId like p_szProductId
					and a.szStockTypeId like p_szStockTypeId
					and a.szLocationId like p_szLocationId
					and a.szLocationType like p_szLocationType
					and a.szReportedAsType = 'WOR'
					and a.szProductSn like p_szSerialNumber
				union all
				SELECT 
					c.szProductSn,shqty as flag,
					szReportedAsId,szProductId,
					c.szReportedAsType,
					c.szLocationType,
					c.szLocationId,
					c.szStockTypeId
				from bos_inv_stocksn c 
				inner join bos_inv_stocksnproduct d on c.szProductSn = d.szProductSn
					and szReportedAsId like p_szWorkplaceId
					and szProductId like p_szProductId
					and szStockTypeId like p_szStockTypeId
					and szLocationId like p_szLocationId
					and szLocationType like p_szLocationType
					and szReportedAsType = 'WOR'
					and c.szProductSn like p_szSerialNumber
			) z
        group by 
			szproductsn,
			szReportedAsId,
			szProductId,
			szReportedAsType,
			szLocationType,
			szLocationId,
			szStockTypeId
         having sum(flag) <> 0
    ) as BOS_INV_StockSn
left Join BOS_SD_RentalProduct on BOS_SD_RentalProduct.szSerNum = BOS_INV_StockSn.szProductSn
--left Join BOS_INV_StockSNProduct on BOS_INV_StockSNProduct.szProductSn = BOS_INV_StockSn.szProductSn
left Join BOS_SD_FDoItemSn on BOS_SD_FDoItemSn.szProductSn = BOS_SD_RentalProduct.szSerNum 
left Join BOS_SD_FDoItem on BOS_SD_FDoItem.szDoId = BOS_SD_FDoItemSn.szDoId 
	and BOS_SD_FDoItem.shItemNumber = BOS_SD_FDoItemSn.shItemNumber 
left Join BOS_SD_FDo on BOS_SD_FDo.szDoId = BOS_SD_RentalProduct.szDocId
left Join BOS_GL_Workplace on BOS_GL_Workplace.szWorkplaceId = BOS_INV_StockSn.szReportedAsId
left Join BOS_INV_Warehouse on BOS_INV_Warehouse.szWarehouseId = BOS_INV_StockSn.szLocationId
left Join BOS_INV_Vehicle on BOS_INV_Vehicle.szVehicleId = BOS_INV_StockSn.szLocationId
left Join BOS_AR_CustLocation on BOS_AR_CustLocation.szCustId = BOS_INV_StockSn.szLocationId
left Join BOS_AP_Supplier on BOS_AP_Supplier.szSuppId = BOS_INV_StockSn.szLocationId
left Join BOS_INV_Carrier on BOS_INV_Carrier.szCarrierId = BOS_INV_StockSn.szLocationId
left Join BOS_PI_Employee on BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szSalesId
left Join BOS_INV_Product on BOS_INV_Product.szProductId = BOS_INV_StockSN.szProductId

ORDER BY 
szWorkplaceId,
szLocationType,
szLocationId,
szProductId,
szProductSN;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetListOfStock(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId,
szLocationType,
szLocationId,
szStockTypeId,
szReportedAsType,
szReportedAsId,
bFreeze

FROM 
BOS_INV_Stock
WHERE 
BOS_INV_Stock.szProductId LIKE p_szProductId AND BOS_INV_Stock.szLocationType LIKE p_szLocationType AND BOS_INV_Stock.szLocationId LIKE p_szLocationId AND BOS_INV_Stock.szStockTypeId LIKE p_szStockTypeId AND BOS_INV_Stock.szReportedAsType LIKE p_szReportedAsType AND BOS_INV_Stock.szReportedAsId LIKE  p_szReportedAsId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetListOfStock_014(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId,
szLocationType,
szLocationId,
szStockTypeId,
szReportedAsType,
szReportedAsId,
bFreeze

FROM 
BOS_INV_Stock
WHERE 
BOS_INV_Stock.szProductId LIKE p_szProductId AND BOS_INV_Stock.szLocationType LIKE p_szLocationType AND BOS_INV_Stock.szLocationId LIKE p_szLocationId AND BOS_INV_Stock.szStockTypeId LIKE p_szStockTypeId AND BOS_INV_Stock.szReportedAsType LIKE p_szReportedAsType AND BOS_INV_Stock.szReportedAsId LIKE  p_szReportedAsId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetListOfStockBalance(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_szProductCat_1 BOS_DT_szId,
p_szProductCat_2 BOS_DT_szId,
p_szProductCat_3 BOS_DT_szId,
p_szProductCat_4 BOS_DT_szId,
p_szProductCat_5 BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

WITH BISH as(
SELECT  
decQtyCurrent = sum(case when dtmTransaction >= p_dtmEnd + 1   then decQty else 0 end),
decQtyOut = SUM(case when dtmTransaction < p_dtmEnd + 1 AND decQty < 0  then decQty else 0 end),
decQtyIn = SUM(case when dtmTransaction < p_dtmEnd + 1 AND decQty >= 0  then decQty else 0 end),
szProductId,  
szLocationType,  
szLocationId,  
szStockTypeId,  
szReportedAsType,  
szReportedAsId
FROM  
BOS_INV_StockHistory
WHERE
dtmTransaction >= p_dtmStart
GROUP BY  
szProductId,  
szLocationType,  
szLocationId,  
szStockTypeId,  
szReportedAsType,  
szReportedAsId
)
SELECT   
BIS.szProductId,  
BIP.szName As szProductName,  
BIS.szLocationType,  
BIS.szLocationId,  
BIS.szStockTypeId,  
BIS.szReportedAsType,  

BIS.szReportedAsId,  
WP.szName AS szReportedAsNm_J,  

BIP.szQtyFormat,  
BIP.szTrackingType,  
BIP.szUomId,  
BIP.szCompUomId AS szProductCompUomId,  
BIP.szUomClassId AS szProductUomClassId_J,  
BIS.decQtyOnHand
, IsNull(BISH.decQtyIn, 0) As decQtyIn
, ISNULL(BISH.decQtyOut,0) as decQtyOut
, IsNull(BISH.decQtyCurrent, 0) As decQtyToCurrent  

FROM  
BOS_INV_Stock As BIS  
LEFT JOIN BOS_INV_Product As BIP ON BIS.szProductId = BIP.szProductId  
LEFT JOIN BOS_GL_Workplace AS WP ON WP.szWorkplaceId = BIS.szReportedAsId  
LEFT JOIN BISH
on 
BISH.szProductId = BIS.szProductId AND  
BISH.szLocationType = BIS.szLocationType AND  
BISH.szLocationId = BIS.szLocationId AND  
BISH.szStockTypeId = BIS.szStockTypeId AND  
BISH.szReportedAsType = BIS.szReportedAsType AND  
BISH.szReportedAsId = BIS.szReportedAsId

WHERE  
BIS.szProductId = case p_szProductId when '%' then BIS.szProductId else p_szProductId end
AND BIS.szLocationType = case p_szLocationType when '%' then BIS.szLocationType else p_szLocationType end
AND BIS.szLocationId = case p_szLocationId when '%' then BIS.szLocationId else p_szLocationId end
AND BIS.szStockTypeId = case p_szStockTypeId when '%' then BIS.szStockTypeId else p_szStockTypeId end
AND BIS.szReportedAsType = case p_szReportedAsType when '%' then BIS.szReportedAsType else p_szReportedAsType end
AND BIS.szReportedAsId = case p_szReportedAsId  when '%' then BIS.szReportedAsId else p_szReportedAsId end
AND BIP.szCategory_1 = case p_szProductCat_1 when '%' then BIP.szCategory_1 else p_szProductCat_1 end
AND BIP.szCategory_2 = case p_szProductCat_2 when '%' then BIP.szCategory_2 else p_szProductCat_2 end
AND BIP.szCategory_3 = case p_szProductCat_3 when '%' then BIP.szCategory_3 else p_szProductCat_3 end
AND BIP.szCategory_4 = case p_szProductCat_4 when '%' then BIP.szCategory_4 else p_szProductCat_4 end
AND BIP.szCategory_5 = case p_szProductCat_5 when '%' then BIP.szCategory_5 else p_szProductCat_5 end

ORDER BY  
BIS.szProductId,  
BIP.szName,  
BIS.szLocationType,  
BIS.szLocationId,  
BIS.szStockTypeId,  
BIS.szReportedAsType,  
BIS.szReportedAsId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetListOfStockBalance_013(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_szProductCat_1 BOS_DT_szId,
p_szProductCat_2 BOS_DT_szId,
p_szProductCat_3 BOS_DT_szId,
p_szProductCat_4 BOS_DT_szId,
p_szProductCat_5 BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

WITH BISH as(  
SELECT    
decQtyCurrent = sum(case when dtmTransaction >= p_dtmEnd + 1   then decQty else 0 end),  
decQtyOut = SUM(case when dtmTransaction < p_dtmEnd + 1 AND decQty < 0  then decQty else 0 end),  
decQtyIn = SUM(case when dtmTransaction < p_dtmEnd + 1 AND decQty >= 0  then decQty else 0 end),  
szProductId,    
szLocationType,    
szLocationId,    
szStockTypeId,    
szReportedAsType,    
szReportedAsId  
FROM    
BOS_INV_StockHistory  
WHERE  
dtmTransaction >= p_dtmStart  
GROUP BY    
szProductId,    
szLocationType,    
szLocationId,    
szStockTypeId,    
szReportedAsType,    
szReportedAsId  
)  
SELECT     
BIS.szProductId,    
BIP.szName As szProductName,    
BIS.szLocationType,    
BIS.szLocationId,    
BIS.szStockTypeId,    
BIS.szReportedAsType,    

BIS.szReportedAsId,    
WP.szName AS szReportedAsNm_J,    

BIP.szQtyFormat,    
BIP.szTrackingType,    
BIP.szUomId,    
BIP.szCompUomId AS szProductCompUomId,    
BIP.szUomClassId AS szProductUomClassId_J,    
BIS.decQtyOnHand  
, IsNull(BISH.decQtyIn, 0) As decQtyIn  
, ISNULL(BISH.decQtyOut,0) as decQtyOut  
, IsNull(BISH.decQtyCurrent, 0) As decQtyToCurrent    

FROM    
BOS_INV_Stock As BIS    
LEFT JOIN BOS_INV_Product As BIP ON BIS.szProductId = BIP.szProductId    
LEFT JOIN BOS_GL_Workplace AS WP ON WP.szWorkplaceId = BIS.szReportedAsId    
LEFT JOIN BISH  
on   
BISH.szProductId = BIS.szProductId AND    
BISH.szLocationType = BIS.szLocationType AND    
BISH.szLocationId = BIS.szLocationId AND    
BISH.szStockTypeId = BIS.szStockTypeId AND    
BISH.szReportedAsType = BIS.szReportedAsType AND    
BISH.szReportedAsId = BIS.szReportedAsId  

WHERE    
BIS.szProductId = case p_szProductId when '%' then BIS.szProductId else p_szProductId end  
AND BIS.szLocationType = case p_szLocationType when '%' then BIS.szLocationType else p_szLocationType end  
AND BIS.szLocationId = case p_szLocationId when '%' then BIS.szLocationId else p_szLocationId end  
AND BIS.szStockTypeId = case p_szStockTypeId when '%' then BIS.szStockTypeId else p_szStockTypeId end  
AND BIS.szReportedAsType = case p_szReportedAsType when '%' then BIS.szReportedAsType else p_szReportedAsType end  
AND BIS.szReportedAsId = case p_szReportedAsId  when '%' then BIS.szReportedAsId else p_szReportedAsId end  
AND BIP.szCategory_1 = case p_szProductCat_1 when '%' then BIP.szCategory_1 else p_szProductCat_1 end  
AND BIP.szCategory_2 = case p_szProductCat_2 when '%' then BIP.szCategory_2 else p_szProductCat_2 end  
AND BIP.szCategory_3 = case p_szProductCat_3 when '%' then BIP.szCategory_3 else p_szProductCat_3 end  
AND BIP.szCategory_4 = case p_szProductCat_4 when '%' then BIP.szCategory_4 else p_szProductCat_4 end  
AND BIP.szCategory_5 = case p_szProductCat_5 when '%' then BIP.szCategory_5 else p_szProductCat_5 end  

ORDER BY    
BIS.szProductId,    
BIP.szName,    
BIS.szLocationType,    
BIS.szLocationId,    
BIS.szStockTypeId,    
BIS.szReportedAsType,    
BIS.szReportedAsId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetListOfStockData(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_INV_Stock.szProductId,
BOS_INV_Product.szName AS szProductNm,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
BOS_INV_Product.szUomId as szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Stock.szStockTypeId,
BOS_INV_Stock.szReportedAsType,

BOS_INV_Stock.szReportedAsId,
WP.szName AS szReportedAsNm_J,

BOS_INV_Stock.szLocationType,
BOS_INV_Stock.szLocationId,
BOS_INV_Stock.decQtyOnHand,

--DataStatus
BOS_INV_Stock.dtmLastUpdated,
BOS_INV_Stock.bAlreadyTransferred

--for stock opname
,BOS_INV_Stock.bFreeze
FROM
BOS_INV_Stock 
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_Stock.szProductId
LEFT JOIN BOS_GL_Workplace AS WP ON WP.szWorkplaceId = BOS_INV_Stock.szReportedAsId
WHERE
BOS_INV_Stock.szProductId LIKE p_szProductId AND
BOS_INV_Stock.szReportedAsType LIKE p_szReportedAsType AND
BOS_INV_Stock.szReportedAsId LIKE  p_szReportedAsId AND
BOS_INV_Stock.szLocationType LIKE p_szLocationType AND
BOS_INV_Stock.szLocationId LIKE p_szLocationId AND
BOS_INV_Stock.szStockTypeId LIKE p_szStockTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetListOfStockData_014(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_INV_Stock.szProductId,
BOS_INV_Product.szName AS szProductNm,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
BOS_INV_Product.szUomId as szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Stock.szStockTypeId,
BOS_INV_Stock.szReportedAsType,

BOS_INV_Stock.szReportedAsId,
WP.szName AS szReportedAsNm_J,

BOS_INV_Stock.szLocationType,
BOS_INV_Stock.szLocationId,
BOS_INV_Stock.decQtyOnHand,

--DataStatus
BOS_INV_Stock.dtmLastUpdated,
BOS_INV_Stock.bAlreadyTransferred

--for stock opname
,BOS_INV_Stock.bFreeze
FROM
BOS_INV_Stock 
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_Stock.szProductId
LEFT JOIN BOS_GL_Workplace AS WP ON WP.szWorkplaceId = BOS_INV_Stock.szReportedAsId
WHERE
BOS_INV_Stock.szProductId LIKE p_szProductId AND
BOS_INV_Stock.szReportedAsType LIKE p_szReportedAsType AND
BOS_INV_Stock.szReportedAsId LIKE  p_szReportedAsId AND
BOS_INV_Stock.szLocationType LIKE p_szLocationType AND
BOS_INV_Stock.szLocationId LIKE p_szLocationId AND
BOS_INV_Stock.szStockTypeId LIKE p_szStockTypeId;


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetListOfStockDataAvailableForSales(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_INV_Stock.szProductId,  
BOS_INV_Product.szName AS szProductNm,  
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,  
BOS_INV_Product.szTrackingType AS szProductTrackingType,  
BOS_INV_Product.szUomId as szProductUomId,  
BOS_INV_Product.szCompUomId AS szProductCompUomId,  
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,  
BOS_INV_Stock.szStockTypeId,  
BOS_INV_Stock.szReportedAsType,  

BOS_INV_Stock.szReportedAsId,  
WP.szName AS szReportedAsNm_J,  

BOS_INV_Stock.szLocationType,  
BOS_INV_Stock.szLocationId,  
BOS_INV_Stock.decQtyOnHand, 
BOS_INV_Stock.bFreeze, 

--DataStatus  
BOS_INV_Stock.dtmLastUpdated,  
BOS_INV_Stock.bAlreadyTransferred  

FROM  
BOS_INV_Stock   
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_Stock.szProductId  
LEFT JOIN BOS_INV_StockType ON BOS_INV_StockType.szStockTypeId = BOS_INV_Stock.szStockTypeId  
LEFT JOIN BOS_GL_Workplace AS WP ON WP.szWorkplaceId = BOS_INV_Stock.szReportedAsId  

WHERE  
BOS_INV_Stock.szProductId LIKE p_szProductId AND  
BOS_INV_Stock.szReportedAsType LIKE p_szReportedAsType AND  
BOS_INV_Stock.szReportedAsId LIKE  p_szReportedAsId AND  
BOS_INV_Stock.szLocationType LIKE p_szLocationType AND  
BOS_INV_Stock.szLocationId LIKE p_szLocationId AND  
BOS_INV_Stock.szStockTypeId LIKE p_szStockTypeId AND  
BOS_INV_StockType.bAvailableForSales = 1;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetListOfStockDataAvailableForSales_014(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_INV_Stock.szProductId,  
BOS_INV_Product.szName AS szProductNm,  
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,  
BOS_INV_Product.szTrackingType AS szProductTrackingType,  
BOS_INV_Product.szUomId as szProductUomId,  
BOS_INV_Product.szCompUomId AS szProductCompUomId,  
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,  
BOS_INV_Stock.szStockTypeId,  
BOS_INV_Stock.szReportedAsType,  

BOS_INV_Stock.szReportedAsId,  
WP.szName AS szReportedAsNm_J,  

BOS_INV_Stock.szLocationType,  
BOS_INV_Stock.szLocationId,  
BOS_INV_Stock.decQtyOnHand, 
BOS_INV_Stock.bFreeze, 

--DataStatus  
BOS_INV_Stock.dtmLastUpdated,  
BOS_INV_Stock.bAlreadyTransferred  

FROM  
BOS_INV_Stock   
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_Stock.szProductId  
LEFT JOIN BOS_INV_StockType ON BOS_INV_StockType.szStockTypeId = BOS_INV_Stock.szStockTypeId  
LEFT JOIN BOS_GL_Workplace AS WP ON WP.szWorkplaceId = BOS_INV_Stock.szReportedAsId  

WHERE  
BOS_INV_Stock.szProductId LIKE p_szProductId AND  
BOS_INV_Stock.szReportedAsType LIKE p_szReportedAsType AND  
BOS_INV_Stock.szReportedAsId LIKE  p_szReportedAsId AND  
BOS_INV_Stock.szLocationType LIKE p_szLocationType AND  
BOS_INV_Stock.szLocationId LIKE p_szLocationId AND  
BOS_INV_Stock.szStockTypeId LIKE p_szStockTypeId AND  
BOS_INV_StockType.bAvailableForSales = 1;


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetListOfStockSN(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_szSn BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_INV_StockSN.szProductSN,
BOS_INV_StockSN.szLocationType,
BOS_INV_StockSN.szLocationId,
BOS_INV_StockSN.szStockTypeId,
BOS_INV_StockSN.szReportedAsId as szWorkplaceId,
BOS_INV_StockSnProduct.szProductId,
BOS_INV_Product.szName as szProductNm,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
WP.szName AS szReportedAsNm_J

FROM 
BOS_INV_StockSN
LEFT JOIN BOS_INV_StockSnProduct ON BOS_INV_StockSnProduct.szProductSN = BOS_INV_StockSN.szProductSN
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockSnProduct.szProductId
LEFT JOIN BOS_GL_Workplace AS WP ON WP.szWorkplaceId = BOS_INV_StockSN.szReportedAsId

WHERE
BOS_INV_StockSnProduct.szProductId like p_szProductId and
BOS_INV_StockSN.szLocationType like p_szLocationType and
BOS_INV_StockSN.szLocationId like p_szLocationId and
BOS_INV_StockSN.szStockTypeId like p_szStockTypeId and
BOS_INV_StockSN.szReportedAsType = 'WOR' and
BOS_INV_StockSN.szReportedAsId like p_szWorkplaceId and
BOS_INV_StockSN.szProductSn like p_szSn AND
BOS_INV_StockSN.shQty > 0

ORDER BY 
BOS_INV_StockSN.szProductSN,
BOS_INV_StockSnProduct.szProductId,
BOS_INV_StockSN.szLocationType,
BOS_INV_StockSN.szLocationId,
BOS_INV_StockSN.szStockTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetListOfStockToDeliver()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId,
szLocationType,
szLocationId,
dtmDelivery,
decQtyToDeliver

FROM 
BOS_INV_StockToDeliver;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetListOfStockToReceive()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId,
szLocationType,
szLocationId,
dtmReceive,
decQtyToReceive


FROM 
BOS_INV_StockToReceive;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetListOfStockType()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szStockTypeId,
szDescription

FROM 
BOS_INV_StockType;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetOneStockSN(
p_szProductSn BOS_DT_szSN,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_StockSnProduct.szProductId,
BOS_INV_Product.szName as szProductNm,
BOS_INV_Product.szQtyFormat as szProductQtyFormat,
BOS_INV_StockSn.shQty,
BOS_INV_StockSn.dtmLastUpdated

FROM 
BOS_INV_StockSN
LEFT JOIN BOS_INV_StockSnProduct ON BOS_INV_StockSnProduct.szProductSN = BOS_INV_StockSn.szProductSN
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockSnProduct.szProductId
WHERE
BOS_INV_StockSN.szProductSN = p_szProductSN and
BOS_INV_StockSN.szLocationType = p_szLocationType and 
BOS_INV_StockSN.szLocationId = p_szLocationId and
BOS_INV_StockSN.szStockTypeId=p_szStockTypeId and
BOS_INV_StockSN.szReportedAsType = p_szReportedAsType and
BOS_INV_StockSN.szReportedAsId = p_szReportedAsId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetQtyOfStock(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
decQtyOnHand

FROM 
BOS_INV_Stock
WHERE 
szProductId = p_szProductId and szLocationType = p_szLocationType and szLocationId = p_szLocationId and szStockTypeId=p_szStockTypeId and szReportedAsType = p_szReportedAsType and szReportedAsId = p_szReportedAsId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetQtyOfStockAllocation(
p_szProductId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_dtmDate timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
sum(a.decAllocatedQty ) as SumOfdecAllocatedQty

FROM 
BOS_INV_StockAllocation a
WHERE 
a.szProductId = p_szProductId and a.szWorkplaceId = p_szWorkplaceId and a.dtmExpired >= p_dtmDate GROUP BY a.szProductId, a.szWorkplaceId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetQtyOfStockAllocation_014(
p_szProductId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_dtmDate timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
sum(a.decAllocatedQty ) as SumOfdecAllocatedQty

FROM 
BOS_INV_StockAllocation a
WHERE 
a.szProductId = p_szProductId and a.szWorkplaceId = p_szWorkplaceId and a.dtmExpired >= p_dtmDate GROUP BY a.szProductId, a.szWorkplaceId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetQtyOfStockToDeliver(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
sum(decQtyToDeliver - decQtyDelivered) as SumOfdecQtyToDeliver

FROM 
BOS_INV_StockToDeliver

WHERE 
szProductId = p_szProductId and szLocationType = p_szLocationType and szLocationId like p_szLocationId and (dtmDelivery >= p_dtmStart and dtmDelivery < dateadd(day, 1, p_dtmEnd)) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetQtyOfStockToReceive(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
sum(decQtyToReceive - decQtyReceived) as SumOfdecQtyToReceive

FROM 
BOS_INV_StockToReceive
WHERE 
szProductId = p_szProductId and szLocationType = p_szLocationType and szLocationId like p_szLocationId and (dtmReceive >= p_dtmStart and dtmReceive < dateadd(day, 1, p_dtmEnd)) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStock(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_Stock.szProductId,
BOS_INV_Product.szName AS szProductNm,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
BOS_INV_Product.szUomId as szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Stock.bFreeze As bFreeze
,Sum(BOS_INV_Stock.decQtyOnHand) AS decSumOfQtyOnHand


FROM 
BOS_INV_Stock
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_Stock.szProductIdLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_Stock.szProductId

WHERE 
BOS_INV_Stock.szProductId = p_szProductId AND BOS_INV_Stock.szLocationType LIKE p_szLocationType AND BOS_INV_Stock.szLocationId LIKE p_szLocationId AND BOS_INV_Stock.szStockTypeId LIKE p_szStockTypeId AND BOS_INV_Stock.szReportedAsType LIKE p_szReportedAsType AND BOS_INV_Stock.szReportedAsId LIKE  p_szReportedAsId GROUP BY BOS_INV_Stock.szProductId, BOS_INV_Product.szName, BOS_INV_Product.szQtyFormat, BOS_INV_Product.szTrackingType, BOS_INV_Product.szUomId, BOS_INV_Product.szCompUomId, BOS_INV_Product.szUomClassId ,BOS_INV_Stock.bFreeze ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStock_014(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_Stock.szProductId,
BOS_INV_Product.szName AS szProductNm,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
BOS_INV_Product.szUomId as szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Stock.bFreeze As bFreeze
,Sum(BOS_INV_Stock.decQtyOnHand) AS decSumOfQtyOnHand


FROM 
BOS_INV_Stock
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_Stock.szProductIdLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_Stock.szProductId

WHERE 
BOS_INV_Stock.szProductId = p_szProductId AND BOS_INV_Stock.szLocationType LIKE p_szLocationType AND BOS_INV_Stock.szLocationId LIKE p_szLocationId AND BOS_INV_Stock.szStockTypeId LIKE p_szStockTypeId AND BOS_INV_Stock.szReportedAsType LIKE p_szReportedAsType AND BOS_INV_Stock.szReportedAsId LIKE  p_szReportedAsId GROUP BY BOS_INV_Stock.szProductId, BOS_INV_Product.szName, BOS_INV_Product.szQtyFormat, BOS_INV_Product.szTrackingType, BOS_INV_Product.szUomId, BOS_INV_Product.szCompUomId, BOS_INV_Product.szUomClassId ,BOS_INV_Stock.bFreeze ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStock_015(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_Stock.szProductId,
BOS_INV_Product.szName AS szProductNm,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
BOS_INV_Product.szUomId as szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Stock.bFreeze As bFreeze
,Sum(BOS_INV_Stock.decQtyOnHand) AS decSumOfQtyOnHand
,BOS_INV_Stock.szDistProductId
,Sum(BOS_INV_Stock.decDistQtyOnHand) AS decSumOfDistQtyOnHand


FROM 
BOS_INV_Stock
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_Stock.szProductIdLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_Stock.szProductId

WHERE 
BOS_INV_Stock.szProductId = p_szProductId AND BOS_INV_Stock.szLocationType LIKE p_szLocationType AND BOS_INV_Stock.szLocationId LIKE p_szLocationId AND BOS_INV_Stock.szStockTypeId LIKE p_szStockTypeId AND BOS_INV_Stock.szReportedAsType LIKE p_szReportedAsType AND BOS_INV_Stock.szReportedAsId LIKE  p_szReportedAsId GROUP BY BOS_INV_Stock.szProductId, BOS_INV_Product.szName, BOS_INV_Product.szQtyFormat, BOS_INV_Product.szTrackingType, BOS_INV_Product.szUomId, BOS_INV_Product.szCompUomId, BOS_INV_Product.szUomClassId ,BOS_INV_Stock.bFreeze ,BOS_INV_Stock.szDistProductId 
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStockAvailableForSales(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_INV_Stock.szProductId,  
BOS_INV_Product.szName AS szProductNm,  
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,  
BOS_INV_Product.szTrackingType AS szProductTrackingType,  
BOS_INV_Product.szUomId as szProductUomId,  
BOS_INV_Product.szCompUomId AS szProductCompUomId,  
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,  
Sum(BOS_INV_Stock.decQtyOnHand) AS decSumOfQtyOnHand ,
BOS_INV_Stock.bFreeze 

FROM  
BOS_INV_Stock   
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_Stock.szProductId  
LEFT JOIN BOS_INV_StockType ON BOS_INV_StockType.szStockTypeId = BOS_INV_Stock.szStockTypeId  
LEFT JOIN BOS_INV_StockLot ON BOS_INV_StockLot.szProductId = BOS_INV_Stock.szProductId  
AND BOS_INV_StockLot.szStockTypeId = BOS_INV_Stock.szStockTypeId  
LEFT JOIN BOS_INV_LotInfo ON BOS_INV_LotInfo.szLotId = BOS_INV_StockLot.szLotId  
LEFT JOIN BOS_INV_LotStatus ON BOS_INV_LotStatus.szLotStatusId = BOS_INV_LotInfo.szLotStatus  

WHERE  
BOS_INV_Stock.szProductId = p_szProductId AND  
BOS_INV_Stock.szLocationType LIKE p_szLocationType AND  
BOS_INV_Stock.szLocationId LIKE p_szLocationId AND  
BOS_INV_Stock.szStockTypeId LIKE p_szStockTypeId AND  
BOS_INV_Stock.szReportedAsType LIKE p_szReportedAsType AND  
BOS_INV_Stock.szReportedAsId LIKE  p_szReportedAsId AND  
(  
BOS_INV_StockType.bAvailableForSales = 1  
OR  
BOS_INV_LotStatus.bAvailableForSales = 1  
)  

GROUP BY   

BOS_INV_Stock.szProductId,   
BOS_INV_Product.szName,   
BOS_INV_Product.szQtyFormat,   
BOS_INV_Product.szTrackingType,   
BOS_INV_Product.szUomId,  
BOS_INV_Product.szCompUomId,  
BOS_INV_Product.szUomClassId,
BOS_INV_Stock.bFreeze;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStockAvailableForSales_014(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_INV_Stock.szProductId,  
BOS_INV_Product.szName AS szProductNm,  
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,  
BOS_INV_Product.szTrackingType AS szProductTrackingType,  
BOS_INV_Product.szUomId as szProductUomId,  
BOS_INV_Product.szCompUomId AS szProductCompUomId,  
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,  
Sum(BOS_INV_Stock.decQtyOnHand) AS decSumOfQtyOnHand ,
BOS_INV_Stock.bFreeze 

FROM  
BOS_INV_Stock   
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_Stock.szProductId  
LEFT JOIN BOS_INV_StockType ON BOS_INV_StockType.szStockTypeId = BOS_INV_Stock.szStockTypeId  
LEFT JOIN BOS_INV_StockLot ON BOS_INV_StockLot.szProductId = BOS_INV_Stock.szProductId  
AND BOS_INV_StockLot.szStockTypeId = BOS_INV_Stock.szStockTypeId  
LEFT JOIN BOS_INV_LotInfo ON BOS_INV_LotInfo.szLotId = BOS_INV_StockLot.szLotId  
LEFT JOIN BOS_INV_LotStatus ON BOS_INV_LotStatus.szLotStatusId = BOS_INV_LotInfo.szLotStatus  

WHERE  
BOS_INV_Stock.szProductId = p_szProductId AND  
BOS_INV_Stock.szLocationType LIKE p_szLocationType AND  
BOS_INV_Stock.szLocationId LIKE p_szLocationId AND  
BOS_INV_Stock.szStockTypeId LIKE p_szStockTypeId AND  
BOS_INV_Stock.szReportedAsType LIKE p_szReportedAsType AND  
BOS_INV_Stock.szReportedAsId LIKE  p_szReportedAsId AND  
(  
BOS_INV_StockType.bAvailableForSales = 1  
OR  
BOS_INV_LotStatus.bAvailableForSales = 1  
)  

GROUP BY   
--  
--  NOTE : What we want is to get stock of product SUMMED, so do not add group by that could  
--  make same product id results more than one rows.  
--  
BOS_INV_Stock.szProductId,   
BOS_INV_Product.szName,   
BOS_INV_Product.szQtyFormat,   
BOS_INV_Product.szTrackingType,   
BOS_INV_Product.szUomId,  
BOS_INV_Product.szCompUomId,  
BOS_INV_Product.szUomClassId,
BOS_INV_Stock.bFreeze;


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStockAvailableForSales_015(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_INV_Stock.szProductId,  
BOS_INV_Product.szName AS szProductNm,  
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,  
BOS_INV_Product.szTrackingType AS szProductTrackingType,  
BOS_INV_Product.szUomId as szProductUomId,  
BOS_INV_Product.szCompUomId AS szProductCompUomId,  
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,  
Sum(BOS_INV_Stock.decQtyOnHand) AS decSumOfQtyOnHand ,
BOS_INV_Stock.bFreeze, 
BOS_INV_Stock.szDistProductId ,
Sum(BOS_INV_Stock.decDistQtyOnHand) AS decSumOfDistQtyOnHand 

FROM  
BOS_INV_Stock   
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_Stock.szProductId  
LEFT JOIN BOS_INV_StockType ON BOS_INV_StockType.szStockTypeId = BOS_INV_Stock.szStockTypeId  
LEFT JOIN BOS_INV_StockLot ON BOS_INV_StockLot.szProductId = BOS_INV_Stock.szProductId  
AND BOS_INV_StockLot.szStockTypeId = BOS_INV_Stock.szStockTypeId  
LEFT JOIN BOS_INV_LotInfo ON BOS_INV_LotInfo.szLotId = BOS_INV_StockLot.szLotId  
LEFT JOIN BOS_INV_LotStatus ON BOS_INV_LotStatus.szLotStatusId = BOS_INV_LotInfo.szLotStatus  

WHERE  
BOS_INV_Stock.szProductId = p_szProductId AND  
BOS_INV_Stock.szLocationType LIKE p_szLocationType AND  
BOS_INV_Stock.szLocationId LIKE p_szLocationId AND  
BOS_INV_Stock.szStockTypeId LIKE p_szStockTypeId AND  
BOS_INV_Stock.szReportedAsType LIKE p_szReportedAsType AND  
BOS_INV_Stock.szReportedAsId LIKE  p_szReportedAsId AND  
(  
BOS_INV_StockType.bAvailableForSales = 1  
OR  
BOS_INV_LotStatus.bAvailableForSales = 1  
)  

GROUP BY   
--  
--  NOTE : What we want is to get stock of product SUMMED, so do not add group by that could  
--  make same product id results more than one rows.  
--  
BOS_INV_Stock.szProductId,   
BOS_INV_Product.szName,   
BOS_INV_Product.szQtyFormat,   
BOS_INV_Product.szTrackingType,   
BOS_INV_Product.szUomId,  
BOS_INV_Product.szCompUomId,  
BOS_INV_Product.szUomClassId,
BOS_INV_Stock.bFreeze,
BOS_INV_Stock.szDistProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStockHistory(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN

SELECT 
BOS_INV_StockHistory.dtmTransaction,
BOS_INV_StockHistory.gdHistoryId,
BOS_INV_StockHistory.shOrder,
BOS_INV_Product.szName as szProductNm,
BOS_INV_Product.szQtyFormat as szProductQtyFormat,
BOS_INV_StockHistory.szLocationType,
BOS_INV_StockHistory.szLocationId,
BOS_INV_StockHistory.szStockTypeId,
BOS_INV_StockHistory.szStockTransferReason,
BOS_INV_StockHistory.decDocQty,
BOS_INV_StockHistory.decQty,
BOS_INV_StockHistory.szDocId,
BOS_INV_StockHistory.szDocUomId,
BOS_INV_StockHistory.szOrderItemTypeId,
BOS_INV_StockHistory.szOrderTypeId,
BOS_INV_StockHistory.szTrnId,
BOS_INV_StockHistory.szURL,
BOS_INV_StockHistory.szReportedAsType,
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szPartyType,
BOS_INV_StockHistory.szPartyId,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName as szEmployeeNm,
BOS_INV_StockHistory.szRefDocId,
BOS_INV_StockHistory.szPartyLocType,
BOS_INV_StockHistory.szPartyLocId,
BOS_INV_StockHistory.szFakturPajakId,
BOS_INV_StockHistory.decCOGS 

FROM 
BOS_INV_StockHistory
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockHistory.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId
WHERE
BOS_INV_StockHistory.szProductId = p_szProductId AND
BOS_INV_StockHistory.szProductId like p_szProductId AND
BOS_INV_StockHistory.szLocationType like p_szLocationType AND
BOS_INV_StockHistory.szLocationId like p_szLocationId AND
BOS_INV_StockHistory.szStockTypeId like p_szStockTypeId AND
BOS_INV_StockHistory.szReportedAsType like p_szReportedAsType AND
BOS_INV_StockHistory.szReportedAsId like p_szReportedAsId  AND
(BOS_INV_StockHistory.dtmTransaction >= p_dtmStart and BOS_INV_StockHistory.dtmTransaction < dateadd(day,1, p_dtmEnd))
ORDER BY
dtmTransaction, shOrder;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStockHistory_013(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN

SELECT   
BOS_INV_StockHistory.dtmTransaction,  
BOS_INV_StockHistory.gdHistoryId,  
BOS_INV_StockHistory.shOrder,  
BOS_INV_Product.szName as szProductNm,  
BOS_INV_Product.szQtyFormat as szProductQtyFormat,  
BOS_INV_StockHistory.szLocationType,  
BOS_INV_StockHistory.szLocationId,  
BOS_INV_StockHistory.szStockTypeId,  
BOS_INV_StockHistory.szStockTransferReason,  
BOS_INV_StockHistory.decDocQty,  
BOS_INV_StockHistory.decQty,  
BOS_INV_StockHistory.szDocId,  
BOS_INV_StockHistory.szDocUomId,  
BOS_INV_StockHistory.szOrderItemTypeId,  
BOS_INV_StockHistory.szOrderTypeId,  
BOS_INV_StockHistory.szTrnId,  
BOS_INV_StockHistory.szURL,  
BOS_INV_StockHistory.szReportedAsType,  
BOS_INV_StockHistory.szReportedAsId,  
BOS_INV_StockHistory.szPartyType,  
BOS_INV_StockHistory.szPartyId,  
BOS_INV_StockHistory.szEmployeeId,  
BOS_PI_Employee.szName as szEmployeeNm,  
BOS_INV_StockHistory.szRefDocId,  
BOS_INV_StockHistory.szPartyLocType,  
BOS_INV_StockHistory.szPartyLocId,  
BOS_INV_StockHistory.szFakturPajakId,  
BOS_INV_StockHistory.decCOGS   

FROM   
BOS_INV_StockHistory  
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockHistory.szProductId  
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId  
WHERE  
BOS_INV_StockHistory.szProductId = p_szProductId AND  
BOS_INV_StockHistory.szProductId like p_szProductId AND  
BOS_INV_StockHistory.szLocationType like p_szLocationType AND  
BOS_INV_StockHistory.szLocationId like p_szLocationId AND  
BOS_INV_StockHistory.szStockTypeId like p_szStockTypeId AND  
BOS_INV_StockHistory.szReportedAsType like p_szReportedAsType AND  
BOS_INV_StockHistory.szReportedAsId like p_szReportedAsId  AND  
(BOS_INV_StockHistory.dtmTransaction >= p_dtmStart and BOS_INV_StockHistory.dtmTransaction < dateadd(day,1, p_dtmEnd))  
ORDER BY  
dtmTransaction, shOrder;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStockSN(
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN

SELECT 
BOS_INV_StockSnProduct.szProductId,
BOS_INV_Product.szName as szProductNm,
BOS_INV_Product.szQtyFormat as szProductQtyFormat,
BOS_INV_StockSn.szLocationType, 
BOS_INV_StockSn.szLocationId, 
BOS_INV_StockSn.szStockTypeId,  
BOS_INV_StockSn.szReportedAsType,
BOS_INV_StockSn.szReportedAsId,
BOS_INV_StockSn.shQty,
BOS_INV_StockSn.dtmLastUpdated
FROM 
BOS_INV_StockSN
LEFT JOIN BOS_INV_StockSnProduct ON BOS_INV_StockSnProduct.szProductSN = BOS_INV_StockSn.szProductSN
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockSnProduct.szProductId

WHERE
BOS_INV_StockSN.szProductSN = p_szProductSN AND
BOS_INV_StockSN.shQty > 0

ORDER BY
BOS_INV_StockSN.dtmLastUpdated DESC;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStockSNHistory(
p_szProductSn BOS_DT_szSN,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN

SELECT 
BOS_INV_StockHistory.dtmTransaction,
BOS_INV_StockSNHistory.szProductId,
BOS_INV_Product.szName as szProductNm,
BOS_INV_StockSNHistory.szLocationType,
BOS_INV_StockSNHistory.szLocationId,
BOS_INV_StockSNHistory.szStockTypeId,
BOS_INV_StockSNHistory.szReportedAsType,
BOS_INV_StockSNHistory.szReportedAsId,
BOS_INV_StockSNHistory.shQty,
BOS_INV_StockHistory.szTrnId,
BOS_INV_StockHistory.szDocId, 
BOS_INV_StockHistory.szStockTransferReason,
BOS_INV_StockHistory.szOrderTypeId,
BOS_INV_StockHistory.szOrderItemTypeId,
BOS_INV_StockHistory.szURL,
BOS_INV_StockHistory.szPartyType,
BOS_INV_StockHistory.szPartyId

FROM 
BOS_INV_StockHistory
INNER JOIN BOS_INV_StockSNHistory ON BOS_INV_StockSNHistory.szProductId = BOS_INV_StockHistory.szProductId
AND BOS_INV_StockSNHistory.szLocationType = BOS_INV_StockHistory.szLocationType
AND BOS_INV_StockSNHistory.szLocationId = BOS_INV_StockHistory.szLocationId
AND BOS_INV_StockSNHistory.szStockTypeId = BOS_INV_StockHistory.szStockTypeId
AND BOS_INV_StockSNHistory.szReportedAsType = BOS_INV_StockHistory.szReportedAsType
AND BOS_INV_StockSNHistory.szReportedAsId = BOS_INV_StockHistory.szReportedAsId
--GUID index is very slow. So place this where clause last (hope SQL Server is smart enough to use this last).
AND BOS_INV_StockSNHistory.gdStockHistoryId = BOS_INV_StockHistory.gdHistoryId
LEFT JOIN BOS_INV_Product ON BOS_INV_StockSNHistory.szProductId = BOS_INV_Product.szProductId

WHERE
(BOS_INV_StockHistory.dtmTransaction >= p_dtmStart and BOS_INV_StockHistory.dtmTransaction < dateadd(day,1, p_dtmEnd))
AND BOS_INV_StockSNHistory.szProductSN like p_szProductSN
AND BOS_INV_StockSNHistory.shQty > 0

ORDER BY
BOS_INV_StockHistory.dtmTransaction, BOS_INV_StockHistory.shOrder;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStockSNProduct(
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN

SELECT     
BOS_INV_StockSnProduct.szProductSN,    
BOS_INV_StockSnProduct.szProductId,    
BOS_INV_StockSnProduct.dtmLastChecked,    
BOS_INV_StockSnProduct.szSuppId,    
BOS_INV_StockSnProduct.szCheckerId,    
BOS_INV_StockSnProduct.szChassisNumber,    
BOS_AP_Supplier.szName AS szSupplierName,    
BOS_PI_Employee.szName AS szCheckerName,    
BOS_INV_Product.szName AS szProductName,  
BOS_INV_StockSnProduct.dtmLastUpdated     
FROM     
BOS_INV_StockSNProduct    
LEFT JOIN BOS_AP_Supplier     
on BOS_INV_StockSnProduct.szSuppId = BOS_AP_Supplier.szSuppId    
LEFT JOIN BOS_PI_Employee    
on BOS_INV_StockSnProduct.szCheckerId = BOS_PI_Employee.szEmployeeId    
LEFT JOIN BOS_INV_Product    
on BOS_INV_StockSnProduct.szProductId = BOS_INV_Product.szProductId    
WHERE    
BOS_INV_StockSnProduct.szProductSN = p_szProductSN;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStockSNProduct_013(
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN

SELECT       
BOS_INV_StockSnProduct.szProductSN,      
BOS_INV_StockSnProduct.szProductId,      
BOS_INV_StockSnProduct.dtmLastChecked,      
BOS_INV_StockSnProduct.szSuppId,      
BOS_INV_StockSnProduct.szCheckerId,      
BOS_INV_StockSnProduct.szChassisNumber,      
BOS_AP_Supplier.szName AS szSupplierName,      
BOS_PI_Employee.szName AS szCheckerName,      
BOS_INV_Product.szName AS szProductName,    
BOS_INV_StockSnProduct.dtmLastUpdated       
FROM       
BOS_INV_StockSNProduct      
LEFT JOIN BOS_AP_Supplier       
on BOS_INV_StockSnProduct.szSuppId = BOS_AP_Supplier.szSuppId      
LEFT JOIN BOS_PI_Employee      
on BOS_INV_StockSnProduct.szCheckerId = BOS_PI_Employee.szEmployeeId      
LEFT JOIN BOS_INV_Product      
on BOS_INV_StockSnProduct.szProductId = BOS_INV_Product.szProductId      
WHERE      
BOS_INV_StockSnProduct.szProductSN = p_szProductSN;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStockSNTotalQty(
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
SELECT 
sum(BOS_INV_StockSn.shQty) AS shTotalQty

FROM 
BOS_INV_StockSN
WHERE 
BOS_INV_StockSN.szProductSN = p_szProductSN GROUP BY BOS_INV_StockSN.szProductSN ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStockSNTotalQty_013(
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
SELECT 
sum(BOS_INV_StockSn.shQty) AS shTotalQty

FROM 
BOS_INV_StockSN
WHERE 
BOS_INV_StockSN.szProductSN = p_szProductSN GROUP BY BOS_INV_StockSN.szProductSN ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStockToDeliver(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmDelivery timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_Product.szName as szProductNm_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szTrackingType as szProductTrackingType_J,
BOS_INV_Product.szUomId as szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,

decQtyToDeliver,
decQtyDelivered, BOS_INV_StockToDeliver.dtmLastUpdated


FROM 
BOS_INV_StockToDeliver
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockToDeliver.szProductIdLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockToDeliver.szProductId;

WHERE 
BOS_INV_StockToDeliver.szProductId = p_szProductId and szLocationType = p_szLocationType and szLocationId = p_szLocationId and (dtmDelivery >= p_dtmDelivery and dtmDelivery < dateadd(day, 1, p_dtmDelivery)) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStockToDeliver_014(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmDelivery timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_Product.szName as szProductNm_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szTrackingType as szProductTrackingType_J,
BOS_INV_Product.szUomId as szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,

decQtyToDeliver,
decQtyDelivered, BOS_INV_StockToDeliver.dtmLastUpdated


FROM 
BOS_INV_StockToDeliver
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockToDeliver.szProductIdLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockToDeliver.szProductId;

WHERE 
BOS_INV_StockToDeliver.szProductId = p_szProductId and szLocationType = p_szLocationType and szLocationId = p_szLocationId and (dtmDelivery >= p_dtmDelivery and dtmDelivery < dateadd(day, 1, p_dtmDelivery)) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStockToReceive(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmReceive timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_Product.szName as szProductNm_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szTrackingType as szProductTrackingType_J,
BOS_INV_Product.szUomId as szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,

decQtyToReceive,
decQtyReceived
, BOS_INV_StockToReceive.dtmLastUpdated


FROM 
BOS_INV_StockToReceive
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockToReceive.szProductIdLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockToReceive.szProductId;

WHERE 
BOS_INV_StockToReceive.szProductId = p_szProductId and szLocationType = p_szLocationType and szLocationId = p_szLocationId and (dtmReceive >= p_dtmReceive and dtmReceive < dateadd(day, 1, p_dtmReceive)) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStockToReceive_014(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmReceive timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_Product.szName as szProductNm_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szTrackingType as szProductTrackingType_J,
BOS_INV_Product.szUomId as szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,

decQtyToReceive,
decQtyReceived, BOS_INV_StockToReceive.dtmLastUpdated


FROM 
BOS_INV_StockToReceive
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockToReceive.szProductIdLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockToReceive.szProductId;

WHERE 
BOS_INV_StockToReceive.szProductId = p_szProductId and szLocationType = p_szLocationType and szLocationId = p_szLocationId and (dtmReceive >= p_dtmReceive and dtmReceive < dateadd(day, 1, p_dtmReceive)) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStockType(
p_szStockTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szStockTypeId,
szDescription,
bAvailableForSales,

-- Data Status
dtmLastUpdated,
bAlreadyTransferred


FROM 
BOS_INV_StockType
WHERE 
szStockTypeId = p_szStockTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_GetStockType_014(
p_szStockTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szStockTypeId,
szDescription,
bAvailableForSales,

-- Data Status
dtmLastUpdated,
bAlreadyTransferred


FROM 
BOS_INV_StockType
WHERE 
szStockTypeId = p_szStockTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_IncrStock(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_decQtyIncr BOS_DT_decAmount,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Stock
SET 
decQtyOnHand = decQtyOnHand + p_decQtyIncr,
dtmLastUpdated = p_dtmLastUpdated
WHERE 
szProductId = p_szProductId and
 szLocationType = p_szLocationType and    
 szLocationId = p_szLocationId and    
 szStockTypeId = p_szStockTypeId and    
 szReportedAsType = p_szReportedAsType and    
 szReportedAsId = p_szReportedAsId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_IncrStock_013(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_decQtyIncr BOS_DT_decAmount,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Stock
SET 
decQtyOnHand = decQtyOnHand + p_decQtyIncr,
dtmLastUpdated = p_dtmLastUpdated
WHERE 
szProductId = p_szProductId and
 szLocationType = p_szLocationType and      
 szLocationId = p_szLocationId and      
 szStockTypeId = p_szStockTypeId and      
 szReportedAsType = p_szReportedAsType and      
 szReportedAsId = p_szReportedAsId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_IncrStock_014(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_decQtyIncr BOS_DT_decAmount,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint,
p_decDistQtyIncr BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Stock
SET 
decQtyOnHand = decQtyOnHand + p_decQtyIncr,
dtmLastUpdated = p_dtmLastUpdated,
decDistQtyOnHand = decDistQtyOnHand + p_decDistQtyIncr
WHERE 
szProductId = p_szProductId and
 szLocationType = p_szLocationType and      
 szLocationId = p_szLocationId and      
 szStockTypeId = p_szStockTypeId and      
 szReportedAsType = p_szReportedAsType and      
 szReportedAsId = p_szReportedAsId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_IncrStockDelivered(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmDelivery timestamp,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockToDeliver
SET 
decQtyDelivered = decQtyDelivered + p_decQty

WHERE 
szProductId = p_szProductId and
szLocationType = p_szLocationType and
	szLocationId = p_szLocationId and
	dtmDelivery = p_dtmDelivery;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_IncrStockReceived(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmReceive timestamp,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockToReceive
SET 
decQtyReceived = decQtyReceived + p_decQty

WHERE 
szProductId = p_szProductId and
szLocationType = p_szLocationType and
	szLocationId = p_szLocationId and
	dtmReceive = p_dtmReceive;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_IncrStockSn(
p_szProductSn BOS_DT_szSN,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_shQty smallint,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockSn
SET 
shQty = shQty + p_shQty,
dtmLastUpdated = p_dtmLastUpdated,
iSyncTransferStatus=0
WHERE 
szProductSN = p_szProductSN and
szLocationType = p_szLocationType and
	szLocationId = p_szLocationId and
	szStockTypeId = p_szStockTypeId and
	szReportedAsType = p_szReportedAsType and
	szReportedAsId = p_szReportedAsId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_IncrStockSn_014(
p_szProductSn BOS_DT_szSN,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_shQty smallint,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockSn
SET 
shQty = shQty + p_shQty,
dtmLastUpdated = p_dtmLastUpdated,
iSyncTransferStatus=0
WHERE 
szProductSN = p_szProductSN and
 szLocationType = p_szLocationType and
    szLocationId = p_szLocationId and
    szStockTypeId = p_szStockTypeId and
    szReportedAsType = p_szReportedAsType and
    szReportedAsId = p_szReportedAsId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_IncrStockToDeliver(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmDelivery timestamp,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockToDeliver
SET 
decQtyToDeliver = decQtyToDeliver + p_decQty

WHERE 
szProductId = p_szProductId and
szLocationType = p_szLocationType and
	szLocationId = p_szLocationId and
	dtmDelivery = p_dtmDelivery;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_IncrStockToReceive(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmReceive timestamp,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockToReceive
SET 
decQtyToReceive = decQtyToReceive + p_decQty

WHERE 
szProductId = p_szProductId and
szLocationType = p_szLocationType and
	szLocationId = p_szLocationId and
	dtmReceive = p_dtmReceive;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_IsStockAllocationExist(
p_szProductId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_dtmExpired timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decAllocatedQty


FROM 
BOS_INV_StockAllocation

WHERE 
szProductId = p_szProductId and szWorkplaceId = p_szWorkplaceId AND dtmExpired = p_dtmExpired ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_IsStockExist(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decQtyOnHand 

FROM 
BOS_INV_Stock 
WHERE 
szProductId = p_szProductId and szLocationType = p_szLocationType and szLocationId = p_szLocationId and szStockTypeId = p_szStockTypeId and szReportedAsType = p_szReportedAsType and szReportedAsId = p_szReportedAsId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_IsStockHistoryExist(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_dtmTransaction timestamp,
p_gdHistoryId bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
--Any short field
BOS_INV_StockHistory.shOrder

FROM 
BOS_INV_StockHistory
WHERE 
BOS_INV_StockHistory.szProductId = p_szProductId AND BOS_INV_StockHistory.szProductId like p_szProductId AND BOS_INV_StockHistory.szLocationType like p_szLocationType AND BOS_INV_StockHistory.szLocationId like p_szLocationId AND BOS_INV_StockHistory.szStockTypeId like p_szStockTypeId AND BOS_INV_StockHistory.szReportedAsType like p_szReportedAsType AND BOS_INV_StockHistory.szReportedAsId like p_szReportedAsId  AND BOS_INV_StockHistory.dtmTransaction = p_dtmTransaction AND gdHistoryId = p_gdHistoryId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_IsStockSNExist(
p_szProductSn BOS_DT_szSN,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shQty


FROM 
BOS_INV_StockSN

WHERE 
szProductSN = p_szProductSN AND szLocationType = p_szLocationType and szLocationId = p_szLocationId and szStockTypeId = p_szStockTypeId and szReportedAsType = p_szReportedAsType and szReportedAsId = p_szReportedAsId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_IsStockSnProductExist(
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId

FROM 
BOS_INV_StockSnProduct
WHERE 
szProductSN = p_szProductSN ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_IsStockToDeliverExist(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmDelivery timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decQtyToDeliver


FROM 
BOS_INV_StockToDeliver

WHERE 
szProductId = p_szProductId and szLocationType = p_szLocationType and szLocationId = p_szLocationId and (dtmDelivery >= p_dtmDelivery and dtmDelivery < dateadd(day, 1, p_dtmDelivery)) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_IsStockToReceiveExist(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmReceive timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decQtyToReceive


FROM 
BOS_INV_StockToReceive

WHERE 
szProductId = p_szProductId and szLocationType = p_szLocationType and szLocationId = p_szLocationId and (dtmReceive >= p_dtmReceive and dtmReceive < dateadd(day, 1, p_dtmReceive)) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_IsStockTypeExist(
p_szStockTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szStockTypeId

FROM 
BOS_INV_StockType
WHERE 
szStockTypeId = p_szStockTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_JustGetStock(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_Stock.szProductId,
BOS_INV_Product.szName AS szProductNm,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
BOS_INV_Product.szUomId as szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Stock.decQtyOnHand,

BOS_INV_Stock.dtmLastUpdated,
BOS_INV_Stock.bAlreadyTransferred
,BOS_INV_Stock.bFreeze

FROM 
BOS_INV_Stock
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_Stock.szProductIdLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_Stock.szProductId

WHERE 
BOS_INV_Stock.szProductId = p_szProductId AND BOS_INV_Stock.szLocationType = p_szLocationType AND BOS_INV_Stock.szLocationId = p_szLocationId AND BOS_INV_Stock.szStockTypeId = p_szStockTypeId AND BOS_INV_Stock.szReportedAsType = p_szReportedAsType AND BOS_INV_Stock.szReportedAsId = p_szReportedAsId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_JustGetStock_013(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_Stock.szProductId,
BOS_INV_Product.szName AS szProductNm,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szTrackingType AS szProductTrackingType,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Stock.decQtyOnHand,

BOS_INV_Stock.dtmLastUpdated,
BOS_INV_Stock.bAlreadyTransferred
,BOS_INV_Stock.bFreeze
,BOS_INV_Stock.szDistProductId
,BOS_INV_Stock.decDistQtyOnHand

FROM 
BOS_INV_Stock
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_Stock.szProductIdLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_Stock.szProductId

WHERE 
BOS_INV_Stock.szProductId = p_szProductId AND BOS_INV_Stock.szLocationType = p_szLocationType AND BOS_INV_Stock.szLocationId = p_szLocationId AND BOS_INV_Stock.szStockTypeId = p_szStockTypeId AND BOS_INV_Stock.szReportedAsType = p_szReportedAsType AND BOS_INV_Stock.szReportedAsId = p_szReportedAsId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_JustGetStockAllocation(
p_szProductId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_dtmExpired timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decAllocatedQty,
dtmLastUpdated

FROM 
BOS_INV_StockAllocation
WHERE 
BOS_INV_StockAllocation.szProductId = p_szProductId and BOS_INV_StockAllocation.szWorkplaceId = p_szWorkplaceId and BOS_INV_StockAllocation.dtmExpired = p_dtmExpired; 
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_LockStock(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Stock
SET 
decQtyOnHand = decQtyOnHand

WHERE 
--There's no obvious reason to lock the all or more than one products, so do not use 'LIKE'.;
szProductId = p_szProductId and
	szLocationType = p_szLocationType and
	szLocationId = p_szLocationId and
	szStockTypeId = p_szStockTypeId and
	szReportedAsType = p_szReportedAsType and
	szReportedAsId = p_szReportedAsId;
	
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_LockStockAllocation(
p_szProductId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_dtmDate timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockAllocation
SET 
decAllocatedQty = decAllocatedQty


WHERE 
BOS_INV_StockAllocation.szProductId = p_szProductId and
BOS_INV_StockAllocation.szWorkplaceId = p_szWorkplaceId and
	BOS_INV_StockAllocation.dtmExpired >= p_dtmDate;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_LockStockSN(
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockSN
SET 
shQty = shQty
WHERE 
szProductSN = p_szProductSN;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_LockStockToDeliver(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmDelivery timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockToDeliver
SET 
decQtyToDeliver = decQtyToDeliver

WHERE 
szProductId = p_szProductId and
szLocationType = p_szLocationType and
	szLocationId = p_szLocationId and
	(dtmDelivery >= p_dtmDelivery and dtmDelivery < dateadd(day, 1, p_dtmDelivery));

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_LockStockToReceive(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmReceive timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockToReceive
SET 
decQtyToReceive = decQtyToReceive

WHERE 
szProductId = p_szProductId and
szLocationType = p_szLocationType and
	szLocationId = p_szLocationId and
	(dtmReceive >= p_dtmReceive and dtmReceive < dateadd(day, 1, p_dtmReceive))

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_LockStockType(
p_szStockTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockType
SET 
bAvailableForSales = bAvailableForSales

WHERE 
szStockTypeId = p_szStockTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_UpdateStock(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_szReportedAsType BOS_DT_szSmallId,
p_szReportedAsId BOS_DT_szId,
p_decQtyOnHand BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Stock
SET 
decQtyOnHand = p_decQtyOnHand
WHERE 
szProductId = p_szProductId and
szLocationType = p_szLocationType and
	szLocationId = p_szLocationId and
	szStockTypeId = p_szStockTypeId and
	szReportedAsType = p_szReportedAsType and
	szReportedAsId = p_szReportedAsId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_UpdateStockAllocation(
p_szProductId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_dtmExpired timestamp,
p_decAllocatedQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockAllocation
SET 
decAllocatedQty = p_decAllocatedQty,
decWpAllocatedQty = p_decAllocatedQty

WHERE 
szProductId = p_szProductId AND
 szWorkplaceId = p_szWorkplaceId AND  
 dtmExpired = p_dtmExpired;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_UpdateStockSnProduct(
p_szProductSn BOS_DT_szSN,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockSnProduct
SET 
szProductId=p_szProductId,
iSyncTransferStatus=0
WHERE 
szProductSN=p_szProductSN;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_UpdateStockSnProduct_014(
p_szProductSn BOS_DT_szSN,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockSnProduct
SET 
szProductId=p_szProductId,
iSyncTransferStatus=0
WHERE 
szProductSN=p_szProductSN;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_UpdateStockSnProductWStockSnProductInfo(
p_szProductSn BOS_DT_szSN,
p_szProductId BOS_DT_szId,
p_dtmLastChecked timestamp,
p_szSuppId BOS_DT_szId,
p_szCheckerId BOS_DT_szId,
p_szChassisNumber BOS_DT_szMediumName)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockSnProduct
SET 
szProductId=p_szProductId,
dtmLastChecked=p_dtmLastChecked,
szSuppId=p_szSuppId,
szCheckerId=p_szCheckerId,
szChassisNumber=p_szChassisNumber,
iSyncTransferStatus=0
WHERE 
szProductSN=p_szProductSN;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_UpdateStockSnProductWStockSnProductInfo_014(
p_szProductSn BOS_DT_szSN,
p_szProductId BOS_DT_szId,
p_dtmLastChecked timestamp,
p_szSuppId BOS_DT_szId,
p_szCheckerId BOS_DT_szId,
p_szChassisNumber BOS_DT_szMediumName)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockSnProduct
SET 
szProductId=p_szProductId,
dtmLastChecked=p_dtmLastChecked,
szSuppId=p_szSuppId,
szCheckerId=p_szCheckerId,
szChassisNumber=p_szChassisNumber,
iSyncTransferStatus=0
WHERE 
szProductSN=p_szProductSN;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_UpdateStockToDeliver(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmDelivery timestamp,
p_decQtyToDeliver BOS_DT_decAmount,
p_decQtyDelivered BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockToDeliver
SET 
decQtyToDeliver = p_decQtyToDeliver,
decQtyDelivered = p_decQtyDelivered

WHERE 
szProductId = p_szProductId and
szLocationType = p_szLocationType and
	szLocationId = p_szLocationId and
	(dtmDelivery >= p_dtmDelivery and dtmDelivery < dateadd(day, 1, p_dtmDelivery))

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_UpdateStockToReceive(
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_dtmReceive timestamp,
p_decQtyToReceive BOS_DT_decAmount,
p_decQtyReceived BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockToReceive
SET 
decQtyToReceive = p_decQtyToReceive,
decQtyReceived = p_decQtyReceived

WHERE 
szProductId = p_szProductId and
szLocationType = p_szLocationType and
	szLocationId = p_szLocationId and
	(dtmReceive >= p_dtmReceive and dtmReceive < dateadd(day, 1, p_dtmReceive));

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Stock_UpdateStockType(
p_szStockTypeId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bAvailableForSales smallint)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockType
SET 
szDescription = p_szDescription,
bAvailableForSales = p_bAvailableForSales

WHERE 
szStockTypeId = p_szStockTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_StockHistory_GetStockCardHeader(
p_szWorkplaceId varchar,
p_szWarehouseId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szLocationIdType BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN

SELECT 
ST.szProductId,
ISNULL(PRD.szName,'') as szProductNm,
SUM(ST.decQtyOnHand)-  
ISNULL((
SELECT
SUM(decQty)
FROM
BOS_INV_StockHistory
WHERE
szLocationType=p_szLocationIdType AND
szLocationId Like p_szWarehouseId AND
szProductId = p_szProductId AND
dtmTransaction>=p_dtmFrom),0) as decBegBalance,
SUM(ST.decQtyOnHand)-  
ISNULL((
SELECT
SUM(decQty)
FROM
BOS_INV_StockHistory
WHERE
szLocationType='WAR' AND
szLocationId Like p_szWarehouseId AND
szProductId = p_szProductId AND
dtmTransaction>p_dtmTo + 1),0) as decEndBalance,
ISNULL((
SELECT
SUM(decQty)
FROM
BOS_INV_StockHistory
WHERE
(szStockTransferReason='COR' OR
szStockTransferReason='MOR' OR
szStockTransferReason='IQU' OR
szStockTransferReason='REJ') AND
szLocationType='WAR' AND
szLocationId Like p_szWarehouseId AND
szProductId = p_szProductId AND
dtmTransaction>=p_dtmFrom AND
dtmTransaction<p_dtmFrom+1),0) as decCorrection
FROM
BOS_INV_Stock AS ST
LEFT JOIN BOS_INV_Product AS PRD ON PRD.szProductId=ST.szProductId
WHERE
ST.szLocationType = 'WAR' AND
ST.szReportedAsType = 'WOR' AND
ST.szLocationId = p_szWarehouseId AND
ST.szReportedAsId = p_szWorkplaceId AND
ST.szProductId LIKE p_szProductId

GROUP BY
ST.szProductId,
PRD.szName
ORDER BY
ST.szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_StockHistory_GetStockCardHeader_014(
p_szWorkplaceId varchar,
p_szWarehouseId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szLocationIdType BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN

SELECT 
ST.szProductId,
ISNULL(PRD.szName,'') as szProductNm,
SUM(ST.decQtyOnHand)-  
ISNULL((
SELECT
SUM(decQty)
FROM
BOS_INV_StockHistory
WHERE
szLocationType=p_szLocationIdType AND
szLocationId Like p_szWarehouseId AND
szProductId = p_szProductId AND
dtmTransaction>=p_dtmFrom),0) as decBegBalance,
SUM(ST.decQtyOnHand)-  
ISNULL((
SELECT
SUM(decQty)
FROM
BOS_INV_StockHistory
WHERE
szLocationType='WAR' AND
szLocationId Like p_szWarehouseId AND
szProductId = p_szProductId AND
dtmTransaction>p_dtmTo + 1),0) as decEndBalance,
ISNULL((
SELECT
SUM(decQty)
FROM
BOS_INV_StockHistory
WHERE
(szStockTransferReason='COR' OR
szStockTransferReason='MOR' OR
szStockTransferReason='IQU' OR
szStockTransferReason='REJ') AND
szLocationType='WAR' AND
szLocationId Like p_szWarehouseId AND
szProductId = p_szProductId AND
dtmTransaction>=p_dtmFrom AND
dtmTransaction<p_dtmFrom+1),0) as decCorrection
FROM
BOS_INV_Stock AS ST
LEFT JOIN BOS_INV_Product AS PRD ON PRD.szProductId=ST.szProductId
WHERE
ST.szLocationType = 'WAR' AND
ST.szReportedAsType = 'WOR' AND
ST.szLocationId = p_szWarehouseId AND
ST.szReportedAsId = p_szWorkplaceId AND
ST.szProductId LIKE p_szProductId
GROUP BY
ST.szProductId,
PRD.szName
ORDER BY
ST.szProductId;


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_StockHistory_GetStockCardItem(
p_szWorkplaceId BOS_DT_szId,
p_szWarehouseId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szLocationType BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
SH.szDocId,
SH.szTrnId,
SH.szStockTypeId,
dbo.KGenReturnDateNoTime(dtmTransaction) as dtmDate,
SH.szPartyId,
ISNULL(WAR.szName,ISNULL(VEH.szPoliceNo,ISNULL(WP.szName,ISNULL(SP.szName,ISNULL(CUST.szName,''))))) as szPartyName,
SH.szRefDocId as szReffno,
ISNULL((
SELECT
SUM(decQty)
FROM
BOS_INV_StockHistory 
WHERE
decQty > 0 AND
szDocId = SH.szDocId AND
szTrnId = SH.szTrnId AND
szLocationType = SH.szLocationType AND
szLocationId LIKE SH.szLocationId AND
szProductId = SH.szProductId AND
dtmTransaction = SH.dtmTransaction), 0) As decIn,
ISNULL(ABS((
SELECT
SUM(decQty)
FROM
BOS_INV_StockHistory 
WHERE
decQty < 0 AND
szDocId = SH.szDocId AND
szTrnId = SH.szTrnId AND
szLocationType = SH.szLocationType AND
szLocationId LIKE SH.szLocationId AND
szProductId = SH.szProductId AND
dtmTransaction = SH.dtmTransaction)), 0) As decOut
FROM
BOS_INV_StockHistory as SH
LEFT JOIN BOS_GL_Workplace AS WP ON WP.szWorkplaceId=SH.szLocationId
LEFT JOIN BOS_AP_Supplier AS SP ON SP.szSuppId=SH.szLocationId
LEFT JOIN BOS_AR_Customer AS CUST ON CUST.szCustId=SH.szLocationId
LEFT JOIN BOS_INV_Vehicle AS VEH ON VEH.szVehicleId=SH.szLocationId
LEFT JOIN BOS_INV_Warehouse AS WAR ON WAR.szWarehouseId=SH.szLocationId
WHERE
SH.szReportedAsType='WOR' AND
SH.szLocationType = p_szLocationType AND
SH.dtmTransaction>=p_dtmFrom AND 
SH.dtmTransaction<p_dtmTo + 1 AND
SH.szLocationId LIKE p_szWarehouseId AND
SH.szReportedAsId = p_szWorkplaceId AND
SH.szProductId LIKE p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_StockHistory_GetStockCardItem_014(
p_szWorkplaceId BOS_DT_szId,
p_szWarehouseId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szLocationType BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
SH.szDocId,
SH.szTrnId,
SH.szStockTypeId,
dbo.KGenReturnDateNoTime(dtmTransaction) as dtmDate,
SH.szPartyId,
ISNULL(WAR.szName,ISNULL(VEH.szPoliceNo,ISNULL(WP.szName,ISNULL(SP.szName,ISNULL(CUST.szName,''))))) as szPartyName,
SH.szRefDocId as szReffno,
ISNULL((
SELECT
SUM(decQty)
FROM
BOS_INV_StockHistory 
WHERE
decQty > 0 AND
szDocId = SH.szDocId AND
szTrnId = SH.szTrnId AND
szLocationType = SH.szLocationType AND
szLocationId LIKE SH.szLocationId AND
szProductId = SH.szProductId AND
dtmTransaction = SH.dtmTransaction), 0) As decIn,
ISNULL(ABS((
SELECT
SUM(decQty)
FROM
BOS_INV_StockHistory 
WHERE
decQty < 0 AND
szDocId = SH.szDocId AND
szTrnId = SH.szTrnId AND
szLocationType = SH.szLocationType AND
szLocationId LIKE SH.szLocationId AND
szProductId = SH.szProductId AND
dtmTransaction = SH.dtmTransaction)), 0) As decOut
FROM
BOS_INV_StockHistory as SH
LEFT JOIN BOS_GL_Workplace AS WP ON WP.szWorkplaceId=SH.szLocationId
LEFT JOIN BOS_AP_Supplier AS SP ON SP.szSuppId=SH.szLocationId
LEFT JOIN BOS_AR_Customer AS CUST ON CUST.szCustId=SH.szLocationId
LEFT JOIN BOS_INV_Vehicle AS VEH ON VEH.szVehicleId=SH.szLocationId
LEFT JOIN BOS_INV_Warehouse AS WAR ON WAR.szWarehouseId=SH.szLocationId
WHERE
SH.szReportedAsType='WOR' AND
SH.szLocationType = p_szLocationType AND
SH.dtmTransaction>=p_dtmFrom AND 
SH.dtmTransaction<p_dtmTo + 1 AND
SH.szLocationId LIKE p_szWarehouseId AND
SH.szReportedAsId = p_szWorkplaceId AND
SH.szProductId LIKE p_szProductId;


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_StockLot_CreateStockLot(
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szLocationType varchar,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_decQtyOnHand BOS_DT_decAmount,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockLot
(
szLotId,
szProductId,
szLocationType,
szLocationId,
szStockTypeId,
decQtyOnHand,
dtmLastUpdated
)
VALUES
(
p_szLotId,
p_szProductId,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_decQtyOnHand,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_StockLot_CreateStockLotHistory(
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_dtmTransaction timestamp,
p_gdStockHistoryId bytea,
p_shOrder smallint,
p_decQty BOS_DT_decAmount,
p_decDocQty BOS_DT_decAmount,
p_szDocUomId BOS_DT_szMediumId,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szStockTransferReason varchar,
p_szUrl BOS_DT_szUrl,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockLotHistory
(
szLotId,
szProductId,
szLocationType,
szLocationId,
szStockTypeId,
dtmTransaction,
gdStockHistoryId,
shOrder,
decQty,
decDocQty,
szDocUomId,
szTrnId,
szDocId,
szStockTransferReason,
szURL,
dtmLastUpdated
)
VALUES
(
p_szLotId,
p_szProductId,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_dtmTransaction,
p_gdStockHistoryId,
p_shOrder,
p_decQty,
p_decDocQty,
p_szDocUomId,
p_szTrnId,
p_szDocId,
p_szStockTransferReason,
p_szURL,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_StockLot_CreateStockLotHistory_013(
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_dtmTransaction timestamp,
p_gdStockHistoryId bytea,
p_shOrder smallint,
p_decQty BOS_DT_decAmount,
p_decDocQty BOS_DT_decAmount,
p_szDocUomId BOS_DT_szMediumId,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szStockTransferReason varchar,
p_szUrl BOS_DT_szUrl,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_StockLotHistory
(
szLotId,
szProductId,
szLocationType,
szLocationId,
szStockTypeId,
dtmTransaction,
gdStockHistoryId,
shOrder,
decQty,
decDocQty,
szDocUomId,
szTrnId,
szDocId,
szStockTransferReason,
szURL,
dtmLastUpdated
)
VALUES
(
p_szLotId,
p_szProductId,
p_szLocationType,
p_szLocationId,
p_szStockTypeId,
p_dtmTransaction,
p_gdStockHistoryId,
p_shOrder,
p_decQty,
p_decDocQty,
p_szDocUomId,
p_szTrnId,
p_szDocId,
p_szStockTransferReason,
p_szURL,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_StockLot_DeleteStockLot(
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szLocationType varchar,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_INV_StockLot
WHERE
szLotId = p_szLotId andszProductId = p_szProductId andszLocationType = p_szLocationType andszLocationId = p_szLocationId andszStockTypeId = p_szStockTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_StockLot_GetListOfStockLot()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLotId,
	szProductId, 
	szLocationType, 
	szLocationId, 
	szStockTypeId
	
FROM 
BOS_INV_StockLot;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_StockLot_GetStockLot(
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_bGetOnlyAvailableQty bit)
RETURNS void AS
$BODY$
BEGIN

IF p_bGetOnlyAvailableQty = 0 THEN


SELECT
BOS_INV_StockLot.szLotId,
BOS_INV_StockLot.szProductId, 
BOS_INV_StockLot.szLocationType, 
BOS_INV_StockLot.szLocationId, 
BOS_INV_StockLot.szStockTypeId, sum(decQtyOnHand) as decSumOfQtyOnHand,
isnull(BOS_INV_LotInfo.szLotTypeId,"") as szLotTypeId,
isnull(BOS_INV_LotInfo.decLotStrength,0) as decLotStrength,
BOS_INV_LotInfo.dtmExpired,
isnull(BOS_INV_LotInfo.szProductionCode,"") as szProductionCode,
isnull(BOS_INV_LotInfo.szLotStatus,"") as szLotStatus,
isnull(BOS_INV_Product.szName,"") as ProductNm

FROM
BOS_INV_StockLot
LEFT JOIN BOS_INV_LotInfo on BOS_INV_StockLot.szLotId=BOS_INV_LotInfo.szLotId AND BOS_INV_StockLot.szProductId=BOS_INV_LotInfo.szProductId
LEFT JOIN BOS_INV_Product on BOS_INV_StockLot.szProductId=BOS_INV_Product.szProductId

WHERE
BOS_INV_StockLot.szLotId like p_szLotId and
BOS_INV_StockLot.szProductId = p_szProductId and
BOS_INV_StockLot.szLocationType like p_szLocationType and
BOS_INV_StockLot.szLocationId like p_szLocationId and
BOS_INV_StockLot.szStockTypeId like p_szStockTypeId

GROUP BY
BOS_INV_StockLot.szLotId, 
BOS_INV_StockLot.szProductId, 
BOS_INV_StockLot.szLocationType, 
BOS_INV_StockLot.szLocationId, 
BOS_INV_StockLot.szStockTypeId,
BOS_INV_LotInfo.szLotTypeId,
BOS_INV_LotInfo.decLotStrength,
BOS_INV_LotInfo.dtmExpired,
BOS_INV_LotInfo.szProductionCode,
BOS_INV_LotInfo.szLotStatus,
BOS_INV_Product.szName;

ELSE

SELECT
BOS_INV_StockLot.szLotId,
BOS_INV_StockLot.szProductId, 
BOS_INV_StockLot.szLocationType, 
BOS_INV_StockLot.szLocationId, 
BOS_INV_StockLot.szStockTypeId, sum(decQtyOnHand) as decSumOfQtyOnHand,
isnull(BOS_INV_LotInfo.szLotTypeId,"") as szLotTypeId,
isnull(BOS_INV_LotInfo.decLotStrength,0) as decLotStrength,
BOS_INV_LotInfo.dtmExpired,
isnull(BOS_INV_LotInfo.szProductionCode,"") as szProductionCode,
isnull(BOS_INV_LotInfo.szLotStatus,"") as szLotStatus,
isnull(BOS_INV_Product.szName,"") as ProductNm

FROM
BOS_INV_StockLot
LEFT JOIN BOS_INV_LotInfo on BOS_INV_StockLot.szLotId=BOS_INV_LotInfo.szLotId AND BOS_INV_StockLot.szProductId=BOS_INV_LotInfo.szProductId
LEFT JOIN BOS_INV_Product on BOS_INV_StockLot.szProductId=BOS_INV_Product.szProductId

WHERE
BOS_INV_StockLot.szLotId like p_szLotId and
BOS_INV_StockLot.szProductId = p_szProductId and
BOS_INV_StockLot.szLocationType like p_szLocationType and
BOS_INV_StockLot.szLocationId like p_szLocationId and
BOS_INV_StockLot.szStockTypeId like p_szStockTypeId AND
BOS_INV_StockLot.decQtyOnHand > 0	
--bGetOnlyAvailableQty = 1

GROUP BY
BOS_INV_StockLot.szLotId, 
BOS_INV_StockLot.szProductId, 
BOS_INV_StockLot.szLocationType, 
BOS_INV_StockLot.szLocationId, 
BOS_INV_StockLot.szStockTypeId,
BOS_INV_LotInfo.szLotTypeId,
BOS_INV_LotInfo.decLotStrength,
BOS_INV_LotInfo.dtmExpired,
BOS_INV_LotInfo.szProductionCode,
BOS_INV_LotInfo.szLotStatus,
BOS_INV_Product.szName;

END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_StockLot_GetStockLot_013(
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_bGetOnlyAvailableQty bit)
RETURNS void AS
$BODY$
BEGIN

IF p_bGetOnlyAvailableQty = 0  
  THEN

SELECT  
BOS_INV_StockLot.szLotId,  
BOS_INV_StockLot.szProductId,   
BOS_INV_StockLot.szLocationType,   
BOS_INV_StockLot.szLocationId,   
BOS_INV_StockLot.szStockTypeId, sum(decQtyOnHand) as decSumOfQtyOnHand,  
isnull(BOS_INV_LotInfo.szLotTypeId,'') as szLotTypeId,  
isnull(BOS_INV_LotInfo.decLotStrength,0) as decLotStrength,  
BOS_INV_LotInfo.dtmExpired,  
isnull(BOS_INV_LotInfo.szProductionCode,'') as szProductionCode,  
isnull(BOS_INV_LotInfo.szLotStatus,'') as szLotStatus,  
isnull(BOS_INV_Product.szName,'') as ProductNm  

FROM  
BOS_INV_StockLot  
LEFT JOIN BOS_INV_LotInfo on BOS_INV_StockLot.szLotId=BOS_INV_LotInfo.szLotId AND BOS_INV_StockLot.szProductId=BOS_INV_LotInfo.szProductId  
LEFT JOIN BOS_INV_Product on BOS_INV_StockLot.szProductId=BOS_INV_Product.szProductId  

WHERE  
BOS_INV_StockLot.szLotId like p_szLotId and  
BOS_INV_StockLot.szProductId = p_szProductId and  
BOS_INV_StockLot.szLocationType like p_szLocationType and  
BOS_INV_StockLot.szLocationId like p_szLocationId and  
BOS_INV_StockLot.szStockTypeId like p_szStockTypeId  

GROUP BY  
BOS_INV_StockLot.szLotId,   
BOS_INV_StockLot.szProductId,   
BOS_INV_StockLot.szLocationType,   
BOS_INV_StockLot.szLocationId,   
BOS_INV_StockLot.szStockTypeId,  
BOS_INV_LotInfo.szLotTypeId,  
BOS_INV_LotInfo.decLotStrength,  
BOS_INV_LotInfo.dtmExpired,  
BOS_INV_LotInfo.szProductionCode,  
BOS_INV_LotInfo.szLotStatus,  
BOS_INV_Product.szName;  

ELSE  

SELECT  
BOS_INV_StockLot.szLotId,  
BOS_INV_StockLot.szProductId,   
BOS_INV_StockLot.szLocationType,   
BOS_INV_StockLot.szLocationId,   
BOS_INV_StockLot.szStockTypeId, sum(decQtyOnHand) as decSumOfQtyOnHand,  
isnull(BOS_INV_LotInfo.szLotTypeId,'') as szLotTypeId,  
isnull(BOS_INV_LotInfo.decLotStrength,0) as decLotStrength,  
BOS_INV_LotInfo.dtmExpired,  
isnull(BOS_INV_LotInfo.szProductionCode,'') as szProductionCode,  
isnull(BOS_INV_LotInfo.szLotStatus,'') as szLotStatus,  
isnull(BOS_INV_Product.szName,'') as ProductNm  

FROM  
BOS_INV_StockLot  
LEFT JOIN BOS_INV_LotInfo on BOS_INV_StockLot.szLotId=BOS_INV_LotInfo.szLotId AND BOS_INV_StockLot.szProductId=BOS_INV_LotInfo.szProductId  
LEFT JOIN BOS_INV_Product on BOS_INV_StockLot.szProductId=BOS_INV_Product.szProductId  

WHERE  
BOS_INV_StockLot.szLotId like p_szLotId and  
BOS_INV_StockLot.szProductId = p_szProductId and  
BOS_INV_StockLot.szLocationType like p_szLocationType and  
BOS_INV_StockLot.szLocationId like p_szLocationId and  
BOS_INV_StockLot.szStockTypeId like p_szStockTypeId AND  
BOS_INV_StockLot.decQtyOnHand > 0    --bGetOnlyAvailableQty = 1  

GROUP BY  
BOS_INV_StockLot.szLotId,   
BOS_INV_StockLot.szProductId,   
BOS_INV_StockLot.szLocationType,   
BOS_INV_StockLot.szLocationId,   
BOS_INV_StockLot.szStockTypeId,  
BOS_INV_LotInfo.szLotTypeId,  
BOS_INV_LotInfo.decLotStrength,  
BOS_INV_LotInfo.dtmExpired,  
BOS_INV_LotInfo.szProductionCode,  
BOS_INV_LotInfo.szLotStatus,  
BOS_INV_Product.szName;

END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_StockLot_IncrStockLot(
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_decQtyIncr BOS_DT_decAmount,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockLot
SET 
decQtyOnHand = decQtyOnHand + p_decQtyIncr,
dtmLastUpdated = p_dtmLastUpdated

WHERE 
szLotId = p_szLotId and
szProductId = p_szProductId and    
 szLocationType = p_szLocationType and    
 szLocationId = p_szLocationId and    
 szStockTypeId = p_szStockTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_StockLot_IncrStockLot_013(
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_decQtyIncr BOS_DT_decAmount,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockLot
SET 
decQtyOnHand = decQtyOnHand + p_decQtyIncr,
dtmLastUpdated = p_dtmLastUpdated

WHERE 
szLotId = p_szLotId and
 szProductId = p_szProductId and    
 szLocationType = p_szLocationType and    
 szLocationId = p_szLocationId and    
 szStockTypeId = p_szStockTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_StockLot_IsStockLotExist(
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szLocationType varchar,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decQtyOnHand 

FROM 
BOS_INV_StockLot 
WHERE 
szLotId = p_szLotId and szProductId = p_szProductId and szLocationType = p_szLocationType and szLocationId = p_szLocationId and szStockTypeId = p_szStockTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_StockLot_LockStockLot(
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szLocationType BOS_DT_szSmallId,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockLot
SET 
decQtyOnHand = decQtyOnHand
WHERE 
szLotId = p_szLotId and
szProductId = p_szProductId and
	szLocationType = p_szLocationType and
	szLocationId = p_szLocationId and
	szStockTypeId = p_szStockTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_StockLot_UpdateStockLot(
p_szLotId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szLocationType varchar,
p_szLocationId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_decQtyOnHand BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_StockLot
SET 
decQtyOnHand = p_decQtyOnHand
WHERE 
szLotId= p_szLotId and
szProductId = p_szProductId and
	szLocationType = p_szLocationType and
	szLocationId = p_szLocationId and
	szStockTypeId = p_szStockTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_SuggestionType_GetListOfSuggestionType()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szSuggestionTypeId, szDescription 

FROM 
 BOS_INV_SuggestionType; 

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Uom_CreateUom(
p_szUomClassId BOS_DT_szMediumId,
p_szUomId BOS_DT_szMediumId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_Uom
(
szUomClassId,
szUomId,
bLock,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szUomClassId,
p_szUomId,
0,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Uom_CreateUomItem(
p_szUomClassId BOS_DT_szMediumId,
p_szUomId BOS_DT_szMediumId,
p_szToUomClassId BOS_DT_szMediumId,
p_szToUomId BOS_DT_szMediumId,
p_decValue BOS_DT_decUomConv)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_UomConversion
(
szUomClassId,
szUomId,
szToUomClassId,
szToUomId,
decValue
)
VALUES
(
p_szUomClassId,
p_szUomId,
p_szToUomClassId,
p_szToUomId,
p_decValue
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Uom_DeleteUom(
p_szUomClassId BOS_DT_szMediumId,
p_szUomId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_INV_Uom
WHERE
szUomClassId = p_szUomClassId ANDszUomId = p_szUomId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Uom_DeleteUomItem(
p_szUomClassId BOS_DT_szMediumId,
p_szUomId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_INV_UomConversion
WHERE
szUomClassId = p_szUomClassId ANDszUomId = p_szUomId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Uom_GetListOfUom(
p_szUomClassId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szUomId

FROM 
BOS_INV_Uom
WHERE 
szUomClassId = p_szUomClassId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Uom_GetUom(
p_szUomClassId BOS_DT_szMediumId,
p_szUomId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szUomClassId,
szUomId,
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_INV_Uom
WHERE 
szUomClassId = p_szUomClassId AND szUomId = p_szUomId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Uom_GetUomConversion(
p_szFrUomClassId BOS_DT_szMediumId,
p_szFrUomId BOS_DT_szMediumId,
p_szToUomClassId BOS_DT_szMediumId,
p_szToUomId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decValue

FROM 
BOS_INV_UomConversion
WHERE 
szUomClassId = p_szFrUomClassId AND szUomId = p_szFrUomId AND szToUomClassId = p_szToUomClassId AND szToUomId = p_szToUomId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Uom_GetUomItem(
p_szUomClassId BOS_DT_szMediumId,
p_szUomId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
--Now we support reverse conversion that we must also return the "from" UOM.
szUomClassId,
szUomId,
szToUomClassId,
szToUomId,
decValue

FROM 
BOS_INV_UomConversion
WHERE 
(szUomClassId = p_szUomClassId AND szUomId = p_szUomId) OR (szToUomClassId = p_szUomClassId AND szToUomId = p_szUomId) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Uom_IsUomExist(
p_szUomClassId BOS_DT_szMediumId,
p_szUomId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szUomClassId,
szUomId

FROM 
BOS_INV_Uom
WHERE 
szUomClassId = p_szUomClassId AND szUomId = p_szUomId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Uom_LockUom(
p_szUomClassId BOS_DT_szMediumId,
p_szUomId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Uom
SET 
bLock=bLock
WHERE 
szUomClassId = p_szUomClassId AND
szUomId = p_szUomId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_UomClass_CreateUomClass(
p_szUomClassId BOS_DT_szMediumId,
p_szDescription BOS_DT_szBigDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_UomClass
(
szUomClassId,
szDescription,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szUomClassId,
p_szDescription,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_UomClass_DeleteUomClass(
p_szUomClassId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_INV_UomClass
WHERE
 szUomClassId = p_szUomClassId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_UomClass_GetListOfUomClass()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szUomClassId, szDescription 

FROM 
BOS_INV_UomClass 

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_UomClass_GetUomClass(
p_szUomClassId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription, dtmLastUpdated, bAlreadyTransferred 

FROM 
BOS_INV_UomClass 
WHERE 
 szUomClassId = p_szUomClassId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_UomClass_IsUomClassExist(
p_szUomClassId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription 

FROM 
BOS_INV_UomClass 
WHERE 
 szUomClassId = p_szUomClassId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_UomClass_LockUomClass(
p_szUomClassId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_UomClass
SET 
 szDescription = szDescription
WHERE 
 szUomClassId = p_szUomClassId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_UomClass_UpdateUomClass(
p_szUomClassId BOS_DT_szMediumId,
p_szDescription BOS_DT_szBigDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_UomClass
SET 
 szDescription = p_szDescription
WHERE 
 szUomClassId = p_szUomClassId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Vehicle_CreateVehicle(
p_szVehicleId BOS_DT_szId,
p_szPoliceNo BOS_DT_szSmallName,
p_szChassisNo BOS_DT_szMediumName,
p_szMachineNo BOS_DT_szMediumName,
p_szVehicleCapacityId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_bActive BOS_DT_bBoolean,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_Vehicle
(
szVehicleId,
szPoliceNo,
szChassisNo,
szMachineNo,
szVehicleCapacityId,
szWorkplaceId,
bActive,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szVehicleId,
p_szPoliceNo,
p_szChassisNo,
p_szMachineNo,
p_szVehicleCapacityId,
p_szWorkplaceId,
p_bActive,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Vehicle_CreateVehicle_013(
p_szVehicleId BOS_DT_szId,
p_szPoliceNo BOS_DT_szSmallName,
p_szChassisNo BOS_DT_szMediumName,
p_szMachineNo BOS_DT_szMediumName,
p_szVehicleCapacityId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_bActive BOS_DT_bBoolean,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_Vehicle
(
szVehicleId,
szPoliceNo,
szChassisNo,
szMachineNo,
szVehicleCapacityId,
szWorkplaceId,
bActive,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szVehicleId,
p_szPoliceNo,
p_szChassisNo,
p_szMachineNo,
p_szVehicleCapacityId,
p_szWorkplaceId,
p_bActive,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Vehicle_DeleteVehicle(
p_szVehicleId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Vehicle_GetActiveVehicle(
p_szVehicleId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
bActive

FROM 
BOS_INV_VEHICLE
WHERE 
 szVehicleId = p_szVehicleId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Vehicle_GetListOfVehicle()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szVehicleId,
szPoliceNo

FROM 
BOS_INV_Vehicle;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Vehicle_GetVehicle(
p_szVehicleId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
TBL_VEC.szPoliceNo,
TBL_VEC.szChassisNo,
TBL_VEC.szMachineNo,
TBL_VEC.szVehicleCapacityId,
TBL_VEC.szWorkplaceId,
TBL_VEC.bActive,
TBL_CAP.decMaxWeight As decCapMaxWeight_J,
TBL_CAP.szWeightUomId As szCapWeightUomId_J,
TBL_CAP.decMaxVolume As decCapMaxVolume_J,
TBL_CAP.szVolumeUomId As szCapVolumeUomId_J,
TBL_VEC.dtmLastUpdated,
TBL_VEC.bAlreadyTransferred

FROM 
BOS_INV_Vehicle As TBL_VEC
LEFT JOIN BOS_INV_VehicleCapacity AS TBL_CAP ON TBL_CAP.szVehicleCapacityId = TBL_VEC.szVehicleCapacityId

WHERE 
szVehicleId = p_szVehicleId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Vehicle_GetVehicle_014(
p_szVehicleId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
TBL_VEC.szPoliceNo,
TBL_VEC.szChassisNo,
TBL_VEC.szMachineNo,
TBL_VEC.szVehicleCapacityId,
TBL_VEC.szWorkplaceId,
TBL_VEC.bActive,
TBL_CAP.decMaxWeight As decCapMaxWeight_J,
TBL_CAP.szWeightUomId As szCapWeightUomId_J,
TBL_CAP.decMaxVolume As decCapMaxVolume_J,
TBL_CAP.szVolumeUomId As szCapVolumeUomId_J,
TBL_VEC.dtmLastUpdated,
TBL_VEC.bAlreadyTransferred

FROM 
BOS_INV_Vehicle As TBL_VEC
LEFT JOIN BOS_INV_VehicleCapacity AS TBL_CAP ON TBL_CAP.szVehicleCapacityId = TBL_VEC.szVehicleCapacityId

WHERE 
szVehicleId = p_szVehicleId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Vehicle_IsVehicleExist(
p_szVehicleId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
 szPoliceNo, 
  szChassisNo, 
  szMachineNo, 
  szVehicleCapacityId, 
  szWorkplaceId 

FROM 
BOS_INV_Vehicle
WHERE 
 szVehicleId = p_szVehicleId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Vehicle_LockVehicle(
p_szVehicleId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Vehicle
SET 
szPoliceNo = szPoliceNo
WHERE 
 szVehicleId = p_szVehicleId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Vehicle_UpdateVehicle(
p_szVehicleId BOS_DT_szId,
p_szPoliceNo BOS_DT_szSmallName,
p_szChassisNo BOS_DT_szMediumName,
p_szMachineNo BOS_DT_szMediumName,
p_szVehicleCapacityId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_bActive BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Vehicle
SET 
szPoliceNo = p_szPoliceNo,
szChassisNo = p_szChassisNo,
szMachineNo = p_szMachineNo,
szVehicleCapacityId = p_szVehicleCapacityId,
szWorkplaceId = p_szWorkplaceId,
bActive = p_bActive
WHERE 
 szVehicleId = p_szVehicleId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Vehicle_UpdateVehicle_013(
p_szVehicleId BOS_DT_szId,
p_szPoliceNo BOS_DT_szSmallName,
p_szChassisNo BOS_DT_szMediumName,
p_szMachineNo BOS_DT_szMediumName,
p_szVehicleCapacityId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_bActive BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Vehicle
SET 
szPoliceNo = p_szPoliceNo,
szChassisNo = p_szChassisNo,
szMachineNo = p_szMachineNo,
szVehicleCapacityId = p_szVehicleCapacityId,
szWorkplaceId = p_szWorkplaceId,
bActive = p_bActive
WHERE 
 szVehicleId = p_szVehicleId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_VehicleCapacity_CreateVehicleCapacity(
p_szVehicleCapacityId BOS_DT_szMediumId,
p_decMaxWeight BOS_DT_decAmount,
p_decMaxVolume BOS_DT_decAmount,
p_szWeightUomId BOS_DT_szId,
p_szVolumeUomId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_VehicleCapacity
(
szVehicleCapacityId,
decMaxWeight,
decMaxVolume,
szWeightUomId,
szVolumeUomId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szVehicleCapacityId,
p_decMaxWeight,
p_decMaxVolume,
p_szWeightUomId,
p_szVolumeUomId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_VehicleCapacity_DeleteVehicleCapacity(
p_szVehicleCapacityId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
DELETE FROM BOS_INV_VehicleCapacity
WHERE szVehicleCapacityId = p_szVehicleCapacityId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_VehicleCapacity_GetListOfVehicleCapacity()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szVehicleCapacityId

FROM 
BOS_INV_VehicleCapacity;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_VehicleCapacity_GetVehicleCapacity(
p_szVehicleCapacityId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decMaxWeight,
decMaxVolume,
	szWeightUomId,
	szVolumeUomId,
	dtmLastUpdated,
	bAlreadyTransferred
	
FROM 
BOS_INV_VehicleCapacity
WHERE 
 szVehicleCapacityId = p_szVehicleCapacityId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_VehicleCapacity_IsVehicleCapacityExist(
p_szVehicleCapacityId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
decMaxWeight, decMaxVolume 

FROM 
BOS_INV_VehicleCapacity
WHERE 
 szVehicleCapacityId = p_szVehicleCapacityId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_VehicleCapacity_LockVehicleCapacity(
p_szVehicleCapacityId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_VehicleCapacity
SET 
decMaxVolume = decMaxVolume
WHERE 
 szVehicleCapacityId = p_szVehicleCapacityId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_VehicleCapacity_UpdateVehicleCapacity(
p_szVehicleCapacityId BOS_DT_szMediumId,
p_decMaxWeight BOS_DT_decAmount,
p_decMaxVolume BOS_DT_decAmount,
p_szWeightUomId BOS_DT_szId,
p_szVolumeUomId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_VehicleCapacity
SET 
decMaxWeight = p_decMaxWeight,
decMaxVolume = p_decMaxVolume,
szWeightUomId = p_szWeightUomId,
szVolumeUomId = p_szVolumeUomId
WHERE 
 szVehicleCapacityId = p_szVehicleCapacityId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Warehouse_CreateWarehouse(
p_szWarehouseId BOS_DT_szId,
p_szName BOS_DT_szName,
p_WhszContactPerson BOS_DT_szName,
p_WhszRoomNo BOS_DT_szSmallName,
p_WhszFloor BOS_DT_szSmallName,
p_WhszBuilding BOS_DT_szName,
p_WhszAddress_1 BOS_DT_szName,
p_WhszAddress_2 BOS_DT_szName,
p_WhszDistrict BOS_DT_szName,
p_WhszCity BOS_DT_szMediumName,
p_WhszZipCode BOS_DT_szSmallName,
p_WhszState BOS_DT_szMediumName,
p_WhszCountry BOS_DT_szMediumName,
p_WhszPhoneNo_1 BOS_DT_szMediumName,
p_WhszPhoneNo_2 BOS_DT_szMediumName,
p_WhszFaxNo BOS_DT_szMediumName,
p_WhszMobileNo BOS_DT_szMediumName,
p_WhszEmail BOS_DT_szMediumName,
p_WhszWebSite BOS_DT_szMediumName,
p_szWorkplaceId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_Warehouse
(
szWarehouseId,
szName,
WhszContactPerson,
WhszRoomNo,
WhszFloor,
WhszBuilding,
WhszAddress_1,
WhszAddress_2,
WhszDistrict,
WhszCity,
WhszZipCode,
WhszState,
WhszCountry,
WhszPhoneNo_1,
WhszPhoneNo_2,
WhszFaxNo,
WhszMobileNo,
WhszEmail,
WhszWebSite,
szWorkPlaceId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szWarehouseId,
p_szName,
p_WhszContactPerson,
p_WhszRoomNo,
p_WhszFloor,
p_WhszBuilding,
p_WhszAddress_1,
p_WhszAddress_2,
p_WhszDistrict,
p_WhszCity,
p_WhszZipCode,
p_WhszState,
p_WhszCountry,
p_WhszPhoneNo_1,
p_WhszPhoneNo_2,
p_WhszFaxNo,
p_WhszMobileNo,
p_WhszEmail,
p_WhszWebSite,
p_szWorkPlaceId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Warehouse_CreateWarehouseStockType(
p_szWarehouseId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_INV_WarehouseStockType
(
szWarehouseId ,
szStockTypeId
)
VALUES
(
p_szWarehouseId ,
p_szStockTypeId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Warehouse_DeleteWarehouse(
p_szWarehouseId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_INV_Warehouse
WHERE
szWarehouseId=p_szWarehouseId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Warehouse_DeleteWarehouseStockType(
p_szWarehouseId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_INV_WarehouseStockType
WHERE
szWarehouseId=p_szWarehouseId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Warehouse_GetListOfWarehouse()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szWarehouseId,
szName

FROM 
BOS_INV_Warehouse;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Warehouse_GetListOfWarehouseWhereWp(
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szWarehouseId,
szName

FROM 
BOS_INV_Warehouse
WHERE 
szWorkplaceId = p_szWorkplaceId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Warehouse_GetWarehouse(
p_szWarehouseId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szName,
WhszContactPerson,
WhszRoomNo,
WhszFloor,
WhszBuilding,
WhszAddress_1,
WhszAddress_2,
WhszDistrict,
WhszCity,
WhszZipCode,
WhszState,
WhszCountry,
WhszPhoneNo_1,
WhszPhoneNo_2,
WhszFaxNo,
WhszMobileNo,
WhszEmail,
WhszWebSite,
szWorkPlaceId,

dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_INV_Warehouse
WHERE 
szWarehouseId=p_szWarehouseId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Warehouse_GetWarehouseStockType(
p_szWarehouseId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_INV_WarehouseStockType.szStockTypeId,
BOS_INV_StockType.szDescription,
BOS_INV_StockType.bAvailableForSales


FROM 
BOS_INV_WarehouseStockType
LEFT JOIN BOS_INV_StockType ON BOS_INV_StockType.szStockTypeId =LEFT JOIN BOS_INV_StockType ON BOS_INV_StockType.szStockTypeId =;
BOS_INV_WarehouseStockType.szStockTypeId
WHERE 
szWarehouseId = p_szWarehouseId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Warehouse_IsWarehouseExist(
p_szWarehouseId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szWarehouseId

FROM 
BOS_INV_Warehouse
WHERE 
szWarehouseId=p_szWarehouseId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Warehouse_LockWarehouse(
p_szWarehouseId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Warehouse
SET 
szName=szName
WHERE 
szWarehouseId=p_szWarehouseId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_INV_Warehouse_UpdateWarehouse(
p_szWarehouseId BOS_DT_szId,
p_szName BOS_DT_szName,
p_WhszContactPerson BOS_DT_szName,
p_WhszRoomNo BOS_DT_szSmallName,
p_WhszFloor BOS_DT_szSmallName,
p_WhszBuilding BOS_DT_szName,
p_WhszAddress_1 BOS_DT_szName,
p_WhszAddress_2 BOS_DT_szName,
p_WhszDistrict BOS_DT_szName,
p_WhszCity BOS_DT_szMediumName,
p_WhszZipCode BOS_DT_szSmallName,
p_WhszState BOS_DT_szMediumName,
p_WhszCountry BOS_DT_szMediumName,
p_WhszPhoneNo_1 BOS_DT_szMediumName,
p_WhszPhoneNo_2 BOS_DT_szMediumName,
p_WhszFaxNo BOS_DT_szMediumName,
p_WhszMobileNo BOS_DT_szMediumName,
p_WhszEmail BOS_DT_szMediumName,
p_WhszWebSite BOS_DT_szMediumName,
p_szWorkplaceId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_INV_Warehouse
SET 
szName=p_szName,
WhszContactPerson=p_WhszContactPerson,
WhszRoomNo=p_WhszRoomNo,
WhszFloor=p_WhszFloor,
WhszBuilding=p_WhszBuilding,
WhszAddress_1=p_WhszAddress_1,
WhszAddress_2=p_WhszAddress_2,
WhszDistrict=p_WhszDistrict,
WhszCity=p_WhszCity,
WhszZipCode=p_WhszZipCode,
WhszState=p_WhszState,
WhszCountry=p_WhszCountry,
WhszPhoneNo_1=p_WhszPhoneNo_1,
WhszPhoneNo_2=p_WhszPhoneNo_2,
WhszFaxNo=p_WhszFaxNo,
WhszMobileNo=p_WhszMobileNo,
WhszEmail=p_WhszEmail,
WhszWebSite=p_WhszWebSite,
szWorkPlaceId=p_szWorkPlaceId,

dtmLastUpdated = p_dtmLastUpdated,
bAlreadyTransferred = p_bAlreadyTransferred
WHERE 
szWarehouseId=p_szWarehouseId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MKT_FPromo_CreateFPromo(
p_szFPromoId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_szPromoMediaId1 BOS_DT_szId,
p_szPromoMediaId2 BOS_DT_szId,
p_szPromoMediaId3 BOS_DT_szId,
p_szPromoMediaId4 BOS_DT_szId,
p_szPromoMediaId5 BOS_DT_szId,
p_szPromoTypeId1 BOS_DT_szId,
p_szPromoTypeId2 BOS_DT_szId,
p_szPromoTypeId3 BOS_DT_szId,
p_szPromoTypeId4 BOS_DT_szId,
p_szPromoTypeId5 BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_MKT_FPromo
(
szFPromoId,
dtmStart,
dtmEnd,
szPromoMediaId1,
szPromoMediaId2,
szPromoMediaId3,
szPromoMediaId4,
szPromoMediaId5,
szPromoTypeId1,
szPromoTypeId2,
szPromoTypeId3,
szPromoTypeId4,
szPromoTypeId5,
szDescription,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFPromoId ,
p_dtmStart,
p_dtmEnd,
p_szPromoMediaId1,
p_szPromoMediaId2,
p_szPromoMediaId3,
p_szPromoMediaId4,
p_szPromoMediaId5,
p_szPromoTypeId1,
p_szPromoTypeId2,
p_szPromoTypeId3,
p_szPromoTypeId4,
p_szPromoTypeId5,
p_szDescription,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MKT_FPromo_CreateFPromoItem(
p_szFPromoId BOS_DT_szId,
p_shItemNumber smallint,
p_dtmEvent timestamp,
p_decCountOfPerformance BOS_DT_decAmount,
p_decDuration BOS_DT_decAmount,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_MKT_FPromoItem
(
szFPromoId,
shItemNumber,
dtmEvent,
decCountOfPerformance,
decDuration,
szDescription
)
VALUES
(
p_szFPromoId,
p_shItemNumber,
p_dtmEvent,
p_decCountOfPerformance,
p_decDuration,
p_szDescription
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MKT_FPromo_DeleteFPromo(
p_szFPromoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_MKT_FPromo
WHERE
szFPromoId = p_szFPromoId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MKT_FPromo_DeleteFPromoItem(
p_szFPromoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_MKT_FPromoItem
WHERE
szFPromoId = p_szFPromoId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MKT_FPromo_GetFPromo(
p_szFPromoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_MKT_FPromo.dtmStart,
BOS_MKT_FPromo.dtmEnd,
BOS_MKT_FPromo.szPromoMediaId1,
BOS_MKT_FPromo.szPromoMediaId2,
BOS_MKT_FPromo.szPromoMediaId3,
BOS_MKT_FPromo.szPromoMediaId4,
BOS_MKT_FPromo.szPromoMediaId5,
BOS_MKT_FPromo.szPromoTypeId1,
BOS_MKT_FPromo.szPromoTypeId2,
BOS_MKT_FPromo.szPromoTypeId3,
BOS_MKT_FPromo.szPromoTypeId4,
BOS_MKT_FPromo.szPromoTypeId5,
BOS_MKT_FPromo.szDescription,
BOS_MKT_FPromo.bResultFrTransfer,
BOS_MKT_FPromo.bVoid,
BOS_GEN_Approved.bApproved,
BOS_MKT_FPromo.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_MKT_FPromo.btPrintedCount,
BOS_MKT_FPromo.bTransferred,
BOS_MKT_FPromo.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_MKT_FPromo.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_MKT_FPromo.szTaxEntityId,
BOS_MKT_FPromo.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_MKT_FPromo.dtmCreated,
BOS_MKT_FPromo.bSystemCreated,

BOS_MKT_FPromo.dtmLastUpdated,
BOS_MKT_FPromo.bAlreadyTransferred
FROM
BOS_MKT_FPromo
LEFT JOIN BOS_GEN_Approved ON BOS_GEN_Approved.gdApprovedId = BOS_MKT_FPromo.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_GL_FJournalTrans.szFJournalId = BOS_MKT_FPromo.szFJournalId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_MKT_FPromo.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_MKT_FPromo.szWorkplaceId
WHERE
BOS_MKT_FPromo.szFPromoId = p_szFPromoId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MKT_FPromo_GetFPromoItem(
p_szFPromoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
dtmEvent,
decCountOfPerformance,
decDuration,
szDescription

FROM 
BOS_MKT_FPromoItem
WHERE 
BOS_MKT_FPromoItem.szFPromoId = p_szFPromoId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MKT_FPromo_GetListOfFPromo()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFPromoId,
szDescription

FROM 
BOS_MKT_FPromo

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MKT_FPromo_IsFPromoExist(
p_szFPromoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFPromoId

FROM 
BOS_MKT_FPromo
WHERE 
szFPromoId = p_szFPromoId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MKT_FPromo_LockFPromo(
p_szFPromoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_MKT_FPromo
SET 
dtmStart = dtmStart
WHERE 
szFPromoId = p_szFPromoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MKT_FPromo_UpdateFPromo(
p_szFPromoId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_szPromoMediaId1 BOS_DT_szId,
p_szPromoMediaId2 BOS_DT_szId,
p_szPromoMediaId3 BOS_DT_szId,
p_szPromoMediaId4 BOS_DT_szId,
p_szPromoMediaId5 BOS_DT_szId,
p_szPromoTypeId1 BOS_DT_szId,
p_szPromoTypeId2 BOS_DT_szId,
p_szPromoTypeId3 BOS_DT_szId,
p_szPromoTypeId4 BOS_DT_szId,
p_szPromoTypeId5 BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_MKT_FPromo
SET 
dtmStart = p_dtmStart,
dtmEnd = p_dtmEnd,
szPromoMediaId1 = p_szPromoMediaId1,
szPromoMediaId2 = p_szPromoMediaId2,
szPromoMediaId3 = p_szPromoMediaId3,
szPromoMediaId4 = p_szPromoMediaId4,
szPromoMediaId5 = p_szPromoMediaId5,
szPromoTypeId1 = p_szPromoTypeId1,
szPromoTypeId2 = p_szPromoTypeId2,
szPromoTypeId3 = p_szPromoTypeId3,
szPromoTypeId4 = p_szPromoTypeId4,
szPromoTypeId5 = p_szPromoTypeId5,
szDescription = p_szDescription,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId
WHERE 
szFPromoId = p_szFPromoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MKT_PromoViewer_CreatePromoViewer(
p_szPromoViewerId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szDateRange varchar,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_szTimeGranular varchar,
p_szPromoMediaId1 BOS_DT_szId,
p_szPromoMediaId2 BOS_DT_szId,
p_szPromoMediaId3 BOS_DT_szId,
p_szPromoMediaId4 BOS_DT_szId,
p_szPromoMediaId5 BOS_DT_szId,
p_szPromoTypeId1 BOS_DT_szId,
p_szPromoTypeId2 BOS_DT_szId,
p_szPromoTypeId3 BOS_DT_szId,
p_szPromoTypeId4 BOS_DT_szId,
p_szPromoTypeId5 BOS_DT_szId,
p_szSalesOrgId1 BOS_DT_szId,
p_szSalesOrgId2 BOS_DT_szId,
p_szSalesOrgId3 BOS_DT_szId,
p_szSalesOrgId4 BOS_DT_szId,
p_szSalesOrgId5 BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_szDistrChannelId BOS_DT_szId,
p_szCustCategoryId1 BOS_DT_szId,
p_szCustCategoryId2 BOS_DT_szId,
p_szCustCategoryId3 BOS_DT_szId,
p_szCustCategoryId4 BOS_DT_szId,
p_szCustCategoryId5 BOS_DT_szId,
p_szProductCategoryId1 BOS_DT_szId,
p_szProductCategoryId2 BOS_DT_szId,
p_szProductCategoryId3 BOS_DT_szId,
p_szProductCategoryId4 BOS_DT_szId,
p_szProductCategoryId5 BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_MKT_PromoViewer
(
szPromoViewerId,
szDescription,
szDateRange,
dtmStart,
dtmEnd,
szTimeGranular,
szPromoMediaId1,
szPromoMediaId2,
szPromoMediaId3,
szPromoMediaId4,
szPromoMediaId5,
szPromoTypeId1,
szPromoTypeId2,
szPromoTypeId3,
szPromoTypeId4,
szPromoTypeId5,
szSalesOrgId1,
szSalesOrgId2,
szSalesOrgId3,
szSalesOrgId4,
szSalesOrgId5,
szWorkplaceId,
szDistrChannelId,
szCustCategoryId1,
szCustCategoryId2,
szCustCategoryId3,
szCustCategoryId4,
szCustCategoryId5,
szProductCategoryId1,
szProductCategoryId2,
szProductCategoryId3,
szProductCategoryId4,
szProductCategoryId5,
szProductId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szPromoViewerId,
p_szDescription,
p_szDateRange,
p_dtmStart,
p_dtmEnd,
p_szTimeGranular,
p_szPromoMediaId1,
p_szPromoMediaId2,
p_szPromoMediaId3,
p_szPromoMediaId4,
p_szPromoMediaId5,
p_szPromoTypeId1,
p_szPromoTypeId2,
p_szPromoTypeId3,
p_szPromoTypeId4,
p_szPromoTypeId5,
p_szSalesOrgId1,
p_szSalesOrgId2,
p_szSalesOrgId3,
p_szSalesOrgId4,
p_szSalesOrgId5,
p_szWorkplaceId,
p_szDistrChannelId,
p_szCustCategoryId1,
p_szCustCategoryId2,
p_szCustCategoryId3,
p_szCustCategoryId4,
p_szCustCategoryId5,
p_szProductCategoryId1,
p_szProductCategoryId2,
p_szProductCategoryId3,
p_szProductCategoryId4,
p_szProductCategoryId5,
p_szProductId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MKT_PromoViewer_DeletePromoViewer(
p_szPromoViewerId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_MKT_PromoViewer
WHERE
szPromoViewerId = p_szPromoViewerId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MKT_PromoViewer_GetListOfPromoViewer()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPromoViewerId,
szDescription

FROM 
BOS_MKT_PromoViewer;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MKT_PromoViewer_GetPromoViewer(
p_szPromoViewerId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_MKT_PromoViewer.szDescription,
BOS_MKT_PromoViewer.szDateRange,
BOS_MKT_PromoViewer.dtmStart,
BOS_MKT_PromoViewer.dtmEnd,
BOS_MKT_PromoViewer.szTimeGranular,
BOS_MKT_PromoViewer.szPromoMediaId1,
BOS_MKT_PromoViewer.szPromoMediaId2,
BOS_MKT_PromoViewer.szPromoMediaId3,
BOS_MKT_PromoViewer.szPromoMediaId4,
BOS_MKT_PromoViewer.szPromoMediaId5,
BOS_MKT_PromoViewer.szPromoTypeId1,
BOS_MKT_PromoViewer.szPromoTypeId2,
BOS_MKT_PromoViewer.szPromoTypeId3,
BOS_MKT_PromoViewer.szPromoTypeId4,
BOS_MKT_PromoViewer.szPromoTypeId5,
BOS_MKT_PromoViewer.szSalesOrgId1,
BOS_MKT_PromoViewer.szSalesOrgId2,
BOS_MKT_PromoViewer.szSalesOrgId3,
BOS_MKT_PromoViewer.szSalesOrgId4,
BOS_MKT_PromoViewer.szSalesOrgId5,
BOS_MKT_PromoViewer.szWorkplaceId,
BOS_MKT_PromoViewer.szDistrChannelId,
BOS_MKT_PromoViewer.szCustCategoryId1,
BOS_MKT_PromoViewer.szCustCategoryId2,
BOS_MKT_PromoViewer.szCustCategoryId3,
BOS_MKT_PromoViewer.szCustCategoryId4,
BOS_MKT_PromoViewer.szCustCategoryId5,
BOS_MKT_PromoViewer.szProductCategoryId1,
BOS_MKT_PromoViewer.szProductCategoryId2,
BOS_MKT_PromoViewer.szProductCategoryId3,
BOS_MKT_PromoViewer.szProductCategoryId4,
BOS_MKT_PromoViewer.szProductCategoryId5,
BOS_MKT_PromoViewer.szProductId,
BOS_INV_Product.szName as szProductNm,

-- Data Status.
BOS_MKT_PromoViewer.dtmLastUpdated,
BOS_MKT_PromoViewer.bAlreadyTransferred

FROM 
BOS_MKT_PromoViewer
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_MKT_PromoViewer.szProductIdLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_MKT_PromoViewer.szProductId;
WHERE 
BOS_MKT_PromoViewer.szPromoViewerId = p_szPromoViewerId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MKT_PromoViewer_IsPromoViewerExist(
p_szPromoViewerId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPromoViewerId

FROM 
BOS_MKT_PromoViewer
WHERE 
szPromoViewerId = p_szPromoViewerId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MKT_PromoViewer_LockPromoViewer(
p_szPromoViewerId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_MKT_PromoViewer
SET 
dtmStart = dtmStart
WHERE 
szPromoViewerId = p_szPromoViewerId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MKT_PromoViewer_UpdatePromoViewer(
p_szPromoViewerId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szDateRange varchar,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_szTimeGranular varchar,
p_szPromoMediaId1 BOS_DT_szId,
p_szPromoMediaId2 BOS_DT_szId,
p_szPromoMediaId3 BOS_DT_szId,
p_szPromoMediaId4 BOS_DT_szId,
p_szPromoMediaId5 BOS_DT_szId,
p_szPromoTypeId1 BOS_DT_szId,
p_szPromoTypeId2 BOS_DT_szId,
p_szPromoTypeId3 BOS_DT_szId,
p_szPromoTypeId4 BOS_DT_szId,
p_szPromoTypeId5 BOS_DT_szId,
p_szSalesOrgId1 BOS_DT_szId,
p_szSalesOrgId2 BOS_DT_szId,
p_szSalesOrgId3 BOS_DT_szId,
p_szSalesOrgId4 BOS_DT_szId,
p_szSalesOrgId5 BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_szDistrChannelId BOS_DT_szId,
p_szCustCategoryId1 BOS_DT_szId,
p_szCustCategoryId2 BOS_DT_szId,
p_szCustCategoryId3 BOS_DT_szId,
p_szCustCategoryId4 BOS_DT_szId,
p_szCustCategoryId5 BOS_DT_szId,
p_szProductCategoryId1 BOS_DT_szId,
p_szProductCategoryId2 BOS_DT_szId,
p_szProductCategoryId3 BOS_DT_szId,
p_szProductCategoryId4 BOS_DT_szId,
p_szProductCategoryId5 BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_MKT_PromoViewer
SET 
szDescription = p_szDescription,
szDateRange = p_szDateRange,
dtmStart = p_dtmStart,
dtmEnd = p_dtmEnd,
szTimeGranular = p_szTimeGranular,
szPromoMediaId1 = p_szPromoMediaId1,
szPromoMediaId2 = p_szPromoMediaId2,
szPromoMediaId3 = p_szPromoMediaId3,
szPromoMediaId4 = p_szPromoMediaId4,
szPromoMediaId5 = p_szPromoMediaId5,
szPromoTypeId1 = p_szPromoTypeId1,
szPromoTypeId2 = p_szPromoTypeId2,
szPromoTypeId3 = p_szPromoTypeId3,
szPromoTypeId4 = p_szPromoTypeId4,
szPromoTypeId5 = p_szPromoTypeId5,
szSalesOrgId1 = p_szSalesOrgId1,
szSalesOrgId2 = p_szSalesOrgId2,
szSalesOrgId3 = p_szSalesOrgId3,
szSalesOrgId4 = p_szSalesOrgId4,
szSalesOrgId5 = p_szSalesOrgId5,
szWorkplaceId = p_szWorkplaceId,
szDistrChannelId = p_szDistrChannelId,
szCustCategoryId1 = p_szCustCategoryId1,
szCustCategoryId2 = p_szCustCategoryId2,
szCustCategoryId3 = p_szCustCategoryId3,
szCustCategoryId4 = p_szCustCategoryId4,
szCustCategoryId5 = p_szCustCategoryId5,
szProductCategoryId1 = p_szProductCategoryId1,
szProductCategoryId2 = p_szProductCategoryId2,
szProductCategoryId3 = p_szProductCategoryId3,
szProductCategoryId4 = p_szProductCategoryId4,
szProductCategoryId5 = p_szProductCategoryId5,
szProductId = p_szProductId
WHERE 
szPromoViewerId = p_szPromoViewerId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MSI_FieldMapping_Create(
p_szType varchar,
p_szIdFrom varchar,
p_szIdTo varchar)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_MSI_FieldMapping(szType, szIdFrom, szIdTo)
VALUES
(p_szType, p_szIdFrom, p_szIdTo);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MSI_FieldMapping_Delete(
p_szType varchar)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_MSI_FieldMapping
WHERE
     (szType = p_szType);
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_MSI_FieldMapping_GetList(
p_szType varchar,
p_szIdFrom varchar,
p_szIdTo varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
     szType, szIdFrom, szIdTo

FROM 
BOS_MSI_FieldMapping
WHERE 
     (szType = p_szType);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Department_CreateDepartment(
p_szDepartmentId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PI_Department
(szDepartmentId,szName,szDescription)
VALUES
(
p_szDepartmentId,
p_szName,
p_szDescription
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Department_DeleteDepartment(
p_szDepartmentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_PI_Department
WHERE
szDepartmentId=p_szDepartmentId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Department_GetDepartment(
p_szDepartmentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szName,szDescription

FROM 
BOS_PI_Department
WHERE 
szDepartmentId=p_szDepartmentId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Department_GetListOfDepartment()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDepartmentId,
szName,
szDescription

FROM 
BOS_PI_Department

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Department_IsDepartmentExist(
p_szDepartmentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDepartmentId

FROM 
BOS_PI_Department
WHERE 
szDepartmentId=p_szDepartmentId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Department_UpdateDepartment(
p_szDepartmentId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_PI_Department
SET 
szName = p_szName,
szDescription = p_szDescription
WHERE 
szDepartmentId = p_szDepartmentId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Division_CreateDivision(
p_szDivisionId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PI_Division
(
szDivisionId,
szName,
szDescription
)
VALUES
(
p_szDivisionId,
p_szName,
p_szDescription
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Division_DeleteDivision(
p_szDivisionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_PI_Division
WHERE
szDivisionId=p_szDivisionId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Division_GetDivision(
p_szDivisionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szName,szDescription

FROM 
BOS_PI_Division
WHERE 
szDivisionId=p_szDivisionId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Division_GetListOfDivision()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDivisionId,
szName,
szDescription

FROM 
BOS_PI_Division;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Division_IsDivisionExist(
p_szDivisionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDivisionId

FROM 
BOS_PI_Division
WHERE 
szDivisionId=p_szDivisionId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Division_UpdateDivision(
p_szDivisionId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_PI_Division
SET 
szName = p_szName,
szDescription = p_szDescription
WHERE 
szDivisionId = p_szDivisionId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_ChangePassKeyEmployee(
p_szEmployeeId BOS_DT_szId,
p_decPassKey BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_PI_Employee
SET 
decPassKey = p_decPassKey

WHERE 
szEmployeeId = p_szEmployeeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_CreateEmployee(
p_szEmployeeId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szWorkplaceId BOS_DT_szId,
p_szDeliveryGroupId BOS_DT_szId,
p_szSupervisorId BOS_DT_szId,
p_szDivisionId BOS_DT_szId,
p_szDepartmentId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_bIncludeInDailySettlement BOS_DT_bBoolean,
p_szRoutineType BOS_DT_szSmallId,
p_szFVRemaScheduleId BOS_DT_szId,
p_intRoundingLevel_for_distribution integer,
p_szSubAccIdForMoDis BOS_DT_szGLAccount,
p_bHasGprs BOS_DT_bBoolean,
p_bHasGps BOS_DT_bBoolean,
p_bHasPrinter BOS_DT_bBoolean,
p_bHasBarcodeCustInfo BOS_DT_bBoolean,
p_bHasBarcodeReaderToReadSn BOS_DT_bBoolean,
p_decPassKey BOS_DT_decAmount,
p_bActive BOS_DT_bBoolean,
p_szGpsType BOS_DT_szSmallId,
p_szBarcodeReaderType BOS_DT_szSmallId,
p_bMustFillAssetMonitoring BOS_DT_bBoolean,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean,
p_bCheckInUsingGps BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PI_Employee
(
szEmployeeId,
szName,
szWorkplaceId,
szDeliveryGroupId,
szSupervisorId,
szDivisionId,
szDepartmentId,
szTeamId,
bIncludeInDailySettlement,
szRoutineType,
szFVRemaScheduleId,
intRoundingLevel_for_distribution,
szSubAccIdForMoDis,
bHasGprs,
bHasGps,
bHasPrinter,
bHasBarcodeCustInfo,
bHasBarcodeReaderToReadSn,
decPassKey,
bActive,
szGpsType,
szBarcodeReaderType,
bMustFillAssetMonitoring,
dtmLastUpdated,
bAlreadyTransferred,
bCheckInUsingGps
)
VALUES
(
p_szEmployeeId,
p_szName,
p_szWorkplaceId,
p_szDeliveryGroupId,
p_szSupervisorId,
p_szDivisionId,
p_szDepartmentId,
p_szTeamId,
p_bIncludeInDailySettlement,
p_szRoutineType,
p_szFVRemaScheduleId,
p_intRoundingLevel_for_distribution,
p_szSubAccIdForMoDis,
p_bHasGprs,
p_bHasGps,
p_bHasPrinter,
p_bHasBarcodeCustInfo,
p_bHasBarcodeReaderToReadSn,
p_decPassKey,
p_bActive,
p_szGpsType,
p_szBarcodeReaderType,
p_bMustFillAssetMonitoring,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_bCheckInUsingGps,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_CreateEmployee_013(
p_szEmployeeId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szWorkplaceId BOS_DT_szId,
p_szDeliveryGroupId BOS_DT_szId,
p_szSupervisorId BOS_DT_szId,
p_szDivisionId BOS_DT_szId,
p_szDepartmentId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_bIncludeInDailySettlement BOS_DT_bBoolean,
p_szRoutineType BOS_DT_szSmallId,
p_szFVRemaScheduleId BOS_DT_szId,
p_intRoundingLevel_for_distribution integer,
p_szSubAccIdForMoDis BOS_DT_szGLAccount,
p_bHasGprs BOS_DT_bBoolean,
p_bHasGps BOS_DT_bBoolean,
p_bHasPrinter BOS_DT_bBoolean,
p_bHasBarcodeCustInfo BOS_DT_bBoolean,
p_bHasBarcodeReaderToReadSn BOS_DT_bBoolean,
p_decPassKey BOS_DT_decAmount,
p_bActive BOS_DT_bBoolean,
p_szGpsType BOS_DT_szSmallId,
p_szBarcodeReaderType BOS_DT_szSmallId,
p_bMustFillAssetMonitoring BOS_DT_bBoolean,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean,
p_bCheckInUsingGps BOS_DT_bBoolean,
p_szDeviceType BOS_DT_szId,
p_AdcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PI_Employee
(
szEmployeeId,
szName,
szWorkplaceId,
szDeliveryGroupId,
szSupervisorId,
szDivisionId,
szDepartmentId,
szTeamId,
bIncludeInDailySettlement,
szRoutineType,
szFVRemaScheduleId,
intRoundingLevel_for_distribution,
szSubAccIdForMoDis,
bHasGprs,
bHasGps,
bHasPrinter,
bHasBarcodeCustInfo,
bHasBarcodeReaderToReadSn,
decPassKey,
bActive,
szGpsType,
szBarcodeReaderType,
bMustFillAssetMonitoring,
dtmLastUpdated,
bAlreadyTransferred,
bCheckInUsingGps,
szDeviceType,
AdcId
)
VALUES
(
p_szEmployeeId,
p_szName,
p_szWorkplaceId,
p_szDeliveryGroupId,
p_szSupervisorId,
p_szDivisionId,
p_szDepartmentId,
p_szTeamId,
p_bIncludeInDailySettlement,
p_szRoutineType,
p_szFVRemaScheduleId,
p_intRoundingLevel_for_distribution,
p_szSubAccIdForMoDis,
p_bHasGprs,
p_bHasGps,
p_bHasPrinter,
p_bHasBarcodeCustInfo,
p_bHasBarcodeReaderToReadSn,
p_decPassKey,
p_bActive,
p_szGpsType,
p_szBarcodeReaderType,
p_bMustFillAssetMonitoring,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_bCheckInUsingGps,
p_szDeviceType,
p_AdcId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_CreateEmployeeDistribution(
p_szDriverId BOS_DT_szId,
p_szHelperId1 BOS_DT_szId,
p_szHelperId2 BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean,
p_szHelperId3 BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PI_EmployeeDistribution
(
szDriverId,
szHelperId1,
szHelperId2,
szVehicleId,
dtmLastUpdated,
bAlreadyTransferred,
szHelperId3
)
VALUES
(
p_szDriverId,
p_szHelperId1,
p_szHelperId2,
p_szVehicleId,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szHelperId3
-- ==================================================================,
--set ANSI_NULLS OFF,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_CreateEmployeeDistribution_014(
p_szDriverId BOS_DT_szId,
p_szHelperId1 BOS_DT_szId,
p_szHelperId2 BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean,
p_szHelperId3 BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PI_EmployeeDistribution
(
szDriverId,
szHelperId1,
szHelperId2,
szVehicleId,
dtmLastUpdated,
bAlreadyTransferred,
szHelperId3
)
VALUES
(
p_szDriverId,
p_szHelperId1,
p_szHelperId2,
p_szVehicleId,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szHelperId3
-- ==================================================================,
--set ANSI_NULLS OFF
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_DeleteEmployee(
p_szEmployeeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_PI_Employee
WHERE
szEmployeeId=p_szEmployeeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_DeleteEmployeeDistribution(
p_szDriverId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_PI_EmployeeDistribution
WHERE
szDriverId=p_szDriverId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_GetEmployee(
p_szEmployeeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT    
Emp.szName,    

Emp.decPassKey,    

Emp.szWorkplaceId,    
Wp.szName AS szWorkplaceNm_J,    

Emp.szDeliveryGroupId,    
DelG.szDesc AS szDeliveryGroupNm_J,    

Emp.szSupervisorId,    
Sup.szName AS szSupervisorNm_J,    

Sup.szSupervisorId AS szSupervisorId_2_J,    
Sup2.szName AS szSupervisorNm_2_J,    

Sup2.szSupervisorId AS szSupervisorId_3_J,    
Sup3.szName AS szSupervisorNm_3_J,    

Emp.szDivisionId,    
Div.szName AS szDivisionNm_J,    

Emp.szDepartmentId,    
Dep.szName AS szDepartmentNm_J,    

Emp.szTeamId,    
Tea.szDescription AS szTeamDescr_J,    

ED.szVehicleId AS szVehicleId_J,    
VEH.szPoliceNo AS szVehiclePoliceNo_J,    
VEH.szVehicleCapacityId AS szVehicleCapacityId_J,    

Emp.bIncludeInDailySettlement,    
Emp.szRoutineType,    

Emp.szFVRemaScheduleId,    
Emp.intRoundingLevel_for_distribution,    

Emp.szSubAccIdForMoDis,    
GSA.szDescription as szSubAccNmForMoDis_J,    

Emp.dtmLastUpdated,    
Emp.bAlreadyTransferred    
,    
Emp.bHasGprs,    
Emp.bHasGps,    
Emp.bHasPrinter,     
Emp.bHasBarcodeCustInfo,    
Emp.bHasBarcodeReaderToReadSn,    

Emp.bActive,    
Emp.szGpsType,    
Emp.szBarcodeReaderType,     
Emp.bMustFillAssetMonitoring,    
Emp.bCheckInUsingGps   
FROM    
BOS_PI_Employee AS Emp    
LEFT JOIN BOS_GL_Workplace AS Wp ON Wp.szWorkplaceId = Emp.szWorkplaceId    

LEFT JOIN BOS_SD_DeliveryGroup AS DelG ON DelG.szDeliveryGroupId = Emp.szDeliveryGroupId    

LEFT JOIN BOS_PI_Employee AS Sup ON Sup.szEmployeeId = Emp.szSupervisorId    
LEFT JOIN BOS_PI_Employee AS Sup2 ON Sup2.szEmployeeId = Sup.szSupervisorId    
LEFT JOIN BOS_PI_Employee AS Sup3 ON Sup3.szEmployeeId = Sup2.szSupervisorId    

LEFT JOIN BOS_PI_Division AS Div ON Div.szDivisionId = Emp.szDivisionId    
LEFT JOIN BOS_PI_Department AS Dep ON Dep.szDepartmentId = Emp.szDepartmentId    
LEFT JOIN BOS_PI_Team AS Tea ON Tea.szTeamId = Emp.szTeamId    

LEFT JOIN BOS_PI_EmployeeDistribution AS ED ON ED.szDriverId = Emp.szEmployeeId    
LEFT JOIN BOS_INV_Vehicle AS VEH ON VEH.szVehicleId = ED.szVehicleId    
LEFT JOIN BOS_GL_GLSubAcc AS GSA ON GSA.szGlSubAccId = Emp.szSubAccIdForMoDis    

WHERE    
Emp.szEmployeeId = p_szEmployeeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_GetEmployee_013(
p_szEmployeeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT        
Emp.szName,        

Emp.decPassKey,        

Emp.szWorkplaceId,        
Wp.szName AS szWorkplaceNm_J,        

Emp.szDeliveryGroupId,        
DelG.szDesc AS szDeliveryGroupNm_J,        

Emp.szSupervisorId,        
Sup.szName AS szSupervisorNm_J,        

Sup.szSupervisorId AS szSupervisorId_2_J,        
Sup2.szName AS szSupervisorNm_2_J,        

Sup2.szSupervisorId AS szSupervisorId_3_J,        
Sup3.szName AS szSupervisorNm_3_J,        

Emp.szDivisionId,        
Div.szName AS szDivisionNm_J,        

Emp.szDepartmentId,        
Dep.szName AS szDepartmentNm_J,        

Emp.szTeamId,        
Tea.szDescription AS szTeamDescr_J,        

ED.szVehicleId AS szVehicleId_J,        
VEH.szPoliceNo AS szVehiclePoliceNo_J,        
VEH.szVehicleCapacityId AS szVehicleCapacityId_J,        

Emp.bIncludeInDailySettlement,        
Emp.szRoutineType,        

Emp.szFVRemaScheduleId,        
Emp.intRoundingLevel_for_distribution,        

Emp.szSubAccIdForMoDis,        
GSA.szDescription as szSubAccNmForMoDis_J,        

Emp.dtmLastUpdated,        
Emp.bAlreadyTransferred,        
Emp.bHasGprs,        
Emp.bHasGps,        
Emp.bHasPrinter,         
Emp.bHasBarcodeCustInfo,        
Emp.bHasBarcodeReaderToReadSn,        

Emp.bActive,        
Emp.szGpsType,        
Emp.szBarcodeReaderType,         
Emp.bMustFillAssetMonitoring,        
Emp.bCheckInUsingGps,
Emp.szDeviceType,
Emp.AdcId  

FROM        
BOS_PI_Employee AS Emp        
LEFT JOIN BOS_GL_Workplace AS Wp ON Wp.szWorkplaceId = Emp.szWorkplaceId        

LEFT JOIN BOS_SD_DeliveryGroup AS DelG ON DelG.szDeliveryGroupId = Emp.szDeliveryGroupId        

LEFT JOIN BOS_PI_Employee AS Sup ON Sup.szEmployeeId = Emp.szSupervisorId        
LEFT JOIN BOS_PI_Employee AS Sup2 ON Sup2.szEmployeeId = Sup.szSupervisorId        
LEFT JOIN BOS_PI_Employee AS Sup3 ON Sup3.szEmployeeId = Sup2.szSupervisorId        

LEFT JOIN BOS_PI_Division AS Div ON Div.szDivisionId = Emp.szDivisionId        
LEFT JOIN BOS_PI_Department AS Dep ON Dep.szDepartmentId = Emp.szDepartmentId        
LEFT JOIN BOS_PI_Team AS Tea ON Tea.szTeamId = Emp.szTeamId        

LEFT JOIN BOS_PI_EmployeeDistribution AS ED ON ED.szDriverId = Emp.szEmployeeId        
LEFT JOIN BOS_INV_Vehicle AS VEH ON VEH.szVehicleId = ED.szVehicleId        
LEFT JOIN BOS_GL_GLSubAcc AS GSA ON GSA.szGlSubAccId = Emp.szSubAccIdForMoDis        

WHERE        
Emp.szEmployeeId = p_szEmployeeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_GetEmployeeDistribution(
p_szDriverId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
ED.szDriverId,
E1.szName as szDriverNm,
ED.szHelperId1,
E2.szName as szHelperNm1,
ED.szHelperId2,
E3.szName as szHelperNm2,
ED.szVehicleId,
V1.szPoliceNo as szPoliceNo,
V1.szVehicleCapacityId,
ED.dtmLastUpdated,
ED.bAlreadyTransferred,
ED.szHelperId3,
E4.szName as szHelperNm3

FROM
BOS_PI_EmployeeDistribution as ED
LEFT JOIN BOS_PI_Employee as E1 ON E1.szEmployeeId = ED.szDriverId
LEFT JOIN BOS_PI_Employee as E2 ON E2.szEmployeeId = ED.szHelperId1
LEFT JOIN BOS_PI_Employee as E3 ON E3.szEmployeeId = ED.szHelperId2
LEFT JOIN BOS_PI_Employee as E4 ON E4.szEmployeeId = ED.szHelperId3
LEFT JOIN BOS_INV_Vehicle as V1 ON V1.szVehicleId = ED.szVehicleId

WHERE
ED.szDriverId=p_szDriverId;

-- ==================================================================

--set ANSI_NULLS OFF

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_GetEmployeeDistribution_014(
p_szDriverId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
ED.szDriverId,
E1.szName as szDriverNm,
ED.szHelperId1,
E2.szName as szHelperNm1,
ED.szHelperId2,
E3.szName as szHelperNm2,
ED.szVehicleId,
V1.szPoliceNo as szPoliceNo,
V1.szVehicleCapacityId,
ED.dtmLastUpdated,
ED.bAlreadyTransferred,
ED.szHelperId3,
E4.szName as szHelperNm3

FROM
BOS_PI_EmployeeDistribution as ED
LEFT JOIN BOS_PI_Employee as E1 ON E1.szEmployeeId = ED.szDriverId
LEFT JOIN BOS_PI_Employee as E2 ON E2.szEmployeeId = ED.szHelperId1
LEFT JOIN BOS_PI_Employee as E3 ON E3.szEmployeeId = ED.szHelperId2
LEFT JOIN BOS_PI_Employee as E4 ON E4.szEmployeeId = ED.szHelperId3
LEFT JOIN BOS_INV_Vehicle as V1 ON V1.szVehicleId = ED.szVehicleId

WHERE
ED.szDriverId=p_szDriverId;

-- ==================================================================

--set ANSI_NULLS OFF


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_GetListOfEmployee(
p_szWorkplaceId BOS_DT_szId,
p_bActiveOnly BOS_DT_bBoolean,
p_szRoutineType BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_bActiveOnly = 1
  THEN

SELECT
szEmployeeId,
szName
FROM
BOS_PI_Employee
WHERE
szWorkplaceId LIKE p_szWorkplaceId
AND szRoutineType LIKE p_szRoutineType
AND bActive = 1;

ELSE

SELECT
szEmployeeId,
szName
FROM
BOS_PI_Employee
WHERE
szWorkplaceId LIKE p_szWorkplaceId
AND szRoutineType LIKE p_szRoutineType;

END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_GetListOfEmployee_013(
p_szWorkplaceId BOS_DT_szId,
p_bActiveOnly BOS_DT_bBoolean,
p_szRoutineType BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_bActiveOnly = 1  
  THEN

SELECT  
szEmployeeId,  
szName  
FROM  
BOS_PI_Employee  
WHERE  
szWorkplaceId LIKE p_szWorkplaceId  
AND szRoutineType LIKE p_szRoutineType  
AND bActive = 1; 

ELSE  

SELECT  
szEmployeeId,  
szName  
FROM  
BOS_PI_Employee  
WHERE  
szWorkplaceId LIKE p_szWorkplaceId  
AND szRoutineType LIKE p_szRoutineType;

END IF;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_GetListOfEmployeeDistribution()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDriverId

FROM 
BOS_PI_EmployeeDistribution;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_IsEmployeeDistributionExist(
p_szDriverId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDriverId

FROM 
BOS_PI_EmployeeDistribution
WHERE 
szDriverId=p_szDriverId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_IsEmployeeExist(
p_szEmployeeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szEmployeeId

FROM 
BOS_PI_Employee
WHERE 
szEmployeeId=p_szEmployeeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_LockEmployee(
p_szEmployeeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_PI_Employee
SET 
szWorkplaceId=szWorkplaceId
WHERE 
szEmployeeId=p_szEmployeeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_LockEmployeeDistribution(
p_szDriverId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_PI_EmployeeDistribution
SET 
szHelperId1 = szHelperId1

WHERE 
szDriverId=p_szDriverId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_UpdateEmployee(
p_szEmployeeId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szWorkplaceId BOS_DT_szId,
p_szDeliveryGroupId BOS_DT_szId,
p_szSupervisorId BOS_DT_szId,
p_szDivisionId BOS_DT_szId,
p_szDepartmentId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_bIncludeInDailySettlement BOS_DT_bBoolean,
p_szRoutineType BOS_DT_szSmallId,
p_szFVRemaScheduleId BOS_DT_szId,
p_intRoundingLevel_for_distribution integer,
p_szSubAccIdForMoDis BOS_DT_szGLAccount,
p_bHasGprs BOS_DT_bBoolean,
p_bHasGps BOS_DT_bBoolean,
p_bHasPrinter BOS_DT_bBoolean,
p_bHasBarcodeCustInfo BOS_DT_bBoolean,
p_bHasBarcodeReaderToReadSn BOS_DT_bBoolean,
p_bActive BOS_DT_bBoolean,
p_szGpsType BOS_DT_szSmallId,
p_szBarcodeReaderType BOS_DT_szSmallId,
p_bMustFillAssetMonitoring BOS_DT_bBoolean,
p_bCheckInUsingGps BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_PI_Employee
SET 
szName = p_szName,
szWorkplaceId = p_szWorkplaceId,
szDeliveryGroupId = p_szDeliveryGroupId,
szSupervisorId = p_szSupervisorId,
szDivisionId = p_szDivisionId,
szDepartmentId = p_szDepartmentId,
szTeamId = p_szTeamId,
bIncludeInDailySettlement = p_bIncludeInDailySettlement,
szRoutineType = p_szRoutineType,
szFVRemaScheduleId = p_szFVRemaScheduleId,
intRoundingLevel_for_distribution = p_intRoundingLevel_for_distribution,
szSubAccIdForMoDis = p_szSubAccIdForMoDis,
bHasGprs = p_bHasGprs,
bHasGps = p_bHasGps,
bHasPrinter = p_bHasPrinter,
bHasBarcodeCustInfo = p_bHasBarcodeCustInfo,
bHasBarcodeReaderToReadSn = p_bHasBarcodeReaderToReadSn,
bActive = p_bActive,
szGpsType =p_szGpsType,
szBarcodeReaderType=p_szBarcodeReaderType,
bMustFillAssetMonitoring=p_bMustFillAssetMonitoring,
bCheckInUsingGps = p_bCheckInUsingGps
WHERE 
szEmployeeId = p_szEmployeeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_UpdateEmployee_013(
p_szEmployeeId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szWorkplaceId BOS_DT_szId,
p_szDeliveryGroupId BOS_DT_szId,
p_szSupervisorId BOS_DT_szId,
p_szDivisionId BOS_DT_szId,
p_szDepartmentId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_bIncludeInDailySettlement BOS_DT_bBoolean,
p_szRoutineType BOS_DT_szSmallId,
p_szFVRemaScheduleId BOS_DT_szId,
p_intRoundingLevel_for_distribution integer,
p_szSubAccIdForMoDis BOS_DT_szGLAccount,
p_bHasGprs BOS_DT_bBoolean,
p_bHasGps BOS_DT_bBoolean,
p_bHasPrinter BOS_DT_bBoolean,
p_bHasBarcodeCustInfo BOS_DT_bBoolean,
p_bHasBarcodeReaderToReadSn BOS_DT_bBoolean,
p_bActive BOS_DT_bBoolean,
p_szGpsType BOS_DT_szSmallId,
p_szBarcodeReaderType BOS_DT_szSmallId,
p_bMustFillAssetMonitoring BOS_DT_bBoolean,
p_bCheckInUsingGps BOS_DT_bBoolean,
p_szDeviceType BOS_DT_szId,
p_AdcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
-- ### 2 update #####
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_UpdateEmployeeDistribution(
p_szDriverId BOS_DT_szId,
p_szHelperId1 BOS_DT_szId,
p_szHelperId2 BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szHelperId3 BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_PI_EmployeeDistribution
SET 
szHelperId1 = p_szHelperId1,
szHelperId2 = p_szHelperId2,
szVehicleId = p_szVehicleId,
szHelperId3 = p_szHelperId3

WHERE 
szDriverId = p_szDriverId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PI_Employee_UpdateEmployeeDistribution_014(
p_szDriverId BOS_DT_szId,
p_szHelperId1 BOS_DT_szId,
p_szHelperId2 BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szHelperId3 BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_PI_EmployeeDistribution
SET 
szHelperId1 = p_szHelperId1,
szHelperId2 = p_szHelperId2,
szVehicleId = p_szVehicleId,
szHelperId3 = p_szHelperId3

WHERE 
szDriverId = p_szDriverId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_FPoItemDateReceiptExpectation_CreateFPoItemDateReceiptExpectation(
p_szFPO_sId BOS_DT_szId,
p_shItemNumber smallint,
p_dtmReceiptDate timestamp,
p_decQtyOrder BOS_DT_decQty)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PUR_FPoItemDateReceiptExpectation
(
szFPO_sId,
shItemNumber,
dtmReceiptDate,
decQtyOrder,
)
VALUES
(
p_szFPO_sId,
p_shItemNumber,
p_dtmReceiptDate,
p_decQtyOrder
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_FPoItemDateReceiptExpectation_DeleteFPoItemDateReceiptExpectation(
p_szFPo_sId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_PUR_FPoItemDateReceiptExpectation
WHERE
szFPo_sId = p_szFPo_sId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_FPoItemDateReceiptExpectation_GetFPoItemDateReceiptExpectation(
p_szFPo_sId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN

select
FPOI.szFPo_sId,
FPOI.shItemNumber,
FPOI.dtmReceiptDate,
FPOI.decQtyOrder,
(select DISTINCT
SUM(FPOR.decQty)
from 
BOS_PUR_FPoReceipt_sItem FPOR
where
FPOR.szFPoReceipt_sId in (
select 
szFPoReceipt_sId
from
BOS_PUR_FPoReceipt_s
where 
szPoId = FPOI.szFPo_sId
)
and
FPOR.szProductId in (
select 
szProductId
from
BOS_PUR_FPo_sItem
where 
szFPo_sId = FPOI.szFPo_sId
AND
shItemNumber = FPOI.shItemNumber
)
) as decQtyDelivered_J
from
BOS_PUR_FPoItemDateReceiptExpectation FPOI
where
FPOI.szFPo_sId = p_szFPo_sId
and
FPOI.shItemNumber = p_shItemNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_FPoReceipt_s_GetFPoReceipt_sIdByPoId(
p_szPoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFPoReceipt_sId

FROM 
BOS_PUR_FPoReceipt_s
WHERE 
szPoId = p_szPoId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_FRequisition_CreateFRequisition(
p_szFRequisitionId BOS_DT_szId,
p_dtmRequisition timestamp,
p_szDemandType BOS_DT_szSmallId,
p_szReasonId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bOpen smallint,
p_szFReqReceivedId BOS_DT_szId,
p_bResultFrTransfer smallint,
p_bVoid smallint,
p_bApproved smallint,
p_bApplied smallint,
p_bJournal smallint,
p_bPosted smallint,
p_btPrintedCount smallint,
p_bTransferred smallint,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval smallint,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated smallint,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PUR_FRequisition
(
szFRequisitionId,
dtmRequisition,
szDemandType,
szReasonId,
szDescription,
bOpen,
szFReqReceivedId,
-- Doc status.,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFRequisitionId,
p_dtmRequisition,
p_szDemandType,
p_szReasonId,
p_szDescription,
p_bOpen,
p_szFReqReceivedId,
-- Doc status.,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_FRequisition_CreateFRequisitionItem(
p_szFRequisitionId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_decQtyRequired BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_dtmRequired timestamp,
p_szFPoId BOS_DT_szId,
p_decQtyOrdered BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PUR_FRequisitionItem
(
szFRequisitionId,
szProductId,
decQtyRequired,
szUomId,
dtmRequired,
szFPoId,
decQtyOrdered
)
VALUES
(
p_szFRequisitionId,
p_szProductId,
p_decQtyRequired,
p_szUomId,
p_dtmRequired,
p_szFPoId,
p_decQtyOrdered
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_FRequisition_DeleteFRequisition(
p_szFRequisitionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_PUR_FRequisition
WHERE
szFRequisitionId = p_szFRequisitionId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_FRequisition_DeleteFRequisitionItem(
p_szFRequisitionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_PUR_FRequisitionItem
WHERE
szFRequisitionId = p_szFRequisitionId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_FRequisition_GetFRequisition(
p_szFRequisitionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_PUR_FRequisition.dtmRequisition,
BOS_PUR_FRequisition.szDemandType,
BOS_PUR_FRequisition.szReasonId,
BOS_PUR_FRequisition.szDescription,
BOS_PUR_FRequisition.bOpen,
BOS_PUR_FRequisition.szFReqReceivedId,
BOS_PI_UserInfo.szDivisionId AS szUserDivisionId,
BOS_PI_Division.szName AS szUserDivisionNm,
BOS_PI_UserInfo.szDepartmentId AS szUserDepartmentId,
BOS_PI_Department.szName AS szUserDepartmentNm,

-- Doc status.
BOS_PUR_FRequisition.bResultFrTransfer,
BOS_PUR_FRequisition.bVoid,
BOS_GEN_Approved.bApproved,
BOS_PUR_FRequisition.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_PUR_FRequisition.btPrintedCount,
BOS_PUR_FRequisition.bTransferred,
BOS_PUR_FRequisition.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_PUR_FRequisition.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_PUR_FRequisition.szTaxEntityId,
BOS_PUR_FRequisition.bNeedApproval,
BOS_PUR_FRequisition.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_PUR_FRequisition.dtmCreated,
BOS_PUR_FRequisition.bSystemCreated,
BOS_PUR_FRequisition.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_PUR_FRequisition.dtmLastUpdated,
BOS_PUR_FRequisition.bAlreadyTransferred
FROM
BOS_PUR_FRequisition

-- For doc status.
LEFT JOIN BOS_GEN_Approved ON BOS_PUR_FRequisition.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_PUR_FRequisition.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_PUR_FRequisition.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_PUR_FRequisition.szWorkplaceId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_PUR_FRequisition.szUserId

LEFT JOIN BOS_PI_UserInfo ON BOS_PI_UserInfo.szUserId = BOS_PUR_FRequisition.szUserId
LEFT JOIN BOS_PI_Division ON BOS_PI_Division.szDivisionId = BOS_PI_UserInfo.szDivisionId
LEFT JOIN BOS_PI_Department ON BOS_PI_Department.szDepartmentId = BOS_PI_UserInfo.szDepartmentId
WHERE
szFRequisitionId = p_szFRequisitionId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_FRequisition_GetFRequisitionItem(
p_szFRequisitionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_PUR_FRequisitionItem.szFRequisitionId,
BOS_PUR_FRequisitionItem.szProductId,

BOS_INV_Product.szName AS szProductNm,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szUomId AS szProductUomId,
BOS_INV_Product.szCompUomId AS szProductCompUomId,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType,

BOS_PUR_FRequisitionItem.decQtyRequired,
BOS_PUR_FRequisitionItem.szUomId,
BOS_PUR_FRequisitionItem.dtmRequired,
BOS_PUR_FRequisitionItem.szFPoId,
BOS_PUR_FRequisitionItem.decQtyOrdered

FROM 
BOS_PUR_FRequisitionItem
left join BOS_INV_Product on BOS_PUR_FRequisitionItem.szProductId = BOS_INV_Product.szProductId
WHERE 
szFRequisitionId = p_szFRequisitionId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_FRequisition_GetListOfFRequisition()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFRequisitionId,
dtmRequisition

FROM 
BOS_PUR_FRequisition

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_FRequisition_IsFRequisitionExist(
p_szFRequisitionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFRequisitionId

FROM 
BOS_PUR_FRequisition
WHERE 
szFRequisitionId = p_szFRequisitionId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_FRequisition_LockFRequisition(
p_szFRequisitionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_PUR_FRequisition
SET 
szDemandType = szDemandType
WHERE 
szFRequisitionId = p_szFRequisitionId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_FRequisition_MarkFRequisitionApplied(
p_szFRequisitionId BOS_DT_szId,
p_dtmRequisition timestamp,
p_bApplied bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_PUR_FRequisition
SET 
dtmRequisition = p_dtmRequisition,
bApplied = p_bApplied
WHERE 
szFRequisitionId = p_szFRequisitionId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_FRequisition_MarkFRequisitionVoid(
p_szFRequisitionId BOS_DT_szId,
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_PUR_FRequisition
SET 
bVoid = 1,
bNeedApproval = 0,
gdApprovedId = p_gdApprovedId
WHERE 
szFRequisitionId = p_szFRequisitionId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_FRequisition_UpdateFRequisition(
p_szFRequisitionId BOS_DT_szId,
p_dtmRequisition timestamp,
p_szDemandType BOS_DT_szSmallId,
p_szReasonId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer smallint,
p_bVoid smallint,
p_bApproved smallint,
p_bApplied smallint,
p_bJournal smallint,
p_bPosted smallint,
p_btPrintedCount smallint,
p_bTransferred smallint,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval smallint,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated smallint,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_PUR_FRequisition
SET 
dtmRequisition = p_dtmRequisition,
szDemandType = p_szDemandType,
szReasonId = p_szReasonId,
szDescription = p_szDescription,

-- Doc status.
bVoid = p_bVoid,
bApplied = p_bApplied,
-- It is better to use these fields as the information of its last updated (or applied), rather than its data creation.
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
szUserId = p_szUserId,
dtmCreated = p_dtmCreated
WHERE 
szFRequisitionId = p_szFRequisitionId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_CreatePurchaseItemType(
p_szPurchaseItemTypeId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szTrnType BOS_DT_szSmallId,
p_bTaxable smallint,
p_bBilled smallint,
p_bApplicable4AllPurchOrg smallint,
p_bApplicable4AllSupplier smallint,
p_bApplicable4AllProduct smallint,
p_szBorrowChargeCalcId BOS_DT_szId,
p_bAllowZeroPrice smallint,
p_szReturPurchaseItemTypeId BOS_DT_szId,
p_gdAuditTrailId bytea,
p_bAllowManualPrice smallint,
p_bAllowManualDiscount smallint,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PUR_PurchaseItemType
(
szPurchaseItemTypeId,
szDescription,
szTrnType,
bTaxable,
bBilled,
bApplicable4AllPurchOrg,
bApplicable4AllSupplier,
bApplicable4AllProduct,
szBorrowChargeCalcId,
bAllowZeroPrice,
szReturPurchaseItemTypeId,
gdAuditTrailId,
bAllowManualPrice,
bAllowManualDiscount,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szPurchaseItemTypeId,
p_szDescription,
p_szTrnType,
p_bTaxable,
p_bBilled,
p_bApplicable4AllPurchOrg,
p_bApplicable4AllSupplier,
p_bApplicable4AllProduct,
p_szBorrowChargeCalcId,
p_bAllowZeroPrice,
p_szReturPurchaseItemTypeId,
p_gdAuditTrailId,
p_bAllowManualPrice,
p_bAllowManualDiscount,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_CreatePurchaseItemType_013(
p_szPurchaseItemTypeId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szTrnType BOS_DT_szSmallId,
p_bTaxable smallint,
p_bBilled smallint,
p_bApplicable4AllPurchOrg smallint,
p_bApplicable4AllSupplier smallint,
p_bApplicable4AllProduct smallint,
p_szBorrowChargeCalcId BOS_DT_szId,
p_bAllowZeroPrice smallint,
p_szReturPurchaseItemTypeId BOS_DT_szId,
p_gdAuditTrailId bytea,
p_bAllowManualPrice smallint,
p_bAllowManualDiscount smallint,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PUR_PurchaseItemType
(
szPurchaseItemTypeId,
szDescription,
szTrnType,
bTaxable,
bBilled,
bApplicable4AllPurchOrg,
bApplicable4AllSupplier,
bApplicable4AllProduct,
szBorrowChargeCalcId,
bAllowZeroPrice,
szReturPurchaseItemTypeId,
gdAuditTrailId,
bAllowManualPrice,
bAllowManualDiscount,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szPurchaseItemTypeId,
p_szDescription,
p_szTrnType,
p_bTaxable,
p_bBilled,
p_bApplicable4AllPurchOrg,
p_bApplicable4AllSupplier,
p_bApplicable4AllProduct,
p_szBorrowChargeCalcId,
p_bAllowZeroPrice,
p_szReturPurchaseItemTypeId,
p_gdAuditTrailId,
p_bAllowManualPrice,
p_bAllowManualDiscount,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_CreatePurchaseItemTypeProduct(
p_szPurchaseItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PUR_PurchaseItemTypeProduct
(
szPurchaseItemTypeId,
szProductId
)
VALUES
(
p_szPurchaseItemTypeId,
p_szProductId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_CreatePurchaseItemTypePurchOrg(
p_szPurchaseItemTypeId BOS_DT_szId,
p_szPurchOrgId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PUR_PurchaseItemTypePurchOrg
(
szPurchaseItemTypeId,
szPurchOrgId
)
VALUES
(
p_szPurchaseItemTypeId,
p_szPurchOrgId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_CreatePurchaseItemTypeSupplier(
p_szPurchaseItemTypeId BOS_DT_szId,
p_szSupplierId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PUR_PurchaseItemTypeSupplier
(
szPurchaseItemTypeId,
szSupplierId
)
VALUES
(
p_szPurchaseItemTypeId,
p_szSupplierId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_DeletePurchaseItemType(
p_szPurchaseItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_PUR_PurchaseItemType
WHERE
szPurchaseItemTypeId = p_szPurchaseItemTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_DeletePurchaseItemTypeProduct(
p_szPurchaseItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_PUR_PurchaseItemTypeProduct
WHERE
szPurchaseItemTypeId = p_szPurchaseItemTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_DeletePurchaseItemTypePurchOrg(
p_szPurchaseItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_PUR_PurchaseItemTypePurchOrg
WHERE
szPurchaseItemTypeId = p_szPurchaseItemTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_DeletePurchaseItemTypeSupplier(
p_szPurchaseItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_PUR_PurchaseItemTypeSupplier
WHERE
szPurchaseItemTypeId = p_szPurchaseItemTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_GetListOfPurchaseItemType()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPurchaseItemTypeId,
szDescription,
szTrnType

FROM 
BOS_PUR_PurchaseItemType

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_GetPurchaseItemType(
p_szPurchaseItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
szTrnType,
bTaxable,
bBilled,
bApplicable4AllPurchOrg,
bApplicable4AllSupplier,
bApplicable4AllProduct,
szBorrowChargeCalcId,
bAllowZeroPrice,
szReturPurchaseItemTypeId,
gdAuditTrailId,
bAllowManualPrice,
bAllowManualDiscount,

dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_PUR_PurchaseItemType
WHERE 
szPurchaseItemTypeId = p_szPurchaseItemTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_GetPurchaseItemType_013(
p_szPurchaseItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
szTrnType,
bTaxable,
bBilled,
bApplicable4AllPurchOrg,
bApplicable4AllSupplier,
bApplicable4AllProduct,
szBorrowChargeCalcId,
bAllowZeroPrice,
szReturPurchaseItemTypeId,
gdAuditTrailId,
bAllowManualPrice,
bAllowManualDiscount,

dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_PUR_PurchaseItemType
WHERE 
szPurchaseItemTypeId = p_szPurchaseItemTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_GetPurchaseItemTypeProduct(
p_szPurchaseItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_PUR_PurchaseItemTypeProduct.szProductId,
BOS_INV_Product.szName AS szProductNm

FROM 
BOS_PUR_PurchaseItemTypeProduct LEFT JOIN BOS_INV_ProductBOS_PUR_PurchaseItemTypeProduct LEFT JOIN BOS_INV_Product;
ON BOS_PUR_PurchaseItemTypeProduct.szProductId = BOS_INV_Product.szProductId
WHERE 
BOS_PUR_PurchaseItemTypeProduct.szPurchaseItemTypeId = p_szPurchaseItemTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_GetPurchaseItemTypePurchOrg(
p_szPurchaseItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_PUR_PurchaseItemTypePurchOrg.szPurchOrgId,
BOS_SCM_PurchOrg.szDescription AS szPurchOrgDesc

FROM 
BOS_PUR_PurchaseItemTypePurchOrg
LEFT JOIN BOS_SCM_PurchOrg ON BOS_PUR_PurchaseItemTypePurchOrg.szPurchOrgId = BOS_SCM_PurchOrg.szPurchOrgIdLEFT JOIN BOS_SCM_PurchOrg ON BOS_PUR_PurchaseItemTypePurchOrg.szPurchOrgId = BOS_SCM_PurchOrg.szPurchOrgId;
WHERE 
BOS_PUR_PurchaseItemTypePurchOrg.szPurchaseItemTypeId = p_szPurchaseItemTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_GetPurchaseItemTypeSupplier(
p_szPurchaseItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_PUR_PurchaseItemTypeSupplier.szSupplierId,
BOS_AP_Supplier.szName AS szSupplierNm

FROM 
BOS_PUR_PurchaseItemTypeSupplier LEFT JOIN BOS_AP_SupplierBOS_PUR_PurchaseItemTypeSupplier LEFT JOIN BOS_AP_Supplier;
ON BOS_PUR_PurchaseItemTypeSupplier.szSupplierId = BOS_AP_Supplier.szSuppId
WHERE 
BOS_PUR_PurchaseItemTypeSupplier.szPurchaseItemTypeId = p_szPurchaseItemTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_IsPurchaseItemTypeExist(
p_szPurchaseItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPurchaseItemTypeId

FROM 
BOS_PUR_PurchaseItemType
WHERE 
szPurchaseItemTypeId = p_szPurchaseItemTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_LockPurchaseItemType(
p_szPurchaseItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_PUR_PurchaseItemType
SET 
bTaxable = bTaxable
WHERE 
szPurchaseItemTypeId = p_szPurchaseItemTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_UpdatePurchaseItemType(
p_szPurchaseItemTypeId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szTrnType BOS_DT_szSmallId,
p_bTaxable smallint,
p_bBilled smallint,
p_bApplicable4AllPurchOrg smallint,
p_bApplicable4AllSupplier smallint,
p_bApplicable4AllProduct smallint,
p_szBorrowChargeCalcId BOS_DT_szId,
p_bAllowZeroPrice smallint,
p_szReturPurchaseItemTypeId BOS_DT_szId,
p_gdAuditTrailId bytea,
p_bAllowManualPrice smallint,
p_bAllowManualDiscount smallint)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_PUR_PurchaseItemType
SET 
szDescription = p_szDescription,
szTrnType = p_szTrnType,
bTaxable = p_bTaxable,
bBilled = p_bBilled,
bApplicable4AllPurchOrg = p_bApplicable4AllPurchOrg,
bApplicable4AllSupplier = p_bApplicable4AllSupplier,
bApplicable4AllProduct = p_bApplicable4AllProduct,
szBorrowChargeCalcId = p_szBorrowChargeCalcId,
bAllowZeroPrice = p_bAllowZeroPrice,
szReturPurchaseItemTypeId = p_szReturPurchaseItemTypeId,
gdAuditTrailId = p_gdAuditTrailId,
bAllowManualPrice = p_bAllowManualPrice,
bAllowManualDiscount = p_bAllowManualDiscount

WHERE 
szPurchaseItemTypeId = p_szPurchaseItemTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseItemType_UpdatePurchaseItemType_013(
p_szPurchaseItemTypeId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szTrnType BOS_DT_szSmallId,
p_bTaxable smallint,
p_bBilled smallint,
p_bApplicable4AllPurchOrg smallint,
p_bApplicable4AllSupplier smallint,
p_bApplicable4AllProduct smallint,
p_szBorrowChargeCalcId BOS_DT_szId,
p_bAllowZeroPrice smallint,
p_szReturPurchaseItemTypeId BOS_DT_szId,
p_gdAuditTrailId bytea,
p_bAllowManualPrice smallint,
p_bAllowManualDiscount smallint)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_PUR_PurchaseItemType
SET 
szDescription = p_szDescription,
szTrnType = p_szTrnType,
bTaxable = p_bTaxable,
bBilled = p_bBilled,
bApplicable4AllPurchOrg = p_bApplicable4AllPurchOrg,
bApplicable4AllSupplier = p_bApplicable4AllSupplier,
bApplicable4AllProduct = p_bApplicable4AllProduct,
szBorrowChargeCalcId = p_szBorrowChargeCalcId,
bAllowZeroPrice = p_bAllowZeroPrice,
szReturPurchaseItemTypeId = p_szReturPurchaseItemTypeId,
gdAuditTrailId = p_gdAuditTrailId,
bAllowManualPrice = p_bAllowManualPrice,
bAllowManualDiscount = p_bAllowManualDiscount

WHERE 
szPurchaseItemTypeId = p_szPurchaseItemTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_CreatePurchaseType(
p_szPurchaseTypeId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szFlexiKeyId BOS_DT_szId,
p_szApprovalId BOS_DT_szId,
p_bAllowManualPrice smallint,
p_bApplicable4AllPurchOrg smallint,
p_bApplicable4AllSupplier smallint,
p_bApplicable4AllProduct smallint,
p_bApplicable4AllPurchaseItemType smallint,
p_szReturPurchaseTypeId BOS_DT_szId,
p_gdAuditTrailId bytea,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PUR_PurchaseType
(
szPurchaseTypeId,
szDescription,
szFlexiKeyId,
szApprovalId,
bAllowManualPrice,
bApplicable4AllPurchOrg,
bApplicable4AllSupplier,
bApplicable4AllProduct,
bApplicable4AllPurchaseItemType,
szReturPurchaseTypeId,
gdAuditTrailId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szPurchaseTypeId,
p_szDescription,
p_szFlexiKeyId,
p_szApprovalId,
p_bAllowManualPrice,
p_bApplicable4AllPurchOrg,
p_bApplicable4AllSupplier,
p_bApplicable4AllProduct,
p_bApplicable4AllPurchaseItemType,
p_szReturPurchaseTypeId,
p_gdAuditTrailId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_CreatePurchaseType_013(
p_szPurchaseTypeId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szFlexiKeyId BOS_DT_szId,
p_szApprovalId BOS_DT_szId,
p_bAllowManualPrice smallint,
p_bApplicable4AllPurchOrg smallint,
p_bApplicable4AllSupplier smallint,
p_bApplicable4AllProduct smallint,
p_bApplicable4AllPurchaseItemType smallint,
p_szReturPurchaseTypeId BOS_DT_szId,
p_gdAuditTrailId bytea,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PUR_PurchaseType
(
szPurchaseTypeId,
szDescription,
szFlexiKeyId,
szApprovalId,
bAllowManualPrice,
bApplicable4AllPurchOrg,
bApplicable4AllSupplier,
bApplicable4AllProduct,
bApplicable4AllPurchaseItemType,
szReturPurchaseTypeId,
gdAuditTrailId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szPurchaseTypeId,
p_szDescription,
p_szFlexiKeyId,
p_szApprovalId,
p_bAllowManualPrice,
p_bApplicable4AllPurchOrg,
p_bApplicable4AllSupplier,
p_bApplicable4AllProduct,
p_bApplicable4AllPurchaseItemType,
p_szReturPurchaseTypeId,
p_gdAuditTrailId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_CreatePurchaseTypeProduct(
p_szPurchaseTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PUR_PurchaseTypeProduct
(
szPurchaseTypeId,
szProductId
)
VALUES
(
p_szPurchaseTypeId,
p_szProductId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_CreatePurchaseTypePurchaseItemType(
p_szPurchaseTypeId BOS_DT_szId,
p_szPurchaseItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PUR_PurchaseTypePurchaseItemType
(
szPurchaseTypeId,
szPurchaseItemTypeId
)
VALUES
(
p_szPurchaseTypeId,
p_szPurchaseItemTypeId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_CreatePurchaseTypePurchOrg(
p_szPurchaseTypeId BOS_DT_szId,
p_szPurchOrgId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PUR_PurchaseTypePurchOrg
(
szPurchaseTypeId,
szPurchOrgId
)
VALUES
(
p_szPurchaseTypeId,
p_szPurchOrgId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_CreatePurchaseTypeSupplier(
p_szPurchaseTypeId BOS_DT_szId,
p_szSupplierId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_PUR_PurchaseTypeSupplier
(
szPurchaseTypeId,
szSupplierId
)
VALUES
(
p_szPurchaseTypeId,
p_szSupplierId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_DeletePurchaseType(
p_szPurchaseTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_PUR_PurchaseType
WHERE
szPurchaseTypeId = p_szPurchaseTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_DeletePurchaseTypeProduct(
p_szPurchaseTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_PUR_PurchaseTypeProduct
WHERE
szPurchaseTypeId = p_szPurchaseTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_DeletePurchaseTypePurchaseItemType(
p_szPurchaseTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_PUR_PurchaseTypePurchaseItemType
WHERE
szPurchaseTypeId = p_szPurchaseTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_DeletePurchaseTypePurchOrg(
p_szPurchaseTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_PUR_PurchaseTypePurchOrg
WHERE
szPurchaseTypeId = p_szPurchaseTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_DeletePurchaseTypeSupplier(
p_szPurchaseTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_PUR_PurchaseTypeSupplier
WHERE
szPurchaseTypeId = p_szPurchaseTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_GetListOfPurchaseType()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPurchaseTypeId,
szDescription

FROM 
BOS_PUR_PurchaseType

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_GetPurchaseType(
p_szPurchaseTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
szFlexiKeyId,
szApprovalId,
bAllowManualPrice,
bApplicable4AllPurchOrg,
bApplicable4AllSupplier,
bApplicable4AllProduct,
bApplicable4AllPurchaseItemType,
szReturPurchaseTypeId,
gdAuditTrailId,
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_PUR_PurchaseType
WHERE 
szPurchaseTypeId = p_szPurchaseTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_GetPurchaseType_013(
p_szPurchaseTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
szFlexiKeyId,
szApprovalId,
bAllowManualPrice,
bApplicable4AllPurchOrg,
bApplicable4AllSupplier,
bApplicable4AllProduct,
bApplicable4AllPurchaseItemType,
szReturPurchaseTypeId,
gdAuditTrailId,
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_PUR_PurchaseType
WHERE 
szPurchaseTypeId = p_szPurchaseTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_GetPurchaseTypeProduct(
p_szPurchaseTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_PUR_PurchaseTypeProduct.szProductId,
BOS_INV_Product.szName AS szProductNm

FROM 
BOS_PUR_PurchaseTypeProduct LEFT JOIN BOS_INV_ProductBOS_PUR_PurchaseTypeProduct LEFT JOIN BOS_INV_Product;
ON BOS_PUR_PurchaseTypeProduct.szProductId = BOS_INV_Product.szProductId
WHERE 
BOS_PUR_PurchaseTypeProduct.szPurchaseTypeId = p_szPurchaseTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_GetPurchaseTypePurchaseItemType(
p_szPurchaseTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_PUR_PurchaseTypePurchaseItemType.szPurchaseItemTypeId,
BOS_PUR_PurchaseItemType.szDescription AS szPurchaseItemTypeDesc

FROM 
BOS_PUR_PurchaseTypePurchaseItemType LEFT JOIN BOS_PUR_PurchaseItemTypeBOS_PUR_PurchaseTypePurchaseItemType LEFT JOIN BOS_PUR_PurchaseItemType;
ON BOS_PUR_PurchaseTypePurchaseItemType.szPurchaseItemTypeId = BOS_PUR_PurchaseItemType.szPurchaseItemTypeId
WHERE 
BOS_PUR_PurchaseTypePurchaseItemType.szPurchaseTypeId = p_szPurchaseTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_GetPurchaseTypePurchOrg(
p_szPurchaseTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_PUR_PurchaseTypePurchOrg.szPurchOrgId,
BOS_SCM_PurchOrg.szDescription AS szPurchOrgDesc

FROM 
BOS_PUR_PurchaseTypePurchOrg
LEFT JOIN BOS_SCM_PurchOrg ON BOS_PUR_PurchaseTypePurchOrg.szPurchOrgId = BOS_SCM_PurchOrg.szPurchOrgIdLEFT JOIN BOS_SCM_PurchOrg ON BOS_PUR_PurchaseTypePurchOrg.szPurchOrgId = BOS_SCM_PurchOrg.szPurchOrgId;
WHERE 
BOS_PUR_PurchaseTypePurchOrg.szPurchaseTypeId = p_szPurchaseTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_GetPurchaseTypeSupplier(
p_szPurchaseTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_PUR_PurchaseTypeSupplier.szSupplierId,
BOS_AP_Supplier.szName AS szSupplierNm

FROM 
BOS_PUR_PurchaseTypeSupplier LEFT JOIN BOS_AP_SupplierBOS_PUR_PurchaseTypeSupplier LEFT JOIN BOS_AP_Supplier;
ON BOS_PUR_PurchaseTypeSupplier.szSupplierId = BOS_AP_Supplier.szSuppId
WHERE 
BOS_PUR_PurchaseTypeSupplier.szPurchaseTypeId = p_szPurchaseTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_IsPurchaseTypeExist(
p_szPurchaseTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPurchaseTypeId

FROM 
BOS_PUR_PurchaseType
WHERE 
szPurchaseTypeId = p_szPurchaseTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_LockPurchaseType(
p_szPurchaseTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_PUR_PurchaseType
SET 
bAllowManualPrice = bAllowManualPrice
WHERE 
szPurchaseTypeId = p_szPurchaseTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_UpdatePurchaseType(
p_szPurchaseTypeId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szFlexiKeyId BOS_DT_szId,
p_szApprovalId BOS_DT_szId,
p_bAllowManualPrice smallint,
p_bApplicable4AllPurchOrg smallint,
p_bApplicable4AllSupplier smallint,
p_bApplicable4AllProduct smallint,
p_bApplicable4AllPurchaseItemType smallint,
p_szReturPurchaseTypeId BOS_DT_szId,
p_gdAuditTrailId bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_PUR_PurchaseType
SET 
szDescription = p_szDescription,
szFlexiKeyId = p_szFlexiKeyId,
szApprovalId = p_szApprovalId,
bAllowManualPrice = p_bAllowManualPrice,
bApplicable4AllPurchOrg = p_bApplicable4AllPurchOrg,
bApplicable4AllSupplier = p_bApplicable4AllSupplier,
bApplicable4AllProduct = p_bApplicable4AllProduct,
bApplicable4AllPurchaseItemType = p_bApplicable4AllPurchaseItemType,
szReturPurchaseTypeId = p_szReturPurchaseTypeId,
gdAuditTrailId = p_gdAuditTrailId

WHERE 
szPurchaseTypeId = p_szPurchaseTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_PUR_PurchaseType_UpdatePurchaseType_013(
p_szPurchaseTypeId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szFlexiKeyId BOS_DT_szId,
p_szApprovalId BOS_DT_szId,
p_bAllowManualPrice smallint,
p_bApplicable4AllPurchOrg smallint,
p_bApplicable4AllSupplier smallint,
p_bApplicable4AllProduct smallint,
p_bApplicable4AllPurchaseItemType smallint,
p_szReturPurchaseTypeId BOS_DT_szId,
p_gdAuditTrailId bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_PUR_PurchaseType
SET 
szDescription = p_szDescription,
szFlexiKeyId = p_szFlexiKeyId,
szApprovalId = p_szApprovalId,
bAllowManualPrice = p_bAllowManualPrice,
bApplicable4AllPurchOrg = p_bApplicable4AllPurchOrg,
bApplicable4AllSupplier = p_bApplicable4AllSupplier,
bApplicable4AllProduct = p_bApplicable4AllProduct,
bApplicable4AllPurchaseItemType = p_bApplicable4AllPurchaseItemType,
szReturPurchaseTypeId = p_szReturPurchaseTypeId,
gdAuditTrailId = p_gdAuditTrailId

WHERE 
szPurchaseTypeId = p_szPurchaseTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustCollRoutine_CreateCustCollRoutine(
p_szCustId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_szDefaultRouteId BOS_DT_szBigId,
p_dtmCollection timestamp,
p_dtmLastCollection timestamp,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint,
p_gdAuditTrailId bytea)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustCollRoutine
(
szCustId,
szScheduleId,
szDefaultRouteId,
dtmCollection,
dtmLastCollection,
dtmLastUpdated,
bAlreadyTransferred,
gdAuditTrailId
)
VALUES
(
p_szCustId,
p_szScheduleId,
p_szDefaultRouteId,
p_dtmCollection,
p_dtmLastCollection,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_gdAuditTrailId,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustCollRoutine_CreateCustCollRoutine_DRAFT(
p_szCustId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_szDefaultRouteId BOS_DT_szBigId,
p_dtmCollection timestamp,
p_dtmLastCollection timestamp,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint,
p_gdAuditTrailId bytea)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustCollRoutine_DRAFT
(
szCustId,
szScheduleId,
szDefaultRouteId,
dtmCollection,
dtmLastCollection,
dtmLastUpdated,
bAlreadyTransferred,
gdAuditTrailId
)
VALUES
(
p_szCustId,
p_szScheduleId,
p_szDefaultRouteId,
p_dtmCollection,
p_dtmLastCollection,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_gdAuditTrailId,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustCollRoutine_DeleteCustCollRoutine(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_CustCollRoutine
WHERE
szCustId = p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustCollRoutine_DeleteCustCollRoutine_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_CustCollRoutine_DRAFT
WHERE
szCustId = p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustCollRoutine_GetCustCollRoutine(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
IsNull(BOS_AR_Customer.szName, '') AS szCustNm,

CCR.szScheduleId,
BOS_GEN_RoutineSchedule.szDescription AS szScheduleDesc_J,
BOS_GEN_RoutineSchedule.szScheduleType AS szScheduleType_J,
BGRSI.decValue AS decScheduleValue_J,

CCR.szDefaultRouteId,
BOS_SD_Route.szDescription AS szDefaultRouteDescr_J,
BOS_SD_Route.szOpUserId AS szDefaultCollectorId,
BOS_PI_Employee.szName AS szDefaultCollectorNm,
BOS_PI_Employee.szTeamId AS szDefaultCollectorTeamId_J,

CCR.dtmCollection,
CCR.dtmLastCollection,
CCR.dtmLastUpdated,
CCR.bAlreadyTransferred,
CCR.gdAuditTrailId

FROM
BOS_SD_CustCollRoutine AS CCR
LEFT JOIN BOS_AR_Customer ON CCR.szCustId=BOS_AR_Customer.szCustId
LEFT JOIN BOS_SD_Route ON BOS_SD_Route.szRouteId = CCR.szDefaultRouteId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_Route.szOpUserId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = CCR.szScheduleId
LEFT JOIN BOS_GEN_RoutineScheduleItem AS BGRSI ON BGRSI.szScheduleId = BOS_GEN_RoutineSchedule.szScheduleId AND
BGRSI.shScheduleItem = 0
WHERE
CCR.szCustId = p_szCustId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustCollRoutine_GetCustCollRoutine_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
IsNull(BOS_AR_Customer.szName, '') AS szCustNm,

CCR.szScheduleId,
BOS_GEN_RoutineSchedule.szDescription AS szScheduleDesc_J,
BOS_GEN_RoutineSchedule.szScheduleType AS szScheduleType_J,
BGRSI.decValue AS decScheduleValue_J,

CCR.szDefaultRouteId,
BOS_SD_Route_DRAFT.szDescription AS szDefaultRouteDescr_J,
BOS_SD_Route_DRAFT.szOpUserId AS szDefaultCollectorId,
BOS_PI_Employee.szName AS szDefaultCollectorNm,
BOS_PI_Employee.szTeamId AS szDefaultCollectorTeamId_J,

CCR.dtmCollection,
CCR.dtmLastCollection,
CCR.dtmLastUpdated,
CCR.bAlreadyTransferred,
CCR.gdAuditTrailId

FROM
BOS_SD_CustCollRoutine_DRAFT AS CCR
LEFT JOIN BOS_AR_Customer ON CCR.szCustId=BOS_AR_Customer.szCustId
LEFT JOIN BOS_SD_Route_DRAFT ON BOS_SD_Route_DRAFT.szRouteId = CCR.szDefaultRouteId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_Route_DRAFT.szOpUserId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = CCR.szScheduleId
LEFT JOIN BOS_GEN_RoutineScheduleItem AS BGRSI ON BGRSI.szScheduleId = BOS_GEN_RoutineSchedule.szScheduleId AND
BGRSI.shScheduleItem = 0
WHERE
CCR.szCustId = p_szCustId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustCollRoutine_GetDefaultCollector(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
COALESCE(BSR.szOpUserId, '') As szCollectorId


FROM 
BOS_SD_CustCollRoutine As BSC
Left Join BOS_SD_Route As BSR On BSC.szDefaultRouteId = BSR.szRouteId

WHERE 
BSC.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustCollRoutine_GetDefaultCollector_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
COALESCE(BSR.szOpUserId, '') As szCollectorId


FROM 
BOS_SD_CustCollRoutine_DRAFT As BSC
Left Join BOS_SD_Route_DRAFT As BSR On BSC.szDefaultRouteId = BSR.szRouteId

WHERE 
BSC.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustCollRoutine_GetGuid(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
gdAuditTrailId

FROM 
BOS_SD_CustCollRoutine
WHERE 
szCustId=p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustCollRoutine_GetGuid_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
gdAuditTrailId

FROM 
BOS_SD_CustCollRoutine_DRAFT
WHERE 
szCustId=p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustCollRoutine_GetListOfCustCollRoutine()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId,
szScheduleId,
dtmCollection

FROM 
BOS_SD_CustCollRoutine

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustCollRoutine_GetListOfCustCollRoutine_DRAFT()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId,
szScheduleId,
dtmCollection

FROM 
BOS_SD_CustCollRoutine_DRAFT

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustCollRoutine_IsCustCollRoutineExist(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId

FROM 
BOS_SD_CustCollRoutine
WHERE 
szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustCollRoutine_IsCustCollRoutineExist_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId

FROM 
BOS_SD_CustCollRoutine_DRAFT
WHERE 
szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustCollRoutine_LockCustCollRoutine(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustCollRoutine
SET 
dtmCollection = dtmCollection
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustCollRoutine_LockCustCollRoutine_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustCollRoutine_DRAFT
SET 
dtmCollection = dtmCollection
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustCollRoutine_UpdateCustCollRoutine(
p_szCustId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_szDefaultRouteId BOS_DT_szBigId,
p_dtmCollection timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustCollRoutine
SET 
szScheduleId = p_szScheduleId,
szDefaultRouteId = p_szDefaultRouteId,
dtmCollection = p_dtmCollection
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustCollRoutine_UpdateCustCollRoutine_DRAFT(
p_szCustId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_szDefaultRouteId BOS_DT_szBigId,
p_dtmCollection timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustCollRoutine_DRAFT
SET 
szScheduleId = p_szScheduleId,
szDefaultRouteId = p_szDefaultRouteId,
dtmCollection = p_dtmCollection
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFoc_CreateCustFoc(
p_szCustId BOS_DT_szId,
p_szFocId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustFoc
(
szCustId,
szFocId,
dtmStart,
dtmEnd,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCustId,
p_szFocId,
p_dtmStart,
p_dtmEnd,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFoc_CreateCustFocItem(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szFocType varchar,
p_bUnlimitedQty bit,
p_decQtyRemain BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_dtmLastReset timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustFocItem
(
szCustId,
szProductId,
szFocType,
bUnlimitedQty,
decQtyRemain,
szUomId,
dtmLastReset
)
VALUES
(
p_szCustId,
p_szProductId,
p_szFocType,
p_bUnlimitedQty,
p_decQtyRemain,
p_szUomId,
p_dtmLastReset
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFoc_DecrFocQty(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustFocItem
SET 
 decQtyRemain = decQtyRemain - p_decQty
WHERE 
 szCustId = p_szCustId And szProductId = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFoc_DeleteCustFoc(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_SD_CustFoc
WHERE
szCustId = p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFoc_DeleteCustFocItem(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_SD_CustFocItem
WHERE
szCustId = p_szCustId andszProductId = p_szProductId*/CREATE procedure [dbo].[BOS_SD_CustFoc_DeleteCustFocItem]p_szCustId BOS_DT_szIdas;DELETE 
 from BOS_SD_CustFocItem
WHERE
szCustId = p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFoc_GetCustFoc(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_CustFoc.szFocId,
isnull(BOS_AR_Customer.szName,"") as szCustName,
BOS_SD_CustFoc.dtmStart,
BOS_SD_CustFoc.dtmEnd,

-- Data Status.
BOS_SD_CustFoc.dtmLastUpdated,
BOS_SD_CustFoc.bAlreadyTransferred

FROM 
BOS_SD_CustFoc left join BOS_AR_Customer on BOS_SD_CustFoc.szCustId=BOS_AR_Customer.szCustId
WHERE 
BOS_SD_CustFoc.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFoc_GetCustFoc_013(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_CustFoc.szFocId,
isnull(BOS_AR_Customer.szName,'') as szCustName,
BOS_SD_CustFoc.dtmStart,
BOS_SD_CustFoc.dtmEnd,

-- Data Status.
BOS_SD_CustFoc.dtmLastUpdated,
BOS_SD_CustFoc.bAlreadyTransferred

FROM 
BOS_SD_CustFoc left join BOS_AR_Customer on BOS_SD_CustFoc.szCustId=BOS_AR_Customer.szCustId
WHERE 
BOS_SD_CustFoc.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFoc_GetCustFocItem(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_CustFocItem.szProductId,
COALESCE(BOS_INV_Product.szName, '') As szName,
COALESCE(BOS_INV_Product.szQtyFormat, '') As szProductQtyFormat,
BOS_SD_CustFocItem.szFocType,
BOS_SD_CustFocItem.bUnlimitedQty,
BOS_SD_CustFocItem.decQtyRemain,
BOS_SD_CustFocItem.szUomId,
BOS_SD_CustFocItem.dtmLastReset

FROM 
BOS_SD_CustFocItem LEFT JOIN BOS_INV_Product ON BOS_SD_CustFocItem.szProductId = BOS_INV_Product.szProductIdBOS_SD_CustFocItem LEFT JOIN BOS_INV_Product ON BOS_SD_CustFocItem.szProductId = BOS_INV_Product.szProductId;
WHERE 
szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFoc_GetListOfCustFoc()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId,
szFocId

FROM 
BOS_SD_CustFoc

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFoc_GetListOfFocThatNeedTobeReset(
p_dtmTransaction timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId,szFocId

FROM 
BOS_SD_CustFoc
WHERE 
p_dtmTransaction >= dtmStart and p_dtmTransaction < dateadd(day,1, dtmEnd) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFoc_GetOneCustFocItem(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
select
BOS_SD_CustFocItem.szProductId,
IsNull(BOS_INV_Product.szName, '') As szName,
BOS_SD_CustFocItem.szFocType,
BOS_SD_CustFocItem.bUnlimitedQty,
BOS_SD_CustFocItem.decQtyRemain,
BOS_SD_CustFocItem.szUomId,
BOS_SD_CustFocItem.dtmLastReset,
BOS_SD_CustFoc.dtmStart,
BOS_SD_CustFoc.dtmEnd
from
BOS_SD_CustFocItem
LEFT JOIN
BOS_INV_Product ON BOS_SD_CustFocItem.szProductId = BOS_INV_Product.szProductId
LEFT JOIN
BOS_SD_CustFoc ON BOS_SD_CustFocItem.szCustId = BOS_SD_CustFoc.szCustId
where
BOS_SD_CustFocItem.szCustId = p_szCustId and
BOS_SD_CustFocItem.szProductId = p_szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFoc_IsCustFocExist(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId

FROM 
BOS_SD_CustFoc
WHERE 
szCustId=p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFoc_IsCustFocItemExist(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId

FROM 
BOS_SD_CustFocItem
WHERE 
szCustId=p_szCustId and szProductId=p_szProductId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFoc_LockCustFoc(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustFoc
SET 
szFocId = szFocId
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFoc_UpdateCustFoc(
p_szCustId BOS_DT_szId,
p_szFocId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustFoc
SET 
szFocId = p_szFocId,
dtmStart = p_dtmStart,
dtmEnd = p_dtmEnd
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFoc_UpdateCustFocItemByUsage(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_decQtyRemain BOS_DT_decAmount,
p_szUomId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustFocItem
SET 
decQtyRemain=p_decQtyRemain,
szUomId=p_szUomId
WHERE 
szCustId=p_szCustId AND szProductId=p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFoc_UpdateFocQty(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustFocItem
SET 
 decQtyRemain = p_decQty
WHERE 
 szCustId = p_szCustId And szProductId = p_szProductId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFoc_UpdateOneCustFocItem(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szFocType varchar,
p_bUnlimitedQty bit,
p_decQtyRemain BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_dtmLastReset timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustFocItem
SET 
szFocType = p_szFocType,
bUnlimitedQty = p_bUnlimitedQty,
decQtyRemain = p_decQtyRemain,
szUomId = p_szUomId,
dtmLastReset = p_dtmLastReset
WHERE 
szCustId = p_szCustId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFocHistory_CreateCustFocHistory(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szFocType varchar,
p_dtmFoc timestamp,
p_decAdd BOS_DT_decAmount,
p_decUse BOS_DT_decAmount,
p_decRemain BOS_DT_decAmount,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szUrl varchar,
p_szDescription varchar)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustFocHistory
(
szCustId,
szProductId,
szFocType,
dtmFoc,
decAdd,
decUse,
decRemain,
szTrnId,
szDocId,
szUrl,
szDescription,
)
VALUES
(
p_szCustId,
p_szProductId,
p_szFocType,
p_dtmFoc,
p_decAdd,
p_decUse,
p_decRemain,
p_szTrnId,
p_szDocId,
p_szUrl,
p_szDescription,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFocHistory_CreateCustFocHistory_013(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szFocType varchar,
p_dtmFoc timestamp,
p_decAdd BOS_DT_decAmount,
p_decUse BOS_DT_decAmount,
p_decRemain BOS_DT_decAmount,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szUrl varchar,
p_szDescription varchar)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustFocHistory
(
szCustId,
szProductId,
szFocType,
dtmFoc,
decAdd,
decUse,
decRemain,
szTrnId,
szDocId,
szUrl,
szDescription,
)
VALUES
(
p_szCustId,
p_szProductId,
p_szFocType,
p_dtmFoc,
p_decAdd,
p_decUse,
p_decRemain,
p_szTrnId,
p_szDocId,
p_szUrl,
p_szDescription,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFocHistory_GetListOfCustFocHistory(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_dtmStartDate timestamp,
p_dtmEndDate timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_CustFocHistory.szCustId,
BOS_SD_CustFocHistory.szProductId,
BOS_INV_Product.szName AS szProductNm_J,
BOS_INV_Product.szQtyFormat,
BOS_SD_CustFocHistory.szFocType,
BOS_SD_CustFocHistory.dtmFoc,
BOS_SD_CustFocHistory.decAdd,
BOS_SD_CustFocHistory.decUse,
BOS_SD_CustFocHistory.decRemain,
BOS_SD_CustFocHistory.szTrnId,
BOS_SD_CustFocHistory.szDocId,
BOS_SD_CustFocHistory.szUrl,
BOS_SD_CustFocHistory.szDescription


FROM 
BOS_SD_CustFocHistory
left join BOS_INV_Product ON BOS_SD_CustFocHistory.szProductId=BOS_INV_Product.szProductId
WHERE 
BOS_SD_CustFocHistory.szCustId LIKE p_szCustId and BOS_SD_CustFocHistory.szProductId LIKE p_szProductId and (BOS_SD_CustFocHistory.dtmFoc >= p_dtmStartDate and BOS_SD_CustFocHistory.dtmFoc < dateadd(day,1, p_dtmEndDate) ) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustFocHistory_GetListOfProductOfCustFocHistory(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
BOS_SD_CustFocHistory.szProductId,

FROM 
BOS_SD_CustFocHistory
LEFT JOIN BOS_INV_Product ON BOS_SD_CustFocHistory.szProductId = BOS_INV_Product.szProductIdLEFT JOIN BOS_INV_Product ON BOS_SD_CustFocHistory.szProductId = BOS_INV_Product.szProductId;
WHERE 
BOS_SD_CustFocHistory.szCustId LIKE p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_CreateCustRoutine(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmDelivery timestamp,
p_szLastFDoId BOS_DT_szId,
p_szNote BOS_DT_szDescription,
p_szDOPrintPaperType varchar,
p_szDOPrintType varchar,
p_gdAuditTrailId bytea,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustRoutine
(
szCustId,
szDefaultTeamId,
szDefaultScheduleId,
decDefaultScheduleValue,
szDefaultRouteId,
szDefaultOrderTypeId,
dtmDelivery,
szLastFDoId,
szNote,
szDOPrintPaperType,
szDOPrintType,
gdAuditTrailId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCustId,
p_szDefaultTeamId,
p_szDefaultScheduleId,
p_decDefaultScheduleValue,
p_szDefaultRouteId,
p_szDefaultOrderTypeId,
p_dtmDelivery,
p_szLastFDoId,
p_szNote,
p_szDOPrintPaperType,
p_szDOPrintType,
p_gdAuditTrailId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_CreateCustRoutine_013(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmDelivery timestamp,
p_szLastFDoId BOS_DT_szId,
p_szNote BOS_DT_szDescription,
p_szDOPrintPaperType varchar,
p_szDOPrintType varchar,
p_gdAuditTrailId bytea,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustRoutine
(
szCustId,
szDefaultTeamId,
szDefaultScheduleId,
decDefaultScheduleValue,
szDefaultRouteId,
szDefaultOrderTypeId,
dtmDelivery,
szLastFDoId,
szNote,
szDOPrintPaperType,
szDOPrintType,
gdAuditTrailId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCustId,
p_szDefaultTeamId,
p_szDefaultScheduleId,
p_decDefaultScheduleValue,
p_szDefaultRouteId,
p_szDefaultOrderTypeId,
p_dtmDelivery,
p_szLastFDoId,
p_szNote,
p_szDOPrintPaperType,
p_szDOPrintType,
p_gdAuditTrailId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_CreateCustRoutine_013_DRAFT(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmDelivery timestamp,
p_szLastFDoId BOS_DT_szId,
p_szNote BOS_DT_szDescription,
p_szDOPrintPaperType varchar,
p_szDOPrintType varchar,
p_gdAuditTrailId bytea,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustRoutine_DRAFT
(
szCustId,
szDefaultTeamId,
szDefaultScheduleId,
decDefaultScheduleValue,
szDefaultRouteId,
szDefaultOrderTypeId,
dtmDelivery,
szLastFDoId,
szNote,
szDOPrintPaperType,
szDOPrintType,
gdAuditTrailId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCustId,
p_szDefaultTeamId,
p_szDefaultScheduleId,
p_decDefaultScheduleValue,
p_szDefaultRouteId,
p_szDefaultOrderTypeId,
p_dtmDelivery,
p_szLastFDoId,
p_szNote,
p_szDOPrintPaperType,
p_szDOPrintType,
p_gdAuditTrailId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_CreateCustRoutine_DRAFT(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmDelivery timestamp,
p_szLastFDoId BOS_DT_szId,
p_szNote BOS_DT_szDescription,
p_szDOPrintPaperType varchar,
p_szDOPrintType varchar,
p_gdAuditTrailId bytea,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustRoutine_DRAFT
(
szCustId,
szDefaultTeamId,
szDefaultScheduleId,
decDefaultScheduleValue,
szDefaultRouteId,
szDefaultOrderTypeId,
dtmDelivery,
szLastFDoId,
szNote,
szDOPrintPaperType,
szDOPrintType,
gdAuditTrailId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCustId,
p_szDefaultTeamId,
p_szDefaultScheduleId,
p_decDefaultScheduleValue,
p_szDefaultRouteId,
p_szDefaultOrderTypeId,
p_dtmDelivery,
p_szLastFDoId,
p_szNote,
p_szDOPrintPaperType,
p_szDOPrintType,
p_gdAuditTrailId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_CreateCustRoutine_DRAFT_013(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmDelivery timestamp,
p_szLastFDoId BOS_DT_szId,
p_szNote BOS_DT_szDescription,
p_szDOPrintPaperType varchar,
p_szDOPrintType varchar,
p_gdAuditTrailId bytea,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustRoutine_DRAFT
(
szCustId,
szDefaultTeamId,
szDefaultScheduleId,
decDefaultScheduleValue,
szDefaultRouteId,
szDefaultOrderTypeId,
dtmDelivery,
szLastFDoId,
szNote,
szDOPrintPaperType,
szDOPrintType,
gdAuditTrailId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCustId,
p_szDefaultTeamId,
p_szDefaultScheduleId,
p_decDefaultScheduleValue,
p_szDefaultRouteId,
p_szDefaultOrderTypeId,
p_dtmDelivery,
p_szLastFDoId,
p_szNote,
p_szDOPrintPaperType,
p_szDOPrintType,
p_gdAuditTrailId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_CreateCustRoutineItem(
p_szCustId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_bPrintPrice bit,
p_szTeamId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_decValue BOS_DT_decAmount,
p_decAvgOrder BOS_DT_decAmount,
p_decMaxDropSize BOS_DT_decQty,
p_szParentId BOS_DT_szId,
p_szParentNm BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustRoutineItem
(
szCustId,
shItemNumber,
szProductId,
decQty,
szUomId,
bPrintPrice,
szTeamId,
szScheduleId,
decValue,
decAvgOrder,
decMaxDropSize,
szParentId,
szParentNm
)
VALUES
(
p_szCustId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_bPrintPrice,
p_szTeamId,
p_szScheduleId,
p_decValue,
p_decAvgOrder,
p_decMaxDropSize,
p_szParentId,
p_szParentNm,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_CreateCustRoutineItem_013(
p_szCustId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_bPrintPrice bit,
p_szTeamId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_decValue BOS_DT_decAmount,
p_decAvgOrder BOS_DT_decAmount,
p_decMaxDropSize BOS_DT_decQty,
p_szParentId BOS_DT_szId,
p_szParentNm BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustRoutineItem
(
szCustId,
shItemNumber,
szProductId,
decQty,
szUomId,
bPrintPrice,
szTeamId,
szScheduleId,
decValue,
decAvgOrder,
decMaxDropSize,
szParentId,
szParentNm
)
VALUES
(
p_szCustId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_bPrintPrice,
p_szTeamId,
p_szScheduleId,
p_decValue,
p_decAvgOrder,
p_decMaxDropSize,
p_szParentId,
p_szParentNm,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_CreateCustRoutineItem_013_DRAFT(
p_szCustId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_bPrintPrice bit,
p_szTeamId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_decValue BOS_DT_decAmount,
p_decAvgOrder BOS_DT_decAmount,
p_decMaxDropSize BOS_DT_decQty,
p_szParentId BOS_DT_szId,
p_szParentNm BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustRoutineItem_DRAFT
(
szCustId,
shItemNumber,
szProductId,
decQty,
szUomId,
bPrintPrice,
szTeamId,
szScheduleId,
decValue,
decAvgOrder,
decMaxDropSize,
szParentId,
szParentNm
)
VALUES
(
p_szCustId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_bPrintPrice,
p_szTeamId,
p_szScheduleId,
p_decValue,
p_decAvgOrder,
p_decMaxDropSize,
p_szParentId,
p_szParentNm,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_CreateCustRoutineItem_DRAFT(
p_szCustId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_bPrintPrice bit,
p_szTeamId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_decValue BOS_DT_decAmount,
p_decAvgOrder BOS_DT_decAmount,
p_decMaxDropSize BOS_DT_decQty,
p_szParentId BOS_DT_szId,
p_szParentNm BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustRoutineItem_DRAFT
(
szCustId,
shItemNumber,
szProductId,
decQty,
szUomId,
bPrintPrice,
szTeamId,
szScheduleId,
decValue,
decAvgOrder,
decMaxDropSize,
szParentId,
szParentNm
)
VALUES
(
p_szCustId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_bPrintPrice,
p_szTeamId,
p_szScheduleId,
p_decValue,
p_decAvgOrder,
p_decMaxDropSize,
p_szParentId,
p_szParentNm,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_CreateCustRoutineItem_DRAFT_013(
p_szCustId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_bPrintPrice bit,
p_szTeamId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_decValue BOS_DT_decAmount,
p_decAvgOrder BOS_DT_decAmount,
p_decMaxDropSize BOS_DT_decQty,
p_szParentId BOS_DT_szId,
p_szParentNm BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustRoutineItem_DRAFT
(
szCustId,
shItemNumber,
szProductId,
decQty,
szUomId,
bPrintPrice,
szTeamId,
szScheduleId,
decValue,
decAvgOrder,
decMaxDropSize,
szParentId,
szParentNm
)
VALUES
(
p_szCustId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_bPrintPrice,
p_szTeamId,
p_szScheduleId,
p_decValue,
p_decAvgOrder,
p_decMaxDropSize,
p_szParentId,
p_szParentNm,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_DeleteCustRoutine(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_CustRoutine
WHERE
szCustId = p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_DeleteCustRoutine_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_CustRoutine_DRAFT
WHERE
szCustId = p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_DeleteCustRoutineItem(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_CustRoutineItem
WHERE
szCustId = p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_DeleteCustRoutineItem_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_CustRoutineItem_DRAFT
WHERE
szCustId = p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetCustRoutine(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
IsNull(BOS_AR_Customer.szName, '') AS szCustNm,

BOS_SD_CustRoutine.szDefaultTeamId,
BOS_SD_CustRoutine.szDefaultScheduleId,
BOS_GEN_RoutineSchedule.szDescription AS szDefaultScheduleDesc_J,

BOS_SD_CustRoutine.decDefaultScheduleValue,

BOS_SD_CustRoutine.szDefaultRouteId,
BOS_SD_Route.szDescription AS szDefaultRouteDescription,
BOS_SD_Route.szOpUserId AS szDefaultDriverId,
BOS_PI_Employee.szName as szDefaultDriverNm,
BOS_PI_Employee.szTeamId AS szDefaultDriverTeamId_J,

BOS_SD_CustRoutine.szDefaultOrderTypeId,
BOS_SD_CustRoutine.dtmDelivery,
BOS_SD_CustRoutine.szLastFDoId,
BOS_SD_CustRoutine.szNote,
BOS_SD_CustRoutine.szDOPrintPaperType,
BOS_SD_CustRoutine.szDOPrintType,
IsNull(BOS_AR_Customer.szDistrChannelId, '') As szCustDistrChannelId_J,
IsNull(BOS_SD_DistrChannel.szName, '') As szCustDistrChannelNm_J,
BOS_SD_CustRoutine.gdAuditTrailId,
BOS_SD_CustRoutine.dtmLastUpdated,
BOS_SD_CustRoutine.bAlreadyTransferred
FROM
BOS_SD_CustRoutine
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_CustRoutine.szCustId
LEFT JOIN BOS_SD_Route ON BOS_SD_Route.szRouteId = BOS_SD_CustRoutine.szDefaultRouteId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_Route.szOpUserId
LEFT JOIN BOS_SD_DistrChannel ON BOS_AR_Customer.szDistrChannelId = BOS_SD_DistrChannel.szDistrChannelId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = BOS_SD_CustRoutine.szDefaultScheduleId
WHERE
BOS_SD_CustRoutine.szCustId = p_szCustId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetCustRoutine_014(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
IsNull(BOS_AR_Customer.szName, '') AS szCustNm,

BOS_SD_CustRoutine.szDefaultTeamId,
BOS_SD_CustRoutine.szDefaultScheduleId,
BOS_GEN_RoutineSchedule.szDescription AS szDefaultScheduleDesc_J,

BOS_SD_CustRoutine.decDefaultScheduleValue,

BOS_SD_CustRoutine.szDefaultRouteId,
BOS_SD_Route.szDescription AS szDefaultRouteDescription,
BOS_SD_Route.szOpUserId AS szDefaultDriverId,
BOS_PI_Employee.szName as szDefaultDriverNm,
BOS_PI_Employee.szTeamId AS szDefaultDriverTeamId_J,

BOS_SD_CustRoutine.szDefaultOrderTypeId,
BOS_SD_CustRoutine.dtmDelivery,
BOS_SD_CustRoutine.szLastFDoId,
BOS_SD_CustRoutine.szNote,
BOS_SD_CustRoutine.szDOPrintPaperType,
BOS_SD_CustRoutine.szDOPrintType,
IsNull(BOS_AR_Customer.szDistrChannelId, '') As szCustDistrChannelId_J,
IsNull(BOS_SD_DistrChannel.szName, '') As szCustDistrChannelNm_J,
BOS_SD_CustRoutine.gdAuditTrailId,
BOS_SD_CustRoutine.dtmLastUpdated,
BOS_SD_CustRoutine.bAlreadyTransferred
FROM
BOS_SD_CustRoutine
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_CustRoutine.szCustId
LEFT JOIN BOS_SD_Route ON BOS_SD_Route.szRouteId = BOS_SD_CustRoutine.szDefaultRouteId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_Route.szOpUserId
LEFT JOIN BOS_SD_DistrChannel ON BOS_AR_Customer.szDistrChannelId = BOS_SD_DistrChannel.szDistrChannelId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = BOS_SD_CustRoutine.szDefaultScheduleId
WHERE
BOS_SD_CustRoutine.szCustId = p_szCustId


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetCustRoutine_014_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
IsNull(BOS_AR_Customer.szName, '') AS szCustNm,

BOS_SD_CustRoutine_DRAFT.szDefaultTeamId,
BOS_SD_CustRoutine_DRAFT.szDefaultScheduleId,
BOS_GEN_RoutineSchedule.szDescription AS szDefaultScheduleDesc_J,

BOS_SD_CustRoutine_DRAFT.decDefaultScheduleValue,

BOS_SD_CustRoutine_DRAFT.szDefaultRouteId,
BOS_SD_Route_DRAFT.szDescription AS szDefaultRouteDescription,
BOS_SD_Route_DRAFT.szOpUserId AS szDefaultDriverId,
BOS_PI_Employee.szName as szDefaultDriverNm,
BOS_PI_Employee.szTeamId AS szDefaultDriverTeamId_J,

BOS_SD_CustRoutine_DRAFT.szDefaultOrderTypeId,
BOS_SD_CustRoutine_DRAFT.dtmDelivery,
BOS_SD_CustRoutine_DRAFT.szLastFDoId,
BOS_SD_CustRoutine_DRAFT.szNote,
BOS_SD_CustRoutine_DRAFT.szDOPrintPaperType,
BOS_SD_CustRoutine_DRAFT.szDOPrintType,
IsNull(BOS_AR_Customer.szDistrChannelId, '') As szCustDistrChannelId_J,
IsNull(BOS_SD_DistrChannel.szName, '') As szCustDistrChannelNm_J,
BOS_SD_CustRoutine_DRAFT.gdAuditTrailId,
BOS_SD_CustRoutine_DRAFT.dtmLastUpdated,
BOS_SD_CustRoutine_DRAFT.bAlreadyTransferred

FROM
BOS_SD_CustRoutine_DRAFT
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_CustRoutine_DRAFT.szCustId
LEFT JOIN BOS_SD_Route_DRAFT ON BOS_SD_Route_DRAFT.szRouteId = BOS_SD_CustRoutine_DRAFT.szDefaultRouteId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_Route_DRAFT.szOpUserId
LEFT JOIN BOS_SD_DistrChannel ON BOS_AR_Customer.szDistrChannelId = BOS_SD_DistrChannel.szDistrChannelId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = BOS_SD_CustRoutine_DRAFT.szDefaultScheduleId

WHERE
BOS_SD_CustRoutine_DRAFT.szCustId = p_szCustId


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetCustRoutine_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
IsNull(BOS_AR_Customer.szName, '') AS szCustNm,

BOS_SD_CustRoutine_DRAFT.szDefaultTeamId,
BOS_SD_CustRoutine_DRAFT.szDefaultScheduleId,
BOS_GEN_RoutineSchedule.szDescription AS szDefaultScheduleDesc_J,

BOS_SD_CustRoutine_DRAFT.decDefaultScheduleValue,

BOS_SD_CustRoutine_DRAFT.szDefaultRouteId,
BOS_SD_Route_DRAFT.szDescription AS szDefaultRouteDescription,
BOS_SD_Route_DRAFT.szOpUserId AS szDefaultDriverId,
BOS_PI_Employee.szName as szDefaultDriverNm,
BOS_PI_Employee.szTeamId AS szDefaultDriverTeamId_J,

BOS_SD_CustRoutine_DRAFT.szDefaultOrderTypeId,
BOS_SD_CustRoutine_DRAFT.dtmDelivery,
BOS_SD_CustRoutine_DRAFT.szLastFDoId,
BOS_SD_CustRoutine_DRAFT.szNote,
BOS_SD_CustRoutine_DRAFT.szDOPrintPaperType,
BOS_SD_CustRoutine_DRAFT.szDOPrintType,
IsNull(BOS_AR_Customer.szDistrChannelId, '') As szCustDistrChannelId_J,
IsNull(BOS_SD_DistrChannel.szName, '') As szCustDistrChannelNm_J,
BOS_SD_CustRoutine_DRAFT.gdAuditTrailId,
BOS_SD_CustRoutine_DRAFT.dtmLastUpdated,
BOS_SD_CustRoutine_DRAFT.bAlreadyTransferred

FROM
BOS_SD_CustRoutine_DRAFT
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_CustRoutine_DRAFT.szCustId
LEFT JOIN BOS_SD_Route_DRAFT ON BOS_SD_Route_DRAFT.szRouteId = BOS_SD_CustRoutine_DRAFT.szDefaultRouteId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_Route_DRAFT.szOpUserId
LEFT JOIN BOS_SD_DistrChannel ON BOS_AR_Customer.szDistrChannelId = BOS_SD_DistrChannel.szDistrChannelId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = BOS_SD_CustRoutine_DRAFT.szDefaultScheduleId

WHERE
BOS_SD_CustRoutine_DRAFT.szCustId = p_szCustId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetCustRoutineItem(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_CustRoutineItem.shItemNumber,
BOS_SD_CustRoutineItem.szProductId,

BOS_INV_Product.szName as szProductName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,

BOS_SD_CustRoutineItem.decQty,
BOS_SD_CustRoutineItem.szUomId,
BOS_SD_CustRoutineItem.bPrintPrice,

BOS_SD_CustRoutineItem.szTeamId,
BOS_SD_CustRoutineItem.szScheduleId,
BOS_GEN_RoutineSchedule.szDescription AS szScheduleDesc_J,
BOS_GEN_RoutineSchedule.szScheduleType AS szScheduleType_J,

BOS_SD_CustRoutineItem.decValue,

BOS_SD_CustRoutineItem.decAvgOrder,

BOS_SD_CustRoutineItem.decMaxDropSize,
BOS_SD_CustRoutineItem.szParentId,
BOS_SD_CustRoutineItem.szParentNm

FROM
BOS_SD_CustRoutineItem 
LEFT JOIN BOS_INV_Product ON BOS_SD_CustRoutineItem.szProductId = BOS_INV_Product.szProductId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = BOS_SD_CustRoutineItem.szScheduleId

WHERE
szCustId = p_szCustId

ORDER BY
BOS_SD_CustRoutineItem.szScheduleId,
BOS_SD_CustRoutineItem.shItemNumber,
BOS_SD_CustRoutineItem.decValue,
BOS_SD_CustRoutineItem.szProductId

-- ==================================================================

set ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetCustRoutineItem_014(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_CustRoutineItem.shItemNumber,
BOS_SD_CustRoutineItem.szProductId,

BOS_INV_Product.szName as szProductName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,

BOS_SD_CustRoutineItem.decQty,
BOS_SD_CustRoutineItem.szUomId,
BOS_SD_CustRoutineItem.bPrintPrice,

BOS_SD_CustRoutineItem.szTeamId,
BOS_SD_CustRoutineItem.szScheduleId,
BOS_GEN_RoutineSchedule.szDescription AS szScheduleDesc_J,
BOS_GEN_RoutineSchedule.szScheduleType AS szScheduleType_J,

BOS_SD_CustRoutineItem.decValue,

BOS_SD_CustRoutineItem.decAvgOrder,

BOS_SD_CustRoutineItem.decMaxDropSize,
BOS_SD_CustRoutineItem.szParentId,
BOS_SD_CustRoutineItem.szParentNm

FROM
BOS_SD_CustRoutineItem 
LEFT JOIN BOS_INV_Product ON BOS_SD_CustRoutineItem.szProductId = BOS_INV_Product.szProductId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = BOS_SD_CustRoutineItem.szScheduleId

WHERE
szCustId = p_szCustId

ORDER BY
BOS_SD_CustRoutineItem.szScheduleId,
BOS_SD_CustRoutineItem.shItemNumber,
BOS_SD_CustRoutineItem.decValue,
BOS_SD_CustRoutineItem.szProductId

-- ==================================================================

set ANSI_NULLS ON


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetCustRoutineItem_014_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_CustRoutineItem_DRAFT.shItemNumber,
BOS_SD_CustRoutineItem_DRAFT.szProductId,

BOS_INV_Product.szName as szProductName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,

BOS_SD_CustRoutineItem_DRAFT.decQty,
BOS_SD_CustRoutineItem_DRAFT.szUomId,
BOS_SD_CustRoutineItem_DRAFT.bPrintPrice,

BOS_SD_CustRoutineItem_DRAFT.szTeamId,
BOS_SD_CustRoutineItem_DRAFT.szScheduleId,
BOS_GEN_RoutineSchedule.szDescription AS szScheduleDesc_J,
BOS_GEN_RoutineSchedule.szScheduleType AS szScheduleType_J,

BOS_SD_CustRoutineItem_DRAFT.decValue,

BOS_SD_CustRoutineItem_DRAFT.decAvgOrder,

BOS_SD_CustRoutineItem_DRAFT.decMaxDropSize,
BOS_SD_CustRoutineItem_DRAFT.szParentId,
--BOS_SD_CustRoutineItem_DRAFT.szParentNm
BIP2.szName AS szParentNm

FROM
BOS_SD_CustRoutineItem_DRAFT
LEFT JOIN BOS_INV_Product ON BOS_SD_CustRoutineItem_DRAFT.szProductId = BOS_INV_Product.szProductId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = BOS_SD_CustRoutineItem_DRAFT.szScheduleId
LEFT JOIN BOS_INV_Product AS BIP2 ON BIP2.szProductId = BOS_SD_CustRoutineItem_DRAFT.szParentId

WHERE
szCustId = p_szCustId

ORDER BY
BOS_SD_CustRoutineItem_DRAFT.szScheduleId,
BOS_SD_CustRoutineItem_DRAFT.shItemNumber,
BOS_SD_CustRoutineItem_DRAFT.decValue,
BOS_SD_CustRoutineItem_DRAFT.szProductId

-- ==================================================================

set ANSI_NULLS ON


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetCustRoutineItem_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_CustRoutineItem_DRAFT.shItemNumber,
BOS_SD_CustRoutineItem_DRAFT.szProductId,

BOS_INV_Product.szName as szProductName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,

BOS_SD_CustRoutineItem_DRAFT.decQty,
BOS_SD_CustRoutineItem_DRAFT.szUomId,
BOS_SD_CustRoutineItem_DRAFT.bPrintPrice,

BOS_SD_CustRoutineItem_DRAFT.szTeamId,
BOS_SD_CustRoutineItem_DRAFT.szScheduleId,
BOS_GEN_RoutineSchedule.szDescription AS szScheduleDesc_J,
BOS_GEN_RoutineSchedule.szScheduleType AS szScheduleType_J,

BOS_SD_CustRoutineItem_DRAFT.decValue,

BOS_SD_CustRoutineItem_DRAFT.decAvgOrder,

BOS_SD_CustRoutineItem_DRAFT.decMaxDropSize,
BOS_SD_CustRoutineItem_DRAFT.szParentId,
--BOS_SD_CustRoutineItem_DRAFT.szParentNm
BIP2.szName AS szParentNm

FROM
BOS_SD_CustRoutineItem_DRAFT
LEFT JOIN BOS_INV_Product ON BOS_SD_CustRoutineItem_DRAFT.szProductId = BOS_INV_Product.szProductId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = BOS_SD_CustRoutineItem_DRAFT.szScheduleId
LEFT JOIN BOS_INV_Product AS BIP2 ON BIP2.szProductId = BOS_SD_CustRoutineItem_DRAFT.szParentId

WHERE
szCustId = p_szCustId

ORDER BY
BOS_SD_CustRoutineItem_DRAFT.szScheduleId,
BOS_SD_CustRoutineItem_DRAFT.shItemNumber,
BOS_SD_CustRoutineItem_DRAFT.decValue,
BOS_SD_CustRoutineItem_DRAFT.szProductId

-- ==================================================================

set ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetDefaultDriver(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
COALESCE(BSR.szOpUserId, '') As szDriverId


FROM 
BOS_SD_CustRoutine As BSC Left Join BOS_SD_Route As BSR On BSC.szDefaultRouteId = BSR.szRouteId

WHERE 
BSC.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetDefaultDriver_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
COALESCE(BSR.szOpUserId, '') As szDriverId


FROM 
BOS_SD_CustRoutine_DRAFT As BSC
Left Join BOS_SD_Route_DRAFT As BSR On BSC.szDefaultRouteId = BSR.szRouteId

WHERE 
BSC.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetGuid(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
gdAuditTrailId

FROM 
BOS_SD_CustRoutine
WHERE 
szCustId=p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetGuid_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
gdAuditTrailId

FROM 
BOS_SD_CustRoutine_DRAFT
WHERE 
szCustId=p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetListOfAverageOrder(
p_szCustId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSDI.szProductId,
BSDI.szUomId,
--NICE FINDING :) COUNT OF PRODUCT ID CANNOT BE ZERO BECOZ IF IT IS,
--THERE WILL BE NO QUANTITY TO BE SUMMED UP TOO.
Convert(Decimal(18, 2), Sum(BSDI.decQty) / COUNT(BSDI.szProductId)) As decQty

FROM 
BOS_SD_FDo As BSD
Inner Join BOS_SD_FDoItem As BSDI On BSD.szDoId = BSDI.szDoId
WHERE 
BSD.dtmDelivery >= p_dtmFrom And BSD.dtmDelivery < dateadd(day, 1, p_dtmTo) And BSD.szCustId = p_szCustId AND bApplied = 1 AND BSDI.szProductId <> ''	--DISCOUNT AND ALIKE HAVE NO PRODUCT ID, AND SHOULD NOT BE CALCULATED. Group By BSDI.szProductId, BSDI.szUomId ;ORDER BY 
BSDI.szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetListOfAverageOrderAllCustomer(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp)
RETURNS void AS
$BODY$
BEGIN

Select
BSC.szCustId,
BAC.szName As szCustName,
BSDI.szProductId,
BIP.szName As szProductName,
BIP.szQtyFormat AS szProductQtyFormat_J,
BSDI.szUomId,
BSCRI.szTeamId,
BSCRI.szScheduleId,
BSCRI.decValue,
BSC.szDefaultTeamId,
BSC.szDefaultScheduleId,
BSC.decDefaultScheduleValue,
BSCRI.bPrintPrice,
BSCRI.decQty,
Convert(Decimal(18, 2), Sum(BSDI.decQty) / COUNT(BSDI.szProductId)) As decAvgOrder

From
BOS_SD_CustRoutine As BSC
Left Join BOS_AR_Customer As BAC On BAC.szCustId = BSC.szCustId
LEFT JOIN BOS_SD_FDo As BSD On BSD.szCustId = BSC.szCustId
LEFT JOIN BOS_SD_FDoItem As BSDI On BSDI.szDoId = BSD.szDoId
Left Join BOS_INV_Product As BIP On BIP.szProductId = BSDI.szProductId
LEFT JOIN BOS_SD_CustRoutineItem AS BSCRI ON BSCRI.szCustId = BSC.szCustId
AND BSCRI.szProductId = BSDI.szProductId AND BSCRI.szUomId = BSDI.szUomId

Where
BAC.szDlvWorkplaceId LIKE p_szWorkplaceId
AND BSD.bApplied = 1
AND BSD.dtmDelivery >= p_dtmFrom 
And BSD.dtmDelivery < DATEADD(DAY, 1, p_dtmTo)
AND BSDI.szProductId <> ''	--DISCOUNT AND ALIKE HAVE NO PRODUCT ID, AND SHOULD NOT BE CALCULATED.

Group By
BSC.szCustId,
BAC.szName,
BSDI.szProductId,
BIP.szName,
BIP.szQtyFormat,
BSDI.szUomId,
BSCRI.szTeamId,
BSCRI.szScheduleId,
BSCRI.decValue,
BSC.szDefaultTeamId,
BSC.szDefaultScheduleId,
BSC.decDefaultScheduleValue,
BSCRI.bPrintPrice,
BSCRI.decQty

Order By
BSC.szCustId,
BSDI.szProductId,
BSDI.szUomId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetListOfAverageOrderAllCustomer_DRAFT(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp)
RETURNS void AS
$BODY$
BEGIN

Select
BSC.szCustId,
BAC.szName As szCustName,
BSDI.szProductId,
BIP.szName As szProductName,
BIP.szQtyFormat AS szProductQtyFormat_J,
BSDI.szUomId,
BSCRI.szTeamId,
BSCRI.szScheduleId,
BSCRI.decValue,
BSC.szDefaultTeamId,
BSC.szDefaultScheduleId,
BSC.decDefaultScheduleValue,
BSCRI.bPrintPrice,
BSCRI.decQty,
Convert(Decimal(18, 2), Sum(BSDI.decQty) / COUNT(BSDI.szProductId)) As decAvgOrder

From
BOS_SD_CustRoutine_DRAFT As BSC
Left Join BOS_AR_Customer As BAC On BAC.szCustId = BSC.szCustId
LEFT JOIN BOS_SD_FDo As BSD On BSD.szCustId = BSC.szCustId
LEFT JOIN BOS_SD_FDoItem As BSDI On BSDI.szDoId = BSD.szDoId
Left Join BOS_INV_Product As BIP On BIP.szProductId = BSDI.szProductId
LEFT JOIN BOS_SD_CustRoutineItem_DRAFT AS BSCRI ON BSCRI.szCustId = BSC.szCustId
AND BSCRI.szProductId = BSDI.szProductId AND BSCRI.szUomId = BSDI.szUomId

Where
BAC.szDlvWorkplaceId LIKE p_szWorkplaceId
AND BSD.bApplied = 1
AND BSD.dtmDelivery >= p_dtmFrom 
And BSD.dtmDelivery < DATEADD(DAY, 1, p_dtmTo)
AND BSDI.szProductId <> ''	--DISCOUNT AND ALIKE HAVE NO PRODUCT ID, AND SHOULD NOT BE CALCULATED.

Group By
BSC.szCustId,
BAC.szName,
BSDI.szProductId,
BIP.szName,
BIP.szQtyFormat,
BSDI.szUomId,
BSCRI.szTeamId,
BSCRI.szScheduleId,
BSCRI.decValue,
BSC.szDefaultTeamId,
BSC.szDefaultScheduleId,
BSC.decDefaultScheduleValue,
BSCRI.bPrintPrice,
BSCRI.decQty

Order By
BSC.szCustId,
BSDI.szProductId,
BSDI.szUomId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetListOfCustRoutine()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId,
dtmDelivery

FROM 
BOS_SD_CustRoutine

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetListOfCustRoutine_DRAFT()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId,
dtmDelivery

FROM 
BOS_SD_CustRoutine_DRAFT

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetListOfProductOnDay(
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_szScheduleType BOS_DT_szSmallId,
p_decValue BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSCI.szProductId, COALESCE(BIP.szName, '') As szProductName, BSCI.decQty

FROM 
BOS_SD_CustRoutine As BSC
Inner Join BOS_SD_CustRoutineItem As BSCI ON BSC.szCustId = BSCI.szCustId
LEFT JOIN BOS_GEN_RoutineSchedule BGRS ON BGRS.szScheduleId = BSCI.szScheduleIdLEFT JOIN BOS_GEN_RoutineSchedule BGRS ON BGRS.szScheduleId = BSCI.szScheduleId;
Left Join BOS_INV_Product As BIP ON BSCI.szProductId = BIP.szProductId
WHERE 
BSC.szCustId = p_szCustId And BGRS.szScheduleType = p_szScheduleType And BSCI.decValue = p_decValue AND BSCI.szTeamId = p_szTeamId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetListOfProductOnDay_013(
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_szScheduleType BOS_DT_szSmallId,
p_decValue BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSCI.szProductId, COALESCE(BIP.szName, '') As szProductName, BSCI.decQty

FROM 
BOS_SD_CustRoutine As BSC
Inner Join BOS_SD_CustRoutineItem As BSCI ON BSC.szCustId = BSCI.szCustId
LEFT JOIN BOS_GEN_RoutineSchedule BGRS ON BGRS.szScheduleId = BSCI.szScheduleIdLEFT JOIN BOS_GEN_RoutineSchedule BGRS ON BGRS.szScheduleId = BSCI.szScheduleId;
Left Join BOS_INV_Product As BIP ON BSCI.szProductId = BIP.szProductId
WHERE 
BSC.szCustId = p_szCustId And BGRS.szScheduleType = p_szScheduleType And BSCI.decValue = p_decValue AND BSCI.szTeamId = p_szTeamId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetListOfProductOnDay_DRAFT(
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_szScheduleType BOS_DT_szSmallId,
p_decValue BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSCI.szProductId, COALESCE(BIP.szName, '') As szProductName, BSCI.decQty

FROM 
BOS_SD_CustRoutine_DRAFT As BSC
Inner Join BOS_SD_CustRoutineItem_DRAFT As BSCI ON BSC.szCustId = BSCI.szCustId
LEFT JOIN BOS_GEN_RoutineSchedule BGRS ON BGRS.szScheduleId = BSCI.szScheduleIdLEFT JOIN BOS_GEN_RoutineSchedule BGRS ON BGRS.szScheduleId = BSCI.szScheduleId;
Left Join BOS_INV_Product As BIP ON BSCI.szProductId = BIP.szProductId
WHERE 
BSC.szCustId = p_szCustId And BGRS.szScheduleType = p_szScheduleType And BSCI.decValue = p_decValue AND BSCI.szTeamId = p_szTeamId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_GetListOfProductOnDay_DRAFT_013(
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_szScheduleType BOS_DT_szSmallId,
p_decValue BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSCI.szProductId, COALESCE(BIP.szName, '') As szProductName, BSCI.decQty

FROM 
BOS_SD_CustRoutine_DRAFT As BSC
Inner Join BOS_SD_CustRoutineItem_DRAFT As BSCI ON BSC.szCustId = BSCI.szCustId
LEFT JOIN BOS_GEN_RoutineSchedule BGRS ON BGRS.szScheduleId = BSCI.szScheduleIdLEFT JOIN BOS_GEN_RoutineSchedule BGRS ON BGRS.szScheduleId = BSCI.szScheduleId;
Left Join BOS_INV_Product As BIP ON BSCI.szProductId = BIP.szProductId
WHERE 
BSC.szCustId = p_szCustId And BGRS.szScheduleType = p_szScheduleType And BSCI.decValue = p_decValue AND BSCI.szTeamId = p_szTeamId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_IsCustRoutineExist(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId

FROM 
BOS_SD_CustRoutine
WHERE 
szCustId=p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_IsCustRoutineExist_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId

FROM 
BOS_SD_CustRoutine_DRAFT
WHERE 
szCustId=p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_LockCustRoutine(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustRoutine
SET 
dtmDelivery = dtmDelivery
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_LockCustRoutine_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustRoutine_DRAFT
SET 
dtmDelivery = dtmDelivery
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_UpdateCustRoutine(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmDelivery timestamp,
p_szNote BOS_DT_szDescription,
p_szDOPrintPaperType varchar,
p_szDOPrintType varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustRoutine
SET 
szDefaultTeamId = p_szDefaultTeamId,
szDefaultScheduleId = p_szDefaultScheduleId,
decDefaultScheduleValue = p_decDefaultScheduleValue,
szDefaultRouteId = p_szDefaultRouteId,
szDefaultOrderTypeId = p_szDefaultOrderTypeId,
dtmDelivery = p_dtmDelivery,
szNote = p_szNote,
szDOPrintPaperType = p_szDOPrintPaperType,
szDOPrintType = p_szDOPrintType
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_UpdateCustRoutine_013(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmDelivery timestamp,
p_szNote BOS_DT_szDescription,
p_szDOPrintPaperType varchar,
p_szDOPrintType varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustRoutine
SET 
szDefaultTeamId = p_szDefaultTeamId,
szDefaultScheduleId = p_szDefaultScheduleId,
decDefaultScheduleValue = p_decDefaultScheduleValue,
szDefaultRouteId = p_szDefaultRouteId,
szDefaultOrderTypeId = p_szDefaultOrderTypeId,
dtmDelivery = p_dtmDelivery,
szNote = p_szNote,
szDOPrintPaperType = p_szDOPrintPaperType,
szDOPrintType = p_szDOPrintType
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_UpdateCustRoutine_013_DRAFT(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmDelivery timestamp,
p_szNote BOS_DT_szDescription,
p_szDOPrintPaperType varchar,
p_szDOPrintType varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustRoutine_DRAFT
SET 
szDefaultTeamId = p_szDefaultTeamId,
szDefaultScheduleId = p_szDefaultScheduleId,
decDefaultScheduleValue = p_decDefaultScheduleValue,
szDefaultRouteId = p_szDefaultRouteId,
szDefaultOrderTypeId = p_szDefaultOrderTypeId,
dtmDelivery = p_dtmDelivery,
szNote = p_szNote,
szDOPrintPaperType = p_szDOPrintPaperType,
szDOPrintType = p_szDOPrintType
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_UpdateCustRoutine_DRAFT(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmDelivery timestamp,
p_szNote BOS_DT_szDescription,
p_szDOPrintPaperType varchar,
p_szDOPrintType varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustRoutine_DRAFT
SET 
szDefaultTeamId = p_szDefaultTeamId,
szDefaultScheduleId = p_szDefaultScheduleId,
decDefaultScheduleValue = p_decDefaultScheduleValue,
szDefaultRouteId = p_szDefaultRouteId,
szDefaultOrderTypeId = p_szDefaultOrderTypeId,
dtmDelivery = p_dtmDelivery,
szNote = p_szNote,
szDOPrintPaperType = p_szDOPrintPaperType,
szDOPrintType = p_szDOPrintType
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_UpdateCustRoutine_DRAFT_013(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmDelivery timestamp,
p_szNote BOS_DT_szDescription,
p_szDOPrintPaperType varchar,
p_szDOPrintType varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustRoutine_DRAFT
SET 
szDefaultTeamId = p_szDefaultTeamId,
szDefaultScheduleId = p_szDefaultScheduleId,
decDefaultScheduleValue = p_decDefaultScheduleValue,
szDefaultRouteId = p_szDefaultRouteId,
szDefaultOrderTypeId = p_szDefaultOrderTypeId,
dtmDelivery = p_dtmDelivery,
szNote = p_szNote,
szDOPrintPaperType = p_szDOPrintPaperType,
szDOPrintType = p_szDOPrintType
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_UpdateCustRoutineLastFDoId(
p_szCustId BOS_DT_szId,
p_szLastFDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustRoutine_DRAFT
SET 
szLastFDoId = p_szLastFDoId
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustRoutine_UpdateCustRoutineLastFDoId_DRAFT(
p_szCustId BOS_DT_szId,
p_szLastFDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustRoutine_DRAFT
SET 
szLastFDoId = p_szLastFDoId
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_CreateCustTORoutine(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmTakingOrder timestamp,
p_szLastFSoId BOS_DT_szId,
p_szNote BOS_DT_szDescription,
p_szSOPrintPaperType varchar,
p_szSOPrintType varchar,
p_szDeliveryGroupId varchar,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustTORoutine
(
szCustId,
szDefaultTeamId,
szDefaultScheduleId,
decDefaultScheduleValue,
szDefaultRouteId,
szDefaultOrderTypeId,
dtmTakingOrder,
szLastFSoId,
szNote,
szSOPrintPaperType,
szSOPrintType,
szDeliveryGroupId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCustId,
p_szDefaultTeamId,
p_szDefaultScheduleId,
p_decDefaultScheduleValue,
p_szDefaultRouteId,
p_szDefaultOrderTypeId,
p_dtmTakingOrder,
p_szLastFSoId,
p_szNote,
p_szSOPrintPaperType,
p_szSOPrintType,
p_szDeliveryGroupId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_CreateCustTORoutine_013(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmTakingOrder timestamp,
p_szLastFSoId BOS_DT_szId,
p_szNote BOS_DT_szDescription,
p_szSOPrintPaperType varchar,
p_szSOPrintType varchar,
p_szDeliveryGroupId varchar,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustTORoutine
(
szCustId,
szDefaultTeamId,
szDefaultScheduleId,
decDefaultScheduleValue,
szDefaultRouteId,
szDefaultOrderTypeId,
dtmTakingOrder,
szLastFSoId,
szNote,
szSOPrintPaperType,
szSOPrintType,
szDeliveryGroupId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCustId,
p_szDefaultTeamId,
p_szDefaultScheduleId,
p_decDefaultScheduleValue,
p_szDefaultRouteId,
p_szDefaultOrderTypeId,
p_dtmTakingOrder,
p_szLastFSoId,
p_szNote,
p_szSOPrintPaperType,
p_szSOPrintType,
p_szDeliveryGroupId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_CreateCustTORoutine_013_DRAFT_013(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmTakingOrder timestamp,
p_szLastFSoId BOS_DT_szId,
p_szNote BOS_DT_szDescription,
p_szSOPrintPaperType varchar,
p_szSOPrintType varchar,
p_szDeliveryGroupId varchar,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustTORoutine_DRAFT
(
szCustId,
szDefaultTeamId,
szDefaultScheduleId,
decDefaultScheduleValue,
szDefaultRouteId,
szDefaultOrderTypeId,
dtmTakingOrder,
szLastFSoId,
szNote,
szSOPrintPaperType,
szSOPrintType,
szDeliveryGroupId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCustId,
p_szDefaultTeamId,
p_szDefaultScheduleId,
p_decDefaultScheduleValue,
p_szDefaultRouteId,
p_szDefaultOrderTypeId,
p_dtmTakingOrder,
p_szLastFSoId,
p_szNote,
p_szSOPrintPaperType,
p_szSOPrintType,
p_szDeliveryGroupId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_CreateCustTORoutine_DRAFT(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmTakingOrder timestamp,
p_szLastFSoId BOS_DT_szId,
p_szNote BOS_DT_szDescription,
p_szSOPrintPaperType varchar,
p_szSOPrintType varchar,
p_szDeliveryGroupId varchar,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustTORoutine_DRAFT
(
szCustId,
szDefaultTeamId,
szDefaultScheduleId,
decDefaultScheduleValue,
szDefaultRouteId,
szDefaultOrderTypeId,
dtmTakingOrder,
szLastFSoId,
szNote,
szSOPrintPaperType,
szSOPrintType,
szDeliveryGroupId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCustId,
p_szDefaultTeamId,
p_szDefaultScheduleId,
p_decDefaultScheduleValue,
p_szDefaultRouteId,
p_szDefaultOrderTypeId,
p_dtmTakingOrder,
p_szLastFSoId,
p_szNote,
p_szSOPrintPaperType,
p_szSOPrintType,
p_szDeliveryGroupId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_CreateCustTORoutine_DRAFT_013(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmTakingOrder timestamp,
p_szLastFSoId BOS_DT_szId,
p_szNote BOS_DT_szDescription,
p_szSOPrintPaperType varchar,
p_szSOPrintType varchar,
p_szDeliveryGroupId varchar,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustTORoutine_DRAFT
(
szCustId,
szDefaultTeamId,
szDefaultScheduleId,
decDefaultScheduleValue,
szDefaultRouteId,
szDefaultOrderTypeId,
dtmTakingOrder,
szLastFSoId,
szNote,
szSOPrintPaperType,
szSOPrintType,
szDeliveryGroupId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCustId,
p_szDefaultTeamId,
p_szDefaultScheduleId,
p_decDefaultScheduleValue,
p_szDefaultRouteId,
p_szDefaultOrderTypeId,
p_dtmTakingOrder,
p_szLastFSoId,
p_szNote,
p_szSOPrintPaperType,
p_szSOPrintType,
p_szDeliveryGroupId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_CreateCustTORoutineItem(
p_szCustId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_bPrintPrice bit,
p_szTeamId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_decValue BOS_DT_decAmount,
p_decAvgOrder BOS_DT_decAmount,
p_decMaxDropSize BOS_DT_decQty,
p_decMinDropSize BOS_DT_decQty,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustTORoutineItem
(
szCustId,
shItemNumber,
szProductId,
decQty,
szUomId,
bPrintPrice,
szTeamId,
szScheduleId,
decValue,
decAvgOrder,
decMaxDropSize,
decMinDropSize,
szParentId
)
VALUES
(
p_szCustId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_bPrintPrice,
p_szTeamId,
p_szScheduleId,
p_decValue,
p_decAvgOrder,
p_decMaxDropSize,
p_decMinDropSize,
p_szParentId,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_CreateCustTORoutineItem_013(
p_szCustId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_bPrintPrice bit,
p_szTeamId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_decValue BOS_DT_decAmount,
p_decAvgOrder BOS_DT_decAmount,
p_decMaxDropSize BOS_DT_decQty,
p_decMinDropSize BOS_DT_decQty,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustTORoutineItem
(
szCustId,
shItemNumber,
szProductId,
decQty,
szUomId,
bPrintPrice,
szTeamId,
szScheduleId,
decValue,
decAvgOrder,
decMaxDropSize,
decMinDropSize,
szParentId
)
VALUES
(
p_szCustId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_bPrintPrice,
p_szTeamId,
p_szScheduleId,
p_decValue,
p_decAvgOrder,
p_decMaxDropSize,
p_decMinDropSize,
p_szParentId,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_CreateCustTORoutineItem_013_DRAFT_013(
p_szCustId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_bPrintPrice bit,
p_szTeamId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_decValue BOS_DT_decAmount,
p_decAvgOrder BOS_DT_decAmount,
p_decMaxDropSize BOS_DT_decQty,
p_decMinDropSize BOS_DT_decQty,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustTORoutineItem_DRAFT
(
szCustId,
shItemNumber,
szProductId,
decQty,
szUomId,
bPrintPrice,
szTeamId,
szScheduleId,
decValue,
decAvgOrder,
decMaxDropSize,
decMinDropSize,
szParentId
)
VALUES
(
p_szCustId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_bPrintPrice,
p_szTeamId,
p_szScheduleId,
p_decValue,
p_decAvgOrder,
p_decMaxDropSize,
p_decMinDropSize,
p_szParentId,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_CreateCustTORoutineItem_DRAFT(
p_szCustId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_bPrintPrice bit,
p_szTeamId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_decValue BOS_DT_decAmount,
p_decAvgOrder BOS_DT_decAmount,
p_decMaxDropSize BOS_DT_decQty,
p_decMinDropSize BOS_DT_decQty,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustTORoutineItem_DRAFT
(
szCustId,
shItemNumber,
szProductId,
decQty,
szUomId,
bPrintPrice,
szTeamId,
szScheduleId,
decValue,
decAvgOrder,
decMaxDropSize,
decMinDropSize,
szParentId
)
VALUES
(
p_szCustId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_bPrintPrice,
p_szTeamId,
p_szScheduleId,
p_decValue,
p_decAvgOrder,
p_decMaxDropSize,
p_decMinDropSize,
p_szParentId,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_CreateCustTORoutineItem_DRAFT_013(
p_szCustId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_bPrintPrice bit,
p_szTeamId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_decValue BOS_DT_decAmount,
p_decAvgOrder BOS_DT_decAmount,
p_decMaxDropSize BOS_DT_decQty,
p_decMinDropSize BOS_DT_decQty,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CustTORoutineItem_DRAFT
(
szCustId,
shItemNumber,
szProductId,
decQty,
szUomId,
bPrintPrice,
szTeamId,
szScheduleId,
decValue,
decAvgOrder,
decMaxDropSize,
decMinDropSize,
szParentId
)
VALUES
(
p_szCustId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_bPrintPrice,
p_szTeamId,
p_szScheduleId,
p_decValue,
p_decAvgOrder,
p_decMaxDropSize,
p_decMinDropSize,
p_szParentId,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_DeleteCustTORoutine(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_CustTORoutine
WHERE
szCustId = p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_DeleteCustTORoutine_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_CustTORoutine_DRAFT
WHERE
szCustId = p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_DeleteCustTORoutine_DRAFT_013(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_CustTORoutine_DRAFT
WHERE
szCustId = p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_DeleteCustTORoutineItem(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_CustTORoutineItem
WHERE
szCustId = p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_DeleteCustTORoutineItem_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_CustTORoutineItem_DRAFT
WHERE
szCustId = p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_DeleteCustTORoutineItem_DRAFT_013(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_CustTORoutineItem_DRAFT
WHERE
szCustId = p_szCustId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetCustTORoutine(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
IsNull(BOS_AR_Customer.szName, '') AS szCustNm,

CTOR.szDefaultTeamId,
CTOR.szDefaultScheduleId,
BOS_GEN_RoutineSchedule.szDescription AS szDefaultScheduleDesc_J,

CTOR.decDefaultScheduleValue,

CTOR.szDefaultRouteId,
BOS_SD_Route.szDescription AS szDefaultRouteDescription,
BOS_SD_Route.szOpUserId AS szDefaultSalesId_J,
BOS_PI_Employee.szName as szDefaultSalesNm_J,
BOS_PI_Employee.szTeamId AS szDefaultSalesTeamId_J,

CTOR.szDefaultOrderTypeId,
CTOR.dtmTakingOrder,
CTOR.szLastFSoId,
CTOR.szNote,
CTOR.szSOPrintPaperType,
CTOR.szSOPrintType,
CTOR.szDeliveryGroupId,
DelG.szDesc AS szDeliveryGroupNm_J,
IsNull(BOS_AR_Customer.szDistrChannelId, '') As szCustDistrChannelId_J,
IsNull(BOS_SD_DistrChannel.szName, '') As szCustDistrChannelNm_J,
CTOR.dtmLastUpdated,
CTOR.bAlreadyTransferred
FROM
BOS_SD_CustTORoutine AS CTOR	
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = CTOR.szCustId
LEFT JOIN BOS_SD_DeliveryGroup AS DelG ON DelG.szDeliveryGroupId = CTOR.szDeliveryGroupId
LEFT JOIN BOS_SD_Route ON BOS_SD_Route.szRouteId = CTOR.szDefaultRouteId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_Route.szOpUserId
LEFT JOIN BOS_SD_DistrChannel ON BOS_AR_Customer.szDistrChannelId = BOS_SD_DistrChannel.szDistrChannelId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = CTOR.szDefaultScheduleId

WHERE
CTOR.szCustId = p_szCustId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetCustTORoutine_014(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
IsNull(BOS_AR_Customer.szName, '') AS szCustNm,

CTOR.szDefaultTeamId,
CTOR.szDefaultScheduleId,
BOS_GEN_RoutineSchedule.szDescription AS szDefaultScheduleDesc_J,

CTOR.decDefaultScheduleValue,

CTOR.szDefaultRouteId,
BOS_SD_Route.szDescription AS szDefaultRouteDescription,
BOS_SD_Route.szOpUserId AS szDefaultSalesId_J,
BOS_PI_Employee.szName as szDefaultSalesNm_J,
BOS_PI_Employee.szTeamId AS szDefaultSalesTeamId_J,

CTOR.szDefaultOrderTypeId,
CTOR.dtmTakingOrder,
CTOR.szLastFSoId,
CTOR.szNote,
CTOR.szSOPrintPaperType,
CTOR.szSOPrintType,
CTOR.szDeliveryGroupId,
DelG.szDesc AS szDeliveryGroupNm_J,
IsNull(BOS_AR_Customer.szDistrChannelId, '') As szCustDistrChannelId_J,
IsNull(BOS_SD_DistrChannel.szName, '') As szCustDistrChannelNm_J,
CTOR.dtmLastUpdated,
CTOR.bAlreadyTransferred
FROM
BOS_SD_CustTORoutine AS CTOR    
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = CTOR.szCustId
LEFT JOIN BOS_SD_DeliveryGroup AS DelG ON DelG.szDeliveryGroupId = CTOR.szDeliveryGroupId
LEFT JOIN BOS_SD_Route ON BOS_SD_Route.szRouteId = CTOR.szDefaultRouteId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_Route.szOpUserId
LEFT JOIN BOS_SD_DistrChannel ON BOS_AR_Customer.szDistrChannelId = BOS_SD_DistrChannel.szDistrChannelId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = CTOR.szDefaultScheduleId

WHERE
CTOR.szCustId = p_szCustId


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetCustTORoutine_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
IsNull(BOS_AR_Customer.szName, '') AS szCustNm,

CTOR.szDefaultTeamId,
CTOR.szDefaultScheduleId,
BOS_GEN_RoutineSchedule.szDescription AS szDefaultScheduleDesc_J,

CTOR.decDefaultScheduleValue,

CTOR.szDefaultRouteId,
BOS_SD_Route.szDescription AS szDefaultRouteDescription,
BOS_SD_Route.szOpUserId AS szDefaultSalesId_J,
BOS_PI_Employee.szName as szDefaultSalesNm_J,
BOS_PI_Employee.szTeamId AS szDefaultSalesTeamId_J,

CTOR.szDefaultOrderTypeId,
CTOR.dtmTakingOrder,
CTOR.szLastFSoId,
CTOR.szNote,
CTOR.szSOPrintPaperType,
CTOR.szSOPrintType,
CTOR.szDeliveryGroupId,
DelG.szDesc AS szDeliveryGroupNm_J,
IsNull(BOS_AR_Customer.szDistrChannelId, '') As szCustDistrChannelId_J,
IsNull(BOS_SD_DistrChannel.szName, '') As szCustDistrChannelNm_J,
CTOR.dtmLastUpdated,
CTOR.bAlreadyTransferred
FROM
BOS_SD_CustTORoutine_DRAFT AS CTOR
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = CTOR.szCustId
LEFT JOIN BOS_SD_DeliveryGroup AS DelG ON DelG.szDeliveryGroupId = CTOR.szDeliveryGroupId
LEFT JOIN BOS_SD_Route ON BOS_SD_Route.szRouteId = CTOR.szDefaultRouteId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_Route.szOpUserId
LEFT JOIN BOS_SD_DistrChannel ON BOS_AR_Customer.szDistrChannelId = BOS_SD_DistrChannel.szDistrChannelId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = CTOR.szDefaultScheduleId

WHERE
CTOR.szCustId = p_szCustId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetCustTORoutine_DRAFT_013(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT  
IsNull(BOS_AR_Customer.szName, '') AS szCustNm,  

CTOR.szDefaultTeamId,  
CTOR.szDefaultScheduleId,  
BOS_GEN_RoutineSchedule.szDescription AS szDefaultScheduleDesc_J,  

CTOR.decDefaultScheduleValue,  

CTOR.szDefaultRouteId,  
BOS_SD_Route.szDescription AS szDefaultRouteDescription,  
BOS_SD_Route.szOpUserId AS szDefaultSalesId_J,  
BOS_PI_Employee.szName as szDefaultSalesNm_J,  
BOS_PI_Employee.szTeamId AS szDefaultSalesTeamId_J,  

CTOR.szDefaultOrderTypeId,  
CTOR.dtmTakingOrder,  
CTOR.szLastFSoId,  
CTOR.szNote,  
CTOR.szSOPrintPaperType,  
CTOR.szSOPrintType,  
CTOR.szDeliveryGroupId,  
DelG.szDesc AS szDeliveryGroupNm_J,  
IsNull(BOS_AR_Customer.szDistrChannelId, '') As szCustDistrChannelId_J,  
IsNull(BOS_SD_DistrChannel.szName, '') As szCustDistrChannelNm_J,  
CTOR.dtmLastUpdated,  
CTOR.bAlreadyTransferred  
FROM  
BOS_SD_CustTORoutine_DRAFT AS CTOR  
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = CTOR.szCustId  
LEFT JOIN BOS_SD_DeliveryGroup AS DelG ON DelG.szDeliveryGroupId = CTOR.szDeliveryGroupId  
LEFT JOIN BOS_SD_Route ON BOS_SD_Route.szRouteId = CTOR.szDefaultRouteId  
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_Route.szOpUserId  
LEFT JOIN BOS_SD_DistrChannel ON BOS_AR_Customer.szDistrChannelId = BOS_SD_DistrChannel.szDistrChannelId  
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = CTOR.szDefaultScheduleId  

WHERE  
CTOR.szCustId = p_szCustId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetCustTORoutineItem(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
CTORI.shItemNumber,
CTORI.szProductId,

BOS_INV_Product.szName as szProductName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,

CTORI.decQty,
CTORI.szUomId,
CTORI.bPrintPrice,

CTORI.szTeamId,
CTORI.szScheduleId,
BOS_GEN_RoutineSchedule.szDescription AS szScheduleDesc_J,
BOS_GEN_RoutineSchedule.szScheduleType AS szScheduleType_J,

CTORI.decValue,

CTORI.decAvgOrder,
CTORI.decMaxDropSize,
CTORI.decMinDropSize,

CTORI.szParentId,
(CASE WHEN CTORI.szParentId = '' THEN '' ELSE I.szName END ) AS szParentNm

FROM
BOS_SD_CustTORoutineItem AS CTORI
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = CTORI.szProductId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = CTORI.szScheduleId
LEFT JOIN dbo.BOS_INV_Product AS I ON I.szProductId = CTORI.szProductId

WHERE
szCustId=p_szCustId

ORDER BY
--It would be less headache for user if it is sorted this way.
CTORI.szTeamId,
CTORI.shItemNumber,
CTORI.szScheduleId,
CTORI.decValue,
CTORI.szProductId

-- ==================================================================

set ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetCustTORoutineItem_014(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
CTORI.shItemNumber,
CTORI.szProductId,

BOS_INV_Product.szName as szProductName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,

CTORI.decQty,
CTORI.szUomId,
CTORI.bPrintPrice,

CTORI.szTeamId,
CTORI.szScheduleId,
BOS_GEN_RoutineSchedule.szDescription AS szScheduleDesc_J,
BOS_GEN_RoutineSchedule.szScheduleType AS szScheduleType_J,

CTORI.decValue,

CTORI.decAvgOrder,
CTORI.decMaxDropSize,
CTORI.decMinDropSize,

CTORI.szParentId,
(CASE WHEN CTORI.szParentId = '' THEN '' ELSE I.szName END ) AS szParentNm

FROM
BOS_SD_CustTORoutineItem AS CTORI
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = CTORI.szProductId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = CTORI.szScheduleId
LEFT JOIN dbo.BOS_INV_Product AS I ON I.szProductId = CTORI.szProductId

WHERE
szCustId=p_szCustId

ORDER BY
--It would be less headache for user if it is sorted this way.
CTORI.szTeamId,
CTORI.shItemNumber,
CTORI.szScheduleId,
CTORI.decValue,
CTORI.szProductId

-- ==================================================================

set ANSI_NULLS ON


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetCustTORoutineItem_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
CTORI.shItemNumber,
CTORI.szProductId,

BOS_INV_Product.szName as szProductName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,

CTORI.decQty,
CTORI.szUomId,
CTORI.bPrintPrice,

CTORI.szTeamId,
CTORI.szScheduleId,
BOS_GEN_RoutineSchedule.szDescription AS szScheduleDesc_J,
BOS_GEN_RoutineSchedule.szScheduleType AS szScheduleType_J,

CTORI.decValue,

CTORI.decAvgOrder,
CTORI.decMaxDropSize,
CTORI.decMinDropSize,

CTORI.szParentId,
(CASE WHEN CTORI.szParentId = '' THEN '' ELSE I.szName END ) AS szParentNm
FROM
BOS_SD_CustTORoutineItem_DRAFT AS CTORI
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = CTORI.szProductId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = CTORI.szScheduleId
LEFT JOIN BOS_INV_Product AS I ON I.szProductId = CTORI.szProductId

WHERE
szCustId=p_szCustId

ORDER BY
--It would be less headache for user if it is sorted this way.
CTORI.szTeamId,
CTORI.shItemNumber,
CTORI.szScheduleId,
CTORI.decValue,
CTORI.szProductId

-- ==================================================================

set ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetCustTORoutineItem_DRAFT_013(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT  
CTORI.shItemNumber,  
CTORI.szProductId,  

BOS_INV_Product.szName as szProductName_J,  
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,  
BOS_INV_Product.szUomId AS szProductUomId_J,  
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,  
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,  
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,  

CTORI.decQty,  
CTORI.szUomId,  
CTORI.bPrintPrice,  

CTORI.szTeamId,  
CTORI.szScheduleId,  
BOS_GEN_RoutineSchedule.szDescription AS szScheduleDesc_J,  
BOS_GEN_RoutineSchedule.szScheduleType AS szScheduleType_J,  

CTORI.decValue,  

CTORI.decAvgOrder,  
CTORI.decMaxDropSize,  
CTORI.decMinDropSize,  

CTORI.szParentId,  
(CASE WHEN CTORI.szParentId = '' THEN '' ELSE I.szName END ) AS szParentNm  
FROM  
BOS_SD_CustTORoutineItem_DRAFT AS CTORI  
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = CTORI.szProductId  
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = CTORI.szScheduleId  
LEFT JOIN BOS_INV_Product AS I ON I.szProductId = CTORI.szProductId  

WHERE  
szCustId=p_szCustId  

ORDER BY  
--It would be less headache for user if it is sorted this way.  
CTORI.szTeamId,  
CTORI.shItemNumber,  
CTORI.szScheduleId,  
CTORI.decValue,  
CTORI.szProductId  

-- ==================================================================  

set ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetDefaultSales(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
COALESCE(BSR.szOpUserId, '') As szSalesId


FROM 
BOS_SD_CustTORoutine As BSC
Left Join BOS_SD_Route As BSR On BSC.szDefaultRouteId = BSR.szRouteId

WHERE 
BSC.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetDefaultSales_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
COALESCE(BSR.szOpUserId, '') As szSalesId


FROM 
BOS_SD_CustTORoutine_DRAFT As BSC
Left Join BOS_SD_Route As BSR On BSC.szDefaultRouteId = BSR.szRouteId

WHERE 
BSC.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetDefaultSales_DRAFT_013(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
COALESCE(BSR.szOpUserId, '') As szSalesId


FROM 
BOS_SD_CustTORoutine_DRAFT As BSC
Left Join BOS_SD_Route As BSR On BSC.szDefaultRouteId = BSR.szRouteId

WHERE 
BSC.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetListOfAverageOrder(
p_szCustId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSDI.szProductId,
BSDI.szUomId,
--NICE FINDING :) COUNT OF PRODUCT ID CANNOT BE ZERO BECOZ IF IT IS,
--THERE WILL BE NO QUANTITY TO BE SUMMED UP TOO.
Convert(Decimal(18, 2), Sum(BSDI.decQty) / COUNT(BSDI.szProductId)) As decQty

FROM 
BOS_SD_FSo As BSD
Inner Join BOS_SD_FSoItem As BSDI On BSD.szFSoId = BSDI.szFSoId
WHERE 
BSD.dtmOrder >= p_dtmFrom And BSD.dtmOrder < DATEADD(DAY, 1, p_dtmTo) And BSD.szCustId = p_szCustId AND BSD.bApplied = 1 AND BSDI.szProductId <> ''	--DISCOUNT AND ALIKE HAVE NO PRODUCT ID, AND SHOULD NOT BE CALCULATED. Group By BSDI.szProductId, BSDI.szUomId ;ORDER BY 
BSDI.szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetListOfAverageOrderAllCustomer(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp)
RETURNS void AS
$BODY$
BEGIN

Select
BSC.szCustId,
BAC.szName As szCustName,
BSSI.szProductId,
BIP.szName As szProductName,
BIP.szQtyFormat AS szProductQtyFormat_J,
BSSI.szUomId,
BSCTI.szTeamId,
BSCTI.szScheduleId,
BSCTI.decValue,
BSC.szDefaultTeamId,
BSC.szDefaultScheduleId,
BSC.decDefaultScheduleValue,
BSCTI.bPrintPrice,
BSCTI.decQty,
Convert(Decimal(18, 2), Sum(BSSI.decQty) / COUNT(BSSI.szProductId)) As decAvgOrder

From
BOS_SD_CustTORoutine As BSC
Left Join BOS_AR_Customer As BAC On BAC.szCustId = BSC.szCustId
LEFT JOIN BOS_SD_FSo As BSS On BSS.szCustId = BSC.szCustId
LEFT JOIN BOS_SD_FSoItem As BSSI On BSSI.szFSoId = BSS.szFSoId
Left Join BOS_INV_Product As BIP On BIP.szProductId = BSSI.szProductId
LEFT JOIN BOS_SD_CustTORoutineItem AS BSCTI ON BSCTI.szCustId = BSC.szCustId
AND BSCTI.szProductId = BSSI.szProductId AND BSCTI.szUomId = BSSI.szUomId

Where
BAC.szDlvWorkplaceId LIKE p_szWorkplaceId
AND BSS.bApplied = 1
AND BSS.dtmOrder >= p_dtmFrom 
And BSS.dtmOrder < DATEADD(DAY, 1, p_dtmTo)
AND BSSI.szProductId <> ''	--DISCOUNT AND ALIKE HAVE NO PRODUCT ID, AND SHOULD NOT BE CALCULATED.

Group By
BSC.szCustId,
BAC.szName,
BSSI.szProductId,
BIP.szName,
BIP.szQtyFormat,
BSSI.szUomId,
BSCTI.szTeamId,
BSCTI.szScheduleId,
BSCTI.decValue,
BSC.szDefaultTeamId,
BSC.szDefaultScheduleId,
BSC.decDefaultScheduleValue,
BSCTI.bPrintPrice,
BSCTI.decQty

Order By
BSC.szCustId,
BSSI.szProductId,
BSSI.szUomId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetListOfAverageOrderAllCustomer_DRAFT(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp)
RETURNS void AS
$BODY$
BEGIN

Select
BSC.szCustId,
BAC.szName As szCustName,
BSSI.szProductId,
BIP.szName As szProductName,
BIP.szQtyFormat AS szProductQtyFormat_J,
BSSI.szUomId,
BSCTI.szTeamId,
BSCTI.szScheduleId,
BSCTI.decValue,
BSC.szDefaultTeamId,
BSC.szDefaultScheduleId,
BSC.decDefaultScheduleValue,
BSCTI.bPrintPrice,
BSCTI.decQty,
Convert(Decimal(18, 2), Sum(BSSI.decQty) / COUNT(BSSI.szProductId)) As decAvgOrder

From
BOS_SD_CustTORoutine_DRAFT As BSC
Left Join BOS_AR_Customer As BAC On BAC.szCustId = BSC.szCustId
LEFT JOIN BOS_SD_FSo As BSS On BSS.szCustId = BSC.szCustId
LEFT JOIN BOS_SD_FSoItem As BSSI On BSSI.szFSoId = BSS.szFSoId
Left Join BOS_INV_Product As BIP On BIP.szProductId = BSSI.szProductId
LEFT JOIN BOS_SD_CustTORoutineItem_DRAFT AS BSCTI ON BSCTI.szCustId = BSC.szCustId 
AND BSCTI.szProductId = BSSI.szProductId AND BSCTI.szUomId = BSSI.szUomId

Where
BAC.szDlvWorkplaceId LIKE p_szWorkplaceId
AND BSS.bApplied = 1
AND BSS.dtmOrder >= p_dtmFrom 
And BSS.dtmOrder < DATEADD(DAY, 1, p_dtmTo)
AND BSSI.szProductId <> ''	--DISCOUNT AND ALIKE HAVE NO PRODUCT ID, AND SHOULD NOT BE CALCULATED.

Group By
BSC.szCustId,
BAC.szName,
BSSI.szProductId,
BIP.szName,
BIP.szQtyFormat,
BSSI.szUomId,
BSCTI.szTeamId,
BSCTI.szScheduleId,
BSCTI.decValue,
BSC.szDefaultTeamId,
BSC.szDefaultScheduleId,
BSC.decDefaultScheduleValue,
BSCTI.bPrintPrice,
BSCTI.decQty

Order By
BSC.szCustId,
BSSI.szProductId,
BSSI.szUomId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetListOfCustTORoutine()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId,
dtmTakingOrder

FROM 
BOS_SD_CustTORoutine

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetListOfCustTORoutine_DRAFT()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId,
dtmTakingOrder

FROM 
BOS_SD_CustTORoutine_DRAFT

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetListOfProductOnDay(
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_szScheduleType BOS_DT_szSmallId,
p_decValue BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSCI.szProductId, COALESCE(BIP.szName, '') As szProductName, BSCI.decQty

FROM 
BOS_SD_CustTORoutine As BSC
Inner Join BOS_SD_CustTORoutineItem As BSCI ON BSCI.szCustId = BSC.szCustId
LEFT JOIN BOS_GEN_RoutineSchedule BGRS ON BGRS.szScheduleId = BSCI.szScheduleIdLEFT JOIN BOS_GEN_RoutineSchedule BGRS ON BGRS.szScheduleId = BSCI.szScheduleId;
Left Join BOS_INV_Product As BIP ON BSCI.szProductId = BIP.szProductId
WHERE 
BSC.szCustId = p_szCustId And BGRS.szScheduleType = p_szScheduleType AND BSCI.decValue = p_decValue AND BSCI.szTeamId = p_szTeamId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetListOfProductOnDay_013(
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_szScheduleType BOS_DT_szSmallId,
p_decValue BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSCI.szProductId, COALESCE(BIP.szName, '') As szProductName, BSCI.decQty

FROM 
BOS_SD_CustTORoutine As BSC
Inner Join BOS_SD_CustTORoutineItem As BSCI ON BSCI.szCustId = BSC.szCustId
LEFT JOIN BOS_GEN_RoutineSchedule BGRS ON BGRS.szScheduleId = BSCI.szScheduleIdLEFT JOIN BOS_GEN_RoutineSchedule BGRS ON BGRS.szScheduleId = BSCI.szScheduleId;
Left Join BOS_INV_Product As BIP ON BSCI.szProductId = BIP.szProductId
WHERE 
BSC.szCustId = p_szCustId And BGRS.szScheduleType = p_szScheduleType AND BSCI.decValue = p_decValue AND BSCI.szTeamId = p_szTeamId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetListOfProductOnDay_DRAFT(
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_szScheduleType BOS_DT_szSmallId,
p_decValue BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSCI.szProductId, COALESCE(BIP.szName, '') As szProductName, BSCI.decQty

FROM 
BOS_SD_CustTORoutine_DRAFT As BSC
Inner Join BOS_SD_CustTORoutineItem_DRAFT As BSCI ON BSCI.szCustId = BSC.szCustId
LEFT JOIN BOS_GEN_RoutineSchedule BGRS ON BGRS.szScheduleId = BSCI.szScheduleIdLEFT JOIN BOS_GEN_RoutineSchedule BGRS ON BGRS.szScheduleId = BSCI.szScheduleId;
Left Join BOS_INV_Product As BIP ON BSCI.szProductId = BIP.szProductId
WHERE 
BSC.szCustId = p_szCustId And BGRS.szScheduleType = p_szScheduleType AND BSCI.decValue = p_decValue AND BSCI.szTeamId = p_szTeamId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_GetListOfProductOnDay_DRAFT_013(
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_szScheduleType BOS_DT_szSmallId,
p_decValue BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSCI.szProductId, COALESCE(BIP.szName, '') As szProductName, BSCI.decQty

FROM 
BOS_SD_CustTORoutine_DRAFT As BSC
Inner Join BOS_SD_CustTORoutineItem_DRAFT As BSCI ON BSCI.szCustId = BSC.szCustId
LEFT JOIN BOS_GEN_RoutineSchedule BGRS ON BGRS.szScheduleId = BSCI.szScheduleIdLEFT JOIN BOS_GEN_RoutineSchedule BGRS ON BGRS.szScheduleId = BSCI.szScheduleId;
Left Join BOS_INV_Product As BIP ON BSCI.szProductId = BIP.szProductId
WHERE 
BSC.szCustId = p_szCustId And BGRS.szScheduleType = p_szScheduleType AND BSCI.decValue = p_decValue AND BSCI.szTeamId = p_szTeamId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_IsCustTORoutineExist(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId

FROM 
BOS_SD_CustTORoutine
WHERE 
szCustId=p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_IsCustTORoutineExist_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId

FROM 
BOS_SD_CustTORoutine_DRAFT
WHERE 
szCustId=p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_IsCustTORoutineExist_DRAFT_013(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId

FROM 
BOS_SD_CustTORoutine_DRAFT
WHERE 
szCustId=p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_LockCustTORoutine(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustTORoutine
SET 
dtmTakingOrder = dtmTakingOrder
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_LockCustTORoutine_DRAFT(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustTORoutine_DRAFT
SET 
dtmTakingOrder = dtmTakingOrder
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_LockCustTORoutine_DRAFT_013(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustTORoutine_DRAFT
SET 
dtmTakingOrder = dtmTakingOrder
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_UpdateCustTORoutine(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmTakingOrder timestamp,
p_szNote BOS_DT_szDescription,
p_szSOPrintPaperType varchar,
p_szSOPrintType varchar,
p_szDeliveryGroupId varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustTORoutine
SET 
szDefaultTeamId = p_szDefaultTeamId,
szDefaultScheduleId = p_szDefaultScheduleId,
decDefaultScheduleValue = p_decDefaultScheduleValue,
szDefaultRouteId = p_szDefaultRouteId,
szDefaultOrderTypeId = p_szDefaultOrderTypeId,
dtmTakingOrder = p_dtmTakingOrder,
szNote = p_szNote,
szSOPrintPaperType = p_szSOPrintPaperType,
szSOPrintType = p_szSOPrintType,
szDeliveryGroupId=p_szDeliveryGroupId
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_UpdateCustTORoutine_013(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmTakingOrder timestamp,
p_szNote BOS_DT_szDescription,
p_szSOPrintPaperType varchar,
p_szSOPrintType varchar,
p_szDeliveryGroupId varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustTORoutine
SET 
szDefaultTeamId = p_szDefaultTeamId,
szDefaultScheduleId = p_szDefaultScheduleId,
decDefaultScheduleValue = p_decDefaultScheduleValue,
szDefaultRouteId = p_szDefaultRouteId,
szDefaultOrderTypeId = p_szDefaultOrderTypeId,
dtmTakingOrder = p_dtmTakingOrder,
szNote = p_szNote,
szSOPrintPaperType = p_szSOPrintPaperType,
szSOPrintType = p_szSOPrintType,
szDeliveryGroupId=p_szDeliveryGroupId
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_UpdateCustTORoutine_013_DRAFT_013(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmTakingOrder timestamp,
p_szNote BOS_DT_szDescription,
p_szSOPrintPaperType varchar,
p_szSOPrintType varchar,
p_szDeliveryGroupId varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustTORoutine_DRAFT
SET 
szDefaultTeamId = p_szDefaultTeamId,
szDefaultScheduleId = p_szDefaultScheduleId,
decDefaultScheduleValue = p_decDefaultScheduleValue,
szDefaultRouteId = p_szDefaultRouteId,
szDefaultOrderTypeId = p_szDefaultOrderTypeId,
dtmTakingOrder = p_dtmTakingOrder,
szNote = p_szNote,
szSOPrintPaperType = p_szSOPrintPaperType,
szSOPrintType = p_szSOPrintType,
szDeliveryGroupId = p_szDeliveryGroupId

WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_UpdateCustTORoutine_DRAFT(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmTakingOrder timestamp,
p_szNote BOS_DT_szDescription,
p_szSOPrintPaperType varchar,
p_szSOPrintType varchar,
p_szDeliveryGroupId varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustTORoutine_DRAFT
SET 
szDefaultTeamId = p_szDefaultTeamId,
szDefaultScheduleId = p_szDefaultScheduleId,
decDefaultScheduleValue = p_decDefaultScheduleValue,
szDefaultRouteId = p_szDefaultRouteId,
szDefaultOrderTypeId = p_szDefaultOrderTypeId,
dtmTakingOrder = p_dtmTakingOrder,
szNote = p_szNote,
szSOPrintPaperType = p_szSOPrintPaperType,
szSOPrintType = p_szSOPrintType,
szDeliveryGroupId = p_szDeliveryGroupId

WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_UpdateCustTORoutine_DRAFT_013(
p_szCustId BOS_DT_szId,
p_szDefaultTeamId BOS_DT_szId,
p_szDefaultScheduleId BOS_DT_szId,
p_decDefaultScheduleValue BOS_DT_decAmount,
p_szDefaultRouteId BOS_DT_szBigId,
p_szDefaultOrderTypeId BOS_DT_szId,
p_dtmTakingOrder timestamp,
p_szNote BOS_DT_szDescription,
p_szSOPrintPaperType varchar,
p_szSOPrintType varchar,
p_szDeliveryGroupId varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustTORoutine_DRAFT
SET 
szDefaultTeamId = p_szDefaultTeamId,
szDefaultScheduleId = p_szDefaultScheduleId,
decDefaultScheduleValue = p_decDefaultScheduleValue,
szDefaultRouteId = p_szDefaultRouteId,
szDefaultOrderTypeId = p_szDefaultOrderTypeId,
dtmTakingOrder = p_dtmTakingOrder,
szNote = p_szNote,
szSOPrintPaperType = p_szSOPrintPaperType,
szSOPrintType = p_szSOPrintType,
szDeliveryGroupId = p_szDeliveryGroupId

WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_UpdateCustTORoutineLastFSoId(
p_szCustId BOS_DT_szId,
p_szLastFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustTORoutine
SET 
szLastFSoId = p_szLastFSoId
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_UpdateCustTORoutineLastFSoId_DRAFT(
p_szCustId BOS_DT_szId,
p_szLastFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustTORoutine_DRAFT
SET 
szLastFSoId = p_szLastFSoId
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_CustTORoutine_UpdateCustTORoutineLastFSoId_DRAFT_013(
p_szCustId BOS_DT_szId,
p_szLastFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CustTORoutine_DRAFT
SET 
szLastFSoId = p_szLastFSoId
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_DistrChannel_CreateDistrChannel(
p_szDistrChannelId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szDescription BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_DistrChannel
(
szDistrChannelId,
szName,
szDescription,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szDistrChannelId,
p_szName,
p_szDescription,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_DistrChannel_CreateDistrChannel_014(
p_szDistrChannelId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szDescription BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_DistrChannel
(
szDistrChannelId,
szName,
szDescription,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szDistrChannelId,
p_szName,
p_szDescription,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_DistrChannel_DeleteDistrChannel(
p_szDistrChannelId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_SD_DistrChannel
WHERE
szDistrChannelId=p_szDistrChannelId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_DistrChannel_GetDistrChannel(
p_szDistrChannelId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szName,
szDescription,
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_SD_DistrChannel
WHERE 
szDistrChannelId=p_szDistrChannelId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_DistrChannel_GetDistrChannel_014(
p_szDistrChannelId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szName,
szDescription,
dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_SD_DistrChannel
WHERE 
szDistrChannelId=p_szDistrChannelId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_DistrChannel_GetListOfDistrChannel()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDistrChannelId,
szName

FROM 
BOS_SD_DistrChannel

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_DistrChannel_IsDistrChannelExist(
p_szDistrChannelId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDistrChannelId

FROM 
BOS_SD_DistrChannel
WHERE 
szDistrChannelId=p_szDistrChannelId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_DistrChannel_LockDistrChannel(
p_szDistrChannelId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_DistrChannel
SET 
szName=szName
WHERE 
szDistrChannelId=p_szDistrChannelId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_DistrChannel_UpdateDistrChannel(
p_szDistrChannelId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_DistrChannel
SET 
szName=p_szName,
szDescription=p_szDescription
WHERE 
szDistrChannelId=p_szDistrChannelId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_EmployeeSalesTarget_CreateEmployeeSalesTarget(
p_szEmployeeId BOS_DT_szId,
p_szPeriodType BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_decTargetAmount BOS_DT_decAmount,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_EmployeeSalesTarget
(
szEmployeeId,
szPeriodType,
dtmStart,
dtmEnd,
decTargetAmount,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_EmployeeSalesTarget_DeleteEmployeeSalesTarget(
p_szEmployeeId BOS_DT_szId,
p_szPeriodType BOS_DT_szId,
p_dtmStart timestamp)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SD_EmployeeSalesTarget
WHERE
 szEmployeeId=p_szEmployeeId AND szPeriodType=p_szPeriodType AND dtmStart=p_dtmStart;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_EmployeeSalesTarget_GetEmployeeSalesTarget(
p_szEmployeeId BOS_DT_szId,
p_szPeriodType BOS_DT_szId,
p_dtmStart timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
* 

FROM 
BOS_SD_EmployeeSalesTarget 
WHERE 
 szEmployeeId=p_szEmployeeId AND szPeriodType=p_szPeriodType AND dtmStart=p_dtmStart;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_EmployeeSalesTarget_IsEmployeeSalesTargetExist(
p_szEmployeeId BOS_DT_szId,
p_szPeriodType BOS_DT_szId,
p_dtmStart timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szEmployeeId 

FROM 
BOS_SD_EmployeeSalesTarget 
WHERE 
 szEmployeeId=p_szEmployeeId AND szPeriodType=p_szPeriodType AND dtmStart=p_dtmStart;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_EmployeeSalesTarget_LockEmployeeSalesTarget(
p_szEmployeeId BOS_DT_szId,
p_szPeriodType BOS_DT_szId,
p_dtmStart timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_EmployeeSalesTarget
SET 
 dtmEnd = dtmEnd
WHERE 
 szEmployeeId=p_szEmployeeId AND szPeriodType=p_szPeriodType AND dtmStart=p_dtmStart;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_CreateCjrTracking(
p_szCjrTrackingId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCollectorId BOS_DT_szId,
p_szFCjrId BOS_DT_szId,
p_bFinished bit,
p_bSuccess bit,
p_bTasked bit,
p_dtmNext timestamp,
p_btTrialCount smallint,
p_szChangeNote varchar,
p_dtmInvoiceExchangeDate timestamp,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CjrTracking
(
szCjrTrackingId,
szCustId,
szTrnId,
szDocId,
szCollectorId,
szFCjrId,
bFinished,
bSuccess,
bTasked,
dtmNext,
btTrialCount,
szChangeNote,
dtmInvoiceExchangeDate,
 dtmLastUpdated
)
VALUES
(
p_szCjrTrackingId,
p_szCustId,
p_szTrnId,
p_szDocId,
p_szCollectorId,
p_szFCjrId,
p_bFinished,
p_bSuccess,
p_bTasked,
p_dtmNext,
p_btTrialCount,
p_szChangeNote,
p_dtmInvoiceExchangeDate,
 p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_CreateCjrTracking_013(
p_szCjrTrackingId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCollectorId BOS_DT_szId,
p_szFCjrId BOS_DT_szId,
p_bFinished bit,
p_bSuccess bit,
p_bTasked bit,
p_dtmNext timestamp,
p_btTrialCount smallint,
p_szChangeNote varchar,
p_dtmInvoiceExchangeDate timestamp,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_CjrTracking
(
szCjrTrackingId,
szCustId,
szTrnId,
szDocId,
szCollectorId,
szFCjrId,
bFinished,
bSuccess,
bTasked,
dtmNext,
btTrialCount,
szChangeNote,
dtmInvoiceExchangeDate,
 dtmLastUpdated
)
VALUES
(
p_szCjrTrackingId,
p_szCustId,
p_szTrnId,
p_szDocId,
p_szCollectorId,
p_szFCjrId,
p_bFinished,
p_bSuccess,
p_bTasked,
p_dtmNext,
p_btTrialCount,
p_szChangeNote,
p_dtmInvoiceExchangeDate,
 p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_CreateFCjr(
p_szFCjrId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szBaseRouteId BOS_DT_szId,
p_dtmFCjr timestamp,
p_szCollectorId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FCjr
(
szFCjrId,
szSalesOrgId,
szBaseRouteId,
dtmFCjr,
szCollectorId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
)
VALUES
(
p_szFCjrId,
p_szSalesOrgId,
p_szBaseRouteId,
p_dtmFCjr,
p_szCollectorId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_CreateFCjrItem(
p_szFCjrId BOS_DT_szId,
p_shItemNumber smallint,
p_szCjrTrackingId BOS_DT_szId,
p_szReasonId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bSuccess bit,
p_szCollRefNo BOS_DT_szDescription,
p_szCollTaskType BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FCjrItem
(
szFCjrId,
shItemNumber,
szCjrTrackingId,
szReasonId,
szDescription,
bSuccess,
szCollRefNo,
szCollTaskType
)
VALUES
(
p_szFCjrId,
p_shItemNumber,
p_szCjrTrackingId,
p_szReasonId,
p_szDescription,
p_bSuccess,
p_szCollRefNo,
p_szCollTaskType,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_DeleteCjrTracking(
p_szCjrTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_CjrTracking
WHERE
szCjrTrackingId = p_szCjrTrackingId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_DeleteFCjr(
p_szFCjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FCjr
WHERE
szFCjrId = p_szFCjrId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_DeleteFCjrItem(
p_szFCjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FCjrItem
WHERE
szFCjrId = p_szFCjrId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_GetCjrTracking(
p_szCjrTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_SD_CjrTracking.szCjrTrackingId,
BOS_SD_CjrTracking.szCustId,
IsNull(BOS_AR_Customer.szName, '') AS szCustNm,

BOS_SD_CjrTracking.szTrnId,
BOS_SD_CjrTracking.szDocId,
BOS_AR_ArTrans.bClosed AS bDocClosed_J,

BOS_SD_CjrTracking.szCollectorId,
IsNull(BOS_PI_Employee.szName, '') AS szCollectorNm,
BOS_SD_CjrTracking.szFCjrId,
BOS_SD_CjrTracking.bFinished,
BOS_SD_CjrTracking.bSuccess,
BOS_SD_CjrTracking.bTasked,
BOS_SD_CjrTracking.dtmNext,
BOS_SD_CjrTracking.btTrialCount,
IsNull(BOS_SD_FCjrItem.szReasonId, '') As szReasonId,
IsNull(BOS_SD_FCjrItem.szDescription, '') As szDescription,
BOS_SD_CjrTracking.szChangeNote,
BOS_SD_CjrTracking.dtmInvoiceExchangeDate

FROM
BOS_SD_CjrTracking LEFT JOIN BOS_AR_Customer ON BOS_SD_CjrTracking.szCustId = BOS_AR_Customer.szCustId
LEFT JOIN BOS_PI_Employee ON BOS_SD_CjrTracking.szCollectorId = BOS_PI_Employee.szEmployeeId
LEFT JOIN BOS_SD_FCjrItem ON BOS_SD_CjrTracking.szFCjrId = BOS_SD_FCjrItem.szFCjrId And BOS_SD_CjrTracking.szCjrTrackingId = BOS_SD_FCjrItem.szCjrTrackingId
LEFT JOIN BOS_AR_ArTrans ON BOS_AR_ArTrans.szTrnId = BOS_SD_CjrTracking.szTrnId
AND BOS_AR_ArTrans.szDocId = BOS_SD_CjrTracking.szDocId

WHERE
BOS_SD_CjrTracking.szCjrTrackingId = p_szCjrTrackingId

-- ==================================================================

set ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_GetCjrTracking_013(
p_szCjrTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT    
BOS_SD_CjrTracking.szCjrTrackingId,    
BOS_SD_CjrTracking.szCustId,    
IsNull(BOS_AR_Customer.szName, '') AS szCustNm,    

BOS_SD_CjrTracking.szTrnId,    
BOS_SD_CjrTracking.szDocId,    
BOS_AR_ArTrans.bClosed AS bDocClosed_J,    

BOS_SD_CjrTracking.szCollectorId,    
IsNull(BOS_PI_Employee.szName, '') AS szCollectorNm,    
BOS_SD_CjrTracking.szFCjrId,    
BOS_SD_CjrTracking.bFinished,    
BOS_SD_CjrTracking.bSuccess,    
BOS_SD_CjrTracking.bTasked,    
BOS_SD_CjrTracking.dtmNext,    
BOS_SD_CjrTracking.btTrialCount,    
IsNull(BOS_SD_FCjrItem.szReasonId, '') As szReasonId,    
IsNull(BOS_SD_FCjrItem.szDescription, '') As szDescription,    
BOS_SD_CjrTracking.szChangeNote,    
BOS_SD_CjrTracking.dtmInvoiceExchangeDate,
BOS_SD_CjrTracking.dtmLastUpdated      

FROM    
BOS_SD_CjrTracking LEFT JOIN BOS_AR_Customer ON BOS_SD_CjrTracking.szCustId = BOS_AR_Customer.szCustId    
LEFT JOIN BOS_PI_Employee ON BOS_SD_CjrTracking.szCollectorId = BOS_PI_Employee.szEmployeeId    
LEFT JOIN BOS_SD_FCjrItem ON BOS_SD_CjrTracking.szFCjrId = BOS_SD_FCjrItem.szFCjrId And BOS_SD_CjrTracking.szCjrTrackingId = BOS_SD_FCjrItem.szCjrTrackingId    
LEFT JOIN BOS_AR_ArTrans ON BOS_AR_ArTrans.szTrnId = BOS_SD_CjrTracking.szTrnId    
AND BOS_AR_ArTrans.szDocId = BOS_SD_CjrTracking.szDocId    

WHERE    
BOS_SD_CjrTracking.szCjrTrackingId = p_szCjrTrackingId    

-- ==================================================================    

set ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_GetFCjr(
p_szFCjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_FCjr.szSalesOrgId,
BOS_SD_FCjr.szBaseRouteId,
BOS_SD_FCjr.dtmFCjr,
BOS_SD_FCjr.szCollectorId,
BOS_PI_Employee.szName AS szCollectorNm,
BOS_SD_FCjr.bResultFrTransfer,
BOS_SD_FCjr.bVoid,
BOS_GEN_Approved.bApproved,
BOS_SD_FCjr.bApplied,
BOS_GL_FJournalTrans.szFJournalId AS bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_SD_FCjr.btPrintedCount,
BOS_SD_FCjr.bTransferred,

BOS_SD_FCjr.szCompanyId,
BOS_GL_Company.szName AS szCompanyNm,

BOS_SD_FCjr.szWorkplaceId,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_SD_FCjr.szTaxEntityId,
BOS_SD_FCjr.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_SD_FCjr.dtmCreated,
BOS_SD_FCjr.bSystemCreated,
BOS_SD_FCjr.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_SD_FCjr.dtmLastUpdated,
BOS_SD_FCjr.bAlreadyTransferred

FROM
BOS_SD_FCjr 
LEFT JOIN BOS_GEN_Approved ON BOS_SD_FCjr.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FCjr.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_PI_Employee ON BOS_SD_FCjr.szCollectorId = BOS_PI_Employee.szEmployeeId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FCjr.szUserId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FCjr.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FCjr.szWorkplaceId

WHERE
BOS_SD_FCjr.szFCjrId = p_szFCjrId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_GetFCjrItem(
p_szFCjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemNumber,
szCjrTrackingId,
szReasonId,
szDescription,
szCollRefNo,
szCollTaskType,
bSuccess

FROM 
BOS_SD_FCjrItem
WHERE 
szFCjrId = p_szFCjrId ;ORDER BY 
shItemNumber


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_GetListOfActiveCjrTracking(
p_szCollectorId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_szStatusTrouble varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_CjrTracking.szCjrTrackingId,
BOS_SD_CjrTracking.szCustId,
COALESCE(BOS_AR_Customer.szName, '') As szCustNm,
BOS_SD_CjrTracking.szTrnId,
BOS_SD_CjrTracking.szDocId

FROM 
BOS_SD_CjrTracking INNER JOIN BOS_AR_Customer ON BOS_SD_CjrTracking.szCustId = BOS_AR_Customer.szCustIdBOS_SD_CjrTracking INNER JOIN BOS_AR_Customer ON BOS_SD_CjrTracking.szCustId = BOS_AR_Customer.szCustId;
WHERE 
BOS_AR_Customer.szStatus <> p_szStatusTrouble AND BOS_SD_CjrTracking.bFinished = 0 AND BOS_SD_CjrTracking.bTasked = 0 AND BOS_SD_CjrTracking.szCollectorId LIKE p_szCollectorId AND BOS_SD_CjrTracking.szCustId LIKE p_szCustId AND (dtmNext  >= p_dtmStart AND dtmNext < p_dtmEnd + 1) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_GetListOfCjrTracking()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCjrTrackingId

FROM 
BOS_SD_CjrTracking

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_GetListOfCjrTrackingTobeReschedule(
p_szCollectorId BOS_DT_szId,
p_bFinished bit,
p_dtmFrom timestamp,
p_dtmTo timestamp)
RETURNS void AS
$BODY$
BEGIN

IF p_szCollectorId = '%'  
  THEN
SELECT  
BSD.bFinished,  
BSD.bSuccess,  
BSD.szCollectorId,  
COALESCE(BPE.szName, '') AS szCollectorName,  
BSD.szCustId,  
COALESCE(BAC.szName, '') AS szCustName,  
BSD.dtmNext AS dtmLastCollectionDate,  
COALESCE(BSF.szReasonId, '') AS szReasonId,  
COALESCE(BSF.szDescription, '') AS szDescription,  
BSD.szCjrTrackingId,  
COALESCE(BSD.szFCjrId, '') As szFCjrId,  
COALESCE(BSC.szScheduleId, '') As szScheduleId,  
COALESCE(BGRS.szDescription, '') As szSchDescription_J,  
BSD.szDocId,  
BSD.szChangeNote,  
BSD.szTrnId,  
BSD.dtmInvoiceExchangeDate  

FROM  
BOS_SD_CjrTracking AS BSD LEFT JOIN BOS_PI_Employee AS BPE ON BSD.szCollectorId = BPE.szEmployeeId  
LEFT JOIN BOS_AR_Customer AS BAC ON BSD.szCustId = BAC.szCustId  
LEFT JOIN BOS_SD_FCjrItem AS BSF ON BSD.szFCjrId = BSF.szFCjrId And BSD.szCjrTrackingId = BSF.szCjrTrackingId  
LEFT JOIN BOS_SD_CustCollRoutine AS BSC ON BSC.szCustId = BSD.szCustId  
LEFT JOIN BOS_GEN_RoutineSchedule AS BGRS ON BGRS.szScheduleId = BSC.szScheduleId  

WHERE  
BSD.dtmNext >= p_dtmFrom And BSD.dtmNext < DateAdd(Day, 1, p_dtmTo) And
--BSD.szCollectorId LIKE p_szCollectorId And  
BSD.bFinished = p_bFinished   

ELSE
SELECT  
BSD.bFinished,  
BSD.bSuccess,  
BSD.szCollectorId,  
COALESCE(BPE.szName, '') AS szCollectorName,  
BSD.szCustId,  
COALESCE(BAC.szName, '') AS szCustName,  
BSD.dtmNext AS dtmLastCollectionDate,  
COALESCE(BSF.szReasonId, '') AS szReasonId,  
COALESCE(BSF.szDescription, '') AS szDescription,  
BSD.szCjrTrackingId,  
COALESCE(BSD.szFCjrId, '') As szFCjrId,  
COALESCE(BSC.szScheduleId, '') As szScheduleId,  
COALESCE(BGRS.szDescription, '') As szSchDescription_J,  
BSD.szDocId,  
BSD.szChangeNote,  
BSD.szTrnId,  
BSD.dtmInvoiceExchangeDate  

FROM  
BOS_SD_CjrTracking AS BSD LEFT JOIN BOS_PI_Employee AS BPE ON BSD.szCollectorId = BPE.szEmployeeId  
LEFT JOIN BOS_AR_Customer AS BAC ON BSD.szCustId = BAC.szCustId  
LEFT JOIN BOS_SD_FCjrItem AS BSF ON BSD.szFCjrId = BSF.szFCjrId And BSD.szCjrTrackingId = BSF.szCjrTrackingId  
LEFT JOIN BOS_SD_CustCollRoutine AS BSC ON BSC.szCustId = BSD.szCustId  
LEFT JOIN BOS_GEN_RoutineSchedule AS BGRS ON BGRS.szScheduleId = BSC.szScheduleId  

WHERE  
BSD.dtmNext >= p_dtmFrom And BSD.dtmNext < DateAdd(Day, 1, p_dtmTo) And
BSD.szCollectorId = p_szCollectorId And  
BSD.bFinished = p_bFinished

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_GetListOfCjrTrackingTobeReschedule_014(
p_szCollectorId BOS_DT_szId,
p_bFinished bit,
p_dtmFrom timestamp,
p_dtmTo timestamp)
RETURNS void AS
$BODY$
BEGIN

IF p_szCollectorId = '%'  
  THEN
SELECT  
BSD.bFinished,  
BSD.bSuccess,  
BSD.szCollectorId,  
COALESCE(BPE.szName, '') AS szCollectorName,  
BSD.szCustId,  
COALESCE(BAC.szName, '') AS szCustName,  
BSD.dtmNext AS dtmLastCollectionDate,  
COALESCE(BSF.szReasonId, '') AS szReasonId,  
COALESCE(BSF.szDescription, '') AS szDescription,  
BSD.szCjrTrackingId,  
COALESCE(BSD.szFCjrId, '') As szFCjrId,  
COALESCE(BSC.szScheduleId, '') As szScheduleId,  
COALESCE(BGRS.szDescription, '') As szSchDescription_J,  
BSD.szDocId,  
BSD.szChangeNote,  
BSD.szTrnId,  
BSD.dtmInvoiceExchangeDate  

FROM  
BOS_SD_CjrTracking AS BSD LEFT JOIN BOS_PI_Employee AS BPE ON BSD.szCollectorId = BPE.szEmployeeId  
LEFT JOIN BOS_AR_Customer AS BAC ON BSD.szCustId = BAC.szCustId  
LEFT JOIN BOS_SD_FCjrItem AS BSF ON BSD.szFCjrId = BSF.szFCjrId And BSD.szCjrTrackingId = BSF.szCjrTrackingId  
LEFT JOIN BOS_SD_CustCollRoutine AS BSC ON BSC.szCustId = BSD.szCustId  
LEFT JOIN BOS_GEN_RoutineSchedule AS BGRS ON BGRS.szScheduleId = BSC.szScheduleId  

WHERE  
BSD.dtmNext >= p_dtmFrom And BSD.dtmNext < DateAdd(Day, 1, p_dtmTo) And
--BSD.szCollectorId LIKE p_szCollectorId And  
BSD.bFinished = p_bFinished   

ELSE
SELECT  
BSD.bFinished,  
BSD.bSuccess,  
BSD.szCollectorId,  
COALESCE(BPE.szName, '') AS szCollectorName,  
BSD.szCustId,  
COALESCE(BAC.szName, '') AS szCustName,  
BSD.dtmNext AS dtmLastCollectionDate,  
COALESCE(BSF.szReasonId, '') AS szReasonId,  
COALESCE(BSF.szDescription, '') AS szDescription,  
BSD.szCjrTrackingId,  
COALESCE(BSD.szFCjrId, '') As szFCjrId,  
COALESCE(BSC.szScheduleId, '') As szScheduleId,  
COALESCE(BGRS.szDescription, '') As szSchDescription_J,  
BSD.szDocId,  
BSD.szChangeNote,  
BSD.szTrnId,  
BSD.dtmInvoiceExchangeDate  

FROM  
BOS_SD_CjrTracking AS BSD LEFT JOIN BOS_PI_Employee AS BPE ON BSD.szCollectorId = BPE.szEmployeeId  
LEFT JOIN BOS_AR_Customer AS BAC ON BSD.szCustId = BAC.szCustId  
LEFT JOIN BOS_SD_FCjrItem AS BSF ON BSD.szFCjrId = BSF.szFCjrId And BSD.szCjrTrackingId = BSF.szCjrTrackingId  
LEFT JOIN BOS_SD_CustCollRoutine AS BSC ON BSC.szCustId = BSD.szCustId  
LEFT JOIN BOS_GEN_RoutineSchedule AS BGRS ON BGRS.szScheduleId = BSC.szScheduleId  

WHERE  
BSD.dtmNext >= p_dtmFrom And BSD.dtmNext < DateAdd(Day, 1, p_dtmTo) And
BSD.szCollectorId = p_szCollectorId And  
BSD.bFinished = p_bFinished


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_GetListOfFCjr()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCjrId,
dtmFCjr

FROM 
BOS_SD_FCjr

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_GetListOfRangeFCjr(
p_szFCjrId_From varchar,
p_szFCjrId_To varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCjrId

FROM 
BOS_SD_FCjr
WHERE 
szFCjrId >= p_szFCjrId_From And szFCjrId <= p_szFCjrId_To And bVoid = 0 ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_GetListOfReportFCj(
p_szFCjrId BOS_DT_szId,
p_szFInvoiceTrnId BOS_DT_szMediumId,
p_szPdrTrnId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSFI.szCjrTrackingId,
COALESCE(BSC.szCustId, '') As szCustId,
COALESCE(BAC.szName, '') As szCustName,
BSC.szTrnId,
BSC.szDocId,
BAT.dtmPeriode,
COALESCE(BAT.decRemain, 0) As decInvAmount,
BAT.dtmDue As dtmDue,
COALESCE(BAC.szCategory_3, '') As szCustCategory_3,
COALESCE(BSFDO.szManualNo, '') As szDoManual

FROM 
BOS_SD_FCjr As BSF
Inner Join BOS_SD_FCjrItem As BSFI On BSF.szFCjrId = BSFI.szFCjrId
Left Join BOS_SD_CjrTracking As BSC On BSFI.szCjrTrackingId = BSC.szCjrTrackingId
Left Join BOS_AR_Customer As BAC On BSC.szCustId = BAC.szCustId
Left Join BOS_AR_ArTrans As BAT On BSC.szTrnId = BAT.szTrnId And BSC.szDocId = BAT.szDocId And
BSC.szCustId = BAT.szCustId And BAT.bClosed = 0
Left Join BOS_SD_FDo As BSFDO on BSC.szDocId = BSFDO.szFirstFInvoiceId
WHERE 
BSF.szFCjrId = p_szFCjrId ;ORDER BY 
BSFI.szFCjrId,
BSFI.shItemNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_GetListOfReportFCj_014(
p_szFCjrId BOS_DT_szId,
p_szFInvoiceTrnId BOS_DT_szMediumId,
p_szPdrTrnId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSFI.szCjrTrackingId,
COALESCE(BSC.szCustId, '') As szCustId,
COALESCE(BAC.szName, '') As szCustName,
BSC.szTrnId,
BSC.szDocId,
BAT.dtmPeriode,
COALESCE(BAT.decRemain, 0) As decInvAmount,
BAT.dtmDue As dtmDue,
COALESCE(BAC.szCategory_3, '') As szCustCategory_3,
COALESCE(BSFDO.szManualNo, '') As szDoManual

FROM 
BOS_SD_FCjr As BSF
Inner Join BOS_SD_FCjrItem As BSFI On BSF.szFCjrId = BSFI.szFCjrId
Left Join BOS_SD_CjrTracking As BSC On BSFI.szCjrTrackingId = BSC.szCjrTrackingId
Left Join BOS_AR_Customer As BAC On BSC.szCustId = BAC.szCustId
Left Join BOS_AR_ArTrans As BAT On BSC.szTrnId = BAT.szTrnId And BSC.szDocId = BAT.szDocId And
BSC.szCustId = BAT.szCustId And BAT.bClosed = 0
Left Join BOS_SD_FDo As BSFDO on BSC.szDocId = BSFDO.szFirstFInvoiceId
WHERE 
BSF.szFCjrId = p_szFCjrId ;ORDER BY 
BSFI.szFCjrId,
BSFI.shItemNumber


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_GetListOfReportFCj_015(
p_szFCjrId BOS_DT_szId,
p_szFInvoiceTrnId BOS_DT_szMediumId,
p_szPdrTrnId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSFI.szCjrTrackingId,
COALESCE(BSC.szCustId, '') As szCustId,
COALESCE(BAC.szName, '') As szCustName,
BSFI.szCollTaskType As szCollTaskType,
COALESCE(BSFI.szCollRefNo,'') As szCollRefNo,
FInvoice.szFakturPajakId,
COALESCE(FDO.szCustReceiptNo,'') As szCustReceiptNo ,
BSC.szTrnId,
BSC.szDocId,
BAT.dtmPeriode,
COALESCE(BAT.decRemain, 0) As decInvAmount,
BAT.dtmDue As dtmDue,
COALESCE(BAC.szCategory_3, '') As szCustCategory_3,
COALESCE(BSFDO.szManualNo, '') As szDoManual

FROM 
BOS_SD_FCjr As BSF
WHERE 
BSF.szFCjrId = p_szFCjrId ;ORDER BY 
BSFI.szFCjrId,
BSFI.shItemNumber




END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_GetListOfReportFCj_016(
p_szFCjrId BOS_DT_szId,
p_szFInvoiceTrnId BOS_DT_szMediumId,
p_szPdrTrnId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSFI.szCjrTrackingId,
COALESCE(BSC.szCustId, '') As szCustId,
COALESCE(BAC.szName, '') As szCustName,
BSFI.szCollTaskType As szCollTaskType,
COALESCE(BSFI.szCollRefNo,'') As szCollRefNo,
FInvoice.szFakturPajakId,
COALESCE(FDO.szCustReceiptNo,'') As szCustReceiptNo ,
BSC.szTrnId,
BSC.szDocId,
BAT.dtmPeriode,
COALESCE(BAT.decRemain, 0) As decOTAmount,
BAT.dtmDue As dtmDue,
COALESCE(BAC.szCategory_3, '') As szCustCategory_3,
COALESCE(BSFDO.szManualNo, '') As szDoManual,
COALESCE(emp.szName, '') As szSalesName ,
COALESCE(BSC.szChangeNote,'') As szChangeNote,
COALESCE(BAT.decAmount, 0) As decInvAmount

FROM 
BOS_SD_FCjr As BSF
WHERE 
BSF.szFCjrId = p_szFCjrId ;ORDER BY 
BSFI.szFCjrId,
BSFI.shItemNumber






END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_GetListOfUnClosedInvoiceToBeCollected(
p_szTrnIdInvoice varchar,
p_szTrnIdPdr varchar,
p_szCustId BOS_DT_szId,
p_dtmCollected timestamp)
RETURNS void AS
$BODY$
BEGIN

Select  
BAT.szTrnId,  
BAT.szDocId,  
IsNull(BSC.szCjrTrackingId, '') As szCjrTrackingId  

From  
BOS_AR_ArTrans As BAT  
Left Join BOS_SD_CjrTracking As BSC On BAT.szTrnId = BSC.szTrnId And BAT.szDocId = BSC.szDocId  and BSC.bFinished=0
LEFT JOIN BOS_AR_CustSales AS BAC ON BAC.szCustId = BAT.szCustId  
LEFT JOIN BOS_AR_PaymentTerm AS BAP ON BAP.szPaymentTermId = BAC.szPaymentTermId  

Where  
(BAT.szTrnId = p_szTrnIdInvoice Or BAT.szTrnId = p_szTrnIdPdr) And  
BAT.bClosed = 0 And  
BAT.szCustId = p_szCustId AND  
--When collecting payment, we want customer to pay at least on the due date printed in the invoice.  
--That's why we have to send invoice several days customer need to process the invoice, before the PRINTED due date.  
BAT.dtmDue_Printed < dateadd(day, isnull(BAP.intDayBeforeDueDateToSendInvoice, 0) + 1, p_dtmCollected)  

Order by  
BAT.szTrnId, BAT.szDocId, BSC.szCjrTrackingId, BAT.szCustId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_GetListOfUnClosedInvoiceToBeCollected_014(
p_szTrnIdInvoice varchar,
p_szTrnIdPdr varchar,
p_szCustId BOS_DT_szId,
p_dtmCollected timestamp)
RETURNS void AS
$BODY$
BEGIN

Select  
BAT.szTrnId,  
BAT.szDocId,  
IsNull(BSC.szCjrTrackingId, '') As szCjrTrackingId  

From  
BOS_AR_ArTrans As BAT  
Left Join BOS_SD_CjrTracking As BSC On BAT.szTrnId = BSC.szTrnId And BAT.szDocId = BSC.szDocId  and BSC.bFinished=0
LEFT JOIN BOS_AR_CustSales AS BAC ON BAC.szCustId = BAT.szCustId  
LEFT JOIN BOS_AR_PaymentTerm AS BAP ON BAP.szPaymentTermId = BAC.szPaymentTermId  

Where  
(BAT.szTrnId = p_szTrnIdInvoice Or BAT.szTrnId = p_szTrnIdPdr) And  
BAT.bClosed = 0 And  
BAT.szCustId = p_szCustId AND  
--When collecting payment, we want customer to pay at least on the due date printed in the invoice.  
--That's why we have to send invoice several days customer need to process the invoice, before the PRINTED due date.  
BAT.dtmDue_Printed < dateadd(day, isnull(BAP.intDayBeforeDueDateToSendInvoice, 0) + 1, p_dtmCollected)  

Order by  
BAT.szTrnId, BAT.szDocId, BSC.szCjrTrackingId, BAT.szCustId


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_IncreaseCjrTrackingTrialCount(
p_szCjrTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CjrTracking
SET 
btTrialCount = btTrialCount + 1
WHERE 
szCjrTrackingId = p_szCjrTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_IsAssignedToTracking(
p_szInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCjrTrackingId

FROM 
BOS_SD_CjrTracking
WHERE 
 szDocId = p_szInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_IsCjrTrackingExist(
p_szCjrTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCjrTrackingId

FROM 
BOS_SD_CjrTracking
WHERE 
szCjrTrackingId = p_szCjrTrackingId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_IsFCjrCreated(
p_szCollectorId BOS_DT_szId,
p_dtmFromDate timestamp,
p_dtmToDate timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCjrId

FROM 
BOS_SD_FCjr
WHERE 
bVoid = 0 AND szCollectorId = p_szCollectorId AND (dtmFCjr >= p_dtmFromDate AND dtmFCjr < p_dtmToDate + 1) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_IsFCjrExist(
p_szFCjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCjrId

FROM 
BOS_SD_FCjr
WHERE 
szFCjrId = p_szFCjrId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_LockCjrTracking(
p_szCjrTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CjrTracking
SET 
btTrialCount = btTrialCount
WHERE 
szCjrTrackingId = p_szCjrTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_LockFCjr(
p_szFCjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FCjr
SET 
bTransferred = bTransferred
WHERE 
szFCjrId = p_szFCjrId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_MarkCjrTracking(
p_szCjrTrackingId BOS_DT_szId,
p_bTasked bit,
p_bFinished bit,
p_dtmNext timestamp,
p_szCollectorId BOS_DT_szId,
p_szFCjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CjrTracking
SET 
bTasked = p_bTasked,
bFinished = p_bFinished,
dtmNext = p_dtmNext,
szCollectorId = p_szCollectorId,
szFCjrId = p_szFCjrId

WHERE 
szCjrTrackingId = p_szCjrTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_MarkCjrTrackingTasked(
p_szCjrTrackingId BOS_DT_szId,
p_bTasked bit,
p_szFCjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CjrTracking
SET 
bTasked = p_bTasked,
szFCjrId = p_szFCjrId

WHERE 
szCjrTrackingId = p_szCjrTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_MarkFCjrVoid(
p_szFCjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FCjr
SET 
bVoid = 1,
bApplied = 0

WHERE 
szFCjrId = p_szFCjrId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_UpdateCjrTracking(
p_szCjrTrackingId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCollectorId BOS_DT_szId,
p_szFCjrId BOS_DT_szId,
p_bFinished bit,
p_bSuccess bit,
p_bTasked bit,
p_dtmNext timestamp,
p_btTrialCount smallint,
p_szChangeNote varchar,
p_dtmInvoiceExchangeDate timestamp,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CjrTracking
SET 
szCustId = p_szCustId,
szTrnId = p_szTrnId,
szDocId = p_szDocId,
szCollectorId = p_szCollectorId,
szFCjrId = p_szFCjrId,
bFinished = p_bFinished,
bSuccess = p_bSuccess,
bTasked = p_bTasked,
dtmNext = p_dtmNext,
btTrialCount = p_btTrialCount,
szChangeNote = p_szChangeNote,
dtmInvoiceExchangeDate = p_dtmInvoiceExchangeDate
, dtmLastUpdated = p_dtmLastUpdated
WHERE 
szCjrTrackingId = p_szCjrTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_UpdateCjrTracking_013(
p_szCjrTrackingId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCollectorId BOS_DT_szId,
p_szFCjrId BOS_DT_szId,
p_bFinished bit,
p_bSuccess bit,
p_bTasked bit,
p_dtmNext timestamp,
p_btTrialCount smallint,
p_szChangeNote varchar,
p_dtmInvoiceExchangeDate timestamp,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CjrTracking
SET 
szCustId = p_szCustId,
szTrnId = p_szTrnId,
szDocId = p_szDocId,
szCollectorId = p_szCollectorId,
szFCjrId = p_szFCjrId,
bFinished = p_bFinished,
bSuccess = p_bSuccess,
bTasked = p_bTasked,
dtmNext = p_dtmNext,
btTrialCount = p_btTrialCount,
szChangeNote = p_szChangeNote,

dtmInvoiceExchangeDate = p_dtmInvoiceExchangeDate,
dtmLastUpdated = p_dtmLastUpdated

WHERE 
szCjrTrackingId = p_szCjrTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_UpdateCjrTracking_014(
p_szCjrTrackingId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szCollectorId BOS_DT_szId,
p_szFCjrId BOS_DT_szId,
p_bFinished bit,
p_bSuccess bit,
p_bTasked bit,
p_dtmNext timestamp,
p_btTrialCount smallint,
p_szChangeNote varchar,
p_szPaymentRefNo varchar,
p_dtmInvoiceExchangeDate timestamp,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CjrTracking
SET 
szCustId = p_szCustId,
szTrnId = p_szTrnId,
szDocId = p_szDocId,
szCollectorId = p_szCollectorId,
szFCjrId = p_szFCjrId,
bFinished = p_bFinished,
bSuccess = p_bSuccess,
bTasked = p_bTasked,
dtmNext = p_dtmNext,
btTrialCount = p_btTrialCount,
szChangeNote = p_szChangeNote,
szPaymentRefNo = p_szPaymentRefNo,
dtmInvoiceExchangeDate = p_dtmInvoiceExchangeDate,
dtmLastUpdated = p_dtmLastUpdated

WHERE 
szCjrTrackingId = p_szCjrTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_UpdateCjrTrackingNextSchedule(
p_szCjrTrackingId BOS_DT_szId,
p_dtmNext timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_CjrTracking
SET 
dtmNext = p_dtmNext
WHERE 
szCjrTrackingId = p_szCjrTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_UpdateFCjr(
p_szFCjrId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szBaseRouteId BOS_DT_szId,
p_dtmFCjr timestamp,
p_szCollectorId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FCjr
SET 
szSalesOrgId = p_szSalesOrgId,
szBaseRouteId = p_szBaseRouteId,
dtmFCjr = p_dtmFCjr,
szCollectorId = p_szCollectorId,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

, dtmLastUpdated = p_dtmLastUpdated

WHERE 
szFCjrId = p_szFCjrId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_UpdateFCjr_014(
p_szFCjrId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szBaseRouteId BOS_DT_szId,
p_dtmFCjr timestamp,
p_szCollectorId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FCjr
SET 
szSalesOrgId = p_szSalesOrgId,
szBaseRouteId = p_szBaseRouteId,
dtmFCjr = p_dtmFCjr,
szCollectorId = p_szCollectorId,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

, dtmLastUpdated = p_dtmLastUpdated

WHERE 
szFCjrId = p_szFCjrId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_UpdateFCjrItemReason(
p_szFCjrId BOS_DT_szId,
p_szCjrTrackingId BOS_DT_szId,
p_szReasonId BOS_DT_szId,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FCjrItem
SET 
szReasonId = p_szReasonId,
szDescription = p_szDescription
WHERE 
szFCjrID = p_szFCjrId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCjr_UpdateFCjrItemSuccess(
p_szFCjrId BOS_DT_szId,
p_szCjrTrackingId BOS_DT_szId,
p_bSuccess bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FCjrItem
SET 
bSuccess = p_bSuccess
WHERE 
szFCjrID = p_szFCjrId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCustFoc_CreateFCustFoc(
p_szFCustFocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szFocId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_bOverride bit,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FCustFoc
(
szFCustFocId,
szCustId,
szFocId,
dtmStart,
dtmEnd,
bOverride,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
szUserId,
-- Data Status.,
dtmLastUpdated ,
bAlreadyTransferred
)
VALUES
(
p_szFCustFocId,
p_szCustId,
p_szFocId,
p_dtmStart,
p_dtmEnd,
p_bOverride,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCustFoc_DeleteFCustFoc(
p_szFCustFocId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SD_FCustFoc
WHERE
szFCustFocId=p_szFCustFocId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCustFoc_GetFCustFoc(
p_szFCustFocId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_SD_FCustFoc.szCustId,
BOS_AR_Customer.szName as szCustNm,
BOS_SD_FCustFoc.szFocId,
BOS_SD_FCustFoc.dtmStart,
BOS_SD_FCustFoc.dtmEnd,
BOS_SD_FCustFoc.bOverride,

BOS_SD_FCustFoc.bResultFrTransfer,
BOS_SD_FCustFoc.bVoid,
BOS_GEN_Approved.bApproved,
BOS_SD_FCustFoc.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_SD_FCustFoc.btPrintedCount,
BOS_SD_FCustFoc.bTransferred,

BOS_SD_FCustFoc.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,

BOS_SD_FCustFoc.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,

BOS_SD_FCustFoc.szTaxEntityId,
BOS_SD_FCustFoc.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_SD_FCustFoc.dtmCreated,
CAST(0 AS tinyint) AS bSystemCreated,

BOS_SD_FCustFoc.szUserId,
BOS_SM_User.szName AS szUserNm_J,

BOS_SD_FCustFoc.dtmLastUpdated,
BOS_SD_FCustFoc.bAlreadyTransferred
FROM
((BOS_SD_FCustFoc left join BOS_GEN_Approved on BOS_SD_FCustFoc.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
left join BOS_GL_FJournalTrans on BOS_SD_FCustFoc.szFJournalId = BOS_GL_FJournalTrans.szFJournalId)
left join BOS_AR_Customer on BOS_AR_Customer.szCustId = BOS_SD_FCustFoc.szCustId

LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FCustFoc.szUserId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FCustFoc.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FCustFoc.szWorkplaceId

WHERE
szFCustFocId = p_szFCustFocId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCustFoc_GetListOfFCustFoc()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCustFocId,
szCustId,
szFocId

FROM 
BOS_SD_FCustFoc

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCustFoc_IsFCustFocExist(
p_szFCustFocId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFCustFocId

FROM 
BOS_SD_FCustFoc
WHERE 
szFCustFocId=p_szFCustFocId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCustFoc_LockFCustFoc(
p_szFCustFocId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FCustFoc
SET 
szCustId=szCustId
WHERE 
szFCustFocId=p_szFCustFocId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCustFoc_MarkFCustFocApplied(
p_szFCustFocId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FCustFoc
SET 
bApplied = 1
WHERE 
szFCustFocId = p_szFCustFocId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCustFoc_MarkFCustFocVoid(
p_szFCustFocId BOS_DT_szId,
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FCustFoc
SET 
bVoid = 1,
bNeedApproval = 0,
gdApprovedId = p_gdApprovedId
WHERE 
szFCustFocId = p_szFCustFocId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FCustFoc_UpdateFCustFoc(
p_szFCustFocId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szFocId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_bOverride bit,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FCustFoc
SET 
szCustId = p_szCustId,
szFocId = p_szFocId,
dtmStart = p_dtmStart,
dtmEnd = p_dtmEnd,
bOverride = p_bOverride,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFCustFocId = p_szFCustFocId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_CreateDjrTracking(
p_szDjrTrackingId BOS_DT_szId,
p_szType BOS_DT_szSmallId,
p_szCustId BOS_DT_szId,
p_szFDoId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szFDjrId BOS_DT_szId,
p_bFinished bit,
p_bSuccess bit,
p_bTasked bit,
p_dtmNext timestamp,
p_btTrialCount smallint,
p_szTeamId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_decValue BOS_DT_decAmount,
p_szFCallId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_bDoNotIncrStockToDeliver smallint,
p_decCustSalesTarget BOS_DT_decAmount,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_DjrTracking
(
szDjrTrackingId,
szType,
szCustId,
szFDoId,
szDriverId,
szFDjrId,
bFinished,
bSuccess,
bTasked,
dtmNext,
btTrialCount,
szTeamId,
szScheduleId,
decValue,
szFCallId,
szWorkplaceId,
bDoNotIncrStockToDeliver,
decCustSalesTarget,
 dtmLastUpdated
)
VALUES
(
p_szDjrTrackingId,
p_szType,
p_szCustId,
p_szFDoId,
p_szDriverId,
p_szFDjrId,
p_bFinished,
p_bSuccess,
p_bTasked,
p_dtmNext,
p_btTrialCount,
p_szTeamId,
p_szScheduleId,
p_decValue,
p_szFCallId,
p_szWorkplaceId,
p_bDoNotIncrStockToDeliver,
p_decCustSalesTarget,
 p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_CreateDjrTracking_013(
p_szDjrTrackingId BOS_DT_szId,
p_szType BOS_DT_szSmallId,
p_szCustId BOS_DT_szId,
p_szFDoId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szFDjrId BOS_DT_szId,
p_bFinished bit,
p_bSuccess bit,
p_bTasked bit,
p_dtmNext timestamp,
p_btTrialCount smallint,
p_szTeamId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_decValue BOS_DT_decAmount,
p_szFCallId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_bDoNotIncrStockToDeliver smallint,
p_decCustSalesTarget BOS_DT_decAmount,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_DjrTracking
(
szDjrTrackingId,
szType,
szCustId,
szFDoId,
szDriverId,
szFDjrId,
bFinished,
bSuccess,
bTasked,
dtmNext,
btTrialCount,
szTeamId,
szScheduleId,
decValue,
szFCallId,
szWorkplaceId,
bDoNotIncrStockToDeliver,
decCustSalesTarget,
 dtmLastUpdated
)
VALUES
(
p_szDjrTrackingId,
p_szType,
p_szCustId,
p_szFDoId,
p_szDriverId,
p_szFDjrId,
p_bFinished,
p_bSuccess,
p_bTasked,
p_dtmNext,
p_btTrialCount,
p_szTeamId,
p_szScheduleId,
p_decValue,
p_szFCallId,
p_szWorkplaceId,
p_bDoNotIncrStockToDeliver,
p_decCustSalesTarget,
 p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_CreateDjrTrackingProduct(
p_szDjrTrackingId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_DjrTrackingProduct
(
szDjrTrackingId,
shItemNumber,
szProductId,
decQty,
szUomId,
szOrderItemTypeId
szParentId,
)
VALUES
(
p_szDjrTrackingId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_szOrderItemTypeId,
p_szParentId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_CreateDjrTrackingProduct_014(
p_szDjrTrackingId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_DjrTrackingProduct
(
szDjrTrackingId,
shItemNumber,
szProductId,
decQty,
szUomId,
szOrderItemTypeId
szParentId,
)
VALUES
(
p_szDjrTrackingId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_szOrderItemTypeId,
p_szParentId,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_CreateFDjr(
p_szFDjrId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szBaseRouteId BOS_DT_szId,
p_dtmFDjr timestamp,
p_szDriverId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_decStartKM BOS_DT_decAmount,
p_decEndKM BOS_DT_decAmount,
p_dtmStartTime timestamp,
p_dtmEndTime timestamp,
p_decVehicleUsageVolume BOS_DT_decAmount,
p_decVehicleUsageWeight BOS_DT_decAmount,
p_szDeliveryGroupId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szHelperId BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_decRit BOS_DT_decDecimal,
p_decTonase numeric,
p_decCubication numeric)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDjr
(
szFDjrId,
szSalesOrgId,
szBaseRouteId,
dtmFDjr,
szDriverId,
szVehicleId,
decStartKM,
decEndKM,
dtmStartTime,
dtmEndTime,
decVehicleUsageVolume,
decVehicleUsageWeight,
szDeliveryGroupId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
-- Helper 123 and Rit,
szHelperId,
szHelperId_2,
szHelperId_3,
decRit,
-- Weight and Volume,
decTonase,
decCubication
)
VALUES
(
p_szFDjrId,
p_szSalesOrgId,
p_szBaseRouteId,
p_dtmFDjr,
p_szDriverId,
p_szVehicleId,
p_decStartKM,
p_decEndKM,
p_dtmStartTime,
p_dtmEndTime,
p_decVehicleUsageVolume,
p_decVehicleUsageWeight,
p_szDeliveryGroupId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
-- Helper 123 and Rit,
p_szHelperId,
p_szHelperId_2,
p_szHelperId_3,
p_decRit,
-- Weight and Volume,
p_decTonase,
p_decCubication,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_CreateFDjr_014(
p_szFDjrId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szBaseRouteId BOS_DT_szId,
p_dtmFDjr timestamp,
p_szDriverId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_decStartKM BOS_DT_decAmount,
p_decEndKM BOS_DT_decAmount,
p_dtmStartTime timestamp,
p_dtmEndTime timestamp,
p_decVehicleUsageVolume BOS_DT_decAmount,
p_decVehicleUsageWeight BOS_DT_decAmount,
p_szDeliveryGroupId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szHelperId BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_decRit BOS_DT_decDecimal,
p_decTonase numeric,
p_decCubication numeric)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDjr
(
szFDjrId,
szSalesOrgId,
szBaseRouteId,
dtmFDjr,
szDriverId,
szVehicleId,
decStartKM,
decEndKM,
dtmStartTime,
dtmEndTime,
decVehicleUsageVolume,
decVehicleUsageWeight,
szDeliveryGroupId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
-- Helper 123 and Rit,
szHelperId,
szHelperId_2,
szHelperId_3,
decRit,
-- Weight and Volume,
decTonase,
decCubication
)
VALUES
(
p_szFDjrId,
p_szSalesOrgId,
p_szBaseRouteId,
p_dtmFDjr,
p_szDriverId,
p_szVehicleId,
p_decStartKM,
p_decEndKM,
p_dtmStartTime,
p_dtmEndTime,
p_decVehicleUsageVolume,
p_decVehicleUsageWeight,
p_szDeliveryGroupId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
-- Helper 123 and Rit,
p_szHelperId,
p_szHelperId_2,
p_szHelperId_3,
p_decRit,
-- Weight and Volume,
p_decTonase,
p_decCubication,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_CreateFDjrItem(
p_szFDjrId BOS_DT_szId,
p_shItemNumber smallint,
p_szDjrTrackingId BOS_DT_szId,
p_szReasonId BOS_DT_szId,
p_szDesciption varchar,
p_bSuccess bit,
p_bStarted BOS_DT_bBoolean,
p_dtmStartVisit timestamp,
p_dtmEndVisit timestamp,
p_decVisitSpendTime numeric,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_bScanBarcodeSuccess smallint,
p_szBarcodeScanFailReasonId BOS_DT_szId,
p_bScanGPSSuccess smallint,
p_szGPSScanFailReasonId BOS_DT_szId,
p_decJourneySpendTime numeric)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDjrItem
(
szFDjrId,
shItemNumber,
szDjrTrackingId,
szReasonId,
szDescription,
bSuccess,
bStarted,
dtmStartVisit,
dtmEndVisit,
decVisitSpendTime,
szLatitude,
szLongitude,
szBarcodeScanFailReasonId,
szGPSScanFailReasonId,
bScanGPSSuccess,
bScanBarcodeSuccess,
decJourneySpendTime
)
VALUES
(
p_szFDjrId,
p_shItemNumber,
p_szDjrTrackingId,
p_szReasonId,
p_szDesciption,
p_bSuccess,
p_bStarted,
p_dtmStartVisit,
p_dtmEndVisit,
p_decVisitSpendTime,
p_szLatitude,
p_szLongitude,
p_szBarcodeScanFailReasonId,
p_szGPSScanFailReasonId,
p_bScanGPSSuccess,
p_bScanBarcodeSuccess,
p_decJourneySpendTime
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_CreateFDjrItem_014(
p_szFDjrId BOS_DT_szId,
p_shItemNumber smallint,
p_szDjrTrackingId BOS_DT_szId,
p_szReasonId BOS_DT_szId,
p_szDesciption varchar,
p_bSuccess bit,
p_bStarted BOS_DT_bBoolean,
p_dtmStartVisit timestamp,
p_dtmEndVisit timestamp,
p_decVisitSpendTime numeric,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_bScanBarcodeSuccess smallint,
p_szBarcodeScanFailReasonId BOS_DT_szId,
p_bScanGPSSuccess smallint,
p_szGPSScanFailReasonId BOS_DT_szId,
p_decJourneySpendTime numeric)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDjrItem
(
szFDjrId,
shItemNumber,
szDjrTrackingId,
szReasonId,
szDescription,
bSuccess,
bStarted,
dtmStartVisit,
dtmEndVisit,
decVisitSpendTime,
szLatitude,
szLongitude,
szBarcodeScanFailReasonId,
szGPSScanFailReasonId,
bScanGPSSuccess,
bScanBarcodeSuccess,
decJourneySpendTime
)
VALUES
(
p_szFDjrId,
p_shItemNumber,
p_szDjrTrackingId,
p_szReasonId,
p_szDesciption,
p_bSuccess,
p_bStarted,
p_dtmStartVisit,
p_dtmEndVisit,
p_decVisitSpendTime,
p_szLatitude,
p_szLongitude,
p_szBarcodeScanFailReasonId,
p_szGPSScanFailReasonId,
p_bScanGPSSuccess,
p_bScanBarcodeSuccess,
p_decJourneySpendTime,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_CreateFDjrProductRequest(
p_szFDjrId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_szWpId1 BOS_DT_szId,
p_szWhId1 BOS_DT_szId,
p_szFPrId1 BOS_DT_szId,
p_decQty1 BOS_DT_decAmount,
p_szWpId2 BOS_DT_szId,
p_szWhId2 BOS_DT_szId,
p_szFPrId2 BOS_DT_szId,
p_decQty2 BOS_DT_decAmount,
p_szWpId3 BOS_DT_szId,
p_szWhId3 BOS_DT_szId,
p_szFPrId3 BOS_DT_szId,
p_decQty3 BOS_DT_decAmount,
p_szWpId4 BOS_DT_szId,
p_szWhId4 BOS_DT_szId,
p_szFPrId4 BOS_DT_szId,
p_decQty4 BOS_DT_decAmount,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDjrProductRequest
(
szFDjrId,
shItemNumber,
szProductId,
decQty,
szUomId,
szWpId1,
szWhId1,
szFPrId1,
decQty1,
szWpId2,
szWhId2,
szFPrId2,
decQty2,
szWpId3,
szWhId3,
szFPrId3,
decQty3,
szWpId4,
szWhId4,
szFPrId4,
decQty4,
szParentId
)
VALUES
(
p_szFDjrId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_szWpId1,
p_szWhId1,
p_szFPrId1,
p_decQty1,
p_szWpId2,
p_szWhId2,
p_szFPrId2,
p_decQty2,
p_szWpId3,
p_szWhId3,
p_szFPrId3,
p_decQty3,
p_szWpId4,
p_szWhId4,
p_szFPrId4,
p_decQty4,
p_szParentId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_CreateFDjrProductRequest_014(
p_szFDjrId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_szWpId1 BOS_DT_szId,
p_szWhId1 BOS_DT_szId,
p_szFPrId1 BOS_DT_szId,
p_decQty1 BOS_DT_decAmount,
p_szWpId2 BOS_DT_szId,
p_szWhId2 BOS_DT_szId,
p_szFPrId2 BOS_DT_szId,
p_decQty2 BOS_DT_decAmount,
p_szWpId3 BOS_DT_szId,
p_szWhId3 BOS_DT_szId,
p_szFPrId3 BOS_DT_szId,
p_decQty3 BOS_DT_decAmount,
p_szWpId4 BOS_DT_szId,
p_szWhId4 BOS_DT_szId,
p_szFPrId4 BOS_DT_szId,
p_decQty4 BOS_DT_decAmount,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDjrProductRequest
(
szFDjrId,
shItemNumber,
szProductId,
decQty,
szUomId,
szWpId1,
szWhId1,
szFPrId1,
decQty1,
szWpId2,
szWhId2,
szFPrId2,
decQty2,
szWpId3,
szWhId3,
szFPrId3,
decQty3,
szWpId4,
szWhId4,
szFPrId4,
decQty4,
szParentId
)
VALUES
(
p_szFDjrId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_szWpId1,
p_szWhId1,
p_szFPrId1,
p_decQty1,
p_szWpId2,
p_szWhId2,
p_szFPrId2,
p_decQty2,
p_szWpId3,
p_szWhId3,
p_szFPrId3,
p_decQty3,
p_szWpId4,
p_szWhId4,
p_szFPrId4,
p_decQty4,
p_szParentId,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_DeleteDjrTrackingProduct(
p_szDjrTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_SD_DjrTrackingProduct
WHERE
szDjrTrackingId = p_szDjrTrackingId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_DeleteDjrTrackingProduct_ByItem(
p_szDjrTrackingId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_DjrTrackingProduct
WHERE
szDjrTrackingId = p_szDjrTrackingIdAND shItemNumber = p_shItemNumber;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_DeleteFDjr(
p_szFDjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FDjr
WHERE
szFDjrId = p_szFDjrId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_DeleteFDjrItem(
p_szFDjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FDjrItem
WHERE
szFDjrId = p_szFDjrId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_DeleteFDjrProductRequest(
p_szFDjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FDjrProductRequest
WHERE
szFDjrId = p_szFDjrId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetDjrTracking(
p_szDjrTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT Distinct
BOS_SD_DjrTracking.szDjrTrackingId,
BOS_SD_DjrTracking.szType,
BOS_SD_DjrTracking.szCustId,
IsNull(BOS_AR_Customer.szName, '') As szCustNm,

BOS_SD_DjrTracking.szFDoId,
BOS_SD_FDo.szFSoId AS szFDoFSoId_J,
BOS_SD_FDo.bApplied AS bFDoApplied_J,

BOS_SD_DjrTracking.szDriverId,
IsNull(BOS_PI_Employee.szName, '') As szDriverNm,
BOS_SD_DjrTracking.szFDjrId,
BOS_SD_DjrTracking.bFinished,
BOS_SD_DjrTracking.bSuccess,
BOS_SD_DjrTracking.bTasked,
BOS_SD_DjrTracking.dtmNext,
BOS_SD_DjrTracking.btTrialCount,

BOS_SD_DjrTracking.szTeamId,
BOS_SD_DjrTracking.szScheduleId,
BOS_SD_DjrTracking.decValue,

IsNull(BOS_SD_FDjrItem.szReasonId, '') As szReasonId,
IsNull(BOS_SD_FDjrItem.szDescription, '') As szDescription,
BOS_SD_DJRTracking.szFCallId,
IsNull(BOS_CRL_FCall.szCallType, '') as szCallType,
BOS_SD_DJRTracking.szWorkplaceId,
BOS_SD_DJRTracking.bDoNotIncrStockToDeliver

--new
, BOS_SD_DjrTracking.decCustSalesTarget

FROM
BOS_SD_DjrTracking LEFT JOIN BOS_AR_Customer ON BOS_SD_DjrTracking.szCustId = BOS_AR_Customer.szCustId
LEFT JOIN BOS_PI_Employee ON BOS_SD_DjrTracking.szDriverId = BOS_PI_Employee.szEmployeeId
Left Join BOS_SD_FDjrItem On BOS_SD_FDjrItem.szFDjrId = BOS_SD_DjrTracking.szFDjrId And 
BOS_SD_FDjrItem.szDjrTrackingId = BOS_SD_DjrTracking.szDjrTrackingId
LEFT JOIN BOS_CRL_FCall ON BOS_CRL_FCall.szFCallId = BOS_SD_DJRTracking.szFCallId
LEFT JOIN BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_SD_DJRTracking.szFDoId

WHERE
BOS_SD_DjrTracking.szDjrTrackingId = p_szDjrTrackingId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetDjrTracking_013(
p_szDjrTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT Distinct      
BOS_SD_DjrTracking.szDjrTrackingId,      
BOS_SD_DjrTracking.szType,      
BOS_SD_DjrTracking.szCustId,      
IsNull(BOS_AR_Customer.szName, '') As szCustNm,      

BOS_SD_DjrTracking.szFDoId,      
BOS_SD_FDo.szFSoId AS szFDoFSoId_J,      
BOS_SD_FDo.bApplied AS bFDoApplied_J,      

BOS_SD_DjrTracking.szDriverId,      
IsNull(BOS_PI_Employee.szName, '') As szDriverNm,      
BOS_SD_DjrTracking.szFDjrId,      
BOS_SD_DjrTracking.bFinished,      
BOS_SD_DjrTracking.bSuccess,      
BOS_SD_DjrTracking.bTasked,      
BOS_SD_DjrTracking.dtmNext,      
BOS_SD_DjrTracking.btTrialCount,      

BOS_SD_DjrTracking.szTeamId,      
BOS_SD_DjrTracking.szScheduleId,      
BOS_SD_DjrTracking.decValue,      

IsNull(BOS_SD_FDjrItem.szReasonId, '') As szReasonId,      
IsNull(BOS_SD_FDjrItem.szDescription, '') As szDescription,      
BOS_SD_DJRTracking.szFCallId,      
IsNull(BOS_CRL_FCall.szCallType, '') as szCallType,      
BOS_SD_DJRTracking.szWorkplaceId,      
BOS_SD_DJRTracking.bDoNotIncrStockToDeliver      

--new      
, BOS_SD_DjrTracking.decCustSalesTarget      
, BOS_SD_DjrTracking.dtmLastUpdated           
FROM      
BOS_SD_DjrTracking LEFT JOIN BOS_AR_Customer ON BOS_SD_DjrTracking.szCustId = BOS_AR_Customer.szCustId      
LEFT JOIN BOS_PI_Employee ON BOS_SD_DjrTracking.szDriverId = BOS_PI_Employee.szEmployeeId      
Left Join BOS_SD_FDjrItem On BOS_SD_FDjrItem.szFDjrId = BOS_SD_DjrTracking.szFDjrId And       
BOS_SD_FDjrItem.szDjrTrackingId = BOS_SD_DjrTracking.szDjrTrackingId      
LEFT JOIN BOS_CRL_FCall ON BOS_CRL_FCall.szFCallId = BOS_SD_DJRTracking.szFCallId      
LEFT JOIN BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_SD_DJRTracking.szFDoId      

WHERE      
BOS_SD_DjrTracking.szDjrTrackingId = p_szDjrTrackingId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetDjrTrackingOfFDo(
p_szFDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDjrTrackingId


FROM 
BOS_SD_DjrTracking

WHERE 
szFDoId = p_szFDoId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetDjrTrackingOfFDo_013(
p_szFDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDjrTrackingId


FROM 
BOS_SD_DjrTracking

WHERE 
szFDoId = p_szFDoId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetDjrTrackingProduct(
p_szDjrTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetDjrTrackingProduct_014(
p_szDjrTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

Select
BOS_SD_DjrTrackingProduct.shItemNumber,
BOS_SD_DjrTrackingProduct.szProductId,

BOS_INV_Product.szName as szProductName_J,
BOS_INV_Product.szNickName as szProductNickName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,
BOS_GL_TaxType.decRate AS decProductTaxRate_J,
BOS_INV_Product.szDiscountGroupId as szProductDiscGroupId_J,

BOS_INV_Product.bKit AS bProductKit_J,
BOS_INV_Product.bExplodeKit AS bProductExplodeKit_J,
BOS_INV_Product.bBreakNonExplodeKit AS bProductBreakNonExplodeKit_J,

BOS_SD_DjrTrackingProduct.decQty,
BOS_SD_DjrTrackingProduct.szUomId,

BOS_SD_DjrTrackingProduct.szOrderItemTypeId,
BOS_INV_OrderItemType.bTaxable AS bOrderItemTypeTaxable_J,
BOS_INV_OrderItemType.bSubjectToInvoice AS bOrderItemTypeSubjectToInvoice_J,
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,
BOS_INV_OrderItemType.szRentChargeCalcId AS 

szOrderItemTypeRentChargeCalcId_J,
BOS_SD_DjrTrackingProduct.szParentId

From
BOS_SD_DjrTrackingProduct
Left Join BOS_INV_Product ON BOS_SD_DjrTrackingProduct.szProductId = 

BOS_INV_Product.szProductId
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = 

BOS_INV_Product.szTaxTypeId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = 

BOS_SD_DjrTrackingProduct.szOrderItemTypeId

Where
BOS_SD_DjrTrackingProduct.szDjrTrackingId = p_szDjrTrackingId
Order By
BOS_SD_DjrTrackingProduct.shItemNumber


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetFDjr(
p_szFDjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_SD_FDjr.szSalesOrgId,
BOS_SD_FDjr.szBaseRouteId,
BOS_SD_FDjr.dtmFDjr,

BOS_SD_FDjr.szDriverId,
IsNull(BOS_PI_Employee.szName, '') As szDriverNm,
BOS_PI_Employee.szTeamId AS szDriverTeamId_J,

BOS_SD_FDjr.szVehicleId,
BOS_INV_Vehicle.szPoliceNo AS szVehicleNumber_J,
BOS_INV_VehicleCapacity.decMaxVolume AS decVehicleMaxVolume_J,
BOS_INV_VehicleCapacity.decMaxWeight AS decVehicleMaxWeight_J,
BOS_SD_FDjr.decVehicleUsageVolume,
BOS_SD_FDjr.decVehicleUsageWeight,
BOS_INV_VehicleCapacity.szVolumeUomId AS szVehicleVolumeUomId_J,
BOS_INV_VehicleCapacity.szWeightUomId AS szVehicleWeightUomId_J,

BOS_SD_FDjr.decStartKM,
BOS_SD_FDjr.decEndKM,
BOS_SD_FDjr.dtmStartTime,
BOS_SD_FDjr.dtmEndTime,
BOS_SD_FDjr.szDeliveryGroupId,
BOS_SD_DeliveryGroup.szDesc AS szDeliveryGroupNm_J,

BOS_SD_FDjr.bResultFrTransfer,
BOS_SD_FDjr.bVoid,
BOS_GEN_Approved.bApproved,
BOS_SD_FDjr.bApplied,
BOS_GL_FJournalTrans.szFJournalId AS bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_SD_FDjr.btPrintedCount,
BOS_SD_FDjr.bTransferred,

BOS_SD_FDjr.szCompanyId,
BOS_GL_Company.szName AS szCompanyNm,

BOS_SD_FDjr.szWorkplaceId,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_SD_FDjr.szTaxEntityId,
BOS_SD_FDjr.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_SD_FDjr.dtmCreated,
BOS_SD_FDjr.bSystemCreated,
BOS_SD_FDjr.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_SD_FDjr.dtmLastUpdated,
BOS_SD_FDjr.bAlreadyTransferred,

BOS_SD_FDjr.szHelperId,
IsNull(E1.szName, '') As szHelperNm,
BOS_SD_FDjr.szHelperId_2,
IsNull(E2.szName, '') As szHelperNm_2,
BOS_SD_FDjr.szHelperId_3,
IsNull(E3.szName, '') As szHelperNm_3,
BOS_SD_FDjr.decRit,

-- Weight and Volume
BOS_SD_FDjr.decTonase,
BOS_SD_FDjr.decCubication
FROM
((BOS_SD_FDjr LEFT JOIN BOS_GEN_Approved ON BOS_SD_FDjr.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FDjr.szFJournalId = BOS_GL_FJournalTrans.szFJournalId)
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDjr.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FDjr.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FDjr.szUserId
LEFT JOIN BOS_PI_Employee ON BOS_SD_FDjr.szDriverId = BOS_PI_Employee.szEmployeeId
LEFT JOIN BOS_PI_Employee E1 ON BOS_SD_FDjr.szHelperId = E1.szEmployeeId
LEFT JOIN BOS_PI_Employee E2 ON BOS_SD_FDjr.szHelperId_2 = E2.szEmployeeId
LEFT JOIN BOS_PI_Employee E3 ON BOS_SD_FDjr.szHelperId_3 = E3.szEmployeeId	

LEFT JOIN BOS_INV_Vehicle ON BOS_INV_Vehicle.szVehicleId = BOS_SD_FDjr.szVehicleId
LEFT JOIN BOS_INV_VehicleCapacity ON BOS_INV_VehicleCapacity.szVehicleCapacityId = BOS_INV_Vehicle.szVehicleCapacityId
LEFT JOIN BOS_SD_DeliveryGroup ON BOS_SD_DeliveryGroup.szDeliveryGroupId = BOS_SD_FDjr.szDeliveryGroupId
WHERE
BOS_SD_FDjr.szFDjrId = p_szFDjrId

-- ==================================================================

set ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetFDjr_014(
p_szFDjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_SD_FDjr.szSalesOrgId,
BOS_SD_FDjr.szBaseRouteId,
BOS_SD_FDjr.dtmFDjr,

BOS_SD_FDjr.szDriverId,
IsNull(BOS_PI_Employee.szName, '') As szDriverNm,
BOS_PI_Employee.szTeamId AS szDriverTeamId_J,

BOS_SD_FDjr.szVehicleId,
BOS_INV_Vehicle.szPoliceNo AS szVehicleNumber_J,
BOS_INV_VehicleCapacity.decMaxVolume AS decVehicleMaxVolume_J,
BOS_INV_VehicleCapacity.decMaxWeight AS decVehicleMaxWeight_J,
BOS_SD_FDjr.decVehicleUsageVolume,
BOS_SD_FDjr.decVehicleUsageWeight,
BOS_INV_VehicleCapacity.szVolumeUomId AS szVehicleVolumeUomId_J,
BOS_INV_VehicleCapacity.szWeightUomId AS szVehicleWeightUomId_J,

BOS_SD_FDjr.decStartKM,
BOS_SD_FDjr.decEndKM,
BOS_SD_FDjr.dtmStartTime,
BOS_SD_FDjr.dtmEndTime,
BOS_SD_FDjr.szDeliveryGroupId,
BOS_SD_DeliveryGroup.szDesc AS szDeliveryGroupNm_J,

BOS_SD_FDjr.bResultFrTransfer,
BOS_SD_FDjr.bVoid,
BOS_GEN_Approved.bApproved,
BOS_SD_FDjr.bApplied,
BOS_GL_FJournalTrans.szFJournalId AS bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_SD_FDjr.btPrintedCount,
BOS_SD_FDjr.bTransferred,

BOS_SD_FDjr.szCompanyId,
BOS_GL_Company.szName AS szCompanyNm,

BOS_SD_FDjr.szWorkplaceId,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_SD_FDjr.szTaxEntityId,
BOS_SD_FDjr.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_SD_FDjr.dtmCreated,
BOS_SD_FDjr.bSystemCreated,
BOS_SD_FDjr.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_SD_FDjr.dtmLastUpdated,
BOS_SD_FDjr.bAlreadyTransferred,

BOS_SD_FDjr.szHelperId,
IsNull(E1.szName, '') As szHelperNm,
BOS_SD_FDjr.szHelperId_2,
IsNull(E2.szName, '') As szHelperNm_2,
BOS_SD_FDjr.szHelperId_3,
IsNull(E3.szName, '') As szHelperNm_3,
BOS_SD_FDjr.decRit,

-- Weight and Volume
BOS_SD_FDjr.decTonase,
BOS_SD_FDjr.decCubication
FROM
((BOS_SD_FDjr LEFT JOIN BOS_GEN_Approved ON BOS_SD_FDjr.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FDjr.szFJournalId = BOS_GL_FJournalTrans.szFJournalId)
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDjr.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FDjr.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FDjr.szUserId
LEFT JOIN BOS_PI_Employee ON BOS_SD_FDjr.szDriverId = BOS_PI_Employee.szEmployeeId
LEFT JOIN BOS_PI_Employee E1 ON BOS_SD_FDjr.szHelperId = E1.szEmployeeId
LEFT JOIN BOS_PI_Employee E2 ON BOS_SD_FDjr.szHelperId_2 = E2.szEmployeeId
LEFT JOIN BOS_PI_Employee E3 ON BOS_SD_FDjr.szHelperId_3 = E3.szEmployeeId    

LEFT JOIN BOS_INV_Vehicle ON BOS_INV_Vehicle.szVehicleId = BOS_SD_FDjr.szVehicleId
LEFT JOIN BOS_INV_VehicleCapacity ON BOS_INV_VehicleCapacity.szVehicleCapacityId = BOS_INV_Vehicle.szVehicleCapacityId
LEFT JOIN BOS_SD_DeliveryGroup ON BOS_SD_DeliveryGroup.szDeliveryGroupId = BOS_SD_FDjr.szDeliveryGroupId
WHERE
BOS_SD_FDjr.szFDjrId = p_szFDjrId

-- ==================================================================

set ANSI_NULLS ON


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetFDjrItem(
p_szFDjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FDjrItem.shItemNumber,
BOS_SD_FDjrItem.szDjrTrackingId,
BOS_SD_FDjrItem.szReasonId,
BOS_SD_FDjrItem.szDescription,
BOS_SD_FDjrItem.bSuccess,
COALESCE(BOS_SD_DjrTracking.szCustId, '') As szCustId,
BOS_SD_FDjrItem.bStarted,
BOS_SD_FDjrItem.dtmStartVisit,
BOS_SD_FDjrItem.dtmEndVisit,
BOS_SD_FDjrItem.decVisitSpendTime,
BOS_SD_FDjrItem.szLatitude,
BOS_SD_FDjrItem.szLongitude,
BOS_SD_FDjrItem.szBarcodeScanFailReasonId,
BOS_SD_FDjrItem.szGPSScanFailReasonId,
BOS_SD_FDjrItem.bScanGPSSuccess,
BOS_SD_FDjrItem.bScanBarcodeSuccess,
COALESCE(BOS_AR_Customer.szName, '') As szCustName,
BOS_SD_FDjrItem.decJourneySpendTime


FROM 
BOS_SD_FDjrItem
Left Join BOS_SD_DjrTracking ON BOS_SD_FDjrItem.szDjrTrackingId = BOS_SD_DjrTracking.szDjrTrackingId
Left Join BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_DjrTracking.szCustId

WHERE 
BOS_SD_FDjrItem.szFDjrId = p_szFDjrId ;ORDER BY 
BOS_SD_FDjrItem.shItemNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetFDjrItem_014(
p_szFDjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FDjrItem.shItemNumber,
BOS_SD_FDjrItem.szDjrTrackingId,
BOS_SD_FDjrItem.szReasonId,
BOS_SD_FDjrItem.szDescription,
BOS_SD_FDjrItem.bSuccess,
COALESCE(BOS_SD_DjrTracking.szCustId, '') As szCustId,
BOS_SD_FDjrItem.bStarted,
BOS_SD_FDjrItem.dtmStartVisit,
BOS_SD_FDjrItem.dtmEndVisit,
BOS_SD_FDjrItem.decVisitSpendTime,
BOS_SD_FDjrItem.szLatitude,
BOS_SD_FDjrItem.szLongitude,
BOS_SD_FDjrItem.szBarcodeScanFailReasonId,
BOS_SD_FDjrItem.szGPSScanFailReasonId,
BOS_SD_FDjrItem.bScanGPSSuccess,
BOS_SD_FDjrItem.bScanBarcodeSuccess,
COALESCE(BOS_AR_Customer.szName, '') As szCustName,
BOS_SD_FDjrItem.decJourneySpendTime


FROM 
BOS_SD_FDjrItem
Left Join BOS_SD_DjrTracking ON BOS_SD_FDjrItem.szDjrTrackingId = BOS_SD_DjrTracking.szDjrTrackingId
Left Join BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_DjrTracking.szCustId

WHERE 
BOS_SD_FDjrItem.szFDjrId = p_szFDjrId ;ORDER BY 
BOS_SD_FDjrItem.shItemNumber


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetFDjrProductRequest(
p_szFDjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT  
BSF.szFDjrId,  
BSF.shItemNumber,  
BSF.szProductId,  
BIP.szNickName As szProductNickName_J,  
BIP.szCompUomId As szProductCompUomId_J,  
BIP.szUomClassId As szProductUomClassId_J,  
BIP.szName As szProductNm_J,  
BIP.szQtyFormat AS szProductQtyFormat_J,  
BIP.szUomId AS szProductUomId_J,  
BSF.decQty,  
BSF.szUomId,  
BSF.szWpId1,  
BSF.szWhId1,  
BSF.szFPrId1,  
BSF.decQty1,  
BSF.szWpId2,  
BSF.szWhId2,  
BSF.szFPrId2,  
BSF.decQty2,  
BSF.szWpId3,  
BSF.szWhId3,  
BSF.szFPrId3,  
BSF.decQty3,  
BSF.szWpId4,  
BSF.szWhId4,  
BSF.szFPrId4,  
BSF.decQty4,  
Convert(bit, IsNull(BSP1.bApplied, 0)) As bApplied1,  
Convert(bit, IsNull(BSP2.bApplied, 0)) As bApplied2,  
Convert(bit, IsNull(BSP3.bApplied, 0)) As bApplied3,  
Convert(bit, IsNull(BSP4.bApplied, 0)) As bApplied4,  

BIPT.decVolume AS decProductVolume_J,  
BIPT.szUomVolume AS szProductVolumeUomId_J,  
BIPT.decWeight AS decProductWeight_J,  
BIPT.szUomWeight AS szProductWeightUomId_J,  
BSF.szParentId AS szParentId,  
BIP2.szName AS szParentNm_J  

FROM  
BOS_SD_FDjrProductRequest As BSF   
LEFT JOIN BOS_SD_FPr As BSP1 ON BSP1.szFPrId = BSF.szFPrId1  
LEFT JOIN BOS_SD_FPr As BSP2 ON BSP2.szFPrId = BSF.szFPrId2  
LEFT JOIN BOS_SD_FPr As BSP3 ON BSP3.szFPrId = BSF.szFPrId3  
LEFT JOIN BOS_SD_FPr As BSP4 ON BSP4.szFPrId = BSF.szFPrId4  
LEFT JOIN BOS_INV_Product As BIP ON BIP.szProductId = BSF.szProductId  
LEFT JOIN BOS_INV_ProductTechnicalSpecInfo AS BIPT ON BIPT.szProductId = BSF.szProductId  
LEFT JOIN BOS_INV_Product AS BIP2 ON BIP2.szProductId = BSF.szParentId  
WHERE  
szFDjrId = p_szFDjrId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetFDjrProductRequest_014(
p_szFDjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT  
BSF.szFDjrId,  
BSF.shItemNumber,  
BSF.szProductId,  
BIP.szNickName As szProductNickName_J,  
BIP.szCompUomId As szProductCompUomId_J,  
BIP.szUomClassId As szProductUomClassId_J,  
BIP.szName As szProductNm_J,  
BIP.szQtyFormat AS szProductQtyFormat_J,  
BIP.szUomId AS szProductUomId_J,  
BSF.decQty,  
BSF.szUomId,  
BSF.szWpId1,  
BSF.szWhId1,  
BSF.szFPrId1,  
BSF.decQty1,  
BSF.szWpId2,  
BSF.szWhId2,  
BSF.szFPrId2,  
BSF.decQty2,  
BSF.szWpId3,  
BSF.szWhId3,  
BSF.szFPrId3,  
BSF.decQty3,  
BSF.szWpId4,  
BSF.szWhId4,  
BSF.szFPrId4,  
BSF.decQty4,  
Convert(bit, IsNull(BSP1.bApplied, 0)) As bApplied1,  
Convert(bit, IsNull(BSP2.bApplied, 0)) As bApplied2,  
Convert(bit, IsNull(BSP3.bApplied, 0)) As bApplied3,  
Convert(bit, IsNull(BSP4.bApplied, 0)) As bApplied4,  

BIPT.decVolume AS decProductVolume_J,  
BIPT.szUomVolume AS szProductVolumeUomId_J,  
BIPT.decWeight AS decProductWeight_J,  
BIPT.szUomWeight AS szProductWeightUomId_J,  
BSF.szParentId AS szParentId,  
BIP2.szName AS szParentNm_J  

FROM  
BOS_SD_FDjrProductRequest As BSF   
LEFT JOIN BOS_SD_FPr As BSP1 ON BSP1.szFPrId = BSF.szFPrId1  
LEFT JOIN BOS_SD_FPr As BSP2 ON BSP2.szFPrId = BSF.szFPrId2  
LEFT JOIN BOS_SD_FPr As BSP3 ON BSP3.szFPrId = BSF.szFPrId3  
LEFT JOIN BOS_SD_FPr As BSP4 ON BSP4.szFPrId = BSF.szFPrId4  
LEFT JOIN BOS_INV_Product As BIP ON BIP.szProductId = BSF.szProductId  
LEFT JOIN BOS_INV_ProductTechnicalSpecInfo AS BIPT ON BIPT.szProductId = BSF.szProductId  
LEFT JOIN BOS_INV_Product AS BIP2 ON BIP2.szProductId = BSF.szParentId  
WHERE  
szFDjrId = p_szFDjrId


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetListOfActiveDjrTrackingId(
p_szType BOS_DT_szSmallId,
p_szDriverId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_szScheduleType BOS_DT_szSmallId,
p_decValue BOS_DT_decAmount,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN

IF p_szScheduleType = ''
  THEN

SELECT
szDjrTrackingId

FROM
BOS_SD_DjrTracking

WHERE
bFinished = 0 AND
szType = p_szType AND
szDriverId = p_szDriverId AND
szCustId = p_szCustId AND
szTeamId LIKE p_szTeamId AND
(dtmNext  >= p_dtmStart AND dtmNext < dateadd(day, 1, p_dtmEnd))

ELSE

SELECT
szDjrTrackingId

FROM
BOS_SD_DjrTracking
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = BOS_SD_DjrTracking.szScheduleId

WHERE
bFinished = 0 AND
szType = p_szType AND
szDriverId = p_szDriverId AND
szCustId = p_szCustId AND
szTeamId LIKE p_szTeamId AND
BOS_GEN_RoutineSchedule.szScheduleType = p_szScheduleType AND
decValue = p_decValue AND
(dtmNext  >= p_dtmStart AND dtmNext < dateadd(day, 1, p_dtmEnd))

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetListOfActiveDjrTrackingId_013(
p_szType BOS_DT_szSmallId,
p_szDriverId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_szScheduleType BOS_DT_szSmallId,
p_decValue BOS_DT_decAmount,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN

IF p_szScheduleType = ''  
  THEN

SELECT  
szDjrTrackingId  

FROM  
BOS_SD_DjrTracking  

WHERE  
bFinished = 0 AND  
szType = p_szType AND  
szDriverId = p_szDriverId AND  
szCustId = p_szCustId AND  
szTeamId LIKE p_szTeamId AND  
(dtmNext  >= p_dtmStart AND dtmNext < dateadd(day, 1, p_dtmEnd))  

ELSE  

SELECT  
szDjrTrackingId  

FROM  
BOS_SD_DjrTracking  
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = BOS_SD_DjrTracking.szScheduleId  

WHERE  
bFinished = 0 AND  
szType = p_szType AND  
szDriverId = p_szDriverId AND  
szCustId = p_szCustId AND  
szTeamId LIKE p_szTeamId AND  
BOS_GEN_RoutineSchedule.szScheduleType = p_szScheduleType AND  
decValue = p_decValue AND  
(dtmNext  >= p_dtmStart AND dtmNext < dateadd(day, 1, p_dtmEnd))

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetListOfDjrTracking()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDjrTrackingId


FROM 
BOS_SD_DjrTracking

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetListOfDjrTrackingTobeReschedule(
p_szDriverId BOS_DT_szId,
p_bFinished bit,
p_dtmFrom timestamp,
p_dtmTo timestamp)
RETURNS void AS
$BODY$
BEGIN

IF p_szDriverId = '%'  
  THEN
SELECT  
BSD.bFinished,  
BSD.bSuccess,  
BSD.szDriverId,  
COALESCE(BPE.szName, '') AS szDriverName,  
BSD.szCustId,  
COALESCE(BAC.szName, '') AS szCustName,  
BSD.dtmNext AS dtmLastDeliveryDate,  
COALESCE(BSF.szReasonId, '') AS szReasonId,  
COALESCE(BSF.szDescription, '') AS szDescription,  
BSD.szDjrTrackingId,  
COALESCE(BSD.szFDjrId, '') As szFDjrId,  
BSD.szTeamId,  
BSD.szScheduleId,  
COALESCE(BGRS.szDescription, '') As szSchDescription_J,  
BSD.szFDoId,  
BSD.decValue  
FROM  
BOS_SD_DjrTracking AS BSD LEFT JOIN BOS_PI_Employee AS BPE ON BSD.szDriverId = BPE.szEmployeeId  
LEFT JOIN BOS_AR_Customer AS BAC ON BSD.szCustId = BAC.szCustId  
LEFT JOIN BOS_SD_FDjrItem AS BSF ON BSD.szFDjrId = BSF.szFDjrId And BSD.szDjrTrackingId = BSF.szDjrTrackingId  
LEFT JOIN BOS_GEN_RoutineSchedule AS BGRS ON BGRS.szScheduleId = BSD.szScheduleId  
WHERE  
BSD.dtmNext >= p_dtmFrom And BSD.dtmNext < DateAdd(Day, 1, p_dtmTo) And
--BSD.szDriverId LIKE p_szDriverId And  
BSD.bFinished = p_bFinished  

ORDER BY  
BSD.szDriverId  
ELSE
SELECT  
BSD.bFinished,  
BSD.bSuccess,  
BSD.szDriverId,  
COALESCE(BPE.szName, '') AS szDriverName,  
BSD.szCustId,  
COALESCE(BAC.szName, '') AS szCustName,  
BSD.dtmNext AS dtmLastDeliveryDate,  
COALESCE(BSF.szReasonId, '') AS szReasonId,  
COALESCE(BSF.szDescription, '') AS szDescription,  
BSD.szDjrTrackingId,  
COALESCE(BSD.szFDjrId, '') As szFDjrId,  
BSD.szTeamId,  
BSD.szScheduleId,  
COALESCE(BGRS.szDescription, '') As szSchDescription_J,  
BSD.szFDoId,  
BSD.decValue  
FROM  
BOS_SD_DjrTracking AS BSD LEFT JOIN BOS_PI_Employee AS BPE ON BSD.szDriverId = BPE.szEmployeeId  
LEFT JOIN BOS_AR_Customer AS BAC ON BSD.szCustId = BAC.szCustId  
LEFT JOIN BOS_SD_FDjrItem AS BSF ON BSD.szFDjrId = BSF.szFDjrId And BSD.szDjrTrackingId = BSF.szDjrTrackingId  
LEFT JOIN BOS_GEN_RoutineSchedule AS BGRS ON BGRS.szScheduleId = BSD.szScheduleId  
WHERE  
BSD.dtmNext >= p_dtmFrom And BSD.dtmNext < DateAdd(Day, 1, p_dtmTo) And
BSD.szDriverId = p_szDriverId And  
BSD.bFinished = p_bFinished  

ORDER BY  
BSD.szDriverId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetListOfDjrTrackingTobeReschedule_014(
p_szDriverId BOS_DT_szId,
p_bFinished bit,
p_dtmFrom timestamp,
p_dtmTo timestamp)
RETURNS void AS
$BODY$
BEGIN

IF p_szDriverId = '%'  
  THEN
SELECT  
BSD.bFinished,  
BSD.bSuccess,  
BSD.szDriverId,  
COALESCE(BPE.szName, '') AS szDriverName,  
BSD.szCustId,  
COALESCE(BAC.szName, '') AS szCustName,  
BSD.dtmNext AS dtmLastDeliveryDate,  
COALESCE(BSF.szReasonId, '') AS szReasonId,  
COALESCE(BSF.szDescription, '') AS szDescription,  
BSD.szDjrTrackingId,  
COALESCE(BSD.szFDjrId, '') As szFDjrId,  
BSD.szTeamId,  
BSD.szScheduleId,  
COALESCE(BGRS.szDescription, '') As szSchDescription_J,  
BSD.szFDoId,  
BSD.decValue  
FROM  
BOS_SD_DjrTracking AS BSD LEFT JOIN BOS_PI_Employee AS BPE ON BSD.szDriverId = BPE.szEmployeeId  
LEFT JOIN BOS_AR_Customer AS BAC ON BSD.szCustId = BAC.szCustId  
LEFT JOIN BOS_SD_FDjrItem AS BSF ON BSD.szFDjrId = BSF.szFDjrId And BSD.szDjrTrackingId = BSF.szDjrTrackingId  
LEFT JOIN BOS_GEN_RoutineSchedule AS BGRS ON BGRS.szScheduleId = BSD.szScheduleId  
WHERE  
BSD.dtmNext >= p_dtmFrom And BSD.dtmNext < DateAdd(Day, 1, p_dtmTo) And
--BSD.szDriverId LIKE p_szDriverId And  
BSD.bFinished = p_bFinished  

ORDER BY  
BSD.szDriverId  
ELSE
SELECT  
BSD.bFinished,  
BSD.bSuccess,  
BSD.szDriverId,  
COALESCE(BPE.szName, '') AS szDriverName,  
BSD.szCustId,  
COALESCE(BAC.szName, '') AS szCustName,  
BSD.dtmNext AS dtmLastDeliveryDate,  
COALESCE(BSF.szReasonId, '') AS szReasonId,  
COALESCE(BSF.szDescription, '') AS szDescription,  
BSD.szDjrTrackingId,  
COALESCE(BSD.szFDjrId, '') As szFDjrId,  
BSD.szTeamId,  
BSD.szScheduleId,  
COALESCE(BGRS.szDescription, '') As szSchDescription_J,  
BSD.szFDoId,  
BSD.decValue  
FROM  
BOS_SD_DjrTracking AS BSD LEFT JOIN BOS_PI_Employee AS BPE ON BSD.szDriverId = BPE.szEmployeeId  
LEFT JOIN BOS_AR_Customer AS BAC ON BSD.szCustId = BAC.szCustId  
LEFT JOIN BOS_SD_FDjrItem AS BSF ON BSD.szFDjrId = BSF.szFDjrId And BSD.szDjrTrackingId = BSF.szDjrTrackingId  
LEFT JOIN BOS_GEN_RoutineSchedule AS BGRS ON BGRS.szScheduleId = BSD.szScheduleId  
WHERE  
BSD.dtmNext >= p_dtmFrom And BSD.dtmNext < DateAdd(Day, 1, p_dtmTo) And
BSD.szDriverId = p_szDriverId And  
BSD.bFinished = p_bFinished  

ORDER BY  
BSD.szDriverId


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetListOfFDjr()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFDjrId,
dtmFDjr

FROM 
BOS_SD_FDjr

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetListOfNotTaskedDjrTracking(
p_szType BOS_DT_szSmallId,
p_szDriverId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_szStatusACT varchar,
p_szStatusFDE varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_DjrTracking.szDjrTrackingId,
BOS_SD_DjrTracking.szCustId,
COALESCE(BOS_AR_Customer.szName, '') AS szCustNm,
BOS_SD_DjrTracking.szFDoId


FROM 
BOS_SD_DjrTracking
LEFT JOIN BOS_AR_Customer ON BOS_SD_DjrTracking.szCustId = BOS_AR_Customer.szCustIdLEFT JOIN BOS_AR_Customer ON BOS_SD_DjrTracking.szCustId = BOS_AR_Customer.szCustId;

WHERE 
(BOS_AR_Customer.szStatus = p_szStatusACT OR BOS_AR_Customer.szStatus = p_szStatusFDE) AND BOS_SD_DjrTracking.bFinished = 0 AND BOS_SD_DjrTracking.bTasked = 0 AND BOS_SD_DjrTracking.szType LIKE p_szType AND BOS_SD_DjrTracking.szDriverId LIKE p_szDriverId AND BOS_SD_DjrTracking.szCustId LIKE p_szCustId AND BOS_SD_DjrTracking.szTeamId LIKE p_szTeamId AND (BOS_SD_DjrTracking.dtmNext  >= p_dtmStart AND BOS_SD_DjrTracking.dtmNext < dateadd(day, 1, p_dtmEnd)) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetListOfNotTaskedDjrTracking_013(
p_szType BOS_DT_szSmallId,
p_szDriverId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_szStatusACT varchar,
p_szStatusFDE varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_DjrTracking.szDjrTrackingId,
BOS_SD_DjrTracking.szCustId,
COALESCE(BOS_AR_Customer.szName, '') AS szCustNm,
BOS_SD_DjrTracking.szFDoId


FROM 
BOS_SD_DjrTracking
LEFT JOIN BOS_AR_Customer ON BOS_SD_DjrTracking.szCustId = BOS_AR_Customer.szCustIdLEFT JOIN BOS_AR_Customer ON BOS_SD_DjrTracking.szCustId = BOS_AR_Customer.szCustId;

WHERE 
(BOS_AR_Customer.szStatus = p_szStatusACT OR BOS_AR_Customer.szStatus = p_szStatusFDE) AND BOS_SD_DjrTracking.bFinished = 0 AND BOS_SD_DjrTracking.bTasked = 0 AND BOS_SD_DjrTracking.szType LIKE p_szType AND BOS_SD_DjrTracking.szDriverId LIKE p_szDriverId AND BOS_SD_DjrTracking.szCustId LIKE p_szCustId AND BOS_SD_DjrTracking.szTeamId LIKE p_szTeamId AND (BOS_SD_DjrTracking.dtmNext  >= p_dtmStart AND BOS_SD_DjrTracking.dtmNext < dateadd(day, 1, p_dtmEnd)) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetListOfProductRequestCalculation(
p_szDjrTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BSDP.szProductId,
IsNull(BIP.szName, '') As szProductName,
BIP.szQtyFormat AS szProductQtyFormat_J,
BIP.szUomClassId AS szProductUomClassId_J,
BIP.szCompUomId AS szProductCompUomId_J,

BIP.bKit,
BIP.bExplodeKit,
BIP.bBreakNonExplodeKit AS bProductBreakNonExplodeKit_J,
BSDP.decQty,
BSDP.szUomId,

BIPT.decVolume AS decProductVolume_J,
BIPT.szUomVolume AS szProductVolumeUomId_J,
BIPT.decWeight AS decProductWeight_J,
BIPT.szUomWeight AS szProductWeightUomId_J,
BSDP.szParentId AS szParentId

FROM
BOS_SD_DjrTracking AS BSD 
INNER JOIN BOS_SD_DjrTrackingProduct As BSDP ON BSDP.szDjrTrackingId = BSD.szDjrTrackingId
LEFT JOIN BOS_INV_Product AS BIP ON BIP.szProductId = BSDP.szProductId
LEFT JOIN BOS_INV_ProductTechnicalSpecInfo AS BIPT ON BIPT.szProductId = BSDP.szProductId

WHERE
BSD.szDjrTrackingId = p_szDjrTrackingId

-- ==================================================================

set ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetListOfProductRequestCalculation_014(
p_szDjrTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BSDP.szProductId,
IsNull(BIP.szName, '') As szProductName,
BIP.szQtyFormat AS szProductQtyFormat_J,
BIP.szUomClassId AS szProductUomClassId_J,
BIP.szCompUomId AS szProductCompUomId_J,

BIP.bKit,
BIP.bExplodeKit,
BIP.bBreakNonExplodeKit AS bProductBreakNonExplodeKit_J,
BSDP.decQty,
BSDP.szUomId,

BIPT.decVolume AS decProductVolume_J,
BIPT.szUomVolume AS szProductVolumeUomId_J,
BIPT.decWeight AS decProductWeight_J,
BIPT.szUomWeight AS szProductWeightUomId_J,
BSDP.szParentId AS szParentId

FROM
BOS_SD_DjrTracking AS BSD 
INNER JOIN BOS_SD_DjrTrackingProduct As BSDP ON BSDP.szDjrTrackingId = BSD.szDjrTrackingId
LEFT JOIN BOS_INV_Product AS BIP ON BIP.szProductId = BSDP.szProductId
LEFT JOIN BOS_INV_ProductTechnicalSpecInfo AS BIPT ON BIPT.szProductId = BSDP.szProductId

WHERE
BSD.szDjrTrackingId = p_szDjrTrackingId

-- ==================================================================

set ANSI_NULLS ON


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetListOfRangeFDjr(
p_szFDjrId_From varchar,
p_szFDjrId_To varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFDjrId

FROM 
BOS_SD_FDjr
WHERE 
 szFDjrId >= p_szFDjrId_From And szFDjrId <= p_szFDjrId_To And bVoid = 0;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetListOfReportFDj(
p_szFDjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSFI.szDjrTrackingId,
BSD.szCustId,
COALESCE(BAC.szName, '') As szCustName,
BSD.szFDoId,
BACS.bAllowToCredit As bAllowToCredit, /*Check null or !null in .net code*/
BSD.szScheduleId,
BAAM.decAmount As decOutstanding, /*Check null or !null in .net code*/
BSFDLast.dtmDelivery,	/*Check null or !null in .net code*/
BAC.szCategory_3 as szCustCategory_3

FROM 
BOS_SD_FDjr As BSF
Inner Join BOS_SD_FDjrItem As BSFI On BSFI.szFDjrId = BSF.szFDjrId
Inner Join BOS_SD_DjrTracking As BSD On BSD.szDjrTrackingId = BSFI.szDjrTrackingId
Left Join BOS_AR_Customer As BAC On BAC.szCustId = BSD.szCustId
Left Join BOS_AR_CustSales As BACS On BACS.szCustId = BSD.szCustId
Left Join BOS_SD_CustRoutine As BSC On BSC.szCustId = BSD.szCustId
Left Join BOS_SD_FDo As BSFDLast On BSFDLast.szDoId = BSC.szLastFDoId
Left Join BOS_SD_FDo As BSFD On BSFD.szDoId = BSD.szFDoId
Left Join BOS_AR_ArMaster As BAAM On BAAM.szCustId = BSD.szCustId And BAAM.szCcyId = BSFD.szCcyId
WHERE 
BSF.szFDjrId = p_szFDjrId ;ORDER BY 
BSFI.shItemNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetListOfReportFDj_013(
p_szFDjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSFI.szDjrTrackingId,
BSD.szCustId,
COALESCE(BAC.szName, '') As szCustName,
BSD.szFDoId,
BACS.bAllowToCredit As bAllowToCredit, /*Check null or !null in .net code*/
BSD.szScheduleId,
ISNULL(BAAM.decAmount, 0) As decOutstanding, /*Check null or !null in .net code*/
ISNULL(BSFDLast.dtmDelivery, 0) AS dtmDelivery, /*Check null or !null in .net code*/
BAC.szCategory_3 as szCustCategory_3,
ISNULL(BAAM.intNumberOfOpenInvoice, 0) AS intNumberOfOpenInvoice,
ISNULL(BSFD.szFSoId, '') AS szFSoId

FROM 
BOS_SD_FDjr As BSF
Inner Join BOS_SD_FDjrItem As BSFI On BSFI.szFDjrId = BSF.szFDjrId
Inner Join BOS_SD_DjrTracking As BSD On BSD.szDjrTrackingId = BSFI.szDjrTrackingId
Left Join BOS_AR_Customer As BAC On BAC.szCustId = BSD.szCustId
Left Join BOS_AR_CustSales As BACS On BACS.szCustId = BSD.szCustId
Left Join BOS_SD_CustRoutine As BSC On BSC.szCustId = BSD.szCustId
Left Join BOS_SD_FDo As BSFDLast On BSFDLast.szDoId = BSC.szLastFDoId
Left Join BOS_SD_FDo As BSFD On BSFD.szDoId = BSD.szFDoId
Left Join BOS_AR_ArMaster As BAAM On BAAM.szCustId = BSD.szCustId And BAAM.szCcyId = BSFD.szCcyId
WHERE 
BSF.szFDjrId = p_szFDjrId ;ORDER BY 
BSFI.shItemNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetListOfReportFDjForDepositRemain(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BACPD.szProductId,
COALESCE(BIP.szName, '') As szProductName,
BACPD.decQty


FROM 
BOS_AR_CustProductDeposit As BACPD
Left Join BOS_INV_Product As BIP On BACPD.szProductId = BIP.szProductId

WHERE 
BACPD.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetListOfReportFDjForFOCRemain(
p_szCustId varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSCFI.szProductId,
COALESCE(BIP.szName, '') As szProductName,
BSCFI.decQtyRemain


FROM 
BOS_SD_CustFOCItem As BSCFI
Left Join BOS_INV_Product As BIP On BSCFI.szProductId = BIP.szProductId

WHERE 
BSCFI.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetListOfReportFDjForLastSentFDo(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSFI.szProductId,
COALESCE(BIP.szName, '') As szProductName,
BSFI.decQty,
BSFI.szParentId,
BSFI.szUomId

FROM 
BOS_SD_FDo As BSF
WHERE 
BSC.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_GetListOfReportFDjForLastSentFDo_014(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSFI.szProductId,
COALESCE(BIP.szName, '') As szProductName,
BSFI.decQty,
BSFI.szParentId,
BSFI.szUomId

FROM 
BOS_SD_FDo As BSF
WHERE 
BSC.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_IsAssignedToTracking(
p_szFDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDjrTrackingId

FROM 
BOS_SD_DjrTracking
WHERE 
 szFDoId = p_szFDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_IsAssignedToTracking_013(
p_szFDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDjrTrackingId

FROM 
BOS_SD_DjrTracking
WHERE 
 szFDoId = p_szFDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_IsDjrTrackingExist(
p_szDjrTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDjrTrackingId

FROM 
BOS_SD_DjrTracking
WHERE 
szDjrTrackingId = p_szDjrTrackingId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_IsFDjrCreated(
p_szDriverId BOS_DT_szId,
p_dtmFromDate timestamp,
p_dtmToDate timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFDjrId

FROM 
BOS_SD_FDjr
WHERE 
bVoid = 0 AND szDriverId = p_szDriverId AND (dtmFDjr >= p_dtmFromDate AND dtmFDjr < p_dtmToDate + 1) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_IsFDjrExist(
p_szFDjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFDjrId

FROM 
BOS_SD_FDjr
WHERE 
szFDjrId = p_szFDjrId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_LockDjrTracking(
p_szDjrTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_DjrTracking
SET 
decValue = decValue
WHERE 
szDjrTrackingId = p_szDjrTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_LockFDjr(
p_szFDjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDjr
SET 
bTransferred = bTransferred
WHERE 
szFDjrId = p_szFDjrId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_MarkDjrTrackingTasked(
p_szDjrTrackingId BOS_DT_szId,
p_dtmNext timestamp,
p_szDriverId BOS_DT_szId,
p_szDocId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_DjrTracking
SET 
bTasked = 1,
bFinished = 0,
dtmNext = p_dtmNext,
szDriverId = p_szDriverId,
szFDjrId = p_szDocId

WHERE 
szDjrTrackingId = p_szDjrTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_MarkDjrTrackingTasked_013(
p_szDjrTrackingId BOS_DT_szId,
p_dtmNext timestamp,
p_szDriverId BOS_DT_szId,
p_szDocId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_DjrTracking
SET 
bTasked = 1,
bFinished = 0,
dtmNext = p_dtmNext,
szDriverId = p_szDriverId,
szFDjrId = p_szDocId

WHERE 
szDjrTrackingId = p_szDjrTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_MarkDjrTrackingUnTasked(
p_szDjrTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_DjrTracking
SET 
bTasked = 0,
szFDjrId = ''

WHERE 
szDjrTrackingId = p_szDjrTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_MarkFDjrVoid(
p_szFDjrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDjr
SET 
bVoid = 1,
bApplied = 0

WHERE 
szFDjrId=p_szFDjrId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_UpdateDjrTracking(
p_szDjrTrackingId BOS_DT_szId,
p_szType BOS_DT_szSmallId,
p_szCustId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szFDjrId BOS_DT_szId,
p_bFinished bit,
p_bSuccess bit,
p_bTasked bit,
p_dtmNext timestamp,
p_btTrialCount smallint,
p_szTeamId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_decValue BOS_DT_decAmount,
p_szFCallId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_bDoNotIncrStockToDeliver smallint,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
-- ### 2 update #####
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_UpdateDjrTracking_013(
p_szDjrTrackingId BOS_DT_szId,
p_szType BOS_DT_szSmallId,
p_szCustId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szFDjrId BOS_DT_szId,
p_bFinished bit,
p_bSuccess bit,
p_bTasked bit,
p_dtmNext timestamp,
p_btTrialCount smallint,
p_szTeamId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_decValue BOS_DT_decAmount,
p_szFCallId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_bDoNotIncrStockToDeliver smallint,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
-- ### 2 update #####
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_UpdateDjrTrackingNextSchedule(
p_szDjrTrackingId BOS_DT_szId,
p_dtmNext timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_DjrTracking
SET 
dtmNext = p_dtmNext

WHERE 
szDjrTrackingId = p_szDjrTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_UpdateDjrTrackingProduct_ByItem(
p_szDjrTrackingId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_DjrTrackingProduct
SET 
szProductId = p_szProductId,
decQty = p_decQty,
szUomId = p_szUomId,
szOrderItemTypeId = p_szOrderItemTypeId
WHERE 
szDjrTrackingId = p_szDjrTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_UpdateFDjr(
p_szFDjrId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szBaseRouteId BOS_DT_szId,
p_dtmFDjr timestamp,
p_szDriverId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_decStartKM BOS_DT_decAmount,
p_decEndKM BOS_DT_decAmount,
p_dtmStartTime timestamp,
p_dtmEndTime timestamp,
p_decVehicleUsageVolume BOS_DT_decAmount,
p_decVehicleUsageWeight BOS_DT_decAmount,
p_szDeliveryGroupId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_szHelperId BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_decRit BOS_DT_decDecimal,
p_decTonase numeric,
p_decCubication numeric)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDjr
SET 
szSalesOrgId = p_szSalesOrgId,
szBaseRouteId = p_szBaseRouteId,
dtmFDjr = p_dtmFDjr,
szDriverId = p_szDriverId,
szVehicleId = p_szVehicleId,
decStartKM = p_decStartKM,
decEndKM = p_decEndKM,
dtmStartTime = p_dtmStartTime,
dtmEndTime = p_dtmEndTime,

decVehicleUsageVolume = p_decVehicleUsageVolume,
decVehicleUsageWeight = p_decVehicleUsageWeight,
szDeliveryGroupId = p_szDeliveryGroupId,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId,

-- Helper 1,2,3 and Rit
szHelperId = p_szHelperId,
szHelperId_2 = p_szHelperId_2,
szHelperId_3 = p_szHelperId_3,
decRit = p_decRit,

-- Weight and Volume
decTonase = p_decTonase,
decCubication = p_decCubication
WHERE 
szFDjrId = p_szFDjrId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_UpdateFDjr_014(
p_szFDjrId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szBaseRouteId BOS_DT_szId,
p_dtmFDjr timestamp,
p_szDriverId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_decStartKM BOS_DT_decAmount,
p_decEndKM BOS_DT_decAmount,
p_dtmStartTime timestamp,
p_dtmEndTime timestamp,
p_decVehicleUsageVolume BOS_DT_decAmount,
p_decVehicleUsageWeight BOS_DT_decAmount,
p_szDeliveryGroupId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_szHelperId BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_decRit BOS_DT_decDecimal,
p_decTonase numeric,
p_decCubication numeric)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDjr
SET 
szSalesOrgId = p_szSalesOrgId,
szBaseRouteId = p_szBaseRouteId,
dtmFDjr = p_dtmFDjr,
szDriverId = p_szDriverId,
szVehicleId = p_szVehicleId,
decStartKM = p_decStartKM,
decEndKM = p_decEndKM,
dtmStartTime = p_dtmStartTime,
dtmEndTime = p_dtmEndTime,

decVehicleUsageVolume = p_decVehicleUsageVolume,
decVehicleUsageWeight = p_decVehicleUsageWeight,
szDeliveryGroupId = p_szDeliveryGroupId,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId,

-- Helper 1,2,3 and Rit
szHelperId = p_szHelperId,
szHelperId_2 = p_szHelperId_2,
szHelperId_3 = p_szHelperId_3,
decRit = p_decRit,

-- Weight and Volume
decTonase = p_decTonase,
decCubication = p_decCubication
WHERE 
szFDjrId = p_szFDjrId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_UpdateFDjrItemReason(
p_szFDjrId BOS_DT_szId,
p_szDjrTrackingId BOS_DT_szId,
p_szReasonId BOS_DT_szId,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDjrItem
SET 
szReasonId = p_szReasonId,
szDescription = p_szDescription
WHERE 
szFDjrID = p_szFDjrId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDjr_UpdateFDjrItemSuccess(
p_szFDjrId BOS_DT_szId,
p_szDjrTrackingId BOS_DT_szId,
p_bSuccess bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDjrItem
SET 
bSuccess = p_bSuccess
WHERE 
szFDjrID = p_szFDjrId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CountUnAppliedFDo(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
count(DISTINCT BOS_SD_FDo.szDoId) as iDoCount

FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId

WHERE
BOS_SD_FDo.bVoid = 0 AND BOS_SD_FDo.bApplied = 0 AND
BOS_SD_FDo.dtmDelivery >= p_dtmFrom AND BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmTo)
--AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId
ELSE
SELECT
count(DISTINCT BOS_SD_FDo.szDoId) as iDoCount

FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId

WHERE
BOS_SD_FDo.bVoid = 0 AND BOS_SD_FDo.bApplied = 0 AND
BOS_SD_FDo.dtmDelivery >= p_dtmFrom AND BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmTo)
AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CountUnAppliedFDo_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
count(DISTINCT BOS_SD_FDo.szDoId) as iDoCount

FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId

WHERE
BOS_SD_FDo.bVoid = 0 AND BOS_SD_FDo.bApplied = 0 AND
BOS_SD_FDo.dtmDelivery >= p_dtmFrom AND BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmTo)
--AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId
ELSE
SELECT
count(DISTINCT BOS_SD_FDo.szDoId) as iDoCount

FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId

WHERE
BOS_SD_FDo.bVoid = 0 AND BOS_SD_FDo.bApplied = 0 AND
BOS_SD_FDo.dtmDelivery >= p_dtmFrom AND BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmTo)
AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CreateFDo(
p_szDoId BOS_DT_szId,
p_szApplyNo BOS_DT_szId,
p_szFSoId BOS_DT_szId,
p_szLogisticType varchar,
p_szFDnId BOS_DT_szId,
p_bReturnToWarehouse smallint,
p_szReturnFDoId BOS_DT_szId,
p_szReturnWarehouseId BOS_DT_szId,
p_szReturnStockTypeId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szOrderTypeId BOS_DT_szId,
p_dtmDelivery timestamp,
p_dtmPrice timestamp,
p_szCustId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_decTax BOS_DT_decTax,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_decCcyRate BOS_DT_decCcyRate,
p_szFInvoiceId BOS_DT_szId,
p_szFirstFInvoiceId BOS_DT_szId,
p_bDropShip bit,
p_bUseThirdPartyCarrier bit,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szHelperId BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_szSalesId BOS_DT_szId,
p_szSalesSupervisorId BOS_DT_szId,
p_szSalesSupervisorId_2 BOS_DT_szId,
p_szSalesSupervisorId_3 BOS_DT_szId,
p_szSalesDivisionId BOS_DT_szId,
p_szSalesDepartmentId BOS_DT_szId,
p_szSalesTeamId BOS_DT_szId,
p_szCarrierId BOS_DT_szId,
p_szVehicleNumber varchar,
p_szDriverName BOS_DT_szName,
p_szRemark BOS_DT_szMessage,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_szCustPoId BOS_DT_szId,
p_dtmCustPo timestamp,
p_szWarehouseId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_bCash bit,
p_gdCreditLimitApprovedId bytea,
p_szPaymentTermId BOS_DT_szId,
p_DeliveryszContactPerson BOS_DT_szName,
p_DeliveryszRoomNo BOS_DT_szSmallName,
p_DeliveryszFloor BOS_DT_szSmallName,
p_DeliveryszBuilding BOS_DT_szName,
p_DeliveryszAddress_1 BOS_DT_szName,
p_DeliveryszAddress_2 BOS_DT_szName,
p_DeliveryszDistrict BOS_DT_szMediumName,
p_DeliveryszCity BOS_DT_szMediumName,
p_DeliveryszZipCode BOS_DT_szSmallName,
p_DeliveryszState BOS_DT_szMediumName,
p_DeliveryszCountry BOS_DT_szMediumName,
p_DeliveryszPhoneNo_1 BOS_DT_szMediumName,
p_DeliveryszPhoneNo_2 BOS_DT_szMediumName,
p_DeliveryszFaxNo BOS_DT_szMediumName,
p_DeliveryszMobileNo BOS_DT_szMediumName,
p_DeliveryszEmail BOS_DT_szMediumName,
p_DeliveryszWebSite BOS_DT_szMediumName,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szManualNo BOS_DT_szId,
p_szFCustBIId BOS_DT_szId,
p_dtmMobileTransaction timestamp,
p_decTonase numeric,
p_decCubication numeric,
p_bUploadedFromMoDis BOS_DT_bBoolean,
p_dtmStartVisit timestamp,
p_dtmEndVisit timestamp,
p_decVisitSpendTime BOS_DT_decAmount,
p_bScanSuccess smallint,
p_szScanFailReason BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDO
(
szDoId,
szApplyNo,
szFSoId,
szLogisticType,
szFDnId,
bReturnToWarehouse,
szReturnFDoId,
szReturnWarehouseId,
szReturnStockTypeId,
szSalesOrgId,
szOrderTypeId,
dtmDelivery,
dtmPrice,
szCustId,
decAmount,
decTax,
szCcyId,
szCcyRateId,
decCcyRate,
szFInvoiceId,
szFirstFInvoiceId,
bDropShip,
bUseThirdPartyCarrier,
szVehicleId,
szDriverId,
szHelperId,
szHelperId_2,
szHelperId_3,
szSalesId,
szSalesSupervisorId,
szSalesSupervisorId_2,
szSalesSupervisorId_3,
szSalesDivisionId,
szSalesDepartmentId,
szSalesTeamId,
szCarrierId,
szVehicleNumber,
szDriverName,
szRemark,
szLatitude,
szLongitude,
szCustPoId,
dtmCustPo,
szWarehouseId,
szStockTypeId,
bCash,
gdCreditLimitApprovedId,
szPaymentTermId,
DeliveryszContactPerson,
DeliveryszRoomNo,
DeliveryszFloor,
DeliveryszBuilding,
DeliveryszAddress_1,
DeliveryszAddress_2,
DeliveryszDistrict,
DeliveryszCity,
DeliveryszZipCode,
DeliveryszState,
DeliveryszCountry,
DeliveryszPhoneNo_1,
DeliveryszPhoneNo_2,
DeliveryszFaxNo,
DeliveryszMobileNo,
DeliveryszEmail,
DeliveryszWebSite,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
szManualNo,
szFCustBIId,
dtmMobileTransaction,
-- Volume and Weight,
decTonase,
decCubication,
bUploadedFromMoDis,
dtmStartVisit	,
dtmEndVisit	,
decVisitSpendTime	,
bScanSuccess	,
szScanFailReason
)
VALUES
(
p_szDoId,
p_szApplyNo,
p_szFSoId,
p_szLogisticType,
p_szFDnId,
p_bReturnToWarehouse,
p_szReturnFDoId,
p_szReturnWarehouseId,
p_szReturnStockTypeId,
p_szSalesOrgId,
p_szOrderTypeId,
p_dtmDelivery,
p_dtmPrice,
p_szCustId,
p_decAmount,
p_decTax,
p_szCcyId,
p_szCcyRateId,
p_decCcyRate,
p_szFInvoiceId,
p_szFirstFInvoiceId,
p_bDropShip,
p_bUseThirdPartyCarrier,
p_szVehicleId,
p_szDriverId,
p_szHelperId,
p_szHelperId_2,
p_szHelperId_3,
p_szSalesId,
p_szSalesSupervisorId,
p_szSalesSupervisorId_2,
p_szSalesSupervisorId_3,
p_szSalesDivisionId,
p_szSalesDepartmentId,
p_szSalesTeamId,
p_szCarrierId,
p_szVehicleNumber,
p_szDriverName,
p_szRemark,
p_szLatitude,
p_szLongitude,
p_szCustPoId,
p_dtmCustPo,
p_szWarehouseId,
p_szStockTypeId,
p_bCash,
p_gdCreditLimitApprovedId,
p_szPaymentTermId,
p_DeliveryszContactPerson,
p_DeliveryszRoomNo,
p_DeliveryszFloor,
p_DeliveryszBuilding,
p_DeliveryszAddress_1,
p_DeliveryszAddress_2,
p_DeliveryszDistrict,
p_DeliveryszCity,
p_DeliveryszZipCode,
p_DeliveryszState,
p_DeliveryszCountry,
p_DeliveryszPhoneNo_1,
p_DeliveryszPhoneNo_2,
p_DeliveryszFaxNo,
p_DeliveryszMobileNo,
p_DeliveryszEmail,
p_DeliveryszWebSite,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szManualNo,
p_szFCustBIId,
p_dtmMobileTransaction,
-- Volume and Weight,
p_decTonase,
p_decCubication,
p_bUploadedFromMoDis ,
p_dtmStartVisit	,
p_dtmEndVisit	,
p_decVisitSpendTime	,
p_bScanSuccess	,
p_szScanFailReason
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CreateFDo_013(
p_szDoId BOS_DT_szId,
p_szApplyNo BOS_DT_szId,
p_szFSoId BOS_DT_szId,
p_szLogisticType varchar,
p_szFDnId BOS_DT_szId,
p_bReturnToWarehouse smallint,
p_szReturnFDoId BOS_DT_szId,
p_szReturnWarehouseId BOS_DT_szId,
p_szReturnStockTypeId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szOrderTypeId BOS_DT_szId,
p_dtmDelivery timestamp,
p_dtmPrice timestamp,
p_szCustId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_decTax BOS_DT_decTax,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_decCcyRate BOS_DT_decCcyRate,
p_szFInvoiceId BOS_DT_szId,
p_szFirstFInvoiceId BOS_DT_szId,
p_bDropShip bit,
p_bUseThirdPartyCarrier bit,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szHelperId BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_szSalesId BOS_DT_szId,
p_szSalesSupervisorId BOS_DT_szId,
p_szSalesSupervisorId_2 BOS_DT_szId,
p_szSalesSupervisorId_3 BOS_DT_szId,
p_szSalesDivisionId BOS_DT_szId,
p_szSalesDepartmentId BOS_DT_szId,
p_szSalesTeamId BOS_DT_szId,
p_szCarrierId BOS_DT_szId,
p_szVehicleNumber varchar,
p_szDriverName BOS_DT_szName,
p_szRemark BOS_DT_szMessage,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_szCustPoId BOS_DT_szId,
p_dtmCustPo timestamp,
p_szWarehouseId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_bCash bit,
p_gdCreditLimitApprovedId bytea,
p_szPaymentTermId BOS_DT_szId,
p_DeliveryszContactPerson BOS_DT_szName,
p_DeliveryszRoomNo BOS_DT_szSmallName,
p_DeliveryszFloor BOS_DT_szSmallName,
p_DeliveryszBuilding BOS_DT_szName,
p_DeliveryszAddress_1 BOS_DT_szBigDescription,
p_DeliveryszAddress_2 BOS_DT_szBigDescription,
p_DeliveryszDistrict BOS_DT_szName,
p_DeliveryszCity BOS_DT_szMediumName,
p_DeliveryszZipCode BOS_DT_szSmallName,
p_DeliveryszState BOS_DT_szMediumName,
p_DeliveryszCountry BOS_DT_szMediumName,
p_DeliveryszPhoneNo_1 BOS_DT_szMediumName,
p_DeliveryszPhoneNo_2 BOS_DT_szMediumName,
p_DeliveryszFaxNo BOS_DT_szMediumName,
p_DeliveryszMobileNo BOS_DT_szMediumName,
p_DeliveryszEmail BOS_DT_szMediumName,
p_DeliveryszWebSite BOS_DT_szMediumName,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szManualNo BOS_DT_szId,
p_szFCustBIId BOS_DT_szId,
p_dtmMobileTransaction timestamp,
p_decTonase numeric,
p_decCubication numeric,
p_bUploadedFromMoDis BOS_DT_bBoolean,
p_dtmStartVisit timestamp,
p_dtmEndVisit timestamp,
p_decVisitSpendTime BOS_DT_decAmount,
p_bScanSuccess smallint,
p_szScanFailReason BOS_DT_szId,
p_szBarcodeScanFailReason BOS_DT_szId,
p_bScanBarcodeSuccess smallint,
p_decJourneySpendTime BOS_DT_decAmount,
p_AdcId BOS_DT_szId,
p_szCustReceiptNo BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDO
(
szDoId,
szApplyNo,
szFSoId,
szLogisticType,
szFDnId,
bReturnToWarehouse,
szReturnFDoId,
szReturnWarehouseId,
szReturnStockTypeId,
szSalesOrgId,
szOrderTypeId,
dtmDelivery,
dtmPrice,
szCustId,
decAmount,
decTax,
szCcyId,
szCcyRateId,
decCcyRate,
szFInvoiceId,
szFirstFInvoiceId,
bDropShip,
bUseThirdPartyCarrier,
szVehicleId,
szDriverId,
szHelperId,
szHelperId_2,
szHelperId_3,
szSalesId,
szSalesSupervisorId,
szSalesSupervisorId_2,
szSalesSupervisorId_3,
szSalesDivisionId,
szSalesDepartmentId,
szSalesTeamId,
szCarrierId,
szVehicleNumber,
szDriverName,
szRemark,
szLatitude,
szLongitude,
szCustPoId,
dtmCustPo,
szWarehouseId,
szStockTypeId,
bCash,
gdCreditLimitApprovedId,
szPaymentTermId,
DeliveryszContactPerson,
DeliveryszRoomNo,
DeliveryszFloor,
DeliveryszBuilding,
DeliveryszAddress_1,
DeliveryszAddress_2,
DeliveryszDistrict,
DeliveryszCity,
DeliveryszZipCode,
DeliveryszState,
DeliveryszCountry,
DeliveryszPhoneNo_1,
DeliveryszPhoneNo_2,
DeliveryszFaxNo,
DeliveryszMobileNo,
DeliveryszEmail,
DeliveryszWebSite,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
szManualNo,
szFCustBIId,
dtmMobileTransaction,
-- Volume and Weight,
decTonase,
decCubication,
bUploadedFromMoDis,
dtmStartVisit ,
dtmEndVisit ,
decVisitSpendTime ,
bScanSuccess ,
szScanFailReason,
szBarcodeScanFailReason,
bScanBarcodeSuccess,
decJourneySpendTime,
AdcId,
szCustReceiptNo
)
VALUES
(
p_szDoId,
p_szApplyNo,
p_szFSoId,
p_szLogisticType,
p_szFDnId,
p_bReturnToWarehouse,
p_szReturnFDoId,
p_szReturnWarehouseId,
p_szReturnStockTypeId,
p_szSalesOrgId,
p_szOrderTypeId,
p_dtmDelivery,
p_dtmPrice,
p_szCustId,
p_decAmount,
p_decTax,
p_szCcyId,
p_szCcyRateId,
p_decCcyRate,
p_szFInvoiceId,
p_szFirstFInvoiceId,
p_bDropShip,
p_bUseThirdPartyCarrier,
p_szVehicleId,
p_szDriverId,
p_szHelperId,
p_szHelperId_2,
p_szHelperId_3,
p_szSalesId,
p_szSalesSupervisorId,
p_szSalesSupervisorId_2,
p_szSalesSupervisorId_3,
p_szSalesDivisionId,
p_szSalesDepartmentId,
p_szSalesTeamId,
p_szCarrierId,
p_szVehicleNumber,
p_szDriverName,
p_szRemark,
p_szLatitude,
p_szLongitude,
p_szCustPoId,
p_dtmCustPo,
p_szWarehouseId,
p_szStockTypeId,
p_bCash,
p_gdCreditLimitApprovedId,
p_szPaymentTermId,
p_DeliveryszContactPerson,
p_DeliveryszRoomNo,
p_DeliveryszFloor,
p_DeliveryszBuilding,
p_DeliveryszAddress_1,
p_DeliveryszAddress_2,
p_DeliveryszDistrict,
p_DeliveryszCity,
p_DeliveryszZipCode,
p_DeliveryszState,
p_DeliveryszCountry,
p_DeliveryszPhoneNo_1,
p_DeliveryszPhoneNo_2,
p_DeliveryszFaxNo,
p_DeliveryszMobileNo,
p_DeliveryszEmail,
p_DeliveryszWebSite,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szManualNo,
p_szFCustBIId,
p_dtmMobileTransaction,
-- Volume and Weight,
p_decTonase,
p_decCubication,
p_bUploadedFromMoDis ,
p_dtmStartVisit ,
p_dtmEndVisit ,
p_decVisitSpendTime ,
p_bScanSuccess ,
p_szScanFailReason,
p_szBarcodeScanFailReason,
p_bScanBarcodeSuccess,
p_decJourneySpendTime,
p_AdcId,
p_szCustReceiptNo,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CreateFDo_015(
p_szDoId BOS_DT_szId,
p_szApplyNo BOS_DT_szId,
p_szFSoId BOS_DT_szId,
p_szLogisticType varchar,
p_szFDnId BOS_DT_szId,
p_bReturnToWarehouse smallint,
p_szReturnFDoId BOS_DT_szId,
p_szReturnWarehouseId BOS_DT_szId,
p_szReturnStockTypeId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szOrderTypeId BOS_DT_szId,
p_dtmDelivery timestamp,
p_dtmPrice timestamp,
p_szCustId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_decTax BOS_DT_decTax,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_decCcyRate BOS_DT_decCcyRate,
p_szFInvoiceId BOS_DT_szId,
p_szFirstFInvoiceId BOS_DT_szId,
p_bDropShip bit,
p_bUseThirdPartyCarrier bit,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szHelperId BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_szSalesId BOS_DT_szId,
p_szSalesSupervisorId BOS_DT_szId,
p_szSalesSupervisorId_2 BOS_DT_szId,
p_szSalesSupervisorId_3 BOS_DT_szId,
p_szSalesDivisionId BOS_DT_szId,
p_szSalesDepartmentId BOS_DT_szId,
p_szSalesTeamId BOS_DT_szId,
p_szCarrierId BOS_DT_szId,
p_szVehicleNumber varchar,
p_szDriverName BOS_DT_szName,
p_szRemark BOS_DT_szMessage,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_szCustPoId BOS_DT_szId,
p_dtmCustPo timestamp,
p_szWarehouseId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_bCash bit,
p_gdCreditLimitApprovedId bytea,
p_szPaymentTermId BOS_DT_szId,
p_DeliveryszContactPerson BOS_DT_szName,
p_DeliveryszRoomNo BOS_DT_szSmallName,
p_DeliveryszFloor BOS_DT_szSmallName,
p_DeliveryszBuilding BOS_DT_szName,
p_DeliveryszAddress_1 BOS_DT_szBigDescription,
p_DeliveryszAddress_2 BOS_DT_szBigDescription,
p_DeliveryszDistrict BOS_DT_szName,
p_DeliveryszCity BOS_DT_szMediumName,
p_DeliveryszZipCode BOS_DT_szSmallName,
p_DeliveryszState BOS_DT_szMediumName,
p_DeliveryszCountry BOS_DT_szMediumName,
p_DeliveryszPhoneNo_1 BOS_DT_szMediumName,
p_DeliveryszPhoneNo_2 BOS_DT_szMediumName,
p_DeliveryszFaxNo BOS_DT_szMediumName,
p_DeliveryszMobileNo BOS_DT_szMediumName,
p_DeliveryszEmail BOS_DT_szMediumName,
p_DeliveryszWebSite BOS_DT_szMediumName,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szManualNo BOS_DT_szId,
p_szFCustBIId BOS_DT_szId,
p_dtmMobileTransaction timestamp,
p_decTonase numeric,
p_decCubication numeric,
p_bUploadedFromMoDis BOS_DT_bBoolean,
p_dtmStartVisit timestamp,
p_dtmEndVisit timestamp,
p_decVisitSpendTime BOS_DT_decAmount,
p_bScanSuccess smallint,
p_szScanFailReason BOS_DT_szId,
p_szBarcodeScanFailReason BOS_DT_szId,
p_bScanBarcodeSuccess smallint,
p_decJourneySpendTime BOS_DT_decAmount,
p_AdcId BOS_DT_szId,
p_szCustReceiptNo BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDO
(
szDoId,
szApplyNo,
szFSoId,
szLogisticType,
szFDnId,
bReturnToWarehouse,
szReturnFDoId,
szReturnWarehouseId,
szReturnStockTypeId,
szSalesOrgId,
szOrderTypeId,
dtmDelivery,
dtmPrice,
szCustId,
decAmount,
decTax,
szCcyId,
szCcyRateId,
decCcyRate,
szFInvoiceId,
szFirstFInvoiceId,
bDropShip,
bUseThirdPartyCarrier,
szVehicleId,
szDriverId,
szHelperId,
szHelperId_2,
szHelperId_3,
szSalesId,
szSalesSupervisorId,
szSalesSupervisorId_2,
szSalesSupervisorId_3,
szSalesDivisionId,
szSalesDepartmentId,
szSalesTeamId,
szCarrierId,
szVehicleNumber,
szDriverName,
szRemark,
szLatitude,
szLongitude,
szCustPoId,
dtmCustPo,
szWarehouseId,
szStockTypeId,
bCash,
gdCreditLimitApprovedId,
szPaymentTermId,
DeliveryszContactPerson,
DeliveryszRoomNo,
DeliveryszFloor,
DeliveryszBuilding,
DeliveryszAddress_1,
DeliveryszAddress_2,
DeliveryszDistrict,
DeliveryszCity,
DeliveryszZipCode,
DeliveryszState,
DeliveryszCountry,
DeliveryszPhoneNo_1,
DeliveryszPhoneNo_2,
DeliveryszFaxNo,
DeliveryszMobileNo,
DeliveryszEmail,
DeliveryszWebSite,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
szManualNo,
szFCustBIId,
dtmMobileTransaction,
-- Volume and Weight,
decTonase,
decCubication,
bUploadedFromMoDis,
dtmStartVisit ,
dtmEndVisit ,
decVisitSpendTime ,
bScanSuccess ,
szScanFailReason,
szBarcodeScanFailReason,
bScanBarcodeSuccess,
decJourneySpendTime,
AdcId,
szCustReceiptNo
)
VALUES
(
p_szDoId,
p_szApplyNo,
p_szFSoId,
p_szLogisticType,
p_szFDnId,
p_bReturnToWarehouse,
p_szReturnFDoId,
p_szReturnWarehouseId,
p_szReturnStockTypeId,
p_szSalesOrgId,
p_szOrderTypeId,
p_dtmDelivery,
p_dtmPrice,
p_szCustId,
p_decAmount,
p_decTax,
p_szCcyId,
p_szCcyRateId,
p_decCcyRate,
p_szFInvoiceId,
p_szFirstFInvoiceId,
p_bDropShip,
p_bUseThirdPartyCarrier,
p_szVehicleId,
p_szDriverId,
p_szHelperId,
p_szHelperId_2,
p_szHelperId_3,
p_szSalesId,
p_szSalesSupervisorId,
p_szSalesSupervisorId_2,
p_szSalesSupervisorId_3,
p_szSalesDivisionId,
p_szSalesDepartmentId,
p_szSalesTeamId,
p_szCarrierId,
p_szVehicleNumber,
p_szDriverName,
p_szRemark,
p_szLatitude,
p_szLongitude,
p_szCustPoId,
p_dtmCustPo,
p_szWarehouseId,
p_szStockTypeId,
p_bCash,
p_gdCreditLimitApprovedId,
p_szPaymentTermId,
p_DeliveryszContactPerson,
p_DeliveryszRoomNo,
p_DeliveryszFloor,
p_DeliveryszBuilding,
p_DeliveryszAddress_1,
p_DeliveryszAddress_2,
p_DeliveryszDistrict,
p_DeliveryszCity,
p_DeliveryszZipCode,
p_DeliveryszState,
p_DeliveryszCountry,
p_DeliveryszPhoneNo_1,
p_DeliveryszPhoneNo_2,
p_DeliveryszFaxNo,
p_DeliveryszMobileNo,
p_DeliveryszEmail,
p_DeliveryszWebSite,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szManualNo,
p_szFCustBIId,
p_dtmMobileTransaction,
-- Volume and Weight,
p_decTonase,
p_decCubication,
p_bUploadedFromMoDis ,
p_dtmStartVisit ,
p_dtmEndVisit ,
p_decVisitSpendTime ,
p_bScanSuccess ,
p_szScanFailReason,
p_szBarcodeScanFailReason,
p_bScanBarcodeSuccess,
p_decJourneySpendTime,
p_AdcId,
p_szCustReceiptNo,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CreateFDoItem(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_dtmPriceDate timestamp,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_decCOGS BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId,
p_decTonase numeric,
p_decCubication numeric,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDOItem
(
szDoId,
shItemNumber,
szOrderItemTypeId,
szProductId,
szPriceId,
szPriceOrderId,
decDiscProcent,
dtmPriceDate,
decQty,
decUomQty,
decCOGS,
szUomId,
decPrice,
decDiscount,
bTaxable,
decTax,
decAmount,
decDPP,
szPaymentType,
szPrincipalDiscRefId,
-- for Cubication and Tonase,
decTonase,
decCubication,
szParentId
)
VALUES
(
p_szDoId,
p_shItemNumber,
p_szOrderItemTypeId,
p_szProductId,
p_szPriceId,
p_szPriceOrderId,
p_decDiscProcent,
p_dtmPriceDate,
p_decQty,
p_decUomQty,
p_decCOGS,
p_szUomId,
p_decPrice,
p_decDiscount,
p_bTaxable,
p_decTax,
p_decAmount,
p_decDPP,
p_szPaymentType,
p_szPrincipalDiscRefId,
-- for Cubication and Tonase,
p_decTonase,
p_decCubication,
p_szParentId,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CreateFDoItem_013(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_dtmPriceDate timestamp,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_decCOGS BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId,
p_decTonase numeric,
p_decCubication numeric,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDOItem
(
szDoId,
shItemNumber,
szOrderItemTypeId,
szProductId,
szPriceId,
szPriceOrderId,
decDiscProcent,
dtmPriceDate,
decQty,
decUomQty,
decCOGS,
szUomId,
decPrice,
decDiscount,
bTaxable,
decTax,
decAmount,
decDPP,
szPaymentType,
szPrincipalDiscRefId,
-- for Cubication and Tonase,
decTonase,
decCubication,
szParentId
)
VALUES
(
p_szDoId,
p_shItemNumber,
p_szOrderItemTypeId,
p_szProductId,
p_szPriceId,
p_szPriceOrderId,
p_decDiscProcent,
p_dtmPriceDate,
p_decQty,
p_decUomQty,
p_decCOGS,
p_szUomId,
p_decPrice,
p_decDiscount,
p_bTaxable,
p_decTax,
p_decAmount,
p_decDPP,
p_szPaymentType,
p_szPrincipalDiscRefId,
-- for Cubication and Tonase,
p_decTonase,
p_decCubication,
p_szParentId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CreateFDoItem_014(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_dtmPriceDate timestamp,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_decCOGS BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId,
p_decTonase numeric,
p_decCubication numeric,
p_szParentId BOS_DT_szId,
p_szDistProductId BOS_DT_szId,
p_decDistQty BOS_DT_decAmount,
p_decDistPrice BOS_DT_decPrice)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDOItem
(
szDoId,
shItemNumber,
szOrderItemTypeId,
szProductId,
szPriceId,
szPriceOrderId,
decDiscProcent,
dtmPriceDate,
decQty,
decUomQty,
decCOGS,
szUomId,
decPrice,
decDiscount,
bTaxable,
decTax,
decAmount,
decDPP,
szPaymentType,
szPrincipalDiscRefId,
-- for Cubication and Tonase,
decTonase,
decCubication,
szParentId,
szDistProductId,
decDistQty,
decDistPrice
)
VALUES
(
p_szDoId,
p_shItemNumber,
p_szOrderItemTypeId,
p_szProductId,
p_szPriceId,
p_szPriceOrderId,
p_decDiscProcent,
p_dtmPriceDate,
p_decQty,
p_decUomQty,
p_decCOGS,
p_szUomId,
p_decPrice,
p_decDiscount,
p_bTaxable,
p_decTax,
p_decAmount,
p_decDPP,
p_szPaymentType,
p_szPrincipalDiscRefId,
-- for Cubication and Tonase,
p_decTonase,
p_decCubication,
p_szParentId,
p_szDistProductId,
p_decDistQty,
p_decDistPrice,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CreateFDoItem_015(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_dtmPriceDate timestamp,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_decCOGS BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId,
p_decTonase numeric,
p_decCubication numeric,
p_szParentId BOS_DT_szId,
p_szDistProductId BOS_DT_szId,
p_decDistQty BOS_DT_decAmount,
p_decDistPrice BOS_DT_decPrice,
p_szBudgetId BOS_DT_szId,
p_decPrincipalCostAmount BOS_DT_decAmount,
p_decPrincipalCostQty BOS_DT_decAmount,
p_bBudgetTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDOItem
(
szDoId,
shItemNumber,
szOrderItemTypeId,
szProductId,
szPriceId,
szPriceOrderId,
decDiscProcent,
dtmPriceDate,
decQty,
decUomQty,
decCOGS,
szUomId,
decPrice,
decDiscount,
bTaxable,
decTax,
decAmount,
decDPP,
szPaymentType,
szPrincipalDiscRefId,
-- for Cubication and Tonase,
decTonase,
decCubication,
szParentId,
szDistProductId,
decDistQty,
decDistPrice,
szBudgetId,
decPrincipalCostAmount,
decPrincipalCostQty,
bBudgetTransferred
)
VALUES
(
p_szDoId,
p_shItemNumber,
p_szOrderItemTypeId,
p_szProductId,
p_szPriceId,
p_szPriceOrderId,
p_decDiscProcent,
p_dtmPriceDate,
p_decQty,
p_decUomQty,
p_decCOGS,
p_szUomId,
p_decPrice,
p_decDiscount,
p_bTaxable,
p_decTax,
p_decAmount,
p_decDPP,
p_szPaymentType,
p_szPrincipalDiscRefId,
-- for Cubication and Tonase,
p_decTonase,
p_decCubication,
p_szParentId,
p_szDistProductId,
p_decDistQty,
p_decDistPrice,
p_szBudgetId,
p_decPrincipalCostAmount,
p_decPrincipalCostQty,
p_bBudgetTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CreateFDoItemBonusSource(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_decBonusAmount BOS_DT_decAmount,
p_decBonusQty BOS_DT_decAmount,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDOItemBonusSource
(
szFDoId,
shItemNumber,
szProductId,
szOrderItemTypeId,
szPaymentType,
decBonusAmount,
decBonusQty,
szParentId
)
VALUES
(
p_szFDoId,
p_shItemNumber,
p_szProductId,
p_szOrderItemTypeId,
p_szPaymentType,
p_decBonusAmount,
p_decBonusQty,
p_szParentId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CreateFDoItemBonusSource_013(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_decBonusAmount BOS_DT_decAmount,
p_decBonusQty BOS_DT_decAmount,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDOItemBonusSource
(
  ,
szFDoId  ,
shItemNumber  ,
szProductId  ,
szOrderItemTypeId  ,
szPaymentType  ,
decBonusAmount  ,
decBonusQty  ,
szParentId  
  ,
)
VALUES
(
p_szFDoId,
p_shItemNumber,
p_szProductId,
p_szOrderItemTypeId,
p_szPaymentType,
p_decBonusAmount,
p_decBonusQty,
p_szParentId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CreateFDoItemLotQty(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szLotId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDoItemLotQty
(
szFDoId,
shItemNumber,
szLotId,
decQty
)
VALUES
(
p_szFDoId,
p_shItemNumber,
p_szLotId,
p_decQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CreateFDoItemLotQty_013(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szLotId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDoItemLotQty
(
szFDoId,
shItemNumber,
szLotId,
decQty
)
VALUES
(
p_szFDoId,
p_shItemNumber,
p_szLotId,
p_decQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CreateFDoItemSN(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint,
p_shItemSnNumber smallint,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDOItemSN
(
szDoId,
shItemNumber,
shItemSnNumber,
szProductSN
)
VALUES
(
p_szDoId,
p_shItemNumber,
p_shItemSnNumber,
p_szProductSN
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CreateFDoItemSN_013(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint,
p_shItemSnNumber smallint,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDOItemSN
(
szDoId,
shItemNumber,
shItemSnNumber,
szProductSN
)
VALUES
(
p_szDoId,
p_shItemNumber,
p_shItemSnNumber,
p_szProductSN
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CreateFDoProductDepositBonusItem(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szOrderItemTypeId BOS_DT_szId,
p_bGenByTotal smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDOProductDepositBonusItem
(
szDoId,
shItemNumber,
szProductId,
decQty,
szUomId,
szOrderItemTypeId,
bGenByTotal
)
VALUES
(
p_szDoId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_szOrderItemTypeId,
p_bGenByTotal
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CreateFDoProductDepositBonusItem_013(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szOrderItemTypeId BOS_DT_szId,
p_bGenByTotal smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDOProductDepositBonusItem
(
  ,
szDoId  ,
shItemNumber  ,
szProductId  ,
decQty  ,
szUomId  ,
szOrderItemTypeId  ,
bGenByTotal  
  ,
)
VALUES
(
p_szDoId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_szOrderItemTypeId,
p_bGenByTotal
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CreateFDoProductDepositBonusItemBonusSource(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_decBonusAmount BOS_DT_decAmount,
p_decBonusQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDoProductDepositBonusItemBonusSource
(
szFDoId,
shItemNumber,
szProductId,
szOrderItemTypeId,
szPaymentType,
decBonusAmount,
decBonusQty
)
VALUES
(
p_szFDoId,
p_shItemNumber,
p_szProductId,
p_szOrderItemTypeId,
p_szPaymentType,
p_decBonusAmount,
p_decBonusQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_CreateFDoProductDepositBonusItemBonusSource_013(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_decBonusAmount BOS_DT_decAmount,
p_decBonusQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDoProductDepositBonusItemBonusSource
(
  ,
szFDoId  ,
shItemNumber  ,
szProductId  ,
szOrderItemTypeId  ,
szPaymentType  ,
decBonusAmount  ,
decBonusQty  
  ,
)
VALUES
(
p_szFDoId,
p_shItemNumber,
p_szProductId,
p_szOrderItemTypeId,
p_szPaymentType,
p_decBonusAmount,
p_decBonusQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDo(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDo_013(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoItem(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_SD_FDOItem
WHERE
szDoId = p_szDoId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoItem_013(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_SD_FDOItem
WHERE
szDoId = p_szDoId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoItem_ByItem(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FDOItem
WHERE
szDoId = p_szDoIdAND shItemNumber = p_shItemNumber;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoItem_ByItem_013(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FDOItem
WHERE
szDoId = p_szDoIdAND shItemNumber = p_shItemNumber;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoItemBonusSource(
p_szFDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_SD_FDoItemBonusSource
WHERE
szFDoId = p_szFDoId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoItemBonusSource_013(
p_szFDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_SD_FDoItemBonusSource
WHERE
szFDoId = p_szFDoId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoItemBonusSource_ByItem(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FDoItemBonusSource
WHERE
szFDoId = p_szFDoIdAND shItemNumber = p_shItemNumberAND szProductId = p_szProductIdAND szOrderItemTypeId = p_szOrderItemTypeIdAND szPaymentType = p_szPaymentTypeAND szParentId = p_szParentId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoItemBonusSource_ByItem_013(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FDoItemBonusSource
WHERE
szFDoId = p_szFDoIdAND shItemNumber = p_shItemNumberAND szProductId = p_szProductIdAND szOrderItemTypeId = p_szOrderItemTypeIdAND szPaymentType = p_szPaymentTypeAND szParentId = p_szParentId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoItemLotQty(
p_szFDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_SD_FDoItemLotQty
WHERE
szFDoId = p_szFDoId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoItemLotQty_013(
p_szFDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_SD_FDoItemLotQty
WHERE
szFDoId = p_szFDoId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoItemLotQty_ByItem(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szLotId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FDoItemLotQty
WHERE
szFDoId = p_szFDoIdAND shItemNumber = p_shItemNumberAND szLotId = p_szLotId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoItemLotQty_ByItem_013(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szLotId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FDoItemLotQty
WHERE
szFDoId = p_szFDoIdAND shItemNumber = p_shItemNumberAND szLotId = p_szLotId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoItemSN(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoItemSN_013(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoItemSN_ByItem(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint,
p_shItemSnNumber smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FDOItemSN
WHERE
szDoId = p_szDoIdAND shItemNumber = p_shItemNumberAND shItemSnNumber = p_shItemSnNumber;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoItemSN_ByItem_013(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint,
p_shItemSnNumber smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FDOItemSN
WHERE
szDoId = p_szDoIdAND shItemNumber = p_shItemNumberAND shItemSnNumber = p_shItemSnNumber;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoProductDepositBonusItem(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SD_FDOProductDepositBonusItem
WHERE
szDoId = p_szDoId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoProductDepositBonusItem_013(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SD_FDOProductDepositBonusItem
WHERE
szDoId = p_szDoId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoProductDepositBonusItemBonusSource(
p_szFDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_DeleteFDoProductDepositBonusItemBonusSource_013(
p_szFDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetFDo(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_SD_FDo.szDoId,  
BOS_SD_FDo.szApplyNo,  
BOS_SD_FDo.szFSoId,  

BOS_SD_FDo.szLogisticType,  
BOS_SD_FDo.szFDnId,  

BOS_SD_FDo.bReturnToWarehouse,  
BOS_SD_FDo.szReturnFDoId,  
BOS_SD_FDo.szReturnWarehouseId,  
BOS_SD_FDo.szReturnStockTypeId,  

BOS_SD_FDo.szSalesOrgId,  

BOS_SD_FDo.szOrderTypeId,  
BOS_INV_OrderType.bAllowManualPrice AS bOrderTypeAllowManualPrice_J,  
BOS_INV_OrderType.bAllowToChangeLinePriceDate AS bOrderTypeAllowToChangeLinePriceDate_J,  

BOS_SD_FDo.dtmDelivery,  
BOS_SD_FDo.dtmPrice,  

BOS_SD_FDo.szCustId,  
BOS_AR_Customer.szName as szCustNm_J,  
CustSales.bAllowToCredit AS bCustAllowToCredit_J,  

BOS_SD_FDo.decAmount,  
BOS_SD_FDo.decTax,  

BOS_SD_FDo.szCcyId,  
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat_J,  

BOS_SD_FDo.szCcyRateId,  
BOS_SD_FDo.decCcyRate,  
BOS_SD_FDo.szFInvoiceId,  
BOS_SD_FDo.szFirstFInvoiceId,  
BOS_SD_FDo.bDropShip,  
BOS_SD_FDo.bUseThirdPartyCarrier,  

BOS_SD_FDo.szVehicleId,  
BOS_SD_FDo.szVehicleNumber,  

BOS_SD_FDo.szDriverId,  
BOS_SD_FDo.szDriverName,  

BOS_SD_FDo.szHelperId,  
Helper1.szName as szHelperNm,  

BOS_SD_FDo.szHelperId_2,  
Helper2.szName as szHelperNm_2,  

BOS_SD_FDo.szHelperId_3,  
Helper3.szName as szHelperNm_3,  

BOS_SD_FDo.szSalesId,  
Sales.szName AS szSalesNm_J,  

BOS_SD_FDo.szSalesSupervisorId,  
BOS_SD_FDo.szSalesSupervisorId_2,  
BOS_SD_FDo.szSalesSupervisorId_3,  
BOS_SD_FDo.szSalesDivisionId,  
BOS_SD_FDo.szSalesDepartmentId,  
BOS_SD_FDo.szSalesTeamId,  

BOS_SD_FDo.szCarrierId,  
BOS_INV_Carrier.szName as szCarrierNm,  

BOS_SD_FDo.szRemark,  
BOS_SD_FDo.szLatitude,  
BOS_SD_FDo.szLongitude,  

BOS_SD_FDo.szCustPoId,  
BOS_SD_FDo.dtmCustPo,  

BOS_SD_FDo.szWarehouseId,  
BOS_INV_Warehouse.szName as szWarehouseNm,  

BOS_SD_FDo.szStockTypeId,  
BOS_SD_FDo.bCash,  

BOS_SD_FDo.gdCreditLimitApprovedId,  
CreditLimitApproved.szApprovalId AS szCreditLimitApprovalId_J,  
CreditLimitApproved.bApproved AS bCreditLimitApproved_J,  

BOS_SD_DjrTracking.szDjrTrackingId as szDjrTrackingId_J,  
BOS_SD_DjrTracking.szFDjrId AS szDjrTrackingFDjrId_J,  

BOS_SD_FDo.szPaymentTermId,  

BOS_SD_FDo.DeliveryszContactPerson,  
BOS_SD_FDo.DeliveryszRoomNo,  
BOS_SD_FDo.DeliveryszFloor,  
BOS_SD_FDo.DeliveryszBuilding,  
BOS_SD_FDo.DeliveryszAddress_1,  
BOS_SD_FDo.DeliveryszAddress_2,  
BOS_SD_FDo.DeliveryszDistrict,  
BOS_SD_FDo.DeliveryszCity,  
BOS_SD_FDo.DeliveryszZipCode,  
BOS_SD_FDo.DeliveryszState,  
BOS_SD_FDo.DeliveryszCountry,  
BOS_SD_FDo.DeliveryszPhoneNo_1,  
BOS_SD_FDo.DeliveryszPhoneNo_2,  
BOS_SD_FDo.DeliveryszFaxNo,  
BOS_SD_FDo.DeliveryszMobileNo,  
BOS_SD_FDo.DeliveryszEmail,  
BOS_SD_FDo.DeliveryszWebSite,  

--Customer's collection info  
BSR.szRouteId AS szCollRouteId,  
BSR.szDescription AS szCollRouteDescription,  
BSR.szOpUserId AS szCollectorId,  
BPE.szName AS szCollectorNm,  

BOS_SD_FDo.bResultFrTransfer,  
BOS_SD_FDo.bVoid,  
BOS_GEN_Approved.bApproved,  
BOS_SD_FDo.bApplied,  
BOS_GL_FJournalTrans.szFJournalId as bJournal,  
BOS_GL_FJournalTrans.bPosted,  
BOS_SD_FDo.btPrintedCount,  
BOS_SD_FDo.bTransferred,  

BOS_SD_FDo.szCompanyId,  
BOS_GL_Company.szName as szCompanyNm,  

BOS_SD_FDo.szWorkplaceId,  
BOS_GL_Workplace.szName as szWorkplaceNm,  

BOS_SD_FDo.szTaxEntityId,  

BOS_SD_FDo.bNeedApproval,  
BOS_GEN_Approved.gdApprovedId,  
BOS_GEN_Approved.szApprovalId,  

BOS_GL_FJournalTrans.szFJournalId,  

BOS_SD_FDo.dtmCreated,  
BOS_SD_FDo.bSystemCreated,  

BOS_SD_FDo.szUserId,  
BOS_SM_User.szName AS szUserNm_J,  

-- Data Status.  
BOS_SD_FDo.dtmLastUpdated,  
BOS_SD_FDo.bAlreadyTransferred,  
BOS_SD_FDo.szManualNo,  
BOS_SD_FDo.szFCustBIId,  
BOS_SD_FDo.dtmMobileTransaction,  

-- Weight and Volume  
BOS_SD_FDo.decTonase,  
BOS_SD_FDo.decCubication,  
BOS_SD_FDo.bUploadedFromMoDis,  
BOS_SD_FDo.dtmStartVisit,	
BOS_SD_FDo.dtmEndVisit,	
BOS_SD_FDo.decVisitSpendTime,	
BOS_SD_FDo.bScanSuccess,	
BOS_SD_FDo.szScanFailReason	 
FROM  
BOS_SD_FDo   
LEFT JOIN BOS_GEN_Approved AS CreditLimitApproved ON CreditLimitApproved.gdApprovedId = BOS_SD_FDo.gdCreditLimitApprovedId  
LEFT JOIN BOS_GEN_Approved ON BOS_SD_FDo.gdApprovedId = BOS_GEN_Approved.gdApprovedId  
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FDo.szFJournalId = BOS_GL_FJournalTrans.szFJournalId  
LEFT JOIN BOS_PI_Employee as Helper1 ON BOS_SD_FDo.szHelperId = Helper1.szEmployeeId  
LEFT JOIN BOS_PI_Employee as Helper2 ON BOS_SD_FDo.szHelperId_2 = Helper2.szEmployeeId  
LEFT JOIN BOS_PI_Employee as Helper3 ON BOS_SD_FDo.szHelperId_3 = Helper3.szEmployeeId  

LEFT JOIN BOS_PI_Employee as Sales ON Sales.szEmployeeId = BOS_SD_FDo.szSalesId  

--  These join fields are not really needed. But to retrieve them makes  
--  to do join to six different tables.  
--  So just de-activate it temporarily and activate it when it is absolutely  
--  necessary (and the processing power has increased).  
--LEFT JOIN BOS_PI_Employee as Sup ON Sup.szEmployeeId = BOS_SD_FDo.szSalesSupervisorId  
--LEFT JOIN BOS_PI_Employee as Sup2 ON Sup2.szEmployeeId = BOS_SD_FDo.szSalesSupervisorId_2  
--LEFT JOIN BOS_PI_Employee as Sup3 ON Sup3.szEmployeeId = BOS_SD_FDo.szSalesSupervisorId_3  
--LEFT JOIN BOS_PI_Division as Div ON Div.szDivisionId = BOS_SD_FDo.szSalesDivisionId  
--LEFT JOIN BOS_PI_Department as Dep ON Dep.szDepartmentId = BOS_SD_FDo.szSalesDepartmentId  
--LEFT JOIN BOS_PI_Team as Tea ON Tea.szTeamId = BOS_SD_FDo.szSalesTeamId  

LEFT JOIN BOS_AR_Customer ON BOS_SD_FDo.szCustId = BOS_AR_Customer.szCustId  

LEFT JOIN BOS_SD_DjrTracking ON BOS_SD_DjrTracking.szFDoId = BOS_SD_FDo.szDoId  
LEFT JOIN BOS_INV_Carrier ON BOS_INV_Carrier.szCarrierId = BOS_SD_FDo.szCarrierId  

LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FDo.szCompanyId  
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId  
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FDo.szUserId  

LEFT JOIN BOS_INV_Warehouse ON BOS_INV_Warehouse.szWarehouseId = BOS_SD_FDo.szWarehouseId  

LEFT JOIN BOS_AR_Customer AS InvCust ON InvCust.szCustId = BOS_AR_Customer.szInvoiceToCustId  

--Allow to credit is based on original customer, not from invoice-to customer.  
LEFT JOIN BOS_AR_CustSales AS CustSales ON CustSales.szCustId = BOS_AR_Customer.szCustId  

LEFT JOIN BOS_AR_Customer AS CollCust ON CollCust.szCustId = InvCust.szCollectToCustId  
LEFT JOIN BOS_SD_CustCollRoutine AS BSCCR ON BSCCR.szCustId = CollCust.szCustId  
LEFT JOIN BOS_SD_Route AS BSR ON BSR.szRouteId = BSCCR.szDefaultRouteId  
LEFT JOIN BOS_PI_Employee AS BPE ON BPE.szEmployeeId = BSR.szOpUserId  
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FDo.szCcyId  

LEFT JOIN BOS_INV_OrderType ON BOS_INV_OrderType.szOrderTypeId = BOS_SD_FDo.szOrderTypeId  

WHERE  
BOS_SD_FDo.szDoId = p_szDoId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetFDo_013(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT      
BOS_SD_FDo.szDoId,      
BOS_SD_FDo.szApplyNo,      
BOS_SD_FDo.szFSoId,      

BOS_SD_FDo.szLogisticType,      
BOS_SD_FDo.szFDnId,      

BOS_SD_FDo.bReturnToWarehouse,      
BOS_SD_FDo.szReturnFDoId,      
BOS_SD_FDo.szReturnWarehouseId,      
BOS_SD_FDo.szReturnStockTypeId,      

BOS_SD_FDo.szSalesOrgId,      

BOS_SD_FDo.szOrderTypeId,      
BOS_INV_OrderType.bAllowManualPrice AS bOrderTypeAllowManualPrice_J,      
BOS_INV_OrderType.bAllowToChangeLinePriceDate AS bOrderTypeAllowToChangeLinePriceDate_J,      

BOS_SD_FDo.dtmDelivery,      
BOS_SD_FDo.dtmPrice,      

BOS_SD_FDo.szCustId,      
BOS_AR_Customer.szName as szCustNm_J,      
CustSales.bAllowToCredit AS bCustAllowToCredit_J,      

BOS_SD_FDo.decAmount,      
BOS_SD_FDo.decTax,      

BOS_SD_FDo.szCcyId,      
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat_J,      

BOS_SD_FDo.szCcyRateId,      
BOS_SD_FDo.decCcyRate,      
BOS_SD_FDo.szFInvoiceId,      
BOS_SD_FDo.szFirstFInvoiceId,      
BOS_SD_FDo.bDropShip,      
BOS_SD_FDo.bUseThirdPartyCarrier,      

BOS_SD_FDo.szVehicleId,      
BOS_SD_FDo.szVehicleNumber,      

BOS_SD_FDo.szDriverId,      
BOS_SD_FDo.szDriverName,      

BOS_SD_FDo.szHelperId,      
Helper1.szName as szHelperNm,      

BOS_SD_FDo.szHelperId_2,      
Helper2.szName as szHelperNm_2,      

BOS_SD_FDo.szHelperId_3,      
Helper3.szName as szHelperNm_3,      

BOS_SD_FDo.szSalesId,      
Sales.szName AS szSalesNm_J,      

BOS_SD_FDo.szSalesSupervisorId,      
BOS_SD_FDo.szSalesSupervisorId_2,      
BOS_SD_FDo.szSalesSupervisorId_3,      
BOS_SD_FDo.szSalesDivisionId,      
BOS_SD_FDo.szSalesDepartmentId,      
BOS_SD_FDo.szSalesTeamId,      

BOS_SD_FDo.szCarrierId,      
BOS_INV_Carrier.szName as szCarrierNm,      

BOS_SD_FDo.szRemark,      
BOS_SD_FDo.szLatitude,      
BOS_SD_FDo.szLongitude,      

BOS_SD_FDo.szCustPoId,      
BOS_SD_FDo.dtmCustPo,      

BOS_SD_FDo.szWarehouseId,      
BOS_INV_Warehouse.szName as szWarehouseNm,      

BOS_SD_FDo.szStockTypeId,      
BOS_SD_FDo.bCash,      

BOS_SD_FDo.gdCreditLimitApprovedId,      
CreditLimitApproved.szApprovalId AS szCreditLimitApprovalId_J,      
CreditLimitApproved.bApproved AS bCreditLimitApproved_J,      

BOS_SD_DjrTracking.szDjrTrackingId as szDjrTrackingId_J,      
BOS_SD_DjrTracking.szFDjrId AS szDjrTrackingFDjrId_J,      

BOS_SD_FDo.szPaymentTermId,      

BOS_SD_FDo.DeliveryszContactPerson,      
BOS_SD_FDo.DeliveryszRoomNo,      
BOS_SD_FDo.DeliveryszFloor,      
BOS_SD_FDo.DeliveryszBuilding,      
BOS_SD_FDo.DeliveryszAddress_1,      
BOS_SD_FDo.DeliveryszAddress_2,      
BOS_SD_FDo.DeliveryszDistrict,      
BOS_SD_FDo.DeliveryszCity,      
BOS_SD_FDo.DeliveryszZipCode,      
BOS_SD_FDo.DeliveryszState,      
BOS_SD_FDo.DeliveryszCountry,      
BOS_SD_FDo.DeliveryszPhoneNo_1,      
BOS_SD_FDo.DeliveryszPhoneNo_2,      
BOS_SD_FDo.DeliveryszFaxNo,      
BOS_SD_FDo.DeliveryszMobileNo,      
BOS_SD_FDo.DeliveryszEmail,      
BOS_SD_FDo.DeliveryszWebSite,      

--Customer's collection info      
BSR.szRouteId AS szCollRouteId,      
BSR.szDescription AS szCollRouteDescription,      
BSR.szOpUserId AS szCollectorId,      
BPE.szName AS szCollectorNm,      

BOS_SD_FDo.bResultFrTransfer,      
BOS_SD_FDo.bVoid,      
BOS_GEN_Approved.bApproved,      
BOS_SD_FDo.bApplied,      
BOS_GL_FJournalTrans.szFJournalId as bJournal,      
BOS_GL_FJournalTrans.bPosted,      
BOS_SD_FDo.btPrintedCount,      
BOS_SD_FDo.bTransferred,      

BOS_SD_FDo.szCompanyId,      
BOS_GL_Company.szName as szCompanyNm,      

BOS_SD_FDo.szWorkplaceId,      
BOS_GL_Workplace.szName as szWorkplaceNm,      

BOS_SD_FDo.szTaxEntityId,      

BOS_SD_FDo.bNeedApproval,      
BOS_GEN_Approved.gdApprovedId,      
BOS_GEN_Approved.szApprovalId,      

BOS_GL_FJournalTrans.szFJournalId,      

BOS_SD_FDo.dtmCreated,      
BOS_SD_FDo.bSystemCreated,      

BOS_SD_FDo.szUserId,      
BOS_SM_User.szName AS szUserNm_J,      

-- Data Status.      
BOS_SD_FDo.dtmLastUpdated,      
BOS_SD_FDo.bAlreadyTransferred,      
BOS_SD_FDo.szManualNo,      
BOS_SD_FDo.szFCustBIId,      
BOS_SD_FDo.dtmMobileTransaction,      

-- Weight and Volume      
BOS_SD_FDo.decTonase,      
BOS_SD_FDo.decCubication,      
BOS_SD_FDo.bUploadedFromMoDis,      
BOS_SD_FDo.dtmStartVisit,     
BOS_SD_FDo.dtmEndVisit,     
BOS_SD_FDo.decVisitSpendTime,    
BOS_SD_FDo.bScanSuccess,     
BOS_SD_FDo.szScanFailReason,
BOS_SD_FDo.szBarcodeScanFailReason,
BOS_SD_FDo.bScanBarcodeSuccess,
BOS_SD_FDo.decJourneySpendTime,
BOS_SD_FDo.AdcId
FROM      
BOS_SD_FDo       
LEFT JOIN BOS_GEN_Approved AS CreditLimitApproved ON CreditLimitApproved.gdApprovedId = BOS_SD_FDo.gdCreditLimitApprovedId      
LEFT JOIN BOS_GEN_Approved ON BOS_SD_FDo.gdApprovedId = BOS_GEN_Approved.gdApprovedId      
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FDo.szFJournalId = BOS_GL_FJournalTrans.szFJournalId      
LEFT JOIN BOS_PI_Employee as Helper1 ON BOS_SD_FDo.szHelperId = Helper1.szEmployeeId      
LEFT JOIN BOS_PI_Employee as Helper2 ON BOS_SD_FDo.szHelperId_2 = Helper2.szEmployeeId      
LEFT JOIN BOS_PI_Employee as Helper3 ON BOS_SD_FDo.szHelperId_3 = Helper3.szEmployeeId      

LEFT JOIN BOS_PI_Employee as Sales ON Sales.szEmployeeId = BOS_SD_FDo.szSalesId      

--  These join fields are not really needed. But to retrieve them makes      
--  to do join to six different tables.      
--  So just de-activate it temporarily and activate it when it is absolutely      
--  necessary (and the processing power has increased).      
--LEFT JOIN BOS_PI_Employee as Sup ON Sup.szEmployeeId = BOS_SD_FDo.szSalesSupervisorId      
--LEFT JOIN BOS_PI_Employee as Sup2 ON Sup2.szEmployeeId = BOS_SD_FDo.szSalesSupervisorId_2      
--LEFT JOIN BOS_PI_Employee as Sup3 ON Sup3.szEmployeeId = BOS_SD_FDo.szSalesSupervisorId_3      
--LEFT JOIN BOS_PI_Division as Div ON Div.szDivisionId = BOS_SD_FDo.szSalesDivisionId      
--LEFT JOIN BOS_PI_Department as Dep ON Dep.szDepartmentId = BOS_SD_FDo.szSalesDepartmentId      
--LEFT JOIN BOS_PI_Team as Tea ON Tea.szTeamId = BOS_SD_FDo.szSalesTeamId      

LEFT JOIN BOS_AR_Customer ON BOS_SD_FDo.szCustId = BOS_AR_Customer.szCustId      

LEFT JOIN BOS_SD_DjrTracking ON BOS_SD_DjrTracking.szFDoId = BOS_SD_FDo.szDoId      
LEFT JOIN BOS_INV_Carrier ON BOS_INV_Carrier.szCarrierId = BOS_SD_FDo.szCarrierId      

LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FDo.szCompanyId      
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId      
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FDo.szUserId      

LEFT JOIN BOS_INV_Warehouse ON BOS_INV_Warehouse.szWarehouseId = BOS_SD_FDo.szWarehouseId      

LEFT JOIN BOS_AR_Customer AS InvCust ON InvCust.szCustId = BOS_AR_Customer.szInvoiceToCustId      

--Allow to credit is based on original customer, not from invoice-to customer.      
LEFT JOIN BOS_AR_CustSales AS CustSales ON CustSales.szCustId = BOS_AR_Customer.szCustId      

LEFT JOIN BOS_AR_Customer AS CollCust ON CollCust.szCustId = InvCust.szCollectToCustId      
LEFT JOIN BOS_SD_CustCollRoutine AS BSCCR ON BSCCR.szCustId = CollCust.szCustId      
LEFT JOIN BOS_SD_Route AS BSR ON BSR.szRouteId = BSCCR.szDefaultRouteId      
LEFT JOIN BOS_PI_Employee AS BPE ON BPE.szEmployeeId = BSR.szOpUserId      
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FDo.szCcyId      

LEFT JOIN BOS_INV_OrderType ON BOS_INV_OrderType.szOrderTypeId = BOS_SD_FDo.szOrderTypeId      

WHERE      
BOS_SD_FDo.szDoId = p_szDoId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetFDo_014(
p_szDoId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN

SELECT      
BOS_SD_FDo.szDoId,      
BOS_SD_FDo.szApplyNo,      
BOS_SD_FDo.szFSoId,      

BOS_SD_FDo.szLogisticType,      
BOS_SD_FDo.szFDnId,      

BOS_SD_FDo.bReturnToWarehouse,      
BOS_SD_FDo.szReturnFDoId,      
BOS_SD_FDo.szReturnWarehouseId,      
BOS_SD_FDo.szReturnStockTypeId,      

BOS_SD_FDo.szSalesOrgId,      

BOS_SD_FDo.szOrderTypeId,      
BOS_INV_OrderType.bAllowManualPrice AS bOrderTypeAllowManualPrice_J,      
BOS_INV_OrderType.bAllowToChangeLinePriceDate AS bOrderTypeAllowToChangeLinePriceDate_J,      

BOS_SD_FDo.dtmDelivery,      
BOS_SD_FDo.dtmPrice,      

BOS_SD_FDo.szCustId,      
BOS_AR_Customer.szName as szCustNm_J,      
CustSales.bAllowToCredit AS bCustAllowToCredit_J,      

BOS_SD_FDo.decAmount,      
BOS_SD_FDo.decTax,      

BOS_SD_FDo.szCcyId,      
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat_J,      

BOS_SD_FDo.szCcyRateId,      
BOS_SD_FDo.decCcyRate,      
BOS_SD_FDo.szFInvoiceId,      
BOS_SD_FDo.szFirstFInvoiceId,      
BOS_SD_FDo.bDropShip,      
BOS_SD_FDo.bUseThirdPartyCarrier,      

BOS_SD_FDo.szVehicleId,      
BOS_SD_FDo.szVehicleNumber,      

BOS_SD_FDo.szDriverId,      
BOS_SD_FDo.szDriverName,      

BOS_SD_FDo.szHelperId,      
Helper1.szName as szHelperNm,      

BOS_SD_FDo.szHelperId_2,      
Helper2.szName as szHelperNm_2,      

BOS_SD_FDo.szHelperId_3,      
Helper3.szName as szHelperNm_3,      

BOS_SD_FDo.szSalesId,      
Sales.szName AS szSalesNm_J,      

BOS_SD_FDo.szSalesSupervisorId,      
BOS_SD_FDo.szSalesSupervisorId_2,      
BOS_SD_FDo.szSalesSupervisorId_3,      
BOS_SD_FDo.szSalesDivisionId,      
BOS_SD_FDo.szSalesDepartmentId,      
BOS_SD_FDo.szSalesTeamId,      

BOS_SD_FDo.szCarrierId,      
BOS_INV_Carrier.szName as szCarrierNm,      

BOS_SD_FDo.szRemark,      
BOS_SD_FDo.szLatitude,      
BOS_SD_FDo.szLongitude,      

BOS_SD_FDo.szCustPoId,      
BOS_SD_FDo.dtmCustPo,      

BOS_SD_FDo.szWarehouseId,      
BOS_INV_Warehouse.szName as szWarehouseNm,      

BOS_SD_FDo.szStockTypeId,      
BOS_SD_FDo.bCash,      

BOS_SD_FDo.gdCreditLimitApprovedId,      
CreditLimitApproved.szApprovalId AS szCreditLimitApprovalId_J,      
CreditLimitApproved.bApproved AS bCreditLimitApproved_J,      

BOS_SD_DjrTracking.szDjrTrackingId as szDjrTrackingId_J,      
BOS_SD_DjrTracking.szFDjrId AS szDjrTrackingFDjrId_J,      

BOS_SD_FDo.szPaymentTermId,      

BOS_SD_FDo.DeliveryszContactPerson,      
BOS_SD_FDo.DeliveryszRoomNo,      
BOS_SD_FDo.DeliveryszFloor,      
BOS_SD_FDo.DeliveryszBuilding,      
BOS_SD_FDo.DeliveryszAddress_1,      
BOS_SD_FDo.DeliveryszAddress_2,      
BOS_SD_FDo.DeliveryszDistrict,      
BOS_SD_FDo.DeliveryszCity,      
BOS_SD_FDo.DeliveryszZipCode,      
BOS_SD_FDo.DeliveryszState,      
BOS_SD_FDo.DeliveryszCountry,      
BOS_SD_FDo.DeliveryszPhoneNo_1,      
BOS_SD_FDo.DeliveryszPhoneNo_2,      
BOS_SD_FDo.DeliveryszFaxNo,      
BOS_SD_FDo.DeliveryszMobileNo,      
BOS_SD_FDo.DeliveryszEmail,      
BOS_SD_FDo.DeliveryszWebSite,      

--Customer's collection info      
BSR.szRouteId AS szCollRouteId,      
BSR.szDescription AS szCollRouteDescription,      
BSR.szOpUserId AS szCollectorId,      
BPE.szName AS szCollectorNm,      

BOS_SD_FDo.bResultFrTransfer,      
BOS_SD_FDo.bVoid,      
BOS_GEN_Approved.bApproved,      
BOS_SD_FDo.bApplied,      
BOS_GL_FJournalTrans.szFJournalId as bJournal,      
BOS_GL_FJournalTrans.bPosted,      
BOS_SD_FDo.btPrintedCount,      
BOS_SD_FDo.bTransferred,      

BOS_SD_FDo.szCompanyId,      
BOS_GL_Company.szName as szCompanyNm,      

BOS_SD_FDo.szWorkplaceId,      
BOS_GL_Workplace.szName as szWorkplaceNm,      

BOS_SD_FDo.szTaxEntityId,      

BOS_SD_FDo.bNeedApproval,      
BOS_GEN_Approved.gdApprovedId,      
BOS_GEN_Approved.szApprovalId,      

BOS_GL_FJournalTrans.szFJournalId,      

BOS_SD_FDo.dtmCreated,      
BOS_SD_FDo.bSystemCreated,      

BOS_SD_FDo.szUserId,      
BOS_SM_User.szName AS szUserNm_J,      

-- Data Status.      
BOS_SD_FDo.dtmLastUpdated,      
BOS_SD_FDo.bAlreadyTransferred,      
BOS_SD_FDo.szManualNo,      
BOS_SD_FDo.szFCustBIId,      
BOS_SD_FDo.dtmMobileTransaction,      

-- Weight and Volume      
BOS_SD_FDo.decTonase,      
BOS_SD_FDo.decCubication,      
BOS_SD_FDo.bUploadedFromMoDis,      
BOS_SD_FDo.dtmStartVisit,     
BOS_SD_FDo.dtmEndVisit,     
BOS_SD_FDo.decVisitSpendTime,     
BOS_SD_FDo.bScanSuccess,     
BOS_SD_FDo.szScanFailReason,
BOS_SD_FDo.szBarcodeScanFailReason,
BOS_SD_FDo.bScanBarcodeSuccess,
BOS_SD_FDo.decJourneySpendTime,
BOS_SD_FDo.szCustReturnTaxRefNote
FROM      
BOS_SD_FDo       
LEFT JOIN BOS_GEN_Approved AS CreditLimitApproved ON CreditLimitApproved.gdApprovedId = BOS_SD_FDo.gdCreditLimitApprovedId      
LEFT JOIN BOS_GEN_Approved ON BOS_SD_FDo.gdApprovedId = BOS_GEN_Approved.gdApprovedId      
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FDo.szFJournalId = BOS_GL_FJournalTrans.szFJournalId      
LEFT JOIN BOS_PI_Employee as Helper1 ON BOS_SD_FDo.szHelperId = Helper1.szEmployeeId      
LEFT JOIN BOS_PI_Employee as Helper2 ON BOS_SD_FDo.szHelperId_2 = Helper2.szEmployeeId      
LEFT JOIN BOS_PI_Employee as Helper3 ON BOS_SD_FDo.szHelperId_3 = Helper3.szEmployeeId      

LEFT JOIN BOS_PI_Employee as Sales ON Sales.szEmployeeId = BOS_SD_FDo.szSalesId      

--  These join fields are not really needed. But to retrieve them makes      
--  to do join to six different tables.      
--  So just de-activate it temporarily and activate it when it is absolutely      
--  necessary (and the processing power has increased).      
--LEFT JOIN BOS_PI_Employee as Sup ON Sup.szEmployeeId = BOS_SD_FDo.szSalesSupervisorId      
--LEFT JOIN BOS_PI_Employee as Sup2 ON Sup2.szEmployeeId = BOS_SD_FDo.szSalesSupervisorId_2      
--LEFT JOIN BOS_PI_Employee as Sup3 ON Sup3.szEmployeeId = BOS_SD_FDo.szSalesSupervisorId_3      
--LEFT JOIN BOS_PI_Division as Div ON Div.szDivisionId = BOS_SD_FDo.szSalesDivisionId      
--LEFT JOIN BOS_PI_Department as Dep ON Dep.szDepartmentId = BOS_SD_FDo.szSalesDepartmentId      
--LEFT JOIN BOS_PI_Team as Tea ON Tea.szTeamId = BOS_SD_FDo.szSalesTeamId      

LEFT JOIN BOS_AR_Customer ON BOS_SD_FDo.szCustId = BOS_AR_Customer.szCustId      

LEFT JOIN BOS_SD_DjrTracking ON BOS_SD_DjrTracking.szFDoId = BOS_SD_FDo.szDoId      
LEFT JOIN BOS_INV_Carrier ON BOS_INV_Carrier.szCarrierId = BOS_SD_FDo.szCarrierId      

LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FDo.szCompanyId      
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId      
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FDo.szUserId      

LEFT JOIN BOS_INV_Warehouse ON BOS_INV_Warehouse.szWarehouseId = BOS_SD_FDo.szWarehouseId      

LEFT JOIN BOS_AR_Customer AS InvCust ON InvCust.szCustId = BOS_AR_Customer.szInvoiceToCustId      

--Allow to credit is based on original customer, not from invoice-to customer.      
LEFT JOIN BOS_AR_CustSales AS CustSales ON CustSales.szCustId = BOS_AR_Customer.szCustId      

LEFT JOIN BOS_AR_Customer AS CollCust ON CollCust.szCustId = InvCust.szCollectToCustId      
LEFT JOIN BOS_SD_CustCollRoutine AS BSCCR ON BSCCR.szCustId = CollCust.szCustId      
LEFT JOIN BOS_SD_Route AS BSR ON BSR.szRouteId = BSCCR.szDefaultRouteId      
LEFT JOIN BOS_PI_Employee AS BPE ON BPE.szEmployeeId = BSR.szOpUserId      
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FDo.szCcyId      

LEFT JOIN BOS_INV_OrderType ON BOS_INV_OrderType.szOrderTypeId = BOS_SD_FDo.szOrderTypeId      

WHERE      
BOS_SD_FDo.szDoId = p_szDoId  





END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetFDo_015(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT      
BOS_SD_FDo.szDoId,      
BOS_SD_FDo.szApplyNo,      
BOS_SD_FDo.szFSoId,      

BOS_SD_FDo.szLogisticType,      
BOS_SD_FDo.szFDnId,      

BOS_SD_FDo.bReturnToWarehouse,      
BOS_SD_FDo.szReturnFDoId,      
BOS_SD_FDo.szReturnWarehouseId,      
BOS_SD_FDo.szReturnStockTypeId,      

BOS_SD_FDo.szSalesOrgId,      

BOS_SD_FDo.szOrderTypeId,      
BOS_INV_OrderType.bAllowManualPrice AS bOrderTypeAllowManualPrice_J,      
BOS_INV_OrderType.bAllowToChangeLinePriceDate AS bOrderTypeAllowToChangeLinePriceDate_J,      

BOS_SD_FDo.dtmDelivery,      
BOS_SD_FDo.dtmPrice,      

BOS_SD_FDo.szCustId,      
BOS_AR_Customer.szName as szCustNm_J,      
CustSales.bAllowToCredit AS bCustAllowToCredit_J,      

BOS_SD_FDo.decAmount,      
BOS_SD_FDo.decTax,      

BOS_SD_FDo.szCcyId,      
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat_J,      

BOS_SD_FDo.szCcyRateId,      
BOS_SD_FDo.decCcyRate,      
BOS_SD_FDo.szFInvoiceId,      
BOS_SD_FDo.szFirstFInvoiceId,      
BOS_SD_FDo.bDropShip,      
BOS_SD_FDo.bUseThirdPartyCarrier,      

BOS_SD_FDo.szVehicleId,      
BOS_SD_FDo.szVehicleNumber,      

BOS_SD_FDo.szDriverId,      
BOS_SD_FDo.szDriverName,      

BOS_SD_FDo.szHelperId,      
Helper1.szName as szHelperNm,      

BOS_SD_FDo.szHelperId_2,      
Helper2.szName as szHelperNm_2,      

BOS_SD_FDo.szHelperId_3,      
Helper3.szName as szHelperNm_3,      

BOS_SD_FDo.szSalesId,      
Sales.szName AS szSalesNm_J,      

BOS_SD_FDo.szSalesSupervisorId,      
BOS_SD_FDo.szSalesSupervisorId_2,      
BOS_SD_FDo.szSalesSupervisorId_3,      
BOS_SD_FDo.szSalesDivisionId,      
BOS_SD_FDo.szSalesDepartmentId,      
BOS_SD_FDo.szSalesTeamId,      

BOS_SD_FDo.szCarrierId,      
BOS_INV_Carrier.szName as szCarrierNm,      

BOS_SD_FDo.szRemark,      
BOS_SD_FDo.szLatitude,      
BOS_SD_FDo.szLongitude,      

BOS_SD_FDo.szCustPoId,      
BOS_SD_FDo.dtmCustPo,      

BOS_SD_FDo.szWarehouseId,      
BOS_INV_Warehouse.szName as szWarehouseNm,      

BOS_SD_FDo.szStockTypeId,      
BOS_SD_FDo.bCash,      

BOS_SD_FDo.gdCreditLimitApprovedId,      
CreditLimitApproved.szApprovalId AS szCreditLimitApprovalId_J,      
CreditLimitApproved.bApproved AS bCreditLimitApproved_J,      

BOS_SD_DjrTracking.szDjrTrackingId as szDjrTrackingId_J,      
BOS_SD_DjrTracking.szFDjrId AS szDjrTrackingFDjrId_J,      

BOS_SD_FDo.szPaymentTermId,      

BOS_SD_FDo.DeliveryszContactPerson,      
BOS_SD_FDo.DeliveryszRoomNo,      
BOS_SD_FDo.DeliveryszFloor,      
BOS_SD_FDo.DeliveryszBuilding,      
BOS_SD_FDo.DeliveryszAddress_1,      
BOS_SD_FDo.DeliveryszAddress_2,      
BOS_SD_FDo.DeliveryszDistrict,      
BOS_SD_FDo.DeliveryszCity,      
BOS_SD_FDo.DeliveryszZipCode,      
BOS_SD_FDo.DeliveryszState,      
BOS_SD_FDo.DeliveryszCountry,      
BOS_SD_FDo.DeliveryszPhoneNo_1,      
BOS_SD_FDo.DeliveryszPhoneNo_2,      
BOS_SD_FDo.DeliveryszFaxNo,      
BOS_SD_FDo.DeliveryszMobileNo,      
BOS_SD_FDo.DeliveryszEmail,      
BOS_SD_FDo.DeliveryszWebSite,      

--Customer's collection info      
BSR.szRouteId AS szCollRouteId,      
BSR.szDescription AS szCollRouteDescription,      
BSR.szOpUserId AS szCollectorId,      
BPE.szName AS szCollectorNm,      

BOS_SD_FDo.bResultFrTransfer,      
BOS_SD_FDo.bVoid,      
BOS_GEN_Approved.bApproved,      
BOS_SD_FDo.bApplied,      
BOS_GL_FJournalTrans.szFJournalId as bJournal,      
BOS_GL_FJournalTrans.bPosted,      
BOS_SD_FDo.btPrintedCount,      
BOS_SD_FDo.bTransferred,      

BOS_SD_FDo.szCompanyId,      
BOS_GL_Company.szName as szCompanyNm,      

BOS_SD_FDo.szWorkplaceId,      
BOS_GL_Workplace.szName as szWorkplaceNm,      

BOS_SD_FDo.szTaxEntityId,      

BOS_SD_FDo.bNeedApproval,      
BOS_GEN_Approved.gdApprovedId,      
BOS_GEN_Approved.szApprovalId,      

BOS_GL_FJournalTrans.szFJournalId,      

BOS_SD_FDo.dtmCreated,      
BOS_SD_FDo.bSystemCreated,      

BOS_SD_FDo.szUserId,      
BOS_SM_User.szName AS szUserNm_J,      

-- Data Status.      
BOS_SD_FDo.dtmLastUpdated,      
BOS_SD_FDo.bAlreadyTransferred,      
BOS_SD_FDo.szManualNo,      
BOS_SD_FDo.szFCustBIId,      
BOS_SD_FDo.dtmMobileTransaction,      

-- Weight and Volume      
BOS_SD_FDo.decTonase,      
BOS_SD_FDo.decCubication,      
BOS_SD_FDo.bUploadedFromMoDis,      
BOS_SD_FDo.dtmStartVisit,     
BOS_SD_FDo.dtmEndVisit,     
BOS_SD_FDo.decVisitSpendTime,    
BOS_SD_FDo.bScanSuccess,     
BOS_SD_FDo.szScanFailReason,
BOS_SD_FDo.szBarcodeScanFailReason,
BOS_SD_FDo.bScanBarcodeSuccess,
BOS_SD_FDo.decJourneySpendTime,
BOS_SD_FDo.AdcId,
BOS_SD_FDo.szCustReturnTaxRefNote,
BOS_SD_FDo.szCustReceiptNo  
FROM      
BOS_SD_FDo       
LEFT JOIN BOS_GEN_Approved AS CreditLimitApproved ON CreditLimitApproved.gdApprovedId = BOS_SD_FDo.gdCreditLimitApprovedId      
LEFT JOIN BOS_GEN_Approved ON BOS_SD_FDo.gdApprovedId = BOS_GEN_Approved.gdApprovedId      
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FDo.szFJournalId = BOS_GL_FJournalTrans.szFJournalId      
LEFT JOIN BOS_PI_Employee as Helper1 ON BOS_SD_FDo.szHelperId = Helper1.szEmployeeId      
LEFT JOIN BOS_PI_Employee as Helper2 ON BOS_SD_FDo.szHelperId_2 = Helper2.szEmployeeId      
LEFT JOIN BOS_PI_Employee as Helper3 ON BOS_SD_FDo.szHelperId_3 = Helper3.szEmployeeId      

LEFT JOIN BOS_PI_Employee as Sales ON Sales.szEmployeeId = BOS_SD_FDo.szSalesId      

--  These join fields are not really needed. But to retrieve them makes      
--  to do join to six different tables.      
--  So just de-activate it temporarily and activate it when it is absolutely      
--  necessary (and the processing power has increased).      
--LEFT JOIN BOS_PI_Employee as Sup ON Sup.szEmployeeId = BOS_SD_FDo.szSalesSupervisorId      
--LEFT JOIN BOS_PI_Employee as Sup2 ON Sup2.szEmployeeId = BOS_SD_FDo.szSalesSupervisorId_2      
--LEFT JOIN BOS_PI_Employee as Sup3 ON Sup3.szEmployeeId = BOS_SD_FDo.szSalesSupervisorId_3      
--LEFT JOIN BOS_PI_Division as Div ON Div.szDivisionId = BOS_SD_FDo.szSalesDivisionId      
--LEFT JOIN BOS_PI_Department as Dep ON Dep.szDepartmentId = BOS_SD_FDo.szSalesDepartmentId      
--LEFT JOIN BOS_PI_Team as Tea ON Tea.szTeamId = BOS_SD_FDo.szSalesTeamId      

LEFT JOIN BOS_AR_Customer ON BOS_SD_FDo.szCustId = BOS_AR_Customer.szCustId      

LEFT JOIN BOS_SD_DjrTracking ON BOS_SD_DjrTracking.szFDoId = BOS_SD_FDo.szDoId      
LEFT JOIN BOS_INV_Carrier ON BOS_INV_Carrier.szCarrierId = BOS_SD_FDo.szCarrierId      

LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FDo.szCompanyId      
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId      
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FDo.szUserId      

LEFT JOIN BOS_INV_Warehouse ON BOS_INV_Warehouse.szWarehouseId = BOS_SD_FDo.szWarehouseId      

LEFT JOIN BOS_AR_Customer AS InvCust ON InvCust.szCustId = BOS_AR_Customer.szInvoiceToCustId      

--Allow to credit is based on original customer, not from invoice-to customer.      
LEFT JOIN BOS_AR_CustSales AS CustSales ON CustSales.szCustId = BOS_AR_Customer.szCustId      

LEFT JOIN BOS_AR_Customer AS CollCust ON CollCust.szCustId = InvCust.szCollectToCustId      
LEFT JOIN BOS_SD_CustCollRoutine AS BSCCR ON BSCCR.szCustId = CollCust.szCustId      
LEFT JOIN BOS_SD_Route AS BSR ON BSR.szRouteId = BSCCR.szDefaultRouteId      
LEFT JOIN BOS_PI_Employee AS BPE ON BPE.szEmployeeId = BSR.szOpUserId      
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FDo.szCcyId      

LEFT JOIN BOS_INV_OrderType ON BOS_INV_OrderType.szOrderTypeId = BOS_SD_FDo.szOrderTypeId      

WHERE      
BOS_SD_FDo.szDoId = p_szDoId



END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetFDoItem(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_FDOItem.szDoId,
BOS_SD_FDOItem.shItemNumber,

BOS_SD_FDOItem.szOrderItemTypeId,
BOS_INV_OrderItemType.bTaxable as bOrderItemTypeTaxable_J,
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,
BOS_INV_OrderItemType.szRentChargeCalcId AS szOrderItemTypeRentChargeCalcId_J,
BOS_INV_OrderItemType.bSubjectToInvoice AS bOrderItemTypeSubjectToInvoice_J,
BOS_INV_OrderItemType.szReturnOrderItemTypeId AS szOrderItemTypeReturnOrderItemTypeId_J,

BOS_INV_OrderItemType.bMustFillTrnReason AS bOrderItemTypeMustFillTrnReason_J,
BOS_INV_OrderItemType.bAllowEmptyTrnReason AS bOrderItemTypeAllowEmptyTrnReason_J,
BOS_INV_OrderItemType.bAllowDifferentSignInQty AS bOrderItemTypeAllowDifferentSignInQty_J,

BOS_SD_FDOItem.szProductId,

BOS_INV_Product.szName as szProductName_J,
BOS_INV_Product.szNickName as szProductNickName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,
BOS_GL_TaxType.decRate as decProductTaxRate_J

, BOS_INV_Product.szDiscountGroupId AS szProductDiscGroupId_J
, isnull(BGWP.szDiscountGroupId, '') AS szProductDiscGroupId_J_wp

, BOS_SD_FDOItem.szPriceId,
BOS_SD_FDOItem.szPriceOrderId,
BOS_SD_FDOItem.decDiscProcent,

BOS_SD_FDoItem.dtmPriceDate,

BOS_SD_FDOItem.decQty,
BOS_SD_FDOItem.decUomQty,

BOS_SD_FDOItem.szUomId,
BOS_SD_FDOItem.decPrice,
BOS_SD_FDOItem.decDiscount,
BOS_SD_FDOItem.bTaxable,
BOS_SD_FDOItem.decTax,
BOS_SD_FDOItem.decAmount,
BOS_SD_FDOItem.decDPP,
BOS_SD_FDOItem.szPaymentType,

BOS_SD_FDOItem.decCOGS,
BOS_SD_FDoItem.szPrincipalDiscRefId,
PrDiscRef.szDescription as szPrincipalDiscRefDesc_J,

-- Weight and Volume
BOS_SD_FDOItem.decTonase,
BOS_SD_FDOItem.decCubication,

dbo.BOS_SD_FDoItem.szParentId,
parent.szName AS szParentNm_J,

BOS_AR_CustomerProductItem.szRefProductId AS szCustProductId_J,
BOS_AR_CustomerProductItem.szRefProductName AS szCustProductNm_J

FROM 
BOS_SD_FDOItem 
LEFT JOIN BOS_SD_FDo AS BSF ON BSF.szDoId = BOS_SD_FDoItem.szDoId
left join BOS_INV_Product on BOS_SD_FDOItem.szProductId = BOS_INV_Product.szProductId
left join BOS_INV_Product AS parent on BOS_SD_FDOItem.szParentId = parent.szProductId
left join BOS_GL_TaxType on BOS_INV_Product.szTaxTypeId = BOS_GL_TaxType.szTaxTypeId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_SD_FDoItem.szOrderItemTypeId
left join BOS_SD_OrgStru_PrincipalDiscRef as PrDiscRef on BOS_SD_FDoItem.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId
LEFT JOIN BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_SD_FDoItem.szDoId	
LEFT JOIN BOS_AR_CustomerProductItem ON BOS_AR_CustomerProductItem.szCustId = BOS_SD_FDo.szCustId 
AND BOS_AR_CustomerProductItem.szProductId = BOS_SD_FDoItem.szProductId
LEFT JOIN BOS_GL_WorkplaceProduct AS BGWP ON BGWP.szWorkplaceId = BSF.szWorkplaceId
AND BGWP.szProductId = BOS_SD_FDoItem.szProductId

WHERE 
BOS_SD_FDOItem.szDoId = p_szDoId
ORDER BY
BOS_SD_FDOItem.shItemNumber

-- ==================================================================

set ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetFDoItem_013(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_SD_FDOItem.szDoId,  
BOS_SD_FDOItem.shItemNumber,  

BOS_SD_FDOItem.szOrderItemTypeId,  
BOS_INV_OrderItemType.bTaxable as bOrderItemTypeTaxable_J,  
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,  
BOS_INV_OrderItemType.szRentChargeCalcId AS szOrderItemTypeRentChargeCalcId_J,  
BOS_INV_OrderItemType.bSubjectToInvoice AS bOrderItemTypeSubjectToInvoice_J,  
BOS_INV_OrderItemType.szReturnOrderItemTypeId AS szOrderItemTypeReturnOrderItemTypeId_J,  

BOS_INV_OrderItemType.bMustFillTrnReason AS bOrderItemTypeMustFillTrnReason_J,  
BOS_INV_OrderItemType.bAllowEmptyTrnReason AS bOrderItemTypeAllowEmptyTrnReason_J,  
BOS_INV_OrderItemType.bAllowDifferentSignInQty AS bOrderItemTypeAllowDifferentSignInQty_J,  

BOS_SD_FDOItem.szProductId,  

BOS_INV_Product.szName as szProductName_J,  
BOS_INV_Product.szNickName as szProductNickName_J,  
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,  
BOS_INV_Product.szUomId AS szProductUomId_J,  
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,  
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,  
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,  
BOS_GL_TaxType.decRate as decProductTaxRate_J  

, BOS_INV_Product.szDiscountGroupId AS szProductDiscGroupId_J  
, isnull(BGWP.szDiscountGroupId, '') AS szProductDiscGroupId_J_wp  

, BOS_SD_FDOItem.szPriceId,  
BOS_SD_FDOItem.szPriceOrderId,  
BOS_SD_FDOItem.decDiscProcent,  

BOS_SD_FDoItem.dtmPriceDate,  

BOS_SD_FDOItem.decQty,  
BOS_SD_FDOItem.decUomQty,  

BOS_SD_FDOItem.szUomId,  
BOS_SD_FDOItem.decPrice,  
BOS_SD_FDOItem.decDiscount,  
BOS_SD_FDOItem.bTaxable,  
BOS_SD_FDOItem.decTax,  
BOS_SD_FDOItem.decAmount,  
BOS_SD_FDOItem.decDPP,  
BOS_SD_FDOItem.szPaymentType,  

BOS_SD_FDOItem.decCOGS,  
BOS_SD_FDoItem.szPrincipalDiscRefId,  
PrDiscRef.szDescription as szPrincipalDiscRefDesc_J,  

-- Weight and Volume  
BOS_SD_FDOItem.decTonase,  
BOS_SD_FDOItem.decCubication,  

dbo.BOS_SD_FDoItem.szParentId,  
parent.szName AS szParentNm_J,  

BOS_AR_CustomerProductItem.szRefProductId AS szCustProductId_J,  
BOS_AR_CustomerProductItem.szRefProductName AS szCustProductNm_J  

FROM   
BOS_SD_FDOItem   
LEFT JOIN BOS_SD_FDo AS BSF ON BSF.szDoId = BOS_SD_FDoItem.szDoId  
left join BOS_INV_Product on BOS_SD_FDOItem.szProductId = BOS_INV_Product.szProductId  
left join BOS_INV_Product AS parent on BOS_SD_FDOItem.szParentId = parent.szProductId  
left join BOS_GL_TaxType on BOS_INV_Product.szTaxTypeId = BOS_GL_TaxType.szTaxTypeId  
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_SD_FDoItem.szOrderItemTypeId  
left join BOS_SD_OrgStru_PrincipalDiscRef as PrDiscRef on BOS_SD_FDoItem.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId  
LEFT JOIN BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_SD_FDoItem.szDoId   
LEFT JOIN BOS_AR_CustomerProductItem ON BOS_AR_CustomerProductItem.szCustId = BOS_SD_FDo.szCustId   
AND BOS_AR_CustomerProductItem.szProductId = BOS_SD_FDoItem.szProductId  
LEFT JOIN BOS_GL_WorkplaceProduct AS BGWP ON BGWP.szWorkplaceId = BSF.szWorkplaceId  
AND BGWP.szProductId = BOS_SD_FDoItem.szProductId  

WHERE   
BOS_SD_FDOItem.szDoId = p_szDoId  
ORDER BY  
BOS_SD_FDOItem.shItemNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetFDoItem_014(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_SD_FDOItem.szDoId,  
BOS_SD_FDOItem.shItemNumber,  

BOS_SD_FDOItem.szOrderItemTypeId,  
BOS_INV_OrderItemType.bTaxable as bOrderItemTypeTaxable_J,  
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,  
BOS_INV_OrderItemType.szRentChargeCalcId AS szOrderItemTypeRentChargeCalcId_J,  
BOS_INV_OrderItemType.bSubjectToInvoice AS bOrderItemTypeSubjectToInvoice_J,  
BOS_INV_OrderItemType.szReturnOrderItemTypeId AS szOrderItemTypeReturnOrderItemTypeId_J,  

BOS_INV_OrderItemType.bMustFillTrnReason AS bOrderItemTypeMustFillTrnReason_J,  
BOS_INV_OrderItemType.bAllowEmptyTrnReason AS bOrderItemTypeAllowEmptyTrnReason_J,  
BOS_INV_OrderItemType.bAllowDifferentSignInQty AS bOrderItemTypeAllowDifferentSignInQty_J,  

BOS_SD_FDOItem.szProductId,  

BOS_INV_Product.szName as szProductName_J,  
BOS_INV_Product.szNickName as szProductNickName_J,  
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,  
BOS_INV_Product.szUomId AS szProductUomId_J,  
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,  
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,  
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,  
BOS_GL_TaxType.decRate as decProductTaxRate_J  

, BOS_INV_Product.szDiscountGroupId AS szProductDiscGroupId_J  
, isnull(BGWP.szDiscountGroupId, '') AS szProductDiscGroupId_J_wp  

, BOS_SD_FDOItem.szPriceId,  
BOS_SD_FDOItem.szPriceOrderId,  
BOS_SD_FDOItem.decDiscProcent,  

BOS_SD_FDoItem.dtmPriceDate,  

BOS_SD_FDOItem.decQty,  
BOS_SD_FDOItem.decUomQty,  

BOS_SD_FDOItem.szUomId,  
BOS_SD_FDOItem.decPrice,  
BOS_SD_FDOItem.decDiscount,  
BOS_SD_FDOItem.bTaxable,  
BOS_SD_FDOItem.decTax,  
BOS_SD_FDOItem.decAmount,  
BOS_SD_FDOItem.decDPP,  
BOS_SD_FDOItem.szPaymentType,  

BOS_SD_FDOItem.decCOGS,  
BOS_SD_FDoItem.szPrincipalDiscRefId,  
PrDiscRef.szDescription as szPrincipalDiscRefDesc_J,  

-- Weight and Volume  
BOS_SD_FDOItem.decTonase,  
BOS_SD_FDOItem.decCubication,  

dbo.BOS_SD_FDoItem.szParentId,  
parent.szName AS szParentNm_J,  

BOS_AR_CustomerProductItem.szRefProductId AS szCustProductId_J,  
BOS_AR_CustomerProductItem.szRefProductName AS szCustProductNm_J,

BOS_SD_FDOItem.szDistProductId,  
BOS_SD_FDOItem.decDistQty,  
BOS_SD_FDOItem.decDistPrice     

FROM   
BOS_SD_FDOItem   
LEFT JOIN BOS_SD_FDo AS BSF ON BSF.szDoId = BOS_SD_FDoItem.szDoId  
left join BOS_INV_Product on BOS_SD_FDOItem.szProductId = BOS_INV_Product.szProductId  
left join BOS_INV_Product AS parent on BOS_SD_FDOItem.szParentId = parent.szProductId  
left join BOS_GL_TaxType on BOS_INV_Product.szTaxTypeId = BOS_GL_TaxType.szTaxTypeId  
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_SD_FDoItem.szOrderItemTypeId  
left join BOS_SD_OrgStru_PrincipalDiscRef as PrDiscRef on BOS_SD_FDoItem.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId  
LEFT JOIN BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_SD_FDoItem.szDoId   
LEFT JOIN BOS_AR_CustomerProductItem ON BOS_AR_CustomerProductItem.szCustId = BOS_SD_FDo.szCustId   
AND BOS_AR_CustomerProductItem.szProductId = BOS_SD_FDoItem.szProductId  
LEFT JOIN BOS_GL_WorkplaceProduct AS BGWP ON BGWP.szWorkplaceId = BSF.szWorkplaceId  
AND BGWP.szProductId = BOS_SD_FDoItem.szProductId  

WHERE   
BOS_SD_FDOItem.szDoId = p_szDoId  
ORDER BY  
BOS_SD_FDOItem.shItemNumber


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetFDoItem_015(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_SD_FDOItem.szDoId,  
BOS_SD_FDOItem.shItemNumber,  

BOS_SD_FDOItem.szOrderItemTypeId,  
BOS_INV_OrderItemType.bTaxable AS bOrderItemTypeTaxable_J,  
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,  
BOS_INV_OrderItemType.szRentChargeCalcId AS szOrderItemTypeRentChargeCalcId_J,  
BOS_INV_OrderItemType.bSubjectToInvoice AS bOrderItemTypeSubjectToInvoice_J,  
BOS_INV_OrderItemType.szReturnOrderItemTypeId AS szOrderItemTypeReturnOrderItemTypeId_J,  

BOS_INV_OrderItemType.bMustFillTrnReason AS bOrderItemTypeMustFillTrnReason_J,  
BOS_INV_OrderItemType.bAllowEmptyTrnReason AS bOrderItemTypeAllowEmptyTrnReason_J,  
BOS_INV_OrderItemType.bAllowDifferentSignInQty AS bOrderItemTypeAllowDifferentSignInQty_J,  

BOS_SD_FDOItem.szProductId,  

BOS_INV_Product.szName AS szProductName_J,  
BOS_INV_Product.szNickName AS szProductNickName_J,  
BOS_INV_Product.szQtyFormat AS szProductQtyFormat_J,  
BOS_INV_Product.szUomId AS szProductUomId_J,  
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,  
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,  
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,  
BOS_GL_TaxType.decRate AS decProductTaxRate_J  

, BOS_INV_Product.szDiscountGroupId AS szProductDiscGroupId_J  
, ISNULL(BGWP.szDiscountGroupId, '') AS szProductDiscGroupId_J_wp  

, BOS_SD_FDOItem.szPriceId,  
BOS_SD_FDOItem.szPriceOrderId,  
BOS_SD_FDOItem.decDiscProcent,  

BOS_SD_FDoItem.dtmPriceDate,  

BOS_SD_FDOItem.decQty,  
BOS_SD_FDOItem.decUomQty,  

BOS_SD_FDOItem.szUomId,  
BOS_SD_FDOItem.decPrice,  
BOS_SD_FDOItem.decDiscount,  
BOS_SD_FDOItem.bTaxable,  
BOS_SD_FDOItem.decTax,  
BOS_SD_FDOItem.decAmount,  
BOS_SD_FDOItem.decDPP,  
BOS_SD_FDOItem.szPaymentType,  

BOS_SD_FDOItem.decCOGS,  
BOS_SD_FDoItem.szPrincipalDiscRefId,  
PrDiscRef.szDescription AS szPrincipalDiscRefDesc_J,  

-- Weight and Volume  
BOS_SD_FDOItem.decTonase,  
BOS_SD_FDOItem.decCubication,  

dbo.BOS_SD_FDoItem.szParentId,  
parent.szName AS szParentNm_J,  

BOS_AR_CustomerProductItem.szRefProductId AS szCustProductId_J,  
BOS_AR_CustomerProductItem.szRefProductName AS szCustProductNm_J,

BOS_SD_FDOItem.szDistProductId,  
BOS_SD_FDOItem.decDistQty,  
BOS_SD_FDOItem.decDistPrice,     

BOS_SD_FDOItem.szBudgetId,  
BOS_SD_FDOItem.decPrincipalCostAmount,
BOS_SD_FDOItem.decPrincipalCostQty,
BOS_SD_FDOItem.bBudgetTransferred

FROM   
BOS_SD_FDOItem   
LEFT JOIN BOS_SD_FDo AS BSF ON BSF.szDoId = BOS_SD_FDoItem.szDoId  
LEFT JOIN BOS_INV_Product ON BOS_SD_FDOItem.szProductId = BOS_INV_Product.szProductId  
LEFT JOIN BOS_INV_Product AS parent ON BOS_SD_FDOItem.szParentId = parent.szProductId  
LEFT JOIN BOS_GL_TaxType ON BOS_INV_Product.szTaxTypeId = BOS_GL_TaxType.szTaxTypeId  
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_SD_FDoItem.szOrderItemTypeId  
LEFT JOIN BOS_SD_OrgStru_PrincipalDiscRef AS PrDiscRef ON BOS_SD_FDoItem.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId  
LEFT JOIN BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_SD_FDoItem.szDoId   
LEFT JOIN BOS_AR_CustomerProductItem ON BOS_AR_CustomerProductItem.szCustId = BOS_SD_FDo.szCustId   
AND BOS_AR_CustomerProductItem.szProductId = BOS_SD_FDoItem.szProductId  
LEFT JOIN BOS_GL_WorkplaceProduct AS BGWP ON BGWP.szWorkplaceId = BSF.szWorkplaceId  
AND BGWP.szProductId = BOS_SD_FDoItem.szProductId  

WHERE   
BOS_SD_FDOItem.szDoId = p_szDoId  
ORDER BY  
BOS_SD_FDOItem.shItemNumber



END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetFDoItemBonusSource(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId,

FROM 
BOS_SD_FDOItemBonusSource
WHERE 
szFDoId = p_szFDoId and shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetFDoItemBonusSource_013(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId,

FROM 
BOS_SD_FDOItemBonusSource
WHERE 
szFDoId = p_szFDoId and shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetFDoItemLotQty(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLotId,
decQty

FROM 
BOS_SD_FDoItemLotQty
WHERE 
szFDoId = p_szFDoId And shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetFDoItemLotQty_013(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLotId,
decQty

FROM 
BOS_SD_FDoItemLotQty
WHERE 
szFDoId = p_szFDoId And shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetFDoItemSN(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemSnNumber,

FROM 
BOS_SD_FDOItemSN
WHERE 
szDoId = p_szDoId and shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetFDoItemSN_013(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemSnNumber,

FROM 
BOS_SD_FDOItemSN
WHERE 
szDoId = p_szDoId and shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetFDoProductDepositBonusItem(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FDoProductDepositBonusItem.szDoId,
BOS_SD_FDoProductDepositBonusItem.shItemNumber,

BOS_SD_FDoProductDepositBonusItem.szProductId,

BOS_INV_Product.szName as szProductName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,

BOS_SD_FDoProductDepositBonusItem.decQty,
BOS_SD_FDoProductDepositBonusItem.szUomId,
BOS_SD_FDoProductDepositBonusItem.szOrderItemTypeId,

BOS_SD_FDoProductDepositBonusItem.bGenByTotal


FROM 
BOS_SD_FDoProductDepositBonusItem
left join BOS_INV_Product on BOS_SD_FDoProductDepositBonusItem.szProductId = BOS_INV_Product.szProductId

WHERE 
BOS_SD_FDoProductDepositBonusItem.szDoId = p_szDoId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetFDoProductDepositBonusItem_013(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FDoProductDepositBonusItem.szDoId,
BOS_SD_FDoProductDepositBonusItem.shItemNumber,

BOS_SD_FDoProductDepositBonusItem.szProductId,

BOS_INV_Product.szName as szProductName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,

BOS_SD_FDoProductDepositBonusItem.decQty,
BOS_SD_FDoProductDepositBonusItem.szUomId,
BOS_SD_FDoProductDepositBonusItem.szOrderItemTypeId,

BOS_SD_FDoProductDepositBonusItem.bGenByTotal


FROM 
BOS_SD_FDoProductDepositBonusItem
left join BOS_INV_Product on BOS_SD_FDoProductDepositBonusItem.szProductId = BOS_INV_Product.szProductId

WHERE 
BOS_SD_FDoProductDepositBonusItem.szDoId = p_szDoId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetFDoProductDepositBonusItemBonusSource(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId,

FROM 
BOS_SD_FDoProductDepositBonusItemBonusSource
WHERE 
szFDoId = p_szFDoId and shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetFDoProductDepositBonusItemBonusSource_013(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId,

FROM 
BOS_SD_FDoProductDepositBonusItemBonusSource
WHERE 
szFDoId = p_szFDoId and shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetListOfFCallOfFDo(
p_szFDoId BOS_DT_szId,
p_szCallType BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
FCall.szFCallId

FROM 
BOS_CRL_FCall as FCall
LEFT JOIN BOS_SD_DjrTracking as DjrTrackingLEFT JOIN BOS_SD_DjrTracking as DjrTracking;
on DjrTracking.szDjrTrackingId = FCall.szTrackingId and szCallType = p_szCallType
WHERE 
DjrTracking.szFDoId = p_szFDoId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetListOfFCallOfFDo_013(
p_szFDoId BOS_DT_szId,
p_szCallType BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
FCall.szFCallId

FROM 
BOS_CRL_FCall as FCall
LEFT JOIN BOS_SD_DjrTracking as DjrTrackingLEFT JOIN BOS_SD_DjrTracking as DjrTracking;
on DjrTracking.szDjrTrackingId = FCall.szTrackingId and szCallType = p_szCallType
WHERE 
DjrTracking.szFDoId = p_szFDoId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetListOfFDo()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDoId,
dtmDelivery,
szCustId

FROM 
BOS_SD_FDO

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetListOfFDoWhereWorkplaceAndDate(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDoId


FROM 
BOS_SD_FDo

WHERE 
szWorkplaceId Like p_szWorkplaceId And dtmDelivery >= p_dtmFrom And dtmDelivery < DateAdd(Day, 1, p_dtmTo) ;ORDER BY 
szDoId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetListOfPendingFDo(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_FDo.szDoId, 
ISNULL(BOS_SD_DjrTracking.szDjrTrackingId, '') AS szDjrTrackingId,
BOS_SD_FDo.dtmDelivery as dtmDo,
ISNULL(BOS_SD_DjrTracking.szDriverId, '') AS szDriverId,
BOS_SD_FDo.szCustId,
isnull(BOS_PI_Employee.szName,'') as szDriverNm,
isnull(BOS_AR_Customer.szName,'') as szCustNm,
BOS_SD_FDo.bApplied

from
BOS_SD_FDo
left join BOS_AR_Customer on BOS_AR_Customer.szCustId = BOS_SD_FDo.szCustId
LEFT JOIN BOS_AR_Customer AS InvCust ON InvCust.szCustId = BOS_AR_Customer.szInvoiceToCustId
--Use inner join so only DO that has tracking will be returned.
INNER JOIN BOS_SD_DjrTracking ON BOS_SD_DjrTracking.szFDoId = BOS_SD_FDo.szDoId
left join BOS_PI_Employee on BOS_PI_Employee.szEmployeeId = BOS_SD_DjrTracking.szDriverId

WHERE 
InvCust.szCustId = p_szCustId AND
BOS_SD_FDo.bApplied = 0 AND
BOS_SD_FDo.bVoid = 0

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetListOfUnAppliedFDo(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT szDoId FROM
(
SELECT 
BOS_SD_FDo.szDoId, BOS_SD_FDo.decAmount 
FROM BOS_SD_FDo
WHERE
BOS_SD_FDo.szWorkplaceId LIKE p_szWorkplaceId 
AND BOS_SD_FDo.bVoid = 0 
AND BOS_SD_FDo.bApplied = 0 
AND dtmDelivery >= p_dtmFrom 
AND dtmDelivery < dateadd(day, 1, p_dtmTo)
AND BOS_SD_FDo.szDriverId LIKE p_szOpUserId
AND (select COUNT(szdoid) from BOS_SD_FDoItem where BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId) > 0  
) AS SUMMARY
ORDER BY SUMMARY.decAmount

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_GetListOfUnAppliedFDo_013(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT szDoId FROM  
(  
SELECT   
BOS_SD_FDo.szDoId, BOS_SD_FDo.decAmount   
FROM BOS_SD_FDo  
WHERE  
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId   
AND BOS_SD_FDo.bVoid = 0   
AND BOS_SD_FDo.bApplied = 0   
AND dtmDelivery >= p_dtmFrom   
AND dtmDelivery < dateadd(day, 1, p_dtmTo)  
--AND BOS_SD_FDo.szDriverId = p_szOpUserId  
AND (select COUNT(szdoid) from BOS_SD_FDoItem where BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId) > 0    
) AS SUMMARY  
ORDER BY SUMMARY.decAmount
ELSE
SELECT szDoId FROM  
(  
SELECT   
BOS_SD_FDo.szDoId, BOS_SD_FDo.decAmount   
FROM BOS_SD_FDo  
WHERE  
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId   
AND BOS_SD_FDo.bVoid = 0   
AND BOS_SD_FDo.bApplied = 0   
AND dtmDelivery >= p_dtmFrom   
AND dtmDelivery < dateadd(day, 1, p_dtmTo)  
AND BOS_SD_FDo.szDriverId = p_szOpUserId  
AND (select COUNT(szdoid) from BOS_SD_FDoItem where BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId) > 0    
) AS SUMMARY  
ORDER BY SUMMARY.decAmount

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDO_GetSelectListOfFDoWhereManualNo(
p_szManualNo BOS_DT_szId,
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDoId

FROM 
BOS_SD_FDo
WHERE 
szManualNo = p_szManualNo AND szDoId <> p_szDoId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDO_GetSelectListOfFDoWhereManualNo_013(
p_szManualNo BOS_DT_szId,
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDoId

FROM 
BOS_SD_FDo
WHERE 
szManualNo = p_szManualNo AND szDoId <> p_szDoId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_IsFDoExist(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDoId

FROM 
BOS_SD_FDO
WHERE 
szDoId = p_szDoId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_IsFDoExist_013(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDoId

FROM 
BOS_SD_FDO
WHERE 
szDoId = p_szDoId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_LockFDo(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDO
SET 
dtmPrice = dtmPrice
WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_LockFDo_013(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDO
SET 
dtmPrice = dtmPrice
WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_MarkFDoDelivered(
p_szFDoId BOS_DT_szId,
p_szFDnId BOS_DT_szId,
p_szFDnDriverId BOS_DT_szId,
p_szFDnVehicleId BOS_DT_szId,
p_szFDnCarrierId BOS_DT_szId,
p_szFDnDriverName BOS_DT_szId,
p_szFDnVehicleNumber BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDO
SET 
szFDnId = p_szFDnId,
szDriverId = p_szFDnDriverId,
szVehicleId = p_szFDnVehicleId,
szCarrierId = p_szFDnCarrierId,
szDriverName = p_szFDnDriverName,
szVehicleNumber = p_szFDnVehicleNumber

WHERE 
szDoId = p_szFDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_MarkFDoDelivered_013(
p_szFDoId BOS_DT_szId,
p_szFDnId BOS_DT_szId,
p_szFDnDriverId BOS_DT_szId,
p_szFDnVehicleId BOS_DT_szId,
p_szFDnCarrierId BOS_DT_szId,
p_szFDnDriverName BOS_DT_szId,
p_szFDnVehicleNumber BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDO
SET 
szFDnId = p_szFDnId,
szDriverId = p_szFDnDriverId,
szVehicleId = p_szFDnVehicleId,
szCarrierId = p_szFDnCarrierId,
szDriverName = p_szFDnDriverName,
szVehicleNumber = p_szFDnVehicleNumber

WHERE 
szDoId = p_szFDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_MarkFDoFirstInvoiced(
p_szDoId BOS_DT_szId,
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDO
SET 
szFirstFInvoiceId = p_szFInvoiceId
WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_MarkFDoFirstInvoiced_013(
p_szDoId BOS_DT_szId,
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDO
SET 
szFirstFInvoiceId = p_szFInvoiceId
WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_MarkFDoInvoiced(
p_szDoId BOS_DT_szId,
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDO
SET 
szFInvoiceId = p_szFInvoiceId
WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_MarkFDoInvoiced_013(
p_szDoId BOS_DT_szId,
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDO
SET 
szFInvoiceId = p_szFInvoiceId
WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_UnMarkFDoInvoiced(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDO
SET 
szFInvoiceId = ''
WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_UnMarkFDoInvoiced_013(
p_szDoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDO
SET 
szFInvoiceId = ''
WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_UpdateCustIdOfFDo(
p_szDoId BOS_DT_szId,
p_szNewCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDO
SET 
szCustId = p_szNewCustId
WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_UpdateCustIdOfFDo_013(
p_szDoId BOS_DT_szId,
p_szNewCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDO
SET 
szCustId = p_szNewCustId
WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_UpdateFDo(
p_szDoId BOS_DT_szBigId,
p_szApplyNo BOS_DT_szId,
p_szFSoId BOS_DT_szId,
p_szLogisticType varchar,
p_bReturnToWarehouse smallint,
p_szReturnFDoId BOS_DT_szBigId,
p_szReturnWarehouseId BOS_DT_szId,
p_szReturnStockTypeId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szOrderTypeId BOS_DT_szId,
p_dtmDelivery timestamp,
p_dtmPrice timestamp,
p_szCustId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_decTax BOS_DT_decTax,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_decCcyRate BOS_DT_decCcyRate,
p_bDropShip bit,
p_bUseThirdPartyCarrier bit,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szHelperId BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_szSalesId BOS_DT_szId,
p_szSalesSupervisorId BOS_DT_szId,
p_szSalesSupervisorId_2 BOS_DT_szId,
p_szSalesSupervisorId_3 BOS_DT_szId,
p_szSalesDivisionId BOS_DT_szId,
p_szSalesDepartmentId BOS_DT_szId,
p_szSalesTeamId BOS_DT_szBigId,
p_szCarrierId BOS_DT_szId,
p_szVehicleNumber varchar,
p_szDriverName BOS_DT_szName,
p_szRemark BOS_DT_szMessage,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_szCustPoId BOS_DT_szId,
p_dtmCustPo timestamp,
p_szWarehouseId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_bCash bit,
p_gdCreditLimitApprovedId bytea,
p_szPaymentTermId BOS_DT_szId,
p_DeliveryszContactPerson BOS_DT_szName,
p_DeliveryszRoomNo BOS_DT_szSmallName,
p_DeliveryszFloor BOS_DT_szSmallName,
p_DeliveryszBuilding BOS_DT_szName,
p_DeliveryszAddress_1 BOS_DT_szName,
p_DeliveryszAddress_2 BOS_DT_szName,
p_DeliveryszDistrict BOS_DT_szMediumName,
p_DeliveryszCity BOS_DT_szMediumName,
p_DeliveryszZipCode BOS_DT_szSmallName,
p_DeliveryszState BOS_DT_szMediumName,
p_DeliveryszCountry BOS_DT_szMediumName,
p_DeliveryszPhoneNo_1 BOS_DT_szMediumName,
p_DeliveryszPhoneNo_2 BOS_DT_szMediumName,
p_DeliveryszFaxNo BOS_DT_szMediumName,
p_DeliveryszMobileNo BOS_DT_szMediumName,
p_DeliveryszEmail BOS_DT_szMediumName,
p_DeliveryszWebSite BOS_DT_szMediumName,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId varchar,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_szManualNo BOS_DT_szId,
p_szFCustBIId BOS_DT_szId,
p_dtmMobileTransaction timestamp,
p_decTonase numeric,
p_decCubication numeric,
p_bUploadedFromMoDis BOS_DT_bBoolean,
p_szFInvoiceId BOS_DT_szBigId,
p_szFirstFInvoiceId BOS_DT_szBigId,
p_dtmLastUpdated timestamp,
p_dtmStartVisit timestamp,
p_dtmEndVisit timestamp,
p_decVisitSpendTime BOS_DT_decAmount,
p_bScanSuccess smallint,
p_szScanFailReason BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDO
SET 
szApplyNo = p_szApplyNo,
szFSoId = p_szFSoId,

szLogisticType = p_szLogisticType,
--FDn field can not be updated.

bReturnToWarehouse = p_bReturnToWarehouse,
szReturnFDoId = p_szReturnFDoId,
szReturnWarehouseId = p_szReturnWarehouseId,
szReturnStockTypeId = p_szReturnStockTypeId,

szSalesOrgId = p_szSalesOrgId,
szOrderTypeId = p_szOrderTypeId,

dtmDelivery = p_dtmDelivery,
dtmPrice = p_dtmPrice,

szCustId = p_szCustId,
decAmount = p_decAmount,
decTax = p_decTax,
szCcyId = p_szCcyId,
szCcyRateId = p_szCcyRateId,
decCcyRate = p_decCcyRate,
bDropShip = p_bDropShip,
bUseThirdPartyCarrier = p_bUseThirdPartyCarrier,
szVehicleId = p_szVehicleId,
szDriverId = p_szDriverId,
szHelperId = p_szHelperId,
szHelperId_2 = p_szHelperId_2,
szHelperId_3 = p_szHelperId_3,

szSalesId = p_szSalesId,
szSalesSupervisorId = p_szSalesSupervisorId,
szSalesSupervisorId_2 = p_szSalesSupervisorId_2,
szSalesSupervisorId_3 = p_szSalesSupervisorId_3,
szSalesDivisionId = p_szSalesDivisionId,
szSalesDepartmentId = p_szSalesDepartmentId,
szSalesTeamId = p_szSalesTeamId,

szCarrierId = p_szCarrierId,
szVehicleNumber = p_szVehicleNumber,
szDriverName = p_szDriverName,

szRemark = p_szRemark,
szLatitude = p_szLatitude,
szLongitude = p_szLongitude,

szCustPoId = p_szCustPoId,
dtmCustPo = p_dtmCustPo,
szWarehouseId = p_szWarehouseId,
szStockTypeId = p_szStockTypeId,
bCash = p_bCash,
gdCreditLimitApprovedId = p_gdCreditLimitApprovedId,

szPaymentTermId = p_szPaymentTermId,

DeliveryszContactPerson = p_DeliveryszContactPerson,
DeliveryszRoomNo = p_DeliveryszRoomNo,
DeliveryszFloor = p_DeliveryszFloor,
DeliveryszBuilding = p_DeliveryszBuilding,
DeliveryszAddress_1 = p_DeliveryszAddress_1,
DeliveryszAddress_2 = p_DeliveryszAddress_2,
DeliveryszDistrict = p_DeliveryszDistrict,
DeliveryszCity = p_DeliveryszCity,
DeliveryszZipCode = p_DeliveryszZipCode,
DeliveryszState = p_DeliveryszState,
DeliveryszCountry = p_DeliveryszCountry,
DeliveryszPhoneNo_1 = p_DeliveryszPhoneNo_1,
DeliveryszPhoneNo_2 = p_DeliveryszPhoneNo_2,
DeliveryszFaxNo = p_DeliveryszFaxNo,
DeliveryszMobileNo = p_DeliveryszMobileNo,
DeliveryszEmail = p_DeliveryszEmail,
DeliveryszWebSite = p_DeliveryszWebSite,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId,
szManualNo = p_szManualNo,
szFCustBIId = p_szFCustBIId,
dtmMobileTransaction = p_dtmMobileTransaction,

-- Weight and Volume
decTonase = p_decTonase,
decCubication = p_decCubication,
bUploadedFromMoDis = p_bUploadedFromMoDis,

szFInvoiceId = p_szFInvoiceId,
szFirstFInvoiceId = p_szFirstFInvoiceId

, dtmLastUpdated = p_dtmLastUpdated
,  dtmStartVisit= p_dtmStartVisit,
dtmEndVisit=p_dtmEndVisit,
decVisitSpendTime=p_decVisitSpendTime,
bScanSuccess=p_bScanSuccess,
szScanFailReason=p_szScanFailReason

WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_UpdateFDo_013(
p_szDoId BOS_DT_szId,
p_szApplyNo BOS_DT_szId,
p_szFSoId BOS_DT_szId,
p_szLogisticType varchar,
p_bReturnToWarehouse smallint,
p_szReturnFDoId BOS_DT_szId,
p_szReturnWarehouseId BOS_DT_szId,
p_szReturnStockTypeId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szOrderTypeId BOS_DT_szId,
p_dtmDelivery timestamp,
p_dtmPrice timestamp,
p_szCustId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_decTax BOS_DT_decTax,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_decCcyRate BOS_DT_decCcyRate,
p_bDropShip bit,
p_bUseThirdPartyCarrier bit,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szHelperId BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_szSalesId BOS_DT_szId,
p_szSalesSupervisorId BOS_DT_szId,
p_szSalesSupervisorId_2 BOS_DT_szId,
p_szSalesSupervisorId_3 BOS_DT_szId,
p_szSalesDivisionId BOS_DT_szId,
p_szSalesDepartmentId BOS_DT_szId,
p_szSalesTeamId BOS_DT_szId,
p_szCarrierId BOS_DT_szId,
p_szVehicleNumber varchar,
p_szDriverName BOS_DT_szName,
p_szRemark BOS_DT_szMessage,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_szCustPoId BOS_DT_szId,
p_dtmCustPo timestamp,
p_szWarehouseId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_bCash bit,
p_gdCreditLimitApprovedId bytea,
p_szPaymentTermId BOS_DT_szId,
p_DeliveryszContactPerson BOS_DT_szName,
p_DeliveryszRoomNo BOS_DT_szSmallName,
p_DeliveryszFloor BOS_DT_szSmallName,
p_DeliveryszBuilding BOS_DT_szName,
p_DeliveryszAddress_1 BOS_DT_szBigDescription,
p_DeliveryszAddress_2 BOS_DT_szBigDescription,
p_DeliveryszDistrict BOS_DT_szName,
p_DeliveryszCity BOS_DT_szMediumName,
p_DeliveryszZipCode BOS_DT_szSmallName,
p_DeliveryszState BOS_DT_szMediumName,
p_DeliveryszCountry BOS_DT_szMediumName,
p_DeliveryszPhoneNo_1 BOS_DT_szMediumName,
p_DeliveryszPhoneNo_2 BOS_DT_szMediumName,
p_DeliveryszFaxNo BOS_DT_szMediumName,
p_DeliveryszMobileNo BOS_DT_szMediumName,
p_DeliveryszEmail BOS_DT_szMediumName,
p_DeliveryszWebSite BOS_DT_szMediumName,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId varchar,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_szManualNo BOS_DT_szId,
p_szFCustBIId BOS_DT_szId,
p_dtmMobileTransaction timestamp,
p_decTonase numeric,
p_decCubication numeric,
p_bUploadedFromMoDis BOS_DT_bBoolean,
p_szFInvoiceId BOS_DT_szId,
p_szFirstFInvoiceId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_dtmStartVisit timestamp,
p_dtmEndVisit timestamp,
p_decVisitSpendTime BOS_DT_decAmount,
p_bScanSuccess smallint,
p_szScanFailReason BOS_DT_szId,
p_szBarcodeScanFailReason BOS_DT_szId,
p_bScanBarcodeSuccess smallint,
p_decJourneySpendTime BOS_DT_decAmount,
p_AdcId BOS_DT_szId,
p_szCustReceiptNo BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDO
SET 
szApplyNo = p_szApplyNo,
szFSoId = p_szFSoId,

szLogisticType = p_szLogisticType,
--FDn field can not be updated.

bReturnToWarehouse = p_bReturnToWarehouse,
szReturnFDoId = p_szReturnFDoId,
szReturnWarehouseId = p_szReturnWarehouseId,
szReturnStockTypeId = p_szReturnStockTypeId,

szSalesOrgId = p_szSalesOrgId,
szOrderTypeId = p_szOrderTypeId,

dtmDelivery = p_dtmDelivery,
dtmPrice = p_dtmPrice,

szCustId = p_szCustId,
decAmount = p_decAmount,
decTax = p_decTax,
szCcyId = p_szCcyId,
szCcyRateId = p_szCcyRateId,
decCcyRate = p_decCcyRate,
bDropShip = p_bDropShip,
bUseThirdPartyCarrier = p_bUseThirdPartyCarrier,
szVehicleId = p_szVehicleId,
szDriverId = p_szDriverId,
szHelperId = p_szHelperId,
szHelperId_2 = p_szHelperId_2,
szHelperId_3 = p_szHelperId_3,

szSalesId = p_szSalesId,
szSalesSupervisorId = p_szSalesSupervisorId,
szSalesSupervisorId_2 = p_szSalesSupervisorId_2,
szSalesSupervisorId_3 = p_szSalesSupervisorId_3,
szSalesDivisionId = p_szSalesDivisionId,
szSalesDepartmentId = p_szSalesDepartmentId,
szSalesTeamId = p_szSalesTeamId,

szCarrierId = p_szCarrierId,
szVehicleNumber = p_szVehicleNumber,
szDriverName = p_szDriverName,

szRemark = p_szRemark,
szLatitude = p_szLatitude,
szLongitude = p_szLongitude,

szCustPoId = p_szCustPoId,
dtmCustPo = p_dtmCustPo,
szWarehouseId = p_szWarehouseId,
szStockTypeId = p_szStockTypeId,
bCash = p_bCash,
gdCreditLimitApprovedId = p_gdCreditLimitApprovedId,

szPaymentTermId = p_szPaymentTermId,

DeliveryszContactPerson = p_DeliveryszContactPerson,
DeliveryszRoomNo = p_DeliveryszRoomNo,
DeliveryszFloor = p_DeliveryszFloor,
DeliveryszBuilding = p_DeliveryszBuilding,
DeliveryszAddress_1 = p_DeliveryszAddress_1,
DeliveryszAddress_2 = p_DeliveryszAddress_2,
DeliveryszDistrict = p_DeliveryszDistrict,
DeliveryszCity = p_DeliveryszCity,
DeliveryszZipCode = p_DeliveryszZipCode,
DeliveryszState = p_DeliveryszState,
DeliveryszCountry = p_DeliveryszCountry,
DeliveryszPhoneNo_1 = p_DeliveryszPhoneNo_1,
DeliveryszPhoneNo_2 = p_DeliveryszPhoneNo_2,
DeliveryszFaxNo = p_DeliveryszFaxNo,
DeliveryszMobileNo = p_DeliveryszMobileNo,
DeliveryszEmail = p_DeliveryszEmail,
DeliveryszWebSite = p_DeliveryszWebSite,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId,
szManualNo = p_szManualNo,
szFCustBIId = p_szFCustBIId,
dtmMobileTransaction = p_dtmMobileTransaction,

-- Weight and Volume
decTonase = p_decTonase,
decCubication = p_decCubication,
bUploadedFromMoDis = p_bUploadedFromMoDis,

szFInvoiceId = p_szFInvoiceId,
szFirstFInvoiceId = p_szFirstFInvoiceId,

dtmLastUpdated = p_dtmLastUpdated,
dtmStartVisit= p_dtmStartVisit,
dtmEndVisit=p_dtmEndVisit,
decVisitSpendTime=p_decVisitSpendTime ,
bScanSuccess=p_bScanSuccess,
szScanFailReason=p_szScanFailReason,
szBarcodeScanFailReason=p_szBarcodeScanFailReason,
bScanBarcodeSuccess=p_bScanBarcodeSuccess,
decJourneySpendTime=p_decJourneySpendTime,
AdcId=p_AdcId,
szCustReceiptNo=p_szCustReceiptNo
WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_UpdateFDo_015(
p_szDoId BOS_DT_szId,
p_szApplyNo BOS_DT_szId,
p_szFSoId BOS_DT_szId,
p_szLogisticType varchar,
p_bReturnToWarehouse smallint,
p_szReturnFDoId BOS_DT_szId,
p_szReturnWarehouseId BOS_DT_szId,
p_szReturnStockTypeId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szOrderTypeId BOS_DT_szId,
p_dtmDelivery timestamp,
p_dtmPrice timestamp,
p_szCustId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_decTax BOS_DT_decTax,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_decCcyRate BOS_DT_decCcyRate,
p_bDropShip bit,
p_bUseThirdPartyCarrier bit,
p_szVehicleId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szHelperId BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_szSalesId BOS_DT_szId,
p_szSalesSupervisorId BOS_DT_szId,
p_szSalesSupervisorId_2 BOS_DT_szId,
p_szSalesSupervisorId_3 BOS_DT_szId,
p_szSalesDivisionId BOS_DT_szId,
p_szSalesDepartmentId BOS_DT_szId,
p_szSalesTeamId BOS_DT_szId,
p_szCarrierId BOS_DT_szId,
p_szVehicleNumber varchar,
p_szDriverName BOS_DT_szName,
p_szRemark BOS_DT_szMessage,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_szCustPoId BOS_DT_szId,
p_dtmCustPo timestamp,
p_szWarehouseId BOS_DT_szId,
p_szStockTypeId BOS_DT_szId,
p_bCash bit,
p_gdCreditLimitApprovedId bytea,
p_szPaymentTermId BOS_DT_szId,
p_DeliveryszContactPerson BOS_DT_szName,
p_DeliveryszRoomNo BOS_DT_szSmallName,
p_DeliveryszFloor BOS_DT_szSmallName,
p_DeliveryszBuilding BOS_DT_szName,
p_DeliveryszAddress_1 BOS_DT_szBigDescription,
p_DeliveryszAddress_2 BOS_DT_szBigDescription,
p_DeliveryszDistrict BOS_DT_szName,
p_DeliveryszCity BOS_DT_szMediumName,
p_DeliveryszZipCode BOS_DT_szSmallName,
p_DeliveryszState BOS_DT_szMediumName,
p_DeliveryszCountry BOS_DT_szMediumName,
p_DeliveryszPhoneNo_1 BOS_DT_szMediumName,
p_DeliveryszPhoneNo_2 BOS_DT_szMediumName,
p_DeliveryszFaxNo BOS_DT_szMediumName,
p_DeliveryszMobileNo BOS_DT_szMediumName,
p_DeliveryszEmail BOS_DT_szMediumName,
p_DeliveryszWebSite BOS_DT_szMediumName,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId varchar,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_szManualNo BOS_DT_szId,
p_szFCustBIId BOS_DT_szId,
p_dtmMobileTransaction timestamp,
p_decTonase numeric,
p_decCubication numeric,
p_bUploadedFromMoDis BOS_DT_bBoolean,
p_szFInvoiceId BOS_DT_szId,
p_szFirstFInvoiceId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_dtmStartVisit timestamp,
p_dtmEndVisit timestamp,
p_decVisitSpendTime BOS_DT_decAmount,
p_bScanSuccess smallint,
p_szScanFailReason BOS_DT_szId,
p_szBarcodeScanFailReason BOS_DT_szId,
p_bScanBarcodeSuccess smallint,
p_decJourneySpendTime BOS_DT_decAmount,
p_AdcId BOS_DT_szId,
p_szCustReceiptNo BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDO
SET 
szApplyNo = p_szApplyNo,
szFSoId = p_szFSoId,

szLogisticType = p_szLogisticType,
--FDn field can not be updated.

bReturnToWarehouse = p_bReturnToWarehouse,
szReturnFDoId = p_szReturnFDoId,
szReturnWarehouseId = p_szReturnWarehouseId,
szReturnStockTypeId = p_szReturnStockTypeId,

szSalesOrgId = p_szSalesOrgId,
szOrderTypeId = p_szOrderTypeId,

dtmDelivery = p_dtmDelivery,
dtmPrice = p_dtmPrice,

szCustId = p_szCustId,
decAmount = p_decAmount,
decTax = p_decTax,
szCcyId = p_szCcyId,
szCcyRateId = p_szCcyRateId,
decCcyRate = p_decCcyRate,
bDropShip = p_bDropShip,
bUseThirdPartyCarrier = p_bUseThirdPartyCarrier,
szVehicleId = p_szVehicleId,
szDriverId = p_szDriverId,
szHelperId = p_szHelperId,
szHelperId_2 = p_szHelperId_2,
szHelperId_3 = p_szHelperId_3,

szSalesId = p_szSalesId,
szSalesSupervisorId = p_szSalesSupervisorId,
szSalesSupervisorId_2 = p_szSalesSupervisorId_2,
szSalesSupervisorId_3 = p_szSalesSupervisorId_3,
szSalesDivisionId = p_szSalesDivisionId,
szSalesDepartmentId = p_szSalesDepartmentId,
szSalesTeamId = p_szSalesTeamId,

szCarrierId = p_szCarrierId,
szVehicleNumber = p_szVehicleNumber,
szDriverName = p_szDriverName,

szRemark = p_szRemark,
szLatitude = p_szLatitude,
szLongitude = p_szLongitude,

szCustPoId = p_szCustPoId,
dtmCustPo = p_dtmCustPo,
szWarehouseId = p_szWarehouseId,
szStockTypeId = p_szStockTypeId,
bCash = p_bCash,
gdCreditLimitApprovedId = p_gdCreditLimitApprovedId,

szPaymentTermId = p_szPaymentTermId,

DeliveryszContactPerson = p_DeliveryszContactPerson,
DeliveryszRoomNo = p_DeliveryszRoomNo,
DeliveryszFloor = p_DeliveryszFloor,
DeliveryszBuilding = p_DeliveryszBuilding,
DeliveryszAddress_1 = p_DeliveryszAddress_1,
DeliveryszAddress_2 = p_DeliveryszAddress_2,
DeliveryszDistrict = p_DeliveryszDistrict,
DeliveryszCity = p_DeliveryszCity,
DeliveryszZipCode = p_DeliveryszZipCode,
DeliveryszState = p_DeliveryszState,
DeliveryszCountry = p_DeliveryszCountry,
DeliveryszPhoneNo_1 = p_DeliveryszPhoneNo_1,
DeliveryszPhoneNo_2 = p_DeliveryszPhoneNo_2,
DeliveryszFaxNo = p_DeliveryszFaxNo,
DeliveryszMobileNo = p_DeliveryszMobileNo,
DeliveryszEmail = p_DeliveryszEmail,
DeliveryszWebSite = p_DeliveryszWebSite,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId,
szManualNo = p_szManualNo,
szFCustBIId = p_szFCustBIId,
dtmMobileTransaction = p_dtmMobileTransaction,

-- Weight and Volume
decTonase = p_decTonase,
decCubication = p_decCubication,
bUploadedFromMoDis = p_bUploadedFromMoDis,

szFInvoiceId = p_szFInvoiceId,
szFirstFInvoiceId = p_szFirstFInvoiceId,

dtmLastUpdated = p_dtmLastUpdated,
dtmStartVisit= p_dtmStartVisit,
dtmEndVisit=p_dtmEndVisit,
decVisitSpendTime=p_decVisitSpendTime ,
bScanSuccess=p_bScanSuccess,
szScanFailReason=p_szScanFailReason,
szBarcodeScanFailReason=p_szBarcodeScanFailReason,
bScanBarcodeSuccess=p_bScanBarcodeSuccess,
decJourneySpendTime=p_decJourneySpendTime,
AdcId=p_AdcId,
szCustReceiptNo=p_szCustReceiptNo
WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_UpdateFDoItem(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_dtmPriceDate timestamp,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_decCOGS BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId,
p_decTonase numeric,
p_decCubication numeric,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDOItem
SET 
szOrderItemTypeId = p_szOrderItemTypeId,
szProductId = p_szProductId,

szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
decDiscProcent = p_decDiscProcent,

dtmPriceDate = p_dtmPriceDate,

decQty = p_decQty,
decUomQty = p_decUomQty,
decCOGS = p_decCOGS,

szUomId = p_szUomId,
decPrice = p_decPrice,
decDiscount = p_decDiscount,
bTaxable = p_bTaxable,
decTax = p_decTax,
decAmount = p_decAmount,
decDPP = p_decDPP,
szPaymentType = p_szPaymentType,
szPrincipalDiscRefId = p_szPrincipalDiscRefId,

-- for Cubication and Tonase
decTonase = p_decTonase,
decCubication = p_decCubication,

szParentId = p_szParentId

WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_UpdateFDoItem_013(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_dtmPriceDate timestamp,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_decCOGS BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId,
p_decTonase numeric,
p_decCubication numeric,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDOItem
SET 
szOrderItemTypeId = p_szOrderItemTypeId,
szProductId = p_szProductId,

szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
decDiscProcent = p_decDiscProcent,

dtmPriceDate = p_dtmPriceDate,

decQty = p_decQty,
decUomQty = p_decUomQty,
decCOGS = p_decCOGS,

szUomId = p_szUomId,
decPrice = p_decPrice,
decDiscount = p_decDiscount,
bTaxable = p_bTaxable,
decTax = p_decTax,
decAmount = p_decAmount,
decDPP = p_decDPP,
szPaymentType = p_szPaymentType,
szPrincipalDiscRefId = p_szPrincipalDiscRefId,

-- for Cubication and Tonase
decTonase = p_decTonase,
decCubication = p_decCubication,

szParentId = p_szParentId

WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_UpdateFDoItem_014(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_dtmPriceDate timestamp,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_decCOGS BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId,
p_decTonase numeric,
p_decCubication numeric,
p_szParentId BOS_DT_szId,
p_szDistProductId BOS_DT_szId,
p_decDistQty BOS_DT_decAmount,
p_decDistPrice BOS_DT_decPrice)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDOItem
SET 
szOrderItemTypeId = p_szOrderItemTypeId,
szProductId = p_szProductId,

szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
decDiscProcent = p_decDiscProcent,

dtmPriceDate = p_dtmPriceDate,

decQty = p_decQty,
decUomQty = p_decUomQty,
decCOGS = p_decCOGS,

szUomId = p_szUomId,
decPrice = p_decPrice,
decDiscount = p_decDiscount,
bTaxable = p_bTaxable,
decTax = p_decTax,
decAmount = p_decAmount,
decDPP = p_decDPP,
szPaymentType = p_szPaymentType,
szPrincipalDiscRefId = p_szPrincipalDiscRefId,

-- for Cubication and Tonase
decTonase = p_decTonase,
decCubication = p_decCubication,

szParentId = p_szParentId,

szDistProductId = p_szDistProductId,
decDistQty = p_decDistQty,
decDistPrice = p_decDistPrice

WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_UpdateFDoItem_015(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_dtmPriceDate timestamp,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_decCOGS BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId,
p_decTonase numeric,
p_decCubication numeric,
p_szParentId BOS_DT_szId,
p_szDistProductId BOS_DT_szId,
p_decDistQty BOS_DT_decAmount,
p_decDistPrice BOS_DT_decPrice,
p_szBudgetId BOS_DT_szId,
p_decPrincipalCostAmount BOS_DT_decAmount,
p_decPrincipalCostQty BOS_DT_decAmount,
p_bBudgetTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDOItem
SET 
szOrderItemTypeId = p_szOrderItemTypeId,
szProductId = p_szProductId,

szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
decDiscProcent = p_decDiscProcent,

dtmPriceDate = p_dtmPriceDate,

decQty = p_decQty,
decUomQty = p_decUomQty,
decCOGS = p_decCOGS,

szUomId = p_szUomId,
decPrice = p_decPrice,
decDiscount = p_decDiscount,
bTaxable = p_bTaxable,
decTax = p_decTax,
decAmount = p_decAmount,
decDPP = p_decDPP,
szPaymentType = p_szPaymentType,
szPrincipalDiscRefId = p_szPrincipalDiscRefId,

-- for Cubication and Tonase
decTonase = p_decTonase,
decCubication = p_decCubication,

szParentId = p_szParentId,

szDistProductId = p_szDistProductId,
decDistQty = p_decDistQty,
decDistPrice = p_decDistPrice,

szBudgetId = p_szBudgetId,
decPrincipalCostAmount = p_decPrincipalCostAmount,
decPrincipalCostQty = p_decPrincipalCostQty,
bBudgetTransferred = p_bBudgetTransferred

WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_UpdateFDoItemBonusSource(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_decBonusAmount BOS_DT_decAmount,
p_decBonusQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDoItemBonusSource
SET 
decBonusAmount = p_decBonusAmount,
decBonusQty = p_decBonusQty

WHERE 
szFDoId = p_szFDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_UpdateFDoItemBonusSource_013(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_decBonusAmount BOS_DT_decAmount,
p_decBonusQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDoItemBonusSource
SET 
decBonusAmount = p_decBonusAmount,
decBonusQty = p_decBonusQty

WHERE 
szFDoId = p_szFDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_UpdateFDoItemLotQty(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szLotId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDoItemLotQty
SET 
decQty = p_decQty
WHERE 
szFDoId = p_szFDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_UpdateFDoItemLotQty_013(
p_szFDoId BOS_DT_szId,
p_shItemNumber smallint,
p_szLotId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDoItemLotQty
SET 
decQty = p_decQty
WHERE 
szFDoId = p_szFDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_UpdateFDoItemSN(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint,
p_shItemSnNumber smallint,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDOItemSN
SET 
szProductSN = p_szProductSN

WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDo_UpdateFDoItemSN_013(
p_szDoId BOS_DT_szId,
p_shItemNumber smallint,
p_shItemSnNumber smallint,
p_szProductSn BOS_DT_szSN)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDOItemSN
SET 
szProductSN = p_szProductSN

WHERE 
szDoId = p_szDoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDoCorrection_CreateFDoCorrection(
p_szFDoCorrectionId BOS_DT_szId,
p_dtmDate timestamp,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDoCorrection
(
szFDoCorrectionId,
dtmDate,
szDescription,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
)
VALUES
(
p_szFDoCorrectionId,
p_dtmDate,
p_szDescription,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDoCorrection_CreateFDoCorrectionItem(
p_szFDoCorrectionId BOS_DT_szId,
p_shItemNumber smallint,
p_szFDoId BOS_DT_szId,
p_szFDoCustId BOS_DT_szId,
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDoCorrectionItem
(
szFDoCorrectionId,
shItemNumber,
szFDoId,
szFDoCustId,
szCustId
)
VALUES
(
p_szFDoCorrectionId,
p_shItemNumber,
p_szFDoId,
p_szFDoCustId,
p_szCustId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDoCorrection_CreateFDoCorrectionItem_013(
p_szFDoCorrectionId BOS_DT_szId,
p_shItemNumber smallint,
p_szFDoId BOS_DT_szId,
p_szFDoCustId BOS_DT_szId,
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDoCorrectionItem  
(
szFDoCorrectionId,
shItemNumber,
szFDoId,
szFDoCustId,
szCustId
)
VALUES
(
p_szFDoCorrectionId,
p_shItemNumber,
p_szFDoId,
p_szFDoCustId,
p_szCustId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDoCorrection_DeleteFDoCorrection(
p_szFDoCorrectionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FDoCorrection
WHERE
szFDoCorrectionId = p_szFDoCorrectionId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDoCorrection_DeleteFDoCorrectionItem(
p_szFDoCorrectionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FDoCorrectionItem
WHERE
szFDoCorrectionId = p_szFDoCorrectionId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDoCorrection_GetFDoCorrection(
p_szFDoCorrectionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
FDoCorr.szFDoCorrectionId,
FDoCorr.dtmDate,
FDoCorr.szDescription,

FDoCorr.bResultFrTransfer,
FDoCorr.bVoid,
BOS_GEN_Approved.bApproved,
FDoCorr.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
FDoCorr.btPrintedCount,
FDoCorr.bTransferred,
FDoCorr.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
FDoCorr.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
FDoCorr.szTaxEntityId,
FDoCorr.bNeedApproval,
FDoCorr.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
FDoCorr.dtmCreated,
FDoCorr.bSystemCreated,
FDoCorr.dtmLastUpdated,
FDoCorr.bAlreadyTransferred
FROM
BOS_SD_FDoCorrection as FDoCorr 
LEFT JOIN BOS_GEN_Approved ON FDoCorr.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON FDoCorr.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = FDoCorr.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = FDoCorr.szWorkplaceId
WHERE
FDoCorr.szFDoCorrectionId = p_szFDoCorrectionId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDoCorrection_GetFDoCorrectionItem(
p_szFDoCorrectionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT

BOS_SD_FDoCorrectionItem.shItemNumber,
BOS_SD_FDoCorrectionItem.szFDoId,
BOS_SD_FDoCorrectionItem.szFDoCustId,
CustFDo.szName as szFDoCustNm,
BOS_SD_FDoCorrectionItem.szCustId,
Cust.szName as szCustNm

FROM
BOS_SD_FDoCorrectionItem
LEFT JOIN BOS_AR_Customer as CustFDo ON CustFDo.szCustId = BOS_SD_FDoCorrectionItem.szFDoCustId
LEFT JOIN BOS_AR_Customer as Cust ON Cust.szCustId = BOS_SD_FDoCorrectionItem.szCustId
WHERE
szFDoCorrectionId = p_szFDoCorrectionId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDoCorrection_GetListOfFDoCorrection()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFDoCorrectionId,
szDescription,
dtmDate

FROM 
BOS_SD_FDoCorrection

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDoCorrection_IsFDoCorrectionExist(
p_szFDoCorrectionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFDoCorrectionId

FROM 
BOS_SD_FDoCorrection
WHERE 
szFDoCorrectionId = p_szFDoCorrectionId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDoCorrection_LockFDoCorrection(
p_szFDoCorrectionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDoCorrection
SET 
dtmDate = dtmDate
WHERE 
szFDoCorrectionId = p_szFDoCorrectionId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDoCorrection_MarkFDoCorrectionApplied(
p_szFDoCorrectionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDoCorrection
SET 
bApplied = 1
WHERE 
szFDoCorrectionId = p_szFDoCorrectionId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDoCorrection_MarkFDoCorrectionVoid(
p_szFDoCorrectionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDoCorrection
SET 
bVoid = 1
WHERE 
szFDoCorrectionId = p_szFDoCorrectionId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDoCorrection_UpdateFDoCorrection(
p_szFDoCorrectionId BOS_DT_szId,
p_dtmDate timestamp,
p_szDescription BOS_DT_szDescription,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDoCorrection
SET 
dtmDate = p_dtmDate,
szDescription = p_szDescription,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId
WHERE 
szFDoCorrectionId = p_szFDoCorrectionId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDOPrintingType_CreateFDOPrintingType(
p_szFDOPrintingTypeId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szProductDefault varchar,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDOPrintingType
(
szFDOPrintingTypeId,
szDescription,
szProductDefault,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFDOPrintingTypeId,
p_szDescription,
p_szProductDefault,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDOPrintingType_CreateFDOPrintingType_014(
p_szFDOPrintingTypeId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szProductDefault varchar,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FDOPrintingType
(
szFDOPrintingTypeId,
szDescription,
szProductDefault,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFDOPrintingTypeId,
p_szDescription,
p_szProductDefault,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDOPrintingType_DeleteFDOPrintingType(
p_szFDOPrintingTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 From BOS_SD_FDOPrintingType
WHERE
 szFDOPrintingTypeId = p_szFDOPrintingTypeId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDOPrintingType_GetFDOPrintingType(
p_szFDOPrintingTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FDOPrintingType.szDescription,
BOS_SD_FDOPrintingType.szProductDefault,
BOS_INV_Product.szName AS szDefaultProductNm_J,
BOS_SD_FDOPrintingType.dtmLastUpdated,
BOS_SD_FDOPrintingType.bAlreadyTransferred

FROM 
BOS_SD_FDOPrintingType
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDOPrintingType.szProductDefaultLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDOPrintingType.szProductDefault;
WHERE 
szFDOPrintingTypeId = p_szFDOPrintingTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDOPrintingType_GetFDOPrintingType_014(
p_szFDOPrintingTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FDOPrintingType.szDescription,
BOS_SD_FDOPrintingType.szProductDefault,
BOS_INV_Product.szName AS szDefaultProductNm_J,
BOS_SD_FDOPrintingType.dtmLastUpdated,
BOS_SD_FDOPrintingType.bAlreadyTransferred

FROM 
BOS_SD_FDOPrintingType
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDOPrintingType.szProductDefaultLEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDOPrintingType.szProductDefault;
WHERE 
szFDOPrintingTypeId = p_szFDOPrintingTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDOPrintingType_GetListOfFDOPrintingType()
RETURNS void AS
$BODY$
BEGIN
SELECT 
Select szFDOPrintingTypeId, szDescription

FROM 
BOS_SD_FDOPrintingType

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDOPrintingType_IsFDOPrintingTypeExist(
p_szFDOPrintingTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFDOPrintingTypeId 

FROM 
BOS_SD_FDOPrintingType 
WHERE 
 szFDOPrintingTypeId = p_szFDOPrintingTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDOPrintingType_LockFDOPrintingType(
p_szFDOPrintingTypeId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDOPrintingType
SET 
 szDescription = szDescription
WHERE 
 szFDOPrintingTypeId = p_szFDOPrintingTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FDOPrintingType_UpdateFDOPrintingType(
p_szFDOPrintingTypeId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szProductDefault varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FDOPrintingType
SET 
szDescription = p_szDescription,
szProductDefault=p_szProductDefault
WHERE 
 szFDOPrintingTypeId = p_szFDOPrintingTypeId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvHandOver_CreateFInvHandOver(
p_szFInvHandOverId BOS_DT_szId,
p_dtmHandOver timestamp,
p_szFrOpUserId BOS_DT_szId,
p_szToOpUserId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvHandOver
(
szFInvHandOverId,
dtmHandOver,
szFrOpUserId,
szToOpUserId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFInvHandOverId,
p_dtmHandOver,
p_szFrOpUserId,
p_szToOpUserId ,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvHandOver_CreateFInvHandOverItem(
p_szFInvHandOverId BOS_DT_szId,
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvHandOverItem
(
szFInvHandOverId,
szFInvoiceId
)
VALUES
(
p_szFInvHandOverId,
p_szFInvoiceId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvHandOver_CreateFInvHandOverItem_013(
p_szFInvHandOverId BOS_DT_szId,
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvHandOverItem
(
szFInvHandOverId,
szFInvoiceId
)
VALUES
(
p_szFInvHandOverId,
p_szFInvoiceId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvHandOver_DeleteFInvHandOver(
p_szFInvHandOverId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FInvHandOver
WHERE
szFInvHandOverId = p_szFInvHandOverId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvHandOver_DeleteFInvHandOverItem(
p_szFInvHandOverId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FInvHandOverItem
WHERE
szFInvHandOverId = p_szFInvHandOverId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvHandOver_GetFInvHandOver(
p_szFInvHandOverId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
Select
BOS_SD_FInvHandOver.dtmHandOver,
BOS_SD_FInvHandOver.szFrOpUserId,
FR_EMP.szName AS szFrOpUserNm,
BOS_SD_FInvHandOver.szToOpUserId,
TO_EMP.szName AS szToOpUserNm,

BOS_SD_FInvHandOver.bResultFrTransfer,
BOS_SD_FInvHandOver.bVoid,
BOS_GEN_Approved.bApproved,
BOS_SD_FInvHandOver.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_SD_FInvHandOver.btPrintedCount,
BOS_SD_FInvHandOver.bTransferred,
BOS_SD_FInvHandOver.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_SD_FInvHandOver.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_SD_FInvHandOver.szTaxEntityId,
BOS_SD_FInvHandOver.bNeedApproval,
BOS_SD_FInvHandOver.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_SD_FInvHandOver.dtmCreated,
BOS_SD_FInvHandOver.bSystemCreated,
BOS_SD_FInvHandOver.szUserId,
BOS_SM_User.szName AS szUserNm_J,

BOS_SD_FInvHandOver.dtmLastUpdated,
BOS_SD_FInvHandOver.bAlreadyTransferred
From
BOS_SD_FInvHandOver
LEFT JOIN BOS_GEN_Approved ON BOS_SD_FInvHandOver.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FInvHandOver.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FInvHandOver.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FInvHandOver.szWorkplaceId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FInvHandOver.szUserId
LEFT JOIN BOS_PI_Employee AS FR_EMP ON FR_EMP.szEmployeeId = BOS_SD_FInvHandOver.szFrOpUserId
LEFT JOIN BOS_PI_Employee AS TO_EMP ON TO_EMP.szEmployeeId = BOS_SD_FInvHandOver.szToOpUserId
Where
BOS_SD_FInvHandOver.szFInvHandOverId = p_szFInvHandOverId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvHandOver_GetFInvHandOverItem(
p_szFInvHandOverId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
Select
BOS_SD_FInvHandOverItem.szFInvoiceId,
BOS_AR_Customer.szCustId,
BOS_AR_Customer.szName AS szCustNm,
BOS_AR_ArTrans.decAmount,
BOS_AR_ArTrans.decRemain,
BOS_CU_Currency.szAmountFormat,
BOS_SD_FInvoice.szKeptByOpUserId,
BOS_PI_Employee.szName AS szKeptByOpUserNm,
BOS_SD_FInvoice.szLastFInvHandOverId

From
BOS_SD_FInvHandOverItem 
LEFT JOIN BOS_SD_FInvoice ON BOS_SD_FInvoice.szFInvoiceId = BOS_SD_FInvHandOverItem.szFInvoiceId
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_FInvoice.szCustId
LEFT JOIN BOS_AR_ArTrans  ON BOS_AR_ArTrans.szDocId = BOS_SD_FInvHandOverItem.szFInvoiceId And BOS_AR_ArTrans.szTrnId = 'FInv'
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FInvoice.szCcyId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FInvoice.szKeptByOpUserId
Where
BOS_SD_FInvHandOverItem.szFInvHandOverId = p_szFInvHandOverId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvHandOver_IsFInvHandOverExist(
p_szFInvHandOverId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFInvHandOverId

FROM 
BOS_SD_FInvHandOver
WHERE 
szFInvHandOverId = p_szFInvHandOverId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvHandOver_LockFInvHandOver(
p_szFInvHandOverId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvHandOver
SET 
dtmHandOver = dtmHandOver
WHERE 
szFInvHandOverId = p_szFInvHandOverId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvHandOver_MarkFInvHandOverApplied(
p_szFInvHandOverId BOS_DT_szId,
p_bApplied bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvHandOver
SET 
bApplied = p_bApplied
WHERE 
szFInvHandOverId = p_szFInvHandOverId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvHandOver_UpdateFInvHandOver(
p_szFInvHandOverId BOS_DT_szId,
p_dtmHandOver timestamp,
p_szFrOpUserId BOS_DT_szId,
p_szToOpUserId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvHandOver
SET 
dtmHandOver = p_dtmHandOver,
szFrOpUserId = p_szFrOpUserId,
szToOpUserId = p_szToOpUserId,
bVoid = p_bVoid,
bApplied = p_bApplied,
--It is better to use these fields as the information of its last updated (or applied), rather than its data creation.
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
szUserId = p_szUserId,
dtmCreated = p_dtmCreated

WHERE 
szFInvHandOverId = p_szFInvHandOverId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveIn_CreateFInvMoveIn(
p_szFInvMoveInId BOS_DT_szId,
p_dtmFInvMoveIn timestamp,
p_szFInvMoveOutId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szFrOpUserId BOS_DT_szId,
p_szToOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvMoveIn
(
szFInvMoveInId,
dtmFInvMoveIn,
szFInvMoveOutId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
szFrOpUserId,
szToOpUserId
)
VALUES
(
p_szFInvMoveInId,
p_dtmFInvMoveIn,
p_szFInvMoveOutId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szFrOpUserId,
p_szToOpUserId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveIn_DeleteFInvMoveIn(
p_szFInvMoveInId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FInvMoveIn
WHERE
szFInvMoveInId = p_szFInvMoveInId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveIn_GetFInvMoveIn(
p_szFInvMoveInId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

Select
BOS_SD_FInvMoveIn.dtmFInvMoveIn,
BOS_SD_FInvMoveIn.szFInvMoveOutId,
BOS_SD_FInvMoveOut.szWorkplaceId AS szFrWorkplaceId,
FR_WP.szName AS szFrWorkplaceNm,

BOS_SD_FInvMoveIn.bResultFrTransfer,
BOS_SD_FInvMoveIn.bVoid,
BOS_GEN_Approved.bApproved,
BOS_SD_FInvMoveIn.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_SD_FInvMoveIn.btPrintedCount,
BOS_SD_FInvMoveIn.bTransferred,
BOS_SD_FInvMoveIn.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_SD_FInvMoveIn.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_SD_FInvMoveIn.szTaxEntityId,
BOS_SD_FInvMoveIn.bNeedApproval,
BOS_SD_FInvMoveIn.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_SD_FInvMoveIn.dtmCreated,
BOS_SD_FInvMoveIn.bSystemCreated,
BOS_SD_FInvMoveIn.szUserId,
BOS_SM_User.szName AS szUserNm_J,

BOS_SD_FInvMoveIn.dtmLastUpdated,
BOS_SD_FInvMoveIn.bAlreadyTransferred,

BOS_SD_FInvMoveIn.szFrOpUserId,
FR_EMP.szName AS szFrOpUserNm,

BOS_SD_FInvMoveIn.szToOpUserId,
TO_EMP.szName AS szToOpUserNm

From
BOS_SD_FInvMoveIn
LEFT JOIN BOS_SD_FInvMoveOut ON BOS_SD_FInvMoveOut.szFInvMoveOutId = BOS_SD_FInvMoveIn.szFInvMoveOutId
LEFT JOIN BOS_GL_Workplace AS FR_WP ON FR_WP.szWorkplaceId = BOS_SD_FInvMoveOut.szWorkplaceId
LEFT JOIN BOS_GEN_Approved ON BOS_SD_FInvMoveIn.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FInvMoveIn.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FInvMoveIn.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FInvMoveIn.szWorkplaceId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FInvMoveIn.szUserId
LEFT JOIN BOS_PI_Employee AS FR_EMP ON FR_EMP.szEmployeeId = BOS_SD_FInvMoveIn.szFrOpUserId
LEFT JOIN BOS_PI_Employee AS TO_EMP ON TO_EMP.szEmployeeId = BOS_SD_FInvMoveIn.szToOpUserId

Where
BOS_SD_FInvMoveIn.szFInvMoveInId = p_szFInvMoveInId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveIn_GetFInvMoveInItem(
p_szFInvMoveInId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

Select
BOS_SD_FInvMoveOutItem.shItemNumber,
BOS_SD_FInvMoveOutItem.szFInvoiceId,
BOS_SD_FInvoice.dtmPeriode,
BOS_SD_FInvoice.dtmCreated,
BOS_AR_Customer.szCustId,
BOS_AR_Customer.szName,
BOS_AR_ArTrans.decAmount,
BOS_AR_ArTrans.decRemain,
BOS_CU_Currency.szAmountFormat

From
BOS_SD_FInvMoveIn
--Use inner join so that when there's no item there's no item returned.
INNER JOIN BOS_SD_FInvMoveOutItem ON BOS_SD_FInvMoveOutItem.szFInvMoveOutId = BOS_SD_FInvMoveIn.szFInvMoveOutId
LEFT JOIN BOS_SD_FInvoice ON BOS_SD_FInvoice.szFInvoiceId = BOS_SD_FInvMoveOutItem.szFInvoiceId
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_FInvoice.szCustId
LEFT JOIN BOS_AR_ArTrans  ON BOS_AR_ArTrans.szDocId = BOS_SD_FInvMoveOutItem.szFInvoiceId And BOS_AR_ArTrans.szTrnId = 'FInv'
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FInvoice.szCcyId

Where
BOS_SD_FInvMoveIn.szFInvMoveInId = p_szFInvMoveInId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveIn_IsFInvMoveInExist(
p_szFInvMoveInId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFInvMoveInId

FROM 
BOS_SD_FInvMoveIn
WHERE 
szFInvMoveInId = p_szFInvMoveInId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveIn_LockFInvMoveIn(
p_szFInvMoveInId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvMoveIn
SET 
dtmFInvMoveIn = dtmFInvMoveIn
WHERE 
szFInvMoveInId = p_szFInvMoveInId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveIn_MarkFInvMoveInApplied(
p_szFInvMoveInId BOS_DT_szId,
p_bApplied bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvMoveIn
SET 
bApplied = p_bApplied
WHERE 
szFInvMoveInId = p_szFInvMoveInId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveIn_UpdateFInvMoveIn(
p_szFInvMoveInId BOS_DT_szId,
p_dtmFInvMoveIn timestamp,
p_szFInvMoveOutId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_szFrOpUserId BOS_DT_szId,
p_szToOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvMoveIn
SET 
dtmFInvMoveIn		= p_dtmFInvMoveIn,
szFInvMoveOutId	= p_szFInvMoveOutId,
bVoid			= p_bVoid,
bApplied		= p_bApplied,
--It is better to use these fields as the information of its last updated (or applied), rather than its data creation.
szCompanyId		= p_szCompanyId,
szWorkplaceId		= p_szWorkplaceId,
szTaxEntityId 		= p_szTaxEntityId,
dtmCreated		= p_dtmCreated,
szUserId		= p_szUserId,
szFrOpUserId		= p_szFrOpUserId,
szToOpUserId		= p_szToOpUserId

WHERE 
szFInvMoveInId 	= p_szFInvMoveInId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveOut_CreateFInvMoveOut(
p_szFInvMoveOutId BOS_DT_szId,
p_dtmFInvMoveOut timestamp,
p_szToWorkplaceId BOS_DT_szId,
p_dtmStartInvCreated timestamp,
p_dtmEndInvCreated timestamp,
p_szUsedByFInvMoveInId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szFrOpUserId BOS_DT_szId,
p_szToOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvMoveOut
(
szFInvMoveOutId,
dtmFInvMoveOut,
szToWorkplaceId,
dtmStartInvCreated,
dtmEndInvCreated,
szUsedByFInvMoveInId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
szFrOpUserId,
szToOpUserId
)
VALUES
(
p_szFInvMoveOutId,
p_dtmFInvMoveOut,
p_szToWorkplaceId,
p_dtmStartInvCreated ,
p_dtmEndInvCreated,
p_szUsedByFInvMoveInId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szFrOpUserId,
p_szToOpUserId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveOut_CreateFInvMoveOutItem(
p_szFInvMoveOutId BOS_DT_szId,
p_shItemNumber smallint,
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvMoveOutItem
(
szFInvMoveOutId,
shItemNumber,
szFInvoiceId
)
VALUES
(
p_szFInvMoveOutId,
p_shItemNumber,
p_szFInvoiceId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveOut_CreateFInvMoveOutItem_013(
p_szFInvMoveOutId BOS_DT_szId,
p_shItemNumber smallint,
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvMoveOutItem
(
szFInvMoveOutId,
shItemNumber,
szFInvoiceId
)
VALUES
(
p_szFInvMoveOutId,
p_shItemNumber,
p_szFInvoiceId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveOut_DeleteFInvMoveOut(
p_szFInvMoveOutId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FInvMoveOut
WHERE
szFInvMoveOutId = p_szFInvMoveOutId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveOut_DeleteFInvMoveOutItem(
p_szFInvMoveOutId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FInvMoveOutItem
WHERE
szFInvMoveOutId = p_szFInvMoveOutId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveOut_GetFInvMoveOut(
p_szFInvMoveOutId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

Select
BOS_SD_FInvMoveOut.dtmFInvMoveOut,
BOS_SD_FInvMoveOut.szToWorkPlaceId,
TO_WP.szName AS szToWorkplaceNm_J,
BOS_SD_FInvMoveOut.dtmStartInvCreated,
BOS_SD_FInvMoveOut.dtmEndInvCreated,
BOS_SD_FInvMoveOut.szUsedByFInvMoveInId,

BOS_SD_FInvMoveOut.bResultFrTransfer,
BOS_SD_FInvMoveOut.bVoid,
BOS_GEN_Approved.bApproved,
BOS_SD_FInvMoveOut.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_SD_FInvMoveOut.btPrintedCount,
BOS_SD_FInvMoveOut.bTransferred,
BOS_SD_FInvMoveOut.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_SD_FInvMoveOut.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_SD_FInvMoveOut.szTaxEntityId,
BOS_SD_FInvMoveOut.bNeedApproval,
BOS_SD_FInvMoveOut.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_SD_FInvMoveOut.dtmCreated,
BOS_SD_FInvMoveOut.bSystemCreated,
BOS_SD_FInvMoveOut.szUserId,
BOS_SM_User.szName AS szUserNm_J,

BOS_SD_FInvMoveOut.dtmLastUpdated,
BOS_SD_FInvMoveOut.bAlreadyTransferred,

BOS_SD_FInvMoveOut.szFrOpUserId,
FR_EMP.szName AS szFrOpUserNm,

BOS_SD_FInvMoveOut.szToOpUserId,
TO_EMP.szName AS szToOpUserNm

From
BOS_SD_FInvMoveOut
LEFT JOIN BOS_GEN_Approved ON BOS_SD_FInvMoveOut.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FInvMoveOut.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FInvMoveOut.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FInvMoveOut.szWorkplaceId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FInvMoveOut.szUserId
LEFT JOIN BOS_GL_Workplace AS TO_WP ON TO_WP.szWorkplaceId = BOS_SD_FInvMoveOut.szToWorkplaceId
LEFT JOIN BOS_PI_Employee AS FR_EMP ON FR_EMP.szEmployeeId = BOS_SD_FInvMoveOut.szFrOpUserId
LEFT JOIN BOS_PI_Employee AS TO_EMP ON TO_EMP.szEmployeeId = BOS_SD_FInvMoveOut.szToOpUserId

Where
BOS_SD_FInvMoveOut.szFInvMoveOutId = p_szFInvMoveOutId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveOut_GetFInvMoveOutItem(
p_szFInvMoveOutId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

Select
BOS_SD_FInvMoveOutItem.shItemNumber,
BOS_SD_FInvMoveOutItem.szFInvoiceId,
BOS_SD_FInvoice.dtmPeriode,
BOS_SD_FInvoice.dtmCreated,
BOS_AR_Customer.szCustId,
BOS_AR_Customer.szName,
BOS_AR_ArTrans.decAmount,
BOS_AR_ArTrans.decRemain,
BOS_CU_Currency.szAmountFormat

From
BOS_SD_FInvMoveOutItem 
LEFT JOIN BOS_SD_FInvoice ON BOS_SD_FInvoice.szFInvoiceId = BOS_SD_FInvMoveOutItem.szFInvoiceId
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_FInvoice.szCustId
LEFT JOIN BOS_AR_ArTrans  ON BOS_AR_ArTrans.szDocId = BOS_SD_FInvMoveOutItem.szFInvoiceId And BOS_AR_ArTrans.szTrnId = 'FInv'
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FInvoice.szCcyId

Where
BOS_SD_FInvMoveOutItem.szFInvMoveOutId = p_szFInvMoveOutId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveOut_IsFInvMoveOutExist(
p_szFInvMoveOutId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFInvMoveOutId

FROM 
BOS_SD_FInvMoveOut
WHERE 
szFInvMoveOutId = p_szFInvMoveOutId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveOut_LockFInvMoveOut(
p_szFInvMoveOutId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvMoveOut
SET 
dtmFInvMoveOut = dtmFInvMoveOut
WHERE 
szFInvMoveOutId = p_szFInvMoveOutId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveOut_MarkFInvMoveOutApplied(
p_szFInvMoveOutId BOS_DT_szId,
p_bApplied bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvMoveOut
SET 
bApplied = p_bApplied
WHERE 
szFInvMoveOutId = p_szFInvMoveOutId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvMoveOut_UpdateFInvMoveOut(
p_szFInvMoveOutId BOS_DT_szId,
p_dtmFInvMoveOut timestamp,
p_szToWorkplaceId BOS_DT_szId,
p_dtmStartInvCreated timestamp,
p_dtmEndInvCreated timestamp,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_szFrOpUserId BOS_DT_szId,
p_szToOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvMoveOut
SET 
dtmFInvMoveOut 	= p_dtmFInvMoveOut,
szToWorkplaceId 	= p_szToWorkplaceId,
dtmStartInvCreated	= p_dtmStartInvCreated,
dtmEndInvCreated	= p_dtmEndInvCreated,
bVoid 			= p_bVoid,
bApplied 		= p_bApplied,
--It is better to use these fields as the information of its last updated (or applied), rather than its data creation.
szCompanyId 		= p_szCompanyId,
szWorkplaceId 		= p_szWorkplaceId,
szTaxEntityId 		= p_szTaxEntityId,
szUserId		= p_szUserId,
dtmCreated		= p_dtmCreated,

szFrOpUserId		= p_szFrOpUserId,
szToOpUserId		= p_szToOpUserId
WHERE 
szFInvMoveOutId 	= p_szFInvMoveOutId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_CreateFInvoice(
p_szFInvoiceId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_dtmPeriode timestamp,
p_szCanceledByInvId BOS_DT_szId,
p_szCorrectedByInvId BOS_DT_szId,
p_szCancelToInvId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_decTax BOS_DT_decTax,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_decCcyRate BOS_DT_decCcyRate,
p_szPaymentTermId BOS_DT_szId,
p_szFInvoiceStatus varchar,
p_dtmBad timestamp,
p_dtmDoubt timestamp,
p_szFInvoiceUsage varchar,
p_bCash bit,
p_bTaxReported bit,
p_szFakturPajakId BOS_DT_szId,
p_szFInvoiceType BOS_DT_szSmallId,
p_szInvoiceCollWpId BOS_DT_szId,
p_szKeptByOpUserId BOS_DT_szId,
p_szCurrentLocWpId BOS_DT_szId,
p_szTransitLocWpId BOS_DT_szId,
p_szChain_FirstId BOS_DT_szId,
p_szChain_NextId BOS_DT_szId,
p_szLastFInvHandOverId BOS_DT_szId,
p_szLastFInvMoveOutId BOS_DT_szId,
p_szLastFInvMoveInId BOS_DT_szId,
p_szLastFInvOpnameId BOS_DT_szId,
p_szRebateFInvoiceId BOS_DT_szId,
p_szFirstFDoId_s BOS_DT_szId,
p_szSalesId BOS_DT_szId,
p_szReasonId BOS_DT_szId,
p_szRemark BOS_DT_szDescription,
p_cntBonusItem smallint,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_dtmFakturPajakCreated timestamp,
p_dtmInvoiceCorrected timestamp,
p_dtmInvoiceCanceled timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvoice
(
szFInvoiceId,
szSalesOrgId,
szCustId,
dtmPeriode,
szCanceledByInvId,
szCorrectedByInvId,
szCancelToInvId,
decAmount,
decTax,
szCcyId,
szCcyRateId,
decCcyRate,
szPaymentTermId,
szFInvoiceStatus,
dtmBad,
dtmDoubt,
szFInvoiceUsage,
bCash,
bTaxReported,
szFakturPajakId,
szFInvoiceType,
szInvoiceCollWpId,
szKeptByOpUserId,
szCurrentLocWpId,
szTransitLocWpId,
szChain_FirstId,
szChain_NextId,
szLastFInvHandOverId,
szLastFInvMoveOutId,
szLastFInvMoveInId,
szLastFInvOpnameId,
szRebateFInvoiceId,
szFirstFDoId_s,
szSalesId,
szReasonId,
szRemark,
cntBonusItem,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated  --Doc status 2,
bSystemCreated  --Doc status 2,
szUserId  --Doc status 3,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
dtmFakturPajakCreated,
dtmInvoiceCorrected,
dtmInvoiceCanceled
)
VALUES
(
p_szFInvoiceId,
p_szSalesOrgId,
p_szCustId,
p_dtmPeriode,
p_szCanceledByInvId,
p_szCorrectedByInvId,
p_szCancelToInvId,
p_decAmount,
p_decTax,
p_szCcyId,
p_szCcyRateId,
p_decCcyRate,
p_szPaymentTermId,
p_szFInvoiceStatus,
p_dtmBad,
p_dtmDoubt,
p_szFInvoiceUsage,
p_bCash,
p_bTaxReported,
p_szFakturPajakId,
p_szFInvoiceType,
p_szInvoiceCollWpId,
p_szKeptByOpUserId,
p_szCurrentLocWpId,
p_szTransitLocWpId,
p_szChain_FirstId,
p_szChain_NextId,
p_szLastFInvHandOverId,
p_szLastFInvMoveOutId,
p_szLastFInvMoveInId,
p_szLastFInvOpnameId,
p_szRebateFInvoiceId,
p_szFirstFDoId_s,
p_szSalesId,
p_szReasonId,
p_szRemark,
p_cntBonusItem,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_dtmFakturPajakCreated,
p_dtmInvoiceCorrected,
p_dtmInvoiceCanceled
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_CreateFInvoice_013(
p_szFInvoiceId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_dtmPeriode timestamp,
p_szCanceledByInvId BOS_DT_szId,
p_szCorrectedByInvId BOS_DT_szId,
p_szCancelToInvId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_decTax BOS_DT_decTax,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_decCcyRate BOS_DT_decCcyRate,
p_szPaymentTermId BOS_DT_szId,
p_szFInvoiceStatus varchar,
p_dtmBad timestamp,
p_dtmDoubt timestamp,
p_szFInvoiceUsage varchar,
p_bCash bit,
p_bTaxReported bit,
p_szFakturPajakId BOS_DT_szId,
p_szFInvoiceType BOS_DT_szSmallId,
p_szInvoiceCollWpId BOS_DT_szId,
p_szKeptByOpUserId BOS_DT_szId,
p_szCurrentLocWpId BOS_DT_szId,
p_szTransitLocWpId BOS_DT_szId,
p_szChain_FirstId BOS_DT_szId,
p_szChain_NextId BOS_DT_szId,
p_szLastFInvHandOverId BOS_DT_szId,
p_szLastFInvMoveOutId BOS_DT_szId,
p_szLastFInvMoveInId BOS_DT_szId,
p_szLastFInvOpnameId BOS_DT_szId,
p_szRebateFInvoiceId BOS_DT_szId,
p_szFirstFDoId_s BOS_DT_szId,
p_szSalesId BOS_DT_szId,
p_szReasonId BOS_DT_szId,
p_szRemark BOS_DT_szDescription,
p_cntBonusItem smallint,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_dtmFakturPajakCreated timestamp,
p_dtmInvoiceCorrected timestamp,
p_dtmInvoiceCanceled timestamp,
p_AdcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvoice
(
szFInvoiceId,
szSalesOrgId,
szCustId,
dtmPeriode,
szCanceledByInvId,
szCorrectedByInvId,
szCancelToInvId,
decAmount,
decTax,
szCcyId,
szCcyRateId,
decCcyRate,
szPaymentTermId,
szFInvoiceStatus,
dtmBad,
dtmDoubt,
szFInvoiceUsage,
bCash,
bTaxReported,
szFakturPajakId,
szFInvoiceType,
szInvoiceCollWpId,
szKeptByOpUserId,
szCurrentLocWpId,
szTransitLocWpId,
szChain_FirstId,
szChain_NextId,
szLastFInvHandOverId,
szLastFInvMoveOutId,
szLastFInvMoveInId,
szLastFInvOpnameId,
szRebateFInvoiceId,
szFirstFDoId_s,
szSalesId,
szReasonId,
szRemark,
cntBonusItem,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated  --Doc status 2,
bSystemCreated  --Doc status 2,
szUserId  --Doc status 3,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
dtmFakturPajakCreated,
dtmInvoiceCorrected,
dtmInvoiceCanceled,
AdcId
)
VALUES
(
p_szFInvoiceId,
p_szSalesOrgId,
p_szCustId,
p_dtmPeriode,
p_szCanceledByInvId,
p_szCorrectedByInvId,
p_szCancelToInvId,
p_decAmount,
p_decTax,
p_szCcyId,
p_szCcyRateId,
p_decCcyRate,
p_szPaymentTermId,
p_szFInvoiceStatus,
p_dtmBad,
p_dtmDoubt,
p_szFInvoiceUsage,
p_bCash,
p_bTaxReported,
p_szFakturPajakId,
p_szFInvoiceType,
p_szInvoiceCollWpId,
p_szKeptByOpUserId,
p_szCurrentLocWpId,
p_szTransitLocWpId,
p_szChain_FirstId,
p_szChain_NextId,
p_szLastFInvHandOverId,
p_szLastFInvMoveOutId,
p_szLastFInvMoveInId,
p_szLastFInvOpnameId,
p_szRebateFInvoiceId,
p_szFirstFDoId_s,
p_szSalesId,
p_szReasonId,
p_szRemark,
p_cntBonusItem,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_dtmFakturPajakCreated,
p_dtmInvoiceCorrected,
p_dtmInvoiceCanceled,
p_AdcId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_CreateFInvoiceItem(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szDoId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szInvItemType BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_szFInvoiceItemUsage varchar,
p_decCOGS BOS_DT_decAmount,
p_szPrincipalDiscRefId BOS_DT_szId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvoiceItem
(
szFInvoiceId,
shItemNumber,
szDoId,
szOrderItemTypeId,
szProductId,
szProductSN,
szPriceId,
szPriceOrderId,
decDiscProcent,
decQty,
decUomQty,
szUomId,
decPrice,
decDiscount,
bTaxable,
decTax,
decAmount,
decDPP,
szPaymentType,
szInvItemType,
szDescription,
szFInvoiceItemUsage,
decCOGS,
szPrincipalDiscRefId,
szParentId
)
VALUES
(
p_szFInvoiceId,
p_shItemNumber,
p_szDoId,
p_szOrderItemTypeId,
p_szProductId,
p_szProductSN,
p_szPriceId,
p_szPriceOrderId,
p_decDiscProcent,
p_decQty,
p_decUomQty,
p_szUomId,
p_decPrice,
p_decDiscount,
p_bTaxable,
p_decTax,
p_decAmount,
p_decDPP,
p_szPaymentType,
p_szInvItemType,
p_szDescription,
p_szFInvoiceItemUsage,
p_decCOGS,
p_szPrincipalDiscRefId,
p_szParentId,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_CreateFInvoiceItem_013(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szDoId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szInvItemType BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_szFInvoiceItemUsage varchar,
p_decCOGS BOS_DT_decAmount,
p_szPrincipalDiscRefId BOS_DT_szId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvoiceItem
(
szFInvoiceId,
shItemNumber,
szDoId,
szOrderItemTypeId,
szProductId,
szProductSN,
szPriceId,
szPriceOrderId,
decDiscProcent,
decQty,
decUomQty,
szUomId,
decPrice,
decDiscount,
bTaxable,
decTax,
decAmount,
decDPP,
szPaymentType,
szInvItemType,
szDescription,
szFInvoiceItemUsage,
decCOGS,
szPrincipalDiscRefId,
szParentId
)
VALUES
(
p_szFInvoiceId,
p_shItemNumber,
p_szDoId,
p_szOrderItemTypeId,
p_szProductId,
p_szProductSN,
p_szPriceId,
p_szPriceOrderId,
p_decDiscProcent,
p_decQty,
p_decUomQty,
p_szUomId,
p_decPrice,
p_decDiscount,
p_bTaxable,
p_decTax,
p_decAmount,
p_decDPP,
p_szPaymentType,
p_szInvItemType,
p_szDescription,
p_szFInvoiceItemUsage,
p_decCOGS,
p_szPrincipalDiscRefId,
p_szParentId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_CreateFInvoiceItem_014(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szDoId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szInvItemType BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_szFInvoiceItemUsage varchar,
p_decCOGS BOS_DT_decAmount,
p_szPrincipalDiscRefId BOS_DT_szId,
p_szParentId BOS_DT_szId,
p_szDistProductId BOS_DT_szId,
p_decDistQty BOS_DT_decAmount,
p_decDistPrice BOS_DT_decPrice)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvoiceItem
(
szFInvoiceId,
shItemNumber,
szDoId,
szOrderItemTypeId,
szProductId,
szProductSN,
szPriceId,
szPriceOrderId,
decDiscProcent,
decQty,
decUomQty,
szUomId,
decPrice,
decDiscount,
bTaxable,
decTax,
decAmount,
decDPP,
szPaymentType,
szInvItemType,
szDescription,
szFInvoiceItemUsage,
decCOGS,
szPrincipalDiscRefId,
szParentId,
szDistProductId,
decDistQty,
decDistPrice
)
VALUES
(
p_szFInvoiceId,
p_shItemNumber,
p_szDoId,
p_szOrderItemTypeId,
p_szProductId,
p_szProductSN,
p_szPriceId,
p_szPriceOrderId,
p_decDiscProcent,
p_decQty,
p_decUomQty,
p_szUomId,
p_decPrice,
p_decDiscount,
p_bTaxable,
p_decTax,
p_decAmount,
p_decDPP,
p_szPaymentType,
p_szInvItemType,
p_szDescription,
p_szFInvoiceItemUsage,
p_decCOGS,
p_szPrincipalDiscRefId,
p_szParentId,
p_szDistProductId,
p_decDistQty,
p_decDistPrice,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_CreateFInvoiceItem_015(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szDoId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szInvItemType BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_szFInvoiceItemUsage varchar,
p_decCOGS BOS_DT_decAmount,
p_szPrincipalDiscRefId BOS_DT_szId,
p_szParentId BOS_DT_szId,
p_szDistProductId BOS_DT_szId,
p_decDistQty BOS_DT_decAmount,
p_decDistPrice BOS_DT_decPrice,
p_szBudgetId BOS_DT_szId,
p_decPrincipalCostAmount BOS_DT_decAmount,
p_decPrincipalCostQty BOS_DT_decAmount,
p_bBudgetTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvoiceItem
(
szFInvoiceId,
shItemNumber,
szDoId,
szOrderItemTypeId,
szProductId,
szProductSN,
szPriceId,
szPriceOrderId,
decDiscProcent,
decQty,
decUomQty,
szUomId,
decPrice,
decDiscount,
bTaxable,
decTax,
decAmount,
decDPP,
szPaymentType,
szInvItemType,
szDescription,
szFInvoiceItemUsage,
decCOGS,
szPrincipalDiscRefId,
szParentId,
szDistProductId,
decDistQty,
decDistPrice,
szBudgetId,
decPrincipalCostAmount,
decPrincipalCostQty,
bBudgetTransferred
)
VALUES
(
p_szFInvoiceId,
p_shItemNumber,
p_szDoId,
p_szOrderItemTypeId,
p_szProductId,
p_szProductSN,
p_szPriceId,
p_szPriceOrderId,
p_decDiscProcent,
p_decQty,
p_decUomQty,
p_szUomId,
p_decPrice,
p_decDiscount,
p_bTaxable,
p_decTax,
p_decAmount,
p_decDPP,
p_szPaymentType,
p_szInvItemType,
p_szDescription,
p_szFInvoiceItemUsage,
p_decCOGS,
p_szPrincipalDiscRefId,
p_szParentId,
p_szDistProductId,
p_decDistQty,
p_decDistPrice,
p_szBudgetId,
p_decPrincipalCostAmount,
p_decPrincipalCostQty,
p_bBudgetTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_CreateFInvoiceItemBonusSource(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szFDoId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_decBonusAmount BOS_DT_decAmount,
p_decBonusQty BOS_DT_decAmount,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvItemBonusSource
(
szFInvoiceId,
shItemNumber,
szFDoId,
szProductId,
szProductSn,
szOrderItemTypeId,
szPaymentType,
decBonusAmount,
decBonusQty,
szParentId
)
VALUES
(
p_szFInvoiceId,
p_shItemNumber,
p_szFDoId,
p_szProductId,
p_szProductSn,
p_szOrderItemTypeId,
p_szPaymentType,
p_decBonusAmount,
p_decBonusQty,
p_szParentId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_CreateFInvoiceItemBonusSource_013(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szFDoId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_decBonusAmount BOS_DT_decAmount,
p_decBonusQty BOS_DT_decAmount,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvItemBonusSource
(
szFInvoiceId,
shItemNumber,
szFDoId,
szProductId,
szProductSn,
szOrderItemTypeId,
szPaymentType,
decBonusAmount,
decBonusQty,
szParentId
)
VALUES
(
p_szFInvoiceId,
p_shItemNumber,
p_szFDoId,
p_szProductId,
p_szProductSn,
p_szOrderItemTypeId,
p_szPaymentType,
p_decBonusAmount,
p_decBonusQty,
p_szParentId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_CreateFInvoiceProductBonusItem(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szProductBonusType BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvoiceProductBonusItem
(
szFInvoiceId,
shItemNumber,
szProductId,
szOrderItemTypeId,
decQty,
szUomId,
szProductBonusType
)
VALUES
(
p_szFInvoiceId,
p_shItemNumber,
p_szProductId,
p_szOrderItemTypeId,
p_decQty,
p_szUomId,
p_szProductBonusType
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_CreateFInvoiceProductBonusItem_013(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szProductBonusType BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvoiceProductBonusItem
(
szFInvoiceId,
shItemNumber,
szProductId,
szOrderItemTypeId,
decQty,
szUomId,
szProductBonusType
)
VALUES
(
p_szFInvoiceId,
p_shItemNumber,
p_szProductId,
p_szOrderItemTypeId,
p_decQty,
p_szUomId,
p_szProductBonusType
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_CreateFInvoiceProductBonusItemBonusSource(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szFDoId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_decBonusAmount BOS_DT_decAmount,
p_decBonusQty BOS_DT_decAmount,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvProductBonusItemBonusSource
(
szFInvoiceId,
shItemNumber,
szFDoId,
szProductId,
szProductSn,
szOrderItemTypeId,
szPaymentType,
decBonusAmount,
decBonusQty,
szParentId
)
VALUES
(
p_szFInvoiceId,
p_shItemNumber,
p_szFDoId,
p_szProductId,
p_szProductSn,
p_szOrderItemTypeId,
p_szPaymentType,
p_decBonusAmount,
p_decBonusQty,
p_szParentId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_CreateFInvoiceProductBonusItemBonusSource_013(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szFDoId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_decBonusAmount BOS_DT_decAmount,
p_decBonusQty BOS_DT_decAmount,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvProductBonusItemBonusSource
(
szFInvoiceId,
shItemNumber,
szFDoId,
szProductId,
szProductSn,
szOrderItemTypeId,
szPaymentType,
decBonusAmount,
decBonusQty,
szParentId
)
VALUES
(
p_szFInvoiceId,
p_shItemNumber,
p_szFDoId,
p_szProductId,
p_szProductSn,
p_szOrderItemTypeId,
p_szPaymentType,
p_decBonusAmount,
p_decBonusQty,
p_szParentId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_DeleteFInvoice(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_SD_FInvoice
WHERE
szFInvoiceId = p_szFInvoiceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_DeleteFInvoice_013(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_SD_FInvoice
WHERE
szFInvoiceId = p_szFInvoiceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_DeleteFInvoiceItem(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_SD_FInvoiceItem
WHERE
szFInvoiceId = p_szFInvoiceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_DeleteFInvoiceItem_013(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_SD_FInvoiceItem
WHERE
szFInvoiceId = p_szFInvoiceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_DeleteFInvoiceItem_ByItem(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FInvoiceItem
WHERE
szFInvoiceId = p_szFInvoiceIdAND shItemNumber = p_shItemNumber;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_DeleteFInvoiceItem_ByItem_013(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FInvoiceItem
WHERE
szFInvoiceId = p_szFInvoiceIdAND shItemNumber = p_shItemNumber;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_DeleteFInvoiceItemBonusSource(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_SD_FInvItemBonusSource
WHERE
szFInvoiceId = p_szFInvoiceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_DeleteFInvoiceItemBonusSource_013(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_SD_FInvItemBonusSource
WHERE
szFInvoiceId = p_szFInvoiceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_DeleteFInvoiceItemBonusSource_ByItem(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szFDoId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FInvItemBonusSource
WHERE
szFInvoiceId = p_szFInvoiceIdAND shItemNumber = p_shItemNumberAND szFDoId = p_szFDoIdAND szProductId = p_szProductIdAND szProductSn = p_szProductSnAND szOrderItemTypeId = p_szOrderItemTypeIdAND szPaymentType = p_szPaymentTypeAND szParentId = p_szParentId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_DeleteFInvoiceItemBonusSource_ByItem_013(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szFDoId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FInvItemBonusSource
WHERE
szFInvoiceId = p_szFInvoiceIdAND shItemNumber = p_shItemNumberAND szFDoId = p_szFDoIdAND szProductId = p_szProductIdAND szProductSn = p_szProductSnAND szOrderItemTypeId = p_szOrderItemTypeIdAND szPaymentType = p_szPaymentTypeAND szParentId = p_szParentId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_DeleteFInvoiceProductBonusItem(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_SD_FInvoiceProductBonusItem
WHERE
szFInvoiceId = p_szFInvoiceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_DeleteFInvoiceProductBonusItem_013(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_SD_FInvoiceProductBonusItem
WHERE
szFInvoiceId = p_szFInvoiceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_DeleteFInvoiceProductBonusItem_ByItem(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FInvoiceProductBonusItem
WHERE
szFInvoiceId = p_szFInvoiceIdAND shItemNumber = p_shItemNumber;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_DeleteFInvoiceProductBonusItem_ByItem_013(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FInvoiceProductBonusItem
WHERE
szFInvoiceId = p_szFInvoiceIdAND shItemNumber = p_shItemNumber;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_DeleteFInvoiceProductBonusItemBonusSource(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_SD_FInvProductBonusItemBonusSource
WHERE
szFInvoiceId = p_szFInvoiceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_DeleteFInvoiceProductBonusItemBonusSource_013(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_SD_FInvProductBonusItemBonusSource
WHERE
szFInvoiceId = p_szFInvoiceId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_DeleteFInvoiceProductBonusItemBonusSource_ByItem(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szFDoId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FInvProductBonusItemBonusSource
WHERE
szFInvoiceId = p_szFInvoiceIdAND shItemNumber = p_shItemNumberAND szFDoId = p_szFDoIdAND szProductId = p_szProductIdAND szProductSn = p_szProductSnAND szOrderItemTypeId = p_szOrderItemTypeIdAND szPaymentType = p_szPaymentTypeAND szParentId = p_szParentId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_DeleteFInvoiceProductBonusItemBonusSource_ByItem_013(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szFDoId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FInvProductBonusItemBonusSource
WHERE
szFInvoiceId = p_szFInvoiceIdAND shItemNumber = p_shItemNumberAND szFDoId = p_szFDoIdAND szProductId = p_szProductIdAND szProductSn = p_szProductSnAND szOrderItemTypeId = p_szOrderItemTypeIdAND szPaymentType = p_szPaymentTypeAND szParentId = p_szParentId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetFInvoice(
p_szFInvoiceId BOS_DT_szId,
p_szTrnId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN

Select  
BOS_SD_FInvoice.bTaxReported,  
BOS_SD_FInvoice.szFakturPajakId,  
BOS_SD_FInvoice.szSalesOrgId,  

BOS_SD_FInvoice.szCustId,  
InvCust.szName AS szCustNm_J,  

COLL_TO.szCollWorkplaceId AS szCustCollWpId_J,  
CollToWp.szName AS szCustCollWpNm_J,  

BOS_SD_Route.szOpUserId AS szCustCollId_J,  

BOS_SD_FInvoice.dtmPeriode,  
BOS_SD_FInvoice.szCanceledByInvId,  
CancelInv.dtmCreated as dtmCanceled_J,  
BOS_SD_FInvoice.szCorrectedByInvId,  
CorrectInv.dtmCreated as dtmCorrected_J,  
BOS_SD_FInvoice.szCancelToInvId,  
BOS_SD_FInvoice.decAmount,  
BOS_SD_FInvoice.decTax,  

BOS_SD_FInvoice.szCcyId,  
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat_J,  

BOS_SD_FInvoice.szCcyRateId,  
BOS_SD_FInvoice.decCcyRate,   
BOS_SD_FInvoice.szPaymentTermId,  
BOS_SD_FInvoice.szFInvoiceStatus,  
BOS_SD_FInvoice.dtmBad,  
BOS_SD_FInvoice.dtmDoubt,  
BOS_SD_FInvoice.szFInvoiceUsage,  
BOS_SD_FInvoice.bCash,  
BOS_SD_FInvoice.szFInvoiceType,  

BOS_SD_FInvoice.szInvoiceCollWpId,  

BOS_SD_FInvoice.szKeptByOpUserId,  
KeptByEmp.szName AS szKeptByOpUserNm_J,  

BOS_SD_FInvoice.szCurrentLocWpId,  
CurrLocWp.szName AS szCurrentLocWpNm_J,  

BOS_SD_FInvoice.szTransitLocWpId,  
TransitLocWp.szName AS szTransitLocWpNm_J,  

BOS_AR_ArTrans.dtmDue as dtmDue_J,  
BOS_AR_ArTrans.dtmDue_Printed as dtmDue_Printed_J,  
BOS_AR_ArTrans.bClosed as bPaid_J,  
BOS_AR_ArTrans.dtmClosed as dtmClosed_J,  
BOS_AR_ArTrans.decRemain as decRemain_J,  

BOS_AR_ArTrans.szArClassId AS szArClassId_J,  

BOS_SD_CjrTracking.szCjrTrackingId as szCjrTrackingId_J,  
BOS_SD_FCjr.szBaseRouteId AS szCjrTrackingRouteId_J,  

BOS_SD_FInvoice.szChain_FirstId,  
BOS_SD_FInvoice.szChain_NextId,  
PrevFInv.szFInvoiceId AS szChain_PrevId_J,  

BOS_SD_FInvoice.szLastFInvHandOverId,  
BOS_SD_FInvoice.szLastFInvMoveOutId,  
BOS_SD_FInvoice.szLastFInvMoveInId,  

BOS_SD_FInvoice.szLastFInvOpnameId,  
BOS_SD_FInvOpname.dtmOpname AS dtmLastFInvOpnameDate_J,  

BOS_SD_FInvoice.szRebateFInvoiceId,  

BOS_SD_FInvoice.szFirstFDoId_s,  
BOS_SD_FInvoice.szSalesId,  
BOS_SD_FInvoice.szReasonId,  
BOS_SD_FInvoice.szRemark,  

BOS_SD_FInvoice.cntBonusItem,  

BOS_SD_FInvoice.bResultFrTransfer,  
BOS_SD_FInvoice.bVoid,  
BOS_GEN_Approved.bApproved,  
BOS_SD_FInvoice.bApplied,  
BOS_GL_FJournalTrans.szFJournalId AS bJournal,  
BOS_GL_FJournalTrans.bPosted,  
BOS_SD_FInvoice.btPrintedCount,  
BOS_SD_FInvoice.bTransferred,  
BOS_SD_FInvoice.szCompanyId,  
BOS_GL_Company.szName AS szCompanyNm,  
BOS_SD_FInvoice.szWorkplaceId,  
BOS_GL_Workplace.szName AS szWorkplaceNm,  
BOS_SD_FInvoice.szTaxEntityId,  
BOS_SD_FInvoice.bNeedApproval,  
BOS_GEN_Approved.szApprovalId,  
BOS_SD_FInvoice.gdApprovedId,  
BOS_GL_FJournalTrans.szFJournalId,  
BOS_SD_FInvoice.dtmCreated,  
BOS_SD_FInvoice.bSystemCreated,  
BOS_SD_FInvoice.szUserId,  
BOS_SM_User.szName AS szUserNm_J,  

-- Data Status.  
BOS_SD_FInvoice.dtmLastUpdated,  
BOS_SD_FInvoice.bAlreadyTransferred,  
BOS_SD_FInvoice.dtmFakturPajakCreated,
BOS_SD_FInvoice.dtmInvoiceCanceled,
BOS_SD_FInvoice.dtmInvoiceCorrected
From  
BOS_SD_FInvoice  
LEFT JOIN BOS_AR_ArTrans ON   
BOS_SD_FInvoice.szFInvoiceId = BOS_AR_ArTrans.szDocId and   
BOS_SD_FInvoice.szCustId = BOS_AR_ArTrans.szCustId and  
BOS_AR_ArTrans.szTrnId = p_szTrnId  
LEFT JOIN BOS_GEN_Approved ON BOS_SD_FInvoice.gdApprovedId = BOS_GEN_Approved.gdApprovedId  
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FInvoice.szFJournalId = BOS_GL_FJournalTrans.szFJournalId  
LEFT JOIN BOS_SD_CjrTracking ON BOS_SD_CjrTracking.szDocId = BOS_SD_FInvoice.szFInvoiceId  
LEFT JOIN BOS_SD_FCjr ON BOS_SD_FCjr.szFCjrId = BOS_SD_CjrTracking.szFCjrId  
LEFT JOIN BOS_SD_FInvoice as CancelInv ON CancelInv.szFInvoiceId = BOS_SD_FInvoice.szCanceledByInvId  
LEFT JOIN BOS_SD_FInvoice as CorrectInv ON CorrectInv.szFInvoiceId = BOS_SD_FInvoice.szCorrectedByInvId  
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FInvoice.szCompanyId  
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FInvoice.szWorkplaceId  
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FInvoice.szUserId  
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FInvoice.szCcyId  
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_FInvoice.szCustId  
LEFT JOIN BOS_AR_Customer AS InvCust ON InvCust.szCustId = BOS_AR_Customer.szInvoiceToCustId  

LEFT JOIN BOS_AR_Customer AS COLL_TO ON COLL_TO.szCustId = InvCust.szCollectToCustId  
LEFT JOIN BOS_GL_Workplace AS CollToWp ON CollToWp.szWorkplaceId = COLL_TO.szCollWorkplaceId  

LEFT JOIN BOS_SD_CustCollRoutine ON BOS_SD_CustCollRoutine.szCustId = COLL_TO.szCustId  
LEFT JOIN BOS_SD_Route ON BOS_SD_Route.szRouteId = BOS_SD_CustCollRoutine.szDefaultRouteId  

LEFT JOIN BOS_GL_Workplace AS CurrLocWp ON CurrLocWp.szWorkplaceId = BOS_SD_FInvoice.szCurrentLocWpId  
LEFT JOIN BOS_GL_Workplace AS TransitLocWp ON CurrLocWp.szWorkplaceId = BOS_SD_FInvoice.szTransitLocWpId  

LEFT JOIN BOS_SD_FInvoice AS PrevFInv ON PrevFInv.szChain_NextId = BOS_SD_FInvoice.szFInvoiceId  

LEFT JOIN BOS_SD_FInvOpname ON BOS_SD_FInvOpname.szFInvOpnameId = BOS_SD_FInvoice.szLastFInvOpnameId  
LEFT JOIN BOS_PI_Employee AS KeptByEmp ON KeptByEmp.szEmployeeId = BOS_SD_FInvoice.szKeptByOpUserId  

Where  
BOS_SD_FInvoice.szFInvoiceId = p_szFInvoiceId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetFInvoice_013(
p_szFInvoiceId BOS_DT_szId,
p_szTrnId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN

Select    
BOS_SD_FInvoice.bTaxReported,    
BOS_SD_FInvoice.szFakturPajakId,    
BOS_SD_FInvoice.szSalesOrgId,    

BOS_SD_FInvoice.szCustId,    
InvCust.szName AS szCustNm_J,    

COLL_TO.szCollWorkplaceId AS szCustCollWpId_J,    
CollToWp.szName AS szCustCollWpNm_J,    

BOS_SD_Route.szOpUserId AS szCustCollId_J,    

BOS_SD_FInvoice.dtmPeriode,    
BOS_SD_FInvoice.szCanceledByInvId,    
CancelInv.dtmCreated as dtmCanceled_J,    
BOS_SD_FInvoice.szCorrectedByInvId,    
CorrectInv.dtmCreated as dtmCorrected_J,    
BOS_SD_FInvoice.szCancelToInvId,    
BOS_SD_FInvoice.decAmount,    
BOS_SD_FInvoice.decTax,    

BOS_SD_FInvoice.szCcyId,    
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat_J,    

BOS_SD_FInvoice.szCcyRateId,    
BOS_SD_FInvoice.decCcyRate,     
BOS_SD_FInvoice.szPaymentTermId,    
BOS_SD_FInvoice.szFInvoiceStatus,    
BOS_SD_FInvoice.dtmBad,    
BOS_SD_FInvoice.dtmDoubt,    
BOS_SD_FInvoice.szFInvoiceUsage,    
BOS_SD_FInvoice.bCash,    
BOS_SD_FInvoice.szFInvoiceType,    

BOS_SD_FInvoice.szInvoiceCollWpId,    

BOS_SD_FInvoice.szKeptByOpUserId,    
KeptByEmp.szName AS szKeptByOpUserNm_J,    

BOS_SD_FInvoice.szCurrentLocWpId,    
CurrLocWp.szName AS szCurrentLocWpNm_J,    

BOS_SD_FInvoice.szTransitLocWpId,    
TransitLocWp.szName AS szTransitLocWpNm_J,    

BOS_AR_ArTrans.dtmDue as dtmDue_J,    
BOS_AR_ArTrans.dtmDue_Printed as dtmDue_Printed_J,    
BOS_AR_ArTrans.bClosed as bPaid_J,    
BOS_AR_ArTrans.dtmClosed as dtmClosed_J,    
BOS_AR_ArTrans.decRemain as decRemain_J,    

BOS_AR_ArTrans.szArClassId AS szArClassId_J,    

BOS_SD_CjrTracking.szCjrTrackingId as szCjrTrackingId_J,    
BOS_SD_FCjr.szBaseRouteId AS szCjrTrackingRouteId_J,    

BOS_SD_FInvoice.szChain_FirstId,    
BOS_SD_FInvoice.szChain_NextId,    
PrevFInv.szFInvoiceId AS szChain_PrevId_J,    

BOS_SD_FInvoice.szLastFInvHandOverId,    
BOS_SD_FInvoice.szLastFInvMoveOutId,    
BOS_SD_FInvoice.szLastFInvMoveInId,    

BOS_SD_FInvoice.szLastFInvOpnameId,    
BOS_SD_FInvOpname.dtmOpname AS dtmLastFInvOpnameDate_J,    

BOS_SD_FInvoice.szRebateFInvoiceId,    

BOS_SD_FInvoice.szFirstFDoId_s,    
BOS_SD_FInvoice.szSalesId,    
BOS_SD_FInvoice.szReasonId,    
BOS_SD_FInvoice.szRemark,    

BOS_SD_FInvoice.cntBonusItem,    

BOS_SD_FInvoice.bResultFrTransfer,    
BOS_SD_FInvoice.bVoid,    
BOS_GEN_Approved.bApproved,    
BOS_SD_FInvoice.bApplied,    
BOS_GL_FJournalTrans.szFJournalId AS bJournal,    
BOS_GL_FJournalTrans.bPosted,    
BOS_SD_FInvoice.btPrintedCount,    
BOS_SD_FInvoice.bTransferred,    
BOS_SD_FInvoice.szCompanyId,    
BOS_GL_Company.szName AS szCompanyNm,    
BOS_SD_FInvoice.szWorkplaceId,    
BOS_GL_Workplace.szName AS szWorkplaceNm,    
BOS_SD_FInvoice.szTaxEntityId,    
BOS_SD_FInvoice.bNeedApproval,    
BOS_GEN_Approved.szApprovalId,    
BOS_SD_FInvoice.gdApprovedId,    
BOS_GL_FJournalTrans.szFJournalId,    
BOS_SD_FInvoice.dtmCreated,    
BOS_SD_FInvoice.bSystemCreated,    
BOS_SD_FInvoice.szUserId,    
BOS_SM_User.szName AS szUserNm_J,    

-- Data Status.    
BOS_SD_FInvoice.dtmLastUpdated,    
BOS_SD_FInvoice.bAlreadyTransferred,    
BOS_SD_FInvoice.dtmFakturPajakCreated,  
BOS_SD_FInvoice.dtmInvoiceCanceled,  
BOS_SD_FInvoice.dtmInvoiceCorrected,
BOS_SD_FInvoice.AdcId  
From    
BOS_SD_FInvoice    
LEFT JOIN BOS_AR_ArTrans ON     
BOS_SD_FInvoice.szFInvoiceId = BOS_AR_ArTrans.szDocId and     
BOS_SD_FInvoice.szCustId = BOS_AR_ArTrans.szCustId and    
BOS_AR_ArTrans.szTrnId = p_szTrnId    
LEFT JOIN BOS_GEN_Approved ON BOS_SD_FInvoice.gdApprovedId = BOS_GEN_Approved.gdApprovedId    
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FInvoice.szFJournalId = BOS_GL_FJournalTrans.szFJournalId    
LEFT JOIN BOS_SD_CjrTracking ON BOS_SD_CjrTracking.szDocId = BOS_SD_FInvoice.szFInvoiceId    
LEFT JOIN BOS_SD_FCjr ON BOS_SD_FCjr.szFCjrId = BOS_SD_CjrTracking.szFCjrId    
LEFT JOIN BOS_SD_FInvoice as CancelInv ON CancelInv.szFInvoiceId = BOS_SD_FInvoice.szCanceledByInvId    
LEFT JOIN BOS_SD_FInvoice as CorrectInv ON CorrectInv.szFInvoiceId = BOS_SD_FInvoice.szCorrectedByInvId    
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FInvoice.szCompanyId    
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FInvoice.szWorkplaceId    
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FInvoice.szUserId    
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FInvoice.szCcyId    
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_FInvoice.szCustId    
LEFT JOIN BOS_AR_Customer AS InvCust ON InvCust.szCustId = BOS_AR_Customer.szInvoiceToCustId    

LEFT JOIN BOS_AR_Customer AS COLL_TO ON COLL_TO.szCustId = InvCust.szCollectToCustId    
LEFT JOIN BOS_GL_Workplace AS CollToWp ON CollToWp.szWorkplaceId = COLL_TO.szCollWorkplaceId    

LEFT JOIN BOS_SD_CustCollRoutine ON BOS_SD_CustCollRoutine.szCustId = COLL_TO.szCustId    
LEFT JOIN BOS_SD_Route ON BOS_SD_Route.szRouteId = BOS_SD_CustCollRoutine.szDefaultRouteId    

LEFT JOIN BOS_GL_Workplace AS CurrLocWp ON CurrLocWp.szWorkplaceId = BOS_SD_FInvoice.szCurrentLocWpId    
LEFT JOIN BOS_GL_Workplace AS TransitLocWp ON CurrLocWp.szWorkplaceId = BOS_SD_FInvoice.szTransitLocWpId    

LEFT JOIN BOS_SD_FInvoice AS PrevFInv ON PrevFInv.szChain_NextId = BOS_SD_FInvoice.szFInvoiceId    

LEFT JOIN BOS_SD_FInvOpname ON BOS_SD_FInvOpname.szFInvOpnameId = BOS_SD_FInvoice.szLastFInvOpnameId    
LEFT JOIN BOS_PI_Employee AS KeptByEmp ON KeptByEmp.szEmployeeId = BOS_SD_FInvoice.szKeptByOpUserId    

Where    
BOS_SD_FInvoice.szFInvoiceId = p_szFInvoiceId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetFInvoiceItem(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_SD_FInvoiceItem.shItemNumber,
BOS_SD_FInvoiceItem.szOrderItemTypeId,

BOS_INV_Product.szName AS szProductNm,
BOS_INV_Product.szDiscountGroupId AS szProductDiscGroupId_J,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_GL_TaxType.decRate AS decProductTaxRate_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,

BOS_SD_FInvoiceItem.szDoId,
BOS_SD_FInvoiceItem.szProductId,
BOS_SD_FInvoiceItem.szProductSN,

BOS_SD_FInvoiceItem.szPriceId,
BOS_SD_FInvoiceItem.szPriceOrderId,
BOS_SD_FInvoiceItem.decDiscProcent,

BOS_SD_FInvoiceItem.decQty,
BOS_SD_FInvoiceItem.decUomQty,

BOS_SD_FInvoiceItem.szUomId,
BOS_SD_FInvoiceItem.decPrice,
BOS_SD_FInvoiceItem.decDiscount,
BOS_SD_FInvoiceItem.bTaxable,
BOS_SD_FInvoiceItem.decTax,
BOS_SD_FInvoiceItem.decAmount,
BOS_SD_FInvoiceItem.decDPP,
BOS_SD_FInvoiceItem.szPaymentType,
BOS_SD_FInvoiceItem.szInvItemType,
BOS_SD_FInvoiceItem.szDescription,
BOS_SD_FInvoiceItem.szFinvoiceItemUsage,
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,
BOS_INV_OrderItemType.bTaxable AS bOrderItemTypeTaxable_J,
ISNULL(BOS_SD_FDo.dtmDelivery,BOS_SD_FInvoice.dtmPeriode) AS dtmDelivery,

BOS_SD_FInvoiceItem.decCOGS,
BOS_SD_FInvoiceItem.szPrincipalDiscRefId,
PrDiscRef.szDescription AS szPrincipalDiscRefDesc_J,

dbo.BOS_SD_FInvoiceItem.szParentId,
parent.szName AS szParentNm_J

FROM
BOS_SD_FInvoiceItem 
left join BOS_INV_Product ON BOS_SD_FInvoiceItem.szProductId = BOS_INV_Product.szProductId
left join BOS_INV_Product AS parent ON BOS_SD_FInvoiceItem.szParentId = parent.szProductId
left join BOS_INV_OrderItemType ON BOS_SD_FInvoiceItem.szOrderItemTypeId = BOS_INV_OrderItemType.szOrderItemTypeId
left join BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_SD_FInvoiceItem.szDoId
left join BOS_SD_FInvoice ON BOS_SD_FInvoice.szFInvoiceId = BOS_SD_FInvoiceItem.szFInvoiceId
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId
left join BOS_SD_OrgStru_PrincipalDiscRef AS PrDiscRef ON BOS_SD_FInvoiceItem.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId
WHERE
BOS_SD_FInvoiceItem.szFInvoiceId = p_szFInvoiceId

ORDER BY
BOS_SD_FInvoiceItem.shItemNumber

/**
Do not add any "order-by" clause, our updating function depends on item number to always be sorted.
**/

set ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetFInvoiceItem_013(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT  
BOS_SD_FInvoiceItem.shItemNumber,  
BOS_SD_FInvoiceItem.szOrderItemTypeId,  

BOS_INV_Product.szName AS szProductNm,  
BOS_INV_Product.szDiscountGroupId AS szProductDiscGroupId_J,  
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,  
BOS_GL_TaxType.decRate AS decProductTaxRate_J,  
BOS_INV_Product.szUomId AS szProductUomId_J,  
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,  
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,  

BOS_SD_FInvoiceItem.szDoId,  
BOS_SD_FInvoiceItem.szProductId,  
BOS_SD_FInvoiceItem.szProductSN,  

BOS_SD_FInvoiceItem.szPriceId,  
BOS_SD_FInvoiceItem.szPriceOrderId,  
BOS_SD_FInvoiceItem.decDiscProcent,  

BOS_SD_FInvoiceItem.decQty,  
BOS_SD_FInvoiceItem.decUomQty,  

BOS_SD_FInvoiceItem.szUomId,  
BOS_SD_FInvoiceItem.decPrice,  
BOS_SD_FInvoiceItem.decDiscount,  
BOS_SD_FInvoiceItem.bTaxable,  
BOS_SD_FInvoiceItem.decTax,  
BOS_SD_FInvoiceItem.decAmount,  
BOS_SD_FInvoiceItem.decDPP,  
BOS_SD_FInvoiceItem.szPaymentType,  
BOS_SD_FInvoiceItem.szInvItemType,  
BOS_SD_FInvoiceItem.szDescription,  
BOS_SD_FInvoiceItem.szFinvoiceItemUsage,  
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,  
BOS_INV_OrderItemType.bTaxable AS bOrderItemTypeTaxable_J,  
ISNULL(BOS_SD_FDo.dtmDelivery,BOS_SD_FInvoice.dtmPeriode) AS dtmDelivery,  

BOS_SD_FInvoiceItem.decCOGS,  
BOS_SD_FInvoiceItem.szPrincipalDiscRefId,  
PrDiscRef.szDescription AS szPrincipalDiscRefDesc_J,  

dbo.BOS_SD_FInvoiceItem.szParentId,  
parent.szName AS szParentNm_J  

FROM  
BOS_SD_FInvoiceItem   
left join BOS_INV_Product ON BOS_SD_FInvoiceItem.szProductId = BOS_INV_Product.szProductId  
left join BOS_INV_Product AS parent ON BOS_SD_FInvoiceItem.szParentId = parent.szProductId  
left join BOS_INV_OrderItemType ON BOS_SD_FInvoiceItem.szOrderItemTypeId = BOS_INV_OrderItemType.szOrderItemTypeId  
left join BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_SD_FInvoiceItem.szDoId  
left join BOS_SD_FInvoice ON BOS_SD_FInvoice.szFInvoiceId = BOS_SD_FInvoiceItem.szFInvoiceId  
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId  
left join BOS_SD_OrgStru_PrincipalDiscRef AS PrDiscRef ON BOS_SD_FInvoiceItem.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId  
WHERE  
BOS_SD_FInvoiceItem.szFInvoiceId = p_szFInvoiceId  

ORDER BY  
BOS_SD_FInvoiceItem.shItemNumber  

/**  
Do not add any "order-by" clause, our updating function depends on item number to always be sorted.  
**/

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetFInvoiceItem_014(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT  
BOS_SD_FInvoiceItem.shItemNumber,  
BOS_SD_FInvoiceItem.szOrderItemTypeId,  

BOS_INV_Product.szName AS szProductNm,  
BOS_INV_Product.szDiscountGroupId AS szProductDiscGroupId_J,  
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,  
BOS_GL_TaxType.decRate AS decProductTaxRate_J,  
BOS_INV_Product.szUomId AS szProductUomId_J,  
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,  
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,  

BOS_SD_FInvoiceItem.szDoId,  
BOS_SD_FInvoiceItem.szProductId,  
BOS_SD_FInvoiceItem.szProductSN,  

BOS_SD_FInvoiceItem.szPriceId,  
BOS_SD_FInvoiceItem.szPriceOrderId,  
BOS_SD_FInvoiceItem.decDiscProcent,  

BOS_SD_FInvoiceItem.decQty,  
BOS_SD_FInvoiceItem.decUomQty,  

BOS_SD_FInvoiceItem.szUomId,  
BOS_SD_FInvoiceItem.decPrice,  
BOS_SD_FInvoiceItem.decDiscount,  
BOS_SD_FInvoiceItem.bTaxable,  
BOS_SD_FInvoiceItem.decTax,  
BOS_SD_FInvoiceItem.decAmount,  
BOS_SD_FInvoiceItem.decDPP,  
BOS_SD_FInvoiceItem.szPaymentType,  
BOS_SD_FInvoiceItem.szInvItemType,  
BOS_SD_FInvoiceItem.szDescription,  
BOS_SD_FInvoiceItem.szFinvoiceItemUsage,  
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,  
BOS_INV_OrderItemType.bTaxable AS bOrderItemTypeTaxable_J,  
ISNULL(BOS_SD_FDo.dtmDelivery,BOS_SD_FInvoice.dtmPeriode) AS dtmDelivery,  

BOS_SD_FInvoiceItem.decCOGS,  
BOS_SD_FInvoiceItem.szPrincipalDiscRefId,  
PrDiscRef.szDescription AS szPrincipalDiscRefDesc_J,  

dbo.BOS_SD_FInvoiceItem.szParentId,  
parent.szName AS szParentNm_J,

BOS_SD_FInvoiceItem.szDistProductId,  
BOS_SD_FInvoiceItem.decDistQty,  
BOS_SD_FInvoiceItem.decDistPrice       

FROM  
BOS_SD_FInvoiceItem   
left join BOS_INV_Product ON BOS_SD_FInvoiceItem.szProductId = BOS_INV_Product.szProductId  
left join BOS_INV_Product AS parent ON BOS_SD_FInvoiceItem.szParentId = parent.szProductId  
left join BOS_INV_OrderItemType ON BOS_SD_FInvoiceItem.szOrderItemTypeId = BOS_INV_OrderItemType.szOrderItemTypeId  
left join BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_SD_FInvoiceItem.szDoId  
left join BOS_SD_FInvoice ON BOS_SD_FInvoice.szFInvoiceId = BOS_SD_FInvoiceItem.szFInvoiceId  
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId  
left join BOS_SD_OrgStru_PrincipalDiscRef AS PrDiscRef ON BOS_SD_FInvoiceItem.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId  
WHERE  
BOS_SD_FInvoiceItem.szFInvoiceId = p_szFInvoiceId  

ORDER BY  
BOS_SD_FInvoiceItem.shItemNumber  


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetFInvoiceItem_015(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT  
BOS_SD_FInvoiceItem.shItemNumber,  
BOS_SD_FInvoiceItem.szOrderItemTypeId,  

BOS_INV_Product.szName AS szProductNm,  
BOS_INV_Product.szDiscountGroupId AS szProductDiscGroupId_J,  
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,  
BOS_GL_TaxType.decRate AS decProductTaxRate_J,  
BOS_INV_Product.szUomId AS szProductUomId_J,  
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,  
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,  

BOS_SD_FInvoiceItem.szDoId,  
BOS_SD_FInvoiceItem.szProductId,  
BOS_SD_FInvoiceItem.szProductSN,  

BOS_SD_FInvoiceItem.szPriceId,  
BOS_SD_FInvoiceItem.szPriceOrderId,  
BOS_SD_FInvoiceItem.decDiscProcent,  

BOS_SD_FInvoiceItem.decQty,  
BOS_SD_FInvoiceItem.decUomQty,  

BOS_SD_FInvoiceItem.szUomId,  
BOS_SD_FInvoiceItem.decPrice,  
BOS_SD_FInvoiceItem.decDiscount,  
BOS_SD_FInvoiceItem.bTaxable,  
BOS_SD_FInvoiceItem.decTax,  
BOS_SD_FInvoiceItem.decAmount,  
BOS_SD_FInvoiceItem.decDPP,  
BOS_SD_FInvoiceItem.szPaymentType,  
BOS_SD_FInvoiceItem.szInvItemType,  
BOS_SD_FInvoiceItem.szDescription,  
BOS_SD_FInvoiceItem.szFinvoiceItemUsage,  
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,  
BOS_INV_OrderItemType.bTaxable AS bOrderItemTypeTaxable_J,  
ISNULL(BOS_SD_FDo.dtmDelivery,BOS_SD_FInvoice.dtmPeriode) AS dtmDelivery,  

BOS_SD_FInvoiceItem.decCOGS,  
BOS_SD_FInvoiceItem.szPrincipalDiscRefId,  
PrDiscRef.szDescription AS szPrincipalDiscRefDesc_J,  

dbo.BOS_SD_FInvoiceItem.szParentId,  
parent.szName AS szParentNm_J,

BOS_SD_FInvoiceItem.szDistProductId,  
BOS_SD_FInvoiceItem.decDistQty,  
BOS_SD_FInvoiceItem.decDistPrice,

BOS_SD_FInvoiceItem.szBudgetId,  
BOS_SD_FInvoiceItem.decPrincipalCostAmount,
BOS_SD_FInvoiceItem.decPrincipalCostQty,
BOS_SD_FInvoiceItem.bBudgetTransferred       

FROM  
BOS_SD_FInvoiceItem   
LEFT JOIN BOS_INV_Product ON BOS_SD_FInvoiceItem.szProductId = BOS_INV_Product.szProductId  
LEFT JOIN BOS_INV_Product AS parent ON BOS_SD_FInvoiceItem.szParentId = parent.szProductId  
LEFT JOIN BOS_INV_OrderItemType ON BOS_SD_FInvoiceItem.szOrderItemTypeId = BOS_INV_OrderItemType.szOrderItemTypeId  
LEFT JOIN BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_SD_FInvoiceItem.szDoId  
LEFT JOIN BOS_SD_FInvoice ON BOS_SD_FInvoice.szFInvoiceId = BOS_SD_FInvoiceItem.szFInvoiceId  
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId  
LEFT JOIN BOS_SD_OrgStru_PrincipalDiscRef AS PrDiscRef ON BOS_SD_FInvoiceItem.szPrincipalDiscRefId = PrDiscRef.szPrincipalDiscRefId  
WHERE  
BOS_SD_FInvoiceItem.szFInvoiceId = p_szFInvoiceId  

ORDER BY  
BOS_SD_FInvoiceItem.shItemNumber  



END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetFInvoiceItemBonusSource(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFDoId,
szProductId,
szProductSn,
szOrderItemTypeId,
szPaymentType,
decBonusAmount,
decBonusQty,
szParentId


FROM 
BOS_SD_FInvItemBonusSource

WHERE 
szFInvoiceId = p_szFInvoiceId and shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetFInvoiceItemBonusSource_013(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFDoId,
szProductId,
szProductSn,
szOrderItemTypeId,
szPaymentType,
decBonusAmount,
decBonusQty,
szParentId


FROM 
BOS_SD_FInvItemBonusSource

WHERE 
szFInvoiceId = p_szFInvoiceId and shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetFInvoiceLocation(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FInvoice.szCurrentLocWpId,
BOS_SD_FInvoice.szTransitLocWpId

FROM 
BOS_SD_FInvoice

WHERE 
BOS_SD_FInvoice.szFInvoiceId = p_szFInvoiceId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetFInvoiceLocation_013(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FInvoice.szCurrentLocWpId,
BOS_SD_FInvoice.szTransitLocWpId

FROM 
BOS_SD_FInvoice

WHERE 
BOS_SD_FInvoice.szFInvoiceId = p_szFInvoiceId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetFInvoiceProductBonusItem(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FInvoiceProductBonusItem.shItemNumber,

BOS_SD_FInvoiceProductBonusItem.szProductId,
BOS_INV_Product.szName as szProductNm_J,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,

BOS_SD_FInvoiceProductBonusItem.szOrderItemTypeId,
BOS_SD_FInvoiceProductBonusItem.decQty,
BOS_SD_FInvoiceProductBonusItem.szUomId,
BOS_SD_FInvoiceProductBonusItem.szProductBonusType,
BOS_SD_FInvoiceProductBonusItem.szParentId

FROM 
BOS_SD_FInvoiceProductBonusItem left join BOS_INV_Product on BOS_SD_FInvoiceProductBonusItem.szProductId = BOS_INV_Product.szProductId
WHERE 
BOS_SD_FInvoiceProductBonusItem.szFInvoiceId = p_szFInvoiceId ;ORDER BY 
BOS_SD_FInvoiceProductBonusItem.shItemNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetFInvoiceProductBonusItem_013(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FInvoiceProductBonusItem.shItemNumber,

BOS_SD_FInvoiceProductBonusItem.szProductId,
BOS_INV_Product.szName as szProductNm_J,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,

BOS_SD_FInvoiceProductBonusItem.szOrderItemTypeId,
BOS_SD_FInvoiceProductBonusItem.decQty,
BOS_SD_FInvoiceProductBonusItem.szUomId,
BOS_SD_FInvoiceProductBonusItem.szProductBonusType,
BOS_SD_FInvoiceProductBonusItem.szParentId

FROM 
BOS_SD_FInvoiceProductBonusItem left join BOS_INV_Product on BOS_SD_FInvoiceProductBonusItem.szProductId = BOS_INV_Product.szProductId
WHERE 
BOS_SD_FInvoiceProductBonusItem.szFInvoiceId = p_szFInvoiceId ;ORDER BY 
BOS_SD_FInvoiceProductBonusItem.shItemNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetFInvoiceProductBonusItemBonusSource(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFDoId,
szProductId,
szProductSn,
szOrderItemTypeId,
szPaymentType,
decBonusAmount,
decBonusQty,
szParentId


FROM 
BOS_SD_FInvProductBonusItemBonusSource

WHERE 
szFInvoiceId = p_szFInvoiceId and shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetFInvoiceProductBonusItemBonusSource_013(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFDoId,
szProductId,
szProductSn,
szOrderItemTypeId,
szPaymentType,
decBonusAmount,
decBonusQty,
szParentId


FROM 
BOS_SD_FInvProductBonusItemBonusSource

WHERE 
szFInvoiceId = p_szFInvoiceId and shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetListOfFCallOfFInvoice(
p_szFInvoiceId BOS_DT_szId,
p_szCallType BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
FCall.szFCallId

FROM 
BOS_CRL_FCall as FCall
LEFT JOIN BOS_SD_CjrTracking as CjrTrackingLEFT JOIN BOS_SD_CjrTracking as CjrTracking;
on CjrTracking.szCjrTrackingId = FCall.szTrackingId and szCallType = p_szCallType
WHERE 
CjrTracking.szDocId = p_szFInvoiceId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetListOfFCallOfFInvoice_013(
p_szFInvoiceId BOS_DT_szId,
p_szCallType BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
FCall.szFCallId

FROM 
BOS_CRL_FCall as FCall
LEFT JOIN BOS_SD_CjrTracking as CjrTrackingLEFT JOIN BOS_SD_CjrTracking as CjrTracking;
on CjrTracking.szCjrTrackingId = FCall.szTrackingId and szCallType = p_szCallType
WHERE 
CjrTracking.szDocId = p_szFInvoiceId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetListOfFInvoice()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFInvoiceId,
dtmCreated,
szFInvoiceUsage

FROM 
BOS_SD_FInvoice

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetListOfFInvoiceItemForFakturPajak(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
InvItem.szProductId,
ISNULL(Prod.szName,'') AS szProductNm,
InvItem.decPrice,
SUM(InvItem.decQty) AS decQty,
InvItem.szInvItemType,
InvItem.bTaxable,
InvItem.szPaymentType,
InvItem.decDiscount


FROM 
BOS_SD_FInvoiceItem AS InvItem
LEFT JOIN BOS_INV_Product AS Prod ON Prod.szProductId = InvItem.szProductIdLEFT JOIN BOS_INV_Product AS Prod ON Prod.szProductId = InvItem.szProductId;

WHERE 
InvItem.szFinvoiceId=p_szFInvoiceId GROUP BY InvItem.szProductId, Prod.szName, InvItem.decPrice, InvItem.szInvItemType, InvItem.bTaxable, InvItem.szPaymentType, InvItem.decDiscount ;ORDER BY 
InvItem.szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetListOfFInvoiceItemForFakturPajak_013(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
InvItem.szProductId,
ISNULL(Prod.szName,'') AS szProductNm,
InvItem.decPrice,
SUM(InvItem.decQty) AS decQty,
InvItem.szInvItemType,
InvItem.bTaxable,
InvItem.szPaymentType,
InvItem.decDiscount


FROM 
BOS_SD_FInvoiceItem AS InvItem
LEFT JOIN BOS_INV_Product AS Prod ON Prod.szProductId = InvItem.szProductIdLEFT JOIN BOS_INV_Product AS Prod ON Prod.szProductId = InvItem.szProductId;

WHERE 
InvItem.szFinvoiceId=p_szFInvoiceId GROUP BY InvItem.szProductId, Prod.szName, InvItem.decPrice, InvItem.szInvItemType, InvItem.bTaxable, InvItem.szPaymentType, InvItem.decDiscount ;ORDER BY 
InvItem.szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetListOfRentalProductWhereCustomer(
p_szCustId BOS_DT_szId,
p_dtmDate timestamp)
RETURNS void AS
$BODY$
BEGIN

SELECT
-- Fields from StockSnProduct.
BOS_INV_StockSnProduct.szProductId as szProductId,
BOS_INV_StockSnProduct.dtmLastChecked AS dtmLastChecked_J,
BOS_INV_StockSnProduct.szSuppId AS szSuppId_J,
BOS_INV_StockSnProduct.szCheckerId AS szCheckerId_J,
BOS_INV_StockSnProduct.szChassisNumber AS szChassisNumber_J,

BOS_INV_Product.szName as szProductNm_J,
BOS_INV_Product.szDiscountGroupId as szProductDiscGroupId_J,
BOS_INV_Product.szUomId as szProductUomId_J,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,

BOS_GL_TaxType.decRate AS decProductTaxRate_J,

BOS_SD_RentalProduct.szSerNum,
BOS_SD_RentalProduct.szCustId,

BOS_SD_RentalProduct.szOrderItemType,
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,

BOS_SD_RentalProduct.bTaxable,
BOS_SD_RentalProduct.decCharge,
BOS_SD_RentalProduct.szCcyId,
BOS_SD_RentalProduct.dtmLastInvoiced,
BOS_SD_RentalProduct.dtmPrevLastInvoiced,
BOS_SD_RentalProduct.szStatusId,
BOS_SD_RentalProduct.bTrouble,
BOS_SD_RentalProduct.szTroubleDescr,
BOS_SD_RentalProduct.szRentChargeCalcId,
BOS_SD_RentalProduct.szUrl,
BOS_SD_RentalProduct.szTrnId,
BOS_SD_RentalProduct.szDocId,
BOS_SD_RentalProduct.szReasonId,

-- Data Status.
BOS_SD_RentalProduct.dtmLastUpdated,
BOS_SD_RentalProduct.bAlreadyTransferred

FROM 
BOS_SD_RentalProduct 
inner join BOS_AR_Customer on BOS_Ar_Customer.szCustId = BOS_SD_RentalProduct.szCustId
left join BOS_INV_StockSnProduct on BOS_INV_StockSnProduct.szProductSN = BOS_SD_RentalProduct.szSerNum
left join BOS_INV_Product on BOS_INV_Product.szProductId = BOS_INV_StockSnProduct.szProductId
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_SD_RentalProduct.szOrderItemType

WHERE
BOS_SD_RentalProduct.dtmLastInvoiced < p_dtmDate and 
BOS_SD_RentalProduct.bTrouble = 0 and
((BOS_AR_Customer.bInvoiceToCust = 1 and BOS_AR_Customer.szCustId = p_szCustId)  or  BOS_AR_Customer.szInvoiceToCustId = p_szCustId)

ORDER BY
BOS_SD_RentalProduct.szCustId, BOS_INV_StockSnProduct.szProductId, BOS_SD_RentalProduct.decCharge

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_GetListOfUnInvoicedFDo(
p_szInvToCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_AR_Customer.szCustId,

FROM 
BOS_SD_FDo
INNER JOIN BOS_AR_Customer on BOS_SD_FDo.szCustId = BOS_Ar_Customer.szCustIdINNER JOIN BOS_AR_Customer on BOS_SD_FDo.szCustId = BOS_Ar_Customer.szCustId;

WHERE 
BOS_SD_FDo.szFInvoiceId = '' and BOS_SD_FDo.bApplied = 1 and ( (BOS_AR_Customer.bInvoiceToCust = 1  and BOS_AR_Customer.szCustId = p_szInvToCustId)  or (BOS_AR_Customer.bInvoiceToCust = 0  and  BOS_AR_Customer.szInvoiceToCustId = p_szInvToCustId) ) and BOS_SD_FDo.dtmDelivery < DateAdd(Day, 1, p_dtmEnd) and BOS_SD_FDo.dtmDelivery >= p_dtmStart AND BOS_SD_FDo.szCcyId = p_szCcyId ;ORDER BY 
BOS_AR_Customer.szCustId,
BOS_SD_FDo.dtmDelivery,
BOS_SD_FDo.szDoId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_IsFInvoiceExist(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFInvoiceId

FROM 
BOS_SD_FInvoice
WHERE 
szFInvoiceId = p_szFInvoiceId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_IsFInvoiceExist_013(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFInvoiceId

FROM 
BOS_SD_FInvoice
WHERE 
szFInvoiceId = p_szFInvoiceId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_LockFInvoice(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
decAmount = decAmount
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_LockFInvoice_013(
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
decAmount = decAmount
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_MarkFInvoiceApplied(
p_szFInvoiceId BOS_DT_szId,
p_dtmCreated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
bApplied = 1,
dtmCreated = p_dtmCreated			--Yes, created date of invoice is the date when it is applied.

WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_MarkFInvoiceApplied_013(
p_szFInvoiceId BOS_DT_szId,
p_dtmCreated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
bApplied = 1,
dtmCreated = p_dtmCreated   --Yes, created date of invoice is the date when it is applied.

WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoice(
p_szFInvoiceId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_dtmPeriode timestamp,
p_szCancelToInvId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_decTax BOS_DT_decTax,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_decCcyRate BOS_DT_decCcyRate,
p_szPaymentTermId BOS_DT_szId,
p_szFInvoiceUsage varchar,
p_szChain_FirstId BOS_DT_szId,
p_szChain_NextId BOS_DT_szId,
p_szFirstFDoId_s BOS_DT_szId,
p_szSalesId BOS_DT_szId,
p_szReasonId BOS_DT_szId,
p_szRemark BOS_DT_szDescription,
p_cntBonusItem smallint,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bTaxReported bit,
p_szFakturPajakId BOS_DT_szId,
p_dtmFakturPajakCreated timestamp,
p_dtmInvoiceCorrected timestamp,
p_dtmInvoiceCanceled timestamp,
p_szCanceledByInvId BOS_DT_szId,
p_szCorrectedByInvId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
szSalesOrgId = p_szSalesOrgId,
szCustId = p_szCustId,
dtmPeriode = p_dtmPeriode,
szCancelToInvId = p_szCancelToInvId,
decAmount = p_decAmount,
decTax = p_decTax,
szCcyId = p_szCcyId,
szCcyRateId = p_szCcyRateId,
decCcyRate = p_decCcyRate,
szPaymentTermId = p_szPaymentTermId,
szFInvoiceUsage = p_szFInvoiceUsage,
szChain_FirstId = p_szChain_FirstId,
szChain_NextId = p_szChain_NextId,
szFirstFDoId_s = p_szFirstFDoId_s,
szSalesId = p_szSalesId,
szReasonId = p_szReasonId,
szRemark = p_szRemark,
cntBonusItem = p_cntBonusItem,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
--It is better to use these fields as the information of its last updated (or applied), rather than its data creation.
szUserId = p_szUserId,
dtmCreated = p_dtmCreated,
dtmLastUpdated = p_dtmLastUpdated,
bTaxReported = p_bTaxReported,
szFakturPajakId = p_szFakturPajakId,
dtmFakturPajakCreated = p_dtmFakturPajakCreated,
dtmInvoiceCorrected = p_dtmInvoiceCorrected,
dtmInvoiceCanceled = p_dtmInvoiceCanceled,
szCanceledByInvId = p_szCanceledByInvId,
szCorrectedByInvId = p_szCorrectedByInvId
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoice_013(
p_szFInvoiceId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_dtmPeriode timestamp,
p_szCancelToInvId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_decTax BOS_DT_decTax,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_decCcyRate BOS_DT_decCcyRate,
p_szPaymentTermId BOS_DT_szId,
p_szFInvoiceUsage varchar,
p_szChain_FirstId BOS_DT_szId,
p_szChain_NextId BOS_DT_szId,
p_szFirstFDoId_s BOS_DT_szId,
p_szSalesId BOS_DT_szId,
p_szReasonId BOS_DT_szId,
p_szRemark BOS_DT_szDescription,
p_cntBonusItem smallint,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bTaxReported bit,
p_szFakturPajakId BOS_DT_szId,
p_dtmFakturPajakCreated timestamp,
p_dtmInvoiceCorrected timestamp,
p_dtmInvoiceCanceled timestamp,
p_szCanceledByInvId BOS_DT_szId,
p_szCorrectedByInvId BOS_DT_szId,
p_AdcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
szSalesOrgId = p_szSalesOrgId,
szCustId = p_szCustId,
dtmPeriode = p_dtmPeriode,
szCancelToInvId = p_szCancelToInvId,
decAmount = p_decAmount,
decTax = p_decTax,
szCcyId = p_szCcyId,
szCcyRateId = p_szCcyRateId,
decCcyRate = p_decCcyRate,
szPaymentTermId = p_szPaymentTermId,
szFInvoiceUsage = p_szFInvoiceUsage,
szChain_FirstId = p_szChain_FirstId,
szChain_NextId = p_szChain_NextId,
szFirstFDoId_s = p_szFirstFDoId_s,
szSalesId = p_szSalesId,
szReasonId = p_szReasonId,
szRemark = p_szRemark,
cntBonusItem = p_cntBonusItem,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
--It is better to use these fields as the information of its last updated (or applied), rather than its data creation.
szUserId = p_szUserId,
dtmCreated = p_dtmCreated,
dtmLastUpdated = p_dtmLastUpdated,
bTaxReported = p_bTaxReported,
szFakturPajakId = p_szFakturPajakId,
dtmFakturPajakCreated = p_dtmFakturPajakCreated,
dtmInvoiceCorrected = p_dtmInvoiceCorrected,
dtmInvoiceCanceled = p_dtmInvoiceCanceled,
szCanceledByInvId = p_szCanceledByInvId,
szCorrectedByInvId = p_szCorrectedByInvId,
AdcId=p_AdcId
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceCancel(
p_szFInvoiceId BOS_DT_szId,
p_szCanceledByInvId BOS_DT_szId,
p_dtmInvoiceCanceled timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
szCanceledByInvId = p_szCanceledByInvId,
dtmInvoiceCanceled = p_dtmInvoiceCanceled
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceCancel_013(
p_szFInvoiceId BOS_DT_szId,
p_szCanceledByInvId BOS_DT_szId,
p_dtmInvoiceCanceled timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
szCanceledByInvId = p_szCanceledByInvId,
dtmInvoiceCanceled = p_dtmInvoiceCanceled
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceCorrect(
p_szFInvoiceId BOS_DT_szId,
p_szCorrectedByInvId BOS_DT_szId,
p_dtmInvoiceCorrected timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
szCorrectedByInvId = p_szCorrectedByInvId,
dtmInvoiceCorrected = p_dtmInvoiceCorrected
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceCorrect_013(
p_szFInvoiceId BOS_DT_szId,
p_szCorrectedByInvId BOS_DT_szId,
p_dtmInvoiceCorrected timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
szCorrectedByInvId = p_szCorrectedByInvId,
dtmInvoiceCorrected = p_dtmInvoiceCorrected
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceItem_ByItem(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szDoId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szInvItemType BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_szFInvoiceItemUsage varchar,
p_decCOGS BOS_DT_decAmount,
p_szPrincipalDiscRefId BOS_DT_szId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoiceItem
SET 
szDoId = p_szDoId,
szOrderItemTypeId = p_szOrderItemTypeId,
szProductId = p_szProductId,
szProductSN = p_szProductSN,

szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
decDiscProcent = p_decDiscProcent,

decQty = p_decQty,
decUomQty = p_decUomQty,

szUomId = p_szUomId,
decPrice = p_decPrice,
decDiscount = p_decDiscount,
bTaxable = p_bTaxable,
decTax = p_decTax,
decAmount = p_decAmount,
decDPP = p_decDPP,
szPaymentType = p_szPaymentType,
szInvItemType = p_szInvItemType,
szDescription = p_szDescription,
szFInvoiceItemUsage = p_szFInvoiceItemUsage,

decCOGS = p_decCOGS,
szPrincipalDiscRefId = p_szPrincipalDiscRefId,
szParentId = p_szParentId
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceItem_ByItem_013(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szDoId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szInvItemType BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_szFInvoiceItemUsage varchar,
p_decCOGS BOS_DT_decAmount,
p_szPrincipalDiscRefId BOS_DT_szId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoiceItem
SET 
szDoId = p_szDoId,
szOrderItemTypeId = p_szOrderItemTypeId,
szProductId = p_szProductId,
szProductSN = p_szProductSN,

szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
decDiscProcent = p_decDiscProcent,

decQty = p_decQty,
decUomQty = p_decUomQty,

szUomId = p_szUomId,
decPrice = p_decPrice,
decDiscount = p_decDiscount,
bTaxable = p_bTaxable,
decTax = p_decTax,
decAmount = p_decAmount,
decDPP = p_decDPP,
szPaymentType = p_szPaymentType,
szInvItemType = p_szInvItemType,
szDescription = p_szDescription,
szFInvoiceItemUsage = p_szFInvoiceItemUsage,

decCOGS = p_decCOGS,
szPrincipalDiscRefId = p_szPrincipalDiscRefId,
szParentId = p_szParentId
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceItem_ByItem_014(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szDoId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szInvItemType BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_szFInvoiceItemUsage varchar,
p_decCOGS BOS_DT_decAmount,
p_szPrincipalDiscRefId BOS_DT_szId,
p_szParentId BOS_DT_szId,
p_szDistProductId BOS_DT_szId,
p_decDistQty BOS_DT_decAmount,
p_decDistPrice BOS_DT_decPrice)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoiceItem
SET 
szDoId = p_szDoId,
szOrderItemTypeId = p_szOrderItemTypeId,
szProductId = p_szProductId,
szProductSN = p_szProductSN,

szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
decDiscProcent = p_decDiscProcent,

decQty = p_decQty,
decUomQty = p_decUomQty,

szUomId = p_szUomId,
decPrice = p_decPrice,
decDiscount = p_decDiscount,
bTaxable = p_bTaxable,
decTax = p_decTax,
decAmount = p_decAmount,
decDPP = p_decDPP,
szPaymentType = p_szPaymentType,
szInvItemType = p_szInvItemType,
szDescription = p_szDescription,
szFInvoiceItemUsage = p_szFInvoiceItemUsage,

decCOGS = p_decCOGS,
szPrincipalDiscRefId = p_szPrincipalDiscRefId,
szParentId = p_szParentId,

szDistProductId = p_szDistProductId,
decDistQty = p_decDistQty,
decDistPrice = p_decDistPrice
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceItem_ByItem_015(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szDoId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szInvItemType BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_szFInvoiceItemUsage varchar,
p_decCOGS BOS_DT_decAmount,
p_szPrincipalDiscRefId BOS_DT_szId,
p_szParentId BOS_DT_szId,
p_szDistProductId BOS_DT_szId,
p_decDistQty BOS_DT_decAmount,
p_decDistPrice BOS_DT_decPrice,
p_szBudgetId BOS_DT_szId,
p_decPrincipalCostAmount BOS_DT_decAmount,
p_decPrincipalCostQty BOS_DT_decAmount,
p_bBudgetTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoiceItem
SET 
szDoId = p_szDoId,
szOrderItemTypeId = p_szOrderItemTypeId,
szProductId = p_szProductId,
szProductSN = p_szProductSN,

szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
decDiscProcent = p_decDiscProcent,

decQty = p_decQty,
decUomQty = p_decUomQty,

szUomId = p_szUomId,
decPrice = p_decPrice,
decDiscount = p_decDiscount,
bTaxable = p_bTaxable,
decTax = p_decTax,
decAmount = p_decAmount,
decDPP = p_decDPP,
szPaymentType = p_szPaymentType,
szInvItemType = p_szInvItemType,
szDescription = p_szDescription,
szFInvoiceItemUsage = p_szFInvoiceItemUsage,

decCOGS = p_decCOGS,
szPrincipalDiscRefId = p_szPrincipalDiscRefId,
szParentId = p_szParentId,

szDistProductId = p_szDistProductId,
decDistQty = p_decDistQty,
decDistPrice = p_decDistPrice,

szBudgetId = p_szBudgetId,
decPrincipalCostAmount = p_decPrincipalCostAmount,
decPrincipalCostQty = p_decPrincipalCostQty,
bBudgetTransferred = p_bBudgetTransferred

WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceItemBonusSource_ByItem(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szFDoId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_decBonusAmount BOS_DT_decAmount,
p_decBonusQty BOS_DT_decAmount,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvItemBonusSource
SET 
decBonusAmount = p_decBonusAmount,
decBonusQty = p_decBonusQty
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceItemBonusSource_ByItem_013(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szFDoId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_decBonusAmount BOS_DT_decAmount,
p_decBonusQty BOS_DT_decAmount,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvItemBonusSource
SET 
decBonusAmount = p_decBonusAmount,
decBonusQty = p_decBonusQty
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceLocation(
p_szFInvoiceId BOS_DT_szId,
p_szCurrentLocWpId varchar,
p_szTransitLocWpId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
szCurrentLocWpId = p_szCurrentLocWpId,
szTransitLocWpId = p_szTransitLocWpId


WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceLocation_013(
p_szFInvoiceId BOS_DT_szId,
p_szCurrentLocWpId varchar,
p_szTransitLocWpId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
szCurrentLocWpId = p_szCurrentLocWpId,
szTransitLocWpId = p_szTransitLocWpId


WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceProductBonusItem_ByItem(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szProductBonusType BOS_DT_szSmallId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoiceProductBonusItem
SET 
szProductId = p_szProductId,
szOrderItemTypeId = p_szOrderItemTypeId,
decQty = p_decQty,
szUomId = p_szUomId,
szProductBonusType = p_szProductBonusType,
szParentId = p_szParentId
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceProductBonusItem_ByItem_013(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szProductBonusType BOS_DT_szSmallId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoiceProductBonusItem
SET 
szProductId = p_szProductId,
szOrderItemTypeId = p_szOrderItemTypeId,
decQty = p_decQty,
szUomId = p_szUomId,
szProductBonusType = p_szProductBonusType,
szParentId = p_szParentId
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceProductBonusItemBonusSource_ByItem(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szFDoId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_decBonusAmount BOS_DT_decAmount,
p_decBonusQty BOS_DT_decAmount,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvProductBonusItemBonusSource
SET 
decBonusAmount = p_decBonusAmount,
decBonusQty = p_decBonusQty
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceProductBonusItemBonusSource_ByItem_013(
p_szFInvoiceId BOS_DT_szId,
p_shItemNumber smallint,
p_szFDoId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn BOS_DT_szSN,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_decBonusAmount BOS_DT_decAmount,
p_decBonusQty BOS_DT_decAmount,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvProductBonusItemBonusSource
SET 
decBonusAmount = p_decBonusAmount,
decBonusQty = p_decBonusQty
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceStatusBad(
p_szFInvoiceId BOS_DT_szId,
p_szFInvoiceStatus varchar,
p_dtmBad timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
szFInvoiceStatus = p_szFInvoiceStatus,
dtmBad = p_dtmBad
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceStatusBad_013(
p_szFInvoiceId BOS_DT_szId,
p_szFInvoiceStatus varchar,
p_dtmBad timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
szFInvoiceStatus = p_szFInvoiceStatus,
dtmBad = p_dtmBad
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceStatusDoubt(
p_szFInvoiceId BOS_DT_szId,
p_szFInvoiceStatus varchar,
p_dtmDoubt timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
szFInvoiceStatus = p_szFInvoiceStatus,
dtmDoubt = p_dtmDoubt
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceStatusDoubt_013(
p_szFInvoiceId BOS_DT_szId,
p_szFInvoiceStatus varchar,
p_dtmDoubt timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
szFInvoiceStatus = p_szFInvoiceStatus,
dtmDoubt = p_dtmDoubt
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceStatusNormal(
p_szFInvoiceId BOS_DT_szId,
p_szFInvoiceStatus varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
szFInvoiceStatus = p_szFInvoiceStatus
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateFInvoiceStatusNormal_013(
p_szFInvoiceId BOS_DT_szId,
p_szFInvoiceStatus varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
szFInvoiceStatus = p_szFInvoiceStatus
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateNextInvoiceChain(
p_szFInvoiceId BOS_DT_szId,
p_szChain_NextId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
szChain_NextId = p_szChain_NextId
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateNextInvoiceChain_013(
p_szFInvoiceId BOS_DT_szId,
p_szChain_NextId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
szChain_NextId = p_szChain_NextId
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateTaxReported(
p_szFInvoiceId BOS_DT_szId,
p_szFakturPajakId BOS_DT_szId,
p_bTaxReported bit,
p_dtmFakturPajakCreated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
bTaxReported = p_bTaxReported,
szFakturPajakId = dbo.KGenFInvoiceToBeFaktured(p_bTaxReported, p_szFakturPajakId),
dtmFakturPajakCreated = p_dtmFakturPajakCreated
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoice_UpdateTaxReported_013(
p_szFInvoiceId BOS_DT_szId,
p_szFakturPajakId BOS_DT_szId,
p_bTaxReported bit,
p_dtmFakturPajakCreated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoice
SET 
bTaxReported = p_bTaxReported,
szFakturPajakId = dbo.KGenFInvoiceToBeFaktured(p_bTaxReported, p_szFakturPajakId),
dtmFakturPajakCreated = p_dtmFakturPajakCreated
WHERE 
szFInvoiceId = p_szFInvoiceId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoiceConvert_CreateFInvoiceConvert(
p_szFInvoiceConvId BOS_DT_szId,
p_dtmDoc timestamp,
p_szFInvoiceStatus varchar,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvoiceConvert
(
szFInvoiceConvId,
dtmDoc,
szFInvoiceStatus,
bResultFrTransfer,
bVoid,
bApproved,
bApplied,
bJournal,
bPosted,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szApprovalId,
szFJournalId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
)
VALUES
(
p_szFInvoiceConvId,
p_dtmDoc,
p_szFInvoiceStatus,
p_bResultFrTransfer,
p_bVoid,
p_bApproved,
p_bApplied,
p_bJournal,
p_bPosted,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szApprovalId,
p_szFJournalId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoiceConvert_CreateFInvoiceConvertItem(
p_szFInvoiceConvId BOS_DT_szId,
p_shItemNumber smallint,
p_szFInvoiceId BOS_DT_szId,
p_szReasonId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvoiceConvertItem
(
szFInvoiceConvId,
shItemNumber,
szFInvoiceId,
szReasonId
)
VALUES
(
p_szFInvoiceConvId,
p_shItemNumber,
p_szFInvoiceId,
p_szReasonId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoiceConvert_CreateFInvoiceConvertItem_013(
p_szFInvoiceConvId BOS_DT_szId,
p_shItemNumber smallint,
p_szFInvoiceId BOS_DT_szId,
p_szReasonId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvoiceConvertItem
(
szFInvoiceConvId,
shItemNumber,
szFInvoiceId,
szReasonId
)
VALUES
(
p_szFInvoiceConvId,
p_shItemNumber,
p_szFInvoiceId,
p_szReasonId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoiceConvert_DeleteFInvoiceConvert(
p_szFInvoiceConvId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SD_FInvoiceConvert
WHERE
szFInvoiceConvId = p_szFInvoiceConvId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoiceConvert_DeleteFInvoiceConvertItem(
p_szFInvoiceConvId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FInvoiceConvertItem
WHERE
szFInvoiceConvId = p_szFInvoiceConvId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoiceConvert_GetFInvoiceConvert(
p_szFInvoiceConvId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
Select

BOS_SD_FInvoiceConvert.szFInvoiceConvId,
BOS_SD_FInvoiceConvert.dtmDoc,
BOS_SD_FInvoiceConvert.szFInvoiceStatus,
BOS_SD_FInvoiceConvert.bResultFrTransfer,
BOS_SD_FInvoiceConvert.bVoid,
BOS_GEN_Approved.bApproved,
BOS_SD_FInvoiceConvert.bApplied,
BOS_GL_FJournalTrans.szFJournalId AS bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_SD_FInvoiceConvert.btPrintedCount,
BOS_SD_FInvoiceConvert.bTransferred,
BOS_SD_FInvoiceConvert.szCompanyId,
BOS_SD_FInvoiceConvert.szWorkplaceId,
BOS_SD_FInvoiceConvert.szTaxEntityId,
BOS_SD_FInvoiceConvert.bNeedApproval,
BOS_GEN_Approved.szApprovalId,
BOS_SD_FInvoiceConvert.gdApprovedId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_SD_FInvoiceConvert.dtmLastUpdated,
BOS_SD_FInvoiceConvert.bAlreadyTransferred


From
BOS_SD_FInvoiceConvert
LEFT JOIN BOS_AR_ArTrans ON 
BOS_SD_FInvoiceConvert.szFInvoiceConvId = BOS_AR_ArTrans.szDocId
LEFT JOIN BOS_GEN_Approved ON 
BOS_SD_FInvoiceConvert.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON 
BOS_SD_FInvoiceConvert.szFJournalId = BOS_GL_FJournalTrans.szFJournalId

Where
BOS_SD_FInvoiceConvert.szFInvoiceConvId = p_szFInvoiceConvId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoiceConvert_GetFInvoiceConvertItem(
p_szFInvoiceConvId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_FInvoiceConvertItem.shItemNumber,
BOS_SD_FInvoiceConvertItem.szFInvoiceId,
BOS_SD_FInvoice.dtmPeriode,
BOS_SD_FInvoice.szCustId,
BOS_AR_Customer.szName as szCustNm,
BOS_AR_ArTrans.decAmount,
BOS_AR_ArTrans.decRemain,
BOS_SD_FInvoice.szCcyId,
BOS_CU_Currency.szAmountFormat,
BOS_SD_FInvoiceConvertItem.szReasonId,
IsNull(BOS_GEN_Reason.szDescription, '') As szReasonDescription
FROM
BOS_SD_FInvoiceConvertItem LEFT JOIN BOS_SD_FInvoice ON 	BOS_SD_FInvoice.szFInvoiceId = BOS_SD_FInvoiceConvertItem.szFInvoiceId
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_FInvoice.szCustId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FInvoice.szCcyId
LEFT JOIN BOS_AR_ArTrans ON BOS_AR_ArTrans.szTrnId = 'FInv'
LEFT JOIN BOS_GEN_Reason ON BOS_GEN_Reason.szReasonId = BOS_SD_FInvoiceConvertItem.szReasonId
WHERE
BOS_SD_FInvoiceConvertItem.szFInvoiceConvId = p_szFInvoiceConvId AND
BOS_AR_ArTrans.szDocId = BOS_SD_FInvoice.szFInvoiceId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoiceConvert_GetFInvoiceConvertItemWhereFInvoiceId(
p_szFInvoiceId BOS_DT_szId,
p_szFInvoiceStatus varchar)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_FInvoice.dtmPeriode,
BOS_SD_FInvoice.szCustId,
BOS_AR_Customer.szName as szCustNm,
BOS_AR_ArTrans.decAmount,
BOS_AR_ArTrans.decRemain,
BOS_SD_FInvoice.szCcyId,
BOS_CU_Currency.szAmountFormat
FROM
BOS_SD_FInvoice LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_FInvoice.szCustId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FInvoice.szCcyId
LEFT JOIN BOS_AR_ArTrans ON BOS_AR_ArTrans.szTrnId = 'FInv'
WHERE
BOS_AR_ArTrans.szDocId = BOS_SD_FInvoice.szFInvoiceId AND BOS_AR_ArTrans.szCustId = BOS_SD_FInvoice.szCustId AND
BOS_AR_ArTrans.bClosed = 0 AND
BOS_SD_FInvoice.szFInvoiceStatus = p_szFInvoiceStatus AND
BOS_SD_FInvoice.szFInvoiceId = p_szFInvoiceId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoiceConvert_GetFInvoiceConvertItemWhereFInvoiceId_013(
p_szFInvoiceId BOS_DT_szId,
p_szFInvoiceStatus varchar)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_SD_FInvoice.dtmPeriode,  
BOS_SD_FInvoice.szCustId,  
BOS_AR_Customer.szName as szCustNm,  
BOS_AR_ArTrans.decAmount,  
BOS_AR_ArTrans.decRemain,  
BOS_SD_FInvoice.szCcyId,  
BOS_CU_Currency.szAmountFormat  
FROM  
BOS_SD_FInvoice LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_FInvoice.szCustId  
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FInvoice.szCcyId  
LEFT JOIN BOS_AR_ArTrans ON BOS_AR_ArTrans.szTrnId = 'FInv'  
WHERE  
BOS_AR_ArTrans.szDocId = BOS_SD_FInvoice.szFInvoiceId AND BOS_AR_ArTrans.szCustId = BOS_SD_FInvoice.szCustId AND  
BOS_AR_ArTrans.bClosed = 0 AND  
BOS_SD_FInvoice.szFInvoiceStatus = p_szFInvoiceStatus AND  
BOS_SD_FInvoice.szFInvoiceId = p_szFInvoiceId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoiceConvert_GetListFinvoiceWhereStatus(
p_szFInvoiceStatus varchar,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_FInvoice.szFInvoiceId,
BOS_SD_FInvoice.dtmPeriode,
BOS_SD_FInvoice.szCustId,
BOS_AR_Customer.szName as szCustNm,
BOS_AR_ArTrans.decAmount,
BOS_AR_ArTrans.decRemain,
BOS_SD_FInvoice.szCcyId,
BOS_CU_Currency.szAmountFormat
FROM
BOS_AR_ArTrans INNER JOIN BOS_SD_FInvoice ON BOS_AR_ArTrans.szDocId = BOS_SD_FInvoice.szFInvoiceId And BOS_AR_ArTrans.szCustId = BOS_SD_FInvoice.szCustId
LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_FInvoice.szCustId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FInvoice.szCcyId
WHERE
BOS_AR_ArTrans.szTrnId = 'FInv' And
BOS_AR_ArTrans.bClosed = 0 AND
BOS_SD_FInvoice.szFInvoiceStatus = p_szFInvoiceStatus AND
(BOS_SD_FInvoice.dtmPeriode >= p_dtmStart and BOS_SD_FInvoice.dtmPeriode < dateadd(day,1, p_dtmEnd))

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoiceConvert_IsFInvoiceConvertExist(
p_szFInvoiceConvId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFInvoiceConvId

FROM 
BOS_SD_FInvoiceConvert
WHERE 
szFInvoiceConvId = p_szFInvoiceConvId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoiceConvert_LockFInvoiceConvert(
p_szFInvoiceConvId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoiceConvert
SET 
szFInvoiceStatus = szFInvoiceStatus
WHERE 
szFInvoiceConvId = p_szFInvoiceConvId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoiceConvert_MarkFInvoiceConvertApplied(
p_szFInvoiceConvId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoiceConvert
SET 
bApplied = 1
WHERE 
szFInvoiceConvId = p_szFInvoiceConvId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoiceConvert_MarkVoid(
p_szFInvoiceConvertId BOS_DT_szId,
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoiceConvert
SET 
bVoid = 1,
bNeedApproval = 0,
gdApprovedId = p_gdApprovedId
WHERE 
szFInvoiceConvId = p_szFInvoiceConvertId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvoiceConvert_UpdateFInvoiceConvert(
p_szFInvoiceConvId BOS_DT_szId,
p_dtmDoc timestamp,
p_szFInvoiceStatus varchar,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvoiceConvert
SET 
szFInvoiceConvId = p_szFInvoiceConvId,
dtmDoc = p_dtmDoc,
szFInvoiceStatus = p_szFInvoiceStatus,
bResultFrTransfer = p_bResultFrTransfer,
bVoid = p_bVoid,
bApproved = p_bApproved,
bApplied = p_bApplied,
bJournal = p_bJournal,
bPosted = p_bPosted,
btPrintedCount = p_btPrintedCount,
bTransferred = p_bTransferred,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
szApprovalId = p_szApprovalId,
szFJournalId = p_szFJournalId
WHERE 
szFInvoiceConvId = p_szFInvoiceConvId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvOpname_CreateFInvOpname(
p_szFInvOpnameId BOS_DT_szId,
p_dtmOpname timestamp,
p_szDescription BOS_DT_szDescription,
p_szLocWorkplaceId BOS_DT_szId,
p_szKeptByOpUserId BOS_DT_szId,
p_bOnlyClosedInv smallint,
p_szOpnameStatus BOS_DT_szSmallName,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvOpname
(
szFInvOpnameId,
dtmOpname,
szDescription,
szLocWorkplaceId,
szKeptByOpUserId,
bOnlyClosedInv,
szOpnameStatus,
--Doc Status.,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
--Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFInvOpnameId,
p_dtmOpname,
p_szDescription,
p_szLocWorkplaceId,
p_szKeptByOpUserId,
p_bOnlyClosedInv,
p_szOpnameStatus,
--Doc Status.,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
--Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvOpname_CreateFInvOpnameItem(
p_szFInvOpnameId BOS_DT_szId,
p_szFInvoiceId BOS_DT_szId,
p_szStatus BOS_DT_szId,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvOpnameItem
(
szFInvOpnameId,
szFInvoiceId,
szStatus,
szDescription
)
VALUES
(
p_szFInvOpnameId,
p_szFInvoiceId,
p_szStatus,
p_szDescription
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvOpname_CreateFInvOpnameItem_013(
p_szFInvOpnameId BOS_DT_szId,
p_szFInvoiceId BOS_DT_szId,
p_szStatus BOS_DT_szId,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FInvOpnameItem
(
szFInvOpnameId,
szFInvoiceId,
szStatus,
szDescription
)
VALUES
(
p_szFInvOpnameId,
p_szFInvoiceId,
p_szStatus,
p_szDescription
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvOpname_DeleteFInvOpname(
p_szFInvOpnameId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SD_FInvOpname
WHERE
szFInvOpnameId = p_szFInvOpnameId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvOpname_DeleteFInvOpnameItem(
p_szFInvOpnameId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SD_FInvOpnameItem
WHERE
szFInvOpnameId = p_szFInvOpnameId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvOpname_GetFInvOpname(
p_szFInvOpnameId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FInvOpname.szFInvOpnameId,
BOS_SD_FInvOpname.dtmOpname,
BOS_SD_FInvOpname.szDescription,
BOS_SD_FInvOpname.szLocWorkplaceId,
CollWp.szName  AS szLocWorkplaceNm_J,
BOS_SD_FInvOpname.szKeptByOpUserId,
BOS_PI_Employee.szName  AS szKeptByUserNm_J,
BOS_SD_FInvOpname.bOnlyClosedInv,
BOS_SD_FInvOpname.szOpnameStatus,		

BOS_SD_FInvOpname.bResultFrTransfer,
BOS_SD_FInvOpname.bVoid,
BOS_GEN_Approved.bApproved,
BOS_SD_FInvOpname.bApplied,
BOS_GL_FJournalTrans.szFJournalId as bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_SD_FInvOpname.btPrintedCount,
BOS_SD_FInvOpname.bTransferred,
BOS_SD_FInvOpname.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_SD_FInvOpname.szWorkplaceId,
BOS_GL_Workplace.szName as szWorkplaceNm,
BOS_SD_FInvOpname.szTaxEntityId,
BOS_SD_FInvOpname.bNeedApproval,
BOS_SD_FInvOpname.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_SD_FInvOpname.dtmCreated,
BOS_SD_FInvOpname.bSystemCreated,
BOS_SD_FInvOpname.szUserId,
BOS_SM_User.szName AS szUserNm_J,

BOS_SD_FInvOpname.dtmLastUpdated,
BOS_SD_FInvOpname.bAlreadyTransferred
FROM
BOS_SD_FInvOpname
LEFT JOIN BOS_GEN_Approved ON BOS_SD_FInvOpname.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FInvOpname.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FInvOpname.szCompanyId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FInvOpname.szWorkplaceId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FInvOpname.szUserId
LEFT JOIN BOS_GL_Workplace AS CollWp ON CollWp.szWorkplaceId = BOS_SD_FInvOpname.szLocWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FInvOpname.szKeptByOpUserId
WHERE
szFInvOpnameId = p_szFInvOpnameId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvOpname_GetFInvOpnameItem(
p_szFInvOpnameId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FInvOpnameItem.szFInvoiceId,
BOS_SD_FInvOpnameItem.szStatus,
BOS_SD_FInvOpnameItem.szDescription,
BOS_AR_ArTrans.decAmount AS decInvAmount_J,
BOS_AR_ArTrans.decRemain AS decRemain_J,
BOS_SD_FInvoice.szKeptByOpUserId,
BOS_SD_FInvoice.szLastFInvOpnameId AS szLastOpnameId_J,
BOS_SD_FInvOpname.dtmOpname  AS dtmLastOpname_J,
BOS_PI_Employee.szName AS szLastKeptByNm_J,
BOS_CU_Currency.szAmountFormat AS szAmountFormat_J,
BOS_SD_FInvoice.szCcyId AS szAmountCcyId_J,
BOS_SD_FInvoice.btPrintedCount AS btPrintedCount_J,
BOS_SD_FInvoice.szCurrentLocWpId AS szCurrentLocWpId_J,
CURR_LOC.szName AS szCurrentLocWpNm_J,
BOS_SD_FInvoice.szTransitLocWpId AS szTransitLocWpId_J,
TRN_LOC.szName AS szTransitLocWpNm_J,
BOS_SD_FInvOpname.szKeptByOpUserId AS szOpnamedOpUserId_J,
BPE.szName AS szOpnamedOpUserNm_J
FROM 
BOS_SD_FInvOpnameItem
LEFT JOIN BOS_AR_ArTrans ON BOS_AR_ArTrans.szDocId = BOS_SD_FInvOpnameItem.szFInvoiceId
AND BOS_AR_ArTrans.szTrnId = 'FInv' 
AND BOS_AR_ArTrans.shRevNo = 0
LEFT JOIN BOS_SD_FInvoice ON BOS_SD_FInvoice.szFInvoiceId = BOS_SD_FInvOpnameItem.szFInvoiceId
LEFT JOIN BOS_SD_FInvOpname ON BOS_SD_FInvOpname.szFInvOpnameId = BOS_SD_FInvoice.szLastFInvOpnameId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FInvoice.szKeptByOpUserId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FInvoice.szCcyId
LEFT JOIN BOS_GL_Workplace AS CURR_LOC  ON CURR_LOC.szWorkplaceId = BOS_SD_FInvoice.szCurrentLocWpId
LEFT JOIN BOS_GL_Workplace AS TRN_LOC  ON TRN_LOC.szWorkplaceId = BOS_SD_FInvoice.szTransitLocWpId
LEFT JOIN BOS_PI_Employee AS BPE ON BPE.szEmployeeId = BOS_SD_FInvOpname.szKeptByOpUserId

WHERE
BOS_SD_FInvOpnameItem.szFInvOpnameId = p_szFInvOpnameId

ORDER BY
BOS_SD_FInvOpnameItem.szStatus

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvOpname_IsExistFInvOpname(
p_szFInvOpnameId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFInvOpnameId

FROM 
BOS_SD_FInvOpname
WHERE 
szFInvOpnameId = p_szFInvOpnameId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvOpname_LockFInvOpname(
p_szFInvOpnameId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvOpname
SET 
 dtmOpname = dtmOpname
WHERE 
szFInvOpnameId = p_szFInvOpnameId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FInvOpname_UpdateFInvOpname(
p_szFInvOpnameId BOS_DT_szId,
p_dtmOpname timestamp,
p_szDescription BOS_DT_szDescription,
p_szLocWorkplaceId BOS_DT_szId,
p_szKeptByOpUserId BOS_DT_szId,
p_bOnlyClosedInv smallint,
p_szOpnameStatus BOS_DT_szSmallName,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FInvOpname
SET 
dtmOpname = p_dtmOpname,
szDescription = p_szDescription,
szLocWorkplaceId = p_szLocWorkplaceId,
szKeptByOpUserId = p_szKeptByOpUserId,
bOnlyClosedInv = p_bOnlyClosedInv,
szOpnameStatus = p_szOpnameStatus,

bResultFrTransfer = p_bResultFrTransfer,
bVoid = p_bVoid,
bApplied = p_bApplied,
btPrintedCount = p_btPrintedCount,
bTransferred = p_bTransferred,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,
szFJournalId = p_szFJournalId,
dtmCreated = p_dtmCreated,
bSystemCreated = p_bSystemCreated,
szUserId = p_szUserId,
-- Data Status.
dtmLastUpdated = p_dtmLastUpdated,
bAlreadyTransferred = p_bAlreadyTransferred
WHERE 
szFInvOpnameId = p_szFInvOpnameId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Foc_CreateFoc(
p_szFocId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_Foc
(
szFocId,
szDescription,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFocId,
p_szDescription,
-- Data Status.,
p_dtmLastUpdated ,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Foc_CreateFocItem(
p_szFocId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szFocType BOS_DT_szSmallId,
p_bUnlimitedQty bit,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FocItem
(
szFocId,
szProductId,
szFocType,
bUnlimitedQty,
decQty,
szUomId
)
VALUES
(
p_szFocId,
p_szProductId,
p_szFocType,
p_bUnlimitedQty,
p_decQty,
p_szUomId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Foc_DeleteFoc(
p_szFocId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_SD_Foc
WHERE
szFocId = p_szFocId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Foc_DeleteFocItem(
p_szFocId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_SD_FocItem
WHERE
szFocId = p_szFocId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Foc_GetFoc(
p_szFocId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFocId,
szDescription,
dtmLastUpdated,
bAlreadyTransferred


FROM 
BOS_SD_Foc
WHERE 
szFocId = p_szFocId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Foc_GetFocItem(
p_szFocId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FocItem.szFocId,
BOS_SD_FocItem.szProductId,
BOS_INV_Product.szName as szProductName,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_SD_FocItem.szFocType,
BOS_SD_FocItem.bUnlimitedQty,
BOS_SD_FocItem.decQty,
BOS_SD_FocItem.szUomId

FROM 
BOS_SD_FocItem left join BOS_INV_Product on BOS_SD_FocItem.szProductId = BOS_INV_Product.szProductId
WHERE 
szFocId = p_szFocId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Foc_GetListOfFoc()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFocId,
szDescription

FROM 
BOS_SD_Foc

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Foc_IsFocExist(
p_szFocId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFocId

FROM 
BOS_SD_Foc
WHERE 
szFocId = p_szFocId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Foc_LockFoc(
p_szFocId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_Foc
SET 
szDescription = szDescription
WHERE 
szFocId = p_szFocId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Foc_UpdateFoc(
p_szFocId BOS_DT_szId,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_Foc
SET 
szDescription = p_szDescription
WHERE 
szFocId = p_szFocId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FPr_CreateFPr(
p_szFPrId BOS_DT_szId,
p_dtmRequest timestamp,
p_szRequestToWpId BOS_DT_szId,
p_szRequestToWhId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_szHelperId_1 BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FPr
(
szFPrId,
dtmRequest,
szRequestToWpId,
szRequestToWhId,
szDriverId,
szVehicleId,
szStatus,
szDescription,
szHelperId_1,
szHelperId_2,
szHelperId_3,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFPrId,
p_dtmRequest,
p_szRequestToWpId,
p_szRequestToWhId,
p_szDriverId,
p_szVehicleId,
p_szStatus,
p_szDescription,
p_szHelperId_1,
p_szHelperId_2,
p_szHelperId_3,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FPr_CreateFPr_014(
p_szFPrId BOS_DT_szId,
p_dtmRequest timestamp,
p_szRequestToWpId BOS_DT_szId,
p_szRequestToWhId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId,
p_szDescription BOS_DT_szDescription,
p_szHelperId_1 BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FPr
(
szFPrId,
dtmRequest,
szRequestToWpId,
szRequestToWhId,
szDriverId,
szVehicleId,
szStatus,
szDescription,
szHelperId_1,
szHelperId_2,
szHelperId_3,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFPrId,
p_dtmRequest,
p_szRequestToWpId,
p_szRequestToWhId,
p_szDriverId,
p_szVehicleId,
p_szStatus,
p_szDescription,
p_szHelperId_1,
p_szHelperId_2,
p_szHelperId_3,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FPr_CreateFPrItem(
p_szFPrId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_decReleased BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FPrItem
(
szFPrId,
shItemNumber,
szProductId,
decQty,
decUomQty,
decReleased,
szUomId,
szParentId
)
VALUES
(
p_szFPrId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_decReleased,
p_szUomId,
p_szParentId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FPr_CreateFPrItem_014(
p_szFPrId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_decReleased BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FPrItem
(
szFPrId,
shItemNumber,
szProductId,
decQty,
decUomQty,
decReleased,
szUomId,
szParentId
)
VALUES
(
p_szFPrId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_decUomQty,
p_decReleased,
p_szUomId,
p_szParentId,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FPr_DeleteFPr(
p_szFPrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FPr
WHERE
szFPrId = p_szFPrId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FPr_DeleteFPrItem(
p_szFPrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FPrItem
WHERE
szFPrId = p_szFPrId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FPr_GetFPr(
p_szFPrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_SD_FPr.dtmRequest,  

BOS_SD_FPr.szRequestToWpId,  
RequestWp.szName AS szRequestToWpNm_J,  

BOS_SD_FPr.szRequestToWhId,  
RequestWh.szName AS szRequestToWhNm_J,  

BOS_SD_FPr.szDriverId,  
e1.szName AS szDriverNm_J,  

BOS_SD_FPr.szVehicleId,  
BOS_INV_Vehicle.szPoliceNo AS szVehiclePoliceNo_J,  

BOS_SD_FPr.szStatus,  
BOS_SD_FPR.szDescription,  

BOS_SD_FPR.szHelperId_1,  
e2.szName as szHelperNm_1,  

BOS_SD_FPR.szHelperId_2,  
e3.szName AS szHelperNm_2,  

BOS_SD_FPR.szHelperId_3,  
e4.szName as szHelperNm_3,  

BOS_SD_FPr.bResultFrTransfer,  
BOS_SD_FPr.bVoid,  
BOS_GEN_Approved.bApproved,  
BOS_SD_FPr.bApplied,  
BOS_GL_FJournalTrans.szFJournalId AS bJournal,  
BOS_GL_FJournalTrans.bPosted,  
BOS_SD_FPr.btPrintedCount,  
BOS_SD_FPr.bTransferred,  

BOS_SD_FPr.szCompanyId,  
BOS_GL_Company.szName as szCompanyNm,  

BOS_SD_FPr.szWorkplaceId,  
BOS_GL_Workplace.szName as szWorkplaceNm,  

BOS_SD_FPr.szTaxEntityId,  
BOS_SD_FPr.bNeedApproval,  
BOS_GEN_Approved.gdApprovedId,  
BOS_GEN_Approved.szApprovalId,  
BOS_GL_FJournalTrans.szFJournalId,  

BOS_SD_FPr.dtmCreated,  
BOS_SD_FPr.bSystemCreated,  

BOS_SD_FPr.szUserId,  
BOS_SM_User.szName AS szUserNm_J,  

BOS_SD_FPr.dtmLastUpdated,  
BOS_SD_FPr.bAlreadyTransferred  

FROM  
BOS_SD_FPr LEFT JOIN BOS_GEN_Approved ON BOS_SD_FPr.gdApprovedId = BOS_GEN_Approved.gdApprovedId  
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FPr.szFJournalId = BOS_GL_FJournalTrans.szFJournalId  
LEFT JOIN BOS_PI_Employee e1 ON BOS_SD_FPr.szDriverId =e1.szEmployeeId  
LEFT JOIN BOS_PI_Employee e2 ON BOS_SD_FPr.szHelperId_1 =e2.szEmployeeId  
LEFT JOIN BOS_PI_Employee e3 ON BOS_SD_FPr.szHelperId_2 =e3.szEmployeeId  
LEFT JOIN BOS_PI_Employee e4 ON BOS_SD_FPr.szHelperId_3 =e4.szEmployeeId  
LEFT JOIN BOS_INV_Vehicle ON BOS_SD_FPr.szVehicleId = BOS_INV_Vehicle.szVehicleId  
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FPr.szCompanyId  
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FPr.szWorkplaceId  
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FPr.szUserId  
LEFT JOIN BOS_GL_Workplace AS RequestWp ON RequestWp.szWorkplaceId = BOS_SD_FPr.szRequestToWpId  
LEFT JOIN BOS_INV_Warehouse AS RequestWh ON RequestWh.szWarehouseId= BOS_SD_FPr.szRequestToWhId  

WHERE  
BOS_SD_FPr.szFPrId = p_szFPrId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FPr_GetFPr_014(
p_szFPrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_SD_FPr.dtmRequest,  

BOS_SD_FPr.szRequestToWpId,  
RequestWp.szName AS szRequestToWpNm_J,  

BOS_SD_FPr.szRequestToWhId,  
RequestWh.szName AS szRequestToWhNm_J,  

BOS_SD_FPr.szDriverId,  
e1.szName AS szDriverNm_J,  

BOS_SD_FPr.szVehicleId,  
BOS_INV_Vehicle.szPoliceNo AS szVehiclePoliceNo_J,  

BOS_SD_FPr.szStatus,  
BOS_SD_FPR.szDescription,  

BOS_SD_FPR.szHelperId_1,  
e2.szName as szHelperNm_1,  

BOS_SD_FPR.szHelperId_2,  
e3.szName AS szHelperNm_2,  

BOS_SD_FPR.szHelperId_3,  
e4.szName as szHelperNm_3,  

BOS_SD_FPr.bResultFrTransfer,  
BOS_SD_FPr.bVoid,  
BOS_GEN_Approved.bApproved,  
BOS_SD_FPr.bApplied,  
BOS_GL_FJournalTrans.szFJournalId AS bJournal,  
BOS_GL_FJournalTrans.bPosted,  
BOS_SD_FPr.btPrintedCount,  
BOS_SD_FPr.bTransferred,  

BOS_SD_FPr.szCompanyId,  
BOS_GL_Company.szName as szCompanyNm,  

BOS_SD_FPr.szWorkplaceId,  
BOS_GL_Workplace.szName as szWorkplaceNm,  

BOS_SD_FPr.szTaxEntityId,  
BOS_SD_FPr.bNeedApproval,  
BOS_GEN_Approved.gdApprovedId,  
BOS_GEN_Approved.szApprovalId,  
BOS_GL_FJournalTrans.szFJournalId,  

BOS_SD_FPr.dtmCreated,  
BOS_SD_FPr.bSystemCreated,  

BOS_SD_FPr.szUserId,  
BOS_SM_User.szName AS szUserNm_J,  

BOS_SD_FPr.dtmLastUpdated,  
BOS_SD_FPr.bAlreadyTransferred  

FROM  
BOS_SD_FPr LEFT JOIN BOS_GEN_Approved ON BOS_SD_FPr.gdApprovedId = BOS_GEN_Approved.gdApprovedId  
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FPr.szFJournalId = BOS_GL_FJournalTrans.szFJournalId  
LEFT JOIN BOS_PI_Employee e1 ON BOS_SD_FPr.szDriverId =e1.szEmployeeId  
LEFT JOIN BOS_PI_Employee e2 ON BOS_SD_FPr.szHelperId_1 =e2.szEmployeeId  
LEFT JOIN BOS_PI_Employee e3 ON BOS_SD_FPr.szHelperId_2 =e3.szEmployeeId  
LEFT JOIN BOS_PI_Employee e4 ON BOS_SD_FPr.szHelperId_3 =e4.szEmployeeId  
LEFT JOIN BOS_INV_Vehicle ON BOS_SD_FPr.szVehicleId = BOS_INV_Vehicle.szVehicleId  
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FPr.szCompanyId  
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FPr.szWorkplaceId  
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FPr.szUserId  
LEFT JOIN BOS_GL_Workplace AS RequestWp ON RequestWp.szWorkplaceId = BOS_SD_FPr.szRequestToWpId  
LEFT JOIN BOS_INV_Warehouse AS RequestWh ON RequestWh.szWarehouseId= BOS_SD_FPr.szRequestToWhId  

WHERE  
BOS_SD_FPr.szFPrId = p_szFPrId


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FPr_GetListOfFPr()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFPrId,
dtmRequest

FROM 
BOS_SD_FPr

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FPr_IsFPrExist(
p_szFPrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFPrId

FROM 
BOS_SD_FPr
WHERE 
szFPrId = p_szFPrId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FPr_LockFPr(
p_szFPrId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FPr
SET 
szDescription = szDescription
WHERE 
szFPrId = p_szFPrId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FPr_MarkFPrApplied(
p_szFPrId BOS_DT_szId,
p_dtmRequest timestamp,
p_bApplied bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FPr
SET 
dtmRequest = p_dtmRequest,
bApplied = p_bApplied
WHERE 
szFPrId = p_szFPrId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FPr_MarkFPrVoid(
p_szFPrId BOS_DT_szId,
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FPr
SET 
bVoid = 1,
bNeedApproval = 0,
gdApprovedId = p_gdApprovedId
WHERE 
szFPrId = p_szFPrId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FPr_UpdateFPr(
p_szFPrId BOS_DT_szId,
p_dtmRequest timestamp,
p_szRequestToWpId BOS_DT_szId,
p_szRequestToWhId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szHelperId_1 BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FPr
SET 
dtmRequest = p_dtmRequest,
szRequestToWpId = p_szRequestToWpId,
szRequestToWhId = p_szRequestToWhId,
szDriverId = p_szDriverId,
szVehicleId = p_szVehicleId,
szDescription = p_szDescription,
szHelperId_1 = p_szHelperId_1,
szHelperId_2 = p_szHelperId_2,
szHelperId_3 = p_szHelperId_3,


bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFPrId = p_szFPrId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FPr_UpdateFPr_014(
p_szFPrId BOS_DT_szId,
p_dtmRequest timestamp,
p_szRequestToWpId BOS_DT_szId,
p_szRequestToWhId BOS_DT_szId,
p_szDriverId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_szHelperId_1 BOS_DT_szId,
p_szHelperId_2 BOS_DT_szId,
p_szHelperId_3 BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FPr
SET 
dtmRequest = p_dtmRequest,
szRequestToWpId = p_szRequestToWpId,
szRequestToWhId = p_szRequestToWhId,
szDriverId = p_szDriverId,
szVehicleId = p_szVehicleId,
szDescription = p_szDescription,
szHelperId_1 = p_szHelperId_1,
szHelperId_2 = p_szHelperId_2,
szHelperId_3 = p_szHelperId_3,


bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFPrId = p_szFPrId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FPr_UpdateStatus(
p_szFPrId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FPr
SET 
szStatus = p_szStatus
WHERE 
szFPrId = p_szFPrId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_CreateFSettlement(
p_szFSettlementId BOS_DT_szId,
p_dtmSettBegin timestamp,
p_dtmSettEnd timestamp,
p_szWpToSettlement varchar,
p_bCloseInventory BOS_DT_bBoolean,
p_bCloseCashier BOS_DT_bBoolean,
p_bCloseDistribution BOS_DT_bBoolean,
p_bCloseEntry BOS_DT_bBoolean,
p_bCloseDaily BOS_DT_bBoolean,
p_szOpUserId BOS_DT_szId,
p_szSettlementType BOS_DT_szSmallId,
p_bResultFrTransfer BOS_DT_bBoolean,
p_bVoid BOS_DT_bBoolean,
p_bApproved BOS_DT_bBoolean,
p_bApplied BOS_DT_bBoolean,
p_bJournal BOS_DT_bBoolean,
p_bPosted BOS_DT_bBoolean,
p_btPrintedCount smallint,
p_bTransferred BOS_DT_bBoolean,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval BOS_DT_bBoolean,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated BOS_DT_bBoolean,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSettlement
(
szFSettlementId,
dtmSettBegin,
dtmSettEnd,
szWpToSettlement,
bCloseInventory,
bCloseCashier,
bCloseDistribution,
bCloseEntry,
bCloseDaily,
szOpUserId,
szSettlementType,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szFSettlementId,
p_dtmSettBegin,
p_dtmSettEnd,
p_szWpToSettlement,
p_bCloseInventory,
p_bCloseCashier,
p_bCloseDistribution,
p_bCloseEntry,
p_bCloseDaily,
p_szOpUserId,
p_szSettlementType,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_CreateFSettlementItem(
p_szFSettlementId BOS_DT_szId,
p_shItemNumber smallint,
p_szSettlementType BOS_DT_szSmallId,
p_szOpUserId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_szPartyWpId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szProductSn varchar,
p_szDescription varchar,
p_decAmount1 BOS_DT_decAmount,
p_decAmount2 BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_szCcyId varchar,
p_szReasonId BOS_DT_szId,
p_szReasonDescription varchar,
p_bMatched smallint,
p_decVehicleQty BOS_DT_decAmount,
p_decBegQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSettlementItem
(
szFSettlementId,
shItemNumber,
szSettlementType,
szOpUserId,
szWorkplaceId,
szPartyWpId,
szProductId,
szProductSn,
szDescription,
decAmount1,
decAmount2,
szUomId,
szCcyId,
szReasonId,
szReasonDescription,
bMatched,
decVehicleQty,
decBegQty
)
VALUES
(
p_szFSettlementId,
p_shItemNumber,
p_szSettlementType,
p_szOpUserId,
p_szWorkplaceId,
p_szPartyWpId,
p_szProductId,
p_szProductSn,
p_szDescription,
p_decAmount1,
p_decAmount2,
p_szUomId,
p_szCcyId,
p_szReasonId,
p_szReasonDescription,
p_bMatched,
p_decVehicleQty,
p_decBegQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_DeleteFSettlement(
p_szFSettlementId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FSettlement
WHERE
szFSettlementId = p_szFSettlementId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_DeleteFSettlementItem(
p_szFSettlementId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FSettlementItem
WHERE
szFSettlementId = p_szFSettlementId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetFSettlement(
p_szFSettlementId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_FSettlement.dtmSettBegin,
BOS_SD_FSettlement.dtmSettEnd,

BOS_SD_FSettlement.szWpToSettlement,
BOS_GL_Workplace.szName as szWpNmToSettlement,

BOS_SD_FSettlement.bCloseInventory,
BOS_SD_FSettlement.bCloseCashier,
BOS_SD_FSettlement.bCloseDistribution,
BOS_SD_FSettlement.bCloseEntry,

BOS_SD_FSettlement.bCloseDaily,

BOS_SD_FSettlement.szOpUserId,
BOS_PI_Employee.szName AS szOpUserNm_J,

BOS_SD_FSettlement.szSettlementType,

BOS_SD_FSettlement.bResultFrTransfer,
BOS_SD_FSettlement.bVoid,
BOS_GEN_Approved.bApproved,
BOS_SD_FSettlement.bApplied,
BOS_GL_FJournalTrans.szFJournalId AS bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_SD_FSettlement.btPrintedCount,
BOS_SD_FSettlement.bTransferred,
BOS_SD_FSettlement.szCompanyId,
BOS_GL_Company.szName as szCompanyNm,
BOS_SD_FSettlement.szWorkplaceId,
WpDoc.szName as szWorkplaceNm,
BOS_SD_FSettlement.szTaxEntityId,
BOS_SD_FSettlement.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_SD_FSettlement.dtmCreated,
BOS_SD_FSettlement.bSystemCreated,
BOS_SD_FSettlement.dtmLastUpdated,
BOS_SD_FSettlement.bAlreadyTransferred,
BOS_SD_FSettlement.szUserId,
BOS_SM_User.szName as szUserNm_J

FROM
BOS_SD_FSettlement 
LEFT JOIN BOS_GEN_Approved ON BOS_SD_FSettlement.gdApprovedId = BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FSettlement.szFJournalId = BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_GL_Workplace ON BOS_SD_FSettlement.szWpToSettlement = BOS_GL_Workplace.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FSettlement.szCompanyId
LEFT JOIN BOS_GL_Workplace AS WpDoc ON WpDoc.szWorkplaceId = BOS_SD_FSettlement.szWorkplaceId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FSettlement.szUserId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FSettlement.szOpUserId

WHERE
BOS_SD_FSettlement.szFSettlementId = p_szFSettlementId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetFSettlementItem(
p_szFSettlementId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_SD_FSettlementItem.szFSettlementId,
BOS_SD_FSettlementItem.shItemNumber,
BOS_SD_FSettlementItem.szSettlementType,
BOS_SD_FSettlementItem.szOpUserId,
BOS_PI_Employee.szName As szOpUserNm,
BOS_SD_FSettlementItem.szWorkplaceId,
WP1.szName as szWp1Nm,
BOS_SD_FSettlementItem.szPartyWpId,
WP2.szName as szWp2Nm,
BOS_SD_FSettlementItem.szProductId,
BOS_SD_FSettlementItem.szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_SD_FSettlementItem.szDescription,
BOS_SD_FSettlementItem.decAmount1,
BOS_SD_FSettlementItem.decAmount2,
BOS_SD_FSettlementItem.szUomId,
BOS_SD_FSettlementItem.szCcyId,
BOS_CU_Currency.szAmountFormat,
BOS_SD_FSettlementItem.szReasonId,
BOS_SD_FSettlementItem.szReasonDescription,
BOS_SD_FSettlementItem.bMatched,
BOS_SD_FSettlementItem.decVehicleQty,
BOS_SD_FSettlementItem.decBegQty
FROM
BOS_SD_FSettlementItem 
LEFT JOIN BOS_GL_Workplace AS WP1 ON BOS_SD_FSettlementItem.szWorkplaceId = WP1.szWorkplaceId
LEFT JOIN BOS_GL_Workplace AS WP2 ON BOS_SD_FSettlementItem.szPartyWpId = WP2.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_SD_FSettlementItem.szOpUserId = BOS_PI_Employee.szEmployeeId
LEFT JOIN BOS_INV_Product ON BOS_SD_FSettlementItem.szProductId = BOS_INV_Product.szProductId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FSettlementItem.szCcyId
WHERE
szFSettlementId = p_szFSettlementId

--Do not order by, just let as it is.

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByCashTemp(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szAccountId BOS_DT_szId,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_CAS_FCashTemp.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,					--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_CAS_FCashTemp.szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_CAS_FCashTemp.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
null As decAmount1,
sum(-BOS_CAS_FCashTempItem.decAmount) As decAmount2

FROM
BOS_CAS_FCashTemp
INNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_FCashTemp.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_FCashTemp.szEmployeeId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_FCashTemp.szCcyId

WHERE
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmFirstDate And BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmLastDate) and
BOS_CAS_FCashTemp.szWorkplaceId = p_szWorkplaceId And
BOS_CAS_FCashTempItem.szAccountId like p_szAccountId And
BOS_CAS_FCashTemp.bApplied = 1
--AND BOS_CAS_FCashTemp.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_CAS_FCashTemp.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_CAS_FCashTemp.szEmployeeId,
BOS_PI_Employee.szName,
BOS_CAS_FCashTemp.szCcyId,
BOS_CU_Currency.szAmountFormat
ELSE
SELECT
BOS_CAS_FCashTemp.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,					--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_CAS_FCashTemp.szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_CAS_FCashTemp.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
null As decAmount1,
sum(-BOS_CAS_FCashTempItem.decAmount) As decAmount2

FROM
BOS_CAS_FCashTemp
INNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_FCashTemp.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_FCashTemp.szEmployeeId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_FCashTemp.szCcyId

WHERE
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmFirstDate And BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmLastDate) and
BOS_CAS_FCashTemp.szWorkplaceId = p_szWorkplaceId And
BOS_CAS_FCashTempItem.szAccountId like p_szAccountId And
BOS_CAS_FCashTemp.bApplied = 1
AND BOS_CAS_FCashTemp.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_CAS_FCashTemp.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_CAS_FCashTemp.szEmployeeId,
BOS_PI_Employee.szName,
BOS_CAS_FCashTemp.szCcyId,
BOS_CU_Currency.szAmountFormat

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByCashTemp_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szAccountId BOS_DT_szId,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_CAS_FCashTemp.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,                    --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_CAS_FCashTemp.szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_CAS_FCashTemp.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
null As decAmount1,
sum(-BOS_CAS_FCashTempItem.decAmount) As decAmount2

FROM
BOS_CAS_FCashTemp
INNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_FCashTemp.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_FCashTemp.szEmployeeId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_FCashTemp.szCcyId

WHERE
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmFirstDate And BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmLastDate) and
BOS_CAS_FCashTemp.szWorkplaceId = p_szWorkplaceId And
BOS_CAS_FCashTempItem.szAccountId like p_szAccountId And
BOS_CAS_FCashTemp.bApplied = 1
--AND BOS_CAS_FCashTemp.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_CAS_FCashTemp.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_CAS_FCashTemp.szEmployeeId,
BOS_PI_Employee.szName,
BOS_CAS_FCashTemp.szCcyId,
BOS_CU_Currency.szAmountFormat
ELSE
SELECT
BOS_CAS_FCashTemp.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,                    --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_CAS_FCashTemp.szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_CAS_FCashTemp.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
null As decAmount1,
sum(-BOS_CAS_FCashTempItem.decAmount) As decAmount2

FROM
BOS_CAS_FCashTemp
INNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_FCashTemp.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_FCashTemp.szEmployeeId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_FCashTemp.szCcyId

WHERE
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmFirstDate And BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmLastDate) and
BOS_CAS_FCashTemp.szWorkplaceId = p_szWorkplaceId And
BOS_CAS_FCashTempItem.szAccountId like p_szAccountId And
BOS_CAS_FCashTemp.bApplied = 1
AND BOS_CAS_FCashTemp.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_CAS_FCashTemp.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_CAS_FCashTemp.szEmployeeId,
BOS_PI_Employee.szName,
BOS_CAS_FCashTemp.szCcyId,
BOS_CU_Currency.szAmountFormat


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByCashTempALL(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szAccountId BOS_DT_szId,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_CAS_FCashTemp.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_CAS_FCashTemp.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,	
null As decAmount1,
sum(-BOS_CAS_FCashTempItem.decAmount) As decAmount2

FROM
BOS_CAS_FCashTemp
INNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_FCashTemp.szWorkplaceId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_FCashTemp.szCcyId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_FCashTemp.szEmployeeId

WHERE
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmFirstDate And BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmLastDate) and
BOS_CAS_FCashTemp.szWorkplaceId = p_szWorkplaceId And
BOS_CAS_FCashTempItem.szAccountId like p_szAccountId And
BOS_CAS_FCashTemp.bApplied = 1
--AND BOS_CAS_FCashTemp.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_CAS_FCashTemp.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_CAS_FCashTemp.szCcyId,
BOS_CU_Currency.szAmountFormat
ELSE
SELECT
BOS_CAS_FCashTemp.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_CAS_FCashTemp.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,	
null As decAmount1,
sum(-BOS_CAS_FCashTempItem.decAmount) As decAmount2

FROM
BOS_CAS_FCashTemp
INNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_FCashTemp.szWorkplaceId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_FCashTemp.szCcyId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_FCashTemp.szEmployeeId

WHERE
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmFirstDate And BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmLastDate) and
BOS_CAS_FCashTemp.szWorkplaceId = p_szWorkplaceId And
BOS_CAS_FCashTempItem.szAccountId like p_szAccountId And
BOS_CAS_FCashTemp.bApplied = 1
AND BOS_CAS_FCashTemp.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_CAS_FCashTemp.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_CAS_FCashTemp.szCcyId,
BOS_CU_Currency.szAmountFormat

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByCashTempALL_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szAccountId BOS_DT_szId,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_CAS_FCashTemp.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_CAS_FCashTemp.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,    
null As decAmount1,
sum(-BOS_CAS_FCashTempItem.decAmount) As decAmount2

FROM
BOS_CAS_FCashTemp
INNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_FCashTemp.szWorkplaceId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_FCashTemp.szCcyId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_FCashTemp.szEmployeeId

WHERE
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmFirstDate And BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmLastDate) and
BOS_CAS_FCashTemp.szWorkplaceId = p_szWorkplaceId And
BOS_CAS_FCashTempItem.szAccountId like p_szAccountId And
BOS_CAS_FCashTemp.bApplied = 1
--AND BOS_CAS_FCashTemp.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_CAS_FCashTemp.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_CAS_FCashTemp.szCcyId,
BOS_CU_Currency.szAmountFormat
ELSE
SELECT
BOS_CAS_FCashTemp.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_CAS_FCashTemp.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,    
null As decAmount1,
sum(-BOS_CAS_FCashTempItem.decAmount) As decAmount2

FROM
BOS_CAS_FCashTemp
INNER JOIN BOS_CAS_FCashTempItem ON BOS_CAS_FCashTempItem.szFCashTempId = BOS_CAS_FCashTemp.szFCashTempId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_FCashTemp.szWorkplaceId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_FCashTemp.szCcyId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_FCashTemp.szEmployeeId

WHERE
BOS_CAS_FCashTemp.dtmTransaction >= p_dtmFirstDate And BOS_CAS_FCashTemp.dtmTransaction < dateadd(day, 1, p_dtmLastDate) and
BOS_CAS_FCashTemp.szWorkplaceId = p_szWorkplaceId And
BOS_CAS_FCashTempItem.szAccountId like p_szAccountId And
BOS_CAS_FCashTemp.bApplied = 1
AND BOS_CAS_FCashTemp.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_CAS_FCashTemp.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_CAS_FCashTemp.szCcyId,
BOS_CU_Currency.szAmountFormat


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByFCustDeposit(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_AR_FCustDeposit.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName AS szWp1Nm,
'' As szWp2Nm,
BOS_AR_FCustDeposit.szDeposanId AS szEmployeeId,
BOS_PI_Employee.szName AS szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_AR_FCustDeposit.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
SUM(BOS_AR_FCustDeposit.decDeposit) AS decAmount1,
null As decAmount2
FROM
BOS_AR_FCustDeposit
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustDeposit.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustDeposit.szDeposanId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustDeposit.szCcyId
WHERE
BOS_AR_FCustDeposit.szWorkplaceId = p_szWorkplaceId
AND BOS_AR_FCustDeposit.dtmFCustDeposit >= p_dtmFirstDate
AND BOS_AR_FCustDeposit.dtmFCustDeposit < dateadd(day, 1, p_dtmLastDate)
AND BOS_AR_FCustDeposit.bVoid = 0
--AND BOS_AR_FCustDeposit.szDeposanId = p_szOpUserId
AND BOS_AR_FCustDeposit.bValue = 1
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
GROUP BY
BOS_AR_FCustDeposit.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_AR_FCustDeposit.szDeposanId,
BOS_PI_Employee.szName,
BOS_AR_FCustDeposit.szCcyId,
BOS_CU_Currency.szAmountFormat
ELSE
SELECT
BOS_AR_FCustDeposit.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName AS szWp1Nm,
'' As szWp2Nm,
BOS_AR_FCustDeposit.szDeposanId AS szEmployeeId,
BOS_PI_Employee.szName AS szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_AR_FCustDeposit.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
SUM(BOS_AR_FCustDeposit.decDeposit) AS decAmount1,
null As decAmount2
FROM
BOS_AR_FCustDeposit
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustDeposit.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustDeposit.szDeposanId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustDeposit.szCcyId
WHERE
BOS_AR_FCustDeposit.szWorkplaceId = p_szWorkplaceId
AND BOS_AR_FCustDeposit.dtmFCustDeposit >= p_dtmFirstDate
AND BOS_AR_FCustDeposit.dtmFCustDeposit < dateadd(day, 1, p_dtmLastDate)
AND BOS_AR_FCustDeposit.bVoid = 0
AND BOS_AR_FCustDeposit.szDeposanId = p_szOpUserId
AND BOS_AR_FCustDeposit.bValue = 1
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
GROUP BY
BOS_AR_FCustDeposit.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_AR_FCustDeposit.szDeposanId,
BOS_PI_Employee.szName,
BOS_AR_FCustDeposit.szCcyId,
BOS_CU_Currency.szAmountFormat

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByFCustDeposit_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_AR_FCustDeposit.szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName AS szWp1Nm,
'' As szWp2Nm,
BOS_AR_FCustDeposit.szDeposanId AS szEmployeeId,
BOS_PI_Employee.szName AS szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_AR_FCustDeposit.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
SUM(BOS_AR_FCustDeposit.decDeposit) AS decAmount1,
null As decAmount2
FROM
BOS_AR_FCustDeposit
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustDeposit.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustDeposit.szDeposanId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustDeposit.szCcyId
WHERE
BOS_AR_FCustDeposit.szWorkplaceId = p_szWorkplaceId
AND BOS_AR_FCustDeposit.dtmFCustDeposit >= p_dtmFirstDate
AND BOS_AR_FCustDeposit.dtmFCustDeposit < dateadd(day, 1, p_dtmLastDate)
AND BOS_AR_FCustDeposit.bVoid = 0
--AND BOS_AR_FCustDeposit.szDeposanId = p_szOpUserId
AND BOS_AR_FCustDeposit.bValue = 1
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
GROUP BY
BOS_AR_FCustDeposit.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_AR_FCustDeposit.szDeposanId,
BOS_PI_Employee.szName,
BOS_AR_FCustDeposit.szCcyId,
BOS_CU_Currency.szAmountFormat
ELSE
SELECT
BOS_AR_FCustDeposit.szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName AS szWp1Nm,
'' As szWp2Nm,
BOS_AR_FCustDeposit.szDeposanId AS szEmployeeId,
BOS_PI_Employee.szName AS szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_AR_FCustDeposit.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
SUM(BOS_AR_FCustDeposit.decDeposit) AS decAmount1,
null As decAmount2
FROM
BOS_AR_FCustDeposit
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustDeposit.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustDeposit.szDeposanId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustDeposit.szCcyId
WHERE
BOS_AR_FCustDeposit.szWorkplaceId = p_szWorkplaceId
AND BOS_AR_FCustDeposit.dtmFCustDeposit >= p_dtmFirstDate
AND BOS_AR_FCustDeposit.dtmFCustDeposit < dateadd(day, 1, p_dtmLastDate)
AND BOS_AR_FCustDeposit.bVoid = 0
AND BOS_AR_FCustDeposit.szDeposanId = p_szOpUserId
AND BOS_AR_FCustDeposit.bValue = 1
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
GROUP BY
BOS_AR_FCustDeposit.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_AR_FCustDeposit.szDeposanId,
BOS_PI_Employee.szName,
BOS_AR_FCustDeposit.szCcyId,
BOS_CU_Currency.szAmountFormat


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByFCustDepositALL(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_AR_FCustDeposit.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName AS szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_AR_FCustDeposit.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
SUM(BOS_AR_FCustDeposit.decDeposit) AS decAmount1,
null As decAmount2
FROM
BOS_AR_FCustDeposit
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustDeposit.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustDeposit.szDeposanId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustDeposit.szCcyId
WHERE
BOS_AR_FCustDeposit.szWorkplaceId = p_szWorkplaceId
AND BOS_AR_FCustDeposit.dtmFCustDeposit >= p_dtmFirstDate
AND BOS_AR_FCustDeposit.dtmFCustDeposit < dateadd(day, 1, p_dtmLastDate)
AND BOS_AR_FCustDeposit.bVoid = 0
--AND BOS_AR_FCustDeposit.szDeposanId = p_szOpUserId
AND BOS_AR_FCustDeposit.bValue = 1
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
GROUP BY
BOS_AR_FCustDeposit.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_AR_FCustDeposit.szCcyId,
BOS_CU_Currency.szAmountFormat
ELSE
SELECT
BOS_AR_FCustDeposit.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName AS szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_AR_FCustDeposit.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
SUM(BOS_AR_FCustDeposit.decDeposit) AS decAmount1,
null As decAmount2
FROM
BOS_AR_FCustDeposit
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustDeposit.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustDeposit.szDeposanId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustDeposit.szCcyId
WHERE
BOS_AR_FCustDeposit.szWorkplaceId = p_szWorkplaceId
AND BOS_AR_FCustDeposit.dtmFCustDeposit >= p_dtmFirstDate
AND BOS_AR_FCustDeposit.dtmFCustDeposit < dateadd(day, 1, p_dtmLastDate)
AND BOS_AR_FCustDeposit.bVoid = 0
AND BOS_AR_FCustDeposit.szDeposanId = p_szOpUserId
AND BOS_AR_FCustDeposit.bValue = 1
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
GROUP BY
BOS_AR_FCustDeposit.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_AR_FCustDeposit.szCcyId,
BOS_CU_Currency.szAmountFormat

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByFCustDepositALL_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_AR_FCustDeposit.szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName AS szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_AR_FCustDeposit.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
SUM(BOS_AR_FCustDeposit.decDeposit) AS decAmount1,
null As decAmount2
FROM
BOS_AR_FCustDeposit
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustDeposit.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustDeposit.szDeposanId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustDeposit.szCcyId
WHERE
BOS_AR_FCustDeposit.szWorkplaceId = p_szWorkplaceId
AND BOS_AR_FCustDeposit.dtmFCustDeposit >= p_dtmFirstDate
AND BOS_AR_FCustDeposit.dtmFCustDeposit < dateadd(day, 1, p_dtmLastDate)
AND BOS_AR_FCustDeposit.bVoid = 0
--AND BOS_AR_FCustDeposit.szDeposanId = p_szOpUserId
AND BOS_AR_FCustDeposit.bValue = 1
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
GROUP BY
BOS_AR_FCustDeposit.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_AR_FCustDeposit.szCcyId,
BOS_CU_Currency.szAmountFormat
ELSE
SELECT
BOS_AR_FCustDeposit.szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName AS szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_AR_FCustDeposit.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
SUM(BOS_AR_FCustDeposit.decDeposit) AS decAmount1,
null As decAmount2
FROM
BOS_AR_FCustDeposit
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustDeposit.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustDeposit.szDeposanId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustDeposit.szCcyId
WHERE
BOS_AR_FCustDeposit.szWorkplaceId = p_szWorkplaceId
AND BOS_AR_FCustDeposit.dtmFCustDeposit >= p_dtmFirstDate
AND BOS_AR_FCustDeposit.dtmFCustDeposit < dateadd(day, 1, p_dtmLastDate)
AND BOS_AR_FCustDeposit.bVoid = 0
AND BOS_AR_FCustDeposit.szDeposanId = p_szOpUserId
AND BOS_AR_FCustDeposit.bValue = 1
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
GROUP BY
BOS_AR_FCustDeposit.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_AR_FCustDeposit.szCcyId,
BOS_CU_Currency.szAmountFormat


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByFCustPayment(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_AR_FCustPayment.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,					--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_AR_FCustPayment.szDeposanId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_AR_FCustPayment.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
sum(BOS_AR_FCustPaymentItemDetail.decAmount) As decAmount1,
null As decAmount2

FROM
BOS_AR_FCustPayment
INNER JOIN BOS_AR_FCustPaymentItemDetail 
ON BOS_AR_FCustPaymentItemDetail.szFCustPaymentId = BOS_AR_FCustPayment.szFCustPaymentId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustPayment.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustPayment.szDeposanId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustPayment.szCcyId
WHERE
BOS_AR_FCustPayment.dtmFCustPayment >= p_dtmFirstDate And BOS_AR_FCustPayment.dtmFCustPayment < dateadd(day, 1, p_dtmLastDate) and
BOS_AR_FCustPayment.szWorkplaceId like p_szWorkplaceId And
BOS_AR_FCustPayment.bVoid=0

--Filter to exclude payment by customer deposit.
AND BOS_AR_FCustPaymentItemDetail.bDeposit = 0
--Filter to get only payment that has value (cash, valuable cheque, clearing cheque).
AND BOS_AR_FCustPaymentItemDetail.bValue = 1

AND BOS_AR_FCustPaymentItemDetail.szBankId = '' 
AND BOS_AR_FCustPaymentItemDetail.szRefDocId = ''

AND BOS_AR_FCustPayment.szDeposanId LIKE p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_AR_FCustPayment.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_AR_FCustPayment.szDeposanId,
BOS_PI_Employee.szName,
BOS_AR_FCustPayment.szCcyId,
BOS_CU_Currency.szAmountFormat

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByFCustPayment_013(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_AR_FCustPayment.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,					--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_AR_FCustPayment.szDeposanId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_AR_FCustPayment.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
sum(BOS_AR_FCustPaymentItemDetail.decAmount) As decAmount1,
null As decAmount2

FROM
BOS_AR_FCustPayment
INNER JOIN BOS_AR_FCustPaymentItemDetail 
ON BOS_AR_FCustPaymentItemDetail.szFCustPaymentId = BOS_AR_FCustPayment.szFCustPaymentId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustPayment.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustPayment.szDeposanId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustPayment.szCcyId
WHERE
BOS_AR_FCustPayment.dtmFCustPayment >= p_dtmFirstDate And BOS_AR_FCustPayment.dtmFCustPayment < dateadd(day, 1, p_dtmLastDate) and
BOS_AR_FCustPayment.szWorkplaceId = p_szWorkplaceId And
BOS_AR_FCustPayment.bVoid=0

--Filter to exclude payment by customer deposit.
AND BOS_AR_FCustPaymentItemDetail.bDeposit = 0
--Filter to get only payment that has value (cash, valuable cheque, clearing cheque).
AND BOS_AR_FCustPaymentItemDetail.bValue = 1

AND BOS_AR_FCustPaymentItemDetail.szBankId = '' 
AND BOS_AR_FCustPaymentItemDetail.szRefDocId = ''

--AND BOS_AR_FCustPayment.szDeposanId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_AR_FCustPayment.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_AR_FCustPayment.szDeposanId,
BOS_PI_Employee.szName,
BOS_AR_FCustPayment.szCcyId,
BOS_CU_Currency.szAmountFormat
ELSE
SELECT
BOS_AR_FCustPayment.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,					--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_AR_FCustPayment.szDeposanId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_AR_FCustPayment.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
sum(BOS_AR_FCustPaymentItemDetail.decAmount) As decAmount1,
null As decAmount2

FROM
BOS_AR_FCustPayment
INNER JOIN BOS_AR_FCustPaymentItemDetail 
ON BOS_AR_FCustPaymentItemDetail.szFCustPaymentId = BOS_AR_FCustPayment.szFCustPaymentId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustPayment.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustPayment.szDeposanId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustPayment.szCcyId
WHERE
BOS_AR_FCustPayment.dtmFCustPayment >= p_dtmFirstDate And BOS_AR_FCustPayment.dtmFCustPayment < dateadd(day, 1, p_dtmLastDate) and
BOS_AR_FCustPayment.szWorkplaceId = p_szWorkplaceId And
BOS_AR_FCustPayment.bVoid=0

--Filter to exclude payment by customer deposit.
AND BOS_AR_FCustPaymentItemDetail.bDeposit = 0
--Filter to get only payment that has value (cash, valuable cheque, clearing cheque).
AND BOS_AR_FCustPaymentItemDetail.bValue = 1

AND BOS_AR_FCustPaymentItemDetail.szBankId = '' 
AND BOS_AR_FCustPaymentItemDetail.szRefDocId = ''

AND BOS_AR_FCustPayment.szDeposanId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_AR_FCustPayment.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_AR_FCustPayment.szDeposanId,
BOS_PI_Employee.szName,
BOS_AR_FCustPayment.szCcyId,
BOS_CU_Currency.szAmountFormat

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByFCustPaymentALL(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_AR_FCustPayment.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_AR_FCustPayment.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,	
sum(BOS_AR_FCustPaymentItemDetail.decAmount) As decAmount1,
null As decAmount2

FROM
BOS_AR_FCustPayment
INNER JOIN BOS_AR_FCustPaymentItemDetail 
ON BOS_AR_FCustPaymentItemDetail.szFCustPaymentId = BOS_AR_FCustPayment.szFCustPaymentId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustPayment.szWorkplaceId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustPayment.szCcyId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustPayment.szDeposanId

WHERE
BOS_AR_FCustPayment.dtmFCustPayment >= p_dtmFirstDate And BOS_AR_FCustPayment.dtmFCustPayment < dateadd(day, 1, p_dtmLastDate) and
BOS_AR_FCustPayment.szWorkplaceId like p_szWorkplaceId And
BOS_AR_FCustPayment.bVoid=0

--Filter to exclude payment by customer deposit.
AND BOS_AR_FCustPaymentItemDetail.bDeposit = 0
--Filter to get only payment that has value (cash, valuable cheque, clearing cheque).
AND BOS_AR_FCustPaymentItemDetail.bValue = 1

AND BOS_AR_FCustPaymentItemDetail.szBankId = '' 
AND BOS_AR_FCustPaymentItemDetail.szRefDocId = ''

AND BOS_AR_FCustPayment.szDeposanId LIKE p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_AR_FCustPayment.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_AR_FCustPayment.szCcyId,
BOS_CU_Currency.szAmountFormat

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByFCustPaymentALL_013(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_AR_FCustPayment.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_AR_FCustPayment.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,	
sum(BOS_AR_FCustPaymentItemDetail.decAmount) As decAmount1,
null As decAmount2

FROM
BOS_AR_FCustPayment
INNER JOIN BOS_AR_FCustPaymentItemDetail 
ON BOS_AR_FCustPaymentItemDetail.szFCustPaymentId = BOS_AR_FCustPayment.szFCustPaymentId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustPayment.szWorkplaceId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustPayment.szCcyId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustPayment.szDeposanId

WHERE
BOS_AR_FCustPayment.dtmFCustPayment >= p_dtmFirstDate And BOS_AR_FCustPayment.dtmFCustPayment < dateadd(day, 1, p_dtmLastDate) and
BOS_AR_FCustPayment.szWorkplaceId = p_szWorkplaceId And
BOS_AR_FCustPayment.bVoid=0

--Filter to exclude payment by customer deposit.
AND BOS_AR_FCustPaymentItemDetail.bDeposit = 0
--Filter to get only payment that has value (cash, valuable cheque, clearing cheque).
AND BOS_AR_FCustPaymentItemDetail.bValue = 1

AND BOS_AR_FCustPaymentItemDetail.szBankId = '' 
AND BOS_AR_FCustPaymentItemDetail.szRefDocId = ''

--AND BOS_AR_FCustPayment.szDeposanId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_AR_FCustPayment.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_AR_FCustPayment.szCcyId,
BOS_CU_Currency.szAmountFormat
ELSE
SELECT
BOS_AR_FCustPayment.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
'' As szUomId,
BOS_AR_FCustPayment.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,	
sum(BOS_AR_FCustPaymentItemDetail.decAmount) As decAmount1,
null As decAmount2

FROM
BOS_AR_FCustPayment
INNER JOIN BOS_AR_FCustPaymentItemDetail 
ON BOS_AR_FCustPaymentItemDetail.szFCustPaymentId = BOS_AR_FCustPayment.szFCustPaymentId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustPayment.szWorkplaceId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustPayment.szCcyId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustPayment.szDeposanId

WHERE
BOS_AR_FCustPayment.dtmFCustPayment >= p_dtmFirstDate And BOS_AR_FCustPayment.dtmFCustPayment < dateadd(day, 1, p_dtmLastDate) and
BOS_AR_FCustPayment.szWorkplaceId = p_szWorkplaceId And
BOS_AR_FCustPayment.bVoid=0

--Filter to exclude payment by customer deposit.
AND BOS_AR_FCustPaymentItemDetail.bDeposit = 0
--Filter to get only payment that has value (cash, valuable cheque, clearing cheque).
AND BOS_AR_FCustPaymentItemDetail.bValue = 1

AND BOS_AR_FCustPaymentItemDetail.szBankId = '' 
AND BOS_AR_FCustPaymentItemDetail.szRefDocId = ''

AND BOS_AR_FCustPayment.szDeposanId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_AR_FCustPayment.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_AR_FCustPayment.szCcyId,
BOS_CU_Currency.szAmountFormat

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByFDo(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_SD_FDo.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FDo.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
BOS_SD_FDo.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
'' As szUomId,
sum(BOS_SD_FDo.decAmount) As decAmount1,
null As decAmount2

FROM
BOS_SD_FDo
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FDo.szCcyId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FDo.bCash = 1 and
BOS_SD_FDo.bVoid = 0
--AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDo.szDriverId,
BOS_PI_Employee.szName,
BOS_SD_FDo.szCcyId,
BOS_CU_Currency.szAmountFormat
ELSE
SELECT
BOS_SD_FDo.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FDo.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
BOS_SD_FDo.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
'' As szUomId,
sum(BOS_SD_FDo.decAmount) As decAmount1,
null As decAmount2

FROM
BOS_SD_FDo
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FDo.szCcyId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FDo.bCash = 1 and
BOS_SD_FDo.bVoid = 0
AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDo.szDriverId,
BOS_PI_Employee.szName,
BOS_SD_FDo.szCcyId,
BOS_CU_Currency.szAmountFormat

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByFDo_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_SD_FDo.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FDo.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
BOS_SD_FDo.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
'' As szUomId,
sum(BOS_SD_FDo.decAmount) As decAmount1,
null As decAmount2

FROM
BOS_SD_FDo
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FDo.szCcyId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FDo.bCash = 1 and
BOS_SD_FDo.bVoid = 0
--AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDo.szDriverId,
BOS_PI_Employee.szName,
BOS_SD_FDo.szCcyId,
BOS_CU_Currency.szAmountFormat
ELSE
SELECT
BOS_SD_FDo.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FDo.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
BOS_SD_FDo.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
'' As szUomId,
sum(BOS_SD_FDo.decAmount) As decAmount1,
null As decAmount2

FROM
BOS_SD_FDo
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FDo.szCcyId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FDo.bCash = 1 and
BOS_SD_FDo.bVoid = 0
AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDo.szDriverId,
BOS_PI_Employee.szName,
BOS_SD_FDo.szCcyId,
BOS_CU_Currency.szAmountFormat


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByFDoALL(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_SD_FDo.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
BOS_SD_FDo.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,	
'' As szUomId,
sum(BOS_SD_FDo.decAmount) As decAmount1,
null As decAmount2

FROM
BOS_SD_FDo
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FDo.szCcyId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FDo.bCash = 1 and
BOS_SD_FDo.bVoid=0
--AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDo.szCcyId,
BOS_CU_Currency.szAmountFormat
ELSE
SELECT
BOS_SD_FDo.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
BOS_SD_FDo.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,	
'' As szUomId,
sum(BOS_SD_FDo.decAmount) As decAmount1,
null As decAmount2

FROM
BOS_SD_FDo
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FDo.szCcyId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FDo.bCash = 1 and
BOS_SD_FDo.bVoid=0
AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDo.szCcyId,
BOS_CU_Currency.szAmountFormat

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByFDoALL_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_SD_FDo.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
BOS_SD_FDo.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,    
'' As szUomId,
sum(BOS_SD_FDo.decAmount) As decAmount1,
null As decAmount2

FROM
BOS_SD_FDo
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FDo.szCcyId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FDo.bCash = 1 and
BOS_SD_FDo.bVoid=0
--AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDo.szCcyId,
BOS_CU_Currency.szAmountFormat
ELSE
SELECT
BOS_SD_FDo.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
BOS_SD_FDo.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,    
'' As szUomId,
sum(BOS_SD_FDo.decAmount) As decAmount1,
null As decAmount2

FROM
BOS_SD_FDo
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FDo.szCcyId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FDo.bCash = 1 and
BOS_SD_FDo.bVoid=0
AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDo.szCcyId,
BOS_CU_Currency.szAmountFormat


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByFSo(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_SD_FSo.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FSo.szSalesId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
BOS_SD_FSo.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
'' As szUomId,
sum(BOS_SD_FSo.decDownPayment) As decAmount1,
null As decAmount2

FROM
BOS_SD_FSo
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FSo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FSo.szSalesId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FSo.szCcyId

WHERE
BOS_SD_FSo.dtmOrder >= p_dtmFirstDate And BOS_SD_FSo.dtmOrder < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FSo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FSo.bCash = 1 and
BOS_SD_FSo.bVoid = 0
--AND BOS_SD_FSo.szSalesId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FSo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FSo.szSalesId,
BOS_PI_Employee.szName,
BOS_SD_FSo.szCcyId,
BOS_CU_Currency.szAmountFormat
ELSE
SELECT
BOS_SD_FSo.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FSo.szSalesId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
BOS_SD_FSo.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
'' As szUomId,
sum(BOS_SD_FSo.decDownPayment) As decAmount1,
null As decAmount2

FROM
BOS_SD_FSo
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FSo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FSo.szSalesId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FSo.szCcyId

WHERE
BOS_SD_FSo.dtmOrder >= p_dtmFirstDate And BOS_SD_FSo.dtmOrder < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FSo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FSo.bCash = 1 and
BOS_SD_FSo.bVoid = 0
AND BOS_SD_FSo.szSalesId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FSo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FSo.szSalesId,
BOS_PI_Employee.szName,
BOS_SD_FSo.szCcyId,
BOS_CU_Currency.szAmountFormat

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByFSo_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_SD_FSo.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FSo.szSalesId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
BOS_SD_FSo.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
'' As szUomId,
sum(BOS_SD_FSo.decDownPayment) As decAmount1,
null As decAmount2

FROM
BOS_SD_FSo
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FSo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FSo.szSalesId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FSo.szCcyId

WHERE
BOS_SD_FSo.dtmOrder >= p_dtmFirstDate And BOS_SD_FSo.dtmOrder < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FSo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FSo.bCash = 1 and
BOS_SD_FSo.bVoid = 0
--AND BOS_SD_FSo.szSalesId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FSo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FSo.szSalesId,
BOS_PI_Employee.szName,
BOS_SD_FSo.szCcyId,
BOS_CU_Currency.szAmountFormat
ELSE
SELECT
BOS_SD_FSo.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FSo.szSalesId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
BOS_SD_FSo.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,
'' As szUomId,
sum(BOS_SD_FSo.decDownPayment) As decAmount1,
null As decAmount2

FROM
BOS_SD_FSo
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FSo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FSo.szSalesId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FSo.szCcyId

WHERE
BOS_SD_FSo.dtmOrder >= p_dtmFirstDate And BOS_SD_FSo.dtmOrder < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FSo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FSo.bCash = 1 and
BOS_SD_FSo.bVoid = 0
AND BOS_SD_FSo.szSalesId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FSo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FSo.szSalesId,
BOS_PI_Employee.szName,
BOS_SD_FSo.szCcyId,
BOS_CU_Currency.szAmountFormat


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByFSoALL(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_SD_FSo.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
BOS_SD_FSo.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,	
'' As szUomId,
sum(BOS_SD_FSo.decDownPayment) As decAmount1,
null As decAmount2

FROM
BOS_SD_FSo
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FSo.szWorkplaceId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FSo.szCcyId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FSo.szSalesId

WHERE
BOS_SD_FSo.dtmOrder >= p_dtmFirstDate And BOS_SD_FSo.dtmOrder < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FSo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FSo.bCash = 1 and
BOS_SD_FSo.bVoid=0
--AND BOS_SD_FSo.szSalesId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FSo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FSo.szCcyId,
BOS_CU_Currency.szAmountFormat
ELSE
SELECT
BOS_SD_FSo.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
BOS_SD_FSo.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,	
'' As szUomId,
sum(BOS_SD_FSo.decDownPayment) As decAmount1,
null As decAmount2

FROM
BOS_SD_FSo
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FSo.szWorkplaceId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FSo.szCcyId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FSo.szSalesId

WHERE
BOS_SD_FSo.dtmOrder >= p_dtmFirstDate And BOS_SD_FSo.dtmOrder < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FSo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FSo.bCash = 1 and
BOS_SD_FSo.bVoid=0
AND BOS_SD_FSo.szSalesId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FSo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FSo.szCcyId,
BOS_CU_Currency.szAmountFormat

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfCashierByFSoALL_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_SD_FSo.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
BOS_SD_FSo.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,    
'' As szUomId,
sum(BOS_SD_FSo.decDownPayment) As decAmount1,
null As decAmount2

FROM
BOS_SD_FSo
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FSo.szWorkplaceId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FSo.szCcyId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FSo.szSalesId

WHERE
BOS_SD_FSo.dtmOrder >= p_dtmFirstDate And BOS_SD_FSo.dtmOrder < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FSo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FSo.bCash = 1 and
BOS_SD_FSo.bVoid=0
--AND BOS_SD_FSo.szSalesId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FSo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FSo.szCcyId,
BOS_CU_Currency.szAmountFormat
ELSE
SELECT
BOS_SD_FSo.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
'CASH' As szProductId,
'' as szProductSN,
'' As szProductNm,
'' As szProductQtyFormat,
BOS_SD_FSo.szCcyId As szCcyId,
BOS_CU_Currency.szAmountFormat,    
'' As szUomId,
sum(BOS_SD_FSo.decDownPayment) As decAmount1,
null As decAmount2

FROM
BOS_SD_FSo
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FSo.szWorkplaceId
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FSo.szCcyId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FSo.szSalesId

WHERE
BOS_SD_FSo.dtmOrder >= p_dtmFirstDate And BOS_SD_FSo.dtmOrder < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FSo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FSo.bCash = 1 and
BOS_SD_FSo.bVoid=0
AND BOS_SD_FSo.szSalesId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FSo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FSo.szCcyId,
BOS_CU_Currency.szAmountFormat


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfFSettlement()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSettlementId,
dtmSettBegin,
dtmSettEnd


FROM 
BOS_SD_FSettlement

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfPdrByFCustDeposit(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_AR_FCustDeposit.szWorkplaceId As szWorkplaceId,  
'' As szPartyWpId,    --Only transfer between workplace that has entry for this field.  
BOS_GL_Workplace.szName As szWp1Nm,  
'' As szWp2Nm,  
BOS_AR_FCustDeposit.szDeposanId AS szEmployeeId,  
BOS_PI_Employee.szName As szEmployeeNm,  
BOS_AR_FCustDeposit.szBankId As szProductId,  
BOS_AR_FCustDeposit.szRefId AS szProductSN,  
'' AS szProductNm,  
'' As szProductQtyFormat,  
'' As szUomId,  
BOS_AR_FCustDeposit.szCcyId As szCcyId,  
BOS_CU_Currency.szAmountFormat,  
SUM(BOS_AR_FCustDeposit.decDeposit) As decAmount1,  
NULL As decAmount2  

FROM  
BOS_AR_FCustDeposit  
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustDeposit.szWorkplaceId  
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustDeposit.szDeposanId  
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustDeposit.szCcyId  
LEFT JOIN BOS_CAS_Pdr AS Pdr ON Pdr.szBankId = BOS_AR_FCustDeposit.szBankId  
AND Pdr.szRefId = BOS_AR_FCustDeposit.szRefId  

WHERE  
BOS_AR_FCustDeposit.dtmFCustDeposit >= p_dtmFirstDate AND BOS_AR_FCustDeposit.dtmFCustDeposit < dateadd(day, 1, p_dtmLastDate)  
AND BOS_AR_FCustDeposit.szWorkplaceId LIKE p_szWorkplaceId  
AND BOS_AR_FCustDeposit.bVoid = 0  
AND BOS_AR_FCustDeposit.szDeposanId LIKE p_szOpUserId  
--This will prevent payment created by system to be calculated again as there will be no PDR receipt to match.  
AND BOS_AR_FCustDeposit.bSystemCreated = 0  
AND BOS_AR_FCustDeposit.szBankId <> '' AND BOS_AR_FCustDeposit.szRefId <> ''  
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement  
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl   
AND (
--  IF ALREADY APPLIED, DO NOT INCLUDE REJECTED PDR BECOZ USER CANNOT CHANGE IT ANYMORE.
(
BOS_AR_FCustDeposit.bApplied = 1 
AND (Pdr.szStatus <> 'REJ' OR (Pdr.szStatus = 'REJ' AND Pdr.dtmClear >= dateadd(day, 1, p_dtmLastDate))) 
AND (Pdr.szStatus <> 'CAN' OR (Pdr.szStatus = 'CAN' AND Pdr.dtmClear >= dateadd(day, 1, p_dtmLastDate)))
)
OR 
--  IF NOT APPLIED, JUST SHOW THE PDR, INCLUDING THE REJECTED ONE, SO USER AWARES AND CAN FIX IT.
(BOS_AR_FCustDeposit.bApplied = 0)
)

GROUP BY  
BOS_AR_FCustDeposit.szWorkplaceId,  
BOS_GL_Workplace.szName,  
BOS_AR_FCustDeposit.szDeposanId,  
BOS_PI_Employee.szName,  
BOS_AR_FCustDeposit.szBankId,  
BOS_AR_FCustDeposit.szRefId,  
BOS_AR_FCustDeposit.szCcyId,  
BOS_CU_Currency.szAmountFormat

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfPdrByFCustDeposit_013(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT  
BOS_AR_FCustDeposit.szWorkplaceId As szWorkplaceId,  
'' As szPartyWpId,    --Only transfer between workplace that has entry for this field.  
BOS_GL_Workplace.szName As szWp1Nm,  
'' As szWp2Nm,  
BOS_AR_FCustDeposit.szDeposanId AS szEmployeeId,  
BOS_PI_Employee.szName As szEmployeeNm,  
BOS_AR_FCustDeposit.szBankId As szProductId,  
BOS_AR_FCustDeposit.szRefId AS szProductSN,  
'' AS szProductNm,  
'' As szProductQtyFormat,  
'' As szUomId,  
BOS_AR_FCustDeposit.szCcyId As szCcyId,  
BOS_CU_Currency.szAmountFormat,  
SUM(BOS_AR_FCustDeposit.decDeposit) As decAmount1,  
NULL As decAmount2  

FROM  
BOS_AR_FCustDeposit  
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustDeposit.szWorkplaceId  
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustDeposit.szDeposanId  
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustDeposit.szCcyId  
LEFT JOIN BOS_CAS_Pdr AS Pdr ON Pdr.szBankId = BOS_AR_FCustDeposit.szBankId  
AND Pdr.szRefId = BOS_AR_FCustDeposit.szRefId  

WHERE  
BOS_AR_FCustDeposit.dtmFCustDeposit >= p_dtmFirstDate AND BOS_AR_FCustDeposit.dtmFCustDeposit < dateadd(day, 1, p_dtmLastDate)  
AND BOS_AR_FCustDeposit.szWorkplaceId = p_szWorkplaceId  
AND BOS_AR_FCustDeposit.bVoid = 0  
--AND BOS_AR_FCustDeposit.szDeposanId = p_szOpUserId  
--This will prevent payment created by system to be calculated again as there will be no PDR receipt to match.  
AND BOS_AR_FCustDeposit.bSystemCreated = 0  
AND BOS_AR_FCustDeposit.szBankId <> '' AND BOS_AR_FCustDeposit.szRefId <> ''  
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement  
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl   
AND (
--  IF ALREADY APPLIED, DO NOT INCLUDE REJECTED PDR BECOZ USER CANNOT CHANGE IT ANYMORE.
(
BOS_AR_FCustDeposit.bApplied = 1 
AND (Pdr.szStatus <> 'REJ' OR (Pdr.szStatus = 'REJ' AND Pdr.dtmClear >= dateadd(day, 1, p_dtmLastDate))) 
AND (Pdr.szStatus <> 'CAN' OR (Pdr.szStatus = 'CAN' AND Pdr.dtmClear >= dateadd(day, 1, p_dtmLastDate)))
)
OR 
--  IF NOT APPLIED, JUST SHOW THE PDR, INCLUDING THE REJECTED ONE, SO USER AWARES AND CAN FIX IT.
(BOS_AR_FCustDeposit.bApplied = 0)
)

GROUP BY  
BOS_AR_FCustDeposit.szWorkplaceId,  
BOS_GL_Workplace.szName,  
BOS_AR_FCustDeposit.szDeposanId,  
BOS_PI_Employee.szName,  
BOS_AR_FCustDeposit.szBankId,  
BOS_AR_FCustDeposit.szRefId,  
BOS_AR_FCustDeposit.szCcyId,  
BOS_CU_Currency.szAmountFormat
ELSE
SELECT  
BOS_AR_FCustDeposit.szWorkplaceId As szWorkplaceId,  
'' As szPartyWpId,    --Only transfer between workplace that has entry for this field.  
BOS_GL_Workplace.szName As szWp1Nm,  
'' As szWp2Nm,  
BOS_AR_FCustDeposit.szDeposanId AS szEmployeeId,  
BOS_PI_Employee.szName As szEmployeeNm,  
BOS_AR_FCustDeposit.szBankId As szProductId,  
BOS_AR_FCustDeposit.szRefId AS szProductSN,  
'' AS szProductNm,  
'' As szProductQtyFormat,  
'' As szUomId,  
BOS_AR_FCustDeposit.szCcyId As szCcyId,  
BOS_CU_Currency.szAmountFormat,  
SUM(BOS_AR_FCustDeposit.decDeposit) As decAmount1,  
NULL As decAmount2  

FROM  
BOS_AR_FCustDeposit  
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustDeposit.szWorkplaceId  
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustDeposit.szDeposanId  
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustDeposit.szCcyId  
LEFT JOIN BOS_CAS_Pdr AS Pdr ON Pdr.szBankId = BOS_AR_FCustDeposit.szBankId  
AND Pdr.szRefId = BOS_AR_FCustDeposit.szRefId  

WHERE  
BOS_AR_FCustDeposit.dtmFCustDeposit >= p_dtmFirstDate AND BOS_AR_FCustDeposit.dtmFCustDeposit < dateadd(day, 1, p_dtmLastDate)  
AND BOS_AR_FCustDeposit.szWorkplaceId = p_szWorkplaceId  
AND BOS_AR_FCustDeposit.bVoid = 0  
AND BOS_AR_FCustDeposit.szDeposanId = p_szOpUserId  
--This will prevent payment created by system to be calculated again as there will be no PDR receipt to match.  
AND BOS_AR_FCustDeposit.bSystemCreated = 0  
AND BOS_AR_FCustDeposit.szBankId <> '' AND BOS_AR_FCustDeposit.szRefId <> ''  
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement  
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl   
AND (
--  IF ALREADY APPLIED, DO NOT INCLUDE REJECTED PDR BECOZ USER CANNOT CHANGE IT ANYMORE.
(
BOS_AR_FCustDeposit.bApplied = 1 
AND (Pdr.szStatus <> 'REJ' OR (Pdr.szStatus = 'REJ' AND Pdr.dtmClear >= dateadd(day, 1, p_dtmLastDate))) 
AND (Pdr.szStatus <> 'CAN' OR (Pdr.szStatus = 'CAN' AND Pdr.dtmClear >= dateadd(day, 1, p_dtmLastDate)))
)
OR 
--  IF NOT APPLIED, JUST SHOW THE PDR, INCLUDING THE REJECTED ONE, SO USER AWARES AND CAN FIX IT.
(BOS_AR_FCustDeposit.bApplied = 0)
)

GROUP BY  
BOS_AR_FCustDeposit.szWorkplaceId,  
BOS_GL_Workplace.szName,  
BOS_AR_FCustDeposit.szDeposanId,  
BOS_PI_Employee.szName,  
BOS_AR_FCustDeposit.szBankId,  
BOS_AR_FCustDeposit.szRefId,  
BOS_AR_FCustDeposit.szCcyId,  
BOS_CU_Currency.szAmountFormat

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfPdrByFCustPayment(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_AR_FCustPayment.szWorkplaceId As szWorkplaceId,  
'' As szPartyWpId,    --Only transfer between workplace that has entry for this field.  
BOS_GL_Workplace.szName As szWp1Nm,  
'' As szWp2Nm,  
BOS_AR_FCustPayment.szDeposanId AS szEmployeeId,  
BOS_PI_Employee.szName As szEmployeeNm,  
BOS_AR_FCustPaymentItemDetail.szBankId As szProductId,  
BOS_AR_FCustPaymentItemDetail.szRefDocId AS szProductSN,  
'' AS szProductNm,  
'' As szProductQtyFormat,  
'' As szUomId,  
BOS_AR_FCustPayment.szCcyId As szCcyId,  
BOS_CU_Currency.szAmountFormat,  
SUM(BOS_AR_FCustPaymentItemDetail.decAmount) As decAmount1,  
NULL As decAmount2  

FROM  
BOS_AR_FCustPayment  
INNER JOIN BOS_AR_FCustPaymentItemDetail   
ON BOS_AR_FCustPaymentItemDetail.szFCustPaymentId = BOS_AR_FCustPayment.szFCustPaymentId  

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustPayment.szWorkplaceId  
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustPayment.szDeposanId  
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustPayment.szCcyId  
LEFT JOIN BOS_CAS_Pdr AS Pdr ON Pdr.szBankId = BOS_AR_FCustPaymentItemDetail.szBankId  
AND Pdr.szRefId = BOS_AR_FCustPaymentItemDetail.szRefDocId  

WHERE  
BOS_AR_FCustPayment.dtmFCustPayment >= p_dtmFirstDate AND BOS_AR_FCustPayment.dtmFCustPayment < dateadd(day, 1, p_dtmLastDate)  
AND BOS_AR_FCustPayment.szWorkplaceId LIKE p_szWorkplaceId  
AND BOS_AR_FCustPayment.bVoid = 0  
AND BOS_AR_FCustPayment.szDeposanId LIKE p_szOpUserId  
--This will prevent payment created by system to be calculated again as there will be no PDR receipt to match.  
AND BOS_AR_FCustPayment.bSystemCreated = 0  
AND BOS_AR_FCustPaymentItemDetail.szBankId <> '' AND BOS_AR_FCustPaymentItemDetail.szRefDocId <> ''  
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement  
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl  
AND (
--  IF ALREADY APPLIED, DO NOT INCLUDE REJECTED PDR BECOZ USER CANNOT CHANGE IT ANYMORE.
(
BOS_AR_FCustPayment.bApplied = 1 
AND (Pdr.szStatus <> 'REJ' OR (Pdr.szStatus = 'REJ' AND Pdr.dtmClear >= dateadd(day, 1, p_dtmLastDate))) 
AND (Pdr.szStatus <> 'CAN' OR (Pdr.szStatus = 'CAN' AND Pdr.dtmClear >= dateadd(day, 1, p_dtmLastDate)))
)
OR 
--  IF NOT APPLIED, JUST SHOW THE PDR, INCLUDING THE REJECTED ONE, SO USER AWARES AND CAN FIX IT.
(BOS_AR_FCustPayment.bApplied = 0)
)

GROUP BY  
BOS_AR_FCustPayment.szWorkplaceId,  
BOS_GL_Workplace.szName,  
BOS_AR_FCustPayment.szDeposanId,  
BOS_PI_Employee.szName,  
BOS_AR_FCustPaymentItemDetail.szBankId,  
BOS_AR_FCustPaymentItemDetail.szRefDocId,  
BOS_AR_FCustPayment.szCcyId,  
BOS_CU_Currency.szAmountFormat

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfPdrByFCustPayment_013(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT  
BOS_AR_FCustPayment.szWorkplaceId As szWorkplaceId,  
'' As szPartyWpId,    --Only transfer between workplace that has entry for this field.  
BOS_GL_Workplace.szName As szWp1Nm,  
'' As szWp2Nm,  
BOS_AR_FCustPayment.szDeposanId AS szEmployeeId,  
BOS_PI_Employee.szName As szEmployeeNm,  
BOS_AR_FCustPaymentItemDetail.szBankId As szProductId,  
BOS_AR_FCustPaymentItemDetail.szRefDocId AS szProductSN,  
'' AS szProductNm,  
'' As szProductQtyFormat,  
'' As szUomId,  
BOS_AR_FCustPayment.szCcyId As szCcyId,  
BOS_CU_Currency.szAmountFormat,  
SUM(BOS_AR_FCustPaymentItemDetail.decAmount) As decAmount1,  
NULL As decAmount2  

FROM  
BOS_AR_FCustPayment  
INNER JOIN BOS_AR_FCustPaymentItemDetail   
ON BOS_AR_FCustPaymentItemDetail.szFCustPaymentId = BOS_AR_FCustPayment.szFCustPaymentId  

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustPayment.szWorkplaceId  
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustPayment.szDeposanId  
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustPayment.szCcyId  
LEFT JOIN BOS_CAS_Pdr AS Pdr ON Pdr.szBankId = BOS_AR_FCustPaymentItemDetail.szBankId  
AND Pdr.szRefId = BOS_AR_FCustPaymentItemDetail.szRefDocId  

WHERE  
BOS_AR_FCustPayment.dtmFCustPayment >= p_dtmFirstDate AND BOS_AR_FCustPayment.dtmFCustPayment < dateadd(day, 1, p_dtmLastDate)  
AND BOS_AR_FCustPayment.szWorkplaceId = p_szWorkplaceId  
AND BOS_AR_FCustPayment.bVoid = 0  
--AND BOS_AR_FCustPayment.szDeposanId = p_szOpUserId  
--This will prevent payment created by system to be calculated again as there will be no PDR receipt to match.  
AND BOS_AR_FCustPayment.bSystemCreated = 0  
AND BOS_AR_FCustPaymentItemDetail.szBankId <> '' AND BOS_AR_FCustPaymentItemDetail.szRefDocId <> ''  
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement  
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl  
AND (
--  IF ALREADY APPLIED, DO NOT INCLUDE REJECTED PDR BECOZ USER CANNOT CHANGE IT ANYMORE.
(
BOS_AR_FCustPayment.bApplied = 1 
AND (Pdr.szStatus <> 'REJ' OR (Pdr.szStatus = 'REJ' AND Pdr.dtmClear >= dateadd(day, 1, p_dtmLastDate))) 
AND (Pdr.szStatus <> 'CAN' OR (Pdr.szStatus = 'CAN' AND Pdr.dtmClear >= dateadd(day, 1, p_dtmLastDate)))
)
OR 
--  IF NOT APPLIED, JUST SHOW THE PDR, INCLUDING THE REJECTED ONE, SO USER AWARES AND CAN FIX IT.
(BOS_AR_FCustPayment.bApplied = 0)
)

GROUP BY  
BOS_AR_FCustPayment.szWorkplaceId,  
BOS_GL_Workplace.szName,  
BOS_AR_FCustPayment.szDeposanId,  
BOS_PI_Employee.szName,  
BOS_AR_FCustPaymentItemDetail.szBankId,  
BOS_AR_FCustPaymentItemDetail.szRefDocId,  
BOS_AR_FCustPayment.szCcyId,  
BOS_CU_Currency.szAmountFormat
ELSE
SELECT  
BOS_AR_FCustPayment.szWorkplaceId As szWorkplaceId,  
'' As szPartyWpId,    --Only transfer between workplace that has entry for this field.  
BOS_GL_Workplace.szName As szWp1Nm,  
'' As szWp2Nm,  
BOS_AR_FCustPayment.szDeposanId AS szEmployeeId,  
BOS_PI_Employee.szName As szEmployeeNm,  
BOS_AR_FCustPaymentItemDetail.szBankId As szProductId,  
BOS_AR_FCustPaymentItemDetail.szRefDocId AS szProductSN,  
'' AS szProductNm,  
'' As szProductQtyFormat,  
'' As szUomId,  
BOS_AR_FCustPayment.szCcyId As szCcyId,  
BOS_CU_Currency.szAmountFormat,  
SUM(BOS_AR_FCustPaymentItemDetail.decAmount) As decAmount1,  
NULL As decAmount2  

FROM  
BOS_AR_FCustPayment  
INNER JOIN BOS_AR_FCustPaymentItemDetail   
ON BOS_AR_FCustPaymentItemDetail.szFCustPaymentId = BOS_AR_FCustPayment.szFCustPaymentId  

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_AR_FCustPayment.szWorkplaceId  
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_AR_FCustPayment.szDeposanId  
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_AR_FCustPayment.szCcyId  
LEFT JOIN BOS_CAS_Pdr AS Pdr ON Pdr.szBankId = BOS_AR_FCustPaymentItemDetail.szBankId  
AND Pdr.szRefId = BOS_AR_FCustPaymentItemDetail.szRefDocId  

WHERE  
BOS_AR_FCustPayment.dtmFCustPayment >= p_dtmFirstDate AND BOS_AR_FCustPayment.dtmFCustPayment < dateadd(day, 1, p_dtmLastDate)  
AND BOS_AR_FCustPayment.szWorkplaceId = p_szWorkplaceId  
AND BOS_AR_FCustPayment.bVoid = 0  
AND BOS_AR_FCustPayment.szDeposanId = p_szOpUserId  
--This will prevent payment created by system to be calculated again as there will be no PDR receipt to match.  
AND BOS_AR_FCustPayment.bSystemCreated = 0  
AND BOS_AR_FCustPaymentItemDetail.szBankId <> '' AND BOS_AR_FCustPaymentItemDetail.szRefDocId <> ''  
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement  
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl  
AND (
--  IF ALREADY APPLIED, DO NOT INCLUDE REJECTED PDR BECOZ USER CANNOT CHANGE IT ANYMORE.
(
BOS_AR_FCustPayment.bApplied = 1 
AND (Pdr.szStatus <> 'REJ' OR (Pdr.szStatus = 'REJ' AND Pdr.dtmClear >= dateadd(day, 1, p_dtmLastDate))) 
AND (Pdr.szStatus <> 'CAN' OR (Pdr.szStatus = 'CAN' AND Pdr.dtmClear >= dateadd(day, 1, p_dtmLastDate)))
)
OR 
--  IF NOT APPLIED, JUST SHOW THE PDR, INCLUDING THE REJECTED ONE, SO USER AWARES AND CAN FIX IT.
(BOS_AR_FCustPayment.bApplied = 0)
)

GROUP BY  
BOS_AR_FCustPayment.szWorkplaceId,  
BOS_GL_Workplace.szName,  
BOS_AR_FCustPayment.szDeposanId,  
BOS_PI_Employee.szName,  
BOS_AR_FCustPaymentItemDetail.szBankId,  
BOS_AR_FCustPaymentItemDetail.szRefDocId,  
BOS_AR_FCustPayment.szCcyId,  
BOS_CU_Currency.szAmountFormat

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfPdrByPdr(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_CAS_Pdr.szRecWorkplaceId As szWorkplaceId,  
'' As szPartyWpId,    --Only transfer between workplace that has entry for this field.  
BOS_GL_Workplace.szName As szWp1Nm,  
'' As szWp2Nm,  
BOS_CAS_Pdr.szDeposanId AS szEmployeeId,  
BOS_PI_Employee.szName As szEmployeeNm,  
BOS_CAS_Pdr.szBankId As szProductId,  
BOS_CAS_Pdr.szRefId AS szProductSN,  
'' AS szProductNm,  
'' As szProductQtyFormat,  
'' As szUomId,  
BOS_CAS_Pdr.szCcyId As szCcyId,  
BOS_CU_Currency.szAmountFormat,  
NULL As decAmount1,  
BOS_CAS_Pdr.decAmount As decAmount2  

FROM  
BOS_CAS_Pdr  
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_Pdr.szRecWorkplaceId  
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_Pdr.szDeposanId  
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_Pdr.szCcyId  

WHERE  
BOS_CAS_Pdr.dtmReceipt >= p_dtmFirstDate AND BOS_CAS_Pdr.dtmReceipt < dateadd(day, 1, p_dtmLastDate)  
AND BOS_CAS_Pdr.szRecWorkplaceId LIKE p_szWorkplaceId  
AND BOS_CAS_Pdr.szDeposanId LIKE p_szOpUserId  
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement  
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl  
--DO NOT INCLUDED REJECTED AND CANCEL PDR SO USER CAN FIX ERROR IN PDR BY SIMPLY REJECTING IT.  
AND (BOS_CAS_Pdr.szStatus <> 'REJ' OR (BOS_CAS_Pdr.szStatus = 'REJ' AND BOS_CAS_Pdr.dtmClear >= dateadd(day, 1, p_dtmLastDate)))  
AND (BOS_CAS_Pdr.szStatus <> 'CAN' OR (BOS_CAS_Pdr.szStatus = 'CAN' AND BOS_CAS_Pdr.dtmClear >= dateadd(day, 1, p_dtmLastDate)))

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfPdrByPdr_013(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT  
BOS_CAS_Pdr.szRecWorkplaceId As szWorkplaceId,  
'' As szPartyWpId,    --Only transfer between workplace that has entry for this field.  
BOS_GL_Workplace.szName As szWp1Nm,  
'' As szWp2Nm,  
BOS_CAS_Pdr.szDeposanId AS szEmployeeId,  
BOS_PI_Employee.szName As szEmployeeNm,  
BOS_CAS_Pdr.szBankId As szProductId,  
BOS_CAS_Pdr.szRefId AS szProductSN,  
'' AS szProductNm,  
'' As szProductQtyFormat,  
'' As szUomId,  
BOS_CAS_Pdr.szCcyId As szCcyId,  
BOS_CU_Currency.szAmountFormat,  
NULL As decAmount1,  
BOS_CAS_Pdr.decAmount As decAmount2  

FROM  
BOS_CAS_Pdr  
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_Pdr.szRecWorkplaceId  
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_Pdr.szDeposanId  
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_Pdr.szCcyId  

WHERE  
BOS_CAS_Pdr.dtmReceipt >= p_dtmFirstDate AND BOS_CAS_Pdr.dtmReceipt < dateadd(day, 1, p_dtmLastDate)  
AND BOS_CAS_Pdr.szRecWorkplaceId = p_szWorkplaceId  
--AND BOS_CAS_Pdr.szDeposanId = p_szOpUserId  
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement  
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl  
--DO NOT INCLUDED REJECTED AND CANCEL PDR SO USER CAN FIX ERROR IN PDR BY SIMPLY REJECTING IT.  
AND (BOS_CAS_Pdr.szStatus <> 'REJ' OR (BOS_CAS_Pdr.szStatus = 'REJ' AND BOS_CAS_Pdr.dtmClear >= dateadd(day, 1, p_dtmLastDate)))  
AND (BOS_CAS_Pdr.szStatus <> 'CAN' OR (BOS_CAS_Pdr.szStatus = 'CAN' AND BOS_CAS_Pdr.dtmClear >= dateadd(day, 1, p_dtmLastDate)))
ELSE
SELECT  
BOS_CAS_Pdr.szRecWorkplaceId As szWorkplaceId,  
'' As szPartyWpId,    --Only transfer between workplace that has entry for this field.  
BOS_GL_Workplace.szName As szWp1Nm,  
'' As szWp2Nm,  
BOS_CAS_Pdr.szDeposanId AS szEmployeeId,  
BOS_PI_Employee.szName As szEmployeeNm,  
BOS_CAS_Pdr.szBankId As szProductId,  
BOS_CAS_Pdr.szRefId AS szProductSN,  
'' AS szProductNm,  
'' As szProductQtyFormat,  
'' As szUomId,  
BOS_CAS_Pdr.szCcyId As szCcyId,  
BOS_CU_Currency.szAmountFormat,  
NULL As decAmount1,  
BOS_CAS_Pdr.decAmount As decAmount2  

FROM  
BOS_CAS_Pdr  
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_CAS_Pdr.szRecWorkplaceId  
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_CAS_Pdr.szDeposanId  
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_CAS_Pdr.szCcyId  

WHERE  
BOS_CAS_Pdr.dtmReceipt >= p_dtmFirstDate AND BOS_CAS_Pdr.dtmReceipt < dateadd(day, 1, p_dtmLastDate)  
AND BOS_CAS_Pdr.szRecWorkplaceId = p_szWorkplaceId  
AND BOS_CAS_Pdr.szDeposanId = p_szOpUserId  
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement  
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl  
--DO NOT INCLUDED REJECTED AND CANCEL PDR SO USER CAN FIX ERROR IN PDR BY SIMPLY REJECTING IT.  
AND (BOS_CAS_Pdr.szStatus <> 'REJ' OR (BOS_CAS_Pdr.szStatus = 'REJ' AND BOS_CAS_Pdr.dtmClear >= dateadd(day, 1, p_dtmLastDate)))  
AND (BOS_CAS_Pdr.szStatus <> 'CAN' OR (BOS_CAS_Pdr.szStatus = 'CAN' AND BOS_CAS_Pdr.dtmClear >= dateadd(day, 1, p_dtmLastDate)))

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductReturnedAll(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_SD_FDo.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' As szEmployeeId,
'' As szEmployeeNm,
BOS_SD_FDoItem.szProductId,
'' as szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
sum(BOS_SD_FDoItem.decQty) As decAmount1,
null As decAmount2
FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) and
BOS_SD_FDo.szWorkplaceId like p_szWorkplaceId And
BOS_SD_FDo.bVoid = 0
--When directly return to warehouse, no FDn created, so it must be excluded from inventory settlement.
AND BOS_SD_FDo.bReturnToWarehouse = 0
AND BOS_SD_FDoItem.decQty < 0
AND BOS_SD_FDo.szDriverId LIKE p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
AND BOS_SD_FDo.szLogisticType <> 'POS'

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDoItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_SD_FDo.szWorkplaceId,
BOS_SD_FDoItem.szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductReturnedAll_013(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_SD_FDo.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' As szEmployeeId,
'' As szEmployeeNm,
BOS_SD_FDoItem.szProductId,
'' as szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
sum(BOS_SD_FDoItem.decQty) As decAmount1,
null As decAmount2
FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) and
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FDo.bVoid = 0
--When directly return to warehouse, no FDn created, so it must be excluded from inventory settlement.
AND BOS_SD_FDo.bReturnToWarehouse = 0
AND BOS_SD_FDoItem.decQty < 0
--AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
AND BOS_SD_FDo.szLogisticType <> 'POS'

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDoItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_SD_FDo.szWorkplaceId,
BOS_SD_FDoItem.szProductId
ELSE
SELECT
BOS_SD_FDo.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' As szEmployeeId,
'' As szEmployeeNm,
BOS_SD_FDoItem.szProductId,
'' as szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
sum(BOS_SD_FDoItem.decQty) As decAmount1,
null As decAmount2
FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) and
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FDo.bVoid = 0
--When directly return to warehouse, no FDn created, so it must be excluded from inventory settlement.
AND BOS_SD_FDo.bReturnToWarehouse = 0
AND BOS_SD_FDoItem.decQty < 0
AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
AND BOS_SD_FDo.szLogisticType <> 'POS'

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDoItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_SD_FDo.szWorkplaceId,
BOS_SD_FDoItem.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductReturnedByEmployee(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_FDo.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FDo.szDriverId As szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_SD_FDoItem.szProductId,
'' As szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
BOS_INV_Product.szQtyFormat As szAmountFormat,	
sum(BOS_SD_FDoItem.decQty) As decAmount1,
null As decAmount2

FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) and
BOS_SD_FDo.szWorkplaceId like p_szWorkplaceId And
BOS_SD_FDo.bVoid = 0
--When directly return to warehouse, no FDn created, so it must be excluded from inventory settlement.
AND BOS_SD_FDo.bReturnToWarehouse = 0
AND BOS_SD_FDoItem.decQty < 0
AND BOS_SD_FDo.szDriverId LIKE p_szOpUserId
AND BOS_SD_FDo.szLogisticType <> 'POS'
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDo.szDriverId,
BOS_PI_Employee.szName,
BOS_SD_FDoItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_SD_FDo.szWorkplaceId,
BOS_SD_FDo.szDriverId,
BOS_SD_FDoItem.szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductReturnedByEmployee_013(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_SD_FDo.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FDo.szDriverId As szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_SD_FDoItem.szProductId,
'' As szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
BOS_INV_Product.szQtyFormat As szAmountFormat,	
sum(BOS_SD_FDoItem.decQty) As decAmount1,
null As decAmount2

FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) and
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FDo.bVoid = 0
--When directly return to warehouse, no FDn created, so it must be excluded from inventory settlement.
AND BOS_SD_FDo.bReturnToWarehouse = 0
AND BOS_SD_FDoItem.decQty < 0
--AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND BOS_SD_FDo.szLogisticType <> 'POS'
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDo.szDriverId,
BOS_PI_Employee.szName,
BOS_SD_FDoItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_SD_FDo.szWorkplaceId,
BOS_SD_FDo.szDriverId,
BOS_SD_FDoItem.szProductId
ELSE
SELECT
BOS_SD_FDo.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FDo.szDriverId As szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_SD_FDoItem.szProductId,
'' As szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
BOS_INV_Product.szQtyFormat As szAmountFormat,	
sum(BOS_SD_FDoItem.decQty) As decAmount1,
null As decAmount2

FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) and
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FDo.bVoid = 0
--When directly return to warehouse, no FDn created, so it must be excluded from inventory settlement.
AND BOS_SD_FDo.bReturnToWarehouse = 0
AND BOS_SD_FDoItem.decQty < 0
AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND BOS_SD_FDo.szLogisticType <> 'POS'
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDo.szDriverId,
BOS_PI_Employee.szName,
BOS_SD_FDoItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_SD_FDo.szWorkplaceId,
BOS_SD_FDo.szDriverId,
BOS_SD_FDoItem.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductSnReturnedByEmployee(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FDo.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FDo.szDriverId As szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_SD_FDoItem.szProductId,
BOS_INV_Product.szName As szProductNm,
BOS_SD_FDoItemSn.szProductSN as szProductSN,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,
DBO.KGenPosNegDecToFactor(BOS_SD_FDoItem.decQty) as decAmount1,
null As decAmount2
FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId
INNER JOIN BOS_SD_FDoItemSn 
ON BOS_SD_FDoItemSn.szDoId = BOS_SD_FDoItem.szDoId And BOS_SD_FDoItemSn.shItemNumber = BOS_SD_FDoItem.shItemNumber

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FDo.szWorkplaceId like p_szWorkplaceId And
BOS_SD_FDo.bVoid = 0
--When directly return to warehouse, no FDn created, so it must be excluded from inventory settlement.
AND BOS_SD_FDo.bReturnToWarehouse = 0
AND BOS_SD_FDoItem.decQty < 0
AND BOS_SD_FDo.szDriverId LIKE p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
AND BOS_SD_FDo.szLogisticType <> 'POS'

ORDER BY
BOS_SD_FDo.szWorkplaceId,
BOS_SD_FDo.szDriverId,
BOS_SD_FDoItem.szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductSnReturnedByEmployee_013(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT 
BOS_SD_FDo.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FDo.szDriverId As szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_SD_FDoItem.szProductId,
BOS_INV_Product.szName As szProductNm,
BOS_SD_FDoItemSn.szProductSN as szProductSN,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,
DBO.KGenPosNegDecToFactor(BOS_SD_FDoItem.decQty) as decAmount1,
null As decAmount2
FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId
INNER JOIN BOS_SD_FDoItemSn 
ON BOS_SD_FDoItemSn.szDoId = BOS_SD_FDoItem.szDoId And BOS_SD_FDoItemSn.shItemNumber = BOS_SD_FDoItem.shItemNumber

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FDo.bVoid = 0
--When directly return to warehouse, no FDn created, so it must be excluded from inventory settlement.
AND BOS_SD_FDo.bReturnToWarehouse = 0
AND BOS_SD_FDoItem.decQty < 0
--AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
AND BOS_SD_FDo.szLogisticType <> 'POS'

ORDER BY
BOS_SD_FDo.szWorkplaceId,
BOS_SD_FDo.szDriverId,
BOS_SD_FDoItem.szProductId
ELSE
SELECT 
BOS_SD_FDo.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FDo.szDriverId As szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_SD_FDoItem.szProductId,
BOS_INV_Product.szName As szProductNm,
BOS_SD_FDoItemSn.szProductSN as szProductSN,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,
DBO.KGenPosNegDecToFactor(BOS_SD_FDoItem.decQty) as decAmount1,
null As decAmount2
FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId
INNER JOIN BOS_SD_FDoItemSn 
ON BOS_SD_FDoItemSn.szDoId = BOS_SD_FDoItem.szDoId And BOS_SD_FDoItemSn.shItemNumber = BOS_SD_FDoItem.shItemNumber

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FDo.bVoid = 0
--When directly return to warehouse, no FDn created, so it must be excluded from inventory settlement.
AND BOS_SD_FDo.bReturnToWarehouse = 0
AND BOS_SD_FDoItem.decQty < 0
AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
AND BOS_SD_FDo.szLogisticType <> 'POS'

ORDER BY
BOS_SD_FDo.szWorkplaceId,
BOS_SD_FDo.szDriverId,
BOS_SD_FDoItem.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductSnSoldByEmployee(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FDo.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FDo.szDriverId As szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_SD_FDoItem.szProductId,
BOS_INV_Product.szName As szProductNm,
BOS_SD_FDoItemSn.szProductSN as szProductSN,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,
DBO.KGenPosNegDecToFactor(BOS_SD_FDoItem.decQty) as decAmount1,
null As decAmount2
FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId
INNER JOIN BOS_SD_FDoItemSn 
ON BOS_SD_FDoItemSn.szDoId = BOS_SD_FDoItem.szDoId And BOS_SD_FDoItemSn.shItemNumber = BOS_SD_FDoItem.shItemNumber

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FDo.szWorkplaceId like p_szWorkplaceId And
BOS_SD_FDo.bVoid = 0
--DO is released from warehouse using FDn, and this FDn is already included in the settlement.
--This means it doesn't matter whether DO released fr warehouse or not, all must be included into settlement.
--AND BOS_SD_FDo.bAllocFrWarehouse = 0
AND BOS_SD_FDoItem.decQty > 0
AND BOS_SD_FDo.szDriverId LIKE p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
and BOS_SD_FDo.szLogisticType <> 'POS'
ORDER BY
BOS_SD_FDo.szWorkplaceId,
BOS_SD_FDo.szDriverId,
BOS_SD_FDoItem.szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductSnSoldByEmployee_013(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT 
BOS_SD_FDo.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FDo.szDriverId As szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_SD_FDoItem.szProductId,
BOS_INV_Product.szName As szProductNm,
BOS_SD_FDoItemSn.szProductSN as szProductSN,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,
DBO.KGenPosNegDecToFactor(BOS_SD_FDoItem.decQty) as decAmount1,
null As decAmount2
FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId
INNER JOIN BOS_SD_FDoItemSn 
ON BOS_SD_FDoItemSn.szDoId = BOS_SD_FDoItem.szDoId And BOS_SD_FDoItemSn.shItemNumber = BOS_SD_FDoItem.shItemNumber

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FDo.bVoid = 0
--DO is released from warehouse using FDn, and this FDn is already included in the settlement.
--This means it doesn't matter whether DO released fr warehouse or not, all must be included into settlement.
--AND BOS_SD_FDo.bAllocFrWarehouse = 0
AND BOS_SD_FDoItem.decQty > 0
--AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
and BOS_SD_FDo.szLogisticType <> 'POS'

ORDER BY
BOS_SD_FDo.szWorkplaceId,
BOS_SD_FDo.szDriverId,
BOS_SD_FDoItem.szProductId
ELSE
SELECT 
BOS_SD_FDo.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FDo.szDriverId As szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_SD_FDoItem.szProductId,
BOS_INV_Product.szName As szProductNm,
BOS_SD_FDoItemSn.szProductSN as szProductSN,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,
DBO.KGenPosNegDecToFactor(BOS_SD_FDoItem.decQty) as decAmount1,
null As decAmount2
FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId
INNER JOIN BOS_SD_FDoItemSn 
ON BOS_SD_FDoItemSn.szDoId = BOS_SD_FDoItem.szDoId And BOS_SD_FDoItemSn.shItemNumber = BOS_SD_FDoItem.shItemNumber

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FDo.bVoid = 0
--DO is released from warehouse using FDn, and this FDn is already included in the settlement.
--This means it doesn't matter whether DO released fr warehouse or not, all must be included into settlement.
--AND BOS_SD_FDo.bAllocFrWarehouse = 0
AND BOS_SD_FDoItem.decQty > 0
AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
and BOS_SD_FDo.szLogisticType <> 'POS'

ORDER BY
BOS_SD_FDo.szWorkplaceId,
BOS_SD_FDo.szDriverId,
BOS_SD_FDoItem.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductSnTakenByEmployee(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_INV_StockSnHistory.szReportedAsId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_StockSnHistory.szProductId,
BOS_INV_Product.szName As szProductNm,
BOS_INV_StockSnHistory.szProductSn,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
null As decAmount1,
convert(Decimal(18, 2), BOS_INV_StockSnHistory.shQty) As decAmount2
FROM
BOS_INV_StockHistory
INNER JOIN BOS_INV_StockSnHistory ON BOS_INV_StockSnHistory.gdStockHistoryId = BOS_INV_StockHistory.gdHistoryId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_StockSnHistory.szReportedAsId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockSnHistory.szProductId

WHERE
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate 
And BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_StockSnHistory.szReportedAsId = p_szWorkplaceId And
(
BOS_INV_StockSnHistory.szLocationType = 'VEH' 
or BOS_INV_StockSnHistory.szLocationType = 'CAR'
or BOS_INV_StockSnHistory.szLocationType = 'EMP'
)
And BOS_INV_StockHistory.szStockTransferReason = 'DIS' 
--AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

ORDER BY
BOS_INV_StockSnHistory.szReportedAsId,
BOS_INV_StockHistory.szEmployeeId,
BOS_INV_StockSnHistory.szProductId
ELSE
SELECT
BOS_INV_StockSnHistory.szReportedAsId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_StockSnHistory.szProductId,
BOS_INV_Product.szName As szProductNm,
BOS_INV_StockSnHistory.szProductSn,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
null As decAmount1,
convert(Decimal(18, 2), BOS_INV_StockSnHistory.shQty) As decAmount2
FROM
BOS_INV_StockHistory
INNER JOIN BOS_INV_StockSnHistory ON BOS_INV_StockSnHistory.gdStockHistoryId = BOS_INV_StockHistory.gdHistoryId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_StockSnHistory.szReportedAsId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockSnHistory.szProductId

WHERE
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate 
And BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_StockSnHistory.szReportedAsId = p_szWorkplaceId And
(
BOS_INV_StockSnHistory.szLocationType = 'VEH' 
or BOS_INV_StockSnHistory.szLocationType = 'CAR'
or BOS_INV_StockSnHistory.szLocationType = 'EMP'
)
And BOS_INV_StockHistory.szStockTransferReason = 'DIS' 
AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

ORDER BY
BOS_INV_StockSnHistory.szReportedAsId,
BOS_INV_StockHistory.szEmployeeId,
BOS_INV_StockSnHistory.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductSnTakenByEmployee_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_INV_StockSnHistory.szReportedAsId As szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_StockSnHistory.szProductId,
BOS_INV_Product.szName As szProductNm,
BOS_INV_StockSnHistory.szProductSn,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
null As decAmount1,
convert(Decimal(18, 2), BOS_INV_StockSnHistory.shQty) As decAmount2
FROM
BOS_INV_StockHistory
INNER JOIN BOS_INV_StockSnHistory ON BOS_INV_StockSnHistory.gdStockHistoryId = BOS_INV_StockHistory.gdHistoryId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_StockSnHistory.szReportedAsId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockSnHistory.szProductId

WHERE
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate 
And BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_StockSnHistory.szReportedAsId = p_szWorkplaceId And
(
BOS_INV_StockSnHistory.szLocationType = 'VEH' 
or BOS_INV_StockSnHistory.szLocationType = 'CAR'
or BOS_INV_StockSnHistory.szLocationType = 'EMP'
)
And BOS_INV_StockHistory.szStockTransferReason = 'DIS' 
--AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

ORDER BY
BOS_INV_StockSnHistory.szReportedAsId,
BOS_INV_StockHistory.szEmployeeId,
BOS_INV_StockSnHistory.szProductId
ELSE
SELECT
BOS_INV_StockSnHistory.szReportedAsId As szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_StockSnHistory.szProductId,
BOS_INV_Product.szName As szProductNm,
BOS_INV_StockSnHistory.szProductSn,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
null As decAmount1,
convert(Decimal(18, 2), BOS_INV_StockSnHistory.shQty) As decAmount2
FROM
BOS_INV_StockHistory
INNER JOIN BOS_INV_StockSnHistory ON BOS_INV_StockSnHistory.gdStockHistoryId = BOS_INV_StockHistory.gdHistoryId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_StockSnHistory.szReportedAsId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockSnHistory.szProductId

WHERE
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate 
And BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_StockSnHistory.szReportedAsId = p_szWorkplaceId And
(
BOS_INV_StockSnHistory.szLocationType = 'VEH' 
or BOS_INV_StockSnHistory.szLocationType = 'CAR'
or BOS_INV_StockSnHistory.szLocationType = 'EMP'
)
And BOS_INV_StockHistory.szStockTransferReason = 'DIS' 
AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

ORDER BY
BOS_INV_StockSnHistory.szReportedAsId,
BOS_INV_StockHistory.szEmployeeId,
BOS_INV_StockSnHistory.szProductId


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductSnTakenByEmployeeFDn(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_INV_FDn.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_FDn.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_FDnItem.szProductId,
BOS_INV_Product.szName As szProductNm,
BOS_INV_FDnItemSn.szProductSn,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
null As decAmount1,
--Adjustment FDn can have negative quantity.
convert(Decimal(18, 2), dbo.KGenPosNegDecToFactor(BOS_INV_FDnItem.decQty)) As decAmount2
FROM
BOS_INV_FDn
INNER JOIN BOS_INV_FDnItem ON BOS_INV_FDnItem.szFDnId = BOS_INV_FDn.szFDnId
INNER JOIN BOS_INV_FDnItemSn ON BOS_INV_FDnItemSn.szFDnId = BOS_INV_FDnItem.szFDnId
AND BOS_INV_FDnItemSn.shItemNumber = BOS_INV_FDnItem.shItemNumber

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FDn.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FDn.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FDnItem.szProductId

WHERE
BOS_INV_FDn.dtmDelivery >= p_dtmFirstDate And BOS_INV_FDn.dtmDelivery < dateadd(day, 1, p_dtmLastDate) 
--And BOS_INV_FDn.szDriverId = p_szOpUserId 
AND BOS_INV_FDn.szFDoId <> '' 
AND BOS_INV_FDn.bApplied = 1		--Yes, for inventory documents, get only applied documents.
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

ORDER BY
BOS_INV_FDn.szWorkplaceId,
BOS_INV_FDn.szDriverId,
BOS_INV_FDnItem.szProductId
ELSE
SELECT
BOS_INV_FDn.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_FDn.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_FDnItem.szProductId,
BOS_INV_Product.szName As szProductNm,
BOS_INV_FDnItemSn.szProductSn,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
null As decAmount1,
--Adjustment FDn can have negative quantity.
convert(Decimal(18, 2), dbo.KGenPosNegDecToFactor(BOS_INV_FDnItem.decQty)) As decAmount2
FROM
BOS_INV_FDn
INNER JOIN BOS_INV_FDnItem ON BOS_INV_FDnItem.szFDnId = BOS_INV_FDn.szFDnId
INNER JOIN BOS_INV_FDnItemSn ON BOS_INV_FDnItemSn.szFDnId = BOS_INV_FDnItem.szFDnId
AND BOS_INV_FDnItemSn.shItemNumber = BOS_INV_FDnItem.shItemNumber

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FDn.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FDn.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FDnItem.szProductId

WHERE
BOS_INV_FDn.dtmDelivery >= p_dtmFirstDate And BOS_INV_FDn.dtmDelivery < dateadd(day, 1, p_dtmLastDate) 
And BOS_INV_FDn.szDriverId = p_szOpUserId 
AND BOS_INV_FDn.szFDoId <> '' 
AND BOS_INV_FDn.bApplied = 1		--Yes, for inventory documents, get only applied documents.
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

ORDER BY
BOS_INV_FDn.szWorkplaceId,
BOS_INV_FDn.szDriverId,
BOS_INV_FDnItem.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductSnTakenByEmployeeFDn_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_INV_FDn.szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_FDn.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_FDnItem.szProductId,
BOS_INV_Product.szName As szProductNm,
BOS_INV_FDnItemSn.szProductSn,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
null As decAmount1,
--Adjustment FDn can have negative quantity.
convert(Decimal(18, 2), dbo.KGenPosNegDecToFactor(BOS_INV_FDnItem.decQty)) As decAmount2
FROM
BOS_INV_FDn
INNER JOIN BOS_INV_FDnItem ON BOS_INV_FDnItem.szFDnId = BOS_INV_FDn.szFDnId
INNER JOIN BOS_INV_FDnItemSn ON BOS_INV_FDnItemSn.szFDnId = BOS_INV_FDnItem.szFDnId
AND BOS_INV_FDnItemSn.shItemNumber = BOS_INV_FDnItem.shItemNumber

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FDn.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FDn.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FDnItem.szProductId

WHERE
BOS_INV_FDn.dtmDelivery >= p_dtmFirstDate And BOS_INV_FDn.dtmDelivery < dateadd(day, 1, p_dtmLastDate) 
--And BOS_INV_FDn.szDriverId = p_szOpUserId 
AND BOS_INV_FDn.szFDoId <> '' 
AND BOS_INV_FDn.bApplied = 1        --Yes, for inventory documents, get only applied documents.
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

ORDER BY
BOS_INV_FDn.szWorkplaceId,
BOS_INV_FDn.szDriverId,
BOS_INV_FDnItem.szProductId
ELSE
SELECT
BOS_INV_FDn.szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_FDn.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_FDnItem.szProductId,
BOS_INV_Product.szName As szProductNm,
BOS_INV_FDnItemSn.szProductSn,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
null As decAmount1,
--Adjustment FDn can have negative quantity.
convert(Decimal(18, 2), dbo.KGenPosNegDecToFactor(BOS_INV_FDnItem.decQty)) As decAmount2
FROM
BOS_INV_FDn
INNER JOIN BOS_INV_FDnItem ON BOS_INV_FDnItem.szFDnId = BOS_INV_FDn.szFDnId
INNER JOIN BOS_INV_FDnItemSn ON BOS_INV_FDnItemSn.szFDnId = BOS_INV_FDnItem.szFDnId
AND BOS_INV_FDnItemSn.shItemNumber = BOS_INV_FDnItem.shItemNumber

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FDn.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FDn.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FDnItem.szProductId

WHERE
BOS_INV_FDn.dtmDelivery >= p_dtmFirstDate And BOS_INV_FDn.dtmDelivery < dateadd(day, 1, p_dtmLastDate) 
And BOS_INV_FDn.szDriverId = p_szOpUserId 
AND BOS_INV_FDn.szFDoId <> '' 
AND BOS_INV_FDn.bApplied = 1        --Yes, for inventory documents, get only applied documents.
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

ORDER BY
BOS_INV_FDn.szWorkplaceId,
BOS_INV_FDn.szDriverId,
BOS_INV_FDnItem.szProductId


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductSnVehicleRemainingQtyByEmployee(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_INV_FVRema.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_FVRema.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_FVRemaItem.szProductId,
BOS_INV_Product.szName As szProductNm,
BOS_INV_FVRemaItemSn.szProductSn,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
null As decAmount1,
null AS decAmount2,
convert(Decimal(18, 2), dbo.KGenPosNegDecToFactor(BOS_INV_FVRemaItem.decQty)) As decVehicleQty
FROM
BOS_INV_FVRema
INNER JOIN BOS_INV_FVRemaItem ON BOS_INV_FVRemaItem.szFVRemaId = BOS_INV_FVRema.szFVRemaId
INNER JOIN BOS_INV_FVRemaItemSn ON BOS_INV_FVRemaItemSn.szFVRemaId = BOS_INV_FVRemaItem.szFVRemaId
AND BOS_INV_FVRemaItemSn.btItemNumber = BOS_INV_FVRemaItem.btItemNumber

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FVRema.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FVRema.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FVRemaItem.szProductId

WHERE
BOS_INV_FVRema.dtmRemain >= p_dtmFirstDate 
And BOS_INV_FVRema.dtmRemain < dateadd(day, 1, p_dtmLastDate)
AND BOS_INV_FVRema.bApplied = 1
AND BOS_INV_FVRema.szWorkplaceId = p_szWorkplaceId
--AND BOS_INV_FVRema.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

ORDER BY
BOS_INV_FVRema.szWorkplaceId,
BOS_INV_FVRema.szDriverId,
BOS_INV_FVRemaItem.szProductId
ELSE
SELECT
BOS_INV_FVRema.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_FVRema.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_FVRemaItem.szProductId,
BOS_INV_Product.szName As szProductNm,
BOS_INV_FVRemaItemSn.szProductSn,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
null As decAmount1,
null AS decAmount2,
convert(Decimal(18, 2), dbo.KGenPosNegDecToFactor(BOS_INV_FVRemaItem.decQty)) As decVehicleQty
FROM
BOS_INV_FVRema
INNER JOIN BOS_INV_FVRemaItem ON BOS_INV_FVRemaItem.szFVRemaId = BOS_INV_FVRema.szFVRemaId
INNER JOIN BOS_INV_FVRemaItemSn ON BOS_INV_FVRemaItemSn.szFVRemaId = BOS_INV_FVRemaItem.szFVRemaId
AND BOS_INV_FVRemaItemSn.btItemNumber = BOS_INV_FVRemaItem.btItemNumber

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FVRema.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FVRema.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FVRemaItem.szProductId

WHERE
BOS_INV_FVRema.dtmRemain >= p_dtmFirstDate 
And BOS_INV_FVRema.dtmRemain < dateadd(day, 1, p_dtmLastDate)
AND BOS_INV_FVRema.bApplied = 1
AND BOS_INV_FVRema.szWorkplaceId = p_szWorkplaceId
AND BOS_INV_FVRema.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

ORDER BY
BOS_INV_FVRema.szWorkplaceId,
BOS_INV_FVRema.szDriverId,
BOS_INV_FVRemaItem.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductSnVehicleRemainingQtyByEmployee_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_INV_FVRema.szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_FVRema.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_FVRemaItem.szProductId,
BOS_INV_Product.szName As szProductNm,
BOS_INV_FVRemaItemSn.szProductSn,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
null As decAmount1,
null AS decAmount2,
convert(Decimal(18, 2), dbo.KGenPosNegDecToFactor(BOS_INV_FVRemaItem.decQty)) As decVehicleQty
FROM
BOS_INV_FVRema
INNER JOIN BOS_INV_FVRemaItem ON BOS_INV_FVRemaItem.szFVRemaId = BOS_INV_FVRema.szFVRemaId
INNER JOIN BOS_INV_FVRemaItemSn ON BOS_INV_FVRemaItemSn.szFVRemaId = BOS_INV_FVRemaItem.szFVRemaId
AND BOS_INV_FVRemaItemSn.btItemNumber = BOS_INV_FVRemaItem.btItemNumber

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FVRema.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FVRema.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FVRemaItem.szProductId

WHERE
BOS_INV_FVRema.dtmRemain >= p_dtmFirstDate 
And BOS_INV_FVRema.dtmRemain < dateadd(day, 1, p_dtmLastDate)
AND BOS_INV_FVRema.bApplied = 1
AND BOS_INV_FVRema.szWorkplaceId = p_szWorkplaceId
--AND BOS_INV_FVRema.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

ORDER BY
BOS_INV_FVRema.szWorkplaceId,
BOS_INV_FVRema.szDriverId,
BOS_INV_FVRemaItem.szProductId
ELSE
SELECT
BOS_INV_FVRema.szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_FVRema.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_FVRemaItem.szProductId,
BOS_INV_Product.szName As szProductNm,
BOS_INV_FVRemaItemSn.szProductSn,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
null As decAmount1,
null AS decAmount2,
convert(Decimal(18, 2), dbo.KGenPosNegDecToFactor(BOS_INV_FVRemaItem.decQty)) As decVehicleQty
FROM
BOS_INV_FVRema
INNER JOIN BOS_INV_FVRemaItem ON BOS_INV_FVRemaItem.szFVRemaId = BOS_INV_FVRema.szFVRemaId
INNER JOIN BOS_INV_FVRemaItemSn ON BOS_INV_FVRemaItemSn.szFVRemaId = BOS_INV_FVRemaItem.szFVRemaId
AND BOS_INV_FVRemaItemSn.btItemNumber = BOS_INV_FVRemaItem.btItemNumber

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FVRema.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FVRema.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FVRemaItem.szProductId

WHERE
BOS_INV_FVRema.dtmRemain >= p_dtmFirstDate 
And BOS_INV_FVRema.dtmRemain < dateadd(day, 1, p_dtmLastDate)
AND BOS_INV_FVRema.bApplied = 1
AND BOS_INV_FVRema.szWorkplaceId = p_szWorkplaceId
AND BOS_INV_FVRema.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

ORDER BY
BOS_INV_FVRema.szWorkplaceId,
BOS_INV_FVRema.szDriverId,
BOS_INV_FVRemaItem.szProductId


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductSoldAll(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_SD_FDo.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' As szEmployeeId,
'' As szEmployeeNm,
BOS_SD_FDoItem.szProductId,
'' as szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
sum(BOS_SD_FDoItem.decQty) As decAmount1,
null As decAmount2
FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) and
BOS_SD_FDo.szWorkplaceId like p_szWorkplaceId And
BOS_SD_FDo.bVoid = 0
--DO is released from warehouse using FDn, and this FDn is already included in the settlement.
--This means it doesn't matter whether DO released fr warehouse or not, all must be included into settlement.
--AND BOS_SD_FDo.bAllocFrWarehouse = 0
AND BOS_SD_FDoItem.decQty > 0
AND BOS_SD_FDo.szDriverId LIKE p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
AND BOS_INV_Product.bService = 0
and BOS_SD_FDO.szLogisticType <> 'POS'

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDoItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_SD_FDo.szWorkplaceId,
BOS_SD_FDoItem.szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductSoldAll_013(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_SD_FDo.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' As szEmployeeId,
'' As szEmployeeNm,
BOS_SD_FDoItem.szProductId,
'' as szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
sum(BOS_SD_FDoItem.decQty) As decAmount1,
null As decAmount2
FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) and
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FDo.bVoid = 0
--DO is released from warehouse using FDn, and this FDn is already included in the settlement.
--This means it doesn't matter whether DO released fr warehouse or not, all must be included into settlement.
--AND BOS_SD_FDo.bAllocFrWarehouse = 0
AND BOS_SD_FDoItem.decQty > 0
--AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
AND BOS_INV_Product.bService = 0
and BOS_SD_FDO.szLogisticType <> 'POS'

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDoItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_SD_FDo.szWorkplaceId,
BOS_SD_FDoItem.szProductId
ELSE
SELECT
BOS_SD_FDo.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' As szEmployeeId,
'' As szEmployeeNm,
BOS_SD_FDoItem.szProductId,
'' as szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
sum(BOS_SD_FDoItem.decQty) As decAmount1,
null As decAmount2
FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) and
BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId And
BOS_SD_FDo.bVoid = 0
--DO is released from warehouse using FDn, and this FDn is already included in the settlement.
--This means it doesn't matter whether DO released fr warehouse or not, all must be included into settlement.
--AND BOS_SD_FDo.bAllocFrWarehouse = 0
AND BOS_SD_FDoItem.decQty > 0
AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
AND BOS_INV_Product.bService = 0
and BOS_SD_FDO.szLogisticType <> 'POS'

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDoItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_SD_FDo.szWorkplaceId,
BOS_SD_FDoItem.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductSoldByEmployee(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_FDo.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FDo.szDriverId As szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_SD_FDoItem.szProductId,
'' As szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
BOS_INV_Product.szQtyFormat As szAmountFormat,	
sum(BOS_SD_FDoItem.decQty) As decAmount1,
null As decAmount2

FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate 
And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) 
and BOS_SD_FDo.szWorkplaceId like p_szWorkplaceId 
And BOS_SD_FDo.bVoid = 0
--DO is released from warehouse using FDn, and this FDn is already included in the settlement.
--This means it doesn't matter whether DO released fr warehouse or not, all must be included into settlement.
--AND BOS_SD_FDo.bAllocFrWarehouse = 0
AND BOS_SD_FDoItem.decQty > 0
AND BOS_SD_FDo.szDriverId LIKE p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
AND BOS_INV_Product.bService = 0
and BOS_SD_FDO.szLogisticType <> 'POS'
GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDo.szDriverId,
BOS_PI_Employee.szName,
BOS_SD_FDoItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_SD_FDo.szWorkplaceId,
BOS_SD_FDo.szDriverId,
BOS_SD_FDoItem.szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductSoldByEmployee_013(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_SD_FDo.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FDo.szDriverId As szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_SD_FDoItem.szProductId,
'' As szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
BOS_INV_Product.szQtyFormat As szAmountFormat,	
sum(BOS_SD_FDoItem.decQty) As decAmount1,
null As decAmount2

FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate 
And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) 
and BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId 
And BOS_SD_FDo.bVoid = 0
--DO is released from warehouse using FDn, and this FDn is already included in the settlement.
--This means it doesn't matter whether DO released fr warehouse or not, all must be included into settlement.
--AND BOS_SD_FDo.bAllocFrWarehouse = 0
AND BOS_SD_FDoItem.decQty > 0
--AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
AND BOS_INV_Product.bService = 0
and BOS_SD_FDO.szLogisticType <> 'POS'

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDo.szDriverId,
BOS_PI_Employee.szName,
BOS_SD_FDoItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_SD_FDo.szWorkplaceId,
BOS_SD_FDo.szDriverId,
BOS_SD_FDoItem.szProductId
ELSE
SELECT
BOS_SD_FDo.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_SD_FDo.szDriverId As szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_SD_FDoItem.szProductId,
'' As szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
BOS_INV_Product.szQtyFormat As szAmountFormat,	
sum(BOS_SD_FDoItem.decQty) As decAmount1,
null As decAmount2

FROM
BOS_SD_FDo
INNER JOIN BOS_SD_FDoItem ON BOS_SD_FDoItem.szDoId = BOS_SD_FDo.szDoId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FDo.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_SD_FDo.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId

WHERE
BOS_SD_FDo.dtmDelivery >= p_dtmFirstDate 
And BOS_SD_FDo.dtmDelivery < dateadd(day, 1, p_dtmLastDate) 
and BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId 
And BOS_SD_FDo.bVoid = 0
--DO is released from warehouse using FDn, and this FDn is already included in the settlement.
--This means it doesn't matter whether DO released fr warehouse or not, all must be included into settlement.
--AND BOS_SD_FDo.bAllocFrWarehouse = 0
AND BOS_SD_FDoItem.decQty > 0
AND BOS_SD_FDo.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl
AND BOS_INV_Product.bService = 0
and BOS_SD_FDO.szLogisticType <> 'POS'

GROUP BY
BOS_SD_FDo.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_SD_FDo.szDriverId,
BOS_PI_Employee.szName,
BOS_SD_FDoItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_SD_FDo.szWorkplaceId,
BOS_SD_FDo.szDriverId,
BOS_SD_FDoItem.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductTakenAll(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
Select
BOS_INV_StockHistory.szReportedAsId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' As szEmployeeId,
'' As szEmployeeNm,
BOS_INV_StockHistory.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
null as decAmount1,
sum(BOS_INV_StockHistory.decQty) As decAmount2
From
BOS_INV_StockHistory
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_StockHistory.szReportedAsId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockHistory.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId
Where
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate And BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_StockHistory.szReportedAsId = p_szWorkplaceId And
(
BOS_INV_StockHistory.szLocationType = 'VEH' 
or BOS_INV_StockHistory.szLocationType = 'CAR'
or BOS_INV_StockHistory.szLocationType = 'EMP'
)
And BOS_INV_StockHistory.szStockTransferReason = 'DIS'
--AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_StockHistory.szReportedAsId,
BOS_GL_Workplace.szName,
BOS_INV_StockHistory.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szProductId
ELSE
Select
BOS_INV_StockHistory.szReportedAsId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' As szEmployeeId,
'' As szEmployeeNm,
BOS_INV_StockHistory.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
null as decAmount1,
sum(BOS_INV_StockHistory.decQty) As decAmount2
From
BOS_INV_StockHistory
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_StockHistory.szReportedAsId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockHistory.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId
Where
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate And BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_StockHistory.szReportedAsId = p_szWorkplaceId And
(
BOS_INV_StockHistory.szLocationType = 'VEH' 
or BOS_INV_StockHistory.szLocationType = 'CAR'
or BOS_INV_StockHistory.szLocationType = 'EMP'
)
And BOS_INV_StockHistory.szStockTransferReason = 'DIS'
AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_StockHistory.szReportedAsId,
BOS_GL_Workplace.szName,
BOS_INV_StockHistory.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductTakenAll_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
Select
BOS_INV_StockHistory.szReportedAsId As szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' As szEmployeeId,
'' As szEmployeeNm,
BOS_INV_StockHistory.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
null as decAmount1,
sum(BOS_INV_StockHistory.decQty) As decAmount2
From
BOS_INV_StockHistory
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_StockHistory.szReportedAsId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockHistory.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId
Where
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate And BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_StockHistory.szReportedAsId = p_szWorkplaceId And
(
BOS_INV_StockHistory.szLocationType = 'VEH' 
or BOS_INV_StockHistory.szLocationType = 'CAR'
or BOS_INV_StockHistory.szLocationType = 'EMP'
)
And BOS_INV_StockHistory.szStockTransferReason = 'DIS'
--AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_StockHistory.szReportedAsId,
BOS_GL_Workplace.szName,
BOS_INV_StockHistory.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szProductId
ELSE
Select
BOS_INV_StockHistory.szReportedAsId As szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' As szEmployeeId,
'' As szEmployeeNm,
BOS_INV_StockHistory.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
null as decAmount1,
sum(BOS_INV_StockHistory.decQty) As decAmount2
From
BOS_INV_StockHistory
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_StockHistory.szReportedAsId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockHistory.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId
Where
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate And BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_StockHistory.szReportedAsId = p_szWorkplaceId And
(
BOS_INV_StockHistory.szLocationType = 'VEH' 
or BOS_INV_StockHistory.szLocationType = 'CAR'
or BOS_INV_StockHistory.szLocationType = 'EMP'
)
And BOS_INV_StockHistory.szStockTransferReason = 'DIS'
AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_StockHistory.szReportedAsId,
BOS_GL_Workplace.szName,
BOS_INV_StockHistory.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szProductId


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductTakenAllByFDn(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
Select
BOS_INV_FDn.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' As szEmployeeId,
'' As szEmployeeNm,
BOS_INV_FDnItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
null as decAmount1,
sum(BOS_INV_FDnItem.decQty) As decAmount2
From
BOS_INV_FDn
INNER JOIN BOS_INV_FDnItem ON BOS_INV_FDnItem.szFDnId = BOS_INV_FDn.szFDnId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FDn.szWorkplaceId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FDnItem.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FDn.szDriverId
Where
BOS_INV_FDn.dtmDelivery >= p_dtmFirstDate And BOS_INV_FDn.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_FDn.szWorkplaceId = p_szWorkplaceId 
--And BOS_INV_FDn.szDriverId = p_szOpUserId 
AND BOS_INV_FDn.szFDoId <> '' 
AND BOS_INV_FDn.bApplied = 1		--Yes, for inventory documents, get only applied documents.
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_FDn.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_INV_FDnItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_FDn.szWorkplaceId,
BOS_INV_FDnItem.szProductId
ELSE
Select
BOS_INV_FDn.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' As szEmployeeId,
'' As szEmployeeNm,
BOS_INV_FDnItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
null as decAmount1,
sum(BOS_INV_FDnItem.decQty) As decAmount2
From
BOS_INV_FDn
INNER JOIN BOS_INV_FDnItem ON BOS_INV_FDnItem.szFDnId = BOS_INV_FDn.szFDnId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FDn.szWorkplaceId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FDnItem.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FDn.szDriverId
Where
BOS_INV_FDn.dtmDelivery >= p_dtmFirstDate And BOS_INV_FDn.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_FDn.szWorkplaceId = p_szWorkplaceId 
And BOS_INV_FDn.szDriverId = p_szOpUserId 
AND BOS_INV_FDn.szFDoId <> '' 
AND BOS_INV_FDn.bApplied = 1		--Yes, for inventory documents, get only applied documents.
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_FDn.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_INV_FDnItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_FDn.szWorkplaceId,
BOS_INV_FDnItem.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductTakenAllByFDn_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
Select
BOS_INV_FDn.szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' As szEmployeeId,
'' As szEmployeeNm,
BOS_INV_FDnItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
null as decAmount1,
sum(BOS_INV_FDnItem.decQty) As decAmount2
From
BOS_INV_FDn
INNER JOIN BOS_INV_FDnItem ON BOS_INV_FDnItem.szFDnId = BOS_INV_FDn.szFDnId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FDn.szWorkplaceId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FDnItem.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FDn.szDriverId
Where
BOS_INV_FDn.dtmDelivery >= p_dtmFirstDate And BOS_INV_FDn.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_FDn.szWorkplaceId = p_szWorkplaceId 
--And BOS_INV_FDn.szDriverId = p_szOpUserId 
AND BOS_INV_FDn.szFDoId <> '' 
AND BOS_INV_FDn.bApplied = 1        --Yes, for inventory documents, get only applied documents.
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_FDn.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_INV_FDnItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_FDn.szWorkplaceId,
BOS_INV_FDnItem.szProductId
ELSE
Select
BOS_INV_FDn.szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' As szEmployeeId,
'' As szEmployeeNm,
BOS_INV_FDnItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
null as decAmount1,
sum(BOS_INV_FDnItem.decQty) As decAmount2
From
BOS_INV_FDn
INNER JOIN BOS_INV_FDnItem ON BOS_INV_FDnItem.szFDnId = BOS_INV_FDn.szFDnId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FDn.szWorkplaceId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FDnItem.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FDn.szDriverId
Where
BOS_INV_FDn.dtmDelivery >= p_dtmFirstDate And BOS_INV_FDn.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_FDn.szWorkplaceId = p_szWorkplaceId 
And BOS_INV_FDn.szDriverId = p_szOpUserId 
AND BOS_INV_FDn.szFDoId <> '' 
AND BOS_INV_FDn.bApplied = 1        --Yes, for inventory documents, get only applied documents.
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_FDn.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_INV_FDnItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_FDn.szWorkplaceId,
BOS_INV_FDnItem.szProductId


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductTakenByEmployee(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
Select
BOS_INV_StockHistory.szReportedAsId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_StockHistory.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
null as decAmount1,
sum(BOS_INV_StockHistory.decQty) As decAmount2

From
BOS_INV_StockHistory
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_StockHistory.szReportedAsId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockHistory.szProductId

Where
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate 
And BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) 
And BOS_INV_StockHistory.szReportedAsId = p_szWorkplaceId 
And 
(
BOS_INV_StockHistory.szLocationType = 'VEH'  
or BOS_INV_StockHistory.szLocationType = 'CAR'
or BOS_INV_StockHistory.szLocationType = 'EMP'
) 
And BOS_INV_StockHistory.szStockTransferReason = 'DIS' 
--AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_StockHistory.szReportedAsId,
BOS_GL_Workplace.szName,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName,
BOS_INV_StockHistory.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szEmployeeId,
BOS_INV_StockHistory.szProductId
ELSE
Select
BOS_INV_StockHistory.szReportedAsId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_StockHistory.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
null as decAmount1,
sum(BOS_INV_StockHistory.decQty) As decAmount2

From
BOS_INV_StockHistory
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_StockHistory.szReportedAsId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockHistory.szProductId

Where
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate 
And BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) 
And BOS_INV_StockHistory.szReportedAsId = p_szWorkplaceId 
And 
(
BOS_INV_StockHistory.szLocationType = 'VEH'  
or BOS_INV_StockHistory.szLocationType = 'CAR'
or BOS_INV_StockHistory.szLocationType = 'EMP'
) 
And BOS_INV_StockHistory.szStockTransferReason = 'DIS' 
AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_StockHistory.szReportedAsId,
BOS_GL_Workplace.szName,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName,
BOS_INV_StockHistory.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szEmployeeId,
BOS_INV_StockHistory.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductTakenByEmployee_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
Select
BOS_INV_StockHistory.szReportedAsId As szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_StockHistory.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
null as decAmount1,
sum(BOS_INV_StockHistory.decQty) As decAmount2

From
BOS_INV_StockHistory
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_StockHistory.szReportedAsId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockHistory.szProductId

Where
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate 
And BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) 
And BOS_INV_StockHistory.szReportedAsId = p_szWorkplaceId 
And 
(
BOS_INV_StockHistory.szLocationType = 'VEH'  
or BOS_INV_StockHistory.szLocationType = 'CAR'
or BOS_INV_StockHistory.szLocationType = 'EMP'
) 
And BOS_INV_StockHistory.szStockTransferReason = 'DIS' 
--AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_StockHistory.szReportedAsId,
BOS_GL_Workplace.szName,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName,
BOS_INV_StockHistory.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szEmployeeId,
BOS_INV_StockHistory.szProductId
ELSE
Select
BOS_INV_StockHistory.szReportedAsId As szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_StockHistory.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
null as decAmount1,
sum(BOS_INV_StockHistory.decQty) As decAmount2

From
BOS_INV_StockHistory
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_StockHistory.szReportedAsId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockHistory.szProductId

Where
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate 
And BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) 
And BOS_INV_StockHistory.szReportedAsId = p_szWorkplaceId 
And 
(
BOS_INV_StockHistory.szLocationType = 'VEH'  
or BOS_INV_StockHistory.szLocationType = 'CAR'
or BOS_INV_StockHistory.szLocationType = 'EMP'
) 
And BOS_INV_StockHistory.szStockTransferReason = 'DIS' 
AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_StockHistory.szReportedAsId,
BOS_GL_Workplace.szName,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName,
BOS_INV_StockHistory.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szEmployeeId,
BOS_INV_StockHistory.szProductId


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductTakenByEmployeeFDn(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
Select
BOS_INV_FDn.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_FDn.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_FDnItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
null as decAmount1,
sum(BOS_INV_FDnItem.decQty) As decAmount2

From
BOS_INV_FDn
INNER JOIN BOS_INV_FDnItem ON BOS_INV_FDnItem.szFDnId = BOS_INV_FDn.szFDnId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FDn.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FDn.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FDnItem.szProductId

Where
BOS_INV_FDn.dtmDelivery >= p_dtmFirstDate And BOS_INV_FDn.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_FDn.szWorkplaceId = p_szWorkplaceId 
--And BOS_INV_FDn.szDriverId = p_szOpUserId 
AND BOS_INV_FDn.szFDoId <> '' 
AND BOS_INV_FDn.bApplied = 1		--Yes, for inventory documents, get only applied documents.
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_FDn.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_INV_FDn.szDriverId,
BOS_PI_Employee.szName,
BOS_INV_FDnItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_FDn.szWorkplaceId,
BOS_INV_FDn.szDriverId,
BOS_INV_FDnItem.szProductId
ELSE
Select
BOS_INV_FDn.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_FDn.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_FDnItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
null as decAmount1,
sum(BOS_INV_FDnItem.decQty) As decAmount2

From
BOS_INV_FDn
INNER JOIN BOS_INV_FDnItem ON BOS_INV_FDnItem.szFDnId = BOS_INV_FDn.szFDnId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FDn.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FDn.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FDnItem.szProductId

Where
BOS_INV_FDn.dtmDelivery >= p_dtmFirstDate And BOS_INV_FDn.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_FDn.szWorkplaceId = p_szWorkplaceId 
And BOS_INV_FDn.szDriverId = p_szOpUserId 
AND BOS_INV_FDn.szFDoId <> '' 
AND BOS_INV_FDn.bApplied = 1		--Yes, for inventory documents, get only applied documents.
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_FDn.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_INV_FDn.szDriverId,
BOS_PI_Employee.szName,
BOS_INV_FDnItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_FDn.szWorkplaceId,
BOS_INV_FDn.szDriverId,
BOS_INV_FDnItem.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductTakenByEmployeeFDn_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
Select
BOS_INV_FDn.szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_FDn.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_FDnItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
null as decAmount1,
sum(BOS_INV_FDnItem.decQty) As decAmount2

From
BOS_INV_FDn
INNER JOIN BOS_INV_FDnItem ON BOS_INV_FDnItem.szFDnId = BOS_INV_FDn.szFDnId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FDn.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FDn.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FDnItem.szProductId

Where
BOS_INV_FDn.dtmDelivery >= p_dtmFirstDate And BOS_INV_FDn.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_FDn.szWorkplaceId = p_szWorkplaceId 
--And BOS_INV_FDn.szDriverId = p_szOpUserId 
AND BOS_INV_FDn.szFDoId <> '' 
AND BOS_INV_FDn.bApplied = 1        --Yes, for inventory documents, get only applied documents.
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_FDn.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_INV_FDn.szDriverId,
BOS_PI_Employee.szName,
BOS_INV_FDnItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_FDn.szWorkplaceId,
BOS_INV_FDn.szDriverId,
BOS_INV_FDnItem.szProductId
ELSE
Select
BOS_INV_FDn.szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_FDn.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_FDnItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
null as decAmount1,
sum(BOS_INV_FDnItem.decQty) As decAmount2

From
BOS_INV_FDn
INNER JOIN BOS_INV_FDnItem ON BOS_INV_FDnItem.szFDnId = BOS_INV_FDn.szFDnId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FDn.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FDn.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FDnItem.szProductId

Where
BOS_INV_FDn.dtmDelivery >= p_dtmFirstDate And BOS_INV_FDn.dtmDelivery < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_FDn.szWorkplaceId = p_szWorkplaceId 
And BOS_INV_FDn.szDriverId = p_szOpUserId 
AND BOS_INV_FDn.szFDoId <> '' 
AND BOS_INV_FDn.bApplied = 1        --Yes, for inventory documents, get only applied documents.
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_FDn.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_INV_FDn.szDriverId,
BOS_PI_Employee.szName,
BOS_INV_FDnItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_FDn.szWorkplaceId,
BOS_INV_FDn.szDriverId,
BOS_INV_FDnItem.szProductId


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductTransfer(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_INV_StockHistory.szReportedAsId As szWorkplaceId,
BOS_INV_StockHistory.szPartyId As szPartyWpId,
Wp1.szName As szWp1Nm,
Wp2.szName As szWp2Nm,

BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName AS szEmployeeNm,

BOS_INV_StockHistory.szProductId,
'' as szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
sum(BOS_INV_StockHistory.decQty) As decAmount1,
null As decAmount2

FROM
BOS_INV_StockHistory
LEFT JOIN BOS_GL_Workplace As Wp1 ON Wp1.szWorkplaceId = BOS_INV_StockHistory.szReportedAsId
LEFT JOIN BOS_GL_Workplace As Wp2 ON Wp2.szWorkplaceId = BOS_INV_StockHistory.szPartyId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockHistory.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId

WHERE
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate And 
BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_StockHistory.szReportedAsId = p_szWorkplaceId And
(
BOS_INV_StockHistory.szStockTransferReason = 'ICT' or
BOS_INV_StockHistory.szStockTransferReason = 'STR' 
)
--AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szPartyId,
Wp1.szName,
Wp2.szName,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName,
BOS_INV_StockHistory.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szPartyId,
BOS_INV_StockHistory.szProductId
ELSE
SELECT
BOS_INV_StockHistory.szReportedAsId As szWorkplaceId,
BOS_INV_StockHistory.szPartyId As szPartyWpId,
Wp1.szName As szWp1Nm,
Wp2.szName As szWp2Nm,

BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName AS szEmployeeNm,

BOS_INV_StockHistory.szProductId,
'' as szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
sum(BOS_INV_StockHistory.decQty) As decAmount1,
null As decAmount2

FROM
BOS_INV_StockHistory
LEFT JOIN BOS_GL_Workplace As Wp1 ON Wp1.szWorkplaceId = BOS_INV_StockHistory.szReportedAsId
LEFT JOIN BOS_GL_Workplace As Wp2 ON Wp2.szWorkplaceId = BOS_INV_StockHistory.szPartyId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockHistory.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId

WHERE
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate And 
BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_StockHistory.szReportedAsId = p_szWorkplaceId And
(
BOS_INV_StockHistory.szStockTransferReason = 'ICT' or
BOS_INV_StockHistory.szStockTransferReason = 'STR' 
)
AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szPartyId,
Wp1.szName,
Wp2.szName,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName,
BOS_INV_StockHistory.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szPartyId,
BOS_INV_StockHistory.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductTransfer_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_INV_StockHistory.szReportedAsId As szWorkplaceId,
BOS_INV_StockHistory.szPartyId As szPartyWpId,
Wp1.szName As szWp1Nm,
Wp2.szName As szWp2Nm,

BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName AS szEmployeeNm,

BOS_INV_StockHistory.szProductId,
'' as szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
sum(BOS_INV_StockHistory.decQty) As decAmount1,
null As decAmount2

FROM
BOS_INV_StockHistory
LEFT JOIN BOS_GL_Workplace As Wp1 ON Wp1.szWorkplaceId = BOS_INV_StockHistory.szReportedAsId
LEFT JOIN BOS_GL_Workplace As Wp2 ON Wp2.szWorkplaceId = BOS_INV_StockHistory.szPartyId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockHistory.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId

WHERE
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate And 
BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_StockHistory.szReportedAsId = p_szWorkplaceId And
(
BOS_INV_StockHistory.szStockTransferReason = 'ICT' or
BOS_INV_StockHistory.szStockTransferReason = 'STR' 
)
--AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szPartyId,
Wp1.szName,
Wp2.szName,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName,
BOS_INV_StockHistory.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szPartyId,
BOS_INV_StockHistory.szProductId
ELSE
SELECT
BOS_INV_StockHistory.szReportedAsId As szWorkplaceId,
BOS_INV_StockHistory.szPartyId As szPartyWpId,
Wp1.szName As szWp1Nm,
Wp2.szName As szWp2Nm,

BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName AS szEmployeeNm,

BOS_INV_StockHistory.szProductId,
'' as szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
sum(BOS_INV_StockHistory.decQty) As decAmount1,
null As decAmount2

FROM
BOS_INV_StockHistory
LEFT JOIN BOS_GL_Workplace As Wp1 ON Wp1.szWorkplaceId = BOS_INV_StockHistory.szReportedAsId
LEFT JOIN BOS_GL_Workplace As Wp2 ON Wp2.szWorkplaceId = BOS_INV_StockHistory.szPartyId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockHistory.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId

WHERE
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate And 
BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_StockHistory.szReportedAsId = p_szWorkplaceId And
(
BOS_INV_StockHistory.szStockTransferReason = 'ICT' or
BOS_INV_StockHistory.szStockTransferReason = 'STR' 
)
AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szPartyId,
Wp1.szName,
Wp2.szName,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName,
BOS_INV_StockHistory.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szPartyId,
BOS_INV_StockHistory.szProductId


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductTransferParty(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_INV_StockHistory.szPartyId As szWorkplaceId,		--Workplace id and party id of party transfer must be swapped so p_MergeList function can function correctly.
BOS_INV_StockHistory.szReportedAsId As szPartyWpId,
Wp1.szName As szWp1Nm,
Wp2.szName As szWp2Nm,

BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName AS szEmployeeNm,

BOS_INV_StockHistory.szProductId,
'' as szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szCcySymbol,
'' As szAmountFormat,	
null As decAmount1,
sum(-BOS_INV_StockHistory.decQty) As decAmount2

FROM
BOS_INV_StockHistory
LEFT JOIN BOS_GL_Workplace As Wp1 ON Wp1.szWorkplaceId = BOS_INV_StockHistory.szPartyId
LEFT JOIN BOS_GL_Workplace As Wp2 ON Wp2.szWorkplaceId = BOS_INV_StockHistory.szReportedAsId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockHistory.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId

WHERE
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate And 
BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_StockHistory.szPartyId = p_szWorkplaceId And
(
BOS_INV_StockHistory.szStockTransferReason = 'ICT' or
BOS_INV_StockHistory.szStockTransferReason = 'STR' 
)
--AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szPartyId,
Wp1.szName,
Wp2.szName,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName,
BOS_INV_StockHistory.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szPartyId,
BOS_INV_StockHistory.szProductId
ELSE
SELECT
BOS_INV_StockHistory.szPartyId As szWorkplaceId,		--Workplace id and party id of party transfer must be swapped so p_MergeList function can function correctly.
BOS_INV_StockHistory.szReportedAsId As szPartyWpId,
Wp1.szName As szWp1Nm,
Wp2.szName As szWp2Nm,

BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName AS szEmployeeNm,

BOS_INV_StockHistory.szProductId,
'' as szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szCcySymbol,
'' As szAmountFormat,	
null As decAmount1,
sum(-BOS_INV_StockHistory.decQty) As decAmount2

FROM
BOS_INV_StockHistory
LEFT JOIN BOS_GL_Workplace As Wp1 ON Wp1.szWorkplaceId = BOS_INV_StockHistory.szPartyId
LEFT JOIN BOS_GL_Workplace As Wp2 ON Wp2.szWorkplaceId = BOS_INV_StockHistory.szReportedAsId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockHistory.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId

WHERE
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate And 
BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_StockHistory.szPartyId = p_szWorkplaceId And
(
BOS_INV_StockHistory.szStockTransferReason = 'ICT' or
BOS_INV_StockHistory.szStockTransferReason = 'STR' 
)
AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szPartyId,
Wp1.szName,
Wp2.szName,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName,
BOS_INV_StockHistory.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szPartyId,
BOS_INV_StockHistory.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfProductTransferParty_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
BOS_INV_StockHistory.szPartyId As szWorkplaceId,        --Workplace id and party id of party transfer must be swapped so p_MergeList function can function correctly.
BOS_INV_StockHistory.szReportedAsId As szPartyWpId,
Wp1.szName As szWp1Nm,
Wp2.szName As szWp2Nm,

BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName AS szEmployeeNm,

BOS_INV_StockHistory.szProductId,
'' as szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szCcySymbol,
'' As szAmountFormat,    
null As decAmount1,
sum(-BOS_INV_StockHistory.decQty) As decAmount2

FROM
BOS_INV_StockHistory
LEFT JOIN BOS_GL_Workplace As Wp1 ON Wp1.szWorkplaceId = BOS_INV_StockHistory.szPartyId
LEFT JOIN BOS_GL_Workplace As Wp2 ON Wp2.szWorkplaceId = BOS_INV_StockHistory.szReportedAsId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockHistory.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId

WHERE
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate And 
BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_StockHistory.szPartyId = p_szWorkplaceId And
(
BOS_INV_StockHistory.szStockTransferReason = 'ICT' or
BOS_INV_StockHistory.szStockTransferReason = 'STR' 
)
--AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szPartyId,
Wp1.szName,
Wp2.szName,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName,
BOS_INV_StockHistory.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szPartyId,
BOS_INV_StockHistory.szProductId
ELSE
SELECT
BOS_INV_StockHistory.szPartyId As szWorkplaceId,        --Workplace id and party id of party transfer must be swapped so p_MergeList function can function correctly.
BOS_INV_StockHistory.szReportedAsId As szPartyWpId,
Wp1.szName As szWp1Nm,
Wp2.szName As szWp2Nm,

BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName AS szEmployeeNm,

BOS_INV_StockHistory.szProductId,
'' as szProductSN,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szCcySymbol,
'' As szAmountFormat,    
null As decAmount1,
sum(-BOS_INV_StockHistory.decQty) As decAmount2

FROM
BOS_INV_StockHistory
LEFT JOIN BOS_GL_Workplace As Wp1 ON Wp1.szWorkplaceId = BOS_INV_StockHistory.szPartyId
LEFT JOIN BOS_GL_Workplace As Wp2 ON Wp2.szWorkplaceId = BOS_INV_StockHistory.szReportedAsId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_StockHistory.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_StockHistory.szEmployeeId

WHERE
BOS_INV_StockHistory.dtmTransaction >= p_dtmFirstDate And 
BOS_INV_StockHistory.dtmTransaction < dateadd(day, 1, p_dtmLastDate) And
BOS_INV_StockHistory.szPartyId = p_szWorkplaceId And
(
BOS_INV_StockHistory.szStockTransferReason = 'ICT' or
BOS_INV_StockHistory.szStockTransferReason = 'STR' 
)
AND BOS_INV_StockHistory.szEmployeeId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

GROUP BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szPartyId,
Wp1.szName,
Wp2.szName,
BOS_INV_StockHistory.szEmployeeId,
BOS_PI_Employee.szName,
BOS_INV_StockHistory.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_StockHistory.szReportedAsId,
BOS_INV_StockHistory.szPartyId,
BOS_INV_StockHistory.szProductId


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfStockReturnedAll(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT 
FSid.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' As szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
FSidItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,	
'' As szCcyId,
'' As szAmountFormat,	
null as decAmount1,
-sum(FSidItem.decUomQty) As decAmount2
FROM 
BOS_INV_FSid AS FSid
LEFT JOIN BOS_INV_FSidItem AS FSidItem on FSidItem.szFSidId = FSid.szFSidId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = FSid.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = FSid.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = FSidItem.szProductId

Where
FSid.dtmIn >= p_dtmFirstDate 
And FSid.dtmIn < dateadd(day, 1, p_dtmLastDate) 
And FSid.szWorkplaceId = p_szWorkplaceId 	
--AND FSid.szDriverId = p_szOpUserId
AND FSid.bApplied = 0
AND FSid.bVoid = 0
AND FSid.btPrintedCount > 0
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
FSid.szWorkplaceId,
BOS_GL_Workplace.szName,
FSid.szDriverId,
BOS_PI_Employee.szName,
FSidItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
FSid.szWorkplaceId,
FSid.szDriverId,
FSidItem.szProductId
ELSE
SELECT 
FSid.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' As szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
FSidItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,	
'' As szCcyId,
'' As szAmountFormat,	
null as decAmount1,
-sum(FSidItem.decUomQty) As decAmount2
FROM 
BOS_INV_FSid AS FSid
LEFT JOIN BOS_INV_FSidItem AS FSidItem on FSidItem.szFSidId = FSid.szFSidId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = FSid.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = FSid.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = FSidItem.szProductId

Where
FSid.dtmIn >= p_dtmFirstDate 
And FSid.dtmIn < dateadd(day, 1, p_dtmLastDate) 
And FSid.szWorkplaceId = p_szWorkplaceId 	
AND FSid.szDriverId = p_szOpUserId
AND FSid.bApplied = 0
AND FSid.bVoid = 0
AND FSid.btPrintedCount > 0
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
FSid.szWorkplaceId,
BOS_GL_Workplace.szName,
FSid.szDriverId,
BOS_PI_Employee.szName,
FSidItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
FSid.szWorkplaceId,
FSid.szDriverId,
FSidItem.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfStockReturnedByEmployee(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT 
FSid.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
FSid.szDriverId As szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
FSidItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,	
'' As szCcyId,
'' As szAmountFormat,	
null as decAmount1,
-sum(FSidItem.decUomQty) As decAmount2
FROM 
BOS_INV_FSid AS FSid
LEFT JOIN BOS_INV_FSidItem AS FSidItem on FSidItem.szFSidId = FSid.szFSidId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = FSid.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = FSid.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = FSidItem.szProductId

Where
FSid.dtmIn >= p_dtmFirstDate 
And FSid.dtmIn < dateadd(day, 1, p_dtmLastDate) 
And FSid.szWorkplaceId = p_szWorkplaceId 	
--AND FSid.szDriverId = p_szOpUserId
AND FSid.bApplied = 0
AND FSid.bVoid = 0
AND FSid.btPrintedCount > 0
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
FSid.szWorkplaceId,
BOS_GL_Workplace.szName,
FSid.szDriverId,
BOS_PI_Employee.szName,
FSidItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
FSid.szWorkplaceId,
FSid.szDriverId,
FSidItem.szProductId
ELSE
SELECT 
FSid.szWorkplaceId As szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
FSid.szDriverId As szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
FSidItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,	
'' As szCcyId,
'' As szAmountFormat,	
null as decAmount1,
-sum(FSidItem.decUomQty) As decAmount2
FROM 
BOS_INV_FSid AS FSid
LEFT JOIN BOS_INV_FSidItem AS FSidItem on FSidItem.szFSidId = FSid.szFSidId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = FSid.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = FSid.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = FSidItem.szProductId

Where
FSid.dtmIn >= p_dtmFirstDate 
And FSid.dtmIn < dateadd(day, 1, p_dtmLastDate) 
And FSid.szWorkplaceId = p_szWorkplaceId 	
AND FSid.szDriverId = p_szOpUserId
AND FSid.bApplied = 0
AND FSid.bVoid = 0
AND FSid.btPrintedCount > 0
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
FSid.szWorkplaceId,
BOS_GL_Workplace.szName,
FSid.szDriverId,
BOS_PI_Employee.szName,
FSidItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
FSid.szWorkplaceId,
FSid.szDriverId,
FSidItem.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfVehicleRemainingQtyALL(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
Select
BOS_INV_FVRema.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
BOS_INV_FVRemaItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
null AS decAmount1,
null AS decAmount2,
sum(BOS_INV_FVRemaItem.decQty) AS decVehicleQty

From
BOS_INV_FVRema
INNER JOIN BOS_INV_FVRemaItem ON BOS_INV_FVRemaItem.szFVRemaId = BOS_INV_FVRema.szFVRemaId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FVRema.szWorkplaceId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FVRemaItem.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FVRema.szDriverId

Where
BOS_INV_FVRema.dtmRemain >= p_dtmFirstDate 
And BOS_INV_FVRema.dtmRemain < dateadd(day, 1, p_dtmLastDate) 
AND BOS_INV_FVRema.bApplied = 1
And BOS_INV_FVRema.szWorkplaceId = p_szWorkplaceId 
--AND BOS_INV_FVRema.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_FVRema.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_INV_FVRemaItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_FVRema.szWorkplaceId,
BOS_INV_FVRemaItem.szProductId
ELSE
Select
BOS_INV_FVRema.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
BOS_INV_FVRemaItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
null AS decAmount1,
null AS decAmount2,
sum(BOS_INV_FVRemaItem.decQty) AS decVehicleQty

From
BOS_INV_FVRema
INNER JOIN BOS_INV_FVRemaItem ON BOS_INV_FVRemaItem.szFVRemaId = BOS_INV_FVRema.szFVRemaId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FVRema.szWorkplaceId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FVRemaItem.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FVRema.szDriverId

Where
BOS_INV_FVRema.dtmRemain >= p_dtmFirstDate 
And BOS_INV_FVRema.dtmRemain < dateadd(day, 1, p_dtmLastDate) 
AND BOS_INV_FVRema.bApplied = 1
And BOS_INV_FVRema.szWorkplaceId = p_szWorkplaceId 
AND BOS_INV_FVRema.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_FVRema.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_INV_FVRemaItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_FVRema.szWorkplaceId,
BOS_INV_FVRemaItem.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfVehicleRemainingQtyALL_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
Select
BOS_INV_FVRema.szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
BOS_INV_FVRemaItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
null AS decAmount1,
null AS decAmount2,
sum(BOS_INV_FVRemaItem.decQty) AS decVehicleQty

From
BOS_INV_FVRema
INNER JOIN BOS_INV_FVRemaItem ON BOS_INV_FVRemaItem.szFVRemaId = BOS_INV_FVRema.szFVRemaId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FVRema.szWorkplaceId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FVRemaItem.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FVRema.szDriverId

Where
BOS_INV_FVRema.dtmRemain >= p_dtmFirstDate 
And BOS_INV_FVRema.dtmRemain < dateadd(day, 1, p_dtmLastDate) 
AND BOS_INV_FVRema.bApplied = 1
And BOS_INV_FVRema.szWorkplaceId = p_szWorkplaceId 
--AND BOS_INV_FVRema.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_FVRema.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_INV_FVRemaItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_FVRema.szWorkplaceId,
BOS_INV_FVRemaItem.szProductId
ELSE
Select
BOS_INV_FVRema.szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
'ALL' AS szEmployeeId,
'' As szEmployeeNm,
BOS_INV_FVRemaItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
null AS decAmount1,
null AS decAmount2,
sum(BOS_INV_FVRemaItem.decQty) AS decVehicleQty

From
BOS_INV_FVRema
INNER JOIN BOS_INV_FVRemaItem ON BOS_INV_FVRemaItem.szFVRemaId = BOS_INV_FVRema.szFVRemaId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FVRema.szWorkplaceId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FVRemaItem.szProductId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FVRema.szDriverId

Where
BOS_INV_FVRema.dtmRemain >= p_dtmFirstDate 
And BOS_INV_FVRema.dtmRemain < dateadd(day, 1, p_dtmLastDate) 
AND BOS_INV_FVRema.bApplied = 1
And BOS_INV_FVRema.szWorkplaceId = p_szWorkplaceId 
AND BOS_INV_FVRema.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_FVRema.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_INV_FVRemaItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_FVRema.szWorkplaceId,
BOS_INV_FVRemaItem.szProductId


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfVehicleRemainingQtyByEmployee(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
Select
BOS_INV_FVRema.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_FVRema.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_FVRemaItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
null AS decAmount1,
null AS decAmount2,
sum(BOS_INV_FVRemaItem.decQty) AS decVehicleQty

From
BOS_INV_FVRema
INNER JOIN BOS_INV_FVRemaItem ON BOS_INV_FVRemaItem.szFVRemaId = BOS_INV_FVRema.szFVRemaId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FVRema.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FVRema.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FVRemaItem.szProductId

Where
BOS_INV_FVRema.dtmRemain >= p_dtmFirstDate 
And BOS_INV_FVRema.dtmRemain < dateadd(day, 1, p_dtmLastDate) 
AND BOS_INV_FVRema.bApplied = 1
And BOS_INV_FVRema.szWorkplaceId = p_szWorkplaceId 
--AND BOS_INV_FVRema.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_FVRema.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_INV_FVRema.szDriverId,
BOS_PI_Employee.szName,
BOS_INV_FVRemaItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_FVRema.szWorkplaceId,
BOS_INV_FVRema.szDriverId,
BOS_INV_FVRemaItem.szProductId
ELSE
Select
BOS_INV_FVRema.szWorkplaceId,
'' As szPartyWpId,				--Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_FVRema.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_FVRemaItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,	
null AS decAmount1,
null AS decAmount2,
sum(BOS_INV_FVRemaItem.decQty) AS decVehicleQty

From
BOS_INV_FVRema
INNER JOIN BOS_INV_FVRemaItem ON BOS_INV_FVRemaItem.szFVRemaId = BOS_INV_FVRema.szFVRemaId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FVRema.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FVRema.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FVRemaItem.szProductId

Where
BOS_INV_FVRema.dtmRemain >= p_dtmFirstDate 
And BOS_INV_FVRema.dtmRemain < dateadd(day, 1, p_dtmLastDate) 
AND BOS_INV_FVRema.bApplied = 1
And BOS_INV_FVRema.szWorkplaceId = p_szWorkplaceId 
AND BOS_INV_FVRema.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_FVRema.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_INV_FVRema.szDriverId,
BOS_PI_Employee.szName,
BOS_INV_FVRemaItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_FVRema.szWorkplaceId,
BOS_INV_FVRema.szDriverId,
BOS_INV_FVRemaItem.szProductId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_GetListOfVehicleRemainingQtyByEmployee_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFirstDate timestamp,
p_dtmLastDate timestamp,
p_szOpUserId BOS_DT_szId,
p_bLowIncl BOS_DT_bBoolean,
p_bTopIncl BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
Select
BOS_INV_FVRema.szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_FVRema.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_FVRemaItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
null AS decAmount1,
null AS decAmount2,
sum(BOS_INV_FVRemaItem.decQty) AS decVehicleQty

From
BOS_INV_FVRema
INNER JOIN BOS_INV_FVRemaItem ON BOS_INV_FVRemaItem.szFVRemaId = BOS_INV_FVRema.szFVRemaId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FVRema.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FVRema.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FVRemaItem.szProductId

Where
BOS_INV_FVRema.dtmRemain >= p_dtmFirstDate 
And BOS_INV_FVRema.dtmRemain < dateadd(day, 1, p_dtmLastDate) 
AND BOS_INV_FVRema.bApplied = 1
And BOS_INV_FVRema.szWorkplaceId = p_szWorkplaceId 
--AND BOS_INV_FVRema.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_FVRema.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_INV_FVRema.szDriverId,
BOS_PI_Employee.szName,
BOS_INV_FVRemaItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_FVRema.szWorkplaceId,
BOS_INV_FVRema.szDriverId,
BOS_INV_FVRemaItem.szProductId
ELSE
Select
BOS_INV_FVRema.szWorkplaceId,
'' As szPartyWpId,                --Only transfer between workplace that has entry for this field.
BOS_GL_Workplace.szName As szWp1Nm,
'' As szWp2Nm,
BOS_INV_FVRema.szDriverId AS szEmployeeId,
BOS_PI_Employee.szName As szEmployeeNm,
BOS_INV_FVRemaItem.szProductId,
'' as szProductSn,
BOS_INV_Product.szName As szProductNm,
BOS_INV_Product.szQtyFormat As szProductQtyFormat,
BOS_INV_Product.szCompUomId As szProductCompUomId_J,
BOS_INV_Product.szUomClassId As szProductUomClassId_J,
BOS_INV_Product.szUomId,
'' As szCcyId,
'' As szAmountFormat,    
null AS decAmount1,
null AS decAmount2,
sum(BOS_INV_FVRemaItem.decQty) AS decVehicleQty

From
BOS_INV_FVRema
INNER JOIN BOS_INV_FVRemaItem ON BOS_INV_FVRemaItem.szFVRemaId = BOS_INV_FVRema.szFVRemaId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_INV_FVRema.szWorkplaceId
LEFT JOIN BOS_PI_Employee ON BOS_PI_Employee.szEmployeeId = BOS_INV_FVRema.szDriverId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FVRemaItem.szProductId

Where
BOS_INV_FVRema.dtmRemain >= p_dtmFirstDate 
And BOS_INV_FVRema.dtmRemain < dateadd(day, 1, p_dtmLastDate) 
AND BOS_INV_FVRema.bApplied = 1
And BOS_INV_FVRema.szWorkplaceId = p_szWorkplaceId 
AND BOS_INV_FVRema.szDriverId = p_szOpUserId
AND p_bLowIncl <= BOS_PI_Employee.bIncludeInDailySettlement
AND BOS_PI_Employee.bIncludeInDailySettlement <= p_bTopIncl

Group By
BOS_INV_FVRema.szWorkplaceId,
BOS_GL_Workplace.szName,
BOS_INV_FVRema.szDriverId,
BOS_PI_Employee.szName,
BOS_INV_FVRemaItem.szProductId,
BOS_INV_Product.szName,
BOS_INV_Product.szQtyFormat,
BOS_INV_Product.szCompUomId,
BOS_INV_Product.szUomClassId,
BOS_INV_Product.szUomId

ORDER BY
BOS_INV_FVRema.szWorkplaceId,
BOS_INV_FVRema.szDriverId,
BOS_INV_FVRemaItem.szProductId


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_IsFSettlementExist(
p_szFSettlementId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSettlementId

FROM 
BOS_SD_FSettlement
WHERE 
szFSettlementId = p_szFSettlementId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_LockFSettlement(
p_szFSettlementId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSettlement
SET 
bTransferred = bTransferred
WHERE 
szFSettlementId = p_szFSettlementId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSettlement_UpdateFSettlement(
p_szFSettlementId BOS_DT_szId,
p_dtmSettBegin timestamp,
p_dtmSettEnd timestamp,
p_szWpToSettlement varchar,
p_bCloseInventory BOS_DT_bBoolean,
p_bCloseCashier BOS_DT_bBoolean,
p_bCloseDistribution BOS_DT_bBoolean,
p_bCloseEntry BOS_DT_bBoolean,
p_bCloseDaily BOS_DT_bBoolean,
p_szOpUserId BOS_DT_szId,
p_szSettlementType BOS_DT_szSmallId,
p_bResultFrTransfer BOS_DT_bBoolean,
p_bVoid BOS_DT_bBoolean,
p_bApproved BOS_DT_bBoolean,
p_bApplied BOS_DT_bBoolean,
p_bJournal BOS_DT_bBoolean,
p_bPosted BOS_DT_bBoolean,
p_btPrintedCount smallint,
p_bTransferred BOS_DT_bBoolean,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval BOS_DT_bBoolean,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated BOS_DT_bBoolean,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSettlement
SET 
dtmSettBegin = p_dtmSettBegin,
dtmSettEnd = p_dtmSettEnd,
szWpToSettlement = p_szWpToSettlement,

bCloseInventory = p_bCloseInventory,
bCloseCashier = p_bCloseCashier,
bCloseDistribution = p_bCloseDistribution,
bCloseEntry = p_bCloseEntry,

bCloseDaily = p_bCloseDaily,

szOpUserId = p_szOpUserId,
szSettlementType = p_szSettlementType,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId

WHERE 
szFSettlementId = p_szFSettlementId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSid_CountUnAppliedFSid(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT 
COUNT(DISTINCT szFSidId) As iFSidCount 
FROM 
BOS_INV_FSid 
WHERE 
szWorkplaceId = p_szWorkplaceId 
AND dtmIn >= p_dtmFrom 
AND dtmIn < dateadd(day, 1, p_dtmTo) 
--AND szDriverId = p_szOpUserId 
AND	bVoid = 0 
AND bApplied = 0 
AND btPrintedCount > 0
ELSE
SELECT 
COUNT(DISTINCT szFSidId) As iFSidCount 
FROM 
BOS_INV_FSid 
WHERE 
szWorkplaceId = p_szWorkplaceId 
AND dtmIn >= p_dtmFrom 
AND dtmIn < dateadd(day, 1, p_dtmTo) 
AND szDriverId = p_szOpUserId 
AND	bVoid = 0 
AND bApplied = 0 
AND btPrintedCount > 0

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSid_GetListOfUnAppliedFSid(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT 
szFSidId 
FROM 
BOS_INV_FSid 
WHERE 
szWorkplaceId = p_szWorkplaceId 
AND dtmIn >= p_dtmFrom 
AND dtmIn < dateadd(day, 1, p_dtmTo)
--AND szDriverId = p_szOpUserId 
AND	bVoid = 0 
AND bApplied = 0 
AND btPrintedCount > 0
ELSE
SELECT 
szFSidId 
FROM 
BOS_INV_FSid 
WHERE 
szWorkplaceId = p_szWorkplaceId 
AND dtmIn >= p_dtmFrom 
AND dtmIn < dateadd(day, 1, p_dtmTo)
AND szDriverId = p_szOpUserId 
AND	bVoid = 0 
AND bApplied = 0 
AND btPrintedCount > 0

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_CreateFSj(
p_szFSjId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_dtmFSj timestamp,
p_szSalesId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSj
(
szFSjId,
szSalesOrgId,
dtmFSj,
szSalesId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
)
VALUES
(
p_szFSjId,
p_szSalesOrgId,
p_dtmFSj,
p_szSalesId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_CreateFSjItem(
p_szFSjId BOS_DT_szId,
p_shItemNumber smallint,
p_szSjTrackingId BOS_DT_szId,
p_szReasonId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bSuccess bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSjItem
(
szFSjId,
shItemNumber,
szSjTrackingId,
szReasonId,
szDescription,
bSuccess
)
VALUES
(
p_szFSjId,
p_shItemNumber,
p_szSjTrackingId,
p_szReasonId,
p_szDescription,
p_bSuccess,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_CreateSjTracking(
p_szSjTrackingId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szFCallId BOS_DT_szId,
p_szSalesId BOS_DT_szId,
p_szFSjId BOS_DT_szId,
p_bFinished bit,
p_bSuccess bit,
p_bTasked bit,
p_dtmNext timestamp,
p_btTrialCount smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_SjTracking
(
szSjTrackingId,
szCustId,
szFCallId,
szSalesId,
szFSjId,
bFinished,
bSuccess,
bTasked,
dtmNext
btTrialCount,
)
VALUES
(
p_szSjTrackingId,
p_szCustId,
p_szFCallId,
p_szSalesId,
p_szFSjId,
p_bFinished,
p_bSuccess,
p_bTasked,
p_dtmNext
p_btTrialCount,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_DeleteFSj(
p_szFSjId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FSj
WHERE
szFSjId = p_szFSjId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_DeleteFSjItem(
p_szFSjId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FSjItem
WHERE
szFSjId = p_szFSjId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_DeleteSjTracking(
p_szSjTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_SD_SjTracking
WHERE
szSjTrackingId = p_szSjTrackingId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_GetActiveSjTrackingIdIfExist(
p_szCustId BOS_DT_szId,
p_dtmNext timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szSjTrackingId

FROM 
BOS_SD_SjTracking
WHERE 
 szCustId = p_szCustId And bFinished = 0 And (dtmNext >= p_dtmNext And dtmNext < DateAdd(Day, 1, p_dtmNext));

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_GetFSj(
p_szFSjId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_SD_FSj.szSalesOrgId,
BOS_SD_FSj.dtmFSj,
BOS_SD_FSj.szSalesId,
IsNull(BOS_PI_Employee.szName, '') AS szSalesName,
BOS_SD_FSj.bResultFrTransfer,
BOS_SD_FSj.bVoid,
BOS_GEN_Approved.bApproved,
BOS_SD_FSj.bApplied,
BOS_GL_FJournalTrans.szFJournalId AS bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_SD_FSj.btPrintedCount,
BOS_SD_FSj.bTransferred,
BOS_SD_FSj.szCompanyId,
BOS_SD_FSj.szWorkplaceId,
BOS_SD_FSj.szTaxEntityId,
BOS_SD_FSj.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
-- Data Status.
BOS_SD_FSj.dtmLastUpdated,
BOS_SD_FSj.bAlreadyTransferred

FROM
((BOS_SD_FSj LEFT JOIN BOS_GEN_Approved ON BOS_SD_FSj.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FSj.szFJournalId = BOS_GL_FJournalTrans.szFJournalId)
LEFT JOIN BOS_PI_Employee ON BOS_SD_FSj.szSalesId = BOS_PI_Employee.szEmployeeId
WHERE
BOS_SD_FSj.szFSjId = p_szFSjId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_GetFSjItem(
p_szFSjId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
shItemNumber,
szSjTrackingId,
szReasonId,
szDescription,
bSuccess

FROM 
BOS_SD_FSjItem
WHERE 
szFSjId = p_szFSjId ;ORDER BY 
shItemNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_GetListOfActiveSjTracking(
p_szSalesId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_SD_SjTracking.szSjTrackingId,
BOS_SD_SjTracking.szCustId,
Case When BOS_SD_SjTracking.szCustId = '' then IsNull(BOS_CRL_FCall.szName, '') else IsNull(BOS_AR_Customer.szName, '') end As szCustName,
BOS_CRL_FCall.szCallReasonId,
BOS_CRL_FCall.szMessage
FROM
BOS_SD_SjTracking LEFT JOIN BOS_AR_Customer ON BOS_SD_SjTracking.szCustId = BOS_AR_Customer.szCustId
LEFT JOIN BOS_CRL_FCall ON BOS_SD_SjTracking.szFCallId = BOS_CRL_FCall.szFCallId
WHERE
BOS_SD_SjTracking.bFinished = 0 AND
BOS_SD_SjTracking.bTasked = 0 AND
BOS_SD_sjTracking.szSalesId LIKE p_szSalesId AND
BOS_SD_SjTracking.szCustId LIKE p_szCustId AND
(BOS_SD_SjTracking.dtmNext  >= p_dtmStart AND BOS_SD_SjTracking.dtmNext < p_dtmEnd + 1)

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_GetListOfFSj()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSjId,
dtmFSj

FROM 
BOS_SD_FSj

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_GetListOfReportFSj(
p_szFSjId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSSI.szSjTrackingId,
COALESCE(BCC.szName, '') As szCustName,
COALESCE(BCC.szAddress_1, '') As szAddress,
COALESCE(BCC.szPhoneNo_1, '') As szPhoneNo,
BCC.dtmFollowUp, --Check Null
COALESCE(BCC.szContactPerson, '') As szContactPerson,
COALESCE(BCC.szCallReasonId, '') As szCallReasonId

FROM 
BOS_SD_FSj As BSS
Inner Join BOS_SD_FSjItem As BSSI On BSS.szFSjId = BSSI.szFSjId
Inner Join BOS_SD_SjTracking As BST On BSSI.szSjTrackingId = BST.szSjTrackingId
Left Join BOS_CRL_FCall As BCC On BST.szFCallId = BCC.szFCallId
WHERE 
BSS.szFSjId = p_szFSjId ;ORDER BY 
BSS.szFSjId,
BSSI.shItemNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_GetListOfSalesForSjProcess(
p_szWorkplaceId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
Select Distinct BOS_SD_SjTracking.szSalesId, COALESCE(BOS_PI_Employee.szName, '') As szSalesName

FROM 
BOS_SD_SjTracking Left Join BOS_PI_Employee ON BOS_SD_SjTracking.szSalesId = BOS_PI_Employee.szEmployeeId
WHERE 
BOS_SD_SjTracking.dtmNext >= p_dtmStart And BOS_SD_SjTracking.dtmNext < DateAdd(Day, 1, p_dtmEnd) And BOS_SD_SjTracking.bTasked = 0 And BOS_SD_SjTracking.bFinished = 0 And BOS_CRL_FCall.szForwardToWorkplaceId LIKE p_szWorkplaceId ;ORDER BY 
BOS_SD_SjTracking.szSalesId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_GetListOfSjTracking()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szSjTrackingId,
dtmNext

FROM 
BOS_SD_SjTracking

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_GetListOfSjTrackingTobeRescheduled(
p_szSalesId BOS_DT_szId,
p_bFinished bit,
p_dtmFrom timestamp,
p_dtmTo timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT
BSS.bFinished,
BSS.bSuccess,
BSS.szSalesId,
IsNull(BPE.szName, '') AS szSalesName,
BSS.szCustId,
Case When BSS.szCustId = '' Then IsNull(BCF.szName, '') Else IsNull(BAC.szName, '') End AS szCustName,
BSS.dtmNext AS dtmLastSalesDate,
IsNull(BSF.szFSjId, '') As szFSjId,
BSS.szSjTrackingId,
IsNull(BSS.szFCallId, '') As szFCallId,
IsNull(BSF.szReasonId, '') AS szReasonId,
IsNull(BSF.szDescription, '') AS szDescription
FROM
BOS_SD_SjTracking AS BSS LEFT JOIN BOS_PI_Employee AS BPE ON BSS.szSalesId = BPE.szEmployeeId
LEFT JOIN BOS_AR_Customer AS BAC ON BSS.szCustId = BAC.szCustId
LEFT JOIN BOS_SD_FSjItem AS BSF ON BSS.szFSjId = BSF.szFSjId And BSS.szSjTrackingId = BSF.szSjTrackingId
LEFT JOIN BOS_CRL_FCall As BCF ON BSS.szFCallId = BCF.szFCallId
WHERE
BSS.szSalesId LIKE p_szSalesId And
BSS.bFinished = p_bFinished And
BSS.dtmNext >= p_dtmFrom And BSS.dtmNext < DateAdd(Day, 1, p_dtmTo)
ORDER BY
BSS.szSalesId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_GetListOfWorkplaceOfSales(
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_szSalesId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
Select Distinct BOS_CRL_FCall.szForwardToWorkplaceId, BOS_GL_Workplace.szName

FROM 
BOS_SD_SjTracking Inner Join BOS_CRL_FCall On BOS_SD_SjTracking.szFCallId = BOS_CRL_FCall.szFCallId
WHERE 
 BOS_SD_SjTracking.bTasked = 0 And BOS_SD_SjTracking.bFinished = 0;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_GetSjTracking(
p_szSjTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
BOS_SD_SjTracking.szCustId,

FROM 
BOS_SD_SjTracking Left Join BOS_PI_Employee On BOS_SD_SjTracking.szSalesId = BOS_PI_Employee.szEmployeeId
Left Join BOS_AR_Customer On BOS_SD_SjTracking.szCustId = BOS_AR_Customer.szCustId
Left Join BOS_CRL_FCall On BOS_SD_SjTracking.szFCallId = BOS_CRL_FCall.szFCallId
Left Join BOS_SD_FSjItem On BOS_SD_FSjItem.szFSjId = BOS_SD_SjTracking.szFSjId And BOS_SD_FSjItem.szSjTrackingId = BOS_SD_SjTracking.szSjTrackingId
WHERE 
BOS_SD_SjTracking.szSjTrackingId = p_szSjTrackingId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_IsFSjCreated(
p_szSalesId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_dtmAutoFSj timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSjId

FROM 
BOS_SD_FSj
WHERE 
bVoid = 0 AND szSalesId = p_szSalesId And szWorkplaceId = p_szWorkplaceId And (dtmFSj >= p_dtmAutoFSj AND dtmFSj < p_dtmAutoFSj + 1) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_IsFSjExist(
p_szFSjId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSjId

FROM 
BOS_SD_FSj
WHERE 
szFSjId = p_szFSjId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_IsSjTrackingExist(
p_szSjTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szSjTrackingId

FROM 
BOS_SD_SjTracking
WHERE 
szSjTrackingId = p_szSjTrackingId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_LockFSj(
p_szFSjId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSj
SET 
bTransferred = bTransferred
WHERE 
szFSjId = p_szFSjId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_LockSjTracking(
p_szSjTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_SjTracking
SET 
bSuccess = bSuccess
WHERE 
szSjTrackingId = p_szSjTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_MarkFSjApplied(
p_szFSjId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSj
SET 
bApplied = 1
WHERE 
szFSjId=p_szFSjId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_MarkFSjVoid(
p_szFSjId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSj
SET 
bVoid = 1
WHERE 
szFSjId = p_szFSjId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_MarkSjTracking(
p_szSjTrackingId BOS_DT_szId,
p_bTasked bit,
p_bFinished bit,
p_dtmNext timestamp,
p_szSalesId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_SjTracking
SET 
bTasked = p_bTasked,
bFinished = p_bFinished,
dtmNext = p_dtmNext,
szSalesId = p_szSalesId
WHERE 
szSjTrackingId = p_szSjTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_MarkSjTrackingTasked(
p_szSjTrackingId BOS_DT_szId,
p_bTasked bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_SjTracking
SET 
bTasked = p_bTasked
WHERE 
szSjTrackingId = p_szSjTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_UpdateFSj(
p_szFSjId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_dtmFSj timestamp,
p_szSalesId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSj
SET 
szSalesOrgId = p_szSalesOrgId,
dtmFSj = p_dtmFSj,
szSalesId = p_szSalesId,
bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId
WHERE 
szFSjId = p_szFSjId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_UpdateFSjItemReason(
p_szFSjId BOS_DT_szId,
p_szSjTrackingId BOS_DT_szId,
p_szReasonId BOS_DT_szId,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSjItem
SET 
szReasonId = p_szReasonId,
szDescription = p_szDescription
WHERE 
szFSjID = p_szFSjId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSj_UpdateSjTracking(
p_szSjTrackingId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szFCallId BOS_DT_szId,
p_szSalesId BOS_DT_szId,
p_szFSjId BOS_DT_szId,
p_bFinished bit,
p_bSuccess bit,
p_bTasked bit,
p_dtmNext timestamp,
p_btTrialCount smallint)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_SjTracking
SET 
szCustId = p_szCustId,
szFCallId = p_szFCallId,
szSalesId = p_szSalesId,
szFSjId = p_szFSjId,
bFinished = p_bFinished,
bSuccess = p_bSuccess,
bTasked = p_bTasked,
dtmNext = p_dtmNext,
btTrialCount = p_btTrialCount
WHERE 
szSjTrackingId = p_szSjTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSnCorrection_CreateFSnCorrection(
p_szFSnCorrectionId BOS_DT_szId,
p_dtmDoc timestamp,
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_decAddQty BOS_DT_decAmount,
p_decDeleteQty BOS_DT_decAmount,
p_szRemark varchar,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSnCorrection
(
szFSnCorrectionId,
dtmDoc,
szCustId,
szProductId,
decAddQty,
decDeleteQty,
szRemark,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
)
VALUES
(
p_szFSnCorrectionId,
p_dtmDoc,
p_szCustId,
p_szProductId,
p_decAddQty,
p_decDeleteQty,
p_szRemark,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSnCorrection_CreateFSnCorrectionItem(
p_szFSnCorrectionId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductSn BOS_DT_szSN,
p_shStatusSn smallint,
p_bTrouble bit,
p_szTroubleDesc varchar,
p_szStockTypeId BOS_DT_szId,
p_dtmRentStartDate timestamp,
p_szRentChargeCalcId BOS_DT_szId,
p_decRentPrice BOS_DT_decAmount,
p_szCurrencyId BOS_DT_szId,
p_szOrderItemType varchar,
p_szStatusId varchar,
p_bTaxable bit,
p_szReasonId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSnCorrectionItem
(
szFSnCorrectionId,
shItemNumber,
szProductSn,
shStatusSn,
bTrouble,
szTroubleDesc,
szStockTypeId,
dtmRentStartDate,
szRentChargeCalcId,
decRentPrice,
szCurrencyId,
szOrderItemType,
szStatusId,
bTaxable,
szReasonId
)
VALUES
(
p_szFSnCorrectionId,
p_shItemNumber,
p_szProductSn,
p_shStatusSn,
p_bTrouble,
p_szTroubleDesc,
p_szStockTypeId,
p_dtmRentStartDate,
p_szRentChargeCalcId,
p_decRentPrice,
p_szCurrencyId,
p_szOrderItemType,
p_szStatusId,
p_bTaxable,
p_szReasonId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSnCorrection_DeleteFSnCorrection(
p_szFSnCorrectionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SD_FSnCorrection
WHERE
szFSnCorrectionId = p_szFSnCorrectionId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSnCorrection_DeleteFSnCorrectionItem(
p_szFSnCorrectionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SD_FSnCorrectionItem
WHERE
szFSnCorrectionId = p_szFSnCorrectionId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSnCorrection_GetFSnCorrection(
p_szFSnCorrectionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_FSnCorrection.dtmDoc,
BOS_SD_FSnCorrection.szCustId,
BOS_AR_Customer.szName as szCustNm,

BOS_SD_FSnCorrection.szProductId,
BOS_INV_Product.szName as szProductNm,
BOS_INV_Product.szUomId AS szProductUomId_J,

BOS_SD_FSnCorrection.decAddQty,
BOS_SD_FSnCorrection.decDeleteQty,
BOS_SD_FSnCorrection.szRemark,
BOS_SD_FSnCorrection.bResultFrTransfer,
BOS_SD_FSnCorrection.bVoid,
BOS_GEN_Approved.bApproved,
BOS_SD_FSnCorrection.bApplied,
BOS_GL_FJournalTrans.szFJournalId AS bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_SD_FSnCorrection.btPrintedCount,
BOS_SD_FSnCorrection.bTransferred,
BOS_SD_FSnCorrection.szCompanyId,
BOS_SD_FSnCorrection.szWorkplaceId,
BOS_SD_FSnCorrection.szTaxEntityId,
BOS_SD_FSnCorrection.bNeedApproval,
BOS_SD_FSnCorrection.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_GL_Company.szName AS szCompanyNm,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_SD_FSnCorrection.dtmCreated,
BOS_SD_FSnCorrection.bSystemCreated,
BOS_SD_FSnCorrection.szUserId,
ISNULL(BOS_SM_User.szName,'') AS szUserNm_J,

BOS_SD_FSnCorrection.dtmLastUpdated,
BOS_SD_FSnCorrection.bAlreadyTransferred

FROM
BOS_SD_FSnCorrection
LEFT JOIN BOS_GEN_Approved ON BOS_SD_FSnCorrection.gdApprovedId=BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FSnCorrection.szFJournalId=BOS_GL_FJournalTrans.szFJournalId
LEFT JOIN BOS_INV_Product ON BOS_SD_FSnCorrection.szProductId=BOS_INV_Product.szProductId
LEFT JOIN BOS_AR_Customer ON BOS_SD_FSnCorrection.szCustId=BOS_AR_Customer.szCustId
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FSnCorrection.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FSnCorrection.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FSnCorrection.szUserId

WHERE
BOS_SD_FSnCorrection.szFSnCorrectionId = p_szFSnCorrectionId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSnCorrection_GetFSnCorrectionItem(
p_szFSnCorrectionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSnCorrectionId,
shItemNumber,
szProductSn,
shStatusSn,
bTrouble,
szTroubleDesc,
szStockTypeId,
dtmRentStartDate,
szRentChargeCalcId,
decRentPrice,
szCurrencyId,
szOrderItemType,
szStatusId,
bTaxable,
szReasonId


FROM 
BOS_SD_FSnCorrectionItem
WHERE 
szFSnCorrectionId = p_szFSnCorrectionId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSnCorrection_GetListOfFSnCorrection()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSnCorrectionId,
dtmDoc

FROM 
BOS_SD_FSnCorrection

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSnCorrection_IsFSnCorrectionExist(
p_szFSnCorrectionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSnCorrectionId

FROM 
BOS_SD_FSnCorrection
WHERE 
szFSnCorrectionId = p_szFSnCorrectionId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSnCorrection_LockFSnCorrection(
p_szFSnCorrectionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSnCorrection
SET 
bTransferred = bTransferred
WHERE 
szFSnCorrectionId = p_szFSnCorrectionId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSnCorrection_MarkFSnCorrectionApplied(
p_szFSnCorrectionId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSnCorrection
SET 
bApplied=1
WHERE 
szFSnCorrectionId = p_szFSnCorrectionId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSnCorrection_MarkFSnCorrectionTransferred(
p_szFSnCorrectionId BOS_DT_szId,
p_bTransferred bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSnCorrection
SET 
bTransferred = p_bTransferred
WHERE 
szFSnCorrectionId = p_szFSnCorrectionId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSnCorrection_MarkFSnCorrectionVoid(
p_szFSnCorrectionId BOS_DT_szId,
p_gdApprovedId bytea)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSnCorrection
SET 
bVoid = 1,
bNeedApproval = 0,
gdApprovedId = p_gdApprovedId
WHERE 
szFSnCorrectionId = p_szFSnCorrectionId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSnCorrection_UpdateFSnCorrection(
p_szFSnCorrectionId BOS_DT_szId,
p_dtmDoc timestamp,
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_decAddQty BOS_DT_decAmount,
p_decDeleteQty BOS_DT_decAmount,
p_szRemark varchar,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated smallint,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSnCorrection
SET 
dtmDoc = p_dtmDoc,
szCustId = p_szCustId,
szProductId = p_szProductId,
decAddQty = p_decAddQty,
decDeleteQty = p_decDeleteQty,
szRemark = p_szRemark,

bVoid=p_bVoid,
bApplied=p_bApplied,
szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId



WHERE 
szFSnCorrectionId = p_szFSnCorrectionId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_CountUnAppliedFSo(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
count(DISTINCT BOS_SD_FSo.szFSoId) as cntFSoCount
FROM
BOS_SD_FSo
INNER JOIN BOS_SD_FSoItem ON BOS_SD_FSoItem.szFSoId = BOS_SD_FSo.szFSoId
WHERE
BOS_SD_FSo.szWorkplaceId = p_szWorkplaceId
AND BOS_SD_FSo.bVoid = 0 AND BOS_SD_FSo.bApplied = 0
AND BOS_SD_FSo.dtmOrder >= p_dtmFrom AND BOS_SD_FSo.dtmOrder < dateadd(day, 1, p_dtmTo)
--AND BOS_SD_FSo.szSalesId = p_szOpUserId
ELSE
SELECT
count(DISTINCT BOS_SD_FSo.szFSoId) as cntFSoCount
FROM
BOS_SD_FSo
INNER JOIN BOS_SD_FSoItem ON BOS_SD_FSoItem.szFSoId = BOS_SD_FSo.szFSoId
WHERE
BOS_SD_FSo.szWorkplaceId = p_szWorkplaceId
AND BOS_SD_FSo.bVoid = 0 AND BOS_SD_FSo.bApplied = 0
AND BOS_SD_FSo.dtmOrder >= p_dtmFrom AND BOS_SD_FSo.dtmOrder < dateadd(day, 1, p_dtmTo)
AND BOS_SD_FSo.szSalesId = p_szOpUserId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_CountUnAppliedFSo_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
count(DISTINCT BOS_SD_FSo.szFSoId) as cntFSoCount
FROM
BOS_SD_FSo
INNER JOIN BOS_SD_FSoItem ON BOS_SD_FSoItem.szFSoId = BOS_SD_FSo.szFSoId
WHERE
BOS_SD_FSo.szWorkplaceId = p_szWorkplaceId
AND BOS_SD_FSo.bVoid = 0 AND BOS_SD_FSo.bApplied = 0
AND BOS_SD_FSo.dtmOrder >= p_dtmFrom AND BOS_SD_FSo.dtmOrder < dateadd(day, 1, p_dtmTo)
--AND BOS_SD_FSo.szSalesId = p_szOpUserId
ELSE
SELECT
count(DISTINCT BOS_SD_FSo.szFSoId) as cntFSoCount
FROM
BOS_SD_FSo
INNER JOIN BOS_SD_FSoItem ON BOS_SD_FSoItem.szFSoId = BOS_SD_FSo.szFSoId
WHERE
BOS_SD_FSo.szWorkplaceId = p_szWorkplaceId
AND BOS_SD_FSo.bVoid = 0 AND BOS_SD_FSo.bApplied = 0
AND BOS_SD_FSo.dtmOrder >= p_dtmFrom AND BOS_SD_FSo.dtmOrder < dateadd(day, 1, p_dtmTo)
AND BOS_SD_FSo.szSalesId = p_szOpUserId


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_CreateFSo(
p_szFSoId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szOrderTypeId BOS_DT_szId,
p_dtmOrder timestamp,
p_dtmPrice timestamp,
p_szCustId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_decTax BOS_DT_decTax,
p_decDownPayment BOS_DT_decAmount,
p_szStatus BOS_DT_szSmallId,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_decCcyRate BOS_DT_decCcyRate,
p_szFInvoiceId BOS_DT_szId,
p_szCompletedFInvoiceId BOS_DT_szId,
p_szFirstCompletedFInvoiceId BOS_DT_szId,
p_bDropShip bit,
p_szSalesId BOS_DT_szId,
p_szSalesSupervisorId BOS_DT_szId,
p_szSalesSupervisorId_2 BOS_DT_szId,
p_szSalesSupervisorId_3 BOS_DT_szId,
p_szSalesDivisionId BOS_DT_szId,
p_szSalesDepartmentId BOS_DT_szId,
p_szSalesTeamId BOS_DT_szId,
p_szRemark BOS_DT_szMessage,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_szCustPoId BOS_DT_szId,
p_dtmCustPo timestamp,
p_bCash bit,
p_gdCreditLimitApprovedId bytea,
p_bNeedFInvoice smallint,
p_szPaymentTermId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_decTonase numeric,
p_decCubication numeric,
p_bUploadedFromMoDis BOS_DT_bBoolean,
p_szFDoReffId BOS_DT_szId,
p_dtmStartVisit timestamp,
p_dtmEndVisit timestamp,
p_decVisitSpendTime BOS_DT_decAmount,
p_bScanSuccess smallint,
p_szScanFailReason BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSo
(
      ,
szFSoId      ,
szSalesOrgId      ,
szOrderTypeId      ,
dtmOrder      ,
dtmPrice      ,
szCustId      ,
decAmount      ,
decTax      ,
decDownPayment      ,
szStatus      ,
szCcyId      ,
szCcyRateId      ,
decCcyRate      ,
szFInvoiceId      ,
szCompletedFInvoiceId      ,
szFirstCompletedFInvoiceId      ,
bDropShip      ,
szSalesId      ,
szSalesSupervisorId      ,
szSalesSupervisorId_2      ,
szSalesSupervisorId_3      ,
szSalesDivisionId      ,
szSalesDepartmentId      ,
szSalesTeamId      ,
szRemark      ,
szLatitude      ,
szLongitude      ,
szCustPoId      ,
dtmCustPo      ,
bCash      ,
gdCreditLimitApprovedId      ,
bNeedFInvoice      ,
szPaymentTermId      ,
bResultFrTransfer      ,
bVoid      ,
bApplied      ,
btPrintedCount      ,
bTransferred      ,
szCompanyId      ,
szWorkplaceId      ,
szTaxEntityId      ,
bNeedApproval      ,
gdApprovedId      ,
szFJournalId      ,
dtmCreated      ,
bSystemCreated      ,
szUserId      ,
-- Data Status.      ,
dtmLastUpdated      ,
bAlreadyTransferred      ,
-- weight and volume      ,
decTonase      ,
decCubication      ,
bUploadedFromMoDis      ,
szFDoReffId    ,
dtmStartVisit    ,
dtmEndVisit    ,
decVisitSpendTime  ,
bScanSuccess  ,
szScanFailReason      
      ,
)
VALUES
(
p_szFSoId,
p_szSalesOrgId,
p_szOrderTypeId,
p_dtmOrder,
p_dtmPrice,
p_szCustId,
p_decAmount,
p_decTax,
p_decDownPayment,
p_szStatus,
p_szCcyId,
p_szCcyRateId,
p_decCcyRate,
p_szFInvoiceId,
p_szCompletedFInvoiceId,
p_szFirstCompletedFInvoiceId,
p_bDropShip,
p_szSalesId,
p_szSalesSupervisorId,
p_szSalesSupervisorId_2,
p_szSalesSupervisorId_3,
p_szSalesDivisionId,
p_szSalesDepartmentId,
p_szSalesTeamId,
p_szRemark,
p_szLatitude,
p_szLongitude,
p_szCustPoId,
p_dtmCustPo,
p_bCash,
p_gdCreditLimitApprovedId,
p_bNeedFInvoice,
p_szPaymentTermId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
-- weight and volume,
p_decTonase,
p_decCubication,
p_bUploadedFromMoDis,
p_szFDoReffId,
p_dtmStartVisit,
p_dtmEndVisit,
p_decVisitSpendTime,
p_bScanSuccess,
p_szScanFailReason
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_CreateFSo_013(
p_szFSoId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szOrderTypeId BOS_DT_szId,
p_dtmOrder timestamp,
p_dtmPrice timestamp,
p_szCustId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_decTax BOS_DT_decTax,
p_decDownPayment BOS_DT_decAmount,
p_szStatus BOS_DT_szSmallId,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_decCcyRate BOS_DT_decCcyRate,
p_szFInvoiceId BOS_DT_szId,
p_szCompletedFInvoiceId BOS_DT_szId,
p_szFirstCompletedFInvoiceId BOS_DT_szId,
p_bDropShip bit,
p_szSalesId BOS_DT_szId,
p_szSalesSupervisorId BOS_DT_szId,
p_szSalesSupervisorId_2 BOS_DT_szId,
p_szSalesSupervisorId_3 BOS_DT_szId,
p_szSalesDivisionId BOS_DT_szId,
p_szSalesDepartmentId BOS_DT_szId,
p_szSalesTeamId BOS_DT_szId,
p_szRemark BOS_DT_szMessage,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_szCustPoId BOS_DT_szId,
p_dtmCustPo timestamp,
p_bCash bit,
p_gdCreditLimitApprovedId bytea,
p_bNeedFInvoice smallint,
p_szPaymentTermId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_decTonase numeric,
p_decCubication numeric,
p_bUploadedFromMoDis BOS_DT_bBoolean,
p_szFDoReffId BOS_DT_szId,
p_dtmStartVisit timestamp,
p_dtmEndVisit timestamp,
p_decVisitSpendTime BOS_DT_decAmount,
p_decJourneySpendTime BOS_DT_decAmount,
p_bScanSuccess smallint,
p_szScanFailReason BOS_DT_szId,
p_szBarcodeScanFailReason BOS_DT_szId,
p_AdcId BOS_DT_szId,
p_dtmExpiration timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSo
(
        ,
szFSoId        ,
szSalesOrgId        ,
szOrderTypeId        ,
dtmOrder        ,
dtmPrice        ,
szCustId        ,
decAmount        ,
decTax        ,
decDownPayment        ,
szStatus        ,
szCcyId        ,
szCcyRateId        ,
decCcyRate        ,
szFInvoiceId        ,
szCompletedFInvoiceId        ,
szFirstCompletedFInvoiceId        ,
bDropShip        ,
szSalesId        ,
szSalesSupervisorId        ,
szSalesSupervisorId_2        ,
szSalesSupervisorId_3        ,
szSalesDivisionId        ,
szSalesDepartmentId        ,
szSalesTeamId        ,
szRemark        ,
szLatitude        ,
szLongitude        ,
szCustPoId        ,
dtmCustPo        ,
bCash        ,
gdCreditLimitApprovedId        ,
bNeedFInvoice        ,
szPaymentTermId        ,
bResultFrTransfer        ,
bVoid        ,
bApplied        ,
btPrintedCount        ,
bTransferred        ,
szCompanyId        ,
szWorkplaceId        ,
szTaxEntityId        ,
bNeedApproval        ,
gdApprovedId        ,
szFJournalId        ,
dtmCreated        ,
bSystemCreated        ,
szUserId        ,
-- Data Status.        ,
dtmLastUpdated        ,
bAlreadyTransferred        ,
-- weight and volume        ,
decTonase        ,
decCubication        ,
bUploadedFromMoDis        ,
szFDoReffId      ,
dtmStartVisit      ,
dtmEndVisit      ,
decVisitSpendTime,
decJourneySpendTime    ,
bScanSuccess    ,
szScanFailReason,
szBarcodeScanFailReason,
AdcId,
dtmExpiration        
        ,
)
VALUES
(
p_szFSoId,
p_szSalesOrgId,
p_szOrderTypeId,
p_dtmOrder,
p_dtmPrice,
p_szCustId,
p_decAmount,
p_decTax,
p_decDownPayment,
p_szStatus,
p_szCcyId,
p_szCcyRateId,
p_decCcyRate,
p_szFInvoiceId,
p_szCompletedFInvoiceId,
p_szFirstCompletedFInvoiceId,
p_bDropShip,
p_szSalesId,
p_szSalesSupervisorId,
p_szSalesSupervisorId_2,
p_szSalesSupervisorId_3,
p_szSalesDivisionId,
p_szSalesDepartmentId,
p_szSalesTeamId,
p_szRemark,
p_szLatitude,
p_szLongitude,
p_szCustPoId,
p_dtmCustPo,
p_bCash,
p_gdCreditLimitApprovedId,
p_bNeedFInvoice,
p_szPaymentTermId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
-- weight and volume,
p_decTonase,
p_decCubication,
p_bUploadedFromMoDis,
p_szFDoReffId,
p_dtmStartVisit,
p_dtmEndVisit,
p_decVisitSpendTime,
p_decJourneySpendTime,
p_bScanSuccess,
p_szScanFailReason,
p_szBarcodeScanFailReason,
p_AdcId,
p_dtmExpiration,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_CreateFSoItem(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_dtmPriceDate timestamp,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId,
p_decTonase numeric,
p_decCubication numeric,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSoItem
(
szFSoId,
shItemNumber,
szOrderItemTypeId,
szProductId,
szPriceId,
szPriceOrderId,
decDiscProcent,
dtmPriceDate,
decQty,
decUomQty,
szUomId,
decPrice,
decDiscount,
bTaxable,
decTax,
decAmount,
decDPP,
szPaymentType,
szPrincipalDiscRefId,
-- Cubication and Tonase,
decTonase,
decCubication,
szParentId
)
VALUES
(
p_szFSoId,
p_shItemNumber,
p_szOrderItemTypeId,
p_szProductId,
p_szPriceId,
p_szPriceOrderId,
p_decDiscProcent,
p_dtmPriceDate,
p_decQty,
p_decUomQty,
p_szUomId,
p_decPrice,
p_decDiscount,
p_bTaxable,
p_decTax,
p_decAmount,
p_decDPP,
p_szPaymentType,
p_szPrincipalDiscRefId,
-- Tonase and Cubication,
p_decTonase,
p_decCubication,
p_szParentId,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_CreateFSoItem_013(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_dtmPriceDate timestamp,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId,
p_decTonase numeric,
p_decCubication numeric,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSoItem
(
szFSoId,
shItemNumber,
szOrderItemTypeId,
szProductId,
szPriceId,
szPriceOrderId,
decDiscProcent,
dtmPriceDate,
decQty,
decUomQty,
szUomId,
decPrice,
decDiscount,
bTaxable,
decTax,
decAmount,
decDPP,
szPaymentType,
szPrincipalDiscRefId,
-- Cubication and Tonase,
decTonase,
decCubication,
szParentId
)
VALUES
(
p_szFSoId,
p_shItemNumber,
p_szOrderItemTypeId,
p_szProductId,
p_szPriceId,
p_szPriceOrderId,
p_decDiscProcent,
p_dtmPriceDate,
p_decQty,
p_decUomQty,
p_szUomId,
p_decPrice,
p_decDiscount,
p_bTaxable,
p_decTax,
p_decAmount,
p_decDPP,
p_szPaymentType,
p_szPrincipalDiscRefId,
-- Tonase and Cubication,
p_decTonase,
p_decCubication,
p_szParentId,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_CreateFSoItem_014(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_dtmPriceDate timestamp,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId,
p_decTonase numeric,
p_decCubication numeric,
p_szParentId BOS_DT_szId,
p_szDistProductId BOS_DT_szId,
p_decDistQty BOS_DT_decAmount,
p_decDistPrice BOS_DT_decPrice)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSoItem
(
szFSoId,
shItemNumber,
szOrderItemTypeId,
szProductId,
szPriceId,
szPriceOrderId,
decDiscProcent,
dtmPriceDate,
decQty,
decUomQty,
szUomId,
decPrice,
decDiscount,
bTaxable,
decTax,
decAmount,
decDPP,
szPaymentType,
szPrincipalDiscRefId,
-- Cubication and Tonase,
decTonase,
decCubication,
szParentId,
szDistProductId,
decDistQty,
decDistPrice
)
VALUES
(
p_szFSoId,
p_shItemNumber,
p_szOrderItemTypeId,
p_szProductId,
p_szPriceId,
p_szPriceOrderId,
p_decDiscProcent,
p_dtmPriceDate,
p_decQty,
p_decUomQty,
p_szUomId,
p_decPrice,
p_decDiscount,
p_bTaxable,
p_decTax,
p_decAmount,
p_decDPP,
p_szPaymentType,
p_szPrincipalDiscRefId,
-- Tonase and Cubication,
p_decTonase,
p_decCubication,
p_szParentId,
p_szDistProductId,
p_decDistQty,
p_decDistPrice,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_CreateFSoItem_015(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_dtmPriceDate timestamp,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId,
p_decTonase numeric,
p_decCubication numeric,
p_szParentId BOS_DT_szId,
p_szDistProductId BOS_DT_szId,
p_decDistQty BOS_DT_decAmount,
p_decDistPrice BOS_DT_decPrice,
p_szBudgetId BOS_DT_szId,
p_decPrincipalCostAmount BOS_DT_decAmount,
p_decPrincipalCostQty BOS_DT_decAmount,
p_bBudgetTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSoItem
(
szFSoId,
shItemNumber,
szOrderItemTypeId,
szProductId,
szPriceId,
szPriceOrderId,
decDiscProcent,
dtmPriceDate,
decQty,
decUomQty,
szUomId,
decPrice,
decDiscount,
bTaxable,
decTax,
decAmount,
decDPP,
szPaymentType,
szPrincipalDiscRefId,
-- Cubication and Tonase,
decTonase,
decCubication,
szParentId,
szDistProductId,
decDistQty,
decDistPrice,
szBudgetId,
decPrincipalCostAmount,
decPrincipalCostQty,
bBudgetTransferred,
)
VALUES
(
p_szFSoId,
p_shItemNumber,
p_szOrderItemTypeId,
p_szProductId,
p_szPriceId,
p_szPriceOrderId,
p_decDiscProcent,
p_dtmPriceDate,
p_decQty,
p_decUomQty,
p_szUomId,
p_decPrice,
p_decDiscount,
p_bTaxable,
p_decTax,
p_decAmount,
p_decDPP,
p_szPaymentType,
p_szPrincipalDiscRefId,
-- Tonase and Cubication,
p_decTonase,
p_decCubication,
p_szParentId,
p_szDistProductId,
p_decDistQty,
p_decDistPrice,
p_szBudgetId,
p_decPrincipalCostAmount,
p_decPrincipalCostQty,
p_bBudgetTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_CreateFSoItemBonusSource(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_decBonusAmount BOS_DT_decAmount,
p_decBonusQty BOS_DT_decAmount,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSoItemBonusSource
(
szFSoId,
shItemNumber,
szProductId,
szOrderItemTypeId,
szPaymentType,
decBonusAmount,
decBonusQty,
szParentId
)
VALUES
(
p_szFSoId,
p_shItemNumber,
p_szProductId,
p_szOrderItemTypeId,
p_szPaymentType,
p_decBonusAmount,
p_decBonusQty,
p_szParentId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_CreateFSoItemBonusSource_014(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_decBonusAmount BOS_DT_decAmount,
p_decBonusQty BOS_DT_decAmount,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSoItemBonusSource
(
szFSoId,
shItemNumber,
szProductId,
szOrderItemTypeId,
szPaymentType,
decBonusAmount,
decBonusQty,
szParentId
)
VALUES
(
p_szFSoId,
p_shItemNumber,
p_szProductId,
p_szOrderItemTypeId,
p_szPaymentType,
p_decBonusAmount,
p_decBonusQty,
p_szParentId,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_CreateFSoItemDelivery(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_dtmDelivery timestamp,
p_szCustId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szFromWpId BOS_DT_szId,
p_szDjrTrackingId BOS_DT_szId,
p_szFDoId BOS_DT_szId,
p_decRemainingQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSoItemDelivery
(
szFSoId,
shItemNumber,
dtmDelivery,
szCustId,
decQty,
szFromWpId,
szDjrTrackingId,
szFDoId,
decRemainingQty,
)
VALUES
(
p_szFSoId,
p_shItemNumber,
p_dtmDelivery,
p_szCustId,
p_decQty,
p_szFromWpId,
p_szDjrTrackingId,
p_szFDoId,
p_decRemainingQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_CreateFSoItemDelivery_013(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_dtmDelivery timestamp,
p_szCustId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szFromWpId BOS_DT_szId,
p_szDjrTrackingId BOS_DT_szId,
p_szFDoId BOS_DT_szId,
p_decRemainingQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSoItemDelivery
(
szFSoId,
shItemNumber,
dtmDelivery,
szCustId,
decQty,
szFromWpId,
szDjrTrackingId,
szFDoId,
decRemainingQty,
)
VALUES
(
p_szFSoId,
p_shItemNumber,
p_dtmDelivery,
p_szCustId,
p_decQty,
p_szFromWpId,
p_szDjrTrackingId,
p_szFDoId,
p_decRemainingQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_CreateFSoItemReason(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_szReasonId BOS_DT_szId,
p_decQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSoItemReason
(
szFSoId,
shItemNumber,
szReasonId,
decQty
)
VALUES
(
p_szFSoId,
p_shItemNumber,
p_szReasonId,
p_decQty,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_CreateFSoProductDepositBonusItem(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szOrderItemTypeId BOS_DT_szId,
p_bGenByTotal smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSoProductDepositBonusItem
(
szFSoId,
shItemNumber,
szProductId,
decQty,
szUomId,
szOrderItemTypeId,
bGenByTotal
)
VALUES
(
p_szFSoId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_szOrderItemTypeId,
p_bGenByTotal
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_CreateFSoProductDepositBonusItemBonusSource(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_decBonusAmount BOS_DT_decAmount,
p_decBonusQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FSoProductDepositBonusItemBonusSource
(
szFSoId,
shItemNumber,
szProductId,
szOrderItemTypeId,
szPaymentType,
decBonusAmount,
decBonusQty
)
VALUES
(
p_szFSoId,
p_shItemNumber,
p_szProductId,
p_szOrderItemTypeId,
p_szPaymentType,
p_decBonusAmount,
p_decBonusQty
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_DeleteFSo(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_DeleteFSoItem(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_SD_FSoItem
WHERE
szFSoId = p_szFSoId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_DeleteFSoItem_ByItem(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FSoItem
WHERE
szFSoId = p_szFSoIdAND shItemNumber = p_shItemNumber;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_DeleteFSoItemBonusSource(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_DeleteFSoItemBonusSource_ByItem(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FSoItemBonusSource
WHERE
szFSoId = p_szFSoIdAND shItemNumber = p_shItemNumberAND szProductId = p_szProductIdAND szOrderItemTypeId = p_szOrderItemTypeIdAND szPaymentType = p_szPaymentType;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_DeleteFSoItemDelivery(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_SD_FSoItemDelivery
WHERE
szFSoId = p_szFSoId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_DeleteFSoItemDelivery_ByItem(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_dtmDelivery timestamp,
p_szCustId BOS_DT_szId,
p_szFromWpId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FSoItemDelivery
WHERE
szFSoId = p_szFSoIdAND shItemNumber = p_shItemNumberAND dtmDelivery = p_dtmDeliveryAND szCustId = p_szCustIdAND szFromWpId = p_szFromWpId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_DeleteFSoItemReason(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SD_FSoItemReason
WHERE
 szFSoId = p_szFSoId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_DeleteFSoProductDepositBonusItem(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SD_FSoProductDepositBonusItem
WHERE
szFSoId = p_szFSoId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_DeleteFSoProductDepositBonusItemBonusSource(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetFSo(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT      
BOS_SD_FSo.szFSoId,      
BOS_SD_FSo.szSalesOrgId,      

BOS_SD_FSo.szOrderTypeId,      
BOS_INV_OrderType.bAllowManualPrice AS bOrderTypeAllowManualPrice_J,      
BOS_INV_OrderType.bAllowToChangeLinePriceDate AS bOrderTypeAllowToChangeLinePriceDate_J,      

BOS_SD_FSo.dtmOrder,      
BOS_SD_FSo.dtmPrice,      

BOS_SD_FSo.szCustId,      
BOS_AR_Customer.szName as szCustNm_J,      
CustSales.bAllowToCredit AS bCustAllowToCredit_J,      

CustLoc.LocationszContactPerson,      
CustLoc.LocationszRoomNo,      
CustLoc.LocationszFloor,      
CustLoc.LocationszBuilding,      
CustLoc.LocationszAddress_1,      
CustLoc.LocationszAddress_2,      
CustLoc.LocationszDistrict,      
CustLoc.LocationszCity,      
CustLoc.LocationszZipcode,      
CustLoc.LocationszState,      
CustLoc.LocationszCountry,      
CustLoc.LocationszPhoneNo_1,      
CustLoc.LocationszPhoneNo_2,      
CustLoc.LocationszFaxNo,      
CustLoc.LocationszMobileNo,      
CustLoc.LocationszEmail,      
CustLoc.LocationszWebSite,      

BOS_SD_FSo.decAmount,      
BOS_SD_FSo.decTax,      

BOS_SD_FSo.szCcyId,      
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat_J,      

BOS_SD_FSo.szCcyRateId,      
BOS_SD_FSo.decCcyRate,      

BOS_SD_FSo.szFInvoiceId,      
ART.bClosed AS bPaid_J,      

BOS_SD_FSo.szCompletedFInvoiceId,      
BOS_SD_FSo.szFirstCompletedFInvoiceId,      
COMPLETED_ART.bClosed AS bCompletedPaid_J,      

BOS_SD_FSo.bDropShip,      

BOS_SD_FSo.szSalesId,      
Sales.szName AS szSalesNm_J,      

BOS_SD_FSo.szSalesSupervisorId,      
BOS_SD_FSo.szSalesSupervisorId_2,      
BOS_SD_FSo.szSalesSupervisorId_3,      
BOS_SD_FSo.szSalesDivisionId,      
BOS_SD_FSo.szSalesDepartmentId,      
BOS_SD_FSo.szSalesTeamId,      

BOS_SD_FSo.szStatus,      
BOS_SD_FSo.decDownPayment,      

BOS_SD_FSo.szRemark,      
BOS_SD_FSo.szLatitude,      
BOS_SD_FSo.szLongitude,      

BOS_SD_FSo.szCustPoId,      
BOS_SD_FSo.dtmCustPo,      

BOS_SD_FSo.bCash,      

BOS_SD_FSo.gdCreditLimitApprovedId,      
CreditLimitApproved.szApprovalId AS szCreditLimitApprovalId_J,      
CreditLimitApproved.bApproved AS bCreditLimitApproved_J,      

BOS_SD_FSo.bNeedFInvoice,      

BOS_SD_TOTracking.szTOTrackingId AS szTOTrackingId_J,      

--Customer's collection info      
BSR.szRouteId AS szCollRouteId,      
BSR.szDescription AS szCollRouteDescription,      
BSR.szOpUserId AS szCollectorId,      
BPE.szName AS szCollectorNm,      

BOS_SD_FSo.szPaymentTermId,      

BOS_SD_FSo.bResultFrTransfer,      
BOS_SD_FSo.bVoid,      
BOS_GEN_Approved.bApproved,      
BOS_SD_FSo.bApplied,      
BOS_GL_FJournalTrans.szFJournalId as bJournal,      
BOS_GL_FJournalTrans.bPosted,      
BOS_SD_FSo.btPrintedCount,      
BOS_SD_FSo.bTransferred,      
BOS_SD_FSo.szCompanyId,      
BOS_GL_Company.szName as szCompanyNm,      
BOS_SD_FSo.szWorkplaceId,      
BOS_GL_Workplace.szName as szWorkplaceNm,      
BOS_SD_FSo.szTaxEntityId,      
BOS_SD_FSo.bNeedApproval,      
BOS_GEN_Approved.gdApprovedId,      
BOS_GEN_Approved.szApprovalId,      
BOS_GL_FJournalTrans.szFJournalId,      

BOS_SD_FSo.dtmCreated,      
BOS_SD_FSo.bSystemCreated,      

BOS_SD_FSo.szUserId,      
BOS_SM_User.szName AS szUserNm_J,      

-- Data Status.      
BOS_SD_FSo.dtmLastUpdated,      
BOS_SD_FSo.bAlreadyTransferred,      

-- Weight and Volume      
BOS_SD_FSo.decTonase,      
BOS_SD_FSo.decCubication,      
BOS_SD_FSo.bUploadedFromMoDis,      
BOS_SD_FSo.szFDoReffId,    
BOS_SD_FSo.dtmStartVisit,    
BOS_SD_FSo.dtmEndVisit,    
BOS_SD_FSo.decVisitSpendTime,  
BOS_SD_FSo.bScanSuccess,  
BOS_SD_FSo.szScanFailReason  
FROM      
BOS_SD_FSo       
LEFT JOIN BOS_GEN_Approved AS CreditLimitApproved ON CreditLimitApproved.gdApprovedId = BOS_SD_FSo.gdCreditLimitApprovedId      
LEFT JOIN BOS_GEN_Approved ON BOS_SD_FSo.gdApprovedId = BOS_GEN_Approved.gdApprovedId      
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FSo.szFJournalId = BOS_GL_FJournalTrans.szFJournalId      

LEFT JOIN BOS_PI_Employee as Sales ON Sales.szEmployeeId = BOS_SD_FSo.szSalesId      

LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_FSo.szCustId      

LEFT JOIN BOS_AR_CustLocation CustLoc ON CustLoc.szCustId = BOS_AR_Customer.szDeliverToCustId      
AND CustLoc.btLocId = 0      

LEFT JOIN BOS_SD_TOTracking ON BOS_SD_TOTracking.szFSoId = BOS_SD_FSo.szFSoId      

LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FSo.szCompanyId      
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FSo.szWorkplaceId      

LEFT JOIN BOS_AR_Customer AS InvCust ON InvCust.szCustId = BOS_AR_Customer.szInvoiceToCustId      

--Allow to credit or not is based on original customer, not from invoice to customer.      
LEFT JOIN BOS_AR_CustSales AS CustSales ON CustSales.szCustId = BOS_AR_Customer.szCustId      

LEFT JOIN BOS_AR_Customer AS CollCust ON CollCust.szCustId = InvCust.szCollectToCustId      
LEFT JOIN BOS_SD_CustCollRoutine AS BSCCR ON BSCCR.szCustId = CollCust.szCustId      
LEFT JOIN BOS_SD_Route AS BSR ON BSR.szRouteId = BSCCR.szDefaultRouteId      
LEFT JOIN BOS_PI_Employee AS BPE ON BPE.szEmployeeId = BSR.szOpUserId      
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FSo.szCcyId      
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FSo.szUserId      

LEFT JOIN BOS_AR_ArTrans AS ART ON ART.szTrnId = 'FInv' and ART.szDocId = BOS_SD_FSo.szFInvoiceId      

LEFT JOIN BOS_AR_ArTrans AS COMPLETED_ART ON COMPLETED_ART.szTrnId = 'FInv'      
AND COMPLETED_ART.szDocId = BOS_SD_FSo.szCompletedFInvoiceId      

LEFT JOIN BOS_INV_OrderType ON BOS_INV_OrderType.szOrderTypeId = BOS_SD_FSo.szOrderTypeId      

WHERE      
BOS_SD_FSo.szFSoId = p_szFSoId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetFSo_013(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT        
BOS_SD_FSo.szFSoId,        
BOS_SD_FSo.szSalesOrgId,        

BOS_SD_FSo.szOrderTypeId,        
BOS_INV_OrderType.bAllowManualPrice AS bOrderTypeAllowManualPrice_J,        
BOS_INV_OrderType.bAllowToChangeLinePriceDate AS bOrderTypeAllowToChangeLinePriceDate_J,        

BOS_SD_FSo.dtmOrder,        
BOS_SD_FSo.dtmPrice,        

BOS_SD_FSo.szCustId,        
BOS_AR_Customer.szName as szCustNm_J,        
CustSales.bAllowToCredit AS bCustAllowToCredit_J,        

CustLoc.LocationszContactPerson,        
CustLoc.LocationszRoomNo,        
CustLoc.LocationszFloor,        
CustLoc.LocationszBuilding,        
CustLoc.LocationszAddress_1,        
CustLoc.LocationszAddress_2,        
CustLoc.LocationszDistrict,        
CustLoc.LocationszCity,        
CustLoc.LocationszZipcode,        
CustLoc.LocationszState,        
CustLoc.LocationszCountry,        
CustLoc.LocationszPhoneNo_1,        
CustLoc.LocationszPhoneNo_2,        
CustLoc.LocationszFaxNo,        
CustLoc.LocationszMobileNo,        
CustLoc.LocationszEmail,        
CustLoc.LocationszWebSite,        

BOS_SD_FSo.decAmount,        
BOS_SD_FSo.decTax,        

BOS_SD_FSo.szCcyId,        
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat_J,        

BOS_SD_FSo.szCcyRateId,        
BOS_SD_FSo.decCcyRate,        

BOS_SD_FSo.szFInvoiceId,        
ART.bClosed AS bPaid_J,        

BOS_SD_FSo.szCompletedFInvoiceId,        
BOS_SD_FSo.szFirstCompletedFInvoiceId,        
COMPLETED_ART.bClosed AS bCompletedPaid_J,        

BOS_SD_FSo.bDropShip,        

BOS_SD_FSo.szSalesId,        
Sales.szName AS szSalesNm_J,        

BOS_SD_FSo.szSalesSupervisorId,        
BOS_SD_FSo.szSalesSupervisorId_2,        
BOS_SD_FSo.szSalesSupervisorId_3,        
BOS_SD_FSo.szSalesDivisionId,        
BOS_SD_FSo.szSalesDepartmentId,        
BOS_SD_FSo.szSalesTeamId,        

BOS_SD_FSo.szStatus,        
BOS_SD_FSo.decDownPayment,        

BOS_SD_FSo.szRemark,        
BOS_SD_FSo.szLatitude,        
BOS_SD_FSo.szLongitude,        

BOS_SD_FSo.szCustPoId,        
BOS_SD_FSo.dtmCustPo,        

BOS_SD_FSo.bCash,        

BOS_SD_FSo.gdCreditLimitApprovedId,        
CreditLimitApproved.szApprovalId AS szCreditLimitApprovalId_J,        
CreditLimitApproved.bApproved AS bCreditLimitApproved_J,        

BOS_SD_FSo.bNeedFInvoice,        

BOS_SD_TOTracking.szTOTrackingId AS szTOTrackingId_J,        

--Customer's collection info        
BSR.szRouteId AS szCollRouteId,        
BSR.szDescription AS szCollRouteDescription,        
BSR.szOpUserId AS szCollectorId,        
BPE.szName AS szCollectorNm,        

BOS_SD_FSo.szPaymentTermId,        

BOS_SD_FSo.bResultFrTransfer,        
BOS_SD_FSo.bVoid,        
BOS_GEN_Approved.bApproved,        
BOS_SD_FSo.bApplied,        
BOS_GL_FJournalTrans.szFJournalId as bJournal,        
BOS_GL_FJournalTrans.bPosted,        
BOS_SD_FSo.btPrintedCount,        
BOS_SD_FSo.bTransferred,        
BOS_SD_FSo.szCompanyId,        
BOS_GL_Company.szName as szCompanyNm,        
BOS_SD_FSo.szWorkplaceId,        
BOS_GL_Workplace.szName as szWorkplaceNm,        
BOS_SD_FSo.szTaxEntityId,        
BOS_SD_FSo.bNeedApproval,        
BOS_GEN_Approved.gdApprovedId,        
BOS_GEN_Approved.szApprovalId,        
BOS_GL_FJournalTrans.szFJournalId,        

BOS_SD_FSo.dtmCreated,        
BOS_SD_FSo.bSystemCreated,        

BOS_SD_FSo.szUserId,        
BOS_SM_User.szName AS szUserNm_J,        

-- Data Status.        
BOS_SD_FSo.dtmLastUpdated,        
BOS_SD_FSo.bAlreadyTransferred,        

-- Weight and Volume        
BOS_SD_FSo.decTonase,        
BOS_SD_FSo.decCubication,        
BOS_SD_FSo.bUploadedFromMoDis,        
BOS_SD_FSo.szFDoReffId,      
BOS_SD_FSo.dtmStartVisit,      
BOS_SD_FSo.dtmEndVisit,      
BOS_SD_FSo.decVisitSpendTime,
BOS_SD_FSo.decJourneySpendTime,    
BOS_SD_FSo.bScanSuccess,    
BOS_SD_FSo.szScanFailReason,
BOS_SD_FSo.szBarcodeScanFailReason,
BOS_SD_FSo.AdcId,
BOS_SD_FSo.dtmExpiration
FROM        
BOS_SD_FSo         
LEFT JOIN BOS_GEN_Approved AS CreditLimitApproved ON CreditLimitApproved.gdApprovedId = BOS_SD_FSo.gdCreditLimitApprovedId        
LEFT JOIN BOS_GEN_Approved ON BOS_SD_FSo.gdApprovedId = BOS_GEN_Approved.gdApprovedId        
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FSo.szFJournalId = BOS_GL_FJournalTrans.szFJournalId        

LEFT JOIN BOS_PI_Employee as Sales ON Sales.szEmployeeId = BOS_SD_FSo.szSalesId        

LEFT JOIN BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_FSo.szCustId        

LEFT JOIN BOS_AR_CustLocation CustLoc ON CustLoc.szCustId = BOS_AR_Customer.szDeliverToCustId        
AND CustLoc.btLocId = 0        

LEFT JOIN BOS_SD_TOTracking ON BOS_SD_TOTracking.szFSoId = BOS_SD_FSo.szFSoId        

LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FSo.szCompanyId        
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FSo.szWorkplaceId        

LEFT JOIN BOS_AR_Customer AS InvCust ON InvCust.szCustId = BOS_AR_Customer.szInvoiceToCustId        

--Allow to credit or not is based on original customer, not from invoice to customer.        
LEFT JOIN BOS_AR_CustSales AS CustSales ON CustSales.szCustId = BOS_AR_Customer.szCustId        

LEFT JOIN BOS_AR_Customer AS CollCust ON CollCust.szCustId = InvCust.szCollectToCustId        
LEFT JOIN BOS_SD_CustCollRoutine AS BSCCR ON BSCCR.szCustId = CollCust.szCustId        
LEFT JOIN BOS_SD_Route AS BSR ON BSR.szRouteId = BSCCR.szDefaultRouteId        
LEFT JOIN BOS_PI_Employee AS BPE ON BPE.szEmployeeId = BSR.szOpUserId        
LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_SD_FSo.szCcyId        
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FSo.szUserId        

LEFT JOIN BOS_AR_ArTrans AS ART ON ART.szTrnId = 'FInv' and ART.szDocId = BOS_SD_FSo.szFInvoiceId        

LEFT JOIN BOS_AR_ArTrans AS COMPLETED_ART ON COMPLETED_ART.szTrnId = 'FInv'        
AND COMPLETED_ART.szDocId = BOS_SD_FSo.szCompletedFInvoiceId        

LEFT JOIN BOS_INV_OrderType ON BOS_INV_OrderType.szOrderTypeId = BOS_SD_FSo.szOrderTypeId        

WHERE        
BOS_SD_FSo.szFSoId = p_szFSoId


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetFSoItem(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_SD_FSoItem.shItemNumber,

BOS_SD_FSoItem.szOrderItemTypeId,
BOS_INV_OrderItemType.bTaxable as bOrderItemTypeTaxable_J,
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,
BOS_INV_OrderItemType.szRentChargeCalcId AS szOrderItemTypeRentChargeCalcId_J,
BOS_INV_OrderItemType.bSubjectToInvoice AS bOrderItemTypeSubjectToInvoice_J,

BOS_SD_FSoItem.szProductId,

BOS_INV_Product.szName as szProductName_J,
BOS_INV_Product.szNickName as szProductNickName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,
BOS_GL_TaxType.decRate as decProductTaxRate_J,
BOS_INV_Product.szDiscountGroupId AS szProductDiscGroupId_J
, isnull(BGWP.szDiscountGroupId, '') AS szProductDiscGroupId_J_wp

, BOS_SD_FSoItem.szPriceId,
BOS_SD_FSoItem.szPriceOrderId,
BOS_SD_FSoItem.decDiscProcent,

BOS_SD_FSoItem.dtmPriceDate,

BOS_SD_FSoItem.decQty,
BOS_SD_FSoItem.decUomQty,

BOS_SD_FSoItem.szUomId,
BOS_SD_FSoItem.decPrice,
BOS_SD_FSoItem.decDiscount,
BOS_SD_FSoItem.bTaxable,
BOS_SD_FSoItem.decTax,
BOS_SD_FSoItem.decAmount,
BOS_SD_FSoItem.decDPP,
BOS_SD_FSoItem.szPaymentType,
BOS_SD_FSoItem.szPrincipalDiscRefId,
PrDiscRef.szDescription as szPrincipalDiscRefDesc_J,

BOS_INV_OrderItemType.bMustFillTrnReason AS bOrderItemTypeMustFillTrnReason_J,
BOS_INV_OrderItemType.bAllowEmptyTrnReason AS bOrderItemTypeAllowEmptyTrnReason_J,
BOS_INV_OrderItemType.bAllowDifferentSignInQty AS bOrderItemTypeAllowDifferentSignInQty_J,

-- Cubication and Tonase
BOS_SD_FSoItem.decTonase,
BOS_SD_FSoItem.decCubication,

BOS_SD_FSoItem.szParentId,
parent.szName AS szParentNm_J,

BOS_AR_CustomerProductItem.szRefProductId AS szCustProductId_J,
BOS_AR_CustomerProductItem.szRefProductName AS szCustProductNm_J


FROM 
BOS_SD_FSoItem 
LEFT JOIN BOS_SD_FSo AS BSF ON BSF.szFSoId = BOS_SD_FSoItem.szFSoId
left join BOS_INV_Product on BOS_SD_FSoItem.szProductId = BOS_INV_Product.szProductId
left join BOS_INV_Product AS parent on BOS_SD_FSoItem.szParentId = parent.szProductId
left join BOS_GL_TaxType on BOS_INV_Product.szTaxTypeId = BOS_GL_TaxType.szTaxTypeId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_SD_FSoItem.szOrderItemTypeId
left join BOS_SD_OrgStru_PrincipalDiscRef as PrDiscRef on PrDiscRef.szPrincipalDiscRefId = BOS_SD_FSoItem.szPrincipalDiscRefId
LEFT JOIN BOS_SD_FSo ON BOS_SD_FSo.szFSoId = BOS_SD_FSoItem.szFSoId	
LEFT JOIN BOS_AR_CustomerProductItem ON BOS_AR_CustomerProductItem.szCustId = BOS_SD_FSo.szCustId 
AND BOS_AR_CustomerProductItem.szProductId = BOS_SD_FSoItem.szProductId
LEFT JOIN BOS_GL_WorkplaceProduct AS BGWP ON BGWP.szWorkplaceId = BSF.szWorkplaceId
AND BGWP.szProductId = BOS_SD_FSoItem.szProductId

WHERE 
BOS_SD_FSoItem.szFSoId = p_szFSoId

ORDER BY
BOS_SD_FSoItem.shItemNumber

-- ==================================================================

set ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetFSoItem_014(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_SD_FSoItem.shItemNumber,

BOS_SD_FSoItem.szOrderItemTypeId,
BOS_INV_OrderItemType.bTaxable as bOrderItemTypeTaxable_J,
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,
BOS_INV_OrderItemType.szRentChargeCalcId AS szOrderItemTypeRentChargeCalcId_J,
BOS_INV_OrderItemType.bSubjectToInvoice AS bOrderItemTypeSubjectToInvoice_J,

BOS_SD_FSoItem.szProductId,

BOS_INV_Product.szName as szProductName_J,
BOS_INV_Product.szNickName as szProductNickName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,
BOS_GL_TaxType.decRate as decProductTaxRate_J,
BOS_INV_Product.szDiscountGroupId AS szProductDiscGroupId_J
, isnull(BGWP.szDiscountGroupId, '') AS szProductDiscGroupId_J_wp

, BOS_SD_FSoItem.szPriceId,
BOS_SD_FSoItem.szPriceOrderId,
BOS_SD_FSoItem.decDiscProcent,

BOS_SD_FSoItem.dtmPriceDate,

BOS_SD_FSoItem.decQty,
BOS_SD_FSoItem.decUomQty,

BOS_SD_FSoItem.szUomId,
BOS_SD_FSoItem.decPrice,
BOS_SD_FSoItem.decDiscount,
BOS_SD_FSoItem.bTaxable,
BOS_SD_FSoItem.decTax,
BOS_SD_FSoItem.decAmount,
BOS_SD_FSoItem.decDPP,
BOS_SD_FSoItem.szPaymentType,
BOS_SD_FSoItem.szPrincipalDiscRefId,
PrDiscRef.szDescription as szPrincipalDiscRefDesc_J,

BOS_INV_OrderItemType.bMustFillTrnReason AS bOrderItemTypeMustFillTrnReason_J,
BOS_INV_OrderItemType.bAllowEmptyTrnReason AS bOrderItemTypeAllowEmptyTrnReason_J,
BOS_INV_OrderItemType.bAllowDifferentSignInQty AS bOrderItemTypeAllowDifferentSignInQty_J,

-- Cubication and Tonase
BOS_SD_FSoItem.decTonase,
BOS_SD_FSoItem.decCubication,

BOS_SD_FSoItem.szParentId,
parent.szName AS szParentNm_J,

BOS_AR_CustomerProductItem.szRefProductId AS szCustProductId_J,
BOS_AR_CustomerProductItem.szRefProductName AS szCustProductNm_J


FROM 
BOS_SD_FSoItem 
LEFT JOIN BOS_SD_FSo AS BSF ON BSF.szFSoId = BOS_SD_FSoItem.szFSoId
left join BOS_INV_Product on BOS_SD_FSoItem.szProductId = BOS_INV_Product.szProductId
left join BOS_INV_Product AS parent on BOS_SD_FSoItem.szParentId = parent.szProductId
left join BOS_GL_TaxType on BOS_INV_Product.szTaxTypeId = BOS_GL_TaxType.szTaxTypeId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_SD_FSoItem.szOrderItemTypeId
left join BOS_SD_OrgStru_PrincipalDiscRef as PrDiscRef on PrDiscRef.szPrincipalDiscRefId = BOS_SD_FSoItem.szPrincipalDiscRefId
LEFT JOIN BOS_SD_FSo ON BOS_SD_FSo.szFSoId = BOS_SD_FSoItem.szFSoId    
LEFT JOIN BOS_AR_CustomerProductItem ON BOS_AR_CustomerProductItem.szCustId = BOS_SD_FSo.szCustId 
AND BOS_AR_CustomerProductItem.szProductId = BOS_SD_FSoItem.szProductId
LEFT JOIN BOS_GL_WorkplaceProduct AS BGWP ON BGWP.szWorkplaceId = BSF.szWorkplaceId
AND BGWP.szProductId = BOS_SD_FSoItem.szProductId

WHERE 
BOS_SD_FSoItem.szFSoId = p_szFSoId

ORDER BY
BOS_SD_FSoItem.shItemNumber

-- ==================================================================

set ANSI_NULLS ON


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetFSoItem_015(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_SD_FSoItem.shItemNumber,

BOS_SD_FSoItem.szOrderItemTypeId,
BOS_INV_OrderItemType.bTaxable as bOrderItemTypeTaxable_J,
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,
BOS_INV_OrderItemType.szRentChargeCalcId AS szOrderItemTypeRentChargeCalcId_J,
BOS_INV_OrderItemType.bSubjectToInvoice AS bOrderItemTypeSubjectToInvoice_J,

BOS_SD_FSoItem.szProductId,

BOS_INV_Product.szName as szProductName_J,
BOS_INV_Product.szNickName as szProductNickName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,
BOS_GL_TaxType.decRate as decProductTaxRate_J,
BOS_INV_Product.szDiscountGroupId AS szProductDiscGroupId_J
, isnull(BGWP.szDiscountGroupId, '') AS szProductDiscGroupId_J_wp

, BOS_SD_FSoItem.szPriceId,
BOS_SD_FSoItem.szPriceOrderId,
BOS_SD_FSoItem.decDiscProcent,

BOS_SD_FSoItem.dtmPriceDate,

BOS_SD_FSoItem.decQty,
BOS_SD_FSoItem.decUomQty,

BOS_SD_FSoItem.szUomId,
BOS_SD_FSoItem.decPrice,
BOS_SD_FSoItem.decDiscount,
BOS_SD_FSoItem.bTaxable,
BOS_SD_FSoItem.decTax,
BOS_SD_FSoItem.decAmount,
BOS_SD_FSoItem.decDPP,
BOS_SD_FSoItem.szPaymentType,
BOS_SD_FSoItem.szPrincipalDiscRefId,
PrDiscRef.szDescription as szPrincipalDiscRefDesc_J,

BOS_INV_OrderItemType.bMustFillTrnReason AS bOrderItemTypeMustFillTrnReason_J,
BOS_INV_OrderItemType.bAllowEmptyTrnReason AS bOrderItemTypeAllowEmptyTrnReason_J,
BOS_INV_OrderItemType.bAllowDifferentSignInQty AS bOrderItemTypeAllowDifferentSignInQty_J,

-- Cubication and Tonase
BOS_SD_FSoItem.decTonase,
BOS_SD_FSoItem.decCubication,

BOS_SD_FSoItem.szParentId,
parent.szName AS szParentNm_J,

BOS_AR_CustomerProductItem.szRefProductId AS szCustProductId_J,
BOS_AR_CustomerProductItem.szRefProductName AS szCustProductNm_J,

BOS_SD_FSoItem.szDistProductId,  
BOS_SD_FSoItem.decDistQty,  
BOS_SD_FSoItem.decDistPrice  

FROM 
BOS_SD_FSoItem 
LEFT JOIN BOS_SD_FSo AS BSF ON BSF.szFSoId = BOS_SD_FSoItem.szFSoId
left join BOS_INV_Product on BOS_SD_FSoItem.szProductId = BOS_INV_Product.szProductId
left join BOS_INV_Product AS parent on BOS_SD_FSoItem.szParentId = parent.szProductId
left join BOS_GL_TaxType on BOS_INV_Product.szTaxTypeId = BOS_GL_TaxType.szTaxTypeId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_SD_FSoItem.szOrderItemTypeId
left join BOS_SD_OrgStru_PrincipalDiscRef as PrDiscRef on PrDiscRef.szPrincipalDiscRefId = BOS_SD_FSoItem.szPrincipalDiscRefId
LEFT JOIN BOS_SD_FSo ON BOS_SD_FSo.szFSoId = BOS_SD_FSoItem.szFSoId    
LEFT JOIN BOS_AR_CustomerProductItem ON BOS_AR_CustomerProductItem.szCustId = BOS_SD_FSo.szCustId 
AND BOS_AR_CustomerProductItem.szProductId = BOS_SD_FSoItem.szProductId
LEFT JOIN BOS_GL_WorkplaceProduct AS BGWP ON BGWP.szWorkplaceId = BSF.szWorkplaceId
AND BGWP.szProductId = BOS_SD_FSoItem.szProductId

WHERE 
BOS_SD_FSoItem.szFSoId = p_szFSoId

ORDER BY
BOS_SD_FSoItem.shItemNumber


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetFSoItem_016(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_SD_FSoItem.shItemNumber,

BOS_SD_FSoItem.szOrderItemTypeId,
BOS_INV_OrderItemType.bTaxable AS bOrderItemTypeTaxable_J,
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,
BOS_INV_OrderItemType.szRentChargeCalcId AS szOrderItemTypeRentChargeCalcId_J,
BOS_INV_OrderItemType.bSubjectToInvoice AS bOrderItemTypeSubjectToInvoice_J,

BOS_SD_FSoItem.szProductId,

BOS_INV_Product.szName AS szProductName_J,
BOS_INV_Product.szNickName AS szProductNickName_J,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,
BOS_GL_TaxType.decRate AS decProductTaxRate_J,
BOS_INV_Product.szDiscountGroupId AS szProductDiscGroupId_J
, ISNULL(BGWP.szDiscountGroupId, '') AS szProductDiscGroupId_J_wp

, BOS_SD_FSoItem.szPriceId,
BOS_SD_FSoItem.szPriceOrderId,
BOS_SD_FSoItem.decDiscProcent,

BOS_SD_FSoItem.dtmPriceDate,

BOS_SD_FSoItem.decQty,
BOS_SD_FSoItem.decUomQty,

BOS_SD_FSoItem.szUomId,
BOS_SD_FSoItem.decPrice,
BOS_SD_FSoItem.decDiscount,
BOS_SD_FSoItem.bTaxable,
BOS_SD_FSoItem.decTax,
BOS_SD_FSoItem.decAmount,
BOS_SD_FSoItem.decDPP,
BOS_SD_FSoItem.szPaymentType,
BOS_SD_FSoItem.szPrincipalDiscRefId,
ISNULL(PrDiscRef.szDescription,'') AS szPrincipalDiscRefDesc_J,

BOS_INV_OrderItemType.bMustFillTrnReason AS bOrderItemTypeMustFillTrnReason_J,
BOS_INV_OrderItemType.bAllowEmptyTrnReason AS bOrderItemTypeAllowEmptyTrnReason_J,
BOS_INV_OrderItemType.bAllowDifferentSignInQty AS bOrderItemTypeAllowDifferentSignInQty_J,

-- Cubication and Tonase
BOS_SD_FSoItem.decTonase,
BOS_SD_FSoItem.decCubication,

BOS_SD_FSoItem.szParentId,
ISNULL(parent.szName,'') AS szParentNm_J,

ISNULL(BOS_AR_CustomerProductItem.szRefProductId,'') AS szCustProductId_J,
ISNULL(BOS_AR_CustomerProductItem.szRefProductName,'') AS szCustProductNm_J,

BOS_SD_FSoItem.szDistProductId,  
BOS_SD_FSoItem.decDistQty,  
BOS_SD_FSoItem.decDistPrice,

BOS_SD_FSoItem.szBudgetId,  
BOS_SD_FSoItem.decPrincipalCostAmount,
BOS_SD_FSoItem.decPrincipalCostQty,
BOS_SD_FSoItem.bBudgetTransferred
FROM 
BOS_SD_FSoItem 
LEFT JOIN BOS_SD_FSo AS BSF ON BSF.szFSoId = BOS_SD_FSoItem.szFSoId
LEFT JOIN BOS_INV_Product ON BOS_SD_FSoItem.szProductId = BOS_INV_Product.szProductId
LEFT JOIN BOS_INV_Product AS parent ON BOS_SD_FSoItem.szParentId = parent.szProductId
LEFT JOIN BOS_GL_TaxType ON BOS_INV_Product.szTaxTypeId = BOS_GL_TaxType.szTaxTypeId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_SD_FSoItem.szOrderItemTypeId
LEFT JOIN BOS_SD_OrgStru_PrincipalDiscRef AS PrDiscRef ON PrDiscRef.szPrincipalDiscRefId = BOS_SD_FSoItem.szPrincipalDiscRefId
LEFT JOIN BOS_SD_FSo ON BOS_SD_FSo.szFSoId = BOS_SD_FSoItem.szFSoId    
LEFT JOIN BOS_AR_CustomerProductItem ON BOS_AR_CustomerProductItem.szCustId = BOS_SD_FSo.szCustId 
AND BOS_AR_CustomerProductItem.szProductId = BOS_SD_FSoItem.szProductId
LEFT JOIN BOS_GL_WorkplaceProduct AS BGWP ON BGWP.szWorkplaceId = BSF.szWorkplaceId
AND BGWP.szProductId = BOS_SD_FSoItem.szProductId

WHERE 
BOS_SD_FSoItem.szFSoId = p_szFSoId

ORDER BY
BOS_SD_FSoItem.shItemNumber



END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetFSoItemBonusSource(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId,

FROM 
BOS_SD_FSoItemBonusSource
WHERE 
szFSoId = p_szFSoId and shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetFSoItemBonusSource_014(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId,

FROM 
BOS_SD_FSoItemBonusSource
WHERE 
szFSoId = p_szFSoId and shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetFSoItemDelivery(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN

SELECT	
BOS_SD_FSoItemDelivery.dtmDelivery,

BOS_SD_FSoItemDelivery.szCustId,
CustLoc.szCustDeliveryNm AS szCustNm_J,

BOS_SD_FSoItemDelivery.decQty,

BOS_SD_FSoItemDelivery.szFromWpId,
Wp.szName AS szFromWpNm_J,

BOS_SD_FSoItemDelivery.szDjrTrackingId,
BOS_SD_DjrTracking.bFinished AS bDjrTrackingFinish_J,

BOS_SD_FSoItemDelivery.szFDoId,
BOS_SD_FSoItemDelivery.decRemainingQty,

DO.dtmDelivery AS dtmActualDelivery_J

FROM  
BOS_SD_FSoItemDelivery
LEFT JOIN BOS_AR_CustLocation AS CustLoc ON CustLoc.szCustId = BOS_SD_FSoItemDelivery.szCustId
AND CustLoc.btLocId = 0

LEFT JOIN BOS_GL_Workplace AS Wp ON Wp.szWorkplaceId = BOS_SD_FSoItemDelivery.szFromWpId

LEFT JOIN BOS_SD_FDo AS DO ON DO.szDoId = BOS_SD_FSoItemDelivery.szFDoId
AND DO.bApplied = 1

LEFT JOIN BOS_SD_DjrTracking ON BOS_SD_DjrTracking.szDjrTrackingId = BOS_SD_FSoItemDelivery.szDjrTrackingId

WHERE
BOS_SD_FSoItemDelivery.szFSoId = p_szFSoId and 
BOS_SD_FSoItemDelivery.shItemNumber = p_shItemNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetFSoItemReason(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FSoItemReason.szReasonId,
BOS_GEN_Reason.szDescription AS szReasonDesc_J,
BOS_SD_FSoItemReason.decQty

FROM 
BOS_SD_FSoItemReason
WHERE 
BOS_SD_FSoItemReason.szFSoId = p_szFSoId AND BOS_SD_FSoItemReason.shItemNumber = p_shItemNumber /** HELPER 1,2,3 and more STORE PROCEDURE **/ set ANSI_NULLS ON ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetFSoProductDepositBonusItem(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FSoProductDepositBonusItem.shItemNumber,

BOS_SD_FSoProductDepositBonusItem.szProductId,

BOS_INV_Product.szName as szProductName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,

BOS_SD_FSoProductDepositBonusItem.decQty,
BOS_SD_FSoProductDepositBonusItem.szUomId,
BOS_SD_FSoProductDepositBonusItem.szOrderItemTypeId,

BOS_SD_FSoProductDepositBonusItem.bGenByTotal


FROM 
BOS_SD_FSoProductDepositBonusItem
left join BOS_INV_Product on BOS_SD_FSoProductDepositBonusItem.szProductId = BOS_INV_Product.szProductId

WHERE 
BOS_SD_FSoProductDepositBonusItem.szFSoId = p_szFSoId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetFSoProductDepositBonusItemBonusSource(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szProductId,

FROM 
BOS_SD_FSoProductDepositBonusItemBonusSource
WHERE 
szFSoId = p_szFSoId and shItemNumber = p_shItemNumber ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetListOfFCallOfFSo(
p_szFSoId BOS_DT_szId,
p_szCallType BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
FCall.szFCallId

FROM 
BOS_CRL_FCall as FCall
LEFT JOIN BOS_SD_TOTracking as TOTrackingLEFT JOIN BOS_SD_TOTracking as TOTracking;
on TOTracking.szTOTrackingId = FCall.szTrackingId and szCallType = p_szCallType
WHERE 
TOTracking.szFSoId = p_szFSoId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetListOfFSo()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSoId,
dtmOrder,
szCustId

FROM 
BOS_SD_FSo

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetListOfFSoWhereWorkplaceAndDate(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSoId


FROM 
BOS_SD_FSo

WHERE 
szWorkplaceId Like p_szWorkplaceId And dtmOrder >= p_dtmFrom And dtmOrder < DateAdd(Day, 1, p_dtmTo) ;ORDER BY 
szFSoId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetListOfPendingFSo(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_FSo.szFSoId, 
ISNULL(BOS_SD_TOTracking.szTOTrackingId, '') AS szTOTrackingId,
BOS_SD_FSo.dtmOrder,
ISNULL(BOS_SD_TOTracking.szSalesId, '') AS szSalesId,
BOS_SD_FSo.szCustId,
isnull(BOS_PI_Employee.szName,'') as szSalesNm,
isnull(BOS_AR_Customer.szName,'') as szCustNm,
BOS_SD_FSo.bApplied

from
BOS_SD_FSo
left join BOS_AR_Customer on BOS_AR_Customer.szCustId = BOS_SD_FSo.szCustId
LEFT JOIN BOS_AR_Customer AS InvCust ON InvCust.szCustId = BOS_AR_Customer.szInvoiceToCustId
LEFT JOIN BOS_SD_TOTracking ON BOS_SD_TOTracking.szFSoId = BOS_SD_FSo.szFSoId
left join BOS_PI_Employee on BOS_PI_Employee.szEmployeeId = BOS_SD_TOTracking.szSalesId

WHERE 
InvCust.szCustId = p_szCustId AND
BOS_SD_FSo.bApplied = 0 AND
BOS_SD_FSo.bVoid = 0

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetListOfUnAppliedFSo(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
DISTINCT BOS_SD_FSoItem.szFSoId as szFSoId
FROM
BOS_SD_FSoItem
LEFT JOIN BOS_SD_FSo on BOS_SD_FSo.szFSoId = BOS_SD_FSoItem.szFSoId
WHERE
BOS_SD_FSo.szWorkplaceId = p_szWorkplaceId AND
BOS_SD_FSo.bVoid = 0 AND BOS_SD_FSo.bApplied = 0 AND
dtmOrder >= p_dtmFrom AND dtmOrder < dateadd(day, 1, p_dtmTo)
--AND BOS_SD_FSo.szSalesId = p_szOpUserId
ELSE
SELECT
DISTINCT BOS_SD_FSoItem.szFSoId as szFSoId
FROM
BOS_SD_FSoItem
LEFT JOIN BOS_SD_FSo on BOS_SD_FSo.szFSoId = BOS_SD_FSoItem.szFSoId
WHERE
BOS_SD_FSo.szWorkplaceId = p_szWorkplaceId AND
BOS_SD_FSo.bVoid = 0 AND BOS_SD_FSo.bApplied = 0 AND
dtmOrder >= p_dtmFrom AND dtmOrder < dateadd(day, 1, p_dtmTo)
AND BOS_SD_FSo.szSalesId = p_szOpUserId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetListOfUnAppliedFSo_014(
p_szWorkplaceId BOS_DT_szId,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

IF p_szOpUserId = '%' --modified by arir, Bogor 2014-04-19
  THEN
SELECT
DISTINCT BOS_SD_FSoItem.szFSoId as szFSoId
FROM
BOS_SD_FSoItem
LEFT JOIN BOS_SD_FSo on BOS_SD_FSo.szFSoId = BOS_SD_FSoItem.szFSoId
WHERE
BOS_SD_FSo.szWorkplaceId = p_szWorkplaceId AND
BOS_SD_FSo.bVoid = 0 AND BOS_SD_FSo.bApplied = 0 AND
dtmOrder >= p_dtmFrom AND dtmOrder < dateadd(day, 1, p_dtmTo)
--AND BOS_SD_FSo.szSalesId = p_szOpUserId
ELSE
SELECT
DISTINCT BOS_SD_FSoItem.szFSoId as szFSoId
FROM
BOS_SD_FSoItem
LEFT JOIN BOS_SD_FSo on BOS_SD_FSo.szFSoId = BOS_SD_FSoItem.szFSoId
WHERE
BOS_SD_FSo.szWorkplaceId = p_szWorkplaceId AND
BOS_SD_FSo.bVoid = 0 AND BOS_SD_FSo.bApplied = 0 AND
dtmOrder >= p_dtmFrom AND dtmOrder < dateadd(day, 1, p_dtmTo)
AND BOS_SD_FSo.szSalesId = p_szOpUserId


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_GetListOfUnInvoicedFSo(
p_szInvToCustId BOS_DT_szId,
p_szCcyId BOS_DT_szSmallId,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN

SELECT DISTINCT
BOS_AR_Customer.szCustId,
BOS_SD_FSo.szFSoId,
BOS_SD_FSo.dtmOrder

FROM 
BOS_SD_FSo 
INNER JOIN BOS_AR_Customer on BOS_Ar_Customer.szCustId = BOS_SD_FSo.szCustId
--LEFT JOIN BOS_SD_FSoItem ON BOS_SD_FSoItem.szFSoId = BOS_SD_FSo.szFSoId
--LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_SD_FSoItem.szOrderItemTypeId

WHERE
BOS_SD_FSo.szCompletedFInvoiceId = '' and 
BOS_SD_FSo.bApplied = 1 and 
(
(BOS_AR_Customer.bInvoiceToCust = 1  and BOS_AR_Customer.szCustId = p_szInvToCustId)  or  
(BOS_AR_Customer.bInvoiceToCust = 0  and  BOS_AR_Customer.szInvoiceToCustId = p_szInvToCustId)
)
and
BOS_SD_FSo.dtmOrder < DateAdd(Day, 1, p_dtmEnd) and
BOS_SD_FSo.dtmOrder >= p_dtmStart AND
BOS_SD_FSo.szCcyId = p_szCcyId AND
BOS_SD_FSo.szStatus = 'CLO'	--CLO = closed.
AND
(
--
--  Previously DO cannot recalculate separate discount / bonus if it is created from SO becoz we think it is
--  too complicated. However by fulfilling requirement from SNS, it turns out that the process is not really 
--  that hard.
--
--  This makes there's no need to invoice the SO directly. In fact if we still do so, it would make the process
--  becoming very very complicated becoz we have to match the adjusted separate discount / bonus in two different
--  process. That is we have to match those separate items with their pair items in SO.
--
--  If now DO can adjust this separate discount / bonus, invoice can work directly to DO, regardless it comes
--  from SO or not, and FORGET THE DIRECT-SO-INVOICING PROCESS COMPLETELY.
--
--  THIS IS VERY BEUTIFUL.
--

--  This obsolete code is still maintained here for easy reference (and I cannot connect to SS right now).

----There is item that is not be included in the DO but to the invoice directly,
----such discount to reduce the amount to be paid.
--(BOS_INV_OrderItemType.bSubjectToInvoice = 1 AND BOS_SD_FSoItem.szProductId = '')
--OR
----Down payment that must be included in the invoice to reduce the amount.
(BOS_SD_FSo.decDownPayment > 0)
)

ORDER BY 
BOS_AR_Customer.szCustId,
BOS_SD_FSo.dtmOrder,
BOS_SD_FSo.szFSoId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_IsFSoExist(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFSoId

FROM 
BOS_SD_FSo
WHERE 
szFSoId = p_szFSoId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_LockFSo(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSo
SET 
dtmPrice = dtmPrice
WHERE 
szFSoId = p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_MarkFSoCompletedInvoiced(
p_szFSoId BOS_DT_szId,
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSo
SET 
szCompletedFInvoiceId = p_szFInvoiceId
WHERE 
szFSoId = p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_MarkFSoCompletedInvoiced_013(
p_szFSoId BOS_DT_szId,
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSo
SET 
szCompletedFInvoiceId = p_szFInvoiceId
WHERE 
szFSoId = p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_MarkFSoFirstCompletedInvoiced(
p_szFSoId BOS_DT_szId,
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSo
SET 
szFirstCompletedFInvoiceId = p_szFInvoiceId

WHERE 
szFSoId = p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_MarkFSoFirstCompletedInvoiced_013(
p_szFSoId BOS_DT_szId,
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSo
SET 
szFirstCompletedFInvoiceId = p_szFInvoiceId

WHERE 
szFSoId = p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_MarkFSoInvoiced(
p_szFSoId BOS_DT_szId,
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSo
SET 
szFInvoiceId = p_szFInvoiceId
WHERE 
szFSoId = p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_MarkFSoInvoiced_013(
p_szFSoId BOS_DT_szId,
p_szFInvoiceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSo
SET 
szFInvoiceId = p_szFInvoiceId
WHERE 
szFSoId = p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_SetFSoStatus(
p_szFSoId BOS_DT_szId,
p_szStatus BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSo
SET 
szStatus = p_szStatus

WHERE 
szFSoId=p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_UnMarkFSoCompletedInvoiced(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSo
SET 
szCompletedFInvoiceId = ''
WHERE 
szFSoId = p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_UpdateCustIdOfFSo(
p_szFSoId BOS_DT_szId,
p_szNewCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSo
SET 
szCustId = p_szNewCustId
WHERE 
szFSoId = p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_UpdateFSo(
p_szFSoId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szOrderTypeId BOS_DT_szId,
p_dtmOrder timestamp,
p_dtmPrice timestamp,
p_szCustId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_decTax BOS_DT_decTax,
p_decDownPayment BOS_DT_decAmount,
p_szStatus BOS_DT_szSmallId,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_decCcyRate BOS_DT_decCcyRate,
p_bDropShip bit,
p_szSalesId BOS_DT_szId,
p_szSalesSupervisorId BOS_DT_szId,
p_szSalesSupervisorId_2 BOS_DT_szId,
p_szSalesSupervisorId_3 BOS_DT_szId,
p_szSalesDivisionId BOS_DT_szId,
p_szSalesDepartmentId BOS_DT_szId,
p_szSalesTeamId BOS_DT_szId,
p_szRemark BOS_DT_szMessage,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_szCustPoId BOS_DT_szId,
p_dtmCustPo timestamp,
p_bCash bit,
p_gdCreditLimitApprovedId bytea,
p_bNeedFInvoice smallint,
p_szPaymentTermId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId varchar,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_decTonase numeric,
p_decCubication numeric,
p_bUploadedFromMoDis BOS_DT_bBoolean,
p_szFDoReffId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_dtmStartVisit timestamp,
p_dtmEndVisit timestamp,
p_decVisitSpendTime BOS_DT_decAmount,
p_bScanSuccess smallint,
p_szScanFailReason BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSo
SET 
szSalesOrgId = p_szSalesOrgId,
szOrderTypeId = p_szOrderTypeId,

dtmOrder = p_dtmOrder,
dtmPrice = p_dtmPrice,

szCustId = p_szCustId,
decAmount = p_decAmount,
decTax = p_decTax,
decDownPayment = p_decDownPayment,
szStatus = p_szStatus,
szCcyId = p_szCcyId,
szCcyRateId = p_szCcyRateId,
decCcyRate = p_decCcyRate,
bDropShip = p_bDropShip,

szSalesId = p_szSalesId,
szSalesSupervisorId = p_szSalesSupervisorId,
szSalesSupervisorId_2 = p_szSalesSupervisorId_2,
szSalesSupervisorId_3 = p_szSalesSupervisorId_3,
szSalesDivisionId = p_szSalesDivisionId,
szSalesDepartmentId = p_szSalesDepartmentId,
szSalesTeamId = p_szSalesTeamId,

szRemark = p_szRemark,
szLatitude = p_szLatitude,
szLongitude = p_szLongitude,

szCustPoId = p_szCustPoId,
dtmCustPo = p_dtmCustPo,
bCash = p_bCash,
gdCreditLimitApprovedId = p_gdCreditLimitApprovedId,

bNeedFInvoice = p_bNeedFInvoice,

szPaymentTermId = p_szPaymentTermId,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId,

-- Weight and Volume
decTonase = p_decTonase,
decCubication = p_decCubication,
bUploadedFromMoDis = p_bUploadedFromMoDis,
szFDoReffId =p_szFDoReffId
, dtmLastUpdated = p_dtmLastUpdated,
dtmStartVisit = p_dtmStartVisit,
dtmEndVisit = p_dtmEndVisit,
decVisitSpendTime = p_decVisitSpendTime,
bScanSuccess =  p_bScanSuccess,
szScanFailReason = p_szScanFailReason

WHERE 
szFSoId = p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_UpdateFSo_013(
p_szFSoId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szOrderTypeId BOS_DT_szId,
p_dtmOrder timestamp,
p_dtmPrice timestamp,
p_szCustId BOS_DT_szId,
p_decAmount BOS_DT_decAmount,
p_decTax BOS_DT_decTax,
p_decDownPayment BOS_DT_decAmount,
p_szStatus BOS_DT_szSmallId,
p_szCcyId BOS_DT_szSmallId,
p_szCcyRateId BOS_DT_szMediumId,
p_decCcyRate BOS_DT_decCcyRate,
p_bDropShip bit,
p_szSalesId BOS_DT_szId,
p_szSalesSupervisorId BOS_DT_szId,
p_szSalesSupervisorId_2 BOS_DT_szId,
p_szSalesSupervisorId_3 BOS_DT_szId,
p_szSalesDivisionId BOS_DT_szId,
p_szSalesDepartmentId BOS_DT_szId,
p_szSalesTeamId BOS_DT_szId,
p_szRemark BOS_DT_szMessage,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_szCustPoId BOS_DT_szId,
p_dtmCustPo timestamp,
p_bCash bit,
p_gdCreditLimitApprovedId bytea,
p_bNeedFInvoice smallint,
p_szPaymentTermId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId varchar,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_decTonase numeric,
p_decCubication numeric,
p_bUploadedFromMoDis BOS_DT_bBoolean,
p_szFDoReffId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_dtmStartVisit timestamp,
p_dtmEndVisit timestamp,
p_decVisitSpendTime BOS_DT_decAmount,
p_decJourneySpendTime BOS_DT_decAmount,
p_bScanSuccess smallint,
p_szScanFailReason BOS_DT_szId,
p_szBarcodeScanFailReason BOS_DT_szId,
p_AdcId BOS_DT_szId,
p_dtmExpiration timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSo
SET 
szSalesOrgId = p_szSalesOrgId,
szOrderTypeId = p_szOrderTypeId,

dtmOrder = p_dtmOrder,
dtmPrice = p_dtmPrice,

szCustId = p_szCustId,
decAmount = p_decAmount,
decTax = p_decTax,
decDownPayment = p_decDownPayment,
szStatus = p_szStatus,
szCcyId = p_szCcyId,
szCcyRateId = p_szCcyRateId,
decCcyRate = p_decCcyRate,
bDropShip = p_bDropShip,

szSalesId = p_szSalesId,
szSalesSupervisorId = p_szSalesSupervisorId,
szSalesSupervisorId_2 = p_szSalesSupervisorId_2,
szSalesSupervisorId_3 = p_szSalesSupervisorId_3,
szSalesDivisionId = p_szSalesDivisionId,
szSalesDepartmentId = p_szSalesDepartmentId,
szSalesTeamId = p_szSalesTeamId,

szRemark = p_szRemark,
szLatitude = p_szLatitude,
szLongitude = p_szLongitude,

szCustPoId = p_szCustPoId,
dtmCustPo = p_dtmCustPo,
bCash = p_bCash,
gdCreditLimitApprovedId = p_gdCreditLimitApprovedId,

bNeedFInvoice = p_bNeedFInvoice,

szPaymentTermId = p_szPaymentTermId,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,
bNeedApproval = p_bNeedApproval,
gdApprovedId = p_gdApprovedId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId,

-- Weight and Volume
decTonase = p_decTonase,
decCubication = p_decCubication,
bUploadedFromMoDis = p_bUploadedFromMoDis,
szFDoReffId =p_szFDoReffId,
dtmLastUpdated = p_dtmLastUpdated,
dtmStartVisit = p_dtmStartVisit,
dtmEndVisit = p_dtmEndVisit,
decVisitSpendTime = p_decVisitSpendTime,
decJourneySpendTime=p_decJourneySpendTime,
bScanSuccess =  p_bScanSuccess,
szScanFailReason = p_szScanFailReason,
szBarcodeScanFailReason = p_szBarcodeScanFailReason,
AdcId = p_AdcId,
dtmExpiration = p_dtmExpiration
WHERE 
szFSoId = p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_UpdateFSoItem_ByItem(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_dtmPriceDate timestamp,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId,
p_decTonase numeric,
p_decCubication numeric,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSoItem
SET 
szOrderItemTypeId = p_szOrderItemTypeId,
szProductId = p_szProductId,

szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
decDiscProcent = p_decDiscProcent,

dtmPriceDate = p_dtmPriceDate,

decQty = p_decQty,
decUomQty = p_decUomQty,

szUomId = p_szUomId,
decPrice = p_decPrice,
decDiscount = p_decDiscount,
bTaxable = p_bTaxable,
decTax = p_decTax,
decAmount = p_decAmount,
decDPP = p_decDPP,
szPaymentType = p_szPaymentType,
szPrincipalDiscRefId = p_szPrincipalDiscRefId,

-- Cubication and Tonase
decTonase = p_decTonase,
decCubication = p_decCubication,

szParentId = p_szParentId
WHERE 
szFSoId = p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_UpdateFSoItem_ByItem_013(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_dtmPriceDate timestamp,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId,
p_decTonase numeric,
p_decCubication numeric,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSoItem
SET 
szOrderItemTypeId = p_szOrderItemTypeId,
szProductId = p_szProductId,

szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
decDiscProcent = p_decDiscProcent,

dtmPriceDate = p_dtmPriceDate,

decQty = p_decQty,
decUomQty = p_decUomQty,

szUomId = p_szUomId,
decPrice = p_decPrice,
decDiscount = p_decDiscount,
bTaxable = p_bTaxable,
decTax = p_decTax,
decAmount = p_decAmount,
decDPP = p_decDPP,
szPaymentType = p_szPaymentType,
szPrincipalDiscRefId = p_szPrincipalDiscRefId,

-- Cubication and Tonase
decTonase = p_decTonase,
decCubication = p_decCubication,

szParentId = p_szParentId
WHERE 
szFSoId = p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_UpdateFSoItem_ByItem_014(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_dtmPriceDate timestamp,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId,
p_decTonase numeric,
p_decCubication numeric,
p_szParentId BOS_DT_szId,
p_szDistProductId BOS_DT_szId,
p_decDistQty BOS_DT_decAmount,
p_decDistPrice BOS_DT_decPrice)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSoItem
SET 
szOrderItemTypeId = p_szOrderItemTypeId,
szProductId = p_szProductId,

szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
decDiscProcent = p_decDiscProcent,

dtmPriceDate = p_dtmPriceDate,

decQty = p_decQty,
decUomQty = p_decUomQty,

szUomId = p_szUomId,
decPrice = p_decPrice,
decDiscount = p_decDiscount,
bTaxable = p_bTaxable,
decTax = p_decTax,
decAmount = p_decAmount,
decDPP = p_decDPP,
szPaymentType = p_szPaymentType,
szPrincipalDiscRefId = p_szPrincipalDiscRefId,

-- Cubication and Tonase
decTonase = p_decTonase,
decCubication = p_decCubication,

szParentId = p_szParentId,

szDistProductId = p_szDistProductId,
decDistQty = p_decDistQty,
decDistPrice = p_decDistPrice

WHERE 
szFSoId = p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_UpdateFSoItem_ByItem_015(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_szOrderItemTypeId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_decDiscProcent BOS_DT_decPrice,
p_dtmPriceDate timestamp,
p_decQty BOS_DT_decAmount,
p_decUomQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_decPrice BOS_DT_decPrice,
p_decDiscount BOS_DT_decAmount,
p_bTaxable bit,
p_decTax BOS_DT_decTax,
p_decAmount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_szPaymentType BOS_DT_szSmallId,
p_szPrincipalDiscRefId BOS_DT_szId,
p_decTonase numeric,
p_decCubication numeric,
p_szParentId BOS_DT_szId,
p_szDistProductId BOS_DT_szId,
p_decDistQty BOS_DT_decAmount,
p_decDistPrice BOS_DT_decPrice,
p_szBudgetId BOS_DT_szId,
p_decPrincipalCostAmount BOS_DT_decAmount,
p_decPrincipalCostQty BOS_DT_decAmount,
p_bBudgetTransferred BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSoItem
SET 
szOrderItemTypeId = p_szOrderItemTypeId,
szProductId = p_szProductId,

szPriceId = p_szPriceId,
szPriceOrderId = p_szPriceOrderId,
decDiscProcent = p_decDiscProcent,

dtmPriceDate = p_dtmPriceDate,

decQty = p_decQty,
decUomQty = p_decUomQty,

szUomId = p_szUomId,
decPrice = p_decPrice,
decDiscount = p_decDiscount,
bTaxable = p_bTaxable,
decTax = p_decTax,
decAmount = p_decAmount,
decDPP = p_decDPP,
szPaymentType = p_szPaymentType,
szPrincipalDiscRefId = p_szPrincipalDiscRefId,

-- Cubication and Tonase
decTonase = p_decTonase,
decCubication = p_decCubication,

szParentId = p_szParentId,

szDistProductId = p_szDistProductId,
decDistQty = p_decDistQty,
decDistPrice = p_decDistPrice,

szBudgetId = p_szBudgetId,
decPrincipalCostAmount = p_decPrincipalCostAmount,
decPrincipalCostQty = p_decPrincipalCostQty,
bBudgetTransferred = p_bBudgetTransferred

WHERE 
szFSoId = p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_UpdateFSoItemBonusSource_ByItem(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szPaymentType BOS_DT_szSmallId,
p_decBonusAmount BOS_DT_decAmount,
p_decBonusQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSoItemBonusSource
SET 
decBonusAmount = p_decBonusAmount,
decBonusQty = p_decBonusQty
WHERE 
szFSoId = p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_UpdateFSoItemDelivery_ByItem(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_dtmDelivery timestamp,
p_szCustId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szFromWpId BOS_DT_szId,
p_szDjrTrackingId BOS_DT_szId,
p_szFDoId BOS_DT_szId,
p_decRemainingQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSoItemDelivery
SET 
decQty = p_decQty,
szDjrTrackingId = p_szDjrTrackingId,
szFDoId = p_szFDoId,
decRemainingQty = p_decRemainingQty

WHERE 
szFSoId = p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FSo_UpdateFSoItemDelivery_ByItem_013(
p_szFSoId BOS_DT_szId,
p_shItemNumber smallint,
p_dtmDelivery timestamp,
p_szCustId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szFromWpId BOS_DT_szId,
p_szDjrTrackingId BOS_DT_szId,
p_szFDoId BOS_DT_szId,
p_decRemainingQty BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FSoItemDelivery
SET 
decQty = p_decQty,
szDjrTrackingId = p_szDjrTrackingId,
szFDoId = p_szFDoId,
decRemainingQty = p_decRemainingQty

WHERE 
szFSoId = p_szFSoId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_CreateFTO(
p_szFTOId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szBaseRouteId BOS_DT_szId,
p_dtmFTO timestamp,
p_szSalesId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_szVehicleId BOS_DT_szId,
p_decStartKM BOS_DT_decAmount,
p_decEndKM BOS_DT_decAmount,
p_dtmStartTime timestamp,
p_dtmEndTime timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FTO
(
szFTOId,
szSalesOrgId,
szBaseRouteId,
dtmFTO,
szSalesId,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred,
szVehicleId,
decStartKM,
decEndKM,
dtmStartTime,
dtmEndTime
)
VALUES
(
p_szFTOId,
p_szSalesOrgId,
p_szBaseRouteId,
p_dtmFTO,
p_szSalesId,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_szVehicleId,
p_decStartKM,
p_decEndKM,
p_dtmStartTime,
p_dtmEndTime
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_CreateFTOItem(
p_szFTOId BOS_DT_szId,
p_shItemNumber smallint,
p_szTOTrackingId BOS_DT_szId,
p_szReasonId BOS_DT_szId,
p_szDesciption varchar,
p_bSuccess bit,
p_bStarted BOS_DT_bBoolean,
p_dtmStartVisit timestamp,
p_dtmEndVisit timestamp,
p_decVisitSpendTime numeric,
p_decJourneySpendTime BOS_DT_decAmount,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_szBarcodeScanFailReasonId BOS_DT_szId,
p_szGPSScanFailReasonId BOS_DT_szId,
p_bBarcodeScanSuccess BOS_DT_bBoolean,
p_bGPSScanSuccess BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FTOItem
(
szFTOId,
shItemNumber,
szTOTrackingId,
szReasonId,
szDescription,
bSuccess,
bStarted,
dtmStartVisit,
dtmEndVisit,
decVisitSpendTime,
decJourneySpendTime,
szLatitude,
szLongitude,
szBarcodeScanFailReasonId,
szGPSScanFailReasonId,
bBarcodeScanSuccess,
bGPSScanSuccess
)
VALUES
(
p_szFTOId,
p_shItemNumber,
p_szTOTrackingId,
p_szReasonId,
p_szDesciption,
p_bSuccess,
p_bStarted,
p_dtmStartVisit,
p_dtmEndVisit,
p_decVisitSpendTime,
p_decJourneySpendTime,
p_szLatitude,
p_szLongitude,
p_szBarcodeScanFailReasonId,
p_szGPSScanFailReasonId,
p_bBarcodeScanSuccess,
p_bGPSScanSuccess
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_CreateFTOItem_014(
p_szFTOId BOS_DT_szId,
p_shItemNumber smallint,
p_szTOTrackingId BOS_DT_szId,
p_szReasonId BOS_DT_szId,
p_szDesciption varchar,
p_bSuccess bit,
p_bStarted BOS_DT_bBoolean,
p_dtmStartVisit timestamp,
p_dtmEndVisit timestamp,
p_decVisitSpendTime numeric,
p_decJourneySpendTime BOS_DT_decAmount,
p_szLatitude BOS_DT_szGPSCoordinate,
p_szLongitude BOS_DT_szGPSCoordinate,
p_szBarcodeScanFailReasonId BOS_DT_szId,
p_szGPSScanFailReasonId BOS_DT_szId,
p_bBarcodeScanSuccess BOS_DT_bBoolean,
p_bGPSScanSuccess BOS_DT_bBoolean)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_FTOItem
(
szFTOId,
shItemNumber,
szTOTrackingId,
szReasonId,
szDescription,
bSuccess,
bStarted,
dtmStartVisit,
dtmEndVisit,
decVisitSpendTime,
decJourneySpendTime,
szLatitude,
szLongitude,
szBarcodeScanFailReasonId,
szGPSScanFailReasonId,
bBarcodeScanSuccess,
bGPSScanSuccess
)
VALUES
(
p_szFTOId,
p_shItemNumber,
p_szTOTrackingId,
p_szReasonId,
p_szDesciption,
p_bSuccess,
p_bStarted,
p_dtmStartVisit,
p_dtmEndVisit,
p_decVisitSpendTime,
p_decJourneySpendTime,
p_szLatitude,
p_szLongitude,
p_szBarcodeScanFailReasonId,
p_szGPSScanFailReasonId,
p_bBarcodeScanSuccess,
p_bGPSScanSuccess,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_CreateTOTracking(
p_szTOTrackingId BOS_DT_szId,
p_szType BOS_DT_szSmallId,
p_szCustId BOS_DT_szId,
p_szFSoId BOS_DT_szId,
p_szSalesId BOS_DT_szId,
p_szFTOId BOS_DT_szId,
p_bFinished bit,
p_bSuccess bit,
p_bTasked bit,
p_dtmNext timestamp,
p_btTrialCount smallint,
p_szTeamId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_decValue BOS_DT_decAmount,
p_szFCallId BOS_DT_szId,
p_decCustSalesTarget BOS_DT_decAmount,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_TOTracking
(
szTOTrackingId,
szType,
szCustId,
szFSoId,
szSalesId,
szFTOId,
bFinished,
bSuccess,
bTasked,
dtmNext,
btTrialCount,
szTeamId,
szScheduleId,
decValue,
szFCallId,
decCustSalesTarget,
 dtmLastUpdated
)
VALUES
(
p_szTOTrackingId,
p_szType,
p_szCustId,
p_szFSoId,
p_szSalesId,
p_szFTOId,
p_bFinished,
p_bSuccess,
p_bTasked,
p_dtmNext,
p_btTrialCount,
p_szTeamId,
p_szScheduleId,
p_decValue,
p_szFCallId,
p_decCustSalesTarget,
 p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_CreateTOTracking_013(
p_szTOTrackingId BOS_DT_szId,
p_szType BOS_DT_szSmallId,
p_szCustId BOS_DT_szId,
p_szFSoId BOS_DT_szId,
p_szSalesId BOS_DT_szId,
p_szFTOId BOS_DT_szId,
p_bFinished bit,
p_bSuccess bit,
p_bTasked bit,
p_dtmNext timestamp,
p_btTrialCount smallint,
p_szTeamId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_decValue BOS_DT_decAmount,
p_szFCallId BOS_DT_szId,
p_decCustSalesTarget BOS_DT_decAmount,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_TOTracking
(
szTOTrackingId,
szType,
szCustId,
szFSoId,
szSalesId,
szFTOId,
bFinished,
bSuccess,
bTasked,
dtmNext,
btTrialCount,
szTeamId,
szScheduleId,
decValue,
szFCallId,
decCustSalesTarget,
 dtmLastUpdated
)
VALUES
(
p_szTOTrackingId,
p_szType,
p_szCustId,
p_szFSoId,
p_szSalesId,
p_szFTOId,
p_bFinished,
p_bSuccess,
p_bTasked,
p_dtmNext,
p_btTrialCount,
p_szTeamId,
p_szScheduleId,
p_decValue,
p_szFCallId,
p_decCustSalesTarget,
 p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_CreateTOTrackingProduct(
p_szTOTrackingId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_TOTrackingProduct
(
szTOTrackingId,
shItemNumber,
szProductId,
decQty,
szUomId,
szOrderItemTypeId,
szParentId,
)
VALUES
(
p_szTOTrackingId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_szOrderItemTypeId,
p_szParentId,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_CreateTOTrackingProduct_014(
p_szTOTrackingId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_TOTrackingProduct
(
szTOTrackingId,
shItemNumber,
szProductId,
decQty,
szUomId,
szOrderItemTypeId,
szParentId,
)
VALUES
(
p_szTOTrackingId,
p_shItemNumber,
p_szProductId,
p_decQty,
p_szUomId,
p_szOrderItemTypeId,
p_szParentId,
-- ==================================================================,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_DeleteFTO(
p_szFTOId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FTO
WHERE
szFTOId = p_szFTOId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_DeleteFTOItem(
p_szFTOId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_FTOItem
WHERE
szFTOId = p_szFTOId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_DeleteTOTrackingProduct(
p_szTOTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
From  BOS_SD_TOTrackingProduct
WHERE
szTOTrackingId = p_szTOTrackingId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_DeleteTOTrackingProduct_ByItem(
p_szTOTrackingId BOS_DT_szId,
p_shItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_TOTrackingProduct
WHERE
szTOTrackingId = p_szTOTrackingIdAND shItemNumber = p_shItemNumber;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetFTO(
p_szFTOId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_FTO.szSalesOrgId,
BOS_SD_FTO.szBaseRouteId,
BOS_SD_FTO.dtmFTO,

BOS_SD_FTO.szSalesId,
BOS_PI_Employee.szName AS szSalesNm,
BOS_PI_Employee.szTeamId AS szSalesTeamId_J,

BOS_SD_FTO.bResultFrTransfer,
BOS_SD_FTO.bVoid,
BOS_GEN_Approved.bApproved,
BOS_SD_FTO.bApplied,
BOS_GL_FJournalTrans.szFJournalId AS bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_SD_FTO.btPrintedCount,
BOS_SD_FTO.bTransferred,

BOS_SD_FTO.szCompanyId,
BOS_GL_Company.szName AS szCompanyNm,

BOS_SD_FTO.szWorkplaceId,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_SD_FTO.szTaxEntityId,
BOS_SD_FTO.bNeedApproval,
BOS_GEN_Approved.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,

BOS_SD_FTO.dtmCreated,
BOS_SD_FTO.bSystemCreated,
BOS_SD_FTO.szUserId,
BOS_SM_User.szName AS szUserNm_J,

-- Data Status.
BOS_SD_FTO.dtmLastUpdated,
BOS_SD_FTO.bAlreadyTransferred,

BOS_SD_FTO.szVehicleId,
BOS_INV_Vehicle.szPoliceNo AS szVehicleNumber_J,
BOS_SD_FTO.decStartKM,
BOS_SD_FTO.decEndKM,
BOS_SD_FTO.dtmStartTime,
BOS_SD_FTO.dtmEndTime

FROM
((BOS_SD_FTO LEFT JOIN BOS_GEN_Approved ON BOS_SD_FTO.gdApprovedId = BOS_GEN_Approved.gdApprovedId)
LEFT JOIN BOS_GL_FJournalTrans ON BOS_SD_FTO.szFJournalId = BOS_GL_FJournalTrans.szFJournalId)
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SD_FTO.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_SD_FTO.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_SD_FTO.szUserId
LEFT JOIN BOS_PI_Employee ON BOS_SD_FTO.szSalesId = BOS_PI_Employee.szEmployeeId

LEFT JOIN BOS_INV_Vehicle ON BOS_INV_Vehicle.szVehicleId = BOS_SD_FTO.szVehicleId
LEFT JOIN BOS_INV_VehicleCapacity ON BOS_INV_VehicleCapacity.szVehicleCapacityId = BOS_INV_Vehicle.szVehicleCapacityId

WHERE
BOS_SD_FTO.szFTOId = p_szFTOId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetFTOItem(
p_szFTOId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FTOItem.shItemNumber,
BOS_SD_FTOItem.szTOTrackingId,
BOS_SD_FTOItem.szReasonId,
BOS_SD_FTOItem.szDescription,
BOS_SD_FTOItem.bSuccess,
COALESCE(BOS_SD_TOTracking.szCustId, '') As szCustId,
BOS_SD_TOTracking.bFinished AS bToTrackingFinished_J,
BOS_SD_TOTracking.szFSoId AS szToTrackingFSoId_J,
BOS_SD_FTOItem.bStarted,
BOS_SD_FTOItem.dtmStartVisit,
BOS_SD_FTOItem.dtmEndVisit,
BOS_SD_FTOItem.decVisitSpendTime,
BOS_SD_FTOItem.decJourneySpendTime,
BOS_SD_FTOItem.szLatitude,
BOS_SD_FTOItem.szLongitude,
BOS_SD_FTOItem.szBarcodeScanFailReasonId,
BOS_SD_FTOItem.szGPSScanFailReasonId,
BOS_SD_FTOItem.bBarcodeScanSuccess,
BOS_SD_FTOItem.bGPSScanSuccess,
COALESCE(BOS_AR_Customer.szName, '') As szCustName


FROM 
BOS_SD_FTOItem
Left Join BOS_SD_TOTracking ON BOS_SD_FTOItem.szTOTrackingId = BOS_SD_TOTracking.szTOTrackingId
Left Join BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_TOTracking.szCustId

WHERE 
BOS_SD_FTOItem.szFTOId = p_szFTOId ;ORDER BY 
BOS_SD_FTOItem.shItemNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetFTOItem_014(
p_szFTOId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_FTOItem.shItemNumber,
BOS_SD_FTOItem.szTOTrackingId,
BOS_SD_FTOItem.szReasonId,
BOS_SD_FTOItem.szDescription,
BOS_SD_FTOItem.bSuccess,
COALESCE(BOS_SD_TOTracking.szCustId, '') As szCustId,
BOS_SD_TOTracking.bFinished AS bToTrackingFinished_J,
BOS_SD_TOTracking.szFSoId AS szToTrackingFSoId_J,
BOS_SD_FTOItem.bStarted,
BOS_SD_FTOItem.dtmStartVisit,
BOS_SD_FTOItem.dtmEndVisit,
BOS_SD_FTOItem.decVisitSpendTime,
BOS_SD_FTOItem.decJourneySpendTime,
BOS_SD_FTOItem.szLatitude,
BOS_SD_FTOItem.szLongitude,
BOS_SD_FTOItem.szBarcodeScanFailReasonId,
BOS_SD_FTOItem.szGPSScanFailReasonId,
BOS_SD_FTOItem.bBarcodeScanSuccess,
BOS_SD_FTOItem.bGPSScanSuccess,
COALESCE(BOS_AR_Customer.szName, '') As szCustName


FROM 
BOS_SD_FTOItem
Left Join BOS_SD_TOTracking ON BOS_SD_FTOItem.szTOTrackingId = BOS_SD_TOTracking.szTOTrackingId
Left Join BOS_AR_Customer ON BOS_AR_Customer.szCustId = BOS_SD_TOTracking.szCustId

WHERE 
BOS_SD_FTOItem.szFTOId = p_szFTOId ;ORDER BY 
BOS_SD_FTOItem.shItemNumber


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetListOfActiveTOTrackingId(
p_szType BOS_DT_szSmallId,
p_szSalesId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_szScheduleType BOS_DT_szSmallId,
p_decValue BOS_DT_decAmount,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN

IF p_szScheduleType = ''
  THEN
SELECT
szTOTrackingId

FROM
BOS_SD_TOTracking

WHERE
bFinished = 0 AND
szType = p_szType AND
szSalesId = p_szSalesId AND
szCustId = p_szCustId AND
szTeamId LIKE p_szTeamId AND
(dtmNext  >= p_dtmStart AND dtmNext < dateadd(day, 1, p_dtmEnd))
ELSE
SELECT
szTOTrackingId

FROM
BOS_SD_TOTracking
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = BOS_SD_TOTracking.szScheduleId

WHERE
bFinished = 0 AND
szType = p_szType AND
szSalesId = p_szSalesId AND
szCustId = p_szCustId AND
szTeamId LIKE p_szTeamId AND
BOS_GEN_RoutineSchedule.szScheduleType = p_szScheduleType AND
decValue = p_decValue AND
(dtmNext  >= p_dtmStart AND dtmNext < dateadd(day, 1, p_dtmEnd))

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetListOfActiveTOTrackingId_013(
p_szType BOS_DT_szSmallId,
p_szSalesId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_szScheduleType BOS_DT_szSmallId,
p_decValue BOS_DT_decAmount,
p_dtmStart timestamp,
p_dtmEnd timestamp)
RETURNS void AS
$BODY$
BEGIN

IF p_szScheduleType = ''
  THEN
SELECT
szTOTrackingId

FROM
BOS_SD_TOTracking

WHERE
bFinished = 0 AND
szType = p_szType AND
szSalesId = p_szSalesId AND
szCustId = p_szCustId AND
szTeamId LIKE p_szTeamId AND
(dtmNext  >= p_dtmStart AND dtmNext < dateadd(day, 1, p_dtmEnd))
ELSE
SELECT
szTOTrackingId

FROM
BOS_SD_TOTracking
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_GEN_RoutineSchedule.szScheduleId = BOS_SD_TOTracking.szScheduleId

WHERE
bFinished = 0 AND
szType = p_szType AND
szSalesId = p_szSalesId AND
szCustId = p_szCustId AND
szTeamId LIKE p_szTeamId AND
BOS_GEN_RoutineSchedule.szScheduleType = p_szScheduleType AND
decValue = p_decValue AND
(dtmNext  >= p_dtmStart AND dtmNext < dateadd(day, 1, p_dtmEnd))

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetListOfFTO()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFTOId,
dtmFTO

FROM 
BOS_SD_FTO

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetListOfNotTaskedTOTracking(
p_szType BOS_DT_szSmallId,
p_szSalesId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_szStatusACT varchar,
p_szStatusFDE varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_TOTracking.szTOTrackingId,
BOS_SD_TOTracking.szCustId,
COALESCE(BOS_AR_Customer.szName, '') AS szCustNm,
BOS_SD_TOTracking.szFSoId


FROM 
BOS_SD_TOTracking LEFT JOIN BOS_AR_Customer ON BOS_SD_TOTracking.szCustId = BOS_AR_Customer.szCustIdBOS_SD_TOTracking LEFT JOIN BOS_AR_Customer ON BOS_SD_TOTracking.szCustId = BOS_AR_Customer.szCustId;

WHERE 
(BOS_AR_Customer.szStatus = p_szStatusACT OR BOS_AR_Customer.szStatus = p_szStatusFDE) AND BOS_SD_TOTracking.bFinished = 0 AND BOS_SD_TOTracking.bTasked = 0 AND BOS_SD_TOTracking.szType LIKE p_szType AND BOS_SD_TOTracking.szSalesId LIKE p_szSalesId AND BOS_SD_TOTracking.szCustId LIKE p_szCustId AND BOS_SD_TOTracking.szTeamId LIKE p_szTeamId AND (BOS_SD_TOTracking.dtmNext  >= p_dtmStart AND BOS_SD_TOTracking.dtmNext < dateadd(day, 1, p_dtmEnd)) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetListOfNotTaskedTOTracking_013(
p_szType BOS_DT_szSmallId,
p_szSalesId BOS_DT_szId,
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_dtmStart timestamp,
p_dtmEnd timestamp,
p_szStatusACT varchar,
p_szStatusFDE varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_TOTracking.szTOTrackingId,
BOS_SD_TOTracking.szCustId,
COALESCE(BOS_AR_Customer.szName, '') AS szCustNm,
BOS_SD_TOTracking.szFSoId


FROM 
BOS_SD_TOTracking LEFT JOIN BOS_AR_Customer ON BOS_SD_TOTracking.szCustId = BOS_AR_Customer.szCustIdBOS_SD_TOTracking LEFT JOIN BOS_AR_Customer ON BOS_SD_TOTracking.szCustId = BOS_AR_Customer.szCustId;

WHERE 
(BOS_AR_Customer.szStatus = p_szStatusACT OR BOS_AR_Customer.szStatus = p_szStatusFDE) AND BOS_SD_TOTracking.bFinished = 0 AND BOS_SD_TOTracking.bTasked = 0 AND BOS_SD_TOTracking.szType LIKE p_szType AND BOS_SD_TOTracking.szSalesId LIKE p_szSalesId AND BOS_SD_TOTracking.szCustId LIKE p_szCustId AND BOS_SD_TOTracking.szTeamId LIKE p_szTeamId AND (BOS_SD_TOTracking.dtmNext  >= p_dtmStart AND BOS_SD_TOTracking.dtmNext < dateadd(day, 1, p_dtmEnd)) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetListOfRangeFTO(
p_szFTOId_From varchar,
p_szFTOId_To varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFTOId

FROM 
BOS_SD_FTO
WHERE 
szFTOId >= p_szFTOId_From And szFTOId <= p_szFTOId_To And bVoid = 0 ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetListOfReportFTO(
p_szFTOId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSFI.szTOTrackingId,
BSD.szCustId,
COALESCE(BAC.szName, '') As szCustName,
BSD.szFSoId,
BACS.bAllowToCredit As bAllowToCredit, 	/*Check null or !null in .net code*/
COALESCE(BSC.szDefaultScheduleId, '') As szScheduleId,
BAAM.decAmount As decOutstanding, 	/*Check null or !null in .net code*/
BSFDLast.dtmOrder,			/*Check null or !null in .net code*/
BAC.szCategory_3 as szCustCategory_3

FROM 
BOS_SD_FTO As BSF
Inner Join BOS_SD_FTOItem As BSFI On BSF.szFTOId = BSFI.szFTOId
Inner Join BOS_SD_TOTracking As BSD On BSFI.szTOTrackingId = BSD.szTOTrackingId
Left Join BOS_AR_Customer As BAC On BSD.szCustId = BAC.szCustId
Left Join BOS_AR_CustSales As BACS On BSD.szCustId = BACS.szCustId
Left Join BOS_SD_CustTORoutine As BSC On BSD.szCustId = BSC.szCustId
Left Join BOS_SD_FSo As BSFDLast On BSC.szLastFSoId = BSFDLast.szFSoId
Left Join BOS_SD_FSo As BSFD On BSD.szFSoId = BSFD.szFSoId
Left Join BOS_AR_ArMaster As BAAM On BSD.szCustId = BAAM.szCustId And BSFD.szCcyId = BAAM.szCcyId
WHERE 
BSF.szFTOId = p_szFTOId ;ORDER BY 
BSFI.shItemNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetListOfReportFTO_013(
p_szFTOId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSFI.szTOTrackingId,
BSD.szCustId,
COALESCE(BAC.szName, '') As szCustName,
BSD.szFSoId,
BACS.bAllowToCredit As bAllowToCredit, 	/*Check null or !null in .net code*/
COALESCE(BSC.szDefaultScheduleId, '') As szScheduleId,
BAAM.decAmount As decOutstanding, 	/*Check null or !null in .net code*/
BSFDLast.dtmOrder,			/*Check null or !null in .net code*/
BAC.szCategory_3 as szCustCategory_3

FROM 
BOS_SD_FTO As BSF
Inner Join BOS_SD_FTOItem As BSFI On BSF.szFTOId = BSFI.szFTOId
Inner Join BOS_SD_TOTracking As BSD On BSFI.szTOTrackingId = BSD.szTOTrackingId
Left Join BOS_AR_Customer As BAC On BSD.szCustId = BAC.szCustId
Left Join BOS_AR_CustSales As BACS On BSD.szCustId = BACS.szCustId
Left Join BOS_SD_CustTORoutine As BSC On BSD.szCustId = BSC.szCustId
Left Join BOS_SD_FSo As BSFDLast On BSC.szLastFSoId = BSFDLast.szFSoId
Left Join BOS_SD_FSo As BSFD On BSD.szFSoId = BSFD.szFSoId
Left Join BOS_AR_ArMaster As BAAM On BSD.szCustId = BAAM.szCustId And BSFD.szCcyId = BAAM.szCcyId
WHERE 
BSF.szFTOId = p_szFTOId ;ORDER BY 
BSFI.shItemNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetListOfReportFTOForDepositRemain(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BACPD.szProductId,
COALESCE(BIP.szName, '') As szProductName,
BACPD.decQty


FROM 
BOS_AR_CustProductDeposit As BACPD
Left Join BOS_INV_Product As BIP On BACPD.szProductId = BIP.szProductId

WHERE 
BACPD.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetListOfReportFTOForFOCRemain(
p_szCustId varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSCFI.szProductId,
COALESCE(BIP.szName, '') As szProductName,
BSCFI.decQtyRemain


FROM 
BOS_SD_CustFOCItem As BSCFI
Left Join BOS_INV_Product As BIP On BSCFI.szProductId = BIP.szProductId

WHERE 
BSCFI.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetListOfReportFTOForLastSentFSo(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSFI.szProductId,
COALESCE(BIP.szName, '') As szProductName,
BSFI.decQty,
BSFI.szParentId,
BSFI.szUomId

FROM 
BOS_SD_FSo As BSF
Inner Join BOS_SD_FSoItem As BSFI On BSF.szFSoId = BSFI.szFSoId
Inner Join BOS_SD_CustTORoutine As BSC On BSF.szFSoId = BSC.szLastFSoId
Left Join BOS_INV_Product As BIP On BSFI.szProductId = BIP.szProductId
WHERE 
BSC.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetListOfReportFTOForLastSentFSo_014(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSFI.szProductId,
COALESCE(BIP.szName, '') As szProductName,
BSFI.decQty,
BSFI.szParentId,
BSFI.szUomId

FROM 
BOS_SD_FSo As BSF
Inner Join BOS_SD_FSoItem As BSFI On BSF.szFSoId = BSFI.szFSoId
Inner Join BOS_SD_CustTORoutine As BSC On BSF.szFSoId = BSC.szLastFSoId
Left Join BOS_INV_Product As BIP On BSFI.szProductId = BIP.szProductId
WHERE 
BSC.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetListOfTOTracking()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szTOTrackingId


FROM 
BOS_SD_TOTracking

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetListOfTOTrackingTobeReschedule(
p_szSalesId BOS_DT_szId,
p_bFinished bit,
p_dtmFrom timestamp,
p_dtmTo timestamp)
RETURNS void AS
$BODY$
BEGIN

IF p_szSalesId = '%'
  THEN
SELECT  
BSD.bFinished,  
BSD.bSuccess,  
BSD.szSalesId,  
COALESCE(BPE.szName, '') AS szSalesName,  
BSD.szCustId,  
COALESCE(BAC.szName, '') AS szCustName,  
BSD.dtmNext AS dtmLastOrderDate,  
COALESCE(BSF.szReasonId, '') AS szReasonId,  
COALESCE(BSF.szDescription, '') AS szDescription,  
BSD.szTOTrackingId,  
COALESCE(BSD.szFTOId, '') As szFTOId,  
BSD.szScheduleId,  
COALESCE(BGRS.szDescription, '') As szSchDescription_J,  
BSD.szFSoId,  
BSD.decValue,  
BSD.szTeamId  

FROM  
BOS_SD_TOTracking AS BSD   
LEFT JOIN BOS_PI_Employee AS BPE ON BSD.szSalesId = BPE.szEmployeeId  
LEFT JOIN BOS_AR_Customer AS BAC ON BSD.szCustId = BAC.szCustId  
LEFT JOIN BOS_SD_FTOItem AS BSF ON BSD.szFTOId = BSF.szFTOId And BSD.szTOTrackingId = BSF.szTOTrackingId  
LEFT JOIN BOS_GEN_RoutineSchedule AS BGRS ON BGRS.szScheduleId = BSD.szScheduleId  

WHERE  
BSD.dtmNext >= p_dtmFrom And BSD.dtmNext < DateAdd(Day, 1, p_dtmTo) And  
--BSD.szSalesId LIKE p_szSalesId And  
BSD.bFinished = p_bFinished 

ORDER BY  
BSD.szSalesId    
ELSE
SELECT  
BSD.bFinished,  
BSD.bSuccess,  
BSD.szSalesId,  
COALESCE(BPE.szName, '') AS szSalesName,  
BSD.szCustId,  
COALESCE(BAC.szName, '') AS szCustName,  
BSD.dtmNext AS dtmLastOrderDate,  
COALESCE(BSF.szReasonId, '') AS szReasonId,  
COALESCE(BSF.szDescription, '') AS szDescription,  
BSD.szTOTrackingId,  
COALESCE(BSD.szFTOId, '') As szFTOId,  
BSD.szScheduleId,  
COALESCE(BGRS.szDescription, '') As szSchDescription_J,  
BSD.szFSoId,  
BSD.decValue,  
BSD.szTeamId  

FROM  
BOS_SD_TOTracking AS BSD   
LEFT JOIN BOS_PI_Employee AS BPE ON BSD.szSalesId = BPE.szEmployeeId  
LEFT JOIN BOS_AR_Customer AS BAC ON BSD.szCustId = BAC.szCustId  
LEFT JOIN BOS_SD_FTOItem AS BSF ON BSD.szFTOId = BSF.szFTOId And BSD.szTOTrackingId = BSF.szTOTrackingId  
LEFT JOIN BOS_GEN_RoutineSchedule AS BGRS ON BGRS.szScheduleId = BSD.szScheduleId  

WHERE  
BSD.dtmNext >= p_dtmFrom And BSD.dtmNext < DateAdd(Day, 1, p_dtmTo) And
BSD.szSalesId = p_szSalesId And  
BSD.bFinished = p_bFinished     

ORDER BY  
BSD.szSalesId

END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetListOfTOTrackingTobeReschedule_014(
p_szSalesId BOS_DT_szId,
p_bFinished bit,
p_dtmFrom timestamp,
p_dtmTo timestamp)
RETURNS void AS
$BODY$
BEGIN

IF p_szSalesId = '%'
  THEN
SELECT  
BSD.bFinished,  
BSD.bSuccess,  
BSD.szSalesId,  
COALESCE(BPE.szName, '') AS szSalesName,  
BSD.szCustId,  
COALESCE(BAC.szName, '') AS szCustName,  
BSD.dtmNext AS dtmLastOrderDate,  
COALESCE(BSF.szReasonId, '') AS szReasonId,  
COALESCE(BSF.szDescription, '') AS szDescription,  
BSD.szTOTrackingId,  
COALESCE(BSD.szFTOId, '') As szFTOId,  
BSD.szScheduleId,  
COALESCE(BGRS.szDescription, '') As szSchDescription_J,  
BSD.szFSoId,  
BSD.decValue,  
BSD.szTeamId  

FROM  
BOS_SD_TOTracking AS BSD   
LEFT JOIN BOS_PI_Employee AS BPE ON BSD.szSalesId = BPE.szEmployeeId  
LEFT JOIN BOS_AR_Customer AS BAC ON BSD.szCustId = BAC.szCustId  
LEFT JOIN BOS_SD_FTOItem AS BSF ON BSD.szFTOId = BSF.szFTOId And BSD.szTOTrackingId = BSF.szTOTrackingId  
LEFT JOIN BOS_GEN_RoutineSchedule AS BGRS ON BGRS.szScheduleId = BSD.szScheduleId  

WHERE  
BSD.dtmNext >= p_dtmFrom And BSD.dtmNext < DateAdd(Day, 1, p_dtmTo) And  
--BSD.szSalesId LIKE p_szSalesId And  
BSD.bFinished = p_bFinished 

ORDER BY  
BSD.szSalesId    
ELSE
SELECT  
BSD.bFinished,  
BSD.bSuccess,  
BSD.szSalesId,  
COALESCE(BPE.szName, '') AS szSalesName,  
BSD.szCustId,  
COALESCE(BAC.szName, '') AS szCustName,  
BSD.dtmNext AS dtmLastOrderDate,  
COALESCE(BSF.szReasonId, '') AS szReasonId,  
COALESCE(BSF.szDescription, '') AS szDescription,  
BSD.szTOTrackingId,  
COALESCE(BSD.szFTOId, '') As szFTOId,  
BSD.szScheduleId,  
COALESCE(BGRS.szDescription, '') As szSchDescription_J,  
BSD.szFSoId,  
BSD.decValue,  
BSD.szTeamId  

FROM  
BOS_SD_TOTracking AS BSD   
LEFT JOIN BOS_PI_Employee AS BPE ON BSD.szSalesId = BPE.szEmployeeId  
LEFT JOIN BOS_AR_Customer AS BAC ON BSD.szCustId = BAC.szCustId  
LEFT JOIN BOS_SD_FTOItem AS BSF ON BSD.szFTOId = BSF.szFTOId And BSD.szTOTrackingId = BSF.szTOTrackingId  
LEFT JOIN BOS_GEN_RoutineSchedule AS BGRS ON BGRS.szScheduleId = BSD.szScheduleId  

WHERE  
BSD.dtmNext >= p_dtmFrom And BSD.dtmNext < DateAdd(Day, 1, p_dtmTo) And
BSD.szSalesId = p_szSalesId And  
BSD.bFinished = p_bFinished     

ORDER BY  
BSD.szSalesId


END IF
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetTOTracking(
p_szTOTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT Distinct
BOS_SD_TOTracking.szTOTrackingId,
BOS_SD_TOTracking.szType,
BOS_SD_TOTracking.szCustId,
IsNull(BOS_AR_Customer.szName, '') As szCustNm,

BOS_SD_TOTracking.szFSoId,
BOS_SD_FSo.bApplied AS bFSoApplied_J,

BOS_SD_TOTracking.szSalesId,
IsNull(BOS_PI_Employee.szName, '') As szSalesNm,
BOS_SD_TOTracking.szFTOId,
BOS_SD_TOTracking.bFinished,
BOS_SD_TOTracking.bSuccess,
BOS_SD_TOTracking.bTasked,
BOS_SD_TOTracking.dtmNext,
BOS_SD_TOTracking.btTrialCount,
BOS_SD_TOTracking.szTeamId,
BOS_SD_TOTracking.szScheduleId,
BOS_SD_TOTracking.decValue,
IsNull(BOS_SD_FTOItem.szReasonId, '') As szReasonId,
IsNull(BOS_SD_FTOItem.szDescription, '') As szDescription,
BOS_SD_TOTracking.szFCallId,
IsNull(BOS_CRL_FCall.szCallType, '') as szCallType

--new
,  BOS_SD_TOTracking.decCustSalesTarget as decCustSalesTarget
,  BOS_SD_TOTracking.dtmLastUpdated as dtmLastUpdated

FROM
BOS_SD_TOTracking LEFT JOIN BOS_AR_Customer ON BOS_SD_TOTracking.szCustId = BOS_AR_Customer.szCustId
LEFT JOIN BOS_PI_Employee ON BOS_SD_TOTracking.szSalesId = BOS_PI_Employee.szEmployeeId
Left Join BOS_SD_FTOItem On BOS_SD_FTOItem.szFTOId = BOS_SD_TOTracking.szFTOId 
And BOS_SD_FTOItem.szTOTrackingId = BOS_SD_TOTracking.szTOTrackingId
LEFT JOIN BOS_CRL_FCall ON BOS_CRL_FCall.szFCallId = BOS_SD_TOTracking.szFCallId
LEFT JOIN BOS_SD_FSo ON BOS_SD_FSo.szFSoId = BOS_SD_TOTracking.szFSoId

WHERE
BOS_SD_TOTracking.szTOTrackingId = p_szTOTrackingId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetTOTracking_014(
p_szTOTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT Distinct
BOS_SD_TOTracking.szTOTrackingId,
BOS_SD_TOTracking.szType,
BOS_SD_TOTracking.szCustId,
IsNull(BOS_AR_Customer.szName, '') As szCustNm,

BOS_SD_TOTracking.szFSoId,
BOS_SD_FSo.bApplied AS bFSoApplied_J,

BOS_SD_TOTracking.szSalesId,
IsNull(BOS_PI_Employee.szName, '') As szSalesNm,
BOS_SD_TOTracking.szFTOId,
BOS_SD_TOTracking.bFinished,
BOS_SD_TOTracking.bSuccess,
BOS_SD_TOTracking.bTasked,
BOS_SD_TOTracking.dtmNext,
BOS_SD_TOTracking.btTrialCount,
BOS_SD_TOTracking.szTeamId,
BOS_SD_TOTracking.szScheduleId,
BOS_SD_TOTracking.decValue,
IsNull(BOS_SD_FTOItem.szReasonId, '') As szReasonId,
IsNull(BOS_SD_FTOItem.szDescription, '') As szDescription,
BOS_SD_TOTracking.szFCallId,
IsNull(BOS_CRL_FCall.szCallType, '') as szCallType

--new
,  BOS_SD_TOTracking.decCustSalesTarget as decCustSalesTarget
,  BOS_SD_TOTracking.dtmLastUpdated as dtmLastUpdated

FROM
BOS_SD_TOTracking LEFT JOIN BOS_AR_Customer ON BOS_SD_TOTracking.szCustId = BOS_AR_Customer.szCustId
LEFT JOIN BOS_PI_Employee ON BOS_SD_TOTracking.szSalesId = BOS_PI_Employee.szEmployeeId
Left Join BOS_SD_FTOItem On BOS_SD_FTOItem.szFTOId = BOS_SD_TOTracking.szFTOId 
And BOS_SD_FTOItem.szTOTrackingId = BOS_SD_TOTracking.szTOTrackingId
LEFT JOIN BOS_CRL_FCall ON BOS_CRL_FCall.szFCallId = BOS_SD_TOTracking.szFCallId
LEFT JOIN BOS_SD_FSo ON BOS_SD_FSo.szFSoId = BOS_SD_TOTracking.szFSoId

WHERE
BOS_SD_TOTracking.szTOTrackingId = p_szTOTrackingId


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetTOTrackingOfFSo(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szTOTrackingId


FROM 
BOS_SD_TOTracking

WHERE 
szFSoId = p_szFSoId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetTOTrackingProduct(
p_szTOTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

Select
BOS_SD_TOTrackingProduct.shItemNumber,
BOS_SD_TOTrackingProduct.szProductId,

BOS_INV_Product.szName as szProductName_J,
BOS_INV_Product.szNickName as szProductNickName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,
BOS_GL_TaxType.decRate AS decProductTaxRate_J,
BOS_INV_Product.szDiscountGroupId as szProductDiscGroupId_J,

BOS_SD_TOTrackingProduct.decQty,
BOS_SD_TOTrackingProduct.szUomId,

BOS_SD_TOTrackingProduct.szOrderItemTypeId,
BOS_INV_OrderItemType.bTaxable AS bOrderItemTypeTaxable_J,
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,
BOS_INV_OrderItemType.szRentChargeCalcId AS szOrderItemTypeRentChargeCalcId_J,

-- Add Parent ID
BOS_SD_TOTrackingProduct.szParentId	


From
BOS_SD_TOTrackingProduct
Left Join BOS_INV_Product ON BOS_SD_TOTrackingProduct.szProductId = BOS_INV_Product.szProductId
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_SD_TOTrackingProduct.szOrderItemTypeId

Where
BOS_SD_TOTrackingProduct.szTOTrackingId = p_szTOTrackingId
Order By
BOS_SD_TOTrackingProduct.shItemNumber

--
--	Do not add any "order-by" clause, our updating function depends on item number to always be sorted.
--

set ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_GetTOTrackingProduct_014(
p_szTOTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

Select
BOS_SD_TOTrackingProduct.shItemNumber,
BOS_SD_TOTrackingProduct.szProductId,

BOS_INV_Product.szName as szProductName_J,
BOS_INV_Product.szNickName as szProductNickName_J,
BOS_INV_Product.szQtyFormat as szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szTrackingType AS szProductTrackingType_J,
BOS_GL_TaxType.decRate AS decProductTaxRate_J,
BOS_INV_Product.szDiscountGroupId as szProductDiscGroupId_J,

BOS_SD_TOTrackingProduct.decQty,
BOS_SD_TOTrackingProduct.szUomId,

BOS_SD_TOTrackingProduct.szOrderItemTypeId,
BOS_INV_OrderItemType.bTaxable AS bOrderItemTypeTaxable_J,
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,
BOS_INV_OrderItemType.szRentChargeCalcId AS szOrderItemTypeRentChargeCalcId_J,

-- Add Parent ID
BOS_SD_TOTrackingProduct.szParentId    


From
BOS_SD_TOTrackingProduct
Left Join BOS_INV_Product ON BOS_SD_TOTrackingProduct.szProductId = BOS_INV_Product.szProductId
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_SD_TOTrackingProduct.szOrderItemTypeId

Where
BOS_SD_TOTrackingProduct.szTOTrackingId = p_szTOTrackingId
Order By
BOS_SD_TOTrackingProduct.shItemNumber

--
--    Do not add any "order-by" clause, our updating function depends on item number to always be sorted.
--

set ANSI_NULLS ON


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_IsAssignedToTracking(
p_szFSoId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szTOTrackingId

FROM 
BOS_SD_TOTracking
WHERE 
szFSoId = p_szFSoId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_IsFTOCreated(
p_szSalesId BOS_DT_szId,
p_dtmFromDate timestamp,
p_dtmToDate timestamp)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFTOId


FROM 
BOS_SD_FTO

WHERE 
bVoid = 0 AND szSalesId = p_szSalesId AND (dtmFTO >= p_dtmFromDate AND dtmFTO < p_dtmToDate + 1) ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_IsFTOExist(
p_szFTOId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFTOId

FROM 
BOS_SD_FTO
WHERE 
szFTOId = p_szFTOId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_IsTOTrackingExist(
p_szTOTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szTOTrackingId

FROM 
BOS_SD_TOTracking
WHERE 
szTOTrackingId = p_szTOTrackingId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_LockFTO(
p_szFTOId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FTO
SET 
bTransferred = bTransferred
WHERE 
szFTOId = p_szFTOId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_LockTOTracking(
p_szTOTrackingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_TOTracking
SET 
decValue = decValue
WHERE 
szTOTrackingId = p_szTOTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_MarkFTOVoid(
p_szFTOId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FTO
SET 
bVoid = 1,
bApplied = 0

WHERE 
szFTOId=p_szFTOId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_MarkTOTracking(
p_szTOTrackingId BOS_DT_szId,
p_bTasked bit,
p_bFinished bit,
p_dtmNext timestamp,
p_szSalesId BOS_DT_szId,
p_szDocId BOS_DT_szId,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_TOTracking
SET 
bTasked = p_bTasked,
bFinished = p_bFinished,
dtmNext = p_dtmNext,
szSalesId = p_szSalesId,
szFTOId = p_szDocId
, dtmLastUpdated = p_dtmLastUpdated

WHERE 
szTOTrackingId = p_szTOTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_MarkTOTracking_013(
p_szTOTrackingId BOS_DT_szId,
p_bTasked bit,
p_bFinished bit,
p_dtmNext timestamp,
p_szSalesId BOS_DT_szId,
p_szDocId BOS_DT_szId,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_TOTracking
SET 
bTasked = p_bTasked,
bFinished = p_bFinished,
dtmNext = p_dtmNext,
szSalesId = p_szSalesId,
szFTOId = p_szDocId
, dtmLastUpdated = p_dtmLastUpdated

WHERE 
szTOTrackingId = p_szTOTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_MarkTOTrackingTasked(
p_szTOTrackingId BOS_DT_szId,
p_bTasked bit,
p_szDocId BOS_DT_szId,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_TOTracking
SET 
bTasked = p_bTasked,
szFTOId = p_szDocId
, dtmLastUpdated = p_dtmLastUpdated

WHERE 
szTOTrackingId = p_szTOTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_MarkTOTrackingTasked_013(
p_szTOTrackingId BOS_DT_szId,
p_bTasked bit,
p_szDocId BOS_DT_szId,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_TOTracking
SET 
bTasked = p_bTasked,
szFTOId = p_szDocId
, dtmLastUpdated = p_dtmLastUpdated

WHERE 
szTOTrackingId = p_szTOTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_UpdateFTO(
p_szFTOId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szBaseRouteId BOS_DT_szId,
p_dtmFTO timestamp,
p_szSalesId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_decStartKM BOS_DT_decAmount,
p_decEndKM BOS_DT_decAmount,
p_dtmStartTime timestamp,
p_dtmEndTime timestamp,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FTO
SET 
szSalesOrgId = p_szSalesOrgId,
szBaseRouteId = p_szBaseRouteId,
dtmFTO = p_dtmFTO,
szSalesId = p_szSalesId,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId,

szVehicleId = p_szVehicleId,
decStartKM = p_decStartKM,
decEndKM = p_decEndKM,
dtmStartTime = p_dtmStartTime,
dtmEndTime = p_dtmEndTime,
dtmLastUpdated = p_dtmLastUpdated,
bAlreadyTransferred = p_bAlreadyTransferred

WHERE 
szFTOId = p_szFTOId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_UpdateFTO_014(
p_szFTOId BOS_DT_szId,
p_szSalesOrgId BOS_DT_szId,
p_szBaseRouteId BOS_DT_szId,
p_dtmFTO timestamp,
p_szSalesId BOS_DT_szId,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_szVehicleId BOS_DT_szId,
p_decStartKM BOS_DT_decAmount,
p_decEndKM BOS_DT_decAmount,
p_dtmStartTime timestamp,
p_dtmEndTime timestamp,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FTO
SET 
szSalesOrgId = p_szSalesOrgId,
szBaseRouteId = p_szBaseRouteId,
dtmFTO = p_dtmFTO,
szSalesId = p_szSalesId,

bVoid = p_bVoid,
bApplied = p_bApplied,
szCompanyId = p_szCompanyId,
szWorkplaceId = p_szWorkplaceId,
szTaxEntityId = p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId,

szVehicleId = p_szVehicleId,
decStartKM = p_decStartKM,
decEndKM = p_decEndKM,
dtmStartTime = p_dtmStartTime,
dtmEndTime = p_dtmEndTime,
dtmLastUpdated = p_dtmLastUpdated,
bAlreadyTransferred = p_bAlreadyTransferred

WHERE 
szFTOId = p_szFTOId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_UpdateFTOItemReason(
p_szFTOId BOS_DT_szId,
p_szTOTrackingId BOS_DT_szId,
p_szReasonId BOS_DT_szId,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FTOItem
SET 
szReasonId = p_szReasonId,
szDescription = p_szDescription
WHERE 
szFTOID = p_szFTOId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_UpdateFTOItemSuccess(
p_szFTOId BOS_DT_szId,
p_szTOTrackingId BOS_DT_szId,
p_bSuccess bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_FTOItem
SET 
bSuccess = p_bSuccess
WHERE 
szFTOID = p_szFTOId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_UpdateTOTracking(
p_szTOTrackingId BOS_DT_szId,
p_szType BOS_DT_szSmallId,
p_szCustId BOS_DT_szId,
p_szFSoId BOS_DT_szId,
p_szSalesId BOS_DT_szId,
p_szFTOId BOS_DT_szId,
p_bFinished bit,
p_bSuccess bit,
p_bTasked bit,
p_dtmNext timestamp,
p_btTrialCount smallint,
p_szTeamId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_decValue BOS_DT_decAmount,
p_szFCallId BOS_DT_szId,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_TOTracking
SET 
szType = p_szType,
szCustId = p_szCustId,
szFSoId = p_szFSoId,
szSalesId = p_szSalesId,
szFTOId = p_szFTOId,
bFinished = p_bFinished,
bSuccess = p_bSuccess,
bTasked = p_bTasked,
dtmNext = p_dtmNext,
btTrialCount = p_btTrialCount,
szTeamId = p_szTeamId,
szScheduleId = p_szScheduleId,
decValue = p_decValue,
szFCallId = p_szFCallId
, dtmLastUpdated = p_dtmLastUpdated

WHERE 
szTOTrackingId = p_szTOTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_UpdateTOTracking_013(
p_szTOTrackingId BOS_DT_szId,
p_szType BOS_DT_szSmallId,
p_szCustId BOS_DT_szId,
p_szFSoId BOS_DT_szId,
p_szSalesId BOS_DT_szId,
p_szFTOId BOS_DT_szId,
p_bFinished bit,
p_bSuccess bit,
p_bTasked bit,
p_dtmNext timestamp,
p_btTrialCount smallint,
p_szTeamId BOS_DT_szId,
p_szScheduleId BOS_DT_szId,
p_decValue BOS_DT_decAmount,
p_szFCallId BOS_DT_szId,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_TOTracking
SET 
szType = p_szType,
szCustId = p_szCustId,
szFSoId = p_szFSoId,
szSalesId = p_szSalesId,
szFTOId = p_szFTOId,
bFinished = p_bFinished,
bSuccess = p_bSuccess,
bTasked = p_bTasked,
dtmNext = p_dtmNext,
btTrialCount = p_btTrialCount,
szTeamId = p_szTeamId,
szScheduleId = p_szScheduleId,
decValue = p_decValue,
szFCallId = p_szFCallId
, dtmLastUpdated = p_dtmLastUpdated

WHERE 
szTOTrackingId = p_szTOTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_UpdateTOTrackingNextSchedule(
p_szTOTrackingId BOS_DT_szId,
p_dtmNext timestamp,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_TOTracking
SET 
dtmNext = p_dtmNext
, dtmLastUpdated = p_dtmLastUpdated
WHERE 
szTOTrackingId = p_szTOTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_UpdateTOTrackingNextSchedule_014(
p_szTOTrackingId BOS_DT_szId,
p_dtmNext timestamp,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_TOTracking
SET 
dtmNext = p_dtmNext
, dtmLastUpdated = p_dtmLastUpdated
WHERE 
szTOTrackingId = p_szTOTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_UpdateTOTrackingProduct_ByItem(
p_szTOTrackingId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_TOTrackingProduct
SET 
szProductId = p_szProductId,
decQty = p_decQty,
szUomId = p_szUomId,
szOrderItemTypeId = p_szOrderItemTypeId,
szParentId = p_szParentId
WHERE 
szTOTrackingId = p_szTOTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_FTO_UpdateTOTrackingProduct_ByItem_014(
p_szTOTrackingId BOS_DT_szId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_decQty BOS_DT_decAmount,
p_szUomId BOS_DT_szId,
p_szOrderItemTypeId BOS_DT_szId,
p_szParentId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_TOTrackingProduct
SET 
szProductId = p_szProductId,
decQty = p_decQty,
szUomId = p_szUomId,
szOrderItemTypeId = p_szOrderItemTypeId,
szParentId = p_szParentId
WHERE 
szTOTrackingId = p_szTOTrackingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_InvoiceProcessing_CreateInvoiceProcessing(
p_szInvoiceProcessingId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bImmediateInvoice bit,
p_szScheduleId BOS_DT_szId,
p_szRentScheduleId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szInvoicePrintingType BOS_DT_szSmallId,
p_bPrintPaymentNote bit,
p_bPrintSNReport bit,
p_bPrintAccountStatement bit,
p_bPrintDeliveryReport bit,
p_szPromoPriceOrderId BOS_DT_szId,
p_decProcessIfAmount BOS_DT_szId,
p_decProcessIfDlvCnt BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_InvoiceProcessing
(
szInvoiceProcessingId,
szDescription,
bImmediateInvoice,
szScheduleId,
szRentScheduleId,
szPriceOrderId,
szInvoicePrintingType,
bPrintPaymentNote,
bPrintSNReport,
bPrintAccountStatement,
bPrintDeliveryReport,
szPromoPriceOrderId,
decProcessIfAmount,
decProcessIfDlvCnt,
szPriceId,
szPromoPriceId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szInvoiceProcessingId,
p_szDescription,
p_bImmediateInvoice,
p_szScheduleId,
p_szRentScheduleId,
p_szPriceOrderId,
p_szInvoicePrintingType,
p_bPrintPaymentNote,
p_bPrintSNReport,
p_bPrintAccountStatement,
p_bPrintDeliveryReport,
p_szPromoPriceOrderId,
p_decProcessIfAmount,
p_decProcessIfDlvCnt,
p_szPriceId,
p_szPromoPriceId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_InvoiceProcessing_CreateInvoiceProcessing_013(
p_szInvoiceProcessingId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bImmediateInvoice bit,
p_szScheduleId BOS_DT_szId,
p_szRentScheduleId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szInvoicePrintingType BOS_DT_szSmallId,
p_bPrintPaymentNote bit,
p_bPrintSNReport bit,
p_bPrintAccountStatement bit,
p_bPrintDeliveryReport bit,
p_szPromoPriceOrderId BOS_DT_szId,
p_decProcessIfAmount BOS_DT_szId,
p_decProcessIfDlvCnt BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_InvoiceProcessing
(
szInvoiceProcessingId,
szDescription,
bImmediateInvoice,
szScheduleId,
szRentScheduleId,
szPriceOrderId,
szInvoicePrintingType,
bPrintPaymentNote,
bPrintSNReport,
bPrintAccountStatement,
bPrintDeliveryReport,
szPromoPriceOrderId,
decProcessIfAmount,
decProcessIfDlvCnt,
szPriceId,
szPromoPriceId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szInvoiceProcessingId,
p_szDescription,
p_bImmediateInvoice,
p_szScheduleId,
p_szRentScheduleId,
p_szPriceOrderId,
p_szInvoicePrintingType,
p_bPrintPaymentNote,
p_bPrintSNReport,
p_bPrintAccountStatement,
p_bPrintDeliveryReport,
p_szPromoPriceOrderId,
p_decProcessIfAmount,
p_decProcessIfDlvCnt,
p_szPriceId,
p_szPromoPriceId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_InvoiceProcessing_DeleteInvoiceProcessing(
p_szInvoiceProcessingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_InvoiceProcessing
WHERE
szInvoiceProcessingId = p_szInvoiceProcessingId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_InvoiceProcessing_DEV_DeleteALL()
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_InvoiceProcessing;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_InvoiceProcessing_GetInvoiceProcessing(
p_szInvoiceProcessingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
bImmediateInvoice,
szScheduleId,
szRentScheduleId,
szPriceOrderId,
szInvoicePrintingType,
bPrintPaymentNote,
bPrintSNReport,
bPrintAccountStatement,
bPrintDeliveryReport,
szPromoPriceOrderId,
decProcessIfAmount,
decProcessIfDlvCnt,
szPriceId,
szPromoPriceId,

dtmLastUpdated,
bAlreadyTransferred


FROM 
BOS_SD_InvoiceProcessing
WHERE 
szInvoiceProcessingId = p_szInvoiceProcessingId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_InvoiceProcessing_GetListOfInvoiceProcessing()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szInvoiceProcessingId,
szDescription,
szScheduleId,
szRentScheduleId,
decProcessIfAmount,
decProcessIfDlvCnt

FROM 
BOS_SD_InvoiceProcessing

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_InvoiceProcessing_IsInvoiceProcessingExist(
p_szInvoiceProcessingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szInvoiceProcessingId

FROM 
BOS_SD_InvoiceProcessing
WHERE 
szInvoiceProcessingId = p_szInvoiceProcessingId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_InvoiceProcessing_LockInvoiceProcessing(
p_szInvoiceProcessingId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_InvoiceProcessing
SET 
bPrintPaymentNote = bPrintPaymentNote
WHERE 
szInvoiceProcessingId = p_szInvoiceProcessingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_InvoiceProcessing_UpdateInvoiceProcessing(
p_szInvoiceProcessingId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bImmediateInvoice bit,
p_szScheduleId BOS_DT_szId,
p_szRentScheduleId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szInvoicePrintingType BOS_DT_szSmallId,
p_bPrintPaymentNote bit,
p_bPrintSNReport bit,
p_bPrintAccountStatement bit,
p_bPrintDeliveryReport bit,
p_szPromoPriceOrderId BOS_DT_szId,
p_decProcessIfAmount BOS_DT_szId,
p_decProcessIfDlvCnt BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_InvoiceProcessing
SET 
szDescription = p_szDescription,
szScheduleId = p_szScheduleId,
szRentScheduleId = p_szRentScheduleId,
bImmediateInvoice = p_bImmediateInvoice,
szPriceOrderId = p_szPriceOrderId,
szInvoicePrintingType = p_szInvoicePrintingType,
bPrintPaymentNote = p_bPrintPaymentNote,
bPrintSNReport = p_bPrintSNReport,
bPrintAccountStatement = p_bPrintAccountStatement,
bPrintDeliveryReport = p_bPrintDeliveryReport,
szPromoPriceOrderId = p_szPromoPriceOrderId,
decProcessIfAmount = p_decProcessIfAmount,
decProcessIfDlvCnt = p_decProcessIfDlvCnt,
szPriceId = p_szPriceId,
szPromoPriceId = p_szPromoPriceId

WHERE 
szInvoiceProcessingId = p_szInvoiceProcessingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_InvoiceProcessing_UpdateInvoiceProcessing_013(
p_szInvoiceProcessingId BOS_DT_szId,
p_szDescription BOS_DT_szDescription,
p_bImmediateInvoice bit,
p_szScheduleId BOS_DT_szId,
p_szRentScheduleId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szInvoicePrintingType BOS_DT_szSmallId,
p_bPrintPaymentNote bit,
p_bPrintSNReport bit,
p_bPrintAccountStatement bit,
p_bPrintDeliveryReport bit,
p_szPromoPriceOrderId BOS_DT_szId,
p_decProcessIfAmount BOS_DT_szId,
p_decProcessIfDlvCnt BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_InvoiceProcessing
SET 
szDescription = p_szDescription,
szScheduleId = p_szScheduleId,
szRentScheduleId = p_szRentScheduleId,
bImmediateInvoice = p_bImmediateInvoice,
szPriceOrderId = p_szPriceOrderId,
szInvoicePrintingType = p_szInvoicePrintingType,
bPrintPaymentNote = p_bPrintPaymentNote,
bPrintSNReport = p_bPrintSNReport,
bPrintAccountStatement = p_bPrintAccountStatement,
bPrintDeliveryReport = p_bPrintDeliveryReport,
szPromoPriceOrderId = p_szPromoPriceOrderId,
decProcessIfAmount = p_decProcessIfAmount,
decProcessIfDlvCnt = p_decProcessIfDlvCnt,
szPriceId = p_szPriceId,
szPromoPriceId = p_szPromoPriceId

WHERE 
szInvoiceProcessingId = p_szInvoiceProcessingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RebateProcessing_CreateRebateProcessing(
p_szRebateProcessingId varchar,
p_szDescription BOS_DT_szDescription,
p_szOrderItemTypeId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_RebateProcessing
(
szRebateProcessingId,
szDescription,
szOrderItemTypeId,
szPriceOrderId,
szPromoPriceOrderId
)
VALUES
(
p_szRebateProcessingId,
p_szDescription,
p_szOrderItemTypeId,
p_szPriceOrderId,
p_szPromoPriceOrderId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RebateProcessing_DeleteRebateProcessing(
p_szRebateProcessingId varchar)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_RebateProcessing
WHERE
szRebateProcessingId = p_szRebateProcessingId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RebateProcessing_GetListOfRebateProcessing()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRebateProcessingId,
szDescription

FROM 
BOS_SD_RebateProcessing

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RebateProcessing_GetRebateProcessing(
p_szRebateProcessingId varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription,
szOrderItemTypeId,
szPriceOrderId,
szPromoPriceOrderId


FROM 
BOS_SD_RebateProcessing
WHERE 
szRebateProcessingId = p_szRebateProcessingId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RebateProcessing_IsRebateProcessingExist(
p_szRebateProcessingId varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRebateProcessingId

FROM 
BOS_SD_RebateProcessing
WHERE 
szRebateProcessingId = p_szRebateProcessingId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RebateProcessing_LockRebateProcessing(
p_szRebateProcessingId varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_RebateProcessing
SET 
szDescription = szDescription
WHERE 
szRebateProcessingId = p_szRebateProcessingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RebateProcessing_UpdateRebateProcessing(
p_szRebateProcessingId varchar,
p_szDescription BOS_DT_szDescription,
p_szOrderItemTypeId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_RebateProcessing
SET 
szDescription = p_szDescription,
szOrderItemTypeId = p_szOrderItemTypeId,
szPriceOrderId = p_szPriceOrderId,
szPromoPriceOrderId = p_szPromoPriceOrderId

WHERE 
szRebateProcessingId = p_szRebateProcessingId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RemainStockInCustomer_CreateRemainStockInCustomer(
p_szCustId BOS_DT_szId,
p_dtmDate timestamp,
p_szProductId BOS_DT_szId,
p_szProductCategory BOS_DT_szId,
p_decUomRemainQty BOS_DT_decAmount,
p_decRemainQty BOS_DT_decAmount,
p_decUomDisplayQty BOS_DT_decAmount,
p_decDisplayQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szSalesId BOS_DT_szId,
p_szRoutineType BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_RemainStockInCustomer
(
szCustId,
dtmDate,
szProductId,
szProductCategory,
decUomRemainQty,
decRemainQty,
decUomDisplayQty,
decDisplayQty,
szUomId,
szSalesId,
szRoutineType,
szWorkplaceId,
szTeamId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCustId,
p_dtmDate,
p_szProductId,
p_szProductCategory,
p_decUomRemainQty,
p_decRemainQty,
p_decUomDisplayQty,
p_decDisplayQty,
p_szUomId,
p_szSalesId,
p_szRoutineType,
p_szWorkplaceId,
p_szTeamId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RemainStockInCustomer_CreateRemainStockInCustomer_014(
p_szCustId BOS_DT_szId,
p_dtmDate timestamp,
p_szProductId BOS_DT_szId,
p_szProductCategory BOS_DT_szId,
p_decUomRemainQty BOS_DT_decAmount,
p_decRemainQty BOS_DT_decAmount,
p_decUomDisplayQty BOS_DT_decAmount,
p_decDisplayQty BOS_DT_decAmount,
p_szUomId BOS_DT_szMediumId,
p_szSalesId BOS_DT_szId,
p_szRoutineType BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_RemainStockInCustomer
(
szCustId,
dtmDate,
szProductId,
szProductCategory,
decUomRemainQty,
decRemainQty,
decUomDisplayQty,
decDisplayQty,
szUomId,
szSalesId,
szRoutineType,
szWorkplaceId,
szTeamId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCustId,
p_dtmDate,
p_szProductId,
p_szProductCategory,
p_decUomRemainQty,
p_decRemainQty,
p_decUomDisplayQty,
p_decDisplayQty,
p_szUomId,
p_szSalesId,
p_szRoutineType,
p_szWorkplaceId,
p_szTeamId,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RemainStockInCustomer_DeleteRemainStockInCustomer(
p_szCustId BOS_DT_szId,
p_dtmDate timestamp,
p_szSalesId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_SD_RemainStockInCustomer
WHERE
szCustId = p_szCustId AnddtmDate >= p_dtmDate And dtmDate < DATEADD(DAY, 1, p_dtmDate) AndszSalesId = p_szSalesId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RemainStockInCustomer_DeleteRemainStockInCustomer_014(
p_szCustId BOS_DT_szId,
p_dtmDate timestamp,
p_szSalesId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_SD_RemainStockInCustomer
WHERE
szCustId = p_szCustId AnddtmDate >= p_dtmDate And dtmDate < DATEADD(DAY, 1, p_dtmDate) AndszSalesId = p_szSalesId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RemainStockInCustomer_GetRemainStockInCustomer(
p_szCustId BOS_DT_szId,
p_dtmDate timestamp,
p_szSalesId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
COALESCE(BAC.szName, '') As szCustName,
BSRS.szProductId,
COALESCE(BIP.szName, '') As szProductName_J,
BSRS.szProductCategory As szProductCategory,

BSRS.szSalesId,
ISNULL(EMP.szName, '') AS szSalesName_J,
BSRS.szRoutineType,
BSRS.szWorkplaceId,
ISNULL(WP.szName, '') AS szWorkplaceName_J,
BSRS.szTeamId,
ISNULL(TM.szDescription, '') AS szTeamName_J,

BIP.szQtyFormat AS szProductQtyFormat_J,
BIP.szUomId AS szProductUomId_J,
BIP.szCompUomId AS szProductCompUomId_J,
BIP.szUomClassId AS szProductUomClassId_J,

BSRS.decUomRemainQty,
BSRS.decRemainQty,

BSRS.decUomDisplayQty,
BSRS.decDisplayQty,

BSRS.szUomId,
BSRS.dtmLastUpdated,
BSRS.bAlreadyTransferred


FROM 
BOS_SD_RemainStockInCustomer As BSRS
Left Join BOS_INV_Product As BIP On BSRS.szProductId = BIP.szProductId
Left Join BOS_AR_Customer As BAC On BSRS.szCustId = BAC.szCustId
Left Join BOS_PI_Employee As EMP On EMP.szEmployeeId = BSRS.szSalesId
Left Join BOS_PI_Team As TM On TM.szTeamId = BSRS.szTeamId
Left Join BOS_GL_Workplace As WP On WP.szWorkplaceId = BSRS.szWorkplaceId
WHERE 
BSRS.szCustId = p_szCustId And BSRS.dtmDate >= p_dtmDate And BSRS.dtmDate < DATEADD(DAY, 1, p_dtmDate) And BSRS.szSalesId = p_szSalesId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RemainStockInCustomer_GetRemainStockInCustomer_014(
p_szCustId BOS_DT_szId,
p_dtmDate timestamp,
p_szSalesId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
COALESCE(BAC.szName, '') As szCustName,
BSRS.szProductId,
COALESCE(BIP.szName, '') As szProductName_J,
BSRS.szProductCategory As szProductCategory,

BSRS.szSalesId,
ISNULL(EMP.szName, '') AS szSalesName_J,
BSRS.szRoutineType,
BSRS.szWorkplaceId,
ISNULL(WP.szName, '') AS szWorkplaceName_J,
BSRS.szTeamId,
ISNULL(TM.szDescription, '') AS szTeamName_J,

BIP.szQtyFormat AS szProductQtyFormat_J,
BIP.szUomId AS szProductUomId_J,
BIP.szCompUomId AS szProductCompUomId_J,
BIP.szUomClassId AS szProductUomClassId_J,

BSRS.decUomRemainQty,
BSRS.decRemainQty,

BSRS.decUomDisplayQty,
BSRS.decDisplayQty,

BSRS.szUomId,
BSRS.dtmLastUpdated,
BSRS.bAlreadyTransferred


FROM 
BOS_SD_RemainStockInCustomer As BSRS
Left Join BOS_INV_Product As BIP On BSRS.szProductId = BIP.szProductId
Left Join BOS_AR_Customer As BAC On BSRS.szCustId = BAC.szCustId
Left Join BOS_PI_Employee As EMP On EMP.szEmployeeId = BSRS.szSalesId
Left Join BOS_PI_Team As TM On TM.szTeamId = BSRS.szTeamId
Left Join BOS_GL_Workplace As WP On WP.szWorkplaceId = BSRS.szWorkplaceId
WHERE 
BSRS.szCustId = p_szCustId And BSRS.dtmDate >= p_dtmDate And BSRS.dtmDate < DATEADD(DAY, 1, p_dtmDate) And BSRS.szSalesId = p_szSalesId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RemainStockInCustomer_IsRemainStockInCustomerExist(
p_szCustId BOS_DT_szId,
p_dtmDate timestamp,
p_szSalesId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId

FROM 
BOS_SD_RemainStockInCustomer
WHERE 
szCustId = p_szCustId And dtmDate >= p_dtmDate And dtmDate < DATEADD(DAY, 1, p_dtmDate) And szSalesId = p_szSalesId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RemainStockInCustomer_IsRemainStockInCustomerExist_014(
p_szCustId BOS_DT_szId,
p_dtmDate timestamp,
p_szSalesId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId

FROM 
BOS_SD_RemainStockInCustomer
WHERE 
szCustId = p_szCustId And dtmDate >= p_dtmDate And dtmDate < DATEADD(DAY, 1, p_dtmDate) And szSalesId = p_szSalesId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RemainStockInCustomer_LockRemainStockInCustomer(
p_szCustId BOS_DT_szId,
p_dtmDate timestamp,
p_szSalesId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_RemainStockInCustomer
SET 
szUomId = szUomId
WHERE 
szCustId = p_szCustId And;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RemainStockInCustomer_LockRemainStockInCustomer_014(
p_szCustId BOS_DT_szId,
p_dtmDate timestamp,
p_szSalesId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_RemainStockInCustomer
SET 
szUomId = szUomId
WHERE 
szCustId = p_szCustId And;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentalProduct_CreateRentalProduct(
p_szSerNum varchar,
p_szCustId BOS_DT_szId,
p_szOrderItemType varchar,
p_bTaxable bit,
p_decCharge BOS_DT_decAmount,
p_szCcyId BOS_DT_szSmallId,
p_dtmLastInvoiced timestamp,
p_dtmPrevLastInvoiced timestamp,
p_szStatusId varchar,
p_bTrouble bit,
p_szTroubleDescr varchar,
p_szRentChargeCalcId BOS_DT_szId,
p_szUrl BOS_DT_szUrl,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szReasonId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_RentalProduct
(
szSerNum,
szCustId,
szOrderItemType,
bTaxable,
decCharge,
szCcyId,
dtmLastInvoiced,
dtmPrevLastInvoiced,
szStatusId,
bTrouble,
szTroubleDescr,
szRentChargeCalcId,
szUrl,
szTrnId,
szDocId,
szReasonId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szSerNum,
p_szCustId,
p_szOrderItemType,
p_bTaxable,
p_decCharge,
p_szCcyId,
p_dtmLastInvoiced,
p_dtmPrevLastInvoiced,
p_szStatusId,
p_bTrouble,
p_szTroubleDescr,
p_szRentChargeCalcId,
p_szUrl,
p_szTrnId,
p_szDocId,
p_szReasonId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentalProduct_CreateRentalProduct_013(
p_szSerNum varchar,
p_szCustId BOS_DT_szId,
p_szOrderItemType varchar,
p_bTaxable bit,
p_decCharge BOS_DT_decAmount,
p_szCcyId BOS_DT_szSmallId,
p_dtmLastInvoiced timestamp,
p_dtmPrevLastInvoiced timestamp,
p_szStatusId varchar,
p_bTrouble bit,
p_szTroubleDescr varchar,
p_szRentChargeCalcId BOS_DT_szId,
p_szUrl BOS_DT_szUrl,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_szReasonId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_RentalProduct
(
szSerNum,
szCustId,
szOrderItemType,
bTaxable,
decCharge,
szCcyId,
dtmLastInvoiced,
dtmPrevLastInvoiced,
szStatusId,
bTrouble,
szTroubleDescr,
szRentChargeCalcId,
szUrl,
szTrnId,
szDocId,
szReasonId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szSerNum,
p_szCustId,
p_szOrderItemType,
p_bTaxable,
p_decCharge,
p_szCcyId,
p_dtmLastInvoiced,
p_dtmPrevLastInvoiced,
p_szStatusId,
p_bTrouble,
p_szTroubleDescr,
p_szRentChargeCalcId,
p_szUrl,
p_szTrnId,
p_szDocId,
p_szReasonId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentalProduct_DeleteRentalProduct(
p_szSerNum varchar)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_SD_RentalProduct
WHERE
szSerNum = p_szSerNum;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentalProduct_GetListOfRentalProduct()
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_RentalProduct.szSerNum,
BOS_INV_StockSnProduct.szProductId

FROM 
BOS_SD_RentalProduct
left join BOS_INV_StockSnProduct on BOS_SD_RentalProduct.szSerNum = BOS_INV_StockSnProduct.szProductSN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentalProduct_GetListOfRentalProductForCustomWorkplace(
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BSRP.szSerNum, BSRP.szCustId

FROM 
BOS_SD_RentalProduct As BSRP
Left Join BOS_AR_Customer As BAC On BSRP.szCustId = BAC.szCustId
WHERE 
BAC.szDlvWorkplaceId Like p_szWorkplaceId ;ORDER BY 
BSRP.szSerNum, BSRP.szCustId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentalProduct_GetListOfRentalProductWhereCustProductSn(
p_szCustId BOS_DT_szId,
p_szProductId BOS_DT_szId,
p_szSerNum varchar)
RETURNS void AS
$BODY$
BEGIN
select
-- Fields from StockSnProduct.
BOS_INV_StockSnProduct.szProductId,
BOS_INV_StockSnProduct.dtmLastChecked AS dtmLastChecked_J,
BOS_INV_StockSnProduct.szSuppId AS szSuppId_J,
BOS_INV_StockSnProduct.szCheckerId AS szCheckerId_J,
BOS_INV_StockSnProduct.szChassisNumber AS szChassisNumber_J,

Product.szName as szProductNm_J,	
Product.szDiscountGroupId as szProductDiscGroupId_J,
Product.szQtyFormat AS szProductQtyFormat_J,
Product.szUomId AS szProductUomId_J,
Product.szUomClassId AS szProductUomClassId_J,
Product.szCompUomId AS szProductCompUomId_J,
BOS_GL_TaxType.decRate AS decProductTaxRate_J,

BOS_SD_RentalProduct.szSerNum,
BOS_SD_RentalProduct.szCustId,

BOS_SD_RentalProduct.szOrderItemType, 
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,

BOS_SD_RentalProduct.bTaxable,
BOS_SD_RentalProduct.decCharge,
BOS_SD_RentalProduct.szCcyId,
BOS_SD_RentalProduct.dtmLastInvoiced,
BOS_SD_RentalProduct.dtmPrevLastInvoiced,
BOS_SD_RentalProduct.szStatusId,
BOS_SD_RentalProduct.bTrouble,
BOS_SD_RentalProduct.szTroubleDescr,
BOS_SD_RentalProduct.szRentChargeCalcId,
BOS_SD_RentalProduct.szUrl,
BOS_SD_RentalProduct.szTrnId,
BOS_SD_RentalProduct.szDocId,
BOS_SD_RentalProduct.szReasonId,

-- Data Status.
BOS_SD_RentalProduct.dtmLastUpdated,
BOS_SD_RentalProduct.bAlreadyTransferred

from 
BOS_SD_RentalProduct
LEFT JOIN BOS_INV_StockSnProduct on BOS_INV_StockSnProduct.szProductSN = BOS_SD_RentalProduct.szSerNum
left join BOS_INV_Product as Product on Product.szProductId = BOS_INV_StockSnProduct.szProductId
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = Product.szTaxTypeId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_SD_RentalProduct.szOrderItemType

where
BOS_SD_RentalProduct.szCustId like p_szCustId and 
BOS_INV_StockSnProduct.szProductId like p_szProductId and 
BOS_SD_RentalProduct.szSerNum like p_szSerNum

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentalProduct_GetRentalProduct(
p_szSerNum varchar)
RETURNS void AS
$BODY$
BEGIN

select
-- Fields from StockSnProduct.
BOS_INV_StockSnProduct.szProductId,
BOS_INV_StockSnProduct.dtmLastChecked AS dtmLastChecked_J,
BOS_INV_StockSnProduct.szSuppId AS szSuppId_J,
BOS_INV_StockSnProduct.szCheckerId AS szCheckerId_J,
BOS_INV_StockSnProduct.szChassisNumber AS szChassisNumber_J,

BOS_INV_Product.szName as szProductNm_J,
BOS_INV_Product.szDiscountGroupId as szProductDiscGroupId_J,
BOS_INV_Product.szQtyFormat AS szProductQtyFormat_J,
BOS_INV_Product.szUomId AS szProductUomId_J,
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,
BOS_GL_TaxType.decRate as decProductTaxRate_J,

BOS_SD_RentalProduct.szSerNum,
BOS_SD_RentalProduct.szCustId,

BOS_SD_RentalProduct.szOrderItemType, 
BOS_INV_OrderItemType.szTrnType AS szOrderItemTypeTrnType_J,

BOS_SD_RentalProduct.bTaxable,
BOS_SD_RentalProduct.decCharge,
BOS_SD_RentalProduct.szCcyId,
BOS_SD_RentalProduct.dtmLastInvoiced,
BOS_SD_RentalProduct.dtmPrevLastInvoiced,
BOS_SD_RentalProduct.szStatusId,
BOS_SD_RentalProduct.bTrouble,
BOS_SD_RentalProduct.szTroubleDescr,
BOS_SD_RentalProduct.szRentChargeCalcId,
BOS_SD_RentalProduct.szUrl,
BOS_SD_RentalProduct.szTrnId,
BOS_SD_RentalProduct.szDocId,
BOS_SD_RentalProduct.szReasonId,

-- Data Status.
BOS_SD_RentalProduct.dtmLastUpdated,
BOS_SD_RentalProduct.bAlreadyTransferred

from 
BOS_SD_RentalProduct
LEFT JOIN BOS_INV_StockSnProduct ON BOS_INV_StockSnProduct.szProductSN = BOS_SD_RentalProduct.szSerNum
left join BOS_INV_Product on BOS_INV_StockSnProduct.szProductId = BOS_INV_Product.szProductId
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId
LEFT JOIN BOS_INV_OrderItemType ON BOS_INV_OrderItemType.szOrderItemTypeId = BOS_SD_RentalProduct.szOrderItemType
where
BOS_SD_RentalProduct.szSerNum = p_szSerNum

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentalProduct_IsRentalProductExist(
p_szSerNum varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szSerNum

FROM 
BOS_SD_RentalProduct
WHERE 
szSerNum = p_szSerNum ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentalProduct_LockRentalProduct(
p_szSerNum varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_RentalProduct
SET 
bTaxable = bTaxable
WHERE 
szSerNum = p_szSerNum;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentalProduct_SetTrouble(
p_szSerNum varchar,
p_bTrouble bit,
p_szTroubleDescr varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_RentalProduct
SET 
bTrouble = p_bTrouble,
szTroubleDescr = p_szTroubleDescr

WHERE 
szSerNum = p_szSerNum;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentalProduct_UpdateLastInvoiced(
p_szSerNum varchar,
p_dtmLastInvoiced timestamp,
p_dtmPrevLastInvoiced timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_RentalProduct
SET 
dtmLastInvoiced = p_dtmLastInvoiced,
dtmPrevLastInvoiced = p_dtmPrevLastInvoiced
WHERE 
szSerNum = p_szSerNum;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentalProduct_UpdateRentalProduct(
p_szSerNum varchar,
p_szCustId BOS_DT_szId,
p_szOrderItemType varchar,
p_bTaxable bit,
p_decCharge BOS_DT_decAmount,
p_szCcyId BOS_DT_szSmallId,
p_szUrl BOS_DT_szUrl,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_bTrouble bit,
p_szTroubleDescr varchar,
p_szReasonId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_RentalProduct
SET 
szCustId = p_szCustId ,
szOrderItemType = p_szOrderItemType,
bTaxable = p_bTaxable,
decCharge = p_decCharge,
szCcyId = p_szCcyId,
szUrl = p_szUrl,
szTrnId = p_szTrnId,
szDocId = p_szDocId,
bTrouble=p_bTrouble,
szTroubleDescr=p_szTroubleDescr,
szReasonId=p_szReasonId
WHERE 
szSerNum = p_szSerNum;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentalProduct_UpdateRentalProduct_013(
p_szSerNum varchar,
p_szCustId BOS_DT_szId,
p_szOrderItemType varchar,
p_bTaxable bit,
p_decCharge BOS_DT_decAmount,
p_szCcyId BOS_DT_szSmallId,
p_szUrl BOS_DT_szUrl,
p_szTrnId BOS_DT_szMediumId,
p_szDocId BOS_DT_szId,
p_bTrouble bit,
p_szTroubleDescr varchar,
p_szReasonId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_RentalProduct
SET 
szCustId = p_szCustId ,
szOrderItemType = p_szOrderItemType,
bTaxable = p_bTaxable,
decCharge = p_decCharge,
szCcyId = p_szCcyId,
szUrl = p_szUrl,
szTrnId = p_szTrnId,
szDocId = p_szDocId,
bTrouble=p_bTrouble,
szTroubleDescr=p_szTroubleDescr,
szReasonId=p_szReasonId
WHERE 
szSerNum = p_szSerNum;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentChargeCalc_CreateRentChargeCalc(
p_szRentChargeCalcId BOS_DT_szId,
p_szChargeCalcType BOS_DT_szSmallId,
p_decValue1 BOS_DT_decAmount,
p_decValue2 BOS_DT_decAmount,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_RentChargeCalc
(
szRentChargeCalcId,
szChargeCalcType,
decValue1,
decValue2,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szRentChargeCalcId,
p_szChargeCalcType,
p_decValue1,
p_decValue2,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentChargeCalc_CreateRentChargeCalc_014(
p_szRentChargeCalcId BOS_DT_szId,
p_szChargeCalcType BOS_DT_szSmallId,
p_decValue1 BOS_DT_decAmount,
p_decValue2 BOS_DT_decAmount,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_RentChargeCalc
(
szRentChargeCalcId,
szChargeCalcType,
decValue1,
decValue2,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szRentChargeCalcId,
p_szChargeCalcType,
p_decValue1,
p_decValue2,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentChargeCalc_DeleteRentChargeCalc(
p_szRentChargeCalcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_SD_RentChargeCalc
WHERE
szRentChargeCalcId = p_szRentChargeCalcId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentChargeCalc_GetListOfRentChargeCalc()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRentChargeCalcId,
szChargeCalcType,
decValue1,
decValue2

FROM 
BOS_SD_RentChargeCalc

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentChargeCalc_GetRentChargeCalc(
p_szRentChargeCalcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRentChargeCalcId,
szChargeCalcType,
decValue1,
decValue2,

dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_SD_RentChargeCalc
WHERE 
szRentChargeCalcId = p_szRentChargeCalcId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentChargeCalc_GetRentChargeCalc_014(
p_szRentChargeCalcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRentChargeCalcId,
szChargeCalcType,
decValue1,
decValue2,

dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_SD_RentChargeCalc
WHERE 
szRentChargeCalcId = p_szRentChargeCalcId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentChargeCalc_IsRentChargeCalcExist(
p_szRentChargeCalcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRentChargeCalcId

FROM 
BOS_SD_RentChargeCalc
WHERE 
szRentChargeCalcId = p_szRentChargeCalcId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentChargeCalc_LockRentChargeCalc(
p_szRentChargeCalcId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_RentChargeCalc
SET 
szChargeCalcType = szChargeCalcType
WHERE 
szRentChargeCalcId = p_szRentChargeCalcId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RentChargeCalc_UpdateRentChargeCalc(
p_szRentChargeCalcId BOS_DT_szId,
p_szChargeCalcType BOS_DT_szSmallId,
p_decValue1 BOS_DT_decAmount,
p_decValue2 BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_RentChargeCalc
SET 
szChargeCalcType = p_szChargeCalcType,
decValue1 = p_decValue1,
decValue2 = p_decValue2
WHERE 
szRentChargeCalcId = p_szRentChargeCalcId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_CreateRoute(
p_szRouteId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_szWorkplaceId BOS_DT_szId,
p_szAreaId BOS_DT_szId,
p_szRouteType BOS_DT_szSmallId,
p_szScheduleId BOS_DT_szId,
p_szOpUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_Route
(
szRouteId,
szDescription,
szWorkplaceId,
szAreaId,
szRouteType,
szScheduleId,
szOpUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szRouteId,
p_szDescription,
p_szWorkplaceId,
p_szAreaId,
p_szRouteType,
p_szScheduleId,
p_szOpUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_CreateRoute_013(
p_szRouteId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_szWorkplaceId BOS_DT_szId,
p_szAreaId BOS_DT_szId,
p_szRouteType BOS_DT_szSmallId,
p_szScheduleId BOS_DT_szId,
p_szOpUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_Route
(
szRouteId,
szDescription,
szWorkplaceId,
szAreaId,
szRouteType,
szScheduleId,
szOpUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szRouteId,
p_szDescription,
p_szWorkplaceId,
p_szAreaId,
p_szRouteType,
p_szScheduleId,
p_szOpUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_CreateRoute_013_DRAFT(
p_szRouteId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_szWorkplaceId BOS_DT_szId,
p_szAreaId BOS_DT_szId,
p_szRouteType BOS_DT_szSmallId,
p_szScheduleId BOS_DT_szId,
p_szOpUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_Route_DRAFT
(
szRouteId,
szDescription,
szWorkplaceId,
szAreaId,
szRouteType,
szScheduleId,
szOpUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szRouteId,
p_szDescription,
p_szWorkplaceId,
p_szAreaId,
p_szRouteType,
p_szScheduleId,
p_szOpUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_CreateRoute_DRAFT(
p_szRouteId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_szWorkplaceId BOS_DT_szId,
p_szAreaId BOS_DT_szId,
p_szRouteType BOS_DT_szSmallId,
p_szScheduleId BOS_DT_szId,
p_szOpUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_Route_DRAFT
(
szRouteId,
szDescription,
szWorkplaceId,
szAreaId,
szRouteType,
szScheduleId,
szOpUserId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szRouteId,
p_szDescription,
p_szWorkplaceId,
p_szAreaId,
p_szRouteType,
p_szScheduleId,
p_szOpUserId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_CreateRouteItem(
p_szRouteId BOS_DT_szBigId,
p_intItemNumber integer,
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_RouteItem
(
szRouteId,
intItemNumber,
szCustId
)
VALUES
(
p_szRouteId,
p_intItemNumber,
p_szCustId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_CreateRouteItem_DRAFT(
p_szRouteId BOS_DT_szBigId,
p_intItemNumber integer,
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_RouteItem_DRAFT
(
szRouteId,
intItemNumber,
szCustId
)
VALUES
(
p_szRouteId,
p_intItemNumber,
p_szCustId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_DeleteRoute(
p_szRouteId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_Route
WHERE
szRouteId = p_szRouteId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_DeleteRoute_DRAFT(
p_szRouteId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_Route_DRAFT
WHERE
szRouteId = p_szRouteId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_DeleteRouteItem(
p_szRouteId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_RouteItem
WHERE
szRouteId = p_szRouteId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_DeleteRouteItem_DRAFT(
p_szRouteId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SD_RouteItem_DRAFT
WHERE
szRouteId = p_szRouteId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfOpUserRoute(
p_szOpUserId BOS_DT_szId,
p_szRouteType BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN

select
bsr.szRouteId,
bsr.szScheduleId as szRouteScheduleId,
isnull(bgr.szDescription, '') as szRouteScheduleName,
isnull(bsri.szCustId, '') as szCustId,
isnull(bac.szName, '') as szCustName,
isnull(bac.CustszAddress_1, '') as szAddr,
isnull(bac.CustszZipCode, '') as szZipCode

from
bos_sd_route as bsr 
inner join bos_sd_routeitem as bsri on bsr.szRouteId = bsri.szRouteId
left join bos_gen_routineschedule as bgr on bsr.szScheduleId = bgr.szScheduleId
left join bos_ar_customer as bac on bsri.szCustId = bac.szCustId

where
bsr.szRouteType like p_szRouteType and bsr.szOpUserId like p_szOpUserId

order by
bsr.szRouteId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfOpUserRoute_DRAFT(
p_szOpUserId BOS_DT_szId,
p_szRouteType BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN

select
bsr.szRouteId,
bsr.szScheduleId as szRouteScheduleId,
isnull(bgr.szDescription, '') as szRouteScheduleName,
isnull(bsri.szCustId, '') as szCustId,
isnull(bac.szName, '') as szCustName,
isnull(bac.CustszAddress_1, '') as szAddr,
isnull(bac.CustszZipCode, '') as szZipCode

from
bos_sd_route_DRAFT as bsr 
inner join bos_sd_routeitem_DRAFT as bsri on bsr.szRouteId = bsri.szRouteId
left join bos_gen_routineschedule as bgr on bsr.szScheduleId = bgr.szScheduleId
left join bos_ar_customer as bac on bsri.szCustId = bac.szCustId

where
bsr.szRouteType like p_szRouteType and bsr.szOpUserId like p_szOpUserId

order by
bsr.szRouteId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfPossibleCustCollRoutine(
p_szRouteTeamId BOS_DT_szId,
p_szRouteSchId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT DISTINCT 
BSCC.szCustId

FROM
BOS_GEN_RoutineSchedule AS BGR
INNER JOIN BOS_GEN_RoutineScheduleItem AS BGRI ON BGRI.szScheduleId = BGR.szScheduleId AND BGRI.shScheduleItem = 0
INNER JOIN BOS_GEN_RoutineSchedule AS BGR2 ON BGR2.szScheduleType = BGR.szScheduleType
INNER JOIN BOS_GEN_RoutineScheduleItem AS BGRI2 ON BGRI2.szScheduleId = BGR2.szScheduleId 
AND BGRI2.decValue = BGRI.decValue
INNER JOIN BOS_SD_CustCollRoutine As BSCC ON BSCC.szScheduleId = BGRI2.szScheduleId
INNER JOIN BOS_AR_Customer AS BAC ON BAC.szCustId = BSCC.szCustId
WHERE
--There's no team for collection routine.
BGRI.szScheduleId = p_szRouteSchId AND
BAC.szCollWorkplaceId = p_szWorkplaceId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfPossibleCustCollRoutine_013(
p_szRouteTeamId BOS_DT_szId,
p_szRouteSchId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT DISTINCT 
BSCC.szCustId

FROM
BOS_GEN_RoutineSchedule AS BGR
INNER JOIN BOS_GEN_RoutineScheduleItem AS BGRI ON BGRI.szScheduleId = BGR.szScheduleId AND BGRI.shScheduleItem = 0
INNER JOIN BOS_GEN_RoutineSchedule AS BGR2 ON BGR2.szScheduleType = BGR.szScheduleType
INNER JOIN BOS_GEN_RoutineScheduleItem AS BGRI2 ON BGRI2.szScheduleId = BGR2.szScheduleId 
AND BGRI2.decValue = BGRI.decValue
INNER JOIN BOS_SD_CustCollRoutine As BSCC ON BSCC.szScheduleId = BGRI2.szScheduleId
INNER JOIN BOS_AR_Customer AS BAC ON BAC.szCustId = BSCC.szCustId
WHERE
--There's no team for collection routine.
BGRI.szScheduleId = p_szRouteSchId AND
BAC.szCollWorkplaceId = p_szWorkplaceId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfPossibleCustCollRoutine_DRAFT(
p_szRouteTeamId BOS_DT_szId,
p_szRouteSchId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT DISTINCT 
BSCC.szCustId

FROM
BOS_GEN_RoutineSchedule AS BGR
INNER JOIN BOS_GEN_RoutineScheduleItem AS BGRI ON BGRI.szScheduleId = BGR.szScheduleId AND BGRI.shScheduleItem = 0
INNER JOIN BOS_GEN_RoutineSchedule AS BGR2 ON BGR2.szScheduleType = BGR.szScheduleType
INNER JOIN BOS_GEN_RoutineScheduleItem AS BGRI2 ON BGRI2.szScheduleId = BGR2.szScheduleId 
AND BGRI2.decValue = BGRI.decValue
INNER JOIN BOS_SD_CustCollRoutine_DRAFT As BSCC ON BSCC.szScheduleId = BGRI2.szScheduleId
INNER JOIN BOS_AR_Customer AS BAC ON BAC.szCustId = BSCC.szCustId
WHERE
--There's no team for collection routine.
BGRI.szScheduleId = p_szRouteSchId AND
BAC.szCollWorkplaceId = p_szWorkplaceId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfPossibleCustRoutine(
p_szRouteTeamId BOS_DT_szId,
p_szRouteSchId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT DISTINCT 
BSCI.szCustId

FROM
BOS_GEN_RoutineSchedule AS BGR
INNER JOIN BOS_GEN_RoutineScheduleItem AS BGRI ON BGRI.szScheduleId = BGR.szScheduleId AND BGRI.shScheduleItem = 0
INNER JOIN BOS_GEN_RoutineSchedule AS BGR2 ON BGR2.szScheduleType = BGR.szScheduleType
INNER JOIN BOS_GEN_RoutineScheduleItem AS BGRI2 ON BGRI2.szScheduleId = BGR2.szScheduleId 
AND BGRI2.decValue = BGRI.decValue
INNER JOIN BOS_SD_CustRoutineItem As BSCI ON BSCI.szScheduleId = BGRI2.szScheduleId AND
BSCI.decValue = BGRI2.decValue
INNER JOIN BOS_AR_Customer AS BAC ON BAC.szCustId = BSCI.szCustId

WHERE
BSCI.szTeamId = p_szRouteTeamId AND
BGRI.szScheduleId = p_szRouteSchId AND
BAC.szDlvWorkplaceId = p_szWorkplaceId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfPossibleCustRoutine_013(
p_szRouteTeamId BOS_DT_szId,
p_szRouteSchId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT DISTINCT 
BSCI.szCustId

FROM
BOS_GEN_RoutineSchedule AS BGR
INNER JOIN BOS_GEN_RoutineScheduleItem AS BGRI ON BGRI.szScheduleId = BGR.szScheduleId AND BGRI.shScheduleItem = 0
INNER JOIN BOS_GEN_RoutineSchedule AS BGR2 ON BGR2.szScheduleType = BGR.szScheduleType
INNER JOIN BOS_GEN_RoutineScheduleItem AS BGRI2 ON BGRI2.szScheduleId = BGR2.szScheduleId 
AND BGRI2.decValue = BGRI.decValue
INNER JOIN BOS_SD_CustRoutineItem As BSCI ON BSCI.szScheduleId = BGRI2.szScheduleId AND
BSCI.decValue = BGRI2.decValue
INNER JOIN BOS_AR_Customer AS BAC ON BAC.szCustId = BSCI.szCustId

WHERE
BSCI.szTeamId = p_szRouteTeamId AND
BGRI.szScheduleId = p_szRouteSchId AND
BAC.szDlvWorkplaceId = p_szWorkplaceId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfPossibleCustRoutine_DRAFT(
p_szRouteTeamId BOS_DT_szId,
p_szRouteSchId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT DISTINCT 
BSCI.szCustId

FROM
BOS_GEN_RoutineSchedule AS BGR
INNER JOIN BOS_GEN_RoutineScheduleItem AS BGRI ON BGRI.szScheduleId = BGR.szScheduleId AND BGRI.shScheduleItem = 0
INNER JOIN BOS_GEN_RoutineSchedule AS BGR2 ON BGR2.szScheduleType = BGR.szScheduleType
INNER JOIN BOS_GEN_RoutineScheduleItem AS BGRI2 ON BGRI2.szScheduleId = BGR2.szScheduleId 
AND BGRI2.decValue = BGRI.decValue
INNER JOIN BOS_SD_CustRoutineItem_DRAFT As BSCI ON BSCI.szScheduleId = BGRI2.szScheduleId AND
BSCI.decValue = BGRI2.decValue
INNER JOIN BOS_AR_Customer AS BAC ON BAC.szCustId = BSCI.szCustId

WHERE
BSCI.szTeamId = p_szRouteTeamId AND
BGRI.szScheduleId = p_szRouteSchId AND
BAC.szDlvWorkplaceId = p_szWorkplaceId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfPossibleCustTakingOrderRoutine(
p_szRouteTeamId BOS_DT_szId,
p_szRouteSchId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT DISTINCT
BSCRI.szCustId

FROM
BOS_GEN_RoutineSchedule AS BGR
INNER JOIN BOS_GEN_RoutineScheduleItem AS BGRI ON BGRI.szScheduleId = BGR.szScheduleId AND BGRI.shScheduleItem = 0
INNER JOIN BOS_GEN_RoutineSchedule AS BGR2 ON BGR2.szScheduleType = BGR.szScheduleType
INNER JOIN BOS_GEN_RoutineScheduleItem AS BGRI2 ON BGRI2.szScheduleId = BGR2.szScheduleId AND 
BGRI2.decValue = BGRI.decValue
INNER JOIN BOS_SD_CustTORoutineItem As BSCRI ON BSCRI.szScheduleId = BGRI2.szScheduleId AND
BSCRI.decValue = BGRI2.decValue
INNER JOIN BOS_AR_Customer AS BAC ON BAC.szCustId = BSCRI.szCustId

WHERE
BSCRI.szTeamId = p_szRouteTeamId AND
BGRI.szScheduleId = p_szRouteSchId AND
BAC.szDlvWorkplaceId = p_szWorkplaceId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfPossibleCustTakingOrderRoutine_013(
p_szRouteTeamId BOS_DT_szId,
p_szRouteSchId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT DISTINCT
BSCRI.szCustId

FROM
BOS_GEN_RoutineSchedule AS BGR
INNER JOIN BOS_GEN_RoutineScheduleItem AS BGRI ON BGRI.szScheduleId = BGR.szScheduleId AND BGRI.shScheduleItem = 0
INNER JOIN BOS_GEN_RoutineSchedule AS BGR2 ON BGR2.szScheduleType = BGR.szScheduleType
INNER JOIN BOS_GEN_RoutineScheduleItem AS BGRI2 ON BGRI2.szScheduleId = BGR2.szScheduleId AND 
BGRI2.decValue = BGRI.decValue
INNER JOIN BOS_SD_CustTORoutineItem As BSCRI ON BSCRI.szScheduleId = BGRI2.szScheduleId AND
BSCRI.decValue = BGRI2.decValue
INNER JOIN BOS_AR_Customer AS BAC ON BAC.szCustId = BSCRI.szCustId

WHERE
BSCRI.szTeamId = p_szRouteTeamId AND
BGRI.szScheduleId = p_szRouteSchId AND
BAC.szDlvWorkplaceId = p_szWorkplaceId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfPossibleCustTakingOrderRoutine_DRAFT(
p_szRouteTeamId BOS_DT_szId,
p_szRouteSchId BOS_DT_szId,
p_szWorkplaceId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT DISTINCT
BSCRI.szCustId

FROM
BOS_GEN_RoutineSchedule AS BGR
INNER JOIN BOS_GEN_RoutineScheduleItem AS BGRI ON BGRI.szScheduleId = BGR.szScheduleId AND BGRI.shScheduleItem = 0
INNER JOIN BOS_GEN_RoutineSchedule AS BGR2 ON BGR2.szScheduleType = BGR.szScheduleType
INNER JOIN BOS_GEN_RoutineScheduleItem AS BGRI2 ON BGRI2.szScheduleId = BGR2.szScheduleId AND 
BGRI2.decValue = BGRI.decValue
INNER JOIN BOS_SD_CustTORoutineItem_DRAFT As BSCRI ON BSCRI.szScheduleId = BGRI2.szScheduleId AND
BSCRI.decValue = BGRI2.decValue
INNER JOIN BOS_AR_Customer AS BAC ON BAC.szCustId = BSCRI.szCustId

WHERE
BSCRI.szTeamId = p_szRouteTeamId AND
BGRI.szScheduleId = p_szRouteSchId AND
BAC.szDlvWorkplaceId = p_szWorkplaceId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfRouteByTypeCustomerTeamRouteSch(
p_szRouteType BOS_DT_szSmallId,
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_szRouteSchId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

Select
BSRI.szRouteId

From
BOS_SD_Route As BSR 
INNER JOIN BOS_SD_RouteItem AS BSRI ON BSR.szRouteId = BSRI.szRouteId

INNER JOIN BOS_PI_Employee AS R_E ON R_E.szEmployeeId = BSR.szOpUserId

Where
BSR.szRouteType = p_szRouteType
AND BSRI.szCustId = p_szCustId
AND R_E.szTeamId LIKE p_szTeamId		--USE LIKE BECOZ COLLECTION DOESN'T SUPPORT TEAM.
AND BSR.szScheduleId = p_szRouteSchId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfRouteByTypeCustomerTeamRouteSch_013(
p_szRouteType BOS_DT_szSmallId,
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_szRouteSchId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

Select
BSRI.szRouteId

From
BOS_SD_Route As BSR 
INNER JOIN BOS_SD_RouteItem AS BSRI ON BSR.szRouteId = BSRI.szRouteId

INNER JOIN BOS_PI_Employee AS R_E ON R_E.szEmployeeId = BSR.szOpUserId

Where
BSR.szRouteType = p_szRouteType
AND BSRI.szCustId = p_szCustId
AND R_E.szTeamId LIKE p_szTeamId		--USE LIKE BECOZ COLLECTION DOESN'T SUPPORT TEAM.
AND BSR.szScheduleId = p_szRouteSchId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfRouteByTypeCustomerTeamRouteSch_DRAFT(
p_szRouteType BOS_DT_szSmallId,
p_szCustId BOS_DT_szId,
p_szTeamId BOS_DT_szId,
p_szRouteSchId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

Select
BSRI.szRouteId

From
BOS_SD_Route_DRAFT As BSR 
INNER JOIN BOS_SD_RouteItem_DRAFT AS BSRI ON BSR.szRouteId = BSRI.szRouteId

INNER JOIN BOS_PI_Employee AS R_E ON R_E.szEmployeeId = BSR.szOpUserId

Where
BSR.szRouteType = p_szRouteType
AND BSRI.szCustId = p_szCustId
AND R_E.szTeamId LIKE p_szTeamId		--USE LIKE BECOZ COLLECTION DOESN'T SUPPORT TEAM.
AND BSR.szScheduleId = p_szRouteSchId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfRouteWhereEmployee(
p_szId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRouteId,
szDescription,
szScheduleId,
szRouteType

FROM 
BOS_SD_Route
WHERE 
szOpUserId LIKE p_szId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfRouteWhereEmployee_DRAFT(
p_szId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRouteId,
szDescription,
szScheduleId,
szRouteType

FROM 
BOS_SD_Route_DRAFT
WHERE 
szOpUserId LIKE p_szId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfRouteWhereType(
p_szId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRouteId,
szDescription,
szScheduleId,
szRouteType

FROM 
BOS_SD_Route
WHERE 
szRouteType LIKE p_szId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfRouteWhereType_DRAFT(
p_szId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRouteId,
szDescription,
szScheduleId,
szRouteType

FROM 
BOS_SD_Route_DRAFT
WHERE 
szRouteType LIKE p_szId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfRouteWhereWorkplace(
p_szId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRouteId,
szDescription,
szScheduleId,
szRouteType

FROM 
BOS_SD_Route
WHERE 
szWorkplaceId LIKE p_szId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetListOfRouteWhereWorkplace_DRAFT(
p_szId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRouteId,
szDescription,
szScheduleId,
szRouteType

FROM 
BOS_SD_Route_DRAFT
WHERE 
szWorkplaceId LIKE p_szId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetRoute(
p_szRouteId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_Route.szRouteId,
BOS_SD_Route.szDescription,
BOS_SD_Route.szWorkplaceId,
BOS_SD_Route.szAreaId,
BOS_SD_Route.szRouteType,

BOS_SD_Route.szScheduleId,
BOS_GEN_RoutineSchedule.szDescription As szScheduleName_J,
BOS_GEN_RoutineSchedule.szScheduleType AS szScheduleType_J,
BGRSI.decValue AS decScheduleValue_J,

BOS_SD_Route.szOpUserId,
ISNULL(BOS_PI_Employee.szName,'') AS szOpUserNm,
ISNULL(((CASE WHEN BOS_PI_Employee.szTeamId = '' THEN MGM.szTeamId ELSE BOS_PI_Employee.szTeamId END)), MGM.szTeamId)AS szOpUserTeamId_J,
BOS_PI_Employee.szWorkplaceId AS szOpUserWorkplaceId_J,

-- Data Status.
BOS_SD_Route.dtmLastUpdated,
BOS_SD_Route.bAlreadyTransferred
FROM
BOS_SD_Route LEFT JOIN BOS_PI_Employee ON BOS_SD_Route.szOpUserId = BOS_PI_Employee.szEmployeeId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_SD_Route.szScheduleId = BOS_GEN_RoutineSchedule.szScheduleId
LEFT JOIN BOS_GEN_RoutineScheduleItem AS BGRSI ON BGRSI.szScheduleId = BOS_GEN_RoutineSchedule.szScheduleId AND
BGRSI.shScheduleItem = 0
LEFT JOIN BOS_SD_MGM_Area MGM ON MGM.szAreaId = BOS_SD_Route.szAreaId 

WHERE
BOS_SD_Route.szRouteId = p_szRouteId

SET ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetRoute_013(
p_szRouteId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_Route.szRouteId,
BOS_SD_Route.szDescription,
BOS_SD_Route.szWorkplaceId,
BOS_SD_Route.szAreaId,
BOS_SD_Route.szRouteType,

BOS_SD_Route.szScheduleId,
BOS_GEN_RoutineSchedule.szDescription As szScheduleName_J,
BOS_GEN_RoutineSchedule.szScheduleType AS szScheduleType_J,
BGRSI.decValue AS decScheduleValue_J,

BOS_SD_Route.szOpUserId,
ISNULL(BOS_PI_Employee.szName,'') AS szOpUserNm,
ISNULL(((CASE WHEN BOS_PI_Employee.szTeamId = '' THEN MGM.szTeamId ELSE BOS_PI_Employee.szTeamId END)), MGM.szTeamId)AS szOpUserTeamId_J,
BOS_PI_Employee.szWorkplaceId AS szOpUserWorkplaceId_J,

-- Data Status.
BOS_SD_Route.dtmLastUpdated,
BOS_SD_Route.bAlreadyTransferred
FROM
BOS_SD_Route LEFT JOIN BOS_PI_Employee ON BOS_SD_Route.szOpUserId = BOS_PI_Employee.szEmployeeId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_SD_Route.szScheduleId = BOS_GEN_RoutineSchedule.szScheduleId
LEFT JOIN BOS_GEN_RoutineScheduleItem AS BGRSI ON BGRSI.szScheduleId = BOS_GEN_RoutineSchedule.szScheduleId AND
BGRSI.shScheduleItem = 0
LEFT JOIN BOS_SD_MGM_Area MGM ON MGM.szAreaId = BOS_SD_Route.szAreaId 

WHERE
BOS_SD_Route.szRouteId = p_szRouteId

SET ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetRoute_013_DRAFT(
p_szRouteId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN

SELECT  
BOS_SD_Route_DRAFT.szRouteId,  
BOS_SD_Route_DRAFT.szDescription,  
BOS_SD_Route_DRAFT.szWorkplaceId,  
BOS_SD_Route_DRAFT.szAreaId,  
BOS_SD_Route_DRAFT.szRouteType,  

BOS_SD_Route_DRAFT.szScheduleId,  
BOS_GEN_RoutineSchedule.szDescription As szScheduleName_J,  
BOS_GEN_RoutineSchedule.szScheduleType AS szScheduleType_J,  
BGRSI.decValue AS decScheduleValue_J,  

BOS_SD_Route_DRAFT.szOpUserId,  
ISNULL(BOS_PI_Employee.szName,'') AS szOpUserNm,  
ISNULL(((CASE WHEN BOS_PI_Employee.szTeamId = '' THEN MGM.szTeamId ELSE BOS_PI_Employee.szTeamId END)), MGM.szTeamId)AS szOpUserTeamId_J,  
BOS_PI_Employee.szWorkplaceId AS szOpUserWorkplaceId_J,  

-- Data Status.  
BOS_SD_Route_DRAFT.dtmLastUpdated,  
BOS_SD_Route_DRAFT.bAlreadyTransferred  
FROM  
BOS_SD_Route_DRAFT   
LEFT JOIN BOS_PI_Employee ON BOS_SD_Route_DRAFT.szOpUserId = BOS_PI_Employee.szEmployeeId  
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_SD_Route_DRAFT.szScheduleId = BOS_GEN_RoutineSchedule.szScheduleId  
LEFT JOIN BOS_GEN_RoutineScheduleItem AS BGRSI ON BGRSI.szScheduleId = BOS_GEN_RoutineSchedule.szScheduleId AND  
BGRSI.shScheduleItem = 0  
LEFT JOIN BOS_SD_MGM_Area MGM ON MGM.szAreaId = BOS_SD_Route_DRAFT.szAreaId   

WHERE  
BOS_SD_Route_DRAFT.szRouteId = p_szRouteId  


------------------------------------  

SET ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetRoute_DRAFT(
p_szRouteId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SD_Route_DRAFT.szRouteId,
BOS_SD_Route_DRAFT.szDescription,
BOS_SD_Route_DRAFT.szWorkplaceId,
BOS_SD_Route_DRAFT.szAreaId,
BOS_SD_Route_DRAFT.szRouteType,

BOS_SD_Route_DRAFT.szScheduleId,
BOS_GEN_RoutineSchedule.szDescription As szScheduleName_J,
BOS_GEN_RoutineSchedule.szScheduleType AS szScheduleType_J,
BGRSI.decValue AS decScheduleValue_J,

BOS_SD_Route_DRAFT.szOpUserId,
ISNULL(BOS_PI_Employee.szName,'') AS szOpUserNm,
ISNULL(((CASE WHEN BOS_PI_Employee.szTeamId = '' THEN MGM.szTeamId ELSE BOS_PI_Employee.szTeamId END)), MGM.szTeamId)AS szOpUserTeamId_J,
BOS_PI_Employee.szWorkplaceId AS szOpUserWorkplaceId_J,

-- Data Status.
BOS_SD_Route_DRAFT.dtmLastUpdated,
BOS_SD_Route_DRAFT.bAlreadyTransferred
FROM
BOS_SD_Route_DRAFT 
LEFT JOIN BOS_PI_Employee ON BOS_SD_Route_DRAFT.szOpUserId = BOS_PI_Employee.szEmployeeId
LEFT JOIN BOS_GEN_RoutineSchedule ON BOS_SD_Route_DRAFT.szScheduleId = BOS_GEN_RoutineSchedule.szScheduleId
LEFT JOIN BOS_GEN_RoutineScheduleItem AS BGRSI ON BGRSI.szScheduleId = BOS_GEN_RoutineSchedule.szScheduleId AND
BGRSI.shScheduleItem = 0
LEFT JOIN BOS_SD_MGM_Area MGM ON MGM.szAreaId = BOS_SD_Route_DRAFT.szAreaId 

WHERE
BOS_SD_Route_DRAFT.szRouteId = p_szRouteId


------------------------------------

SET ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetRouteItem(
p_szRouteId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_RouteItem.intItemNumber,
BOS_SD_RouteItem.szCustId,
BOS_AR_Customer.szName AS szCustNm

FROM 
BOS_SD_RouteItem LEFT JOIN BOS_AR_Customer ONBOS_SD_RouteItem LEFT JOIN BOS_AR_Customer ON;
BOS_SD_RouteItem.szCustId = BOS_AR_Customer.szCustId
WHERE 
BOS_SD_RouteItem.szRouteId = p_szRouteId ;ORDER BY 
--Must be explicit becoz the behavior of index in un-commited isolation level is un-guessed.
BOS_SD_RouteItem.intItemNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_GetRouteItem_DRAFT(
p_szRouteId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SD_RouteItem_DRAFT.intItemNumber,
BOS_SD_RouteItem_DRAFT.szCustId,
BOS_AR_Customer.szName AS szCustNm

FROM 
BOS_SD_RouteItem_DRAFT
LEFT JOIN BOS_AR_Customer ON BOS_SD_RouteItem_DRAFT.szCustId = BOS_AR_Customer.szCustIdLEFT JOIN BOS_AR_Customer ON BOS_SD_RouteItem_DRAFT.szCustId = BOS_AR_Customer.szCustId;
WHERE 
BOS_SD_RouteItem_DRAFT.szRouteId = p_szRouteId ;ORDER BY 
--Must be explicit becoz the behavior of index in un-commited isolation level is un-guessed.
BOS_SD_RouteItem_DRAFT.intItemNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_IsRouteExist(
p_szRouteId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRouteId

FROM 
BOS_SD_Route
WHERE 
szRouteId = p_szRouteId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_IsRouteExist_DRAFT(
p_szRouteId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szRouteId

FROM 
BOS_SD_Route_DRAFT
WHERE 
szRouteId = p_szRouteId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_LockRoute(
p_szRouteId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_Route
SET 
szRouteType = szRouteType
WHERE 
szRouteId = p_szRouteId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_LockRoute_DRAFT(
p_szRouteId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_Route_DRAFT
SET 
szRouteType = szRouteType
WHERE 
szRouteId = p_szRouteId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_UpdateRoute(
p_szRouteId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_szWorkplaceId BOS_DT_szId,
p_szAreaId BOS_DT_szId,
p_szRouteType BOS_DT_szSmallId,
p_szScheduleId BOS_DT_szId,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_Route
SET 
szDescription = p_szDescription,
szWorkplaceId = p_szWorkplaceId,
szAreaId = p_szAreaId,
szRouteType = p_szRouteType,
szScheduleId = p_szScheduleId,
szOpUserId = p_szOpUserId
WHERE 
szRouteId = p_szRouteId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_UpdateRoute_013(
p_szRouteId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_szWorkplaceId BOS_DT_szId,
p_szAreaId BOS_DT_szId,
p_szRouteType BOS_DT_szSmallId,
p_szScheduleId BOS_DT_szId,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_Route
SET 
szDescription = p_szDescription,
szWorkplaceId = p_szWorkplaceId,
szAreaId = p_szAreaId,
szRouteType = p_szRouteType,
szScheduleId = p_szScheduleId,
szOpUserId = p_szOpUserId
WHERE 
szRouteId = p_szRouteId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_UpdateRoute_013_DRAFT(
p_szRouteId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_szWorkplaceId BOS_DT_szId,
p_szAreaId BOS_DT_szId,
p_szRouteType BOS_DT_szSmallId,
p_szScheduleId BOS_DT_szId,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_Route_DRAFT
SET 
szDescription = p_szDescription,
szWorkplaceId = p_szWorkplaceId,
szAreaId = p_szAreaId,
szRouteType = p_szRouteType,
szScheduleId = p_szScheduleId,
szOpUserId = p_szOpUserId
WHERE 
szRouteId = p_szRouteId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_Route_UpdateRoute_DRAFT(
p_szRouteId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_szWorkplaceId BOS_DT_szId,
p_szAreaId BOS_DT_szId,
p_szRouteType BOS_DT_szSmallId,
p_szScheduleId BOS_DT_szId,
p_szOpUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_Route_DRAFT
SET 
szDescription = p_szDescription,
szWorkplaceId = p_szWorkplaceId,
szAreaId = p_szAreaId,
szRouteType = p_szRouteType,
szScheduleId = p_szScheduleId,
szOpUserId = p_szOpUserId
WHERE 
szRouteId = p_szRouteId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RptLPH_GetListOfCollectionResult_Cash(
p_szWorkplaceId varchar,
p_szCollectorId varchar,
p_dtmDate timestamp,
p_bCollectApplied bit)
RETURNS void AS
$BODY$
BEGIN
SELECT
BAT.szDocId,
BAT.dtmDate,
BAT.szCustId,
IsNull(BAC.szName, '') AS szCustName,
BAT.decAmount - IsNull((SELECT
SUM(SUB_BACPI.decPaidByCashReceipt) AS decPaid
FROM
BOS_AR_FCustPayment SUB_BACP
INNER JOIN BOS_AR_FCustPaymentItem SUB_BACPI ON SUB_BACPI.szFCustPaymentId = SUB_BACP.szFCustPaymentId
WHERE
SUB_BACP.bApplied = 1 AND
SUB_BACP.dtmFCustPayment < dbo.KGenReturnDateNoTime(FCP.dtmFCustPayment) AND
SUB_BACPI.szTrnId = BAT.szTrnId AND
SUB_BACPI.szDocId = BAT.szDocId), 0) AS decAR,
SUM(FCPID.decAmount) AS decPaidByCash,
CONVERT(DECIMAL, 0) AS decPaidByGiro,
'' AS szBankId,
'' AS szRefDocId,
BAT.dtmDue,
BAT.bCash,
ISNULL(BOS_SD_FDo.szSalesId, '') AS szSalesId
FROM
BOS_AR_FCustPaymentItemDetail FCPID
INNER JOIN BOS_AR_FCustPaymentItem FCPI ON FCPI.szFCustPaymentId = FCPID.szFCustPaymentId AND
FCPI.shItemNumber = FCPID.shItemNumber
INNER JOIN BOS_AR_FCustPayment FCP ON FCP.szFCustPaymentId = FCPI.szFCustPaymentId
INNER JOIN BOS_AR_ArTrans BAT ON BAT.szTrnId = FCPI.szTrnId AND
BAT.szDocId = FCPI.szDocId AND
BAT.szCustId = FCPI.szCustId AND
BAT.shRevNo = 0
LEFT JOIN BOS_AR_Customer BAC ON BAC.szCustId = BAT.szCustId
LEFT JOIN BOS_SD_FInvoice ON BOS_SD_FInvoice.szFInvoiceId = FCPI.szDocId
LEFT JOIN BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_SD_FInvoice.szFirstFDoId_s
WHERE
FCP.bVoid = 0 AND
FCP.bApplied = p_bCollectApplied AND
FCP.szWorkplaceId = p_szWorkplaceId AND
FCP.szDeposanId = p_szCollectorId AND
FCP.dtmFCustPayment >= p_dtmDate AND
FCP.dtmFCustPayment < p_dtmDate+1 AND
FCPID.bValue = 1 AND
FCPID.bDeposit = 0
GROUP BY
BAT.szTrnId,
BAT.szDocId,
BAT.dtmDate,
BAT.szCustId,
IsNull(BAC.szName, ''),
BAT.decAmount,
FCP.dtmFCustPayment,
BAT.dtmDue,
BAT.bCash,
ISNULL(BOS_SD_FDo.szSalesId, '')
ORDER BY
BAT.szTrnId,
BAT.szDocId,
BAT.dtmDate,
BAT.szCustId,
IsNull(BAC.szName, ''),
BAT.decAmount,
FCP.dtmFCustPayment,
BAT.dtmDue,
BAT.bCash,
ISNULL(BOS_SD_FDo.szSalesId, '')

--GO

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RptLPH_GetListOfCollectionResult_Giro(
p_szWorkplaceId varchar,
p_szCollectorId varchar,
p_dtmDate timestamp,
p_bCollectApplied bit)
RETURNS void AS
$BODY$
BEGIN
SELECT
BAT.szDocId,
BAT.dtmDate,
BAT.szCustId,
IsNull(BAC.szName, '') AS szCustName,
BAT.decAmount - IsNull((SELECT
SUM(SUB_BACPI.decPaidByCashReceipt) AS decPaid
FROM
BOS_AR_FCustPayment SUB_BACP
INNER JOIN BOS_AR_FCustPaymentItem SUB_BACPI ON SUB_BACPI.szFCustPaymentId = SUB_BACP.szFCustPaymentId
WHERE
SUB_BACP.bApplied = 1 AND
SUB_BACP.dtmFCustPayment < dbo.KGenReturnDateNoTime(FCP.dtmFCustPayment) AND
SUB_BACPI.szTrnId = BAT.szTrnId AND
SUB_BACPI.szDocId = BAT.szDocId), 0) AS decAR,
CONVERT(DECIMAL, 0) AS decPaidByCash,
SUM(FCPID.decAmount) AS decPaidByGiro,
FCPID.szBankId AS szBankId,
FCPID.szRefDocId AS szRefDocId,
BAT.dtmDue,
BAT.bCash,
ISNULL(BOS_SD_FDo.szSalesId, '') AS szSalesId
FROM
BOS_AR_FCustPaymentItemDetail FCPID
INNER JOIN BOS_AR_FCustPaymentItem FCPI ON FCPI.szFCustPaymentId = FCPID.szFCustPaymentId AND
FCPI.shItemNumber = FCPID.shItemNumber
INNER JOIN BOS_AR_FCustPayment FCP ON FCP.szFCustPaymentId = FCPI.szFCustPaymentId
INNER JOIN BOS_AR_ArTrans BAT ON BAT.szTrnId = FCPI.szTrnId AND
BAT.szDocId = FCPI.szDocId AND
BAT.szCustId = FCPI.szCustId AND
BAT.shRevNo = 0
LEFT JOIN BOS_AR_Customer BAC ON BAC.szCustId = BAT.szCustId
LEFT JOIN BOS_SD_FInvoice ON BOS_SD_FInvoice.szFInvoiceId = FCPI.szDocId
LEFT JOIN BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_SD_FInvoice.szFirstFDoId_s
WHERE
FCP.bVoid = 0 AND
FCP.bApplied = p_bCollectApplied AND
FCP.szWorkplaceId = p_szWorkplaceId AND
FCP.szDeposanId = p_szCollectorId AND
FCP.dtmFCustPayment >= p_dtmDate AND
FCP.dtmFCustPayment < p_dtmDate+1 AND
FCPID.bDeposit = 0 AND
FCPID.bValue = 0 AND
FCPID.szBankId <> '' AND
FCPID.szRefDocId <> ''
GROUP BY
BAT.szTrnId,
BAT.szDocId,
BAT.dtmDate,
BAT.szCustId,
IsNull(BAC.szName, ''),
BAT.decAmount,
FCP.dtmFCustPayment,
FCPID.szBankId,
FCPID.szRefDocId,
BAT.dtmDue,
BAT.bCash,
ISNULL(BOS_SD_FDo.szSalesId, '')
ORDER BY
BAT.szTrnId,
BAT.szDocId,
BAT.dtmDate,
BAT.szCustId,
IsNull(BAC.szName, ''),
BAT.decAmount,
FCP.dtmFCustPayment,
FCPID.szBankId,
FCPID.szRefDocId,
BAT.dtmDue,
BAT.bCash,
ISNULL(BOS_SD_FDo.szSalesId, '')

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RptLPH_GetListOfSalesResult(
p_szWorkplaceId varchar,
p_szSalesId varchar,
p_dtmDate timestamp,
p_szTrnId varchar,
p_bSalesApplied bit)
RETURNS void AS
$BODY$
BEGIN

SELECT
BAT.szDocId,
BAT.dtmDate,
BAT.szCustId,
IsNull(BAC.szName, '') AS szCustName,
BAT.decAmount AS decAR,
BAT.decAmount AS decPaidByCash,
0 AS decPaidByGiro,
'' AS szBankId,
'' AS szRefDocId,
BAT.dtmDue,
BAT.bCash,
BSD.szSalesId
FROM
BOS_SD_FDo BSD
LEFT JOIN BOS_AR_ArTrans BAT ON BAT.szTrnId = p_szTrnId AND
BAT.szDocId = BSD.szFInvoiceId AND
BAT.szCustId = BSD.szCustId AND
BAT.shRevNo = 0
LEFT JOIN BOS_AR_Customer BAC ON BAC.szCustId = BAT.szCustId
WHERE
BSD.bVoid = 0 AND
BSD.bApplied = p_bSalesApplied AND
BSD.szWorkplaceId = p_szWorkplaceId AND
BSD.szSalesId = p_szSalesId AND
BSD.dtmDelivery >= p_dtmDate AND BSD.dtmDelivery < p_dtmDate+1 AND
BSD.szFInvoiceId <> '' AND
BSD.bCash = 1 AND
BAT.bClosed = 1
ORDER BY
BAT.szDocId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RptLPH_GetListOfStockInDist_FDo_Sold(
p_szWorkplaceId varchar,
p_szEmployeeId varchar,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_bSalesApplied bit)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_SD_FDoItem.szProductId
, BOS_INV_Product.szName AS szProductName
, CONVERT(DECIMAL, 0) AS decBeginningQty
, CONVERT(DECIMAL, 0) AS decQtyIn
, SUM(BOS_SD_FDoItem.decQty) AS decQtySold
, CONVERT(DECIMAL, 0) AS decQtySoldReturn
, CONVERT(DECIMAL, 0) AS decQtyReturn
FROM
BOS_SD_FDoItem INNER JOIN BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_SD_FDoItem.szDoId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId
WHERE
BOS_SD_FDo.bApplied = p_bSalesApplied
AND BOS_SD_FDo.szWorkplaceId =p_szWorkplaceId
AND BOS_SD_FDo.szSalesId = p_szEmployeeId
AND BOS_SD_FDo.dtmDelivery >= p_dtmFrom
AND BOS_SD_FDo.dtmDelivery < p_dtmTo+1
AND BOS_SD_FDo.szLogisticType <> 'INV'
AND BOS_SD_FDoItem.decQty > 0
GROUP BY
BOS_SD_FDoItem.szProductId
, BOS_INV_Product.szName
ORDER BY
BOS_SD_FDoItem.szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RptLPH_GetListOfStockInDist_FDo_Sold_014(
p_szWorkplaceId varchar,
p_szEmployeeId varchar,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_bSalesApplied bit)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_SD_FDoItem.szProductId
, BOS_INV_Product.szName AS szProductName
, CONVERT(DECIMAL, 0) AS decBeginningQty
, CONVERT(DECIMAL, 0) AS decQtyIn
, SUM(BOS_SD_FDoItem.decQty) AS decQtySold
, CONVERT(DECIMAL, 0) AS decQtySoldReturn
, CONVERT(DECIMAL, 0) AS decQtyReturn
FROM
BOS_SD_FDoItem INNER JOIN BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_SD_FDoItem.szDoId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId
WHERE
BOS_SD_FDo.bApplied = p_bSalesApplied
AND BOS_SD_FDo.szWorkplaceId =p_szWorkplaceId
AND BOS_SD_FDo.szSalesId = p_szEmployeeId
AND BOS_SD_FDo.dtmDelivery >= p_dtmFrom
AND BOS_SD_FDo.dtmDelivery < p_dtmTo+1
AND BOS_SD_FDo.szLogisticType <> 'INV'
AND BOS_SD_FDoItem.decQty > 0
GROUP BY
BOS_SD_FDoItem.szProductId
, BOS_INV_Product.szName
ORDER BY
BOS_SD_FDoItem.szProductId


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RptLPH_GetListOfStockInDist_FDo_SoldReturn(
p_szWorkplaceId varchar,
p_szEmployeeId varchar,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_bSalesApplied bit)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_SD_FDoItem.szProductId
, BOS_INV_Product.szName AS szProductName
, CONVERT(DECIMAL, 0) AS decBeginningQty
, CONVERT(DECIMAL, 0) AS decQtyIn
, CONVERT(DECIMAL, 0) AS decQtySold
, SUM(BOS_SD_FDoItem.decQty) AS decQtySoldReturn
, CONVERT(DECIMAL, 0) AS decQtyReturn
FROM
BOS_SD_FDoItem INNER JOIN BOS_SD_FDo ON BOS_SD_FDo.szDoId = BOS_SD_FDoItem.szDoId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_SD_FDoItem.szProductId
WHERE
BOS_SD_FDo.bApplied = p_bSalesApplied
AND BOS_SD_FDo.szWorkplaceId =p_szWorkplaceId
AND BOS_SD_FDo.szSalesId = p_szEmployeeId
AND BOS_SD_FDo.dtmDelivery >= p_dtmFrom
AND BOS_SD_FDo.dtmDelivery < p_dtmTo+1
AND BOS_SD_FDo.bReturnToWarehouse = 0
AND BOS_SD_FDoItem.decQty < 0
GROUP BY
BOS_SD_FDoItem.szProductId
, BOS_INV_Product.szName
ORDER BY
BOS_SD_FDoItem.szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RptLPH_GetListOfStockInDist_FSid(
p_szWorkplaceId varchar,
p_szEmployeeId varchar,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_bSalesApplied bit)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_INV_FSidItem.szProductId
, BOS_INV_Product.szName AS szProductName
, CONVERT(DECIMAL, 0) AS decBeginningQty
, CONVERT(DECIMAL, 0) AS decQtyIn
, CONVERT(DECIMAL, 0) AS decQtySold
, CONVERT(DECIMAL, 0) AS decQtySoldReturn
, SUM(BOS_INV_FSidItem.decQty) AS decQtyReturn
FROM
BOS_INV_FSidItem INNER JOIN BOS_INV_FSid ON BOS_INV_FSid.szFSidId = BOS_INV_FSidItem.szFSidId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FSidItem.szProductId
WHERE
BOS_INV_FSid.bApplied = 1
AND BOS_INV_FSid.szFAdjustmentId = ''
AND BOS_INV_FSid.szWorkplaceId =p_szWorkplaceId
AND BOS_INV_FSid.szDriverId = p_szEmployeeId
AND BOS_INV_FSid.dtmIn >= p_dtmFrom
AND BOS_INV_FSid.dtmIn < p_dtmTo+1
GROUP BY
BOS_INV_FSidItem.szProductId
, BOS_INV_Product.szName
ORDER BY
BOS_INV_FSidItem.szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RptLPH_GetListOfStockInDist_FSod(
p_szWorkplaceId varchar,
p_szEmployeeId varchar,
p_dtmFrom timestamp,
p_dtmTo timestamp,
p_bSalesApplied bit)
RETURNS void AS
$BODY$
BEGIN
SELECT
BOS_INV_FSodItem.szProductId
, BOS_INV_Product.szName AS szProductName
, CONVERT(DECIMAL, 0) AS decBeginningQty
, SUM(BOS_INV_FSodItem.decQty) AS decQtyIn
, CONVERT(DECIMAL, 0) AS decQtySold
, CONVERT(DECIMAL, 0) AS decQtySoldReturn
, CONVERT(DECIMAL, 0) AS decQtyReturn
FROM
BOS_INV_FSodItem INNER JOIN BOS_INV_FSod ON BOS_INV_FSod.szFSodId = BOS_INV_FSodItem.szFSodId
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_INV_FSodItem.szProductId
WHERE
BOS_INV_FSod.bApplied = 1
AND BOS_INV_FSod.szFAdjustmentId = ''
AND BOS_INV_FSod.szWorkplaceId =p_szWorkplaceId
AND BOS_INV_FSod.szDriverId = p_szEmployeeId
AND BOS_INV_FSod.dtmOut >= p_dtmFrom
AND BOS_INV_FSod.dtmOut < p_dtmTo+1
GROUP BY
BOS_INV_FSodItem.szProductId
, BOS_INV_Product.szName
ORDER BY
BOS_INV_FSodItem.szProductId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_RptLph_GetListOfSummary(
p_szWorkplaceId varchar,
p_szSalesID varchar,
p_dtmDate timestamp,
p_bSalesApplied bit)
RETURNS void AS
$BODY$
BEGIN
SELECT
PenjualanKotor = SUM(BOSFDOItem.decAmount) - SUM(BOSFDOItem.decTax),
Discount = SUM(BOSFDOItem.decDiscount),
PPN = SUM(BOSFDOItem.decTax),
SYD =
(SELECT
ISNULL(SUM(BCCI.decAmount), 0) AS decAmount
FROM
BOS_CAS_FCashTemp BCC
INNER JOIN BOS_CAS_FCashTempItem BCCI ON BCCI.szFCashTempId = BCC.szFCashTempId
WHERE
BCC.bApplied = 1 AND
BCC.szWorkplaceId = p_szWorkplaceId AND
BCC.szEmployeeId = p_szSalesID AND
BCC.dtmTransaction >= p_dtmDate AND
BCC.dtmTransaction < p_dtmDate+1 AND
BCC.szCashDirection = 'IN' AND
BCCI.btItemNumber = 0),
TPK =
(SELECT
SUM(BOS_SD_FDo.decAmount)
FROM
BOS_SD_FDo
WHERE
BOS_SD_FDo.szSalesId = p_szSalesId
AND BOS_SD_FDo.szWorkplaceId = p_szWorkplaceId
AND BOS_SD_FDo.bApplied = p_bSalesApplied
AND BOS_SD_FDo.dtmDelivery >= p_dtmDate
AND BOS_SD_FDo.dtmDelivery < p_dtmDate+1
AND BOS_SD_FDo.bCash = 0)
FROM dbo.BOS_SD_FDO BFDO INNER JOIN 
dbo.BOS_SD_FDOItem BOSFDOItem ON BFDO.szDoId = BOSFDOItem.szDoId
WHERE BFDO.szSalesID = p_szSalesID
AND BFDO.szWorkplaceId = p_szWorkplaceId
AND BFDO.bApplied = p_bSalesApplied
AND BFDO.dtmDelivery >= p_dtmDate AND 
BFDO.dtmDelivery < p_dtmDate+1

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_SalesOrganization_CreateSalesOrganization(
p_szSalesOrgId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szDescription BOS_DT_szDescription,
p_szFullPathId varchar,
p_byteLevel smallint,
p_szParentSalesOrgId BOS_DT_szId,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SD_SalesOrganization
(
szSalesOrgId,
szName,
szDescription,
szFullPathId,
byteLevel,
szParentSalesOrgId,
szPriceId,
szPriceOrderId,
szPromoPriceId,
szPromoPriceOrderId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szSalesOrgId,
p_szName,
p_szDescription,
p_szFullPathId,
p_byteLevel,
p_szParentSalesOrgId,
p_szPriceId,
p_szPriceOrderId,
p_szPromoPriceId,
p_szPromoPriceOrderId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_SalesOrganization_DeleteSalesOrganization(
p_szSalesOrgId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_SD_SalesOrganization
WHERE
szSalesOrgId = p_szSalesOrgId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_SalesOrganization_GetListOfAllSalesOrganization()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szSalesOrgId,
szName,
szDescription,
szFullPathId

FROM 
BOS_SD_SalesOrganization
order by
szSalesOrgId
ORDER BY 
szSalesOrgId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_SalesOrganization_GetListOfSalesOrganization(
p_szFullPathId BOS_DT_szId,
p_byteLevel smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szSalesOrgId,
szName,
szDescription,
szFullPathId

FROM 
BOS_SD_SalesOrganization
WHERE 
szFullPathId LIKE p_szFullPathId+'%' AND byteLevel = p_byteLevel ;ORDER BY 
szSalesOrgId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_SalesOrganization_GetListOfSalesOrganizationWithChild(
p_szFullPathId BOS_DT_szId,
p_byteLevel smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szSalesOrgId,
szName,
szDescription,
szFullPathId

FROM 
BOS_SD_SalesOrganization
WHERE 
szFullPathId LIKE p_szFullPathId+'%' AND byteLevel >= p_byteLevel ;ORDER BY 
szSalesOrgId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_SalesOrganization_GetSalesOrganization(
p_szSalesOrgId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szSalesOrgId,
szName,
szDescription,
szFullPathId,
byteLevel,
szPriceId,
szPriceOrderId,
szPromoPriceId,
szPromoPriceOrderId,

dtmLastUpdated,
bAlreadyTransferred

FROM 
BOS_SD_SalesOrganization
WHERE 
szSalesOrgId = p_szSalesOrgId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_SalesOrganization_IsSalesOrganizationExist(
p_szSalesOrgId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szSalesOrgId

FROM 
BOS_SD_SalesOrganization
WHERE 
szSalesOrgId = p_szSalesOrgId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_SalesOrganization_LockSalesOrganization(
p_szSalesOrgId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SD_SalesOrganization
SET 
szDescription = szDescription
WHERE 
szSalesOrgId = p_szSalesOrgId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SD_SalesOrganization_UpdateSalesOrganization(
p_szSalesOrgId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szDescription BOS_DT_szDescription,
p_szFullPathId varchar,
p_byteLevel smallint,
p_szParentSalesOrgId BOS_DT_szId,
p_szPrevFullPathId varchar,
p_shDiffLevel smallint,
p_szPriceId BOS_DT_szId,
p_szPriceOrderId BOS_DT_szId,
p_szPromoPriceId BOS_DT_szId,
p_szPromoPriceOrderId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
-- ### 2 update #####
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_AuditTrail_GetAuditTrail(
p_gdTxId bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
Select szDescription, szUserId, dtmCommitted

FROM 
BOS_SM_BosTxAuditTrail
WHERE 
 gdTxId = p_gdTxId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_AuditTrail_GetAuditTrailItem(
p_gdTxId bytea)
RETURNS void AS
$BODY$
BEGIN
SELECT 
Select siItemNumber, gdRecordAuditTrailId, szDescription

FROM 
BOS_SM_BosTxAuditTrailItem
WHERE 
 gdTxId = p_gdTxId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_AuditTrail_GetListOfRecordAuditTrail(
p_gdAuditTrailId bytea,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SM_BosTxAuditTrail.szUserId,
BOS_SM_User.szName AS szUserName,
BOS_SM_BosTxAuditTrailItem.szDescription,
BOS_SM_BosTxAuditTrail.dtmCommitted

FROM 
BOS_SM_BosTxAuditTrail
Inner Join BOS_SM_BosTxAuditTrailItem On BOS_SM_BosTxAuditTrail.gdTxId = BOS_SM_BosTxAuditTrailItem.gdTxId
Left Join BOS_SM_User On BOS_SM_BosTxAuditTrail.szUserId = BOS_SM_User.szUserId
WHERE 
BOS_SM_BosTxAuditTrailItem.gdRecordAuditTrailId = p_gdAuditTrailId And BOS_SM_BosTxAuditTrail.szUserId Like p_szUserId ;ORDER BY 
BOS_SM_BosTxAuditTrail.dtmCommitted,
BOS_SM_BosTxAuditTrail.szUserId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_CreateBoq(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szBoqId BOS_DT_szBigId,
p_szSelectClause varchar,
p_szOrderByClause varchar,
p_szWhereClause varchar,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_Boq
(
szBoqTemplateId,
szBoqName,
szBoqId,
szSelectClause,
szOrderByClause,
szWhereClause,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szBoqTemplateId,
p_szBoqName,
p_szBoqId,
p_szSelectClause,
p_szOrderByClause,
p_szWhereClause,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_CreateBoq_014(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szBoqId BOS_DT_szBigId,
p_szSelectClause BOS_DT_szMessage,
p_szOrderByClause BOS_DT_szMessage,
p_szWhereClause BOS_DT_szMessage,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_Boq
(
szBoqTemplateId,
szBoqName,
szBoqId,
szSelectClause,
szOrderByClause,
szWhereClause,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szBoqTemplateId,
p_szBoqName,
p_szBoqId,
p_szSelectClause,
p_szOrderByClause,
p_szWhereClause,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_CreateBoqLastUsed(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szUserId BOS_DT_szId,
p_szBoqId BOS_DT_szBigId,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_BoqLastUsed
(
szBoqTemplateId,
szBoqName,
szUserId,
szBoqId,
dtmLastUpdated
)
VALUES
(
p_szBoqTemplateId,
p_szBoqName,
p_szUserId,
p_szBoqId,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_CreateBoqLastUsed_013(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szUserId BOS_DT_szId,
p_szBoqId BOS_DT_szBigId,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_BoqLastUsed
(
szBoqTemplateId,
szBoqName,
szUserId,
szBoqId,
dtmLastUpdated
)
VALUES
(
p_szBoqTemplateId,
p_szBoqName,
p_szUserId,
p_szBoqId,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_CreateBoqTemplate(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szFromClause varchar,
p_szDescription BOS_DT_szDescription,
p_bSystemBoq bit,
p_szWorkplaceFilter varchar,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_BoqTemplate
(
szBoqTemplateId,
szBoqName,
szFromClause,
szDescription,
bSystemBoq,
szWorkplaceFilter,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szBoqTemplateId,
p_szBoqName,
p_szFromClause,
p_szDescription,
p_bSystemBoq,
p_szWorkplaceFilter,
p_dtmLastUpdated,
p_bAlreadyTransferred,
---------------------------------
SET ANSI_NULLS ON,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_CreateBoqTemplate_013(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szFromClause varchar,
p_szDescription BOS_DT_szDescription,
p_bSystemBoq bit,
p_szWorkplaceFilter BOS_DT_szBigId,
p_szCompanyFilter BOS_DT_szBigId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_BoqTemplate
(
szBoqTemplateId,
szBoqName,
szFromClause,
szDescription,
bSystemBoq,
szWorkplaceFilter,
szCompanyFilter,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szBoqTemplateId,
p_szBoqName,
p_szFromClause,
p_szDescription,
p_bSystemBoq,
p_szWorkplaceFilter,
p_szCompanyFilter,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_DeleteBoq(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szBoqId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SM_Boq
WHERE
szBoqTemplateId = p_szBoqTemplateId ANDszBoqName = p_szBoqName ANDszBoqId = p_szBoqId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_DeleteBoqLastUsed(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SM_BoqLastUsed
WHERE
szBoqTemplateId = p_szBoqTemplateId ANDszBoqName = p_szBoqName ANDszUserId = p_szUserId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_DeleteBoqTemplate(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SM_BoqTemplate
WHERE
szBoqTemplateId = p_szBoqTemplateId ANDszBoqName = p_szBoqName;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_DeleteBoqTemplateByBoqTemplateId(
p_szBoqTemplateId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SM_BoqTemplate
WHERE
szBoqTemplateId = p_szBoqTemplateId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_GetBoq(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szBoqId BOS_DT_szBigId,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SM_Boq.szSelectClause,
BOS_SM_Boq.szOrderByClause,
BOS_SM_Boq.szWhereClause,
BOS_SM_BoqTemplate.szFromClause as szFromClause,
BOS_SM_BoqLastUsed.szBoqId AS szLastUsedBoqId_J,
BOS_SM_Boq.dtmLastUpdated,
BOS_SM_Boq.bAlreadyTransferred
FROM 
BOS_SM_Boq

left join BOS_SM_BoqTemplate on BOS_SM_Boq.szBoqTemplateId = BOS_SM_BoqTemplate.szBoqTemplateId AND
BOS_SM_Boq.szBoqName = BOS_SM_BoqTemplate.szBoqName

LEFT JOIN BOS_SM_BoqLastUsed ON BOS_SM_BoqLastUsed.szBoqTemplateId = BOS_SM_Boq.szBoqTemplateId AND
BOS_SM_BoqLastUsed.szBoqName = BOS_SM_Boq.szBoqName AND 
BOS_SM_BoqLastUsed.szUserId = p_szUserId

WHERE
BOS_SM_Boq.szBoqTemplateId = p_szBoqTemplateId AND 
BOS_SM_Boq.szBoqName = p_szBoqName AND
BOS_SM_Boq.szBoqId = p_szBoqId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_GetBoq_014(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szBoqId BOS_DT_szBigId,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SM_Boq.szSelectClause,
BOS_SM_Boq.szOrderByClause,
BOS_SM_Boq.szWhereClause,
BOS_SM_BoqTemplate.szFromClause as szFromClause,
BOS_SM_BoqLastUsed.szBoqId AS szLastUsedBoqId_J,
BOS_SM_Boq.dtmLastUpdated,
BOS_SM_Boq.bAlreadyTransferred
FROM 
BOS_SM_Boq

left join BOS_SM_BoqTemplate on BOS_SM_Boq.szBoqTemplateId = BOS_SM_BoqTemplate.szBoqTemplateId AND
BOS_SM_Boq.szBoqName = BOS_SM_BoqTemplate.szBoqName

LEFT JOIN BOS_SM_BoqLastUsed ON BOS_SM_BoqLastUsed.szBoqTemplateId = BOS_SM_Boq.szBoqTemplateId AND
BOS_SM_BoqLastUsed.szBoqName = BOS_SM_Boq.szBoqName AND 
BOS_SM_BoqLastUsed.szUserId = p_szUserId

WHERE
BOS_SM_Boq.szBoqTemplateId = p_szBoqTemplateId AND 
BOS_SM_Boq.szBoqName = p_szBoqName AND
BOS_SM_Boq.szBoqId = p_szBoqId


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_GetBoqLastUsed(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szBoqId,
dtmLastUpdated

FROM 
BOS_SM_BoqLastUsed
WHERE 
szBoqTemplateId = p_szBoqTemplateId AND szBoqName = p_szBoqName AND szUserId = p_szUserId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_GetBoqLastUsed_014(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szBoqId,
dtmLastUpdated

FROM 
BOS_SM_BoqLastUsed
WHERE 
szBoqTemplateId = p_szBoqTemplateId AND szBoqName = p_szBoqName AND szUserId = p_szUserId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_GetBoqTemplate(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFromClause,
szDescription,
bSystemBoq,
dtmLastUpdated,
bAlreadyTransferred,
szWorkplaceFilter


FROM 
BOS_SM_BoqTemplate

WHERE 
szBoqTemplateId = p_szBoqTemplateId AND szBoqName = p_szBoqName SET ANSI_NULLS ON ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_GetBoqTemplate_013(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFromClause,
szDescription,
bSystemBoq,
dtmLastUpdated,
bAlreadyTransferred,
szWorkplaceFilter,
szCompanyFilter


FROM 
BOS_SM_BoqTemplate

WHERE 
szBoqTemplateId = p_szBoqTemplateId AND szBoqName = p_szBoqName ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_GetListOfBoq()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szBoqTemplateId,
szBoqName,
szBoqId

FROM 
BOS_SM_Boq

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_GetListOfBoqByTemplate(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szBoqId

FROM 
BOS_SM_Boq
WHERE 
szBoqTemplateId = p_szBoqTemplateId AND szBoqName = p_szBoqName ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_GetListOfBoqLastUsed()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szBoqTemplateId,
szBoqName,
szUserId

FROM 
BOS_SM_BoqLastUsed

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_GetListOfBoqTemplate()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szBoqTemplateId,
szBoqName,
szFromClause,
szWorkplaceFilter

FROM 
BOS_SM_BoqTemplate

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_GetListOfBoqTemplate_013()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szBoqTemplateId,
szBoqName,
szFromClause,
szWorkplaceFilter,
szCompanyFilter

FROM 
BOS_SM_BoqTemplate

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_GetListOfBoqTemplateByBoqTemplateId(
p_szBoqTemplateId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szBoqName

FROM 
BOS_SM_BoqTemplate
WHERE 
szBoqTemplateId = p_szBoqTemplateId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_GetListOfBoqTemplateURI()
RETURNS void AS
$BODY$
BEGIN
SELECT DISTINCT
szBoqTemplateId

FROM 
BOS_SM_BoqTemplate

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_IsBoqExist(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szBoqId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szBoqId

FROM 
BOS_SM_Boq
WHERE 
szBoqTemplateId = p_szBoqTemplateId AND szBoqName = p_szBoqName AND szBoqId = p_szBoqId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_IsBoqLastUsedExist(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szBoqName

FROM 
BOS_SM_BoqLastUsed
WHERE 
szBoqTemplateId = p_szBoqTemplateId AND szBoqName = p_szBoqName AND szUserId = p_szUserId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_IsBoqTemplateExist(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szBoqName

FROM 
BOS_SM_BoqTemplate
WHERE 
szBoqTemplateId = p_szBoqTemplateId AND szBoqName = p_szBoqName ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_LockBoq(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szBoqId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_Boq
SET 
szOrderByClause = szOrderByClause
WHERE 
szBoqTemplateId = p_szBoqTemplateId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_LockBoqLastUsed(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_BoqLastUsed
SET 
szBoqId = szBoqId
WHERE 
szBoqTemplateId = p_szBoqTemplateId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_LockBoqTemplate(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_BoqTemplate
SET 
bSystemBoq = bSystemBoq
WHERE 
szBoqTemplateId = p_szBoqTemplateId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_UpdateBoq(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szBoqId BOS_DT_szBigId,
p_szSelectClause BOS_DT_szMessage,
p_szOrderByClause BOS_DT_szMessage,
p_szWhereClause BOS_DT_szMessage)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_Boq
SET 
szSelectClause = p_szSelectClause,
szOrderByClause = p_szOrderByClause,
szWhereClause = p_szWhereClause

WHERE 
szBoqTemplateId = p_szBoqTemplateId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_UpdateBoqLastUsed(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szUserId BOS_DT_szId,
p_szBoqId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_BoqLastUsed
SET 
szBoqId = p_szBoqId
WHERE 
szBoqTemplateId = p_szBoqTemplateId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_UpdateBoqTemplate(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szFromClause varchar,
p_szDescription BOS_DT_szDescription,
p_bSystemBoq bit,
p_szWorkplaceFilter varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_BoqTemplate
SET 
szFromClause = p_szFromClause,
szDescription = p_szDescription,
bSystemBoq = p_bSystemBoq,
szWorkplaceFilter = p_szWorkplaceFilter
WHERE 
szBoqTemplateId = p_szBoqTemplateId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Boq_UpdateBoqTemplate_013(
p_szBoqTemplateId BOS_DT_szBigId,
p_szBoqName BOS_DT_szBigId,
p_szFromClause varchar,
p_szDescription BOS_DT_szDescription,
p_bSystemBoq bit,
p_szWorkplaceFilter BOS_DT_szBigId,
p_szCompanyFilter BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_BoqTemplate
SET 
szFromClause = p_szFromClause,
szDescription = p_szDescription,
bSystemBoq = p_bSystemBoq,
szWorkplaceFilter = p_szWorkplaceFilter,
szCompanyFilter = p_szCompanyFilter
WHERE 
szBoqTemplateId = p_szBoqTemplateId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_BosObjectTemplate_CreateBosObjectTemplate(
p_szClassName BOS_DT_szName,
p_szDesc BOS_DT_szDescription,
p_szAuthor varchar,
p_szModuleCode varchar,
p_bProvideAuditTrail bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_BosObjectTemplate
(
szClassName,
szDesc,
szAuthor,
szModuleCode,
bProvideAuditTrail
)
VALUES
(
p_szClassName,
p_szDesc,
p_szAuthor,
p_szModuleCode,
p_bProvideAuditTrail
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_BosObjectTemplate_CreateBosObjectTemplateItem(
p_szClassName BOS_DT_szName,
p_btLevel smallint,
p_szFieldName BOS_DT_szName,
p_szFieldType BOS_DT_szSmallId,
p_sLength smallint,
p_bPrimaryKey bit,
p_szDesc varchar,
p_btItemNumber smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_BosObjectTemplateItem
(
szClassName,
btLevel,
szFieldName,
szFieldType,
sLength,
bPrimaryKey,
szDesc,
btItemNumber
)
VALUES
(
p_szClassName,
p_btLevel,
p_szFieldName,
p_szFieldType,
p_sLength,
p_bPrimaryKey,
p_szDesc,
p_btItemNumber
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_BosObjectTemplate_DeleteBosObjectTemplate(
p_szClassName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SM_BosObjectTemplate
WHERE
szClassName = p_szClassName;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_BosObjectTemplate_DeleteBosObjectTemplateItem(
p_szClassName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SM_BosObjectTemplateItem
WHERE
szClassName = p_szClassName;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_BosObjectTemplate_GetBosObjectTemplate(
p_szClassName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szClassName,
szDesc,
szAuthor,
szModuleCode,
bProvideAuditTrail

FROM 
BOS_SM_BosObjectTemplate
WHERE 
szClassName = p_szClassName ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_BosObjectTemplate_GetBosObjectTemplateItem(
p_szClassName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
SELECT 
btLevel,
szFieldName,
szFieldType,
sLength,
bPrimaryKey,
szDesc,
btItemNumber

FROM 
BOS_SM_BosObjectTemplateItem
WHERE 
szClassName = p_szClassName ;ORDER BY 
btLevel, bPrimaryKey desc, btItemNumber

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_BosObjectTemplate_GetListOfBosObjectTemplate()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szClassName,
szDesc

FROM 
BOS_SM_BosObjectTemplate

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_BosObjectTemplate_IsBosObjectTemplateExist(
p_szClassName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szClassName

FROM 
BOS_SM_BosObjectTemplate
WHERE 
szClassName = p_szClassName ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_BosObjectTemplate_LockBosObjectTemplate(
p_szClassName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_BosObjectTemplate
SET 
szDesc = szDesc
WHERE 
szClassName = p_szClassName;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_BosObjectTemplate_UpdateBosObjectTemplate(
p_szClassName BOS_DT_szName,
p_szDesc BOS_DT_szDescription,
p_szAuthor varchar,
p_szModuleCode varchar,
p_bProvideAuditTrail bit)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_BosObjectTemplate
SET 
szDesc = p_szDesc,
szAuthor = p_szAuthor,
szModuleCode = p_szModuleCode,
bProvideAuditTrail = p_bProvideAuditTrail
WHERE 
szClassName = p_szClassName;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_BOSTx_CreateAuditTrail(
p_gdTxId bytea,
p_szDescription BOS_DT_szDescription,
p_szUserId BOS_DT_szId,
p_dtmCommitted timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_BosTxAuditTrail
(
gdTxId,
szDescription,
szUserId,
dtmCommitted
)
VALUES
(
p_gdTxId,
p_szDescription,
p_szUserId,
p_dtmCommitted
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_BOSTx_CreateAuditTrailItem(
p_gdTxId bytea,
p_siItemNumber smallint,
p_gdRecordAuditTrailId bytea,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_BosTxAuditTrailItem
(
gdTxId,
siItemNumber,
gdRecordAuditTrailId,
szDescription
)
VALUES
(
p_gdTxId,
p_siItemNumber,
p_gdRecordAuditTrailId,
p_szDescription
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_BOSTx_DEV_DeleteALL()
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SM_BOSTxAuditTrailItem;
DELETE 
BOS_SM_BOSTxAuditTrail;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_CreateConfigInfo(
p_szConfigTemplateId BOS_DT_szBigId,
p_szConfigItemTypeId BOS_DT_szSmallId,
p_szConfigItemId BOS_DT_szBigId,
p_szConfigItemTypeValue BOS_DT_szBigId,
p_szValue BOS_DT_szName,
p_gdAuditTrailId bytea,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_ConfigInfoItem
(
szConfigTemplateId,
szConfigItemTypeId,
szConfigItemId,
szConfigItemTypeValue,
szValue,
gdAuditTrailId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szConfigTemplateId,
p_szConfigItemTypeId,
p_szConfigItemId,
p_szConfigItemTypeValue,
p_szValue,
p_gdAuditTrailId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_CreateConfigInfo_014(
p_szConfigTemplateId BOS_DT_szBigId,
p_szConfigItemTypeId BOS_DT_szSmallId,
p_szConfigItemId BOS_DT_szBigId,
p_szConfigItemTypeValue BOS_DT_szBigId,
p_szValue BOS_DT_szName,
p_gdAuditTrailId bytea,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_ConfigInfoItem
(
szConfigTemplateId,
szConfigItemTypeId,
szConfigItemId,
szConfigItemTypeValue,
szValue,
gdAuditTrailId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szConfigTemplateId,
p_szConfigItemTypeId,
p_szConfigItemId,
p_szConfigItemTypeValue,
p_szValue,
p_gdAuditTrailId,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_CreateConfigTemplate(
p_szConfigTemplateId BOS_DT_szBigId,
p_szDesc BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_ConfigTemplate
(
szConfigTemplateId,
szDesc,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szConfigTemplateId,
p_szDesc,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_CreateConfigTemplate_014(
p_szConfigTemplateId BOS_DT_szBigId,
p_szDesc BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_ConfigTemplate
(
szConfigTemplateId,
szDesc,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szConfigTemplateId,
p_szDesc,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_CreateConfigTemplateItem(
p_szConfigTemplateId BOS_DT_szBigId,
p_szConfigItemId BOS_DT_szBigId,
p_szConfigItemTypeId BOS_DT_szSmallId,
p_szDefaultValue BOS_DT_szName,
p_szDesc BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_ConfigTemplateItem
(
szConfigTemplateId,
szConfigItemId,
szConfigItemTypeId,
szDefaultValue,
szDesc
)
VALUES
(
p_szConfigTemplateId,
p_szConfigItemId,
p_szConfigItemTypeId,
p_szDefaultValue,
p_szDesc
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_DeleteConfigInfo(
p_szConfigTemplateId BOS_DT_szBigId,
p_szConfigItemTypeId BOS_DT_szSmallId,
p_szConfigItemTypeValue BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_SM_ConfigInfoItem
WHERE
szConfigTemplateId = p_szConfigTemplateId andszConfigItemTypeId = p_szConfigItemTypeId andszConfigItemTypeValue = p_szConfigItemTypeValue;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_DeleteConfigInfoForSync(
p_szConfigTemplateId BOS_DT_szBigId,
p_szConfigItemTypeId BOS_DT_szSmallId,
p_szConfigItemId BOS_DT_szBigId,
p_szConfigItemTypeValue BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_SM_ConfigInfoItem
WHERE
szConfigTemplateId = p_szConfigTemplateId andszConfigItemTypeId = p_szConfigItemTypeId andszConfigItemId = p_szConfigItemId andszConfigItemTypeValue = p_szConfigItemTypeValue;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_DeleteConfigInfoWhereTemplateId(
p_szConfigTemplateId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_SM_ConfigInfoItem
WHERE
szConfigTemplateId = p_szConfigTemplateId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_DeleteConfigTemplate(
p_szConfigTemplateId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
from  BOS_SM_ConfigTemplate
WHERE
szConfigTemplateId = p_szConfigTemplateId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_DeleteConfigTemplateItem(
p_szConfigTemplateId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 from BOS_SM_ConfigTemplateItem
WHERE
szConfigTemplateId = p_szConfigTemplateId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_DEV_DeleteALL()
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SM_ConfigInfoItem;
DELETE 
BOS_SM_ConfigTemplateItem;
DELETE 
BOS_SM_ConfigTemplate;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_GetConfigInfo(
p_szConfigTemplateId BOS_DT_szBigId,
p_szConfigItemTypeId BOS_DT_szSmallId,
p_szConfigItemTypeValue BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
*

FROM 
BOS_SM_ConfigInfoItem
WHERE 
szConfigTemplateId = p_szConfigTemplateId and szConfigItemTypeId = p_szConfigItemTypeId and szConfigItemTypeValue = p_szConfigItemTypeValue ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_GetConfigTemplate(
p_szConfigTemplateId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDesc,

FROM 
BOS_SM_ConfigTemplate
WHERE 
szConfigTemplateId = p_szConfigTemplateId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_GetConfigTemplate_014(
p_szConfigTemplateId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDesc,

FROM 
BOS_SM_ConfigTemplate
WHERE 
szConfigTemplateId = p_szConfigTemplateId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_GetConfigTemplateForAnItemType(
p_szConfigTemplateId BOS_DT_szBigId,
p_szConfigItemTypeId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDesc 

FROM 
BOS_SM_ConfigTemplate 
WHERE 
szConfigTemplateId = p_szConfigTemplateId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_GetConfigTemplateItem(
p_szConfigTemplateId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szConfigItemId,
szConfigItemTypeId,
szDefaultValue,
szDesc

FROM 
BOS_SM_ConfigTemplateItem
WHERE 
szConfigTemplateId = p_szConfigTemplateId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_GetConfigTemplateItemForAnItemType(
p_szConfigTemplateId BOS_DT_szBigId,
p_szConfigItemTypeId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szConfigItemId,
szConfigItemTypeId,
szDefaultValue,
szDesc

FROM 
BOS_SM_ConfigTemplateItem
WHERE 
szConfigTemplateId = p_szConfigTemplateId and szConfigItemTypeId = p_szConfigItemTypeId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_GetGuid(
p_szConfigTemplateId BOS_DT_szBigId,
p_szConfigItemTypeId BOS_DT_szSmallId,
p_szConfigItemTypeValue BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
gdAuditTrailId

FROM 
BOS_SM_ConfigInfoItem
WHERE 
szConfigTemplateId = p_szConfigTemplateId and szConfigItemTypeId = p_szConfigItemTypeId and szConfigItemTypeValue = p_szConfigItemTypeValue ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_GetListOfConfigItemTypeWhereTemplate(
p_szConfigTemplateId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
select distinct szConfigItemTypeId

FROM 
BOS_SM_ConfigTemplateItem
WHERE 
 szConfigTemplateId = p_szConfigTemplateId;
ORDER BY 
order by szConfigItemTypeId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_GetListOfConfigTemplate()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szConfigTemplateId, szDesc

FROM 
BOS_SM_ConfigTemplate
order by
szConfigTemplateId
ORDER BY 
szConfigTemplateId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_IsConfigInfoExist(
p_szConfigTemplateId BOS_DT_szBigId,
p_szConfigItemTypeId BOS_DT_szSmallId,
p_szConfigItemTypeValue BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szConfigTemplateId

FROM 
BOS_SM_ConfigInfoItem
WHERE 
szConfigTemplateId = p_szConfigTemplateId and szConfigItemTypeId = p_szConfigItemTypeId and szConfigItemTypeValue = p_szConfigItemTypeValue ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_IsConfigInfoForSyncExist(
p_szConfigTemplateId BOS_DT_szBigId,
p_szConfigItemTypeId BOS_DT_szSmallId,
p_szConfigItemId BOS_DT_szBigId,
p_szConfigItemTypeValue BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szConfigTemplateId

FROM 
BOS_SM_ConfigInfoItem
WHERE 
szConfigTemplateId = p_szConfigTemplateId and szConfigItemTypeId = p_szConfigItemTypeId and szConfigItemId = p_szConfigItemId and szConfigItemTypeValue = p_szConfigItemTypeValue ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_IsConfigTemplateExist(
p_szConfigTemplateId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDesc

FROM 
BOS_SM_ConfigTemplate
WHERE 
 szConfigTemplateId = p_szConfigTemplateId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_LockConfigInfo(
p_szConfigTemplateId BOS_DT_szBigId,
p_szConfigItemTypeId BOS_DT_szSmallId,
p_szConfigItemTypeValue BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_ConfigInfoItem
SET 
szValue = szValue
WHERE 
szConfigTemplateId = p_szConfigTemplateId and;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_LockConfigTemplate(
p_szConfigTemplateId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_ConfigTemplate
SET 
szDesc = szDesc
WHERE 
szConfigTemplateId = p_szConfigTemplateId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_SetupAlphardWelcomingPage()
RETURNS void AS
$BODY$
BEGIN
INSERT INTO 
(
,
,

,
)
VALUES
(
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Config_UpdateConfigTemplate(
p_szConfigTemplateId BOS_DT_szBigId,
p_szDesc BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_ConfigTemplate
SET 
szDesc= p_szDesc
WHERE 
szConfigTemplateId = p_szConfigTemplateId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_DEV_DeleteALL()
RETURNS void AS
$BODY$
BEGIN
 EXEC PATTERN not set
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_DEV_DeleteALL_014()
RETURNS void AS
$BODY$
BEGIN
 EXEC PATTERN not set
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Error_Create(
p_szErrorLog varchar,
p_dtDateTime timestamp,
p_szClassDesc varchar)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_ErrorLog
(
szErrorLog,
dtDateTime,
szClassDesc
)
VALUES
(
p_szErrorLog,
p_dtDateTime,
p_szClassDesc
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_AddGroupToUser(
p_szUserId BOS_DT_szId,
p_szGroupId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_GroupUser
(
szGroupId,
szUserId
)
VALUES
(
p_szGroupId,
p_szUserId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_AddUser(
p_szGroupId BOS_DT_szId,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_GroupUser
(
szGroupId,
szUserId
)
VALUES
(
p_szGroupId,
p_szUserId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_CreateGroup(
p_szGroupId BOS_DT_szId,
p_szFullPathGroupId varchar,
p_byteLevel smallint,
p_szName BOS_DT_szName,
p_gdAuditTrailId bytea,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_Group
(
szGroupId,
szFullPathGroupId,
byteLevel,
szName,
gdAuditTrailId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szGroupId,
p_szFullPathGroupId,
p_byteLevel,
p_szName,
p_gdAuditTrailId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_CreateGroup_014(
p_szGroupId BOS_DT_szId,
p_szFullPathGroupId varchar,
p_byteLevel smallint,
p_szName BOS_DT_szName,
p_gdAuditTrailId bytea,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_Group
(
szGroupId,
szFullPathGroupId,
byteLevel,
szName,
gdAuditTrailId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szGroupId,
p_szFullPathGroupId,
p_byteLevel,
p_szName,
p_gdAuditTrailId,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_DeleteGroup(
p_szGroupId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SM_Group
WHERE
szGroupId = p_szGroupId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_DEV_DeleteALL()
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SM_GroupUser;
DELETE 
BOS_SM_Group;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_GetGroup(
p_szGroupId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFullPathGroupId, byteLevel, szName, gdAuditTrailId, dtmLastUpdated, bAlreadyTransferred

FROM 
BOS_SM_Group
WHERE 
szGroupId = p_szGroupId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_GetGroup_014(
p_szGroupId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFullPathGroupId, byteLevel, szName, gdAuditTrailId, dtmLastUpdated, bAlreadyTransferred

FROM 
BOS_SM_Group
WHERE 
szGroupId = p_szGroupId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_GetGuid(
p_szGroupId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
gdAuditTrailId

FROM 
BOS_SM_Group
WHERE 
szGroupId=p_szGroupId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_GetListOfAllGroup()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szGroupId, szName, byteLevel, szFullPathGroupId

FROM 
BOS_SM_Group

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_GetListOfgroup(
p_szFullPathGroupId BOS_DT_szId,
p_byteLevel smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szGroupId,
szFullPathGroupId

FROM 
BOS_SM_Group
WHERE 
szFullPathGroupId LIKE p_szFullPathGroupId + '%' AND byteLevel = p_byteLevel ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_GetListOfGroupChild(
p_szFullPathGroupId BOS_DT_szId,
p_byteLevel smallint)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szGroupId,
szFullPathGroupId

FROM 
BOS_SM_Group
WHERE 
szFullPathGroupId LIKE p_szFullPathGroupId + '%' AND byteLevel >= p_byteLevel ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_GetListOfUser(
p_szGroupId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szUserId

FROM 
BOS_SM_GroupUser
WHERE 
szGroupId = p_szGroupId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_GetListOfUserGroup(
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szGroupId

FROM 
BOS_SM_GroupUser
WHERE 
szUserId = p_szUserId ;ORDER BY 
--In read-un-committed transaction, the behavior of index is --like-- un-defined.

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_IsGroupExist(
p_szGroupId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFullPathGroupId

FROM 
BOS_SM_Group
WHERE 
szGroupId = p_szGroupId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_LockGroup(
p_szGroupId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_Group
SET 
byteLevel= byteLevel
WHERE 
szGroupId= p_szGroupId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_RemoveAllGroupOfUser(
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SM_GroupUser
WHERE
szUserId = p_szUserId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_RemoveAllUser(
p_szGroupId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SM_GroupUser
WHERE
szGroupId = p_szGroupId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_RemoveGroupOfUser(
p_szUserId BOS_DT_szId,
p_szGroupId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SM_GroupUser
WHERE
szUserId = p_szUserId AND szGroupId = p_szGroupId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_RemoveUser(
p_szGroupId BOS_DT_szId,
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SM_GroupUser
WHERE
szGroupId = p_szGroupId AND szUserId = p_szUserId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Group_UpdateGroup(
p_szGroupId BOS_DT_szId,
p_szFullPathGroupId varchar,
p_byteLevel smallint,
p_szName BOS_DT_szName,
p_szPrevFullPathGroupId varchar,
p_shDiffLevel smallint)
RETURNS void AS
$BODY$
BEGIN
-- ### 2 update #####
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_IsCustInvoiceExist(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId,
InvoiceszContactPerson,
InvoiceszRoomNo,
InvoiceszFloor,
InvoiceszBuilding,
InvoiceszAddress_1,
InvoiceszAddress_2,
InvoiceszDistrict,
InvoiceszCity,
InvoiceszZipCode,
InvoiceszState,
InvoiceszCountry,
InvoiceszPhoneNo_1,
InvoiceszPhoneNo_2,
InvoiceszFaxNo,
InvoiceszMobileNo,
InvoiceszEmail,
InvoiceszWebSite,
bIsDiffTaxAddress,
TaxszContactPerson,
TaxszRoomNo,
TaxszFloor,
TaxszBuilding,
TaxszAddress_1,
TaxszAddress_2,
TaxszDistrict,
TaxszCity,
TaxszZipCode,
TaxszState,
TaxszCountry,
TaxszPhoneNo_1,
TaxszPhoneNo_2,
TaxszFaxNo,
TaxszMobileNo,
TaxszEmail,
TaxszWebSite,
bIsDiffCollectAddress,
CollectszContactPerson,
CollectszRoomNo,
CollectszFloor,
CollectszBuilding,
CollectszAddress_1,
CollectszAddress_2,
CollectszDistrict,
CollectszCity,
CollectszZipCode,
CollectszState,
CollectszCountry,
CollectszPhoneNo_1,
CollectszPhoneNo_2,
CollectszFaxNo,
CollectszMobileNo,
CollectszEmail,
CollectszWebSite,
bLock

FROM 
BOS_SM_CustInvoice
WHERE 
szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_CreateDict(
p_szDictId BOS_DT_szBigId,
p_szDesc BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_LangDict
(
szDictId,
szDesc
)
VALUES
(
p_szDictId,
p_szDesc
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_CreateLang(
p_szDictId BOS_DT_szBigId,
p_szLangId BOS_DT_szSmallId,
p_szMsgTypeId varchar,
p_szTextId varchar,
p_szText varchar,
p_szContentId varchar)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_LangDictItem
(
szDictId,
szLangId,
szMsgTypeId,
szTextId,
szText,
bHasChanged,
szContentId
)
VALUES
(
p_szDictId,
p_szLangId,
p_szMsgTypeId,
p_szTextId,
p_szText,
0,
p_szContentId
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_CreateLang_013(
p_szDictId BOS_DT_szBigId,
p_szLangId BOS_DT_szSmallId,
p_szMsgTypeId varchar,
p_szTextId varchar,
p_szText varchar,
p_szContentId varchar,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_LangDictItem
(
szDictId,
szLangId,
szMsgTypeId,
szTextId,
szText,
bHasChanged,
szContentId,
dtmLastUpdated
)
VALUES
(
p_szDictId,
p_szLangId,
p_szMsgTypeId,
p_szTextId,
p_szText,
0,
p_szContentId,
p_dtmLastUpdated
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_CreateLangId(
p_szLangId BOS_DT_szSmallId,
p_szName BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_Language
(
szLangId,
szName
)
VALUES
(
p_szLangId,
p_szName
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_DeleteDict(
p_szDictId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SM_LangDict
WHERE
szDictId = p_szDictId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_DeleteLang(
p_szDictId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SM_LangDictItem
WHERE
szDictId = p_szDictId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_DeleteLangId(
p_szLangId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SM_Language
WHERE
szLangId = p_szLangId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_DeleteLangWhereLangId(
p_szDictId BOS_DT_szBigId,
p_szLangId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_DeleteNotChangedLang(
p_szDictId BOS_DT_szBigId,
p_szLangId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SM_LangDictItem
WHERE
szDictId = p_szDictIdAND szLangId = p_szLangIdAND bHasChanged = 0;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_DEV_DeleteALL()
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SM_LangDictItem;
DELETE 
BOS_SM_LangDict;
DELETE 
BOS_SM_Language;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_GetChangedLang(
p_szDictId BOS_DT_szBigId,
p_szLangId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SM_LangDict.szDictId,
BOS_SM_LangDictItem.szMsgTypeId,
BOS_SM_LangDictItem.szLangId,
BOS_SM_LangDictItem.szTextId,
BOS_SM_LangDictItem.szText,
BOS_SM_LangDictItem.szContentId

FROM 
BOS_SM_LangDict
WHERE 
BOS_SM_LangDict.szDictId = p_szDictId AND BOS_SM_LangDictItem.szLangId = p_szLangId AND bHasChanged = 1 ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_GetChangedLang_013(
p_szDictId BOS_DT_szBigId,
p_szLangId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SM_LangDict.szDictId,
BOS_SM_LangDictItem.szMsgTypeId,
BOS_SM_LangDictItem.szLangId,
BOS_SM_LangDictItem.szTextId,
BOS_SM_LangDictItem.szText,
BOS_SM_LangDictItem.szContentId

FROM 
BOS_SM_LangDict
WHERE 
BOS_SM_LangDict.szDictId = p_szDictId AND BOS_SM_LangDictItem.szLangId = p_szLangId AND bHasChanged = 1 ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_GetLang(
p_szDictId BOS_DT_szBigId,
p_szLangId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SM_LangDict.szDictId,
BOS_SM_LangDictItem.szMsgTypeId,
BOS_SM_LangDictItem.szLangId,
BOS_SM_LangDictItem.szTextId,
BOS_SM_LangDictItem.szText,
BOS_SM_LangDictItem.szContentId

FROM 
BOS_SM_LangDict
WHERE 
BOS_SM_LangDict.szDictId = p_szDictId AND BOS_SM_LangDictItem.szLangId = p_szLangId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_GetLang_013(
p_szDictId BOS_DT_szBigId,
p_szLangId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SM_LangDict.szDictId,
BOS_SM_LangDictItem.szMsgTypeId,
BOS_SM_LangDictItem.szLangId,
BOS_SM_LangDictItem.szTextId,
BOS_SM_LangDictItem.szText,
BOS_SM_LangDictItem.szContentId

FROM 
BOS_SM_LangDict
WHERE 
BOS_SM_LangDict.szDictId = p_szDictId AND BOS_SM_LangDictItem.szLangId = p_szLangId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_GetLangText(
p_szDictId BOS_DT_szBigId,
p_szLangId BOS_DT_szSmallId,
p_szMsgTypeId varchar,
p_szTextId varchar,
p_szContentId varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SM_LangDict.szDictId,
BOS_SM_LangDictItem.szMsgTypeId,
BOS_SM_LangDictItem.szLangId,
BOS_SM_LangDictItem.szTextId,
BOS_SM_LangDictItem.szText,
BOS_SM_LangDictItem.szContentId

FROM 
BOS_SM_LangDict
WHERE 
BOS_SM_LangDict.szDictId = p_szDictId AND BOS_SM_LangDictItem.szLangId = p_szLangId AND BOS_SM_LangDictItem.szMsgTypeId = p_szMsgTypeId AND BOS_SM_LangDictItem.szTextId = p_szTextId AND BOS_SM_LangDictItem.szContentId = p_szContentId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_GetLangText_013(
p_szDictId BOS_DT_szBigId,
p_szLangId BOS_DT_szSmallId,
p_szMsgTypeId varchar,
p_szTextId varchar,
p_szContentId varchar)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SM_LangDict.szDictId,
BOS_SM_LangDictItem.szMsgTypeId,
BOS_SM_LangDictItem.szLangId,
BOS_SM_LangDictItem.szTextId,
BOS_SM_LangDictItem.szText,
BOS_SM_LangDictItem.szContentId

FROM 
BOS_SM_LangDict
WHERE 
BOS_SM_LangDict.szDictId = p_szDictId AND BOS_SM_LangDictItem.szLangId = p_szLangId AND BOS_SM_LangDictItem.szMsgTypeId = p_szMsgTypeId AND BOS_SM_LangDictItem.szTextId = p_szTextId AND BOS_SM_LangDictItem.szContentId = p_szContentId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_GetListOfDict()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDictId,
szDesc

FROM 
BOS_SM_LangDict

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_GetListOfLangID()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szLangId,
szName

FROM 
BOS_SM_Language

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_GetListOfLangOfDict(
p_szDictId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
 DISTINCT szLangId

FROM 
BOS_SM_LangDictItem
WHERE 
     szDictId =  p_szDictId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_IsDictExist(
p_szDictId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SM_LangDict.szDesc

FROM 
BOS_SM_LangDict
WHERE 
BOS_SM_LangDict.szDictId=p_szDictId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_IsLanguageExist(
p_szDictId BOS_DT_szBigId,
p_szLangId BOS_DT_szSmallId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_SM_LangDictItem.szTextId

FROM 
BOS_SM_LangDict
WHERE 
BOS_SM_LangDict.szDictId=p_szDictId AND BOS_SM_LangDictItem.szLangId=p_szLangId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_LockDict(
p_szDictId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_LangDict
SET 
szDesc= szDesc
WHERE 
szDictId = p_szDictId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_UpdateDict(
p_szDictId BOS_DT_szBigId,
p_szDesc BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_LangDict
SET 
szDesc = p_szDesc
WHERE 
szDictId = p_szDictId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_UpdateLanguageAndSetChangedFlag(
p_szDictId BOS_DT_szBigId,
p_szLangId BOS_DT_szSmallId,
p_szMsgTypeId varchar,
p_szTextId varchar,
p_szText varchar,
p_szContentId varchar)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_LangDictItem
SET 
 NOCOUNT ON





WHERE 
szDictId = p_szDictId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Language_UpdateLanguageAndSetChangedFlag_013(
p_szDictId BOS_DT_szBigId,
p_szLangId BOS_DT_szSmallId,
p_szMsgTypeId varchar,
p_szTextId varchar,
p_szText varchar,
p_szContentId varchar,
p_dtmLastUpdated timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_LangDictItem
SET 
 NOCOUNT ON






WHERE 
szDictId = p_szDictId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_PrinterDriver_CreatePrinterDriver(
p_szPrinterId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szBarcodePrinterId BOS_DT_szSmallId,
p_szPrinterType BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_PrinterDriver
(
szPrinterId,
szName,
szBarcodePrinterId,
szPrinterType
)
VALUES
(
p_szPrinterId,
p_szName,
p_szBarcodePrinterId,
p_szPrinterType
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_PrinterDriver_CreatePrinterDriver_014(
p_szPrinterId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szBarcodePrinterId BOS_DT_szSmallId,
p_szPrinterType BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_PrinterDriver
(
szPrinterId,
szName,
szBarcodePrinterId,
szPrinterType
)
VALUES
(
p_szPrinterId,
p_szName,
p_szBarcodePrinterId,
p_szPrinterType,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_PrinterDriver_CreatePrinterDriverItem(
p_szPrinterId BOS_DT_szId,
p_szCommandName BOS_DT_szName,
p_szCommandCode varchar,
p_shCharWidth smallint,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_PrinterDriverItem
(
szPrinterId,
szCommandName,
szCommandCode,
shCharWidth,
szDescription
)
VALUES
(
p_szPrinterId,
p_szCommandName,
p_szCommandCode,
p_shCharWidth,
p_szDescription
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_PrinterDriver_DeletePrinterDriver(
p_szPrinterId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_SM_PrinterDriver
WHERE
szPrinterId=p_szPrinterId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_PrinterDriver_DeletePrinterDriverItem(
p_szPrinterId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_SM_PrinterDriverItem
WHERE
szPrinterId=p_szPrinterId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_PrinterDriver_GetListOfPrinterDriver()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPrinterId,
szName

FROM 
BOS_SM_PrinterDriver

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_PrinterDriver_GetPrinterDriver(
p_szPrinterId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szName,
szBarcodePrinterId,
szPrinterType

FROM 
BOS_SM_PrinterDriver
WHERE 
szPrinterId=p_szPrinterId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_PrinterDriver_GetPrinterDriver_014(
p_szPrinterId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szName,
szBarcodePrinterId,
szPrinterType

FROM 
BOS_SM_PrinterDriver
WHERE 
szPrinterId=p_szPrinterId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_PrinterDriver_GetPrinterDriverItem(
p_szPrinterId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCommandName,
szCommandCode,
shCharWidth,
szDescription

FROM 
BOS_SM_PrinterDriverItem
WHERE 
szPrinterId=p_szPrinterId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_PrinterDriver_IsPrinterDriverExist(
p_szPrinterId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szPrinterId

FROM 
BOS_SM_PrinterDriver
WHERE 
szPrinterId=p_szPrinterId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_PrinterDriver_LockPrinterDriver(
p_szPrinterId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_PrinterDriver
SET 
szName=szName
WHERE 
szPrinterId=p_szPrinterId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_PrinterDriver_UpdatePrinterDriver(
p_szPrinterId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szBarcodePrinterId BOS_DT_szSmallId,
p_szPrinterType BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_PrinterDriver
SET 
szName = p_szName,
szBarcodePrinterId = p_szBarcodePrinterId,
szPrinterType = p_szPrinterType
WHERE 
szPrinterId=p_szPrinterId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_PrinterDriver_UpdatePrinterDriver_014(
p_szPrinterId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szBarcodePrinterId BOS_DT_szSmallId,
p_szPrinterType BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_PrinterDriver
SET 
szName = p_szName,
szBarcodePrinterId = p_szBarcodePrinterId,
szPrinterType = p_szPrinterType
WHERE 
szPrinterId=p_szPrinterId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_CreateSecInfo(
p_szGroupId BOS_DT_szId,
p_szSecTplId BOS_DT_szBigId,
p_gdAuditTrailId bytea,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_SecInfo
(
szGroupId,
szSecTplId,
bLock,
gdAuditTrailId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szGroupId,
p_szSecTplId,
0,
p_gdAuditTrailId,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_CreateSecInfo_014(
p_szGroupId BOS_DT_szId,
p_szSecTplId BOS_DT_szBigId,
p_gdAuditTrailId bytea,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_SecInfo
(
szGroupId,
szSecTplId,
bLock,
gdAuditTrailId,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szGroupId,
p_szSecTplId,
0,
p_gdAuditTrailId,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_CreateSecInfoItem(
p_szGroupId BOS_DT_szId,
p_szSecTplId BOS_DT_szBigId,
p_szSecInfoItemId BOS_DT_szBigId,
p_szValue BOS_DT_szName,
p_bTimelyAccess bit,
p_StartTime1 timestamp,
p_EndTime1 timestamp,
p_StartTime2 timestamp,
p_EndTime2 timestamp)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_SecInfoItem
(
szGroupId,
szSecTplId,
szSecInfoItemId,
szValue,
bTimelyAccess,
StartTime1,
EndTime1,
StartTime2,
EndTime2	
)
VALUES
(
p_szGroupId,
p_szSecTplId,
p_szSecInfoItemId,
p_szValue,
p_bTimelyAccess,
p_StartTime1,
p_EndTime1,
p_StartTime2,
p_EndTime2
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_CreateSecTemplate(
p_szSecTplId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_SecTemplate
(
szSecTplId,
szDescription,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szSecTplId,
p_szDescription,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_CreateSecTemplate_014(
p_szSecTplId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_SecTemplate
(
szSecTplId,
szDescription,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szSecTplId,
p_szDescription,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_CreateSecTemplateItem(
p_szSecTplId BOS_DT_szBigId,
p_szSecInfoItemId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription,
p_szDefaultValue BOS_DT_szName)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_SecTemplateItem
(
szSecTplId,
szSecInfoItemId,
szDescription,
szDefaultValue
)
VALUES
(
p_szSecTplId,
p_szSecInfoItemId,
p_szDescription,
p_szDefaultValue
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_DeleteSecInfo(
p_szGroupId BOS_DT_szId,
p_szSecTplId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_DeleteSecInfoItem(
p_szGroupId BOS_DT_szId,
p_szSecTplId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_DeleteSecInfoWhereTemplateId(
p_szSecTplId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
 FROM BOS_SM_SecInfoItem
WHERE
szSecTplId=p_szSecTplId;DELETE 
 FROM BOS_SM_SecInfo
WHERE
szSecTplId=p_szSecTplId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_DeleteSecTemplate(
p_szSecTplId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SM_SecTemplate
WHERE
szSecTplId = p_szSecTplId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_DeleteSecTemplateItem(
p_szSecTplId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SM_SecTemplateItem
WHERE
szSecTplId = p_szSecTplId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_DEV_DeleteALL()
RETURNS void AS
$BODY$
BEGIN
DELETE 
BOS_SM_SecInfoItem;
DELETE 
BOS_SM_SecInfo;
DELETE 
BOS_SM_SecTemplateItem;
DELETE 
BOS_SM_SecTemplate;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_GetGuid(
p_szGroupId BOS_DT_szId,
p_szSecTplId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
gdAuditTrailId

FROM 
BOS_SM_SecInfo
WHERE 
szGroupId = p_szGroupId AND szSecTplId = p_szSecTplId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_GetListOfGroupSecurity(
p_szGroupId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
Select szSecTplId, szSecInfoItemId, szValue

FROM 
BOS_SM_SecInfoItem
WHERE 
 szGroupId = p_szGroupId;
ORDER BY 
Order By szSecTplId, szSecInfoItemId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_GetListOfSecTemplate()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szSecTplId, szDescription

FROM 
BOS_SM_SecTemplate
ORDER BY
szSecTPLID
ORDER BY 
szSecTPLID

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_GetSecInfo(
p_szGroupId BOS_DT_szId,
p_szSecTplId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
bLock,dtmLastUpdated,bAlreadyTransferred 

FROM 
BOS_SM_SecInfo 
WHERE 
szGroupId=p_szGroupId AND szSecTplId=p_szSecTplId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_GetSecInfo_014(
p_szGroupId BOS_DT_szId,
p_szSecTplId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
bLock,dtmLastUpdated,bAlreadyTransferred 

FROM 
BOS_SM_SecInfo 
WHERE 
szGroupId=p_szGroupId AND szSecTplId=p_szSecTplId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_GetSecInfoItem(
p_szGroupId BOS_DT_szId,
p_szSecTplId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szSecInfoItemId
, szValue
, bTimelyAccess
, StartTime1
, EndTime1
, StartTime2
, EndTime2

FROM 
BOS_SM_SecInfoItem
WHERE 
szGroupId=p_szGroupId AND szSecTplId=p_szSecTplId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_GetSecInfoItemWhereSecInfoItemId(
p_szGroupId BOS_DT_szId,
p_szSecTplId BOS_DT_szBigId,
p_szSecInfoItemId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szValue
, bTimelyAccess
, StartTime1
, EndTime1
, StartTime2
, EndTime2

FROM 
BOS_SM_SecInfoItem
WHERE 
szGroupId=p_szGroupId AND szSecTplId=p_szSecTplId AND szSecInfoItemId=p_szSecInfoItemId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_GetSecTemplate(
p_szSecTplId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription, dtmLastUpdated, bAlreadyTransferred 

FROM 
BOS_SM_SecTemplate 
WHERE 
szSecTplId=p_szSecTplId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_GetSecTemplate_014(
p_szSecTplId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription, dtmLastUpdated, bAlreadyTransferred 

FROM 
BOS_SM_SecTemplate 
WHERE 
szSecTplId=p_szSecTplId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_GetSecTemplateItem(
p_szSecTplId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szSecInfoItemId, szDescription, szDefaultValue 

FROM 
BOS_SM_SecTemplateItem 
WHERE 
szSecTplId=p_szSecTplId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_IsSecInfoExist(
p_szGroupId BOS_DT_szId,
p_szSecTplId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
bLock 

FROM 
BOS_SM_SecInfo 
WHERE 
szGroupId=p_szGroupId AND szSecTplId=p_szSecTplId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_IsSecTemplateExist(
p_szSecTplId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szDescription 

FROM 
BOS_SM_SecTemplate 
WHERE 
szSecTplId=p_szSecTplId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_LockSecInfo(
p_szGroupId BOS_DT_szId,
p_szSecTplId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_SecInfo
SET 
bLock=bLock
WHERE 
szGroupId=p_szGroupId AND;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_LockSecTemplate(
p_szSecTplId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_SecTemplate
SET 
szDescription=szDescription
WHERE 
szSecTplId=p_szSecTplId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Security_UpdateSecTemplate(
p_szSecTplId BOS_DT_szBigId,
p_szDescription BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_SecTemplate
SET 
szDescription=p_szDescription
WHERE 
szSecTplId=p_szSecTplId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Setup()
RETURNS void AS
$BODY$
BEGIN
 EXEC PATTERN not set
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_Setup_014()
RETURNS void AS
$BODY$
BEGIN
 EXEC PATTERN not set
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_User_ChangePassword(
p_szUserId BOS_DT_szId,
p_decPasswordHash BOS_DT_decAmount,
p_dtmPasswordExpiredDate timestamp)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_User
SET 
decPasswordHash = p_decPasswordHash,
dtmPasswordExpiredDate = p_dtmPasswordExpiredDate

WHERE 
szUserId = p_szUserId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_User_CreateUser(
p_szUserId BOS_DT_szId,
p_szName BOS_DT_szName,
p_decPasswordHash BOS_DT_decAmount,
p_szWorkplaceId BOS_DT_szId,
p_gdAuditTrailId bytea,
p_bClearPDC BOS_DT_bBoolean,
p_dtmPasswordExpiredDate timestamp,
p_bFirstTimeLogin BOS_DT_bBoolean,
p_dtmLockedForLogin timestamp,
p_iWrongLoginCounter integer,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_dtmLoginExpiredDate timestamp,
p_szApplicationClass BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_User
(
szUserId,
szName,
decPasswordHash,
szWorkplaceId,
gdAuditTrailId,
bClearPDC,
dtmPasswordExpiredDate,
bFirstTimeLogin,
dtmLockedForLogin,
iWrongLoginCounter,
dtmLastUpdated,
bAlreadyTransferred,
dtmLoginExpiredDate,
szApplicationClass
)
VALUES
(
p_szUserId,
p_szName,
p_decPasswordHash,
p_szWorkplaceId,
p_gdAuditTrailId,
p_bClearPDC,
p_dtmPasswordExpiredDate,
p_bFirstTimeLogin,
p_dtmLockedForLogin,
p_iWrongLoginCounter,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_dtmLoginExpiredDate,
p_szApplicationClass,
SET ANSI_NULLS ON,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_User_CreateUser_013(
p_szUserId BOS_DT_szId,
p_szName BOS_DT_szName,
p_decPasswordHash BOS_DT_decAmount,
p_szWorkplaceId BOS_DT_szId,
p_gdAuditTrailId bytea,
p_bClearPDC BOS_DT_bBoolean,
p_dtmPasswordExpiredDate timestamp,
p_bFirstTimeLogin BOS_DT_bBoolean,
p_dtmLockedForLogin timestamp,
p_iWrongLoginCounter integer,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_dtmLoginExpiredDate timestamp,
p_szApplicationClass BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_SM_User
(
szUserId,
szName,
decPasswordHash,
szWorkplaceId,
gdAuditTrailId,
bClearPDC,
dtmPasswordExpiredDate,
bFirstTimeLogin,
dtmLockedForLogin,
iWrongLoginCounter,
dtmLastUpdated,
bAlreadyTransferred,
dtmLoginExpiredDate,
szApplicationClass
)
VALUES
(
p_szUserId,
p_szName,
p_decPasswordHash,
p_szWorkplaceId,
p_gdAuditTrailId,
p_bClearPDC,
p_dtmPasswordExpiredDate,
p_bFirstTimeLogin,
p_dtmLockedForLogin,
p_iWrongLoginCounter,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_dtmLoginExpiredDate,
p_szApplicationClass,
SET ANSI_NULLS ON,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_User_DeleteUser(
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_User_DEV_DeleteALL()
RETURNS void AS
$BODY$
BEGIN
DELETE 
 BOS_SM_User where szUserId <> 'administrator';

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_User_GetGuid(
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
gdAuditTrailId

FROM 
BOS_SM_User
WHERE 
szUserId=p_szUserId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_User_GetListOfUser()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szUserId,

FROM 
BOS_SM_User

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_User_GetUser(
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SM_User.szName,
BOS_SM_User.decPasswordHash,
BOS_SM_User.szWorkplaceId,

BOS_GL_Workplace.szSalesOrgId AS szWorkplaceSalesOrgId_1_J,
SO.szParentSalesOrgId AS szWorkplaceSalesOrgId_2_J,

BOS_GL_Workplace.szTaxId AS szWorkplaceTaxEntityId_J,

BOS_GL_Workplace.szCompanyId,
BOS_GL_Company.szName AS szCompanyNm_J,

BOS_SM_User.gdAuditTrailId,

BOS_SM_User.bClearPDC,
BOS_SM_User.dtmPasswordExpiredDate,
BOS_SM_User.bFirstTimeLogin,
BOS_SM_User.dtmLockedForLogin,
BOS_SM_User.iWrongLoginCounter,

BOS_SM_User.dtmLastUpdated,
BOS_SM_User.bAlreadyTransferred,
BOS_SM_User.dtmLoginExpiredDate,
BOS_SM_User.szApplicationClass 

FROM
BOS_SM_User
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SM_User.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_GL_Workplace.szCompanyId
LEFT JOIN BOS_SD_SalesOrganization AS SO ON SO.szSalesOrgId = BOS_GL_Workplace.szSalesOrgId
WHERE
BOS_SM_User.szUserId = p_szUserId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_User_GetUser_013(
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_SM_User.szName,
BOS_SM_User.decPasswordHash,
BOS_SM_User.szWorkplaceId,

BOS_GL_Workplace.szSalesOrgId AS szWorkplaceSalesOrgId_1_J,
SO.szParentSalesOrgId AS szWorkplaceSalesOrgId_2_J,

BOS_GL_Workplace.szTaxId AS szWorkplaceTaxEntityId_J,

BOS_GL_Workplace.szCompanyId,
BOS_GL_Company.szName AS szCompanyNm_J,

BOS_SM_User.gdAuditTrailId,

BOS_SM_User.bClearPDC,
BOS_SM_User.dtmPasswordExpiredDate,
BOS_SM_User.bFirstTimeLogin,
BOS_SM_User.dtmLockedForLogin,
BOS_SM_User.iWrongLoginCounter,

BOS_SM_User.dtmLastUpdated,
BOS_SM_User.bAlreadyTransferred,
BOS_SM_User.dtmLoginExpiredDate,
BOS_SM_User.szApplicationClass 

FROM
BOS_SM_User
LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_SM_User.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_GL_Workplace.szCompanyId
LEFT JOIN BOS_SD_SalesOrganization AS SO ON SO.szSalesOrgId = BOS_GL_Workplace.szSalesOrgId
WHERE
BOS_SM_User.szUserId = p_szUserId

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_User_IsUserExist(
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szName,

FROM 
BOS_SM_User
WHERE 
szUserId=p_szUserId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_User_LockUser(
p_szUserId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_User
SET 
szName= szName
WHERE 
szUserId= p_szUserId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_User_UpdateUser(
p_szUserId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szWorkplaceId BOS_DT_szId,
p_bClearPDC BOS_DT_bBoolean,
p_decPasswordHash BOS_DT_decAmount,
p_dtmLoginExpiredDate timestamp,
p_szApplicationClass BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_User
SET 
szName = p_szName,
szWorkplaceId = p_szWorkplaceId,
bClearPDC = p_bClearPDC,
decPasswordHash = p_decPasswordHash,
dtmLoginExpiredDate = p_dtmLoginExpiredDate,
szApplicationClass = p_szApplicationClass

WHERE 
szUserId = p_szUserId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_SM_User_UpdateUser_013(
p_szUserId BOS_DT_szId,
p_szName BOS_DT_szName,
p_szWorkplaceId BOS_DT_szId,
p_bClearPDC BOS_DT_bBoolean,
p_decPasswordHash BOS_DT_decAmount,
p_dtmLoginExpiredDate timestamp,
p_szApplicationClass BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_SM_User
SET 
szName = p_szName,
szWorkplaceId = p_szWorkplaceId,
bClearPDC = p_bClearPDC,
decPasswordHash = p_decPasswordHash,
dtmLoginExpiredDate = p_dtmLoginExpiredDate,
szApplicationClass = p_szApplicationClass

WHERE 
szUserId = p_szUserId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_CustTaxIndConfig_CreateCustTaxIndConfig(
p_szCustId BOS_DT_szId,
p_szTaxIndConfigId BOS_DT_szId,
p_szNPWP BOS_DT_szTaxId,
p_szPKP BOS_DT_szTaxId,
p_dtmPKP timestamp,
p_szTaxTrnId BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_TIN_CustTaxIndConfig
(
szCustId,
szTaxIndConfigId,
szNPWP,
szPKP,
dtmPKP,
szTaxTrnId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCustId,
p_szTaxIndConfigId,
p_szNPWP,
p_szPKP,
p_dtmPKP,
p_szTaxTrnId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_CustTaxIndConfig_CreateCustTaxIndConfig_014(
p_szCustId BOS_DT_szId,
p_szTaxIndConfigId BOS_DT_szId,
p_szNPWP BOS_DT_szTaxId,
p_szPKP BOS_DT_szTaxId,
p_dtmPKP timestamp,
p_szTaxTrnId BOS_DT_szDescription,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_TIN_CustTaxIndConfig
(
szCustId,
szTaxIndConfigId,
szNPWP,
szPKP,
dtmPKP,
szTaxTrnId,
-- Data Status.,
dtmLastUpdated,
bAlreadyTransferred
)
VALUES
(
p_szCustId,
p_szTaxIndConfigId,
p_szNPWP,
p_szPKP,
p_dtmPKP,
p_szTaxTrnId,
-- Data Status.,
p_dtmLastUpdated,
p_bAlreadyTransferred,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_CustTaxIndConfig_DeleteCustTaxIndConfig(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_CustTaxIndConfig_GetCustTaxIndConfig(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_TIN_CustTaxIndConfig.szTaxIndConfigId,
BOS_TIN_CustTaxIndConfig.szNPWP,
BOS_TIN_CustTaxIndConfig.szPKP,
BOS_TIN_CustTaxIndConfig.dtmPKP,
BOS_TIN_CustTaxIndConfig.szTaxTrnId,
BOS_AR_CustInvoice.szCustTaxNm AS szCustTaxNm_J,
BOS_TIN_CustTaxIndConfig.dtmLastUpdated,
BOS_TIN_CustTaxIndConfig.bAlreadyTransferred

FROM 
BOS_TIN_CustTaxIndConfig
LEFT JOIN BOS_AR_CustInvoice ON BOS_TIN_CustTaxIndConfig.szCustId = BOS_AR_CustInvoice.szCustIdLEFT JOIN BOS_AR_CustInvoice ON BOS_TIN_CustTaxIndConfig.szCustId = BOS_AR_CustInvoice.szCustId;

WHERE 
BOS_TIN_CustTaxIndConfig.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_CustTaxIndConfig_GetCustTaxIndConfig_014(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
BOS_TIN_CustTaxIndConfig.szTaxIndConfigId,
BOS_TIN_CustTaxIndConfig.szNPWP,
BOS_TIN_CustTaxIndConfig.szPKP,
BOS_TIN_CustTaxIndConfig.dtmPKP,
BOS_TIN_CustTaxIndConfig.szTaxTrnId,
BOS_AR_CustInvoice.szCustTaxNm AS szCustTaxNm_J,
BOS_TIN_CustTaxIndConfig.dtmLastUpdated,
BOS_TIN_CustTaxIndConfig.bAlreadyTransferred

FROM 
BOS_TIN_CustTaxIndConfig
LEFT JOIN BOS_AR_CustInvoice ON BOS_TIN_CustTaxIndConfig.szCustId = BOS_AR_CustInvoice.szCustIdLEFT JOIN BOS_AR_CustInvoice ON BOS_TIN_CustTaxIndConfig.szCustId = BOS_AR_CustInvoice.szCustId;

WHERE 
BOS_TIN_CustTaxIndConfig.szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_CustTaxIndConfig_GetListOfCustTaxIndConfig()
RETURNS void AS
$BODY$
BEGIN
SELECT 
szCustId

FROM 
BOS_TIN_CustTaxIndConfig

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_CustTaxIndConfig_IsCustTaxIndConfigExist(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szTaxIndConfigId

FROM 
BOS_TIN_CustTaxIndConfig
WHERE 
szCustId = p_szCustId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_CustTaxIndConfig_LockCustTaxIndConfig(
p_szCustId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_TIN_CustTaxIndConfig
SET 
szTaxIndConfigId = szTaxIndConfigId
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_CustTaxIndConfig_UpdateCustTaxIndConfig(
p_szCustId BOS_DT_szId,
p_szTaxIndConfigId BOS_DT_szId,
p_szNPWP BOS_DT_szTaxId,
p_szPKP BOS_DT_szTaxId,
p_dtmPKP timestamp,
p_szTaxTrnId BOS_DT_szDescription)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_TIN_CustTaxIndConfig
SET 
szTaxIndConfigId = p_szTaxIndConfigId,
szNPWP = p_szNPWP,
szPKP = p_szPKP,
dtmPKP = p_dtmPKP,
szTaxTrnId = p_szTaxTrnId
WHERE 
szCustId = p_szCustId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_CreateFakturPajak(
p_szFakturPajakId BOS_DT_szId,
p_dtmFakturPajak timestamp,
p_szCustId BOS_DT_szId,
p_szCustNm BOS_DT_szName,
p_szCustAddr BOS_DT_szDescription,
p_szCustNpwp BOS_DT_szTaxId,
p_szCompId BOS_DT_szId,
p_szCompNm BOS_DT_szName,
p_szCompAddr varchar,
p_szCompNpwp BOS_DT_szTaxId,
p_szCompPkpNo BOS_DT_szTaxId,
p_dtmCompPkpTg timestamp,
p_szTaxIndConfigId BOS_DT_szId,
p_bIncludeTax smallint,
p_shFakturType smallint,
p_szCcyId BOS_DT_szSmallId,
p_decAmount BOS_DT_decAmount,
p_decDiscount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_decPPN BOS_DT_decTax,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_shTaxIndConfigType smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_TIN_FakturPajak
(
szFakturPajakId,
dtmFakturPajak,
szCustId,
szCustNm,
szCustAddr,
szCustNpwp,
szCompId,
szCompNm,
szCompAddr,
szCompNpwp,
szCompPkpNo,
dtmCompPkpTg,
szTaxIndConfigId,
bIncludeTax,
shFakturType,
szCcyId,
decAmount,
decDiscount,
decDPP,
decPPN,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
dtmLastUpdated,
bAlreadyTransferred,
shTaxIndConfigType
)
VALUES
(
p_szFakturPajakId,
p_dtmFakturPajak,
p_szCustId,
p_szCustNm,
p_szCustAddr,
p_szCustNpwp,
p_szCompId,
p_szCompNm,
p_szCompAddr,
p_szCompNpwp,
p_szCompPkpNo,
p_dtmCompPkpTg,
p_szTaxIndConfigId,
p_bIncludeTax,
p_shFakturType,
p_szCcyId,
p_decAmount,
p_decDiscount,
p_decDPP,
p_decPPN,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_shTaxIndConfigType,
-----------------------
SET ANSI_NULLS ON,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_CreateFakturPajak_013(
p_szFakturPajakId BOS_DT_szId,
p_dtmFakturPajak timestamp,
p_szCustId BOS_DT_szId,
p_szCustNm BOS_DT_szName,
p_szCustAddr BOS_DT_szDescription,
p_szCustNpwp BOS_DT_szTaxId,
p_szCompId BOS_DT_szId,
p_szCompNm BOS_DT_szName,
p_szCompAddr varchar,
p_szCompNpwp BOS_DT_szTaxId,
p_szCompPkpNo BOS_DT_szTaxId,
p_dtmCompPkpTg timestamp,
p_szTaxIndConfigId BOS_DT_szId,
p_bIncludeTax smallint,
p_shFakturType smallint,
p_szCcyId BOS_DT_szSmallId,
p_decAmount BOS_DT_decAmount,
p_decDiscount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_decPPN BOS_DT_decTax,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_shTaxIndConfigType smallint)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_TIN_FakturPajak
(
szFakturPajakId,
dtmFakturPajak,
szCustId,
szCustNm,
szCustAddr,
szCustNpwp,
szCompId,
szCompNm,
szCompAddr,
szCompNpwp,
szCompPkpNo,
dtmCompPkpTg,
szTaxIndConfigId,
bIncludeTax,
shFakturType,
szCcyId,
decAmount,
decDiscount,
decDPP,
decPPN,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
dtmLastUpdated,
bAlreadyTransferred,
shTaxIndConfigType
)
VALUES
(
p_szFakturPajakId,
p_dtmFakturPajak,
p_szCustId,
p_szCustNm,
p_szCustAddr,
p_szCustNpwp,
p_szCompId,
p_szCompNm,
p_szCompAddr,
p_szCompNpwp,
p_szCompPkpNo,
p_dtmCompPkpTg,
p_szTaxIndConfigId,
p_bIncludeTax,
p_shFakturType,
p_szCcyId,
p_decAmount,
p_decDiscount,
p_decDPP,
p_decPPN,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_shTaxIndConfigType,
-----------------------
SET ANSI_NULLS ON,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_CreateFakturPajak_014(
p_szFakturPajakId BOS_DT_szBigId,
p_dtmFakturPajak timestamp,
p_szCustId BOS_DT_szId,
p_szCustNm BOS_DT_szName,
p_szCustAddr BOS_DT_szBigDescription,
p_szCustNpwp BOS_DT_szTaxId,
p_szCompId BOS_DT_szId,
p_szCompNm BOS_DT_szName,
p_szCompAddr varchar,
p_szCompNpwp BOS_DT_szTaxId,
p_szCompPkpNo BOS_DT_szTaxId,
p_dtmCompPkpTg timestamp,
p_szTaxIndConfigId BOS_DT_szId,
p_bIncludeTax smallint,
p_shFakturType smallint,
p_szCcyId BOS_DT_szSmallId,
p_decAmount BOS_DT_decAmount,
p_decDiscount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_decPPN BOS_DT_decTax,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_dtmLastUpdated timestamp,
p_bAlreadyTransferred bit,
p_shTaxIndConfigType smallint,
p_szFakturPajakType BOS_DT_szId,
p_szReturnRefId BOS_DT_szBigId,
p_szCustReturnTaxRefNote BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_TIN_FakturPajak
(
szFakturPajakId,
dtmFakturPajak,
szCustId,
szCustNm,
szCustAddr,
szCustNpwp,
szCompId,
szCompNm,
szCompAddr,
szCompNpwp,
szCompPkpNo,
dtmCompPkpTg,
szTaxIndConfigId,
bIncludeTax,
shFakturType,
szCcyId,
decAmount,
decDiscount,
decDPP,
decPPN,
bResultFrTransfer,
bVoid,
bApplied,
btPrintedCount,
bTransferred,
szCompanyId,
szWorkplaceId,
szTaxEntityId,
bNeedApproval,
gdApprovedId,
szFJournalId,
dtmCreated,
bSystemCreated,
szUserId,
dtmLastUpdated,
bAlreadyTransferred,
shTaxIndConfigType,
szFakturPajakType,
szReturnRefId,
szCustReturnTaxRefNote
)
VALUES
(
p_szFakturPajakId,
p_dtmFakturPajak,
p_szCustId,
p_szCustNm,
p_szCustAddr,
p_szCustNpwp,
p_szCompId,
p_szCompNm,
p_szCompAddr,
p_szCompNpwp,
p_szCompPkpNo,
p_dtmCompPkpTg,
p_szTaxIndConfigId,
p_bIncludeTax,
p_shFakturType,
p_szCcyId,
p_decAmount,
p_decDiscount,
p_decDPP,
p_decPPN,
p_bResultFrTransfer,
p_bVoid,
p_bApplied,
p_btPrintedCount,
p_bTransferred,
p_szCompanyId,
p_szWorkplaceId,
p_szTaxEntityId,
p_bNeedApproval,
p_gdApprovedId,
p_szFJournalId,
p_dtmCreated,
p_bSystemCreated,
p_szUserId,
p_dtmLastUpdated,
p_bAlreadyTransferred,
p_shTaxIndConfigType,
p_szFakturPajakType,
p_szReturnRefId,
p_szCustReturnTaxRefNote,
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_CreateFakturPajakItem_014(
p_szFakturPajakId BOS_DT_szBigId,
p_shItemNumber smallint,
p_szProductId BOS_DT_szId,
p_szProductNm BOS_DT_szName,
p_decQty BOS_DT_decAmount,
p_decPrice BOS_DT_decAmount,
p_decSubTotal BOS_DT_decAmount,
p_decDiscount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_decTax BOS_DT_decTax,
p_decTaxRate BOS_DT_decAmount,
p_decReturnQtyRemaining BOS_DT_decAmount)
RETURNS void AS
$BODY$
BEGIN
INSERT INTO BOS_TIN_FakturPajakItem
(
szFakturPajakId,
shItemNumber,
szProductId,
szProductNm,
decQty,
decPrice,
decSubTotal,
decDiscount,
decDPP,
decTax,
decTaxRate,
decReturnQtyRemaining
)
VALUES
(
p_szFakturPajakId,
p_shItemNumber,
p_szProductId,
p_szProductNm,
p_decQty,
p_decPrice,
p_decSubTotal,
p_decDiscount,
p_decDPP,
p_decTax,
p_decTaxRate,
p_decReturnQtyRemaining,
-----------------------,
SET ANSI_NULLS ON
);

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_DeleteFakturPajak(
p_szFakturPajakId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_TIN_FakturPajak
WHERE
szFakturPajakId = p_szFakturPajakId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_DeleteFakturPajak_013(
p_szFakturPajakId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_TIN_FakturPajak
WHERE
szFakturPajakId = p_szFakturPajakId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_DeleteFakturPajakItem(
p_szFakturPajakId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_TIN_FakturPajakItem
WHERE
szFakturPajakId = p_szFakturPajakId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_DeleteFakturPajakItem_013(
p_szFakturPajakId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
DELETE 
FROM  BOS_TIN_FakturPajakItem
WHERE
szFakturPajakId = p_szFakturPajakId;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_GetFakturPajak(
p_szFakturPajakId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_TIN_FakturPajak.szFakturPajakId,
BOS_TIN_FakturPajak.dtmFakturPajak,

BOS_TIN_FakturPajak.szCustId,
BOS_TIN_FakturPajak.szCustNm,
BOS_TIN_FakturPajak.szCustNpwp,
BOS_TIN_FakturPajak.szCustAddr,

BOS_TIN_FakturPajak.szCompId,
BOS_TIN_FakturPajak.szCompNm,
BOS_TIN_FakturPajak.szCompNpwp,
BOS_TIN_FakturPajak.szCompPkpNo,
BOS_TIN_FakturPajak.dtmCompPkpTg,
BOS_TIN_FakturPajak.szCompAddr,

BOS_TIN_FakturPajak.szTaxIndConfigId,

BOS_TIN_FakturPajak.bIncludeTax,
BOS_TIN_FakturPajak.shFakturType,

BOS_TIN_FakturPajak.szCcyId,
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat_J,

BOS_TIN_FakturPajak.decAmount,
BOS_TIN_FakturPajak.decDiscount,
BOS_TIN_FakturPajak.decDPP,
BOS_TIN_FakturPajak.decPPN,

BOS_TIN_FakturPajak.bResultFrTransfer,
BOS_TIN_FakturPajak.bVoid,
BOS_GEN_Approved.bApproved,
BOS_TIN_FakturPajak.bApplied,
BOS_GL_FJournalTrans.szFJournalId AS bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_TIN_FakturPajak.btPrintedCount,
BOS_TIN_FakturPajak.bTransferred,

BOS_TIN_FakturPajak.szCompanyId,
BOS_GL_Company.szName AS szCompanyNm,

BOS_TIN_FakturPajak.szWorkplaceId,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_TIN_FakturPajak.szTaxEntityId,
BOS_TIN_FakturPajak.bNeedApproval,
BOS_TIN_FakturPajak.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_TIN_FakturPajak.dtmLastUpdated,
BOS_TIN_FakturPajak.bAlreadyTransferred,

BOS_TIN_FakturPajak.dtmCreated,
BOS_TIN_FakturPajak.bSystemCreated,

BOS_TIN_FakturPajak.szUserId,
BOS_SM_User.szName AS szUserNm_J,

BOS_TIN_FakturPajak.shTaxIndConfigType
FROM
BOS_TIN_FakturPajak 
LEFT JOIN BOS_GEN_Approved ON BOS_TIN_FakturPajak.gdApprovedId=BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_TIN_FakturPajak.szFJournalId=BOS_GL_FJournalTrans.szFJournalId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_TIN_FakturPajak.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_TIN_FakturPajak.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_TIN_FakturPajak.szUserId

LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_TIN_FakturPajak.szCcyId

WHERE
BOS_TIN_FakturPajak.szFakturPajakId = p_szFakturPajakId


-----------------------
SET ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_GetFakturPajak_013(
p_szFakturPajakId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN

SELECT
BOS_TIN_FakturPajak.szFakturPajakId,
BOS_TIN_FakturPajak.dtmFakturPajak,

BOS_TIN_FakturPajak.szCustId,
BOS_TIN_FakturPajak.szCustNm,
BOS_TIN_FakturPajak.szCustNpwp,
BOS_TIN_FakturPajak.szCustAddr,

BOS_TIN_FakturPajak.szCompId,
BOS_TIN_FakturPajak.szCompNm,
BOS_TIN_FakturPajak.szCompNpwp,
BOS_TIN_FakturPajak.szCompPkpNo,
BOS_TIN_FakturPajak.dtmCompPkpTg,
BOS_TIN_FakturPajak.szCompAddr,

BOS_TIN_FakturPajak.szTaxIndConfigId,

BOS_TIN_FakturPajak.bIncludeTax,
BOS_TIN_FakturPajak.shFakturType,

BOS_TIN_FakturPajak.szCcyId,
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat_J,

BOS_TIN_FakturPajak.decAmount,
BOS_TIN_FakturPajak.decDiscount,
BOS_TIN_FakturPajak.decDPP,
BOS_TIN_FakturPajak.decPPN,

BOS_TIN_FakturPajak.bResultFrTransfer,
BOS_TIN_FakturPajak.bVoid,
BOS_GEN_Approved.bApproved,
BOS_TIN_FakturPajak.bApplied,
BOS_GL_FJournalTrans.szFJournalId AS bJournal,
BOS_GL_FJournalTrans.bPosted,
BOS_TIN_FakturPajak.btPrintedCount,
BOS_TIN_FakturPajak.bTransferred,

BOS_TIN_FakturPajak.szCompanyId,
BOS_GL_Company.szName AS szCompanyNm,

BOS_TIN_FakturPajak.szWorkplaceId,
BOS_GL_Workplace.szName AS szWorkplaceNm,

BOS_TIN_FakturPajak.szTaxEntityId,
BOS_TIN_FakturPajak.bNeedApproval,
BOS_TIN_FakturPajak.gdApprovedId,
BOS_GEN_Approved.szApprovalId,
BOS_GL_FJournalTrans.szFJournalId,
BOS_TIN_FakturPajak.dtmLastUpdated,
BOS_TIN_FakturPajak.bAlreadyTransferred,

BOS_TIN_FakturPajak.dtmCreated,
BOS_TIN_FakturPajak.bSystemCreated,

BOS_TIN_FakturPajak.szUserId,
BOS_SM_User.szName AS szUserNm_J,

BOS_TIN_FakturPajak.shTaxIndConfigType
FROM
BOS_TIN_FakturPajak 
LEFT JOIN BOS_GEN_Approved ON BOS_TIN_FakturPajak.gdApprovedId=BOS_GEN_Approved.gdApprovedId
LEFT JOIN BOS_GL_FJournalTrans ON BOS_TIN_FakturPajak.szFJournalId=BOS_GL_FJournalTrans.szFJournalId

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_TIN_FakturPajak.szWorkplaceId
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_TIN_FakturPajak.szCompanyId
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_TIN_FakturPajak.szUserId


LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_TIN_FakturPajak.szCcyId

WHERE
BOS_TIN_FakturPajak.szFakturPajakId = p_szFakturPajakId


-----------------------
SET ANSI_NULLS ON

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_GetFakturPajak_014(
p_szFakturPajakId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN

SELECT    
BOS_TIN_FakturPajak.szFakturPajakId,    
BOS_TIN_FakturPajak.dtmFakturPajak,    

BOS_TIN_FakturPajak.szCustId,    
BOS_TIN_FakturPajak.szCustNm,    
BOS_TIN_FakturPajak.szCustNpwp,    
BOS_TIN_FakturPajak.szCustAddr,    

BOS_TIN_FakturPajak.szCompId,    
BOS_TIN_FakturPajak.szCompNm,    
BOS_TIN_FakturPajak.szCompNpwp,    
BOS_TIN_FakturPajak.szCompPkpNo,    
BOS_TIN_FakturPajak.dtmCompPkpTg,    
BOS_TIN_FakturPajak.szCompAddr,    

BOS_TIN_FakturPajak.szTaxIndConfigId,    

BOS_TIN_FakturPajak.bIncludeTax,    
BOS_TIN_FakturPajak.shFakturType,    

BOS_TIN_FakturPajak.szCcyId,    
BOS_CU_Currency.szAmountFormat AS szCcyAmountFormat_J,    

BOS_TIN_FakturPajak.decAmount,    
BOS_TIN_FakturPajak.decDiscount,    
BOS_TIN_FakturPajak.decDPP,    
BOS_TIN_FakturPajak.decPPN,    

BOS_TIN_FakturPajak.bResultFrTransfer,    
BOS_TIN_FakturPajak.bVoid,    
BOS_GEN_Approved.bApproved,    
BOS_TIN_FakturPajak.bApplied,    
BOS_GL_FJournalTrans.szFJournalId AS bJournal,    
BOS_GL_FJournalTrans.bPosted,    
BOS_TIN_FakturPajak.btPrintedCount,    
BOS_TIN_FakturPajak.bTransferred,    

BOS_TIN_FakturPajak.szCompanyId,    
BOS_GL_Company.szName AS szCompanyNm,    

BOS_TIN_FakturPajak.szWorkplaceId,    
BOS_GL_Workplace.szName AS szWorkplaceNm,    

BOS_TIN_FakturPajak.szTaxEntityId,    
BOS_TIN_FakturPajak.bNeedApproval,    
BOS_TIN_FakturPajak.gdApprovedId,    
BOS_GEN_Approved.szApprovalId,    
BOS_GL_FJournalTrans.szFJournalId,    
BOS_TIN_FakturPajak.dtmLastUpdated,    
BOS_TIN_FakturPajak.bAlreadyTransferred,    

BOS_TIN_FakturPajak.dtmCreated,    
BOS_TIN_FakturPajak.bSystemCreated,    

BOS_TIN_FakturPajak.szUserId,    
BOS_SM_User.szName AS szUserNm_J,    

BOS_TIN_FakturPajak.shTaxIndConfigType,
BOS_TIN_FakturPajak.szFakturPajakType,
BOS_TIN_FakturPajak.szReturnRefId,   
BOS_TIN_FakturPajak.szCustReturnTaxRefNote  
FROM    
BOS_TIN_FakturPajak     
LEFT JOIN BOS_GEN_Approved ON BOS_TIN_FakturPajak.gdApprovedId=BOS_GEN_Approved.gdApprovedId    
LEFT JOIN BOS_GL_FJournalTrans ON BOS_TIN_FakturPajak.szFJournalId=BOS_GL_FJournalTrans.szFJournalId    

LEFT JOIN BOS_GL_Workplace ON BOS_GL_Workplace.szWorkplaceId = BOS_TIN_FakturPajak.szWorkplaceId    
LEFT JOIN BOS_GL_Company ON BOS_GL_Company.szCompanyId = BOS_TIN_FakturPajak.szCompanyId    
LEFT JOIN BOS_SM_User ON BOS_SM_User.szUserId = BOS_TIN_FakturPajak.szUserId    


LEFT JOIN BOS_CU_Currency ON BOS_CU_Currency.szCcyId = BOS_TIN_FakturPajak.szCcyId    

WHERE    
BOS_TIN_FakturPajak.szFakturPajakId = p_szFakturPajakId   


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_GetFakturPajakItem_014(
p_szFakturPajakId BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN

SELECT    
BOS_TIN_FakturPajakItem.szProductId,    
BOS_TIN_FakturPajakItem.shItemNumber,
BOS_INV_Product.szName as szProductNm_J,    
BOS_INV_Product.szQtyFormat AS szProductQtyFormat_J,    
BOS_GL_TaxType.decRate AS decProductTaxRate_J,    
BOS_INV_Product.szUomId AS szProductUomId_J,    
BOS_INV_Product.szCompUomId AS szProductCompUomId_J,    
BOS_INV_Product.szUomClassId AS szProductUomClassId_J,    

BOS_TIN_FakturPajakItem.szProductNm,    
BOS_TIN_FakturPajakItem.decQty,    
BOS_TIN_FakturPajakItem.decPrice,    
BOS_TIN_FakturPajakItem.decSubTotal,    

BOS_TIN_FakturPajakItem.decDiscount,    
BOS_TIN_FakturPajakItem.decDPP,    
BOS_TIN_FakturPajakItem.decTax,    
BOS_TIN_FakturPajakItem.decTaxRate,      
BOS_TIN_FakturPajakItem.decReturnQtyRemaining      

FROM    
BOS_TIN_FakturPajakItem
LEFT JOIN BOS_INV_Product ON BOS_INV_Product.szProductId = BOS_TIN_FakturPajakItem.szProductId    
LEFT JOIN BOS_GL_TaxType ON BOS_GL_TaxType.szTaxTypeId = BOS_INV_Product.szTaxTypeId    

WHERE    
BOS_TIN_FakturPajakItem.szFakturPajakId = p_szFakturPajakId   

-----------------------
SET ANSI_NULLS ON


END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_GetListOfFakturPajak_014()
RETURNS void AS
$BODY$
BEGIN
SELECT 
 DISTINCT BOS_TIN_FakturPajakItem.szFakturPajakId, BOS_TIN_FakturPajakItemInvoiceSource.szInvoiceId

FROM 
BOS_TIN_FakturPajakItem

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_IsFakturPajakExist(
p_szFakturPajakId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFakturPajakId

FROM 
BOS_TIN_FakturPajak
WHERE 
szFakturPajakId = p_szFakturPajakId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_IsFakturPajakExist_013(
p_szFakturPajakId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
SELECT 
szFakturPajakId

FROM 
BOS_TIN_FakturPajak
WHERE 
szFakturPajakId = p_szFakturPajakId ;
END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_LockFakturPajak(
p_szFakturPajakId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_TIN_FakturPajak
SET 
bTransferred = bTransferred
WHERE 
szFakturPajakId = p_szFakturPajakId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_LockFakturPajak_013(
p_szFakturPajakId BOS_DT_szId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_TIN_FakturPajak
SET 
bTransferred = bTransferred
WHERE 
szFakturPajakId = p_szFakturPajakId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_UpdateFakturPajak(
p_szFakturPajakId BOS_DT_szId,
p_dtmFakturPajak timestamp,
p_szCustId BOS_DT_szId,
p_szCustNm BOS_DT_szName,
p_szCustAddr BOS_DT_szDescription,
p_szCustNpwp BOS_DT_szTaxId,
p_szCompId BOS_DT_szId,
p_szCompNm BOS_DT_szName,
p_szCompAddr varchar,
p_szCompNpwp BOS_DT_szTaxId,
p_szCompPkpNo BOS_DT_szTaxId,
p_dtmCompPkpTg timestamp,
p_szTaxIndConfigId BOS_DT_szId,
p_bIncludeTax smallint,
p_shFakturType smallint,
p_szCcyId BOS_DT_szSmallId,
p_decAmount BOS_DT_decAmount,
p_decDiscount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_decPPN BOS_DT_decTax,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_shTaxIndConfigType smallint)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_TIN_FakturPajak
SET 
szFakturPajakId=p_szFakturPajakId,
dtmFakturPajak=p_dtmFakturPajak,
szCustId=p_szCustId,
szCustNm=p_szCustNm,
szCustAddr=p_szCustAddr,
szCustNpwp=p_szCustNpwp,
szCompId=p_szCompId,
szCompNm=p_szCompNm,
szCompAddr=p_szCompAddr,
szCompNpwp=p_szCompNpwp,
szCompPkpNo=p_szCompPkpNo,
dtmCompPkpTg=p_dtmCompPkpTg,
szTaxIndConfigId=p_szTaxIndConfigId,
bIncludeTax=p_bIncludeTax,
shFakturType=p_shFakturType,
szCcyId = p_szCcyId,

decAmount=p_decAmount,
decDiscount=p_decDiscount,
decDPP=p_decDPP,
decPPN=p_decPPN,

bVoid=p_bVoid,
bApplied=p_bApplied,

szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId,

shTaxIndConfigType = p_shTaxIndConfigType
WHERE 
szFakturPajakId = p_szFakturPajakId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_UpdateFakturPajak_013(
p_szFakturPajakId BOS_DT_szId,
p_dtmFakturPajak timestamp,
p_szCustId BOS_DT_szId,
p_szCustNm BOS_DT_szName,
p_szCustAddr BOS_DT_szDescription,
p_szCustNpwp BOS_DT_szTaxId,
p_szCompId BOS_DT_szId,
p_szCompNm BOS_DT_szName,
p_szCompAddr varchar,
p_szCompNpwp BOS_DT_szTaxId,
p_szCompPkpNo BOS_DT_szTaxId,
p_dtmCompPkpTg timestamp,
p_szTaxIndConfigId BOS_DT_szId,
p_bIncludeTax smallint,
p_shFakturType smallint,
p_szCcyId BOS_DT_szSmallId,
p_decAmount BOS_DT_decAmount,
p_decDiscount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_decPPN BOS_DT_decTax,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_shTaxIndConfigType smallint)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_TIN_FakturPajak
SET 
szFakturPajakId=p_szFakturPajakId,
dtmFakturPajak=p_dtmFakturPajak,
szCustId=p_szCustId,
szCustNm=p_szCustNm,
szCustAddr=p_szCustAddr,
szCustNpwp=p_szCustNpwp,
szCompId=p_szCompId,
szCompNm=p_szCompNm,
szCompAddr=p_szCompAddr,
szCompNpwp=p_szCompNpwp,
szCompPkpNo=p_szCompPkpNo,
dtmCompPkpTg=p_dtmCompPkpTg,
szTaxIndConfigId=p_szTaxIndConfigId,
bIncludeTax=p_bIncludeTax,
shFakturType=p_shFakturType,
szCcyId = p_szCcyId,

decAmount=p_decAmount,
decDiscount=p_decDiscount,
decDPP=p_decDPP,
decPPN=p_decPPN,

bVoid=p_bVoid,
bApplied=p_bApplied,

szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId,

shTaxIndConfigType = p_shTaxIndConfigType
WHERE 
szFakturPajakId = p_szFakturPajakId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION BOS_TIN_FakturPajak_UpdateFakturPajak_014(
p_szFakturPajakId BOS_DT_szBigId,
p_dtmFakturPajak timestamp,
p_szCustId BOS_DT_szId,
p_szCustNm BOS_DT_szName,
p_szCustAddr BOS_DT_szBigDescription,
p_szCustNpwp BOS_DT_szTaxId,
p_szCompId BOS_DT_szId,
p_szCompNm BOS_DT_szName,
p_szCompAddr varchar,
p_szCompNpwp BOS_DT_szTaxId,
p_szCompPkpNo BOS_DT_szTaxId,
p_dtmCompPkpTg timestamp,
p_szTaxIndConfigId BOS_DT_szId,
p_bIncludeTax smallint,
p_shFakturType smallint,
p_szCcyId BOS_DT_szSmallId,
p_decAmount BOS_DT_decAmount,
p_decDiscount BOS_DT_decAmount,
p_decDPP BOS_DT_decTax,
p_decPPN BOS_DT_decTax,
p_bResultFrTransfer bit,
p_bVoid bit,
p_bApproved bit,
p_bApplied bit,
p_bJournal bit,
p_bPosted bit,
p_btPrintedCount smallint,
p_bTransferred bit,
p_szCompanyId BOS_DT_szMediumId,
p_szWorkplaceId BOS_DT_szId,
p_szTaxEntityId BOS_DT_szId,
p_bNeedApproval bit,
p_gdApprovedId bytea,
p_szApprovalId BOS_DT_szId,
p_szFJournalId BOS_DT_szId,
p_dtmCreated timestamp,
p_bSystemCreated bit,
p_szUserId BOS_DT_szId,
p_shTaxIndConfigType smallint,
p_szFakturPajakType BOS_DT_szId,
p_szReturnRefId BOS_DT_szBigId,
p_szCustReturnTaxRefNote BOS_DT_szBigId)
RETURNS void AS
$BODY$
BEGIN
UPDATE BOS_TIN_FakturPajak
SET 
szFakturPajakId=p_szFakturPajakId,
dtmFakturPajak=p_dtmFakturPajak,
szCustId=p_szCustId,
szCustNm=p_szCustNm,
szCustAddr=p_szCustAddr,
szCustNpwp=p_szCustNpwp,
szCompId=p_szCompId,
szCompNm=p_szCompNm,
szCompAddr=p_szCompAddr,
szCompNpwp=p_szCompNpwp,
szCompPkpNo=p_szCompPkpNo,
dtmCompPkpTg=p_dtmCompPkpTg,
szTaxIndConfigId=p_szTaxIndConfigId,
bIncludeTax=p_bIncludeTax,
shFakturType=p_shFakturType,
szCcyId = p_szCcyId,

decAmount=p_decAmount,
decDiscount=p_decDiscount,
decDPP=p_decDPP,
decPPN=p_decPPN,

bVoid=p_bVoid,
bApplied=p_bApplied,

szCompanyId=p_szCompanyId,
szWorkplaceId=p_szWorkplaceId,
szTaxEntityId=p_szTaxEntityId,

dtmCreated = p_dtmCreated,
szUserId = p_szUserId,

shTaxIndConfigType = p_shTaxIndConfigType,
szFakturPajakType = p_szFakturPajakType,
szReturnRefId = p_szReturnRefId,
szCustReturnTaxRefNote = p_szCustReturnTaxRefNote
WHERE 
szFakturPajakId = p_szFakturPajakId;

END;
$BODY$
LANGUAGE plpgsql;


CREATE OR REPLACE FUNCTION sp_GetRowsForAllTables(
p_DBName varchar)
RETURNS void AS
$BODY$
BEGIN

set nocount on
if p_DBName is null
  THEN
set p_DBName = db_name()

create table #a
(TableName varchar(128), norows int null, id int identity(1,1))

declare	p_id		int ,
p_maxID		int ,
p_TableName	varchar(128) ,
p_FKName		varchar(128) ,
p_cmd		nvarchar(1000) ,
p_rc		int, 
p_spcmd		varchar(1000)

set p_cmd = 'exec ' + p_DBName + '..sp_executesql N''insert #a (TableName) 
select TABLE_NAME from information_schema.tables
where TABLE_TYPE = ''''BASE TABLE'''' ''
'
exec (p_cmd)

select 	p_id = 0 ,
p_maxID = max(id)
from	#a

while p_id < p_maxID
begin
select 	p_id = min(id)
from	#a
where	id > p_id

select	p_TableName = TableName
from	#a
where 	id = p_id

set	p_cmd = 'exec ' + p_DBName + '..sp_executesql N''update #a set norows = (select rows from sysindexes where indid in (0,1) and id = object_id(''''' + p_TableName + '''''))'
set	p_cmd = p_cmd + ' where #a.id = ' + convert(varchar(10),p_id) + ''''

exec  (p_cmd)
END IF
if p_rc <> 0 or p_p_error <> 0
  THEN
begin
raiserror('failed %s',16,-1,p_TableName)
return
end
end

select * from #a
order by TableName ASC

drop table #a

END IF
END;
$BODY$
LANGUAGE plpgsql;